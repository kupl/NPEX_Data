[
    {
        "repo": "incubator-pinot",
        "commit": "https://github.com/apache/incubator-pinot/commit/69b2e7b0483dd697014d381dcc99a3fdb78282c9",
        "bug_id": "incubator-pinot_69b2e7b",
        "message": "[PINOT-2262] Set mmap handles to null after the file is unmapped.\n\nThis moves us one step easier to debug the issue. We will get an NPE instead of\na JVM crash (which is what is happening now)\n\nFix usages of CustomBitSet to close it, and remove the finalize method from it.\nThe finalize method was used only in tests\n\nRB=596782\nBUG=PINOT-2262\nG=pinot-dev-reviewers\nR=kgopalak,jfim\nA=kgopalak,jfim",
        "parent": "https://github.com/apache/incubator-pinot/commit/2cb57cea1d7292dd09a31e361120edc0db7c9c47",
        "patched_files": [
            "FixedByteSingleColumnSingleValueReaderWriter.java",
            "FixedBitWidthRowColDataFileReader.java",
            "FixedByteSingleColumnMultiValueReaderWriter.java",
            "GenericRowColumnDataFileReader.java",
            "FixedByteWidthRowColDataFileWriter.java",
            "FixedByteSkipListSCMVReader.java",
            "FixedBitSkipListSCMVReader.java",
            "FixedBitSkipListSCMVWriter.java",
            "FixedBitWidthSingleColumnMultiValueWriter.java",
            "BitmapInvertedIndexReader.java",
            "FixedBitCompressedMVForwardIndexReader.java",
            "FixedByteWidthRowColDataFileReader.java",
            "FixedByteSkipListSCMVWriter.java",
            "CustomBitSet.java",
            "FixedByteWidthSingleColumnMultiValueWriter.java",
            "FixedBitWidthRowColDataFileWriter.java",
            "FixedByteWidthSingleColumnMultiValueReader.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitSkipListSCMVReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitSkipListSCMVReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitSkipListSCMVReader.java",
                "deletions": 0,
                "sha": "3367939e188bcfe3413b35eaaa703733951ad7de",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitSkipListSCMVReader.java",
                "patch": "@@ -155,8 +155,15 @@ public int getRowsPerChunk() {\n   @Override\n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(chunkOffsetsBuffer);\n+    chunkOffsetsBuffer = null;\n     MmapUtils.unloadByteBuffer(bitsetBuffer);\n+    bitsetBuffer = null;\n     MmapUtils.unloadByteBuffer(rawDataBuffer);\n+    rawDataBuffer = null;\n+    customBitSet.close();\n+    customBitSet = null;\n+    rawDataReader.close();\n+    rawDataReader = null;\n \n     if (isMmap) {\n       raf.close();",
                "changes": 7
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitWidthRowColDataFileReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitWidthRowColDataFileReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitWidthRowColDataFileReader.java",
                "deletions": 6,
                "sha": "dc631f862d853ea0938e89468ef6adddadac4c19",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitWidthRowColDataFileReader.java",
                "patch": "@@ -15,20 +15,17 @@\n  */\n package com.linkedin.pinot.core.index.reader.impl;\n \n-import com.google.common.primitives.Ints;\n+import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.util.CustomBitSet;\n import java.io.File;\n import java.io.IOException;\n import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n import java.util.Arrays;\n-\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n-import com.linkedin.pinot.common.utils.MmapUtils;\n-import com.linkedin.pinot.core.util.CustomBitSet;\n-\n \n /**\n  *\n@@ -61,7 +58,7 @@\n    * contain negative numbers\n    */\n   private int[] offsets;\n-  private final CustomBitSet customBitSet;\n+  private CustomBitSet customBitSet;\n \n   private int totalSizeInBytes;\n   private boolean isMmap;\n@@ -286,6 +283,9 @@ public int getNumberOfCols() {\n   public void close() throws IOException {\n     if (ownsByteBuffer) {\n       MmapUtils.unloadByteBuffer(byteBuffer);\n+      byteBuffer = null;\n+      customBitSet.close();\n+      customBitSet = null;\n \n       if (isMmap) {\n         file.close();",
                "changes": 12
            },
            {
                "status": "modified",
                "additions": 11,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteSkipListSCMVReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteSkipListSCMVReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteSkipListSCMVReader.java",
                "deletions": 6,
                "sha": "1eb4e73c6a7de3c5f6babd4824ee5702f4c9cee2",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteSkipListSCMVReader.java",
                "patch": "@@ -15,18 +15,16 @@\n  */\n package com.linkedin.pinot.core.index.reader.impl;\n \n-import com.google.common.primitives.Ints;\n+import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n+import com.linkedin.pinot.core.index.reader.SingleColumnMultiValueReader;\n+import com.linkedin.pinot.core.util.CustomBitSet;\n import java.io.File;\n import java.io.IOException;\n import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n \n-import com.linkedin.pinot.common.utils.MmapUtils;\n-import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n-import com.linkedin.pinot.core.index.reader.SingleColumnMultiValueReader;\n-import com.linkedin.pinot.core.util.CustomBitSet;\n-\n \n /**\n  * Storage Layout\n@@ -166,8 +164,15 @@ private int computeStartOffset(int row) {\n \n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(chunkOffsetsBuffer);\n+    chunkOffsetsBuffer = null;\n     MmapUtils.unloadByteBuffer(bitsetBuffer);\n+    bitsetBuffer = null;\n     MmapUtils.unloadByteBuffer(rawDataBuffer);\n+    rawDataBuffer = null;\n+    customBitSet.close();\n+    customBitSet = null;\n+    rawDataReader.close();\n+    rawDataReader = null;\n \n     if (isMmap) {\n       raf.close();",
                "changes": 17
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthRowColDataFileReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthRowColDataFileReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthRowColDataFileReader.java",
                "deletions": 0,
                "sha": "321d1ec23dec093537487c1770e8c55f18a9e29d",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthRowColDataFileReader.java",
                "patch": "@@ -272,6 +272,7 @@ public int getNumberOfCols() {\n \n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(byteBuffer);\n+    byteBuffer = null;\n \n     if (isMMap) {\n       file.close();",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthSingleColumnMultiValueReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthSingleColumnMultiValueReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthSingleColumnMultiValueReader.java",
                "deletions": 0,
                "sha": "f238d23770f784185173ceacc6e56cc71f45dd6d",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthSingleColumnMultiValueReader.java",
                "patch": "@@ -131,7 +131,13 @@ public DataFileMetadata getMetadata() {\n   @Override\n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(headerSectionByteBuffer);\n+    headerSectionByteBuffer = null;\n     MmapUtils.unloadByteBuffer(dataSectionByteBuffer);\n+    dataSectionByteBuffer = null;\n+    headerSectionReader.close();\n+    headerSectionReader = null;\n+    dataSectionReader.close();\n+    dataSectionReader = null;\n \n     if (isMMap) {\n       raf.close();",
                "changes": 6
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnMultiValueReaderWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnMultiValueReaderWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnMultiValueReaderWriter.java",
                "deletions": 0,
                "sha": "d222ff254d8cee052a09463ded76e9ba4108878e",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnMultiValueReaderWriter.java",
                "patch": "@@ -156,7 +156,9 @@ public void close() {\n     for (ByteBuffer dataBuffer : dataBuffers) {\n       MmapUtils.unloadByteBuffer(dataBuffer);\n     }\n+    dataBuffers.clear();\n     MmapUtils.unloadByteBuffer(headerBuffer);\n+    headerBuffer = null;\n   }\n \n   private int updateHeader(int row, int length) {",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnSingleValueReaderWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnSingleValueReaderWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnSingleValueReaderWriter.java",
                "deletions": 6,
                "sha": "b10045f3c2e771b8f511fc14d27c93ff7c33bb91",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnSingleValueReaderWriter.java",
                "patch": "@@ -16,17 +16,14 @@\n package com.linkedin.pinot.core.index.readerwriter.impl;\n \n import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n+import com.linkedin.pinot.core.index.reader.impl.FixedByteWidthRowColDataFileReader;\n import com.linkedin.pinot.core.index.readerwriter.SingleColumnSingleValueReaderWriter;\n+import com.linkedin.pinot.core.index.writer.impl.FixedByteWidthRowColDataFileWriter;\n import java.io.IOException;\n import java.nio.ByteBuffer;\n import java.nio.ByteOrder;\n \n-import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n-import com.linkedin.pinot.core.index.reader.SingleColumnSingleValueReader;\n-import com.linkedin.pinot.core.index.reader.impl.FixedByteWidthRowColDataFileReader;\n-import com.linkedin.pinot.core.index.writer.SingleColumnSingleValueWriter;\n-import com.linkedin.pinot.core.index.writer.impl.FixedByteWidthRowColDataFileWriter;\n-\n \n public class FixedByteSingleColumnSingleValueReaderWriter implements SingleColumnSingleValueReaderWriter {\n \n@@ -68,8 +65,11 @@ public DataFileMetadata getMetadata() {\n   @Override\n   public void close() throws IOException {\n     reader.close();\n+    reader = null;\n     writer.close();\n+    writer = null;\n     MmapUtils.unloadByteBuffer(_buffer);\n+    _buffer = null;\n   }\n \n   @Override",
                "changes": 12
            },
            {
                "status": "modified",
                "additions": 9,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitSkipListSCMVWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitSkipListSCMVWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitSkipListSCMVWriter.java",
                "deletions": 0,
                "sha": "b60a9331f091672fa482860785c0524ec2c3c43b",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitSkipListSCMVWriter.java",
                "patch": "@@ -139,8 +139,17 @@ public void close() {\n     IOUtils.closeQuietly(raf);\n     raf = null;\n     MmapUtils.unloadByteBuffer(chunkOffsetsBuffer);\n+    chunkOffsetsBuffer = null;\n     MmapUtils.unloadByteBuffer(bitsetBuffer);\n+    bitsetBuffer = null;\n     MmapUtils.unloadByteBuffer(rawDataBuffer);\n+    rawDataBuffer = null;\n+    customBitSet.close();\n+    customBitSet = null;\n+    chunkOffsetsWriter.close();\n+    chunkOffsetsWriter = null;\n+    rawDataWriter.close();\n+    rawDataWriter = null;\n   }\n \n   private int updateHeader(int rowId, int length) {",
                "changes": 9
            },
            {
                "status": "modified",
                "additions": 5,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthRowColDataFileWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthRowColDataFileWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthRowColDataFileWriter.java",
                "deletions": 3,
                "sha": "6f758bb0bfb56aeb4095fd0d4c036ac9658eda5e",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthRowColDataFileWriter.java",
                "patch": "@@ -15,8 +15,8 @@\n  */\n package com.linkedin.pinot.core.index.writer.impl;\n \n-import com.google.common.primitives.Ints;\n import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.util.CustomBitSet;\n import java.io.Closeable;\n import java.io.File;\n import java.io.FileNotFoundException;\n@@ -25,8 +25,6 @@\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n import java.util.Arrays;\n-\n-import com.linkedin.pinot.core.util.CustomBitSet;\n import org.apache.commons.io.IOUtils;\n \n \n@@ -146,9 +144,13 @@ public void setInt(int row, int col, int val) {\n     }\n   }\n \n+  @Override\n   public void close() {\n     IOUtils.closeQuietly(raf);\n     raf = null;\n     MmapUtils.unloadByteBuffer(byteBuffer);\n+    byteBuffer = null;\n+    bitSet.close();\n+    bitSet = null;\n   }\n }",
                "changes": 8
            },
            {
                "status": "modified",
                "additions": 9,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthSingleColumnMultiValueWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthSingleColumnMultiValueWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthSingleColumnMultiValueWriter.java",
                "deletions": 1,
                "sha": "5c84861193c482d70d27fd4f817e62c7a21a1b4a",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthSingleColumnMultiValueWriter.java",
                "patch": "@@ -17,6 +17,7 @@\n \n import com.linkedin.pinot.common.utils.MmapUtils;\n import java.io.File;\n+import java.io.IOException;\n import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n@@ -67,11 +68,18 @@ public boolean setMetadata(DataFileMetadata metadata) {\n   }\n \n   @Override\n-  public void close() {\n+  public void close() throws IOException {\n     IOUtils.closeQuietly(raf);\n     raf = null;\n     MmapUtils.unloadByteBuffer(dataBuffer);\n+    dataBuffer = null;\n     MmapUtils.unloadByteBuffer(headerBuffer);\n+    headerBuffer = null;\n+    headerWriter.close();\n+    headerWriter = null;\n+    headerReader.close();\n+    dataWriter.close();\n+    dataWriter = null;\n   }\n \n   private int updateHeader(int row, int length) {",
                "changes": 10
            },
            {
                "status": "modified",
                "additions": 13,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteSkipListSCMVWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteSkipListSCMVWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteSkipListSCMVWriter.java",
                "deletions": 6,
                "sha": "bc63ac88a91602a8a7e9e6e796691ece2b0b8735",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteSkipListSCMVWriter.java",
                "patch": "@@ -15,18 +15,16 @@\n  */\n package com.linkedin.pinot.core.index.writer.impl;\n \n+import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n+import com.linkedin.pinot.core.index.writer.SingleColumnMultiValueWriter;\n+import com.linkedin.pinot.core.util.CustomBitSet;\n import java.io.File;\n import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n-\n import org.apache.commons.io.IOUtils;\n \n-import com.linkedin.pinot.common.utils.MmapUtils;\n-import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n-import com.linkedin.pinot.core.index.writer.SingleColumnMultiValueWriter;\n-import com.linkedin.pinot.core.util.CustomBitSet;\n-\n \n /**\n  * Storage Layout\n@@ -132,8 +130,17 @@ public void close() {\n     IOUtils.closeQuietly(raf);\n     raf = null;\n     MmapUtils.unloadByteBuffer(chunkOffsetsBuffer);\n+    chunkOffsetsBuffer = null;\n     MmapUtils.unloadByteBuffer(bitsetBuffer);\n+    bitsetBuffer = null;\n     MmapUtils.unloadByteBuffer(rawDataBuffer);\n+    rawDataBuffer = null;\n+    customBitSet.close();\n+    customBitSet = null;\n+    chunkOffsetsWriter.close();\n+    chunkOffsetsWriter = null;\n+    rawDataWriter.close();\n+    rawDataWriter = null;\n   }\n \n   private int updateHeader(int rowId, int length) {",
                "changes": 19
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthRowColDataFileWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthRowColDataFileWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthRowColDataFileWriter.java",
                "deletions": 0,
                "sha": "7a5e21777f287725449deaf4b4fe32b4fbe07545",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthRowColDataFileWriter.java",
                "patch": "@@ -120,6 +120,7 @@ public void close() {\n     raf = null;\n     if (ownsByteBuffer) {\n       MmapUtils.unloadByteBuffer(byteBuffer);\n+      byteBuffer = null;\n     }\n   }\n }",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 12,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthSingleColumnMultiValueWriter.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthSingleColumnMultiValueWriter.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthSingleColumnMultiValueWriter.java",
                "deletions": 5,
                "sha": "9ad02874e8b4101019666b34a58c22c70fedab09",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthSingleColumnMultiValueWriter.java",
                "patch": "@@ -16,15 +16,14 @@\n package com.linkedin.pinot.core.index.writer.impl;\n \n import com.linkedin.pinot.common.utils.MmapUtils;\n+import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n+import com.linkedin.pinot.core.index.reader.impl.FixedByteWidthRowColDataFileReader;\n+import com.linkedin.pinot.core.index.writer.SingleColumnMultiValueWriter;\n import java.io.File;\n import java.io.IOException;\n import java.io.RandomAccessFile;\n import java.nio.ByteBuffer;\n import java.nio.channels.FileChannel;\n-\n-import com.linkedin.pinot.core.index.reader.DataFileMetadata;\n-import com.linkedin.pinot.core.index.reader.impl.FixedByteWidthRowColDataFileReader;\n-import com.linkedin.pinot.core.index.writer.SingleColumnMultiValueWriter;\n import org.apache.commons.io.IOUtils;\n \n \n@@ -68,11 +67,19 @@ public boolean setMetadata(DataFileMetadata metadata) {\n   }\n \n   @Override\n-  public void close() {\n+  public void close() throws IOException {\n     IOUtils.closeQuietly(raf);\n     raf = null;\n     MmapUtils.unloadByteBuffer(dataBuffer);\n+    dataBuffer = null;\n     MmapUtils.unloadByteBuffer(headerBuffer);\n+    headerBuffer = null;\n+    dataWriter.close();\n+    dataWriter = null;\n+    headerWriter.close();\n+    headerWriter = null;\n+    headerReader.close();\n+    headerReader = null;\n   }\n \n   private int updateHeader(int row, int length) {",
                "changes": 17
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/indexsegment/utils/GenericRowColumnDataFileReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/indexsegment/utils/GenericRowColumnDataFileReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/indexsegment/utils/GenericRowColumnDataFileReader.java",
                "deletions": 0,
                "sha": "ee7b10277f607dbdd927387d3a2a843768ed2d2c",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/indexsegment/utils/GenericRowColumnDataFileReader.java",
                "patch": "@@ -232,5 +232,6 @@ public int getNumberOfCols() {\n   public void close() {\n     IOUtils.closeQuietly(file);\n     MmapUtils.unloadByteBuffer(byteBuffer);\n+    byteBuffer = null;\n   }\n }",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/BitmapInvertedIndexReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/BitmapInvertedIndexReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/BitmapInvertedIndexReader.java",
                "deletions": 0,
                "sha": "a44719f99565e26244cad71fa723a92e16fe6681",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/BitmapInvertedIndexReader.java",
                "patch": "@@ -127,6 +127,7 @@ private void load(File file, boolean isMmap) throws IOException {\n   @Override\n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(buffer);\n+    buffer = null;\n     if (_rndFile != null) {\n       _rndFile.close();\n     }",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/readers/FixedBitCompressedMVForwardIndexReader.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/readers/FixedBitCompressedMVForwardIndexReader.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/readers/FixedBitCompressedMVForwardIndexReader.java",
                "deletions": 0,
                "sha": "0e00e12b204a2e14a24e4f2c4fe60ec1b5505929",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/readers/FixedBitCompressedMVForwardIndexReader.java",
                "patch": "@@ -164,7 +164,13 @@ public DataFileMetadata getMetadata() {\n   @Override\n   public void close() throws IOException {\n     MmapUtils.unloadByteBuffer(dataSectionBuffer);\n+    dataSectionBuffer = null;\n     MmapUtils.unloadByteBuffer(headerSectionBuffer);\n+    headerSectionBuffer = null;\n+    dataSectionReader.close();\n+    dataSectionReader = null;\n+    headerSectionReader.close();\n+    headerSectionReader = null;\n \n     if (isMmap) {\n       raf.close();",
                "changes": 6
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/util/CustomBitSet.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/main/java/com/linkedin/pinot/core/util/CustomBitSet.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/main/java/com/linkedin/pinot/core/util/CustomBitSet.java",
                "deletions": 6,
                "sha": "de0eeed17d9f17d63c2377dd21cd1ad7a2d9660b",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/main/java/com/linkedin/pinot/core/util/CustomBitSet.java",
                "patch": "@@ -15,9 +15,9 @@\n  */\n package com.linkedin.pinot.core.util;\n \n-import com.google.common.primitives.Ints;\n import com.linkedin.pinot.common.utils.MmapUtils;\n import com.linkedin.pinot.core.indexsegment.utils.BitUtils;\n+import java.io.Closeable;\n import java.nio.ByteBuffer;\n \n \n@@ -26,10 +26,10 @@\n  * Util class to store bit set, provides additional utility over java bit set by\n  * allowing reading int from start bit to end bit\n  */\n-public final class CustomBitSet {\n+public final class CustomBitSet implements Closeable {\n \n   private final int nrBytes;\n-  private final ByteBuffer buf;\n+  private ByteBuffer buf;\n   private final static int[] bitCountArray = new int[256];\n   private final static int IGNORED_ZEROS_COUNT = Integer.SIZE - Byte.SIZE;\n   private final boolean ownsByteBuffer;\n@@ -268,11 +268,11 @@ public boolean isBitSet(long index) {\n     return ((b & (1 << offset)) != 0);\n   }\n \n-  protected void finalize() throws Throwable {\n+  @Override\n+  public void close() {\n     if (ownsByteBuffer) {\n       MmapUtils.unloadByteBuffer(buf);\n+      buf = null;\n     }\n-\n-    super.finalize();\n   }\n }",
                "changes": 12
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/core/util/CustomBitSetTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/core/util/CustomBitSetTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/core/util/CustomBitSetTest.java",
                "deletions": 0,
                "sha": "4130d93c4a61c54c5c0c13f189a800ae228b8888",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/core/util/CustomBitSetTest.java",
                "patch": "@@ -41,6 +41,7 @@ public void testSetBit() {\n         Assert.assertFalse(customBitSet.isBitSet(i));\n       }\n     }\n+    customBitSet.close();\n   }\n \n   @Test\n@@ -52,6 +53,7 @@ public void testFindNthBitSet() {\n     customBitSet.setBit(250);\n     System.out.println(customBitSet.findNthBitSetAfter(0, 1));\n     System.out.println(customBitSet.findNthBitSetAfter(100, 1));\n+    customBitSet.close();\n \n   }\n \n@@ -135,6 +137,7 @@ public void testFindNthBitSetRandom() {\n       }\n       Assert.assertEquals(nthBitSetAfter, expectedIndex, \"Bits set \" +\n           bitsOnCopy + \", searching for \" + nthBitToFind + \"th bit from \" + startSearchIndex);\n+      customBitSet.close();\n     }\n   }\n \n@@ -153,6 +156,7 @@ public void testNthBit() {\n           Assert.assertEquals(foundSetBitIndex, -1, \"Found bit at index \" + foundSetBitIndex + \" while it was set at \"\n               + setBitIndex + \" searching from \" + searchStartIndex);\n         }\n+        customBitSet.close();\n       }\n     }\n   }\n@@ -179,6 +183,7 @@ public void testNthBitWithConfusingBit() {\n             Assert.assertEquals(foundSetBitIndex, -1, \"Found bit at index \" + foundSetBitIndex\n                 + \" while it was set at \" + setBitIndex + \" searching from \" + searchStartIndex);\n           }\n+          customBitSet.close();\n         }\n       }\n     }\n@@ -200,5 +205,6 @@ public void testNthBitFixed() {\n       Assert.assertEquals(foundSetBitIndex, -1, \"Found bit at index \" + foundSetBitIndex + \" while it was set at \"\n           + setBitIndex + \" searching from \" + searchStartIndex);\n     }\n+    customBitSet.close();\n   }\n }",
                "changes": 6
            },
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthRowColDataFileReaderTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthRowColDataFileReaderTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthRowColDataFileReaderTest.java",
                "deletions": 6,
                "sha": "339987172e8f4eb964802fc8fa37ea71b5820c1b",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthRowColDataFileReaderTest.java",
                "patch": "@@ -72,7 +72,7 @@ public void testReadIntFromByteBuffer() {\n       }\n       System.out.println(\"END MAX BITS:\" + maxBits);\n       maxBits = maxBits + 1;\n-\n+      customBitSet.close();\n     }\n   }\n \n@@ -88,10 +88,11 @@ public void testSingleColUnsigned() throws Exception {\n     for (int maxBits : maxBitArray) {\n       String fileName = \"test\" + maxBits + \"FixedBitWidthSingleCol\";\n       File file = new File(fileName);\n+      CustomBitSet bitset = null;\n       try {\n         System.out.println(\"START MAX BITS:\" + maxBits);\n         int numElements = 100;\n-        CustomBitSet bitset = CustomBitSet.withBitLength(numElements * maxBits);\n+        bitset = CustomBitSet.withBitLength(numElements * maxBits);\n         int max = (int) Math.pow(2, maxBits);\n         Random r = new Random();\n         int[] values = new int[numElements];\n@@ -135,9 +136,8 @@ public void testSingleColUnsigned() throws Exception {\n         System.out.println(\"END MAX BITS:\" + maxBits);\n       } finally {\n         file.delete();\n-\n+        bitset.close();\n       }\n-\n     }\n   }\n \n@@ -153,12 +153,12 @@ public void testSingleColSigned() throws Exception {\n     for (int maxBits : maxBitArray) {\n       String fileName = \"test\" + maxBits + \"FixedBitWidthSingleCol\";\n       File file = new File(fileName);\n+      CustomBitSet bitset = null;\n       try {\n         System.out.println(\"START MAX BITS:\" + maxBits);\n         int numElements = 100;\n         int requiredBits = maxBits + 1;\n-        CustomBitSet bitset = CustomBitSet.withBitLength(numElements\n-            * requiredBits);\n+        bitset = CustomBitSet.withBitLength(numElements * requiredBits);\n         int max = (int) Math.pow(2, maxBits);\n         Random r = new Random();\n         int[] values = new int[numElements];\n@@ -207,6 +207,7 @@ public void testSingleColSigned() throws Exception {\n         System.out.println(\"END MAX BITS:\" + maxBits);\n       } finally {\n         file.delete();\n+        bitset.close();\n       }\n \n     }",
                "changes": 13
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthSingleColumnMultiValueReaderTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthSingleColumnMultiValueReaderTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthSingleColumnMultiValueReaderTest.java",
                "deletions": 0,
                "sha": "65c7f384011cf74acc6f4fc302f1ad0aaa4ee047",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/reader/FixedBitWidthSingleColumnMultiValueReaderTest.java",
                "patch": "@@ -74,6 +74,7 @@ public void testSingleColMultiValue() throws Exception {\n       dos.write(bitSet.toByteArray());\n       dos.flush();\n       dos.close();\n+      bitSet.close();\n \n       // Assert.assertEquals(FileReaderTestUtils.getNumOpenFiles(f), 0);\n       final int[] readValues = new int[100];",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitSkipListSCMVWriterTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitSkipListSCMVWriterTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitSkipListSCMVWriterTest.java",
                "deletions": 0,
                "sha": "04db98342ecbf4eff0d761b5ea48301d6a3d218f",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitSkipListSCMVWriterTest.java",
                "patch": "@@ -114,6 +114,8 @@ public void testSingleColMultiValue() throws Exception {\n       file.delete();\n       System.out.println(\"END test maxBit:\" + maxBits);\n       maxBits = maxBits + 1;\n+      bitSet.close();\n+      customBit.close();\n     }\n   }\n }",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthRowColDataFileWriterTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthRowColDataFileWriterTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthRowColDataFileWriterTest.java",
                "deletions": 0,
                "sha": "d9afc8ff569bc93964be902302c4962a10396c69",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthRowColDataFileWriterTest.java",
                "patch": "@@ -79,6 +79,7 @@ public void testSingleColUnsigned() throws Exception {\n       System.out.println(\"END test maxBits:\" + maxBits);\n       maxBits = maxBits + 1;\n       file.delete();\n+      set.close();\n     }\n   }\n \n@@ -140,6 +141,7 @@ public void testSingleColSigned() throws Exception {\n       System.out.println(\"END test maxBits:\" + maxBits);\n       maxBits = maxBits + 1;\n       file.delete();\n+      set.close();\n     }\n   }\n }",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthSingleColumnMultiValueWriterTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthSingleColumnMultiValueWriterTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthSingleColumnMultiValueWriterTest.java",
                "deletions": 0,
                "sha": "f569683bd9450d072f061197ee4a104df2310cc9",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedBitWidthSingleColumnMultiValueWriterTest.java",
                "patch": "@@ -90,6 +90,7 @@ public void testSingleColMultiValue() throws Exception {\n       file.delete();\n       System.out.println(\"END test maxBit:\" + maxBits);\n       maxBits = maxBits + 1;\n+      bitSet.close();\n     }\n \n   }",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-pinot/raw/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedByteSkipListSCMVWriterTest.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-pinot/contents/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedByteSkipListSCMVWriterTest.java?ref=69b2e7b0483dd697014d381dcc99a3fdb78282c9",
                "filename": "pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedByteSkipListSCMVWriterTest.java",
                "deletions": 0,
                "sha": "12d180628cd25b7e8d0c4e2a1207e8a4ab7ba153",
                "blob_url": "https://github.com/apache/incubator-pinot/blob/69b2e7b0483dd697014d381dcc99a3fdb78282c9/pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedByteSkipListSCMVWriterTest.java",
                "patch": "@@ -92,5 +92,6 @@ public void testSingleColMultiValue() throws Exception {\n     dis.close();\n     file.delete();\n     raf.close();\n+    customBit.close();\n   }\n }",
                "changes": 1
            }
        ],
        "unit_tests": [
            "FixedByteWidthRowColDataFileWriterTest.java",
            "FixedBitSkipListSCMVWriterTest.java",
            "FixedBitSkipListSCMVReaderTest.java",
            "FixedByteSingleColumnMultiValueReaderWriterTest.java",
            "FixedBitWidthSingleColumnMultiValueWriterTest.java",
            "FixedByteSkipListSCMVReaderTest.java",
            "FixedByteWidthRowColDataFileReaderTest.java",
            "FixedBitWidthRowColDataFileReaderTest.java",
            "FixedByteSingleColumnSingleValueReaderWriterTest.java",
            "FixedByteWidthSingleColumnMultiValueReaderTest.java",
            "FixedBitWidthSingleColumnMultiValueReaderTest.java",
            "FixedBitWidthRowColDataFileWriterTest.java",
            "CustomBitSetTest.java",
            "FixedByteWidthSingleColumnMultiValueWriterTest.java",
            "FixedByteSkipListSCMVWriterTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "pinot-core/src/test/java/com/linkedin/pinot/index/writer/FixedByteWidthRowColDataFileWriterTest.java",
        "buggy_files": [
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnSingleValueReaderWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitWidthRowColDataFileReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/readerwriter/impl/FixedByteSingleColumnMultiValueReaderWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/indexsegment/utils/GenericRowColumnDataFileReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthRowColDataFileWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteSkipListSCMVReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedBitSkipListSCMVReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitSkipListSCMVWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthSingleColumnMultiValueWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/BitmapInvertedIndexReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/segment/index/readers/FixedBitCompressedMVForwardIndexReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthRowColDataFileReader.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteSkipListSCMVWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/util/CustomBitSet.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedByteWidthSingleColumnMultiValueWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/writer/impl/FixedBitWidthRowColDataFileWriter.java",
            "pinot-core/src/main/java/com/linkedin/pinot/core/index/reader/impl/FixedByteWidthSingleColumnMultiValueReader.java"
        ],
        "fixed": true
    }
]