[
    {
        "repo": "httpcomponents-client",
        "commit": "https://github.com/apache/httpcomponents-client/commit/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1",
        "bug_id": "httpcomponents-client_9cc7c1a",
        "message": "HTTPCLIENT-1440: 'file' scheme in redirect location URI causes NPE.\nContributed by James Leigh <james at 3roundstones dot com>\n\ngit-svn-id: https://svn.apache.org/repos/asf/httpcomponents/httpclient/trunk@1546315 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/httpcomponents-client/commit/037b915bd094e1c1c17b442cda92e822e90c0f59",
        "patched_files": [
            "RELEASE_NOTES.txt",
            "URIUtils.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 3,
                "raw_url": "https://github.com/apache/httpcomponents-client/raw/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/RELEASE_NOTES.txt",
                "contents_url": "https://api.github.com/repos/apache/httpcomponents-client/contents/RELEASE_NOTES.txt?ref=9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1",
                "filename": "RELEASE_NOTES.txt",
                "deletions": 0,
                "sha": "706677632793bf5a7b45c9a49f4e76d2f98a5bcb",
                "blob_url": "https://github.com/apache/httpcomponents-client/blob/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/RELEASE_NOTES.txt",
                "patch": "@@ -1,6 +1,9 @@\n Changes since 4.3.1\n -------------------\n \n+* [HTTPCLIENT-1440] 'file' scheme in redirect location URI causes NPE.\n+  Contributed by James Leigh <james at 3roundstones dot com>\n+\n * [HTTPCLIENT-1437] Made Executor#execute thread safe.\n   Contributed by Oleg Kalnichevski <olegk at apache.org>\n ",
                "changes": 3
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/httpcomponents-client/raw/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/httpclient/src/main/java/org/apache/http/client/utils/URIUtils.java",
                "contents_url": "https://api.github.com/repos/apache/httpcomponents-client/contents/httpclient/src/main/java/org/apache/http/client/utils/URIUtils.java?ref=9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1",
                "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIUtils.java",
                "deletions": 1,
                "sha": "131f20d7af630579aa8b34cd041ca26578679f63",
                "blob_url": "https://github.com/apache/httpcomponents-client/blob/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/httpclient/src/main/java/org/apache/http/client/utils/URIUtils.java",
                "patch": "@@ -259,7 +259,8 @@ private static URI resolveReferenceStartingWithQueryString(\n      * @return the URI without dot segments\n      */\n     private static URI normalizeSyntax(final URI uri) {\n-        if (uri.isOpaque()) {\n+        if (uri.isOpaque() || uri.getAuthority() == null) {\n+            // opaque and file: URIs\n             return uri;\n         }\n         Args.check(uri.isAbsolute(), \"Base URI must be absolute\");",
                "changes": 3
            },
            {
                "status": "modified",
                "additions": 14,
                "raw_url": "https://github.com/apache/httpcomponents-client/raw/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/httpclient/src/test/java/org/apache/http/client/utils/TestURIUtils.java",
                "contents_url": "https://api.github.com/repos/apache/httpcomponents-client/contents/httpclient/src/test/java/org/apache/http/client/utils/TestURIUtils.java?ref=9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1",
                "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIUtils.java",
                "deletions": 0,
                "sha": "6050061a6808c7a90fb8e7b409253a537c9d87a2",
                "blob_url": "https://github.com/apache/httpcomponents-client/blob/9cc7c1acecb5ce7af867718f0d1933b3bdf3c3f1/httpclient/src/test/java/org/apache/http/client/utils/TestURIUtils.java",
                "patch": "@@ -173,6 +173,20 @@ public void testResolve() {\n                 \"http://s/mid/content=5/../6\").toString());\n     }\n \n+    @Test\n+    public void testResolveOpaque() {\n+        Assert.assertEquals(\"example://a/b/c/%7Bfoo%7D\", URIUtils.resolve(this.baseURI, \"eXAMPLE://a/./b/../b/%63/%7bfoo%7d\").toString());\n+        Assert.assertEquals(\"file://localhost/etc/fstab\", URIUtils.resolve(this.baseURI, \"file://localhost/etc/fstab\").toString());\n+        Assert.assertEquals(\"file:///etc/fstab\", URIUtils.resolve(this.baseURI, \"file:///etc/fstab\").toString());\n+        Assert.assertEquals(\"file://localhost/c:/WINDOWS/clock.avi\", URIUtils.resolve(this.baseURI, \"file://localhost/c:/WINDOWS/clock.avi\").toString());\n+        Assert.assertEquals(\"file:///c:/WINDOWS/clock.avi\", URIUtils.resolve(this.baseURI, \"file:///c:/WINDOWS/clock.avi\").toString());\n+        Assert.assertEquals(\"file://hostname/path/to/the%20file.txt\", URIUtils.resolve(this.baseURI, \"file://hostname/path/to/the%20file.txt\").toString());\n+        Assert.assertEquals(\"file:///c:/path/to/the%20file.txt\", URIUtils.resolve(this.baseURI, \"file:///c:/path/to/the%20file.txt\").toString());\n+        Assert.assertEquals(\"urn:issn:1535-3613\", URIUtils.resolve(this.baseURI, \"urn:issn:1535-3613\").toString());\n+        Assert.assertEquals(\"mailto:user@example.com\", URIUtils.resolve(this.baseURI, \"mailto:user@example.com\").toString());\n+        Assert.assertEquals(\"ftp://example.org/resource.txt\", URIUtils.resolve(this.baseURI, \"ftp://example.org/resource.txt\").toString());\n+    }\n+\n     @Test\n     public void testExtractHost() throws Exception {\n         Assert.assertEquals(new HttpHost(\"localhost\"),",
                "changes": 14
            }
        ],
        "unit_tests": [
            "TestURIUtils.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "httpclient/src/test/java/org/apache/http/client/utils/TestURIUtils.java",
        "buggy_files": [
            "RELEASE_NOTES.txt",
            "httpclient/src/main/java/org/apache/http/client/utils/URIUtils.java"
        ],
        "fixed": true
    }
]