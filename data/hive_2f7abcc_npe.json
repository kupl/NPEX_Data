[
    {
        "repo": "hive",
        "commit": "https://github.com/apache/hive/commit/2f7abcc6039ca4fddda2c90d5d0184c70c663614",
        "bug_id": "hive_2f7abcc",
        "message": "HIVE-20829: JdbcStorageHandler range split throws NPE (Daniel Dai, reviewed by Thejas Nair)\n\nSigned-off-by: Thejas M Nair <thejas@hortonworks.com>",
        "parent": "https://github.com/apache/hive/commit/1656e1bd892bb47e50ee8352813b0dab6f230bb4",
        "patched_files": [
            "JdbcInputFormat.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/hive/raw/2f7abcc6039ca4fddda2c90d5d0184c70c663614/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputFormat.java",
                "contents_url": "https://api.github.com/repos/apache/hive/contents/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputFormat.java?ref=2f7abcc6039ca4fddda2c90d5d0184c70c663614",
                "filename": "jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputFormat.java",
                "deletions": 1,
                "sha": "14c5a777965b7158092331e06610e08b9f649b94",
                "blob_url": "https://github.com/apache/hive/blob/2f7abcc6039ca4fddda2c90d5d0184c70c663614/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputFormat.java",
                "patch": "@@ -132,7 +132,7 @@\n         intervals.get(intervals.size()-1).setRight(null);\n         splits = new InputSplit[intervals.size()];\n         for (int i = 0; i < intervals.size(); i++) {\n-          splits[i] = new JdbcInputSplit(partitionColumn, intervals.get(i).getLeft(), intervals.get(i).getRight());\n+          splits[i] = new JdbcInputSplit(partitionColumn, intervals.get(i).getLeft(), intervals.get(i).getRight(), tablePaths[0]);\n         }\n       } else {\n         int numRecords = dbAccessor.getTotalNumberOfRecords(job);",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 18,
                "raw_url": "https://github.com/apache/hive/raw/2f7abcc6039ca4fddda2c90d5d0184c70c663614/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputSplit.java",
                "contents_url": "https://api.github.com/repos/apache/hive/contents/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputSplit.java?ref=2f7abcc6039ca4fddda2c90d5d0184c70c663614",
                "filename": "jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputSplit.java",
                "deletions": 9,
                "sha": "e591413aec6c5686c97693d8227d34bed2e68ca0",
                "blob_url": "https://github.com/apache/hive/blob/2f7abcc6039ca4fddda2c90d5d0184c70c663614/jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputSplit.java",
                "patch": "@@ -32,7 +32,6 @@\n   private String lowerBound = null;\n   private String upperBound = null;\n \n-\n   public JdbcInputSplit() {\n     super(null, 0, 0, EMPTY_ARRAY);\n     this.limit = -1;\n@@ -51,14 +50,8 @@ public JdbcInputSplit(int limit, int offset, Path dummyPath) {\n     this.offset = offset;\n   }\n \n-  public JdbcInputSplit(int limit, int offset) {\n-    super(null, 0, 0, EMPTY_ARRAY);\n-    this.limit = limit;\n-    this.offset = offset;\n-  }\n-\n-  public JdbcInputSplit(String partitionColumn, String lowerBound, String upperBound) {\n-    super(null, 0, 0, EMPTY_ARRAY);\n+  public JdbcInputSplit(String partitionColumn, String lowerBound, String upperBound, Path dummyPath) {\n+    super(dummyPath, 0, 0, EMPTY_ARRAY);\n     this.partitionColumn = partitionColumn;\n     this.lowerBound = lowerBound;\n     this.upperBound = upperBound;\n@@ -72,7 +65,17 @@ public void write(DataOutput out) throws IOException {\n     if (partitionColumn != null) {\n       out.writeBoolean(true);\n       out.writeUTF(partitionColumn);\n+    } else {\n+      out.writeBoolean(false);\n+    }\n+    if (lowerBound != null) {\n+      out.writeBoolean(true);\n       out.writeUTF(lowerBound);\n+    } else {\n+      out.writeBoolean(false);\n+    }\n+    if (upperBound != null) {\n+      out.writeBoolean(true);\n       out.writeUTF(upperBound);\n     } else {\n       out.writeBoolean(false);\n@@ -88,7 +91,13 @@ public void readFields(DataInput in) throws IOException {\n     boolean partitionColumnExists = in.readBoolean();\n     if (partitionColumnExists) {\n       partitionColumn = in.readUTF();\n+    }\n+    boolean lowerBoundExists = in.readBoolean();\n+    if (lowerBoundExists) {\n       lowerBound = in.readUTF();\n+    }\n+    boolean upperBoundExists = in.readBoolean();\n+    if (upperBoundExists) {\n       upperBound = in.readUTF();\n     }\n   }",
                "changes": 27
            }
        ],
        "unit_tests": [
            "TestJdbcInputFormat.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "jdbc-handler/src/test/java/org/apache/hive/storage/jdbc/TestJdbcInputFormat.java",
        "buggy_files": [
            "jdbc-handler/src/main/java/org/apache/hive/storage/jdbc/JdbcInputFormat.java"
        ],
        "fixed": true
    }
]