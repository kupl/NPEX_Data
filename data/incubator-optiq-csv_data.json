[
    {
        "repo": "incubator-optiq-csv",
        "message": "Fix bug where non-existent directory would give NPE. Instead print warning.",
        "commit": "https://github.com/apache/incubator-optiq-csv/commit/387bee8b616623d91103751e8afe6d7c21842446",
        "parent": "https://github.com/apache/incubator-optiq-csv/commit/5b0e70c7457d23f7cf5ddb74c78395f5ad45476c",
        "bug_id": "incubator-optiq-csv_1",
        "file": [
            {
                "sha": "8640228582add0586a43a4fb0edc66e94d4bd5a7",
                "filename": "src/main/java/net/hydromatic/optiq/impl/csv/CsvSchema.java",
                "blob_url": "https://github.com/apache/incubator-optiq-csv/blob/387bee8b616623d91103751e8afe6d7c21842446/src/main/java/net/hydromatic/optiq/impl/csv/CsvSchema.java",
                "raw_url": "https://github.com/apache/incubator-optiq-csv/raw/387bee8b616623d91103751e8afe6d7c21842446/src/main/java/net/hydromatic/optiq/impl/csv/CsvSchema.java",
                "status": "modified",
                "changes": 4,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/incubator-optiq-csv/contents/src/main/java/net/hydromatic/optiq/impl/csv/CsvSchema.java?ref=387bee8b616623d91103751e8afe6d7c21842446",
                "patch": "@@ -67,6 +67,10 @@ public boolean accept(File dir, String name) {\n             return name.endsWith(\".csv\");\n           }\n         });\n+    if (files == null) {\n+      System.out.println(\"directory \" + directoryFile + \" not found\");\n+      files = new File[0];\n+    }\n     for (File file : files) {\n       String tableName = file.getName();\n       if (tableName.endsWith(\".csv\")) {",
                "deletions": 0
            },
            {
                "sha": "a7869091924d39c6afc615d3e36e89d7f396cdad",
                "filename": "src/test/java/net/hydromatic/optiq/test/CsvTest.java",
                "blob_url": "https://github.com/apache/incubator-optiq-csv/blob/387bee8b616623d91103751e8afe6d7c21842446/src/test/java/net/hydromatic/optiq/test/CsvTest.java",
                "raw_url": "https://github.com/apache/incubator-optiq-csv/raw/387bee8b616623d91103751e8afe6d7c21842446/src/test/java/net/hydromatic/optiq/test/CsvTest.java",
                "status": "modified",
                "changes": 29,
                "additions": 29,
                "contents_url": "https://api.github.com/repos/apache/incubator-optiq-csv/contents/src/test/java/net/hydromatic/optiq/test/CsvTest.java?ref=387bee8b616623d91103751e8afe6d7c21842446",
                "patch": "@@ -71,6 +71,35 @@ private void close(Connection connection, Statement statement) {\n     connection.close();\n   }\n \n+  /** Tests an inline schema with a non-existent directory. */\n+  @Test public void testBadDirectory() throws SQLException {\n+    Properties info = new Properties();\n+    info.put(\"model\",\n+        \"inline:\"\n+        + \"{\\n\"\n+        + \"  version: '1.0',\\n\"\n+        + \"   schemas: [\\n\"\n+        + \"     {\\n\"\n+        + \"       type: 'custom',\\n\"\n+        + \"       name: 'bad',\\n\"\n+        + \"       factory: 'net.hydromatic.optiq.impl.csv.CsvSchemaFactory',\\n\"\n+        + \"       operand: {\\n\"\n+        + \"         directory: '/does/not/exist'\\n\"\n+        + \"       }\\n\"\n+        + \"     }\\n\"\n+        + \"   ]\\n\"\n+        + \"}\");\n+\n+    Connection connection =\n+        DriverManager.getConnection(\"jdbc:optiq:\", info);\n+    // must print \"directory ... not found\" to stdout, but not fail\n+    ResultSet tables =\n+        connection.getMetaData().getTables(null, null, null, null);\n+    tables.next();\n+    tables.close();\n+    connection.close();\n+  }\n+\n   /**\n    * Reads from a table.\n    */",
                "deletions": 0
            }
        ]
    }
]