[
    {
        "repo": "directory-ldap-api",
        "commit": "https://github.com/apache/directory-ldap-api/commit/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e",
        "bug_id": "directory-ldap-api_a7f4362",
        "message": "Fix for a NPE raised in Studio when exporting entries to DSML, DIRSTUDIO-765 (Can not export DSML).\n\ngit-svn-id: https://svn.apache.org/repos/asf/directory/shared/trunk@1240225 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/directory-ldap-api/commit/2cc63efd4989ea054c8b24cd68faf41e1627dc2a",
        "patched_files": [
            "SearchResponse.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/directory-ldap-api/raw/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/Dsmlv2ResponseGrammar.java",
                "contents_url": "https://api.github.com/repos/apache/directory-ldap-api/contents/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/Dsmlv2ResponseGrammar.java?ref=a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e",
                "filename": "dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/Dsmlv2ResponseGrammar.java",
                "deletions": 2,
                "sha": "e31a5c0aa24aae49cd3eade3c9fa172ec12c3d4a",
                "blob_url": "https://github.com/apache/directory-ldap-api/blob/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/Dsmlv2ResponseGrammar.java",
                "patch": "@@ -1621,11 +1621,11 @@ public void action( Dsmlv2Container container ) throws XmlPullParserException\n             if ( attributeValue != null )\n             {\n                 searchResponse = new SearchResponse(\n-                    ParserUtils.parseAndVerifyRequestID( attributeValue, xpp ), null );\n+                    ParserUtils.parseAndVerifyRequestID( attributeValue, xpp ) );\n             }\n             else\n             {\n-                searchResponse = new SearchResponse( -1, null );\n+                searchResponse = new SearchResponse();\n             }\n \n             container.getBatchResponse().addResponse( new SearchResponseDsml(",
                "changes": 4
            },
            {
                "status": "modified",
                "additions": 39,
                "raw_url": "https://github.com/apache/directory-ldap-api/raw/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponse.java",
                "contents_url": "https://api.github.com/repos/apache/directory-ldap-api/contents/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponse.java?ref=a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e",
                "filename": "dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponse.java",
                "deletions": 3,
                "sha": "2bdbf46b8c5b847eba87b8b1f68b98a494ecb1b7",
                "blob_url": "https://github.com/apache/directory-ldap-api/blob/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponse.java",
                "patch": "@@ -44,15 +44,23 @@\n     private SearchResultDoneDsml searchResultDone;\n \n \n+    /**\n+     * Creates a new instance of SearchResponse.\n+     */\n+    public SearchResponse()\n+    {\n+        super( -1, null );\n+    }\n+\n+\n     /**\n      * Creates a new instance of SearchResponse.\n      *\n      * @param messageId the response eliciting this Request\n-     * @param type the message type of the response\n      */\n-    public SearchResponse( int messageId, MessageTypeEnum type )\n+    public SearchResponse( int messageId )\n     {\n-        super( messageId, type );\n+        super( messageId, null );\n     }\n \n \n@@ -70,6 +78,20 @@ public boolean addSearchResultEntry( SearchResultEntryDsml searchResultEntry )\n     }\n \n \n+    /**\n+     * Removes a Search Result Entry\n+     *\n+     * @param searchResultEntry\n+     *      the Search Result Entry to remove\n+     * @return\n+     *      true (as per the general contract of the Collection.remove method)\n+     */\n+    public boolean removeSearchResultEntry( SearchResultEntryDsml searchResultEntry )\n+    {\n+        return searchResultEntryList.remove( searchResultEntry );\n+    }\n+\n+\n     /**\n      * Gets the Current Search Result Entry\n      * \n@@ -115,6 +137,20 @@ public boolean addSearchResultReference( SearchResultReferenceDsml searchResultR\n     }\n \n \n+    /**\n+     * Removes a Search Result Reference\n+     *\n+     * @param searchResultReference\n+     *      the Search Result Reference to remove\n+     * @return\n+     *      true (as per the general contract of the Collection.remove method)\n+     */\n+    public boolean removeSearchResultReference( SearchResultReferenceDsml searchResultReference )\n+    {\n+        return searchResultReferenceList.remove( searchResultReference );\n+    }\n+\n+\n     /**\n      * Gets the current Search Result Reference\n      *",
                "changes": 42
            },
            {
                "status": "modified",
                "additions": 24,
                "raw_url": "https://github.com/apache/directory-ldap-api/raw/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponseDsml.java",
                "contents_url": "https://api.github.com/repos/apache/directory-ldap-api/contents/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponseDsml.java?ref=a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e",
                "filename": "dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponseDsml.java",
                "deletions": 2,
                "sha": "67b803370c559b6adc31f7c7df87347961ba5ad9",
                "blob_url": "https://github.com/apache/directory-ldap-api/blob/a7f4362bdb8ef0e09a35f6f5e08ce7878459c57e/dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponseDsml.java",
                "patch": "@@ -55,7 +55,7 @@\n      */\n     public SearchResponseDsml( LdapApiService codec )\n     {\n-        super( codec, null );\n+        super( codec, new SearchResponse() );\n     }\n \n \n@@ -112,8 +112,30 @@ else if ( response instanceof SearchResultDone )\n      * @return\n      *      true if this list contained the specified element.\n      */\n-    public boolean removeResponse( DsmlDecorator<Response> response )\n+    public boolean removeResponse( DsmlDecorator<? extends Response> response )\n     {\n+        if ( response instanceof SearchResultEntry )\n+        {\n+            ( ( SearchResponse ) getDecorated() ).removeSearchResultEntry(\n+                ( SearchResultEntryDsml ) response );\n+        }\n+        else if ( response instanceof SearchResultReference )\n+        {\n+            ( ( SearchResponse ) getDecorated() ).removeSearchResultReference(\n+                ( SearchResultReferenceDsml ) response );\n+        }\n+        else if ( response instanceof SearchResultDone )\n+        {\n+            if ( response.equals( ( ( SearchResponse ) getDecorated() ).getSearchResultDone() ) )\n+            {\n+                ( ( SearchResponse ) getDecorated() ).setSearchResultDone( null );\n+            }\n+        }\n+        else\n+        {\n+            throw new IllegalArgumentException( \"Unidentified search resp type\" );\n+        }\n+\n         return responses.remove( response );\n     }\n ",
                "changes": 26
            }
        ],
        "unit_tests": [
            "SearchResponseTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "dsml/parser/src/test/java/org/apache/directory/shared/dsmlv2/searchResponse/SearchResponseTest.java",
        "buggy_files": [
            "dsml/parser/src/main/java/org/apache/directory/shared/dsmlv2/reponse/SearchResponse.java"
        ],
        "fixed": true
    }
]