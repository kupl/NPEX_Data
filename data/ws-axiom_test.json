{
    "ws-axiom_e5341a7": {
        "repo": "ws-axiom",
        "message": "Prevent NPE",
        "commit": "https://github.com/apache/ws-axiom/commit/e5341a76c6f3d17e46067af2546551fe63627a35",
        "parent": "https://github.com/apache/ws-axiom/commit/60f861511f93b48d0c28054444fc3102881c06c4",
        "bug_id": "ws-axiom_e5341a7",
        "file": [
            {
                "sha": "1250427d395fd2354eed7387611f60efa9809e7c",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/e5341a76c6f3d17e46067af2546551fe63627a35/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/e5341a76c6f3d17e46067af2546551fe63627a35/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java?ref=e5341a76c6f3d17e46067af2546551fe63627a35",
                "patch": "@@ -33,6 +33,7 @@\n import org.apache.axiom.om.util.ElementHelper;\n import org.w3c.dom.Attr;\n import org.w3c.dom.DOMException;\n+import org.w3c.dom.Document;\n import org.w3c.dom.Element;\n import org.w3c.dom.NamedNodeMap;\n import org.w3c.dom.Node;\n@@ -1277,6 +1278,7 @@ public NamedNodeMap getAttributes() {\n                 // check if the parent of this element has the same namespace\n                 // as the default and if NOT add the attr\n                 boolean parentHasSameDefaultNS = this.parentNode != null &&\n+                        this.parentNode.getNamespaceURI() != null &&\n                         this.parentNode.getNamespaceURI().equals(this.getNamespaceURI()) &&\n                         (this.parentNode.getPrefix() == null ||\n                                 this.parentNode.getPrefix().equals(\"\"));",
                "deletions": 0
            }
        ],
        "patched_files": [
            "ElementImpl.java"
        ],
        "unit_tests": [
            "ElementImplTest.java"
        ]
    },
    "ws-axiom_a3e2fce": {
        "repo": "ws-axiom",
        "message": "prevent NPE's in calling code, example AXIS2-2868",
        "commit": "https://github.com/apache/ws-axiom/commit/a3e2fce5d115ac85da31839738cb4d52315a1312",
        "parent": "https://github.com/apache/ws-axiom/commit/60b2ddf84bc56b0805626a1c3cc3be9dd6e155af",
        "bug_id": "ws-axiom_a3e2fce",
        "file": [
            {
                "sha": "ae26660df460140b87cd142338cd24a72957a827",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/a3e2fce5d115ac85da31839738cb4d52315a1312/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/a3e2fce5d115ac85da31839738cb4d52315a1312/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java?ref=a3e2fce5d115ac85da31839738cb4d52315a1312",
                "patch": "@@ -1157,7 +1157,7 @@ public Iterator getChildElements() {\n     /** @see org.apache.axiom.om.OMElement#getAllDeclaredNamespaces() */\n     public Iterator getAllDeclaredNamespaces() throws OMException {\n         if (namespaces == null) {\n-            return null;\n+            return EMPTY_ITERATOR;\n         }\n         return namespaces.values().iterator();\n     }",
                "deletions": 1
            }
        ],
        "patched_files": [
            "ElementImpl.java"
        ],
        "unit_tests": [
            "ElementImplTest.java"
        ]
    },
    "ws-axiom_6c68926": {
        "repo": "ws-axiom",
        "message": "Fix for WSCOMMONS-196 - NPE in StAXOMBuilder when parsing from DOMSource",
        "commit": "https://github.com/apache/ws-axiom/commit/6c68926bf2d299baac01428ceef9dd7b3d8b2896",
        "parent": "https://github.com/apache/ws-axiom/commit/f95a98853d88bb6c20912b3d5da191959c562688",
        "bug_id": "ws-axiom_6c68926",
        "file": [
            {
                "sha": "42701d1a7578d626c5179a8b2a331ed9d707eee5",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/6c68926bf2d299baac01428ceef9dd7b3d8b2896/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/6c68926bf2d299baac01428ceef9dd7b3d8b2896/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "status": "modified",
                "changes": 6,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java?ref=6c68926bf2d299baac01428ceef9dd7b3d8b2896",
                "patch": "@@ -33,6 +33,7 @@\n import javax.xml.stream.XMLStreamConstants;\r\n import javax.xml.stream.XMLStreamException;\r\n import javax.xml.stream.XMLStreamReader;\r\n+import javax.xml.stream.Location;\r\n import java.io.FileInputStream;\r\n import java.io.FileNotFoundException;\r\n import java.io.InputStream;\r\n@@ -222,7 +223,10 @@ private void populateOMElement(OMElement node) {\n         processNamespaceData(node);\r\n         // fill in the attributes\r\n         processAttributes(node);\r\n-        node.setLineNumber(parser.getLocation().getLineNumber());\r\n+        Location location = parser.getLocation();\r\n+        if(location != null) {\r\n+            node.setLineNumber(location.getLineNumber());\r\n+        }\r\n     }\r\n \r\n     /**\r",
                "deletions": 1
            }
        ],
        "patched_files": [
            "StAXOMBuilder.java"
        ],
        "unit_tests": [
            "StAXOMBuilderTest.java"
        ]
    },
    "ws-axiom_b19aff8": {
        "repo": "ws-axiom",
        "message": "Quick Fix\nContributor:Rich Scheuerle\nNPE in the custom builder code if the custom object is the root.\nThis is a one line change to use the document as the parent in such cases.",
        "commit": "https://github.com/apache/ws-axiom/commit/b19aff8f97575f08f27842cdf1df000fcddb09a4",
        "parent": "https://github.com/apache/ws-axiom/commit/8637d0d10366e1d9a160692acc1b6a0d7dc763ed",
        "bug_id": "ws-axiom_b19aff8",
        "file": [
            {
                "sha": "5e9ee156c89b1cf50669725674e84dc35b9be1e2",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/b19aff8f97575f08f27842cdf1df000fcddb09a4/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/b19aff8f97575f08f27842cdf1df000fcddb09a4/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "status": "modified",
                "changes": 3,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java?ref=b19aff8f97575f08f27842cdf1df000fcddb09a4",
                "patch": "@@ -283,7 +283,8 @@ protected OMNode createWithCustomBuilder(CustomBuilder customBuilder, OMFactory\n             } else {\r\n                 parent = (OMContainer)lastNode;\r\n             }\r\n-                \r\n+        } else {\r\n+            parent = document;\r\n         }\r\n         return customBuilder.create(namespace, localPart, parent, parser, factory);\r\n         \r",
                "deletions": 1
            }
        ],
        "patched_files": [
            "StAXOMBuilder.java"
        ],
        "unit_tests": [
            "StAXOMBuilderTest.java"
        ]
    },
    "ws-axiom_e991deb": {
        "repo": "ws-axiom",
        "message": "Quick Fix for an NPE\nAdded protection in the OMStAXWrapper.generateEvents method if the current node is null.\nAlso added more logging to OMElementImpl and OMNodeImpl.",
        "commit": "https://github.com/apache/ws-axiom/commit/e991deb22f02f9197e7c2f751c29390448e70114",
        "parent": "https://github.com/apache/ws-axiom/commit/a072d7cfad5d5ca0f41ed14c32cc6664c5a08651",
        "bug_id": "ws-axiom_e991deb",
        "file": [
            {
                "sha": "b8b0c93629857065e3696fc4d7fcd355e62ebc81",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "status": "modified",
                "changes": 18,
                "additions": 17,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java?ref=e991deb22f02f9197e7c2f751c29390448e70114",
                "patch": "@@ -1110,8 +1110,24 @@ public QName resolveQName(String qname) {\n     }\r\n \r\n     public OMElement cloneOMElement() {\r\n+        \r\n+        if (log.isDebugEnabled()) {\r\n+            log.debug(\"cloneOMElement start\");\r\n+            log.debug(\"  element string =\" + this.toString());\r\n+            log.debug(\" isComplete = \" + isComplete());\r\n+            log.debug(\"  builder = \" + builder);\r\n+        }\r\n+        // Make sure the source (this node) is completed\r\n+        if (!isComplete()) {\r\n+            this.build();\r\n+        }\r\n+        \r\n+        // Now get a parser for the full tree\r\n+        XMLStreamReader xmlStreamReader = this.getXMLStreamReader(true);\r\n+        \r\n+        // Build the (target) clonedElement from the parser\r\n         OMElement clonedElement =\r\n-                new StAXOMBuilder(this.getXMLStreamReader(true)).getDocumentElement();\r\n+                new StAXOMBuilder(xmlStreamReader).getDocumentElement();\r\n         clonedElement.build();\r\n         return clonedElement;\r\n     }\r",
                "deletions": 1
            },
            {
                "sha": "624e289e2dfb88f64cb47203f1c118e8d9162d7e",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMNodeImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMNodeImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMNodeImpl.java",
                "status": "modified",
                "changes": 8,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMNodeImpl.java?ref=e991deb22f02f9197e7c2f751c29390448e70114",
                "patch": "@@ -323,8 +323,14 @@ public void setPreviousOMSibling(OMNode previousSibling) {\n      * @throws OMException\r\n      */\r\n     public void build() throws OMException {\r\n+        if (builder != null && builder.isCompleted()) {\r\n+            if (DEBUG_ENABLED) {\r\n+                log.debug(\"Builder is already complete.\");\r\n+            }\r\n+        }\r\n         while (!done) {\r\n-            builder.next();\r\n+\r\n+            builder.next();    \r\n             if (builder.isCompleted() && !done) {\r\n                 if (DEBUG_ENABLED) {\r\n                     log.debug(\"Builder is complete.  Setting OMNode to complete.\");\r",
                "deletions": 1
            },
            {
                "sha": "b50a1ade200db2992e43ddbbdf41c2cd7324bbc9",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMStAXWrapper.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMStAXWrapper.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/e991deb22f02f9197e7c2f751c29390448e70114/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMStAXWrapper.java",
                "status": "modified",
                "changes": 15,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMStAXWrapper.java?ref=e991deb22f02f9197e7c2f751c29390448e70114",
                "patch": "@@ -1096,10 +1096,10 @@ private void updateNextNode() {\n             nextNode = navigator.next();\r\n         } else {\r\n             if (!switchingAllowed) {\r\n-                if (navigator.isCompleted() || builder.isCompleted()) {\r\n+                if (navigator.isCompleted() || builder == null || builder.isCompleted()) {\r\n                     nextNode = null;\r\n                     if (DEBUG_ENABLED) {\r\n-                        if (builder.isCompleted()) {\r\n+                        if (builder == null || builder.isCompleted()) {\r\n                             log.debug(\"Builder is complete.  Next node is set to null.\");\r\n                         }\r\n                     }\r\n@@ -1117,7 +1117,9 @@ private void updateNextNode() {\n                 } else {\r\n                     // reset caching (the default is ON so it was not needed in the\r\n                     // earlier case!\r\n-                    builder.setCache(false);\r\n+                    if (builder != null) {\r\n+                        builder.setCache(false);\r\n+                    }\r\n                     state = SWITCH_AT_NEXT;\r\n                 }\r\n             }\r\n@@ -1265,6 +1267,13 @@ public String getPIData() {\n      */\r\n     private int generateEvents(OMNode node) {\r\n         int returnEvent = 0;\r\n+        if (node == null) {\r\n+            if (log.isDebugEnabled()) {\r\n+                log.debug(\"Node is null...returning END_DOCUMENT\");\r\n+            }\r\n+            returnEvent = END_DOCUMENT;\r\n+            return returnEvent;\r\n+        }\r\n         int nodeType = node.getType();\r\n         switch (nodeType) {\r\n             case OMNode.ELEMENT_NODE:\r",
                "deletions": 3
            }
        ],
        "patched_files": [
            "OMStAXWrapper.java"
        ],
        "unit_tests": [
            "OMStAXWrapperTest.java"
        ]
    },
    "ws-axiom_9567e52": {
        "repo": "ws-axiom",
        "message": "Fixed a potential NullPointerException when debug logs are enabled.",
        "commit": "https://github.com/apache/ws-axiom/commit/9567e52059e79fe3dddbe89c567d7c9e9275aaab",
        "parent": "https://github.com/apache/ws-axiom/commit/35876c9717b2e6f5240c2e152fdecbce6d51d0b7",
        "bug_id": "ws-axiom_9567e52",
        "file": [
            {
                "sha": "7d76af589f7a791c71b0e11552e569f095ce06de",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/9567e52059e79fe3dddbe89c567d7c9e9275aaab/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/9567e52059e79fe3dddbe89c567d7c9e9275aaab/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "status": "modified",
                "changes": 13,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java?ref=9567e52059e79fe3dddbe89c567d7c9e9275aaab",
                "patch": "@@ -198,10 +198,11 @@ public int next() throws OMException {\n                 return token;\n             }\n            \n-            // The current token should be the same as the \n-            // one just obtained.  This bit of code is used to \n-            // detect invalid parser state.\n-            if (doTrace) {\n+            // Note: if autoClose is enabled, then the parser may be null at this point\n+            if (doTrace && parser != null) {\n+                // The current token should be the same as the \n+                // one just obtained.  This bit of code is used to \n+                // detect invalid parser state.\n                 int currentParserToken = parser.getEventType();\n                 if (currentParserToken != token) {\n \n@@ -218,10 +219,8 @@ public int next() throws OMException {\n                                      \"The parser is \" + parser);\n                      */\n                 }\n-            }\n             \n-            // Now log the current state of the parser\n-            if (doTrace) {\n+                // Now log the current state of the parser\n                 logParserState();\n             }\n            ",
                "deletions": 7
            }
        ],
        "patched_files": [
            "StAXOMBuilder.java"
        ],
        "unit_tests": [
            "StAXOMBuilderTest.java"
        ]
    },
    "ws-axiom_39f1b33": {
        "repo": "ws-axiom",
        "message": "Fix potential NPE during serialization if an encoding has not been set for the OMOutputFormat.",
        "commit": "https://github.com/apache/ws-axiom/commit/39f1b33605414684db925c34b9dc53508ac5c915",
        "parent": "https://github.com/apache/ws-axiom/commit/e1b5c240c8c3e31a6636c2e52926e9c89972d9ac",
        "bug_id": "ws-axiom_39f1b33",
        "file": [
            {
                "sha": "31c388b242abaea62caf68df4312a165c2ee10c9",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/39f1b33605414684db925c34b9dc53508ac5c915/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/39f1b33605414684db925c34b9dc53508ac5c915/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java?ref=39f1b33605414684db925c34b9dc53508ac5c915",
                "patch": "@@ -214,7 +214,7 @@ public String getNextContentId() {\n      * @return Returns encoding string.\n      */\n     public String getCharSetEncoding() {\n-        return this.charSetEncoding;\n+        return (this.charSetEncoding != null)?this.charSetEncoding:DEFAULT_CHAR_SET_ENCODING;\n     }\n \n     public void setCharSetEncoding(String charSetEncoding) {",
                "deletions": 1
            },
            {
                "sha": "e0c7f744906721abc13068046c829c38666f8f20",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/39f1b33605414684db925c34b9dc53508ac5c915/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/39f1b33605414684db925c34b9dc53508ac5c915/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "status": "modified",
                "changes": 10,
                "additions": 9,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java?ref=39f1b33605414684db925c34b9dc53508ac5c915",
                "patch": "@@ -139,7 +139,15 @@ public void testByteArrayDS() throws Exception {\n         String payload = new String(bytes, \"utf-16\");\n         assertTrue(\"The obtained bytes did not match the payload\",\n                    payload1.equals(payload));\n-        \n+\n+        // Test getting the raw bytes with the default encoding\n+        OMOutputFormat outputFormat = new OMOutputFormat();\n+        baos = new ByteArrayOutputStream();\n+        ds.serialize(baos, outputFormat);\n+        output = baos.toString(OMOutputFormat.DEFAULT_CHAR_SET_ENCODING);\n+        System.out.println(output);\n+        assertTrue(\"The obtained bytes did not match the payload\",\n+                   payload1.equals(output));     \n     }\n     \n     /**",
                "deletions": 1
            }
        ],
        "patched_files": [
            "OMOutputFormat.java",
            "OMSourcedElement.java"
        ],
        "unit_tests": [
            "OMSourcedElementTest.java",
            "OMOutputFormatTest.java"
        ]
    },
    "ws-axiom_6eb0aa8": {
        "repo": "ws-axiom",
        "message": "WSCOMMONS-303\nContributor: Rich Scheuerle\nFix for NPE and SOAPFaultException revealed by Axis2 Continuum",
        "commit": "https://github.com/apache/ws-axiom/commit/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd",
        "parent": "https://github.com/apache/ws-axiom/commit/1fd2634df0e3d30f207884b6b03aaa7f79e78861",
        "bug_id": "ws-axiom_6eb0aa8",
        "file": [
            {
                "sha": "2e1a5df8725c97e6b55589b9411989d7e9eaba68",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java",
                "status": "modified",
                "changes": 4,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/builder/StAXOMBuilder.java?ref=6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd",
                "patch": "@@ -532,4 +532,8 @@ public boolean lookahead()  {\n             throw new OMException(e);\r\n         }\r\n     }\r\n+    \r\n+    public boolean isLookahead() {\r\n+        return lookAheadToken >= 0;\r\n+    }\r\n }\r",
                "deletions": 0
            },
            {
                "sha": "d47157907ba3613b7e623fc1ba74fff072bcf623",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/StAXSOAPModelBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/StAXSOAPModelBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/StAXSOAPModelBuilder.java",
                "status": "modified",
                "changes": 3,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/StAXSOAPModelBuilder.java?ref=6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd",
                "patch": "@@ -202,6 +202,7 @@ protected OMNode createNextOMElement() {\n      * @throws OMException\r\n      */\r\n     protected OMNode createOMElement() throws OMException {\r\n+        \r\n         OMElement node;\r\n         String elementName = parser.getLocalName();\r\n         if (lastNode == null) {\r\n@@ -354,7 +355,6 @@ protected OMElement constructNode(OMElement parent, String elementName,\n         } else if ((elementLevel == 3) &&\r\n                 parent.getLocalName().equals(SOAPConstants.BODY_LOCAL_NAME) &&\r\n                 elementName.equals(SOAPConstants.BODY_FAULT_LOCAL_NAME)) {\r\n-\r\n             // this is a headerblock\r\n             element = soapFactory.createSOAPFault((SOAPBody) parent, this);\r\n             processNamespaceData(element, false);\r\n@@ -373,7 +373,6 @@ protected OMElement constructNode(OMElement parent, String elementName,\n         } else if (elementLevel > 3 && processingFault) {\r\n             element = builderHelper.handleEvent(parser, parent, elementLevel);\r\n         } else {\r\n-\r\n             // this is neither of above. Just create an element\r\n             element = soapFactory.createOMElement(elementName, null,\r\n                                                   parent, this);\r",
                "deletions": 2
            },
            {
                "sha": "c0be0f3ee26786562aed81c16456073e2269a3c2",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java?ref=6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd",
                "patch": "@@ -713,6 +713,11 @@ public XMLStreamReader getXMLStreamReaderWithoutCaching() {\n      * @return Returns reader.\r\n      */\r\n     private XMLStreamReader getXMLStreamReader(boolean cache) {\r\n+        if (builder != null && this.builder instanceof StAXOMBuilder) {\r\n+            if (((StAXOMBuilder) builder).isLookahead()) {\r\n+                this.buildNext();\r\n+            }\r\n+        }\r\n         // The om tree was built by hand and is already complete\r\n         if ((builder == null) && done) {\r\n             return new OMStAXWrapper(null, this, false);\r",
                "deletions": 0
            },
            {
                "sha": "64f1e0851cb28cc7ff2b77a3b45419276ebbf3c1",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java?ref=6eb0aa87e44e1e6cb1eb94855010d94cc4a8bddd",
                "patch": "@@ -191,7 +191,9 @@ private boolean hasLookahead() {\n             lookAheadSuccessful = soapBuilder.lookahead();\r\n             if (lookAheadSuccessful) {\r\n                 this.lookAheadLocalName = soapBuilder.getName();\r\n-                this.lookAheadNS = factory.createOMNamespace(soapBuilder.getNamespace(), \r\n+                String ns = soapBuilder.getNamespace();\r\n+                ns = (ns == null) ? \"\" : ns;\r\n+                this.lookAheadNS = factory.createOMNamespace(ns, \r\n                                                              soapBuilder.getPrefix());\r\n             }\r\n         }\r",
                "deletions": 1
            }
        ],
        "patched_files": [
            "StAXSOAPModelBuilder.java",
            "StAXOMBuilder.java"
        ],
        "unit_tests": [
            "StAXOMBuilderTest.java",
            "StAXSOAPModelBuilderTest.java"
        ]
    },
    "ws-axiom_a764ce2": {
        "repo": "ws-axiom",
        "message": "Revised patch for fixing potential NPE during serialization if an encoding has not been set for the OMOutputFormat.",
        "commit": "https://github.com/apache/ws-axiom/commit/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1",
        "parent": "https://github.com/apache/ws-axiom/commit/943bf918ac8dfc7f11945eb21753b2f3829ace43",
        "bug_id": "ws-axiom_a764ce2",
        "file": [
            {
                "sha": "86a96a6cb8859241179f9bc84f11844dde024604",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java",
                "status": "modified",
                "changes": 5,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/OMOutputFormat.java?ref=a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1",
                "patch": "@@ -208,10 +208,9 @@ public String getNextContentId() {\n     }\n \n     /**\n-     * Returns the character set encoding scheme. If the value of the charSetEncoding is not set\n-     * then the default will be returned.\n+     * Returns the character set encoding scheme.\n      *\n-     * @return Returns encoding string.\n+     * @return Returns encoding string or null if it has not been set.\n      */\n     public String getCharSetEncoding() {\n         return this.charSetEncoding;",
                "deletions": 3
            },
            {
                "sha": "361f707dc2a90c2e26cdfae80726e1c125417939",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/ds/ByteArrayDataSource.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-api/src/main/java/org/apache/axiom/om/ds/ByteArrayDataSource.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-api/src/main/java/org/apache/axiom/om/ds/ByteArrayDataSource.java",
                "status": "modified",
                "changes": 7,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/ds/ByteArrayDataSource.java?ref=a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1",
                "patch": "@@ -19,6 +19,7 @@\n package org.apache.axiom.om.ds;\n \n import org.apache.axiom.om.OMDataSourceExt;\n+import org.apache.axiom.om.OMOutputFormat;\n import org.apache.axiom.om.util.StAXUtils;\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n@@ -77,9 +78,15 @@ public boolean isDestructiveWrite() {\n     }\n \n     public byte[] getXMLBytes(String encoding) throws UnsupportedEncodingException {\n+        if (encoding == null)\n+        {\n+          encoding = OMOutputFormat.DEFAULT_CHAR_SET_ENCODING;\n+        }\n+\n         if (DEBUG_ENABLED) {\n             log.debug(\"getXMLBytes encoding=\"+encoding);\n         }\n+\n         // Return the byte array directly if it is the same encoding\n         // Otherwise convert the bytes to the proper encoding\n         if (!byteArray.encoding.equalsIgnoreCase(encoding)) {",
                "deletions": 0
            },
            {
                "sha": "8e2b7810f43cac260db0671be9da773d8f1ef4bf",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java",
                "status": "modified",
                "changes": 9,
                "additions": 9,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/OMSourcedElementTest.java?ref=a764ce2c6d6fb87c023e6269eabd8c393dfc2fd1",
                "patch": "@@ -140,6 +140,15 @@ public void testByteArrayDS() throws Exception {\n         assertTrue(\"The obtained bytes did not match the payload\",\n                    payload1.equals(payload));\n         \n+       \n+        // Test getting the raw bytes with the default encoding\n+        OMOutputFormat outputFormat = new OMOutputFormat();\n+        baos = new ByteArrayOutputStream();\n+        ds.serialize(baos, outputFormat);\n+        output = baos.toString(OMOutputFormat.DEFAULT_CHAR_SET_ENCODING);\n+        System.out.println(output);\n+        assertTrue(\"The obtained bytes did not match the payload\",\n+                   payload1.equals(output));     \n     }\n     \n     /**",
                "deletions": 0
            }
        ],
        "patched_files": [
            "OMOutputFormat.java",
            "OMSourcedElement.java",
            "ByteArrayDataSource.java"
        ],
        "unit_tests": [
            "OMSourcedElementTest.java",
            "OMOutputFormatTest.java"
        ]
    },
    "ws-axiom_2bd1eb8": {
        "repo": "ws-axiom",
        "message": "Make sure a created DocumentFragment is \"done\"\nPrevent NPE in child node by checking for a null parent before checking its completness\nFix for WSCOMMONS-105 - Thanks C Corvin\nSerialize a soap 12 fault with normally with serilization logic inherited from ElementImpl - possible fix for WSCOMMONS-106",
        "commit": "https://github.com/apache/ws-axiom/commit/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
        "parent": "https://github.com/apache/ws-axiom/commit/c9fe635b0929d1a065e63e3e7fb33772b7db453e",
        "bug_id": "ws-axiom_2bd1eb8",
        "file": [
            {
                "sha": "05358c865d42a1944d9d53ebfacc8e32cca0f790",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/AttrImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/AttrImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/AttrImpl.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/AttrImpl.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -149,7 +149,7 @@ public String getValue() {\n     // /\n     public String getName() {\n         return (this.namespace == null) ? this.attrName\n-                : OMConstants.XMLNS_NS_PREFIX + \":\" + this.attrName;\n+                : (OMConstants.XMLNS_NS_PREFIX.equals(this.attrName) ? this.attrName : OMConstants.XMLNS_NS_PREFIX + \":\" + this.attrName);\n     }\n \n     /**",
                "deletions": 1
            },
            {
                "sha": "bffb5cfabfcd8032ac3f5241df0a2e90d57b9e64",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ChildNode.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ChildNode.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ChildNode.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ChildNode.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -42,7 +42,7 @@ protected ChildNode(OMFactory factory) {\n     }\n \n     public OMNode getNextOMSibling() throws OMException {\n-        while ((nextSibling == null) && !this.parentNode.done) {\n+        while (nextSibling == null && this.parentNode != null && !this.parentNode.done) {\n             this.parentNode.buildNext();\n         }\n         return nextSibling;",
                "deletions": 1
            },
            {
                "sha": "fc4cab7f6be69721a98daf9c3453adce986af826",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/DocumentFragmentimpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/DocumentFragmentimpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/DocumentFragmentimpl.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/DocumentFragmentimpl.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -31,6 +31,7 @@\n      */\n     public DocumentFragmentimpl(DocumentImpl ownerDocument, OMFactory factory) {\n         super(ownerDocument, factory);\n+        this.done = true;\n     }\n \n     /*",
                "deletions": 0
            },
            {
                "sha": "50b699bda313c6f20e188b96d151af0d3bfb8c29",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ParentNode.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ParentNode.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ParentNode.java",
                "status": "modified",
                "changes": 17,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ParentNode.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -296,14 +296,18 @@ public Node replaceChild(Node newChild, Node oldChild) throws DOMException {\n         ChildNode newDomChild = (ChildNode) newChild;\n         ChildNode oldDomChild = (ChildNode) oldChild;\n \n+        if(newChild == null) {\n+            return this.removeChild(oldChild);\n+        }\n+        \n         if (this == newChild || !isAncestor(newChild)) {\n             throw new DOMException(DOMException.HIERARCHY_REQUEST_ERR,\n                     DOMMessageFormatter.formatMessage(\n                             DOMMessageFormatter.DOM_DOMAIN,\n                             \"HIERARCHY_REQUEST_ERR\", null));\n         }\n \n-        if (!this.ownerNode.equals(newDomChild.ownerNode)) {\n+        if (newDomChild != null && !this.ownerNode.equals(newDomChild.ownerNode)) {\n             throw new DOMException(DOMException.WRONG_DOCUMENT_ERR,\n                     DOMMessageFormatter.formatMessage(\n                             DOMMessageFormatter.DOM_DOMAIN,\n@@ -326,13 +330,13 @@ public Node replaceChild(Node newChild, Node oldChild) throws DOMException {\n                     DocumentFragmentimpl docFrag = \n                                             (DocumentFragmentimpl) newDomChild;\n                     ChildNode child = (ChildNode) docFrag.getFirstChild();\n-                    child.parentNode = this;\n                     this.replaceChild(child, oldChild);\n+                    if(child != null) {\n+                        child.parentNode = this;\n+                    }\n                 } else {\n                     if (this.firstChild == oldDomChild) {\n                         \n-                        newDomChild.parentNode = this;\n-                        \n                         if(this.firstChild.nextSibling != null) {\n                             this.firstChild.nextSibling.previousSibling = newDomChild;\n                             newDomChild.nextSibling = this.firstChild.nextSibling;\n@@ -358,10 +362,9 @@ public Node replaceChild(Node newChild, Node oldChild) throws DOMException {\n                             this.lastChild = newDomChild;\n                         }\n \n-                        if (newDomChild.parentNode == null) {\n-                            newDomChild.parentNode = this;\n-                        }\n                     }\n+                \n+                    newDomChild.parentNode = this;\n                 }\n                 found = true;\n ",
                "deletions": 7
            },
            {
                "sha": "5f7a49025cd42058b402262ed9ae934d88cb4764",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPFaultCodeImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPFaultCodeImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPFaultCodeImpl.java",
                "status": "modified",
                "changes": 42,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPFaultCodeImpl.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -76,46 +76,4 @@ public SOAPFaultSubCode getSubCode() {\n                 SOAP12Constants.SOAP_FAULT_SUB_CODE_LOCAL_NAME);\n     }\n \n-    protected void internalSerialize(XMLStreamWriter writer, boolean cache) throws XMLStreamException {\n-        // select the builder\n-        short builderType = PULL_TYPE_BUILDER;    // default is pull type\n-        if (builder != null) {\n-            builderType = this.builder.getBuilderType();\n-        }\n-        if ((builderType == PUSH_TYPE_BUILDER)\n-                && (builder.getRegisteredContentHandler() == null)) {\n-            builder.registerExternalContentHandler(new StreamWriterToContentHandlerConverter(writer));\n-        }\n-\n-        if (!cache) {\n-            //No caching\n-            if (this.firstChild != null) {\n-                OMSerializerUtil.serializeStartpart(this, writer);\n-                firstChild.internalSerializeAndConsume(writer);\n-                OMSerializerUtil.serializeEndpart(writer);\n-            } else if (!this.done) {\n-                if (builderType == PULL_TYPE_BUILDER) {\n-                    OMSerializerUtil.serializeByPullStream(this, writer);\n-                } else {\n-                    OMSerializerUtil.serializeStartpart(this, writer);\n-                    builder.setCache(cache);\n-                    builder.next();\n-                    OMSerializerUtil.serializeEndpart(writer);\n-                }\n-            } else {\n-                OMSerializerUtil.serializeNormal(this, writer, cache);\n-            }\n-            // do not serialise the siblings\n-\n-\n-        } else {\n-            //Cached\n-            OMSerializerUtil.serializeNormal(this, writer, cache);\n-\n-            // do not serialise the siblings\n-        }\n-\n-\n-    }\n-\n }",
                "deletions": 42
            },
            {
                "sha": "d5c473e7a755bb5a86b8515b34bb11cc2e877e76",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/CompareOMWithDOMTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-tests/src/test/java/org/apache/axiom/om/CompareOMWithDOMTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1/modules/axiom-tests/src/test/java/org/apache/axiom/om/CompareOMWithDOMTest.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/CompareOMWithDOMTest.java?ref=2bd1eb8ec2b202cd4fc7cbf686b166dec5fa72c1",
                "patch": "@@ -40,6 +40,7 @@ public void testAllMessagesInSOAP() throws OMException, Exception {\n         if (files != null) {\r\n             for (int i = 0; i < files.length; i++) {\r\n                 if (files[i].isFile() && files[i].getName().endsWith(\".xml\") && !files[i].getName().startsWith(\"wrong\")) {\r\n+                    System.out.println(files[i].getAbsolutePath());\r\n                     SOAPEnvelope soapEnvelope = (SOAPEnvelope) OMTestUtils.getOMBuilder(\r\n                             files[i])\r\n                             .getDocumentElement();\r",
                "deletions": 0
            }
        ],
        "patched_files": [
            "SOAPFaultCodeImpl.java",
            "DocumentFragmentimpl.java",
            "ChildNode.java",
            "AttrImpl.java",
            "ParentNode.java"
        ],
        "unit_tests": [
            "CompareOMWithDOMTest.java"
        ]
    },
    "ws-axiom_65bdfc7": {
        "repo": "ws-axiom",
        "message": "AXIOM-423: Fixed a NullPointerException.",
        "commit": "https://github.com/apache/ws-axiom/commit/65bdfc79283d62052adef2da5a04096af8a1e05a",
        "parent": "https://github.com/apache/ws-axiom/commit/faf1ec9f0ffc125f90492ee0adab00e911bee3c6",
        "bug_id": "ws-axiom_65bdfc7",
        "file": [
            {
                "sha": "8d2899f04e77e2b4c9effe62b2cc0d52baf887e8",
                "filename": "modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java?ref=65bdfc79283d62052adef2da5a04096af8a1e05a",
                "patch": "@@ -39,6 +39,7 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.dom.attr.TestGetFirstChild(dbf));\n         addTest(new org.apache.axiom.ts.dom.attr.TestGetValueWithMultipleChildren(dbf));\n         addTest(new org.apache.axiom.ts.dom.attr.TestLookupNamespaceURI(dbf));\n+        addTest(new org.apache.axiom.ts.dom.attr.TestLookupNamespaceURIWithoutOwnerElement(dbf));\n         addTest(new org.apache.axiom.ts.dom.attr.TestSetPrefixNotNullWithNamespace(dbf));\n         addTest(new org.apache.axiom.ts.dom.attr.TestSetPrefixNotNullWithoutNamespace(dbf));\n         addTest(new org.apache.axiom.ts.dom.builder.TestParseURI(dbf));",
                "deletions": 0
            },
            {
                "sha": "62cd46f96c3fea2c3cf5afb3f86451703618f393",
                "filename": "modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/attr/TestLookupNamespaceURIWithoutOwnerElement.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/attr/TestLookupNamespaceURIWithoutOwnerElement.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/attr/TestLookupNamespaceURIWithoutOwnerElement.java",
                "status": "added",
                "changes": 42,
                "additions": 42,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/attr/TestLookupNamespaceURIWithoutOwnerElement.java?ref=65bdfc79283d62052adef2da5a04096af8a1e05a",
                "patch": "@@ -0,0 +1,42 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.dom.attr;\n+\n+import javax.xml.parsers.DocumentBuilderFactory;\n+\n+import org.apache.axiom.ts.dom.DOMTestCase;\n+import org.w3c.dom.Attr;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+\n+/**\n+ * Tests the behavior of {@link Node#lookupNamespaceURI(String)} on an attribute node that has no\n+ * owner element.\n+ */\n+public class TestLookupNamespaceURIWithoutOwnerElement extends DOMTestCase {\n+    public TestLookupNamespaceURIWithoutOwnerElement(DocumentBuilderFactory dbf) {\n+        super(dbf);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        Document document = dbf.newDocumentBuilder().newDocument();\n+        Attr attr = document.createAttributeNS(\"urn:test\", \"p:attr\");\n+        assertNull(attr.lookupNamespaceURI(\"p\"));\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "f9399866ac49ed0d02991c95e35ab1e51f34ded8",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/65bdfc79283d62052adef2da5a04096af8a1e05a/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "status": "modified",
                "changes": 8,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java?ref=65bdfc79283d62052adef2da5a04096af8a1e05a",
                "patch": "@@ -309,12 +309,8 @@ public String lookupNamespaceURI(String specifiedPrefix) {\n             // type is unknown\n             return null;\n         case Node.ATTRIBUTE_NODE: {\n-            NodeImpl ownerNode = (NodeImpl) ((Attr) this).getOwnerElement();\n-            if (ownerNode.getNodeType() == Node.ELEMENT_NODE) {\n-                return ownerNode.lookupNamespaceURI(specifiedPrefix);\n-\n-            }\n-            return null;\n+            Element ownerElement = ((Attr) this).getOwnerElement();\n+            return ownerElement == null ? null : ownerElement.lookupNamespaceURI(specifiedPrefix);\n         }\n         default: {\n             NodeImpl ancestor = (NodeImpl) getElementAncestor(this);",
                "deletions": 6
            }
        ],
        "patched_files": [
            "DOMTestSuiteBuilder.java",
            "NodeImpl.java"
        ],
        "unit_tests": [
            "TestLookupNamespaceURIWithoutOwnerElement.java"
        ]
    },
    "ws-axiom_24b680b": {
        "repo": "ws-axiom",
        "message": "- Prevent NPE in SOAPBuilderHelper\n- Special case for XMLNS_PREFIX since sjsxp does not seem to turn the correct prefix for xml uri in OMSerializerUtil\n- Check for xml being equal instead of explicit byte-by-byte in OMSourcedElementTest\n- add a new prefix in OMOutputTest since the same prefix was being used in 2 spots.",
        "commit": "https://github.com/apache/ws-axiom/commit/24b680b32ff99e6ced264fb28384147134faf025",
        "parent": "https://github.com/apache/ws-axiom/commit/89d731e097a2cbc22d2efe1acc6431ab7fb72ffa",
        "bug_id": "ws-axiom_24b680b",
        "file": [
            {
                "sha": "3a00cec6fc371f5057d122db8deb5e43e7ab3e5b",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/impl/util/OMSerializerUtil.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/util/OMSerializerUtil.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/util/OMSerializerUtil.java",
                "status": "modified",
                "changes": 4,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/impl/util/OMSerializerUtil.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -23,6 +23,7 @@\n import org.apache.axiom.om.OMElement;\n import org.apache.axiom.om.OMNamespace;\n import org.apache.axiom.om.OMNode;\n+import org.apache.axiom.om.OMConstants;\n import org.apache.axiom.om.impl.serialize.StreamingOMSerializer;\n \n import javax.xml.namespace.NamespaceContext;\n@@ -379,6 +380,9 @@ public static void serializeStartpart(OMElement element, String localName,\n                 }\n             }\n             if (namespace != null) {\n+                if(prefix == null && OMConstants.XMLNS_URI.equals(namespace)){\n+                    prefix = OMConstants.XMLNS_PREFIX;\n+                }\n                 // Qualified attribute\n                 writer.writeAttribute(prefix, namespace,\n                                       attr.getLocalName(),",
                "deletions": 0
            },
            {
                "sha": "b163817f0c456fa983fde8ad87877843dd6306a0",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/SOAPBuilderHelper.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/SOAPBuilderHelper.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/SOAPBuilderHelper.java",
                "status": "modified",
                "changes": 10,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/soap/impl/builder/SOAPBuilderHelper.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -43,8 +43,12 @@ public abstract OMElement handleEvent(XMLStreamReader parser,\n     protected void processNamespaceData(OMElement node, boolean checkSOAPNamespace) {\r\n         int namespaceCount = parser.getNamespaceCount();\r\n         for (int i = 0; i < namespaceCount; i++) {\r\n-            node.declareNamespace(parser.getNamespaceURI(i),\r\n-                                  parser.getNamespacePrefix(i));\r\n+            String nsp = parser.getNamespaceURI(i);\r\n+            String prefix = parser.getNamespacePrefix(i);\r\n+            if(nsp != null && prefix != null) {\r\n+                node.declareNamespace(nsp,\r\n+                        prefix);\r\n+            }\r\n         }\r\n \r\n         // set the own namespace\r\n@@ -62,8 +66,6 @@ protected void processNamespaceData(OMElement node, boolean checkSOAPNamespace)\n                 namespace = node.findNamespace(namespaceURI, prefix);\r\n             }\r\n             node.setNamespace(namespace);\r\n-        } else {\r\n-\r\n         }\r\n \r\n         // TODO we got to have this to make sure OM reject mesagess that are not name space qualified\r",
                "deletions": 4
            },
            {
                "sha": "aba813929de4d1edf01de61a9780a9af6bb6eb14",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/AbstractTestCase.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/AbstractTestCase.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/AbstractTestCase.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/AbstractTestCase.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -23,9 +23,11 @@\n \r\n import java.io.File;\r\n \r\n+import org.custommonkey.xmlunit.XMLTestCase;\r\n+\r\n /** Abstract base class for test cases. */\r\n public abstract class AbstractTestCase\r\n-        extends TestCase {\r\n+        extends XMLTestCase {\r\n     protected String testDir = \"test\" + File.separator;\r\n     protected String sampleDir = \"samples\" + File.separator;\r\n     protected String outDir = \"target\" + File.separator + \"generated\" +\r",
                "deletions": 1
            },
            {
                "sha": "be3cf4ca37ac9de81763622d934c117ff4326d7e",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMOutputTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMOutputTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMOutputTest.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMOutputTest.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -73,7 +73,7 @@ protected void setUp() throws Exception {\n         OMElement data = new OMElementImpl(\"data\", dataName, fac);\r\n \r\n         OMNamespaceImpl mime = new OMNamespaceImpl(\r\n-                \"http://www.w3.org/2003/06/xmlmime\", \"m\");\r\n+                \"http://www.w3.org/2003/06/xmlmime\", \"mime\");\r\n \r\n         OMElement text = new OMElementImpl(\"name\", dataName, fac);\r\n         OMAttribute cType1 = new OMAttributeImpl(\"contentType\", mime,\r",
                "deletions": 1
            },
            {
                "sha": "8d45201a20e537731136151f3afc47788c0e33fe",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMSourcedElementTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMSourcedElementTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMSourcedElementTest.java",
                "status": "modified",
                "changes": 16,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/om/impl/llom/OMSourcedElementTest.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -139,12 +139,12 @@ public void testSerializeToStream() throws Exception {\n         ByteArrayOutputStream bos = new ByteArrayOutputStream();\r\n         element.serialize(bos);\r\n         String newText = new String(bos.toByteArray());\r\n-        assertEquals(\"Serialized text error\", testDocument, newText);\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, newText);\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n \r\n         bos = new ByteArrayOutputStream();\r\n         element.serialize(bos);\r\n-        assertEquals(\"Serialized text error\", testDocument,\r\n+        assertXMLEqual(\"Serialized text error\", testDocument,\r\n                      new String(bos.toByteArray()));\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n     }\r\n@@ -171,13 +171,13 @@ public void testSerializeToWriter() throws Exception {\n         StringWriter writer = new StringWriter();\r\n         element.serialize(writer);\r\n         String result = writer.toString();\r\n-        assertEquals(\"Serialized text error\", testDocument, result);\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, result);\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n \r\n         writer = new StringWriter();\r\n         element.serialize(writer);\r\n         result = writer.toString();\r\n-        assertEquals(\"Serialized text error\", testDocument, result);\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, result);\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n     }\r\n \r\n@@ -190,7 +190,7 @@ public void testSerializeAndConsumeToWriter() throws Exception {\n         StringWriter writer = new StringWriter();\r\n         element.serializeAndConsume(writer);\r\n         String result = writer.toString();\r\n-        assertEquals(\"Serialized text error\", testDocument, result);\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, result);\r\n         assertFalse(\"Element expansion when serializing\", element.isExpanded());\r\n     }\r\n \r\n@@ -204,14 +204,14 @@ public void testSerializeToXMLWriter() throws Exception {\n         XMLStreamWriter xmlwriter = XMLOutputFactory.newInstance().createXMLStreamWriter(writer);\r\n         element.serialize(writer);\r\n         xmlwriter.flush();\r\n-        assertEquals(\"Serialized text error\", testDocument, writer.toString());\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, writer.toString());\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n \r\n         writer = new StringWriter();\r\n         xmlwriter = XMLOutputFactory.newInstance().createXMLStreamWriter(writer);\r\n         element.serialize(writer);\r\n         xmlwriter.flush();\r\n-        assertEquals(\"Serialized text error\", testDocument, writer.toString());\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, writer.toString());\r\n         assertTrue(\"Element not expanded when serializing\", element.isExpanded());\r\n     }\r\n \r\n@@ -225,7 +225,7 @@ public void testSerializeAndConsumeToXMLWriter() throws Exception {\n         XMLStreamWriter xmlwriter = XMLOutputFactory.newInstance().createXMLStreamWriter(writer);\r\n         element.serializeAndConsume(writer);\r\n         xmlwriter.flush();\r\n-        assertEquals(\"Serialized text error\", testDocument, writer.toString());\r\n+        assertXMLEqual(\"Serialized text error\", testDocument, writer.toString());\r\n         assertFalse(\"Element expansion when serializing\", element.isExpanded());\r\n     }\r\n \r",
                "deletions": 8
            },
            {
                "sha": "350cd9b4a58944da065e8d5cc93eed6505895219",
                "filename": "modules/axiom-tests/src/test/java/org/apache/axiom/soap/SOAP11FaultImplConversionTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/soap/SOAP11FaultImplConversionTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/24b680b32ff99e6ced264fb28384147134faf025/modules/axiom-tests/src/test/java/org/apache/axiom/soap/SOAP11FaultImplConversionTest.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-tests/src/test/java/org/apache/axiom/soap/SOAP11FaultImplConversionTest.java?ref=24b680b32ff99e6ced264fb28384147134faf025",
                "patch": "@@ -35,7 +35,9 @@\n     public void testConversion() {\n         try {\n             InputStream is = new FileInputStream(soap11FaulXmlPath);\n-            XMLStreamReader reader = XMLInputFactory.newInstance().createXMLStreamReader(is);\n+            XMLInputFactory xmlInputFactory = XMLInputFactory.newInstance();\n+            xmlInputFactory.setProperty(XMLInputFactory.IS_NAMESPACE_AWARE, Boolean.TRUE) ;\n+            XMLStreamReader reader = xmlInputFactory.createXMLStreamReader(is);\n \n             SOAPEnvelope env = new StAXSOAPModelBuilder(reader, null).getSOAPEnvelope();\n ",
                "deletions": 1
            }
        ],
        "patched_files": [
            "SOAPBuilderHelper.java",
            "OMSerializerUtil.java",
            "AbstractTestCase.java"
        ],
        "unit_tests": [
            "SOAP11FaultImplConversionTest.java",
            "OMOutputTest.java",
            "OMSourcedElementTest.java"
        ]
    },
    "ws-axiom_d49ab20": {
        "repo": "ws-axiom",
        "message": "Fixed an issue in DOOM causing a NPE when attempting to create an OMComment or OMProcessingInstruction without a parent.",
        "commit": "https://github.com/apache/ws-axiom/commit/d49ab202444f0184e2757c398c60aa7a0a079ba7",
        "parent": "https://github.com/apache/ws-axiom/commit/46577906748ab74078363b193c67dd5495228b7e",
        "bug_id": "ws-axiom_d49ab20",
        "file": [
            {
                "sha": "7deeeb5b3cdd671d0db277a922aa3d79c9320685",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/factory/OMDOMFactory.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/factory/OMDOMFactory.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/factory/OMDOMFactory.java",
                "status": "modified",
                "changes": 13,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/factory/OMDOMFactory.java?ref=d49ab202444f0184e2757c398c60aa7a0a079ba7",
                "patch": "@@ -387,13 +387,17 @@ public OMProcessingInstruction createOMProcessingInstruction(\n             OMContainer parent, String piTarget, String piData) {\n         ProcessingInstructionImpl pi =\n             new ProcessingInstructionImpl(getDocumentFromParent(parent), piTarget, piData, this);\n-        parent.addChild(pi);\n+        if (parent != null) {\n+            parent.addChild(pi);\n+        }\n         return pi;\n     }\n \n     public OMComment createOMComment(OMContainer parent, String content) {\n         CommentImpl comment = new CommentImpl(getDocumentFromParent(parent), content, this);\n-        parent.addChild(comment);\n+        if (parent != null) {\n+            parent.addChild(comment);\n+        }\n         return comment;\n     }\n \n@@ -407,7 +411,10 @@ public OMDocument createOMDocument(OMXMLParserWrapper builder) {\n     }\n \n     private DocumentImpl getDocumentFromParent(OMContainer parent) {\n-        if (parent instanceof DocumentImpl) {\n+        if (parent == null) {\n+            // TODO: this is really a hack; we should make OMDOMFactory stateless\n+            return (DocumentImpl)createOMDocument();\n+        } else if (parent instanceof DocumentImpl) {\n             return (DocumentImpl) parent;\n         } else {\n             return (DocumentImpl) ((ParentNode) parent).getOwnerDocument();",
                "deletions": 3
            },
            {
                "sha": "a5d7af9c2985c8380ca192246da66e04aa253431",
                "filename": "modules/axiom-dom/src/test/java/org/apache/axiom/om/impl/dom/OMImplementationTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-dom/src/test/java/org/apache/axiom/om/impl/dom/OMImplementationTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-dom/src/test/java/org/apache/axiom/om/impl/dom/OMImplementationTest.java",
                "status": "modified",
                "changes": 3,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/test/java/org/apache/axiom/om/impl/dom/OMImplementationTest.java?ref=d49ab202444f0184e2757c398c60aa7a0a079ba7",
                "patch": "@@ -85,9 +85,6 @@ public static TestSuite suite() {\n         // TODO: investigate why this is not working with DOOM\n         builder.exclude(TestGetChildrenWithName4.class);\n \n-        // TODO: there seems to be an issue with OMFactory in this case\n-        builder.exclude(org.apache.axiom.ts.om.pi.TestDigest.class);\n-        \n         // TODO: if there is a comment node surrounded by text, then these text nodes need to be merged\n         builder.exclude(TestDigest.class, \"(|(file=digest3.xml)(file=digest4.xml))\");\n         ",
                "deletions": 3
            },
            {
                "sha": "9beb9659cbff564a9b15e94dcca38aaeab642372",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/OMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/OMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/OMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/OMTestSuiteBuilder.java?ref=d49ab202444f0184e2757c398c60aa7a0a079ba7",
                "patch": "@@ -188,6 +188,7 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.om.element.TestSetTextQNameWithEmptyPrefix(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestSetTextQNameWithoutNamespace(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestUndeclarePrefix(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.factory.TestCreateOMCommentWithoutParent(metaFactory));\n         for (int i=0; i<OMElementCreator.INSTANCES.length; i++) {\n             OMElementCreator creator = OMElementCreator.INSTANCES[i];\n             if (creator.isSupportsDefaultNamespace()) {\n@@ -204,6 +205,7 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.om.factory.TestCreateOMElementWithNullURIAndPrefix(metaFactory));\n         addTest(new org.apache.axiom.ts.om.factory.TestCreateOMNamespace(metaFactory));\n         addTest(new org.apache.axiom.ts.om.factory.TestCreateOMNamespaceWithNullURI(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.factory.TestCreateOMProcessingInstructionWithoutParent(metaFactory));\n         addTest(new org.apache.axiom.ts.om.factory.TestCreateOMText(metaFactory));\n         addTest(new org.apache.axiom.ts.om.factory.TestCreateOMTextFromDataHandlerProvider(metaFactory));\n         addTest(new org.apache.axiom.ts.om.namespace.TestEquals(metaFactory));",
                "deletions": 0
            },
            {
                "sha": "d965dab6a910836fcdc8ae96ac79cb6debb1674e",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMCommentWithoutParent.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMCommentWithoutParent.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMCommentWithoutParent.java",
                "status": "added",
                "changes": 35,
                "additions": 35,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMCommentWithoutParent.java?ref=d49ab202444f0184e2757c398c60aa7a0a079ba7",
                "patch": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.factory;\n+\n+import org.apache.axiom.om.OMComment;\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+public class TestCreateOMCommentWithoutParent extends AxiomTestCase {\n+    public TestCreateOMCommentWithoutParent(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMComment comment = metaFactory.getOMFactory().createOMComment(null, \"my comment\");\n+        assertNull(comment.getParent());\n+        assertEquals(\"my comment\", comment.getValue());\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "53cbf3d21577cff7eeda59f8beff4772076df4c4",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMProcessingInstructionWithoutParent.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMProcessingInstructionWithoutParent.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/d49ab202444f0184e2757c398c60aa7a0a079ba7/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMProcessingInstructionWithoutParent.java",
                "status": "added",
                "changes": 36,
                "additions": 36,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/factory/TestCreateOMProcessingInstructionWithoutParent.java?ref=d49ab202444f0184e2757c398c60aa7a0a079ba7",
                "patch": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.factory;\n+\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMProcessingInstruction;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+public class TestCreateOMProcessingInstructionWithoutParent extends AxiomTestCase {\n+    public TestCreateOMProcessingInstructionWithoutParent(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMProcessingInstruction pi = metaFactory.getOMFactory().createOMProcessingInstruction(null, \"mypi\", \"data\");\n+        assertNull(pi.getParent());\n+        assertEquals(\"mypi\", pi.getTarget());\n+        assertEquals(\"data\", pi.getValue());\n+    }\n+}",
                "deletions": 0
            }
        ],
        "patched_files": [
            "OMDOMFactory.java",
            "OMTestSuiteBuilder.java"
        ],
        "unit_tests": [
            "TestCreateOMCommentWithoutParent.java",
            "TestCreateOMProcessingInstructionWithoutParent.java",
            "OMImplementationTest.java"
        ]
    },
    "ws-axiom_2599637": {
        "repo": "ws-axiom",
        "message": "AXIOM-423: Fixed a NullPointerException in the lookupNamespaceURI implementation.",
        "commit": "https://github.com/apache/ws-axiom/commit/2599637bb2555d78197546772192a3a0b04bd125",
        "parent": "https://github.com/apache/ws-axiom/commit/5854cbc4bbb84a7473cc5be293d4417e09d28f6f",
        "bug_id": "ws-axiom_2599637",
        "file": [
            {
                "sha": "329973a9a4e3831368a1aeb94e1f28ae18f95ac8",
                "filename": "modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/DOMTestSuiteBuilder.java?ref=2599637bb2555d78197546772192a3a0b04bd125",
                "patch": "@@ -65,6 +65,7 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.dom.document.TestGetDomConfigDefaults(dbf));\n         addTest(new org.apache.axiom.ts.dom.document.TestGetOwnerDocument(dbf));\n         addTest(new org.apache.axiom.ts.dom.document.TestLookupNamespaceURI(dbf));\n+        addTest(new org.apache.axiom.ts.dom.document.TestLookupNamespaceURIWithEmptyDocument(dbf));\n         addTest(new org.apache.axiom.ts.dom.document.TestNormalizeDocumentNamespace(dbf));\n         addTest(new org.apache.axiom.ts.dom.document.TestTransformerWithIdentityStylesheet(dbf, org.apache.xalan.processor.TransformerFactoryImpl.class));\n         addTest(new org.apache.axiom.ts.dom.document.TestTransformerWithIdentityStylesheet(dbf, net.sf.saxon.TransformerFactoryImpl.class));",
                "deletions": 0
            },
            {
                "sha": "40166970f3d6ddeecac262b54ddbff2ff777fc99",
                "filename": "modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/document/TestLookupNamespaceURIWithEmptyDocument.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/document/TestLookupNamespaceURIWithEmptyDocument.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/document/TestLookupNamespaceURIWithEmptyDocument.java",
                "status": "added",
                "changes": 39,
                "additions": 39,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom-testsuite/src/main/java/org/apache/axiom/ts/dom/document/TestLookupNamespaceURIWithEmptyDocument.java?ref=2599637bb2555d78197546772192a3a0b04bd125",
                "patch": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.dom.document;\n+\n+import javax.xml.parsers.DocumentBuilderFactory;\n+\n+import org.apache.axiom.ts.dom.DOMTestCase;\n+import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n+\n+/**\n+ * Tests the behavior of {@link Node#lookupNamespaceURI(String)} on an empty {@link Document}.\n+ */\n+public class TestLookupNamespaceURIWithEmptyDocument extends DOMTestCase {\n+    public TestLookupNamespaceURIWithEmptyDocument(DocumentBuilderFactory dbf) {\n+        super(dbf);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        Document document = dbf.newDocumentBuilder().newDocument();\n+        assertNull(document.lookupNamespaceURI(\"p\"));\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "348d85c2f66bf3ae07a8b047af1b30c1f9728ff3",
                "filename": "modules/axiom-dom-testsuite/src/test/java/org/apache/axiom/ts/dom/XercesTest.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/test/java/org/apache/axiom/ts/dom/XercesTest.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom-testsuite/src/test/java/org/apache/axiom/ts/dom/XercesTest.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom-testsuite/src/test/java/org/apache/axiom/ts/dom/XercesTest.java?ref=2599637bb2555d78197546772192a3a0b04bd125",
                "patch": "@@ -23,13 +23,18 @@\n import junit.framework.TestCase;\n import junit.framework.TestSuite;\n \n+import org.apache.axiom.ts.dom.document.TestLookupNamespaceURIWithEmptyDocument;\n import org.apache.xerces.jaxp.DocumentBuilderFactoryImpl;\n \n public class XercesTest extends TestCase {\n     public static TestSuite suite() {\n         DocumentBuilderFactory dbf = new DocumentBuilderFactoryImpl();\n         dbf.setNamespaceAware(true);\n         DOMTestSuiteBuilder builder = new DOMTestSuiteBuilder(dbf);\n+        \n+        // XERCESJ-1582\n+        builder.exclude(TestLookupNamespaceURIWithEmptyDocument.class);\n+        \n         return builder.build();\n     }\n }",
                "deletions": 0
            },
            {
                "sha": "56590eedb0296df9cc8dc05935e6a12e994d0972",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/2599637bb2555d78197546772192a3a0b04bd125/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java",
                "status": "modified",
                "changes": 6,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/NodeImpl.java?ref=2599637bb2555d78197546772192a3a0b04bd125",
                "patch": "@@ -34,6 +34,7 @@\n import org.apache.axiom.soap.impl.builder.StAXSOAPModelBuilder;\n import org.w3c.dom.DOMException;\n import org.w3c.dom.Document;\n+import org.w3c.dom.Element;\n import org.w3c.dom.NamedNodeMap;\n import org.w3c.dom.Node;\n import org.w3c.dom.UserDataHandler;\n@@ -297,8 +298,9 @@ public String lookupNamespaceURI(String specifiedPrefix) {\n \n         }\n         case Node.DOCUMENT_NODE: {\n-            return ((NodeImpl) ((Document) this).getDocumentElement())\n-                    .lookupNamespaceURI(specifiedPrefix);\n+            Element documentElement = ((Document) this).getDocumentElement();\n+            return documentElement == null ? null\n+                    : documentElement.lookupNamespaceURI(specifiedPrefix);\n         }\n         case Node.ENTITY_NODE:\n         case Node.NOTATION_NODE:",
                "deletions": 2
            }
        ],
        "patched_files": [
            "DOMTestSuiteBuilder.java",
            "NodeImpl.java"
        ],
        "unit_tests": [
            "XercesTest.java",
            "TestLookupNamespaceURIWithEmptyDocument.java"
        ]
    },
    "ws-axiom_838c505": {
        "repo": "ws-axiom",
        "message": "Fixed a NullPointerException.",
        "commit": "https://github.com/apache/ws-axiom/commit/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba",
        "parent": "https://github.com/apache/ws-axiom/commit/03075b3cff67c791e8d09079e6a866e6acbb0aaa",
        "bug_id": "ws-axiom_838c505",
        "file": [
            {
                "sha": "6c42ae9e9b7b3dd93b077686f3baca5ab486e68b",
                "filename": "modules/axiom-common-impl/src/main/java/org/apache/axiom/om/impl/common/OMContainerHelper.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-common-impl/src/main/java/org/apache/axiom/om/impl/common/OMContainerHelper.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-common-impl/src/main/java/org/apache/axiom/om/impl/common/OMContainerHelper.java",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-common-impl/src/main/java/org/apache/axiom/om/impl/common/OMContainerHelper.java?ref=838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba",
                "patch": "@@ -141,6 +141,9 @@ public static void addChild(IContainer container, OMNode omNode, boolean fromBui\n     }\n     \n     public static void build(IContainer container) {\n+        if (container.getState() == IContainer.DISCARDED) {\n+            throw new NodeUnavailableException();\n+        }\n         OMXMLParserWrapper builder = container.getBuilder();\n         if (builder != null && builder.isCompleted()) {\n             log.debug(\"Builder is already complete.\");",
                "deletions": 0
            },
            {
                "sha": "8b4d51d4a07929dcdfa98a1eb4bc808599731e8a",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java?ref=838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba",
                "patch": "@@ -166,10 +166,12 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.om.element.TestAddAttributeWithoutNamespace(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChild(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChild2(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.element.TestAddChildDiscarded(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChildIncomplete(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChildWithParent(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChildWithSameParent(metaFactory, true));\n         addTest(new org.apache.axiom.ts.om.element.TestAddChildWithSameParent(metaFactory, false));\n+        addTest(new org.apache.axiom.ts.om.element.TestBuildDiscarded(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestChildReDeclaringGrandParentsDefaultNSWithPrefix(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestChildReDeclaringParentsDefaultNSWithPrefix(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestCloneOMElement(metaFactory));",
                "deletions": 0
            },
            {
                "sha": "9b00f5e82691e2931d4cb7bdcc7a64a8156655a1",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddChildDiscarded.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddChildDiscarded.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddChildDiscarded.java",
                "status": "added",
                "changes": 54,
                "additions": 54,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddChildDiscarded.java?ref=838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba",
                "patch": "@@ -0,0 +1,54 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.element;\n+\n+import java.io.StringReader;\n+\n+import org.apache.axiom.om.NodeUnavailableException;\n+import org.apache.axiom.om.OMContainer;\n+import org.apache.axiom.om.OMElement;\n+import org.apache.axiom.om.OMFactory;\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMNode;\n+import org.apache.axiom.om.OMXMLBuilderFactory;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+/**\n+ * Tests the behavior of {@link OMContainer#addChild(OMNode)} if the parent has been discarded. In\n+ * this case the method is expected to throw a {@link NodeUnavailableException}.\n+ */\n+public class TestAddChildDiscarded extends AxiomTestCase {\n+    public TestAddChildDiscarded(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMFactory factory = metaFactory.getOMFactory();\n+        OMElement parent = OMXMLBuilderFactory.createOMBuilder(factory, new StringReader(\"<root><a/><b/></root>\")).getDocumentElement();\n+        // Partially build the parent\n+        parent.getFirstOMChild();\n+        parent.discard();\n+        try {\n+            parent.addChild(factory.createOMElement(\"c\", null));\n+            fail(\"Expected NodeUnavailableException\");\n+        } catch (NodeUnavailableException ex) {\n+            // Expected\n+        }\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "735fec5eeb3e9bace007402286a5aa68d69510a8",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestBuildDiscarded.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestBuildDiscarded.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestBuildDiscarded.java",
                "status": "added",
                "changes": 53,
                "additions": 53,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestBuildDiscarded.java?ref=838c5059c443ab6eb6ec8bcf408d56fdd78bb7ba",
                "patch": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.element;\n+\n+import java.io.StringReader;\n+\n+import org.apache.axiom.om.NodeUnavailableException;\n+import org.apache.axiom.om.OMElement;\n+import org.apache.axiom.om.OMFactory;\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMSerializable;\n+import org.apache.axiom.om.OMXMLBuilderFactory;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+/**\n+ * Tests the behavior of {@link OMSerializable#build()} on an {@link OMElement} that has been\n+ * discarded. In this case the method is expected to throw a {@link NodeUnavailableException}.\n+ */\n+public class TestBuildDiscarded extends AxiomTestCase {\n+    public TestBuildDiscarded(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMFactory factory = metaFactory.getOMFactory();\n+        OMElement parent = OMXMLBuilderFactory.createOMBuilder(factory, new StringReader(\"<root><a/><b/></root>\")).getDocumentElement();\n+        // Partially build the parent\n+        parent.getFirstOMChild();\n+        parent.discard();\n+        try {\n+            parent.build();\n+            fail(\"Expected NodeUnavailableException\");\n+        } catch (NodeUnavailableException ex) {\n+            // Expected\n+        }\n+    }\n+}",
                "deletions": 0
            }
        ],
        "patched_files": [
            "OMContainerHelper.java",
            "OMTestSuiteBuilder.java"
        ],
        "unit_tests": [
            "TestAddChildDiscarded.java",
            "TestBuildDiscarded.java"
        ]
    },
    "ws-axiom_c7de279": {
        "repo": "ws-axiom",
        "message": "Fixed a couple of potential NPEs in the hasFault and getFault methods of the SOAPBody implementations.",
        "commit": "https://github.com/apache/ws-axiom/commit/c7de27908ac6a1162d7bff7435ba57938f6c5854",
        "parent": "https://github.com/apache/ws-axiom/commit/5231ed5429fd47dee9c7818c2fa47cf6160f4c0c",
        "bug_id": "ws-axiom_c7de279",
        "file": [
            {
                "sha": "66a435e1ee95cf01772f322e2d78a71e3d10388c",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPBodyImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPBodyImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPBodyImpl.java",
                "status": "modified",
                "changes": 36,
                "additions": 20,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/soap/impl/dom/SOAPBodyImpl.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -76,14 +76,16 @@ public boolean hasFault() {\n         } else {\n             OMElement element = getFirstElement();\n             if (element != null\n-                    && SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(element\n-                    .getLocalName())\n-                    && (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI\n-                    .equals(element.getNamespace().getNamespaceURI()) ||\n-                    SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI\n-                            .equals(element.getNamespace().getNamespaceURI()))) { //added this line\n-                hasSOAPFault = true;\n-                return true;\n+                    && SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(element.getLocalName())) {\n+                OMNamespace ns = element.getNamespace();\n+                if (ns != null &&\n+                        (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()) ||\n+                         SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()))) {\n+                    hasSOAPFault = true;\n+                    return true;\n+                } else {\n+                    return false;\n+                }\n             } else {\n                 return false;\n             }\n@@ -100,17 +102,19 @@ public SOAPFault getFault() {\n         if (hasSOAPFault) {\n             return (SOAPFault) element;\n         } else if (element != null\n-                && SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(element\n-                .getLocalName())\n-                && (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(element\n-                .getNamespace().getNamespaceURI()) || SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI\n-                .equals(element.getNamespace().getNamespaceURI()))) { //added this line\n-            hasSOAPFault = true;\n-            return (SOAPFault) element;\n+                && SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(element.getLocalName())) {\n+            OMNamespace ns = element.getNamespace();\n+            if (ns != null &&\n+                    (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()) ||\n+                     SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()))) {\n+                hasSOAPFault = true;\n+                return (SOAPFault) element;\n+            } else {\n+                return null;\n+            }\n         } else {\n             return null;\n         }\n-\n     }\n \n     /**",
                "deletions": 16
            },
            {
                "sha": "5c87ed078d945ea19ed841362bd16039acaf1e8e",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java",
                "status": "modified",
                "changes": 22,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/soap/impl/llom/SOAPBodyImpl.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -125,21 +125,19 @@ public SOAPFault getFault() {\n         if (hasSOAPFault) {\n             return (SOAPFault) element;\n         } else if (element != null\n-                &&\n-                SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(\n-                        element.getLocalName())\n-                &&\n-                (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(\n-                        element.getNamespace().getNamespaceURI())\n-                        ||\n-                        SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(\n-                                element.getNamespace().getNamespaceURI()))) {     //added this line\n-            hasSOAPFault = true;\n-            return (SOAPFault) element;\n+                && SOAPConstants.SOAPFAULT_LOCAL_NAME.equals(element.getLocalName())) {\n+            OMNamespace ns = element.getNamespace();\n+            if (ns != null &&\n+                    (SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()) ||\n+                     SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI.equals(ns.getNamespaceURI()))) {\n+                hasSOAPFault = true;\n+                return (SOAPFault) element;\n+            } else {\n+                return null;\n+            }\n         } else {\n             return null;\n         }\n-\n     }\n \n     /**",
                "deletions": 12
            },
            {
                "sha": "04d802e4a7e08bca183b544738d7b428e5c12960",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/SOAPTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/SOAPTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/SOAPTestSuiteBuilder.java",
                "status": "modified",
                "changes": 27,
                "additions": 22,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/SOAPTestSuiteBuilder.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -23,6 +23,9 @@\n import org.apache.axiom.om.OMMetaFactory;\n import org.apache.axiom.om.OMSourcedElement;\n import org.apache.axiom.om.TestConstants;\n+import org.apache.axiom.soap.SOAP11Constants;\n+import org.apache.axiom.soap.SOAP12Constants;\n+import org.apache.axiom.soap.SOAPConstants;\n import org.apache.axiom.testutils.suite.TestSuiteBuilder;\n \n public class SOAPTestSuiteBuilder extends TestSuiteBuilder {\n@@ -35,11 +38,20 @@\n         TestConstants.EMPTY_BODY_MESSAGE, \"soap/soap11/soapfault.xml\", \"soap/soap11/bodyNotQualified.xml\",\n         \"soap/soap11/faultstring-with-comment.xml\"};\n     \n-    private static final QName[] qnames = {\n+    private static final QName[] generalQNames = {\n         new QName(\"root\"),\n         new QName(\"urn:test\", \"root\", \"p\"),\n         new QName(\"urn:test\", \"root\") };\n     \n+    private static final QName[] noFaultQNames = {\n+        new QName(\"root\"),\n+        new QName(\"urn:test\", \"root\", \"p\"),\n+        new QName(\"urn:test\", \"root\"),\n+        new QName(\"Fault\"),\n+        new QName(\"urn:test\", \"Fault\", \"p\"),\n+        new QName(SOAP11Constants.SOAP_ENVELOPE_NAMESPACE_URI, \"NoFault\", SOAPConstants.SOAP_DEFAULT_NAMESPACE_PREFIX),\n+        new QName(SOAP12Constants.SOAP_ENVELOPE_NAMESPACE_URI, \"NoFault\", SOAPConstants.SOAP_DEFAULT_NAMESPACE_PREFIX) };\n+    \n     private final OMMetaFactory metaFactory;\n     private final boolean supportsOMSourcedElement;\n     private final boolean supportsBodyElementNameOptimization;\n@@ -65,12 +77,17 @@ private void addTests(SOAPSpec spec) {\n         addTest(new org.apache.axiom.ts.soap.body.TestAddFault2(metaFactory, spec));\n         addTest(new org.apache.axiom.ts.soap.body.TestGetFault(metaFactory, spec));\n         addTest(new org.apache.axiom.ts.soap.body.TestGetFaultWithParser(metaFactory, spec));\n-        for (int i=0; i<qnames.length; i++) {\n-            QName qname = qnames[i];\n+        for (int i=0; i<generalQNames.length; i++) {\n+            QName qname = generalQNames[i];\n             addTest(new org.apache.axiom.ts.soap.body.TestGetFirstElementLocalNameWithParser(metaFactory, spec,\n                     qname, supportsBodyElementNameOptimization));\n             addTest(new org.apache.axiom.ts.soap.body.TestGetFirstElementNSWithParser(metaFactory, spec,\n                     qname, supportsBodyElementNameOptimization));\n+        }\n+        for (int i=0; i<noFaultQNames.length; i++) {\n+            QName qname = noFaultQNames[i];\n+            addTest(new org.apache.axiom.ts.soap.body.TestGetFaultNoFault(metaFactory, spec, qname));\n+            addTest(new org.apache.axiom.ts.soap.body.TestHasFaultNoFault(metaFactory, spec, qname));\n             addTest(new org.apache.axiom.ts.soap.body.TestHasFaultWithParserNoFault(metaFactory, spec,\n                     qname, supportsBodyElementNameOptimization));\n         }\n@@ -98,8 +115,8 @@ private void addTests(SOAPSpec spec) {\n         addTest(new org.apache.axiom.ts.soap.envelope.TestGetBodyWithParser(metaFactory, spec));\n         addTest(new org.apache.axiom.ts.soap.envelope.TestGetHeader(metaFactory, spec));\n         addTest(new org.apache.axiom.ts.soap.envelope.TestGetHeaderWithParser(metaFactory, spec));\n-        for (int i=0; i<qnames.length; i++) {\n-            QName qname = qnames[i];\n+        for (int i=0; i<generalQNames.length; i++) {\n+            QName qname = generalQNames[i];\n             addTest(new org.apache.axiom.ts.soap.envelope.TestGetSOAPBodyFirstElementLocalNameAndNS(metaFactory, spec, qname));\n             addTest(new org.apache.axiom.ts.soap.envelope.TestGetSOAPBodyFirstElementLocalNameAndNSWithParser(metaFactory, spec, qname));\n         }",
                "deletions": 5
            },
            {
                "sha": "d38304d37eb90fd539b41054a65ed9d1efb86c5d",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/FirstElementNameWithParserTestCase.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/FirstElementNameWithParserTestCase.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/FirstElementNameWithParserTestCase.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/FirstElementNameWithParserTestCase.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -49,6 +49,7 @@ public FirstElementNameWithParserTestCase(OMMetaFactory metaFactory,\n         this.qname = qname;\n         addTestProperty(\"prefix\", qname.getPrefix());\n         addTestProperty(\"uri\", qname.getNamespaceURI());\n+        addTestProperty(\"localName\", qname.getLocalPart());\n         this.supportsOptimization = supportsOptimization;\n     }\n ",
                "deletions": 0
            },
            {
                "sha": "422534b18ea1e3125e246069f2fe27ced27c6945",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestGetFaultNoFault.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestGetFaultNoFault.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestGetFaultNoFault.java",
                "status": "added",
                "changes": 27,
                "additions": 27,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestGetFaultNoFault.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -0,0 +1,27 @@\n+package org.apache.axiom.ts.soap.body;\n+\n+import javax.xml.namespace.QName;\n+\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.soap.SOAPBody;\n+import org.apache.axiom.ts.soap.SOAPSpec;\n+import org.apache.axiom.ts.soap.SOAPTestCase;\n+\n+public class TestGetFaultNoFault extends SOAPTestCase {\n+    private final QName qname;\n+    \n+    public TestGetFaultNoFault(OMMetaFactory metaFactory, SOAPSpec spec, QName qname) {\n+        super(metaFactory, spec);\n+        this.qname = qname;\n+        addTestProperty(\"prefix\", qname.getPrefix());\n+        addTestProperty(\"uri\", qname.getNamespaceURI());\n+        addTestProperty(\"localName\", qname.getLocalPart());\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        SOAPBody body = soapFactory.getDefaultEnvelope().getBody();\n+        body.addChild(soapFactory.createOMElement(\n+                qname.getLocalPart(), qname.getNamespaceURI(), qname.getPrefix()));\n+        assertNull(body.getFault());\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "a0183a89b9f8fe3f5cd002daf99574b6e69d6d1e",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestHasFaultNoFault.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestHasFaultNoFault.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/c7de27908ac6a1162d7bff7435ba57938f6c5854/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestHasFaultNoFault.java",
                "status": "added",
                "changes": 27,
                "additions": 27,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/soap/body/TestHasFaultNoFault.java?ref=c7de27908ac6a1162d7bff7435ba57938f6c5854",
                "patch": "@@ -0,0 +1,27 @@\n+package org.apache.axiom.ts.soap.body;\n+\n+import javax.xml.namespace.QName;\n+\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.soap.SOAPBody;\n+import org.apache.axiom.ts.soap.SOAPSpec;\n+import org.apache.axiom.ts.soap.SOAPTestCase;\n+\n+public class TestHasFaultNoFault extends SOAPTestCase {\n+    private final QName qname;\n+    \n+    public TestHasFaultNoFault(OMMetaFactory metaFactory, SOAPSpec spec, QName qname) {\n+        super(metaFactory, spec);\n+        this.qname = qname;\n+        addTestProperty(\"prefix\", qname.getPrefix());\n+        addTestProperty(\"uri\", qname.getNamespaceURI());\n+        addTestProperty(\"localName\", qname.getLocalPart());\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        SOAPBody body = soapFactory.getDefaultEnvelope().getBody();\n+        body.addChild(soapFactory.createOMElement(\n+                qname.getLocalPart(), qname.getNamespaceURI(), qname.getPrefix()));\n+        assertFalse(body.hasFault());\n+    }\n+}",
                "deletions": 0
            }
        ],
        "patched_files": [
            "FirstElementNameWithParserTestCase.java",
            "SOAPTestSuiteBuilder.java",
            "SOAPBodyImpl.java"
        ],
        "unit_tests": [
            "TestHasFaultNoFault.java",
            "TestGetFaultNoFault.java"
        ]
    },
    "ws-axiom_376edbc": {
        "repo": "ws-axiom",
        "message": "AXIOM-442: Fixed a NullPointerException in OMText#getTextCharacters().",
        "commit": "https://github.com/apache/ws-axiom/commit/376edbc63759e008571d7c1a36a09331acbfe5c8",
        "parent": "https://github.com/apache/ws-axiom/commit/70ab6086f8ae92d72679b2dc1b7c5d94f08a1d6c",
        "bug_id": "ws-axiom_376edbc",
        "file": [
            {
                "sha": "56fdcb399c39dbc6f96cd31d8e90ab4285ccfb3a",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/util/base64/Base64Utils.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/Base64Utils.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/Base64Utils.java",
                "status": "modified",
                "changes": 41,
                "additions": 30,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/Base64Utils.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -54,25 +54,28 @@ private static int getEncodedSize(int unencodedSize) {\n         return (unencodedSize+2) / 3 * 4;\n     }\n     \n+    private static int getBufferSize(DataHandler dh) {\n+        long size = DataSourceUtils.getSize(dh.getDataSource());\n+        if (size == -1) {\n+            // Use a reasonable default capacity.\n+            return 4096;\n+        } else if (size > Integer.MAX_VALUE) {\n+            throw new IllegalArgumentException(\"DataHandler is too large to encode to string\");\n+        } else {\n+            return getEncodedSize((int)size);\n+        }\n+    }\n+    \n     /**\n-     * Get a base64 representation of the content of a given {@link DataHandler}.\n+     * Get a base64 representation of the content of a given {@link DataHandler} as a string.\n      * This method will try to carry out the encoding operation in the most efficient way.\n      * \n      * @param dh the data handler with the content to encode\n      * @return the base64 encoded content\n      * @throws IOException if an I/O error occurs when reading the content of the data handler\n      */\n     public static String encode(DataHandler dh) throws IOException {\n-        long size = DataSourceUtils.getSize(dh.getDataSource());\n-        StringBuilder buffer;\n-        if (size == -1) {\n-            // Use a reasonable default capacity (better than the default of 16).\n-            buffer = new StringBuilder(4096);\n-        } else if (size > Integer.MAX_VALUE) {\n-            throw new IllegalArgumentException(\"DataHandler is too large to encode to string\");\n-        } else {\n-            buffer = new StringBuilder(getEncodedSize((int)size));\n-        }\n+        StringBuilder buffer = new StringBuilder(getBufferSize(dh));\n         Base64EncodingStringBufferOutputStream out = new Base64EncodingStringBufferOutputStream(buffer);\n         // Always prefer writeTo, because getInputStream will create a thread and a pipe if\n         // the DataHandler was constructed using an object instead of a DataSource\n@@ -81,6 +84,22 @@ public static String encode(DataHandler dh) throws IOException {\n         return buffer.toString();\n     }\n \n+    /**\n+     * Get a base64 representation of the content of a given {@link DataHandler} as a char array.\n+     * This method will try to carry out the encoding operation in the most efficient way.\n+     * \n+     * @param dh the data handler with the content to encode\n+     * @return the base64 encoded content\n+     * @throws IOException if an I/O error occurs when reading the content of the data handler\n+     */\n+    public static char[] encodeToCharArray(DataHandler dh) throws IOException {\n+        NoCopyCharArrayWriter buffer = new NoCopyCharArrayWriter(getBufferSize(dh));\n+        Base64EncodingWriterOutputStream out = new Base64EncodingWriterOutputStream(buffer);\n+        dh.writeTo(out);\n+        out.complete();\n+        return buffer.toCharArray();\n+    }\n+\n     private static int decode0(char[] ibuf, byte[] obuf, int wp) {\n         int outlen = 3;\n         if (ibuf[3] == S_BASE64PAD)",
                "deletions": 11
            },
            {
                "sha": "8a275d8320de59dd2f77fb46d1bd5d8f7c302dd5",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/util/base64/NoCopyCharArrayWriter.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/NoCopyCharArrayWriter.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/NoCopyCharArrayWriter.java",
                "status": "added",
                "changes": 36,
                "additions": 36,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/util/base64/NoCopyCharArrayWriter.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.util.base64;\n+\n+import java.io.CharArrayWriter;\n+\n+/**\n+ * Modified {@link CharArrayWriter} that returns the internal buffer (instead of a copy) if the\n+ * buffer has just the right size, i.e. if the size of the buffer is equal to the number of\n+ * characters that have been written.\n+ */\n+class NoCopyCharArrayWriter extends CharArrayWriter {\n+    NoCopyCharArrayWriter(int expectedSize) {\n+        super(expectedSize);\n+    }\n+\n+    public char[] toCharArray() {\n+        return count == buf.length ? buf : super.toCharArray();\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "5b056cccc14376253ef24e5c310f57fe5928a96c",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/TextNodeImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/TextNodeImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/TextNodeImpl.java",
                "status": "modified",
                "changes": 12,
                "additions": 11,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/TextNodeImpl.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -269,7 +269,17 @@ public String getData() throws DOMException {\n     }\n \n     public char[] getTextCharacters() {\n-        return charArray != null ? charArray : this.textValue.toCharArray();\n+        if (charArray != null) {\n+            return charArray;\n+        } else if (textValue != null) {\n+            return textValue.toCharArray();\n+        } else {\n+            try {\n+                return Base64Utils.encodeToCharArray((DataHandler)getDataHandler());\n+            } catch (IOException ex) {\n+                throw new OMException(ex);\n+            }\n+        }\n     }\n \n     public boolean isCharacters() {",
                "deletions": 1
            },
            {
                "sha": "0b29242e11bcb634d649b063c12eb862e9dfa6b0",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMTextImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMTextImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMTextImpl.java",
                "status": "modified",
                "changes": 12,
                "additions": 11,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMTextImpl.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -255,7 +255,17 @@ public String getText() throws OMException {\n     }\n \n     public char[] getTextCharacters() {\n-        return charArray != null ? charArray : value.toCharArray();\n+        if (charArray != null) {\n+            return charArray;\n+        } else if (value != null) {\n+            return value.toCharArray();\n+        } else {\n+            try {\n+                return Base64Utils.encodeToCharArray((DataHandler)getDataHandler());\n+            } catch (IOException ex) {\n+                throw new OMException(ex);\n+            }\n+        }\n     }\n \n     public boolean isCharacters() {",
                "deletions": 1
            },
            {
                "sha": "12d27d322a5df29b6f7a068b900ac5ced54e0e51",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -475,6 +475,7 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.om.pi.TestDigest(metaFactory));\n         addTest(new org.apache.axiom.ts.om.text.TestBase64Streaming(metaFactory));\n         addTest(new org.apache.axiom.ts.om.text.TestDigest(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.text.TestGetTextCharactersFromDataHandler(metaFactory));\n         Method[] methods = AXIOMXPathTestCase.class.getMethods();\n         for (int i=0; i<methods.length; i++) {\n             String methodName = methods[i].getName();",
                "deletions": 0
            },
            {
                "sha": "aafeb8d49a79a1f28f51372cf3a3cfbf6ac46026",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/text/TestGetTextCharactersFromDataHandler.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/text/TestGetTextCharactersFromDataHandler.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/376edbc63759e008571d7c1a36a09331acbfe5c8/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/text/TestGetTextCharactersFromDataHandler.java",
                "status": "added",
                "changes": 45,
                "additions": 45,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/text/TestGetTextCharactersFromDataHandler.java?ref=376edbc63759e008571d7c1a36a09331acbfe5c8",
                "patch": "@@ -0,0 +1,45 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.text;\n+\n+import javax.activation.DataHandler;\n+\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMText;\n+import org.apache.axiom.ts.AxiomTestCase;\n+import org.apache.axiom.util.base64.Base64Utils;\n+\n+/**\n+ * Tests that {@link OMText#getTextCharacters()} returns the expected result for an {@link OMText}\n+ * node backed by a {@link DataHandler}. This is a regression test for <a\n+ * href=\"https://issues.apache.org/jira/browse/AXIOM-442\">AXIOM-442</a>.\n+ */\n+public class TestGetTextCharactersFromDataHandler extends AxiomTestCase {\n+    public TestGetTextCharactersFromDataHandler(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        DataHandler dh = new DataHandler(\"test content\", \"text/plain; charset=utf-8\");\n+        OMText text = metaFactory.getOMFactory().createOMText(dh, true);\n+        char[] chars = text.getTextCharacters();\n+        byte[] decoded = Base64Utils.decode(chars, 0, chars.length);\n+        assertEquals(\"test content\", new String(decoded, \"utf-8\"));\n+    }\n+}",
                "deletions": 0
            }
        ],
        "patched_files": [
            "NoCopyCharArrayWriter.java",
            "OMTextImpl.java",
            "TextNodeImpl.java",
            "Base64Utils.java",
            "OMTestSuiteBuilder.java"
        ],
        "unit_tests": [
            "TestGetTextCharactersFromDataHandler.java"
        ]
    },
    "ws-axiom_959af60": {
        "repo": "ws-axiom",
        "message": "Improve consistency of the OMElement#addAttribute(String, String, OMNamespace) API:\n* Let LLOM's addAttribute implementation generate a prefix (instead of throwing a NPE) if the prefix is null and no namespace declaration for the given namespace URI is found.\n* Add test coverage for the scenario where the prefix is null and a namespace declaration for the given URI is found (in which case the corresponding prefix is reused). This worked correctly in LLOM.\n* Make DOOM's behavior consistent with LLOM.\n* Update Javadoc of the addAttribute method.",
        "commit": "https://github.com/apache/ws-axiom/commit/959af604b36b92ffcc79058495ab631ee8d193da",
        "parent": "https://github.com/apache/ws-axiom/commit/8ea27174a675ae98f161571df4e246561af5c0da",
        "bug_id": "ws-axiom_959af60",
        "file": [
            {
                "sha": "2d62079a500f2fb7cd63a526fe37db6c3fd30602",
                "filename": "modules/axiom-api/src/main/java/org/apache/axiom/om/OMElement.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-api/src/main/java/org/apache/axiom/om/OMElement.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-api/src/main/java/org/apache/axiom/om/OMElement.java",
                "status": "modified",
                "changes": 8,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-api/src/main/java/org/apache/axiom/om/OMElement.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -365,9 +365,11 @@\n      *            the given attribute value can be serialized directly as an XML value. The caller\n      *            may, for example, pass a string with the character 0x01.\n      * @param ns\n-     *            The namespace has to be one of the in scope namespace. i.e. the passed namespace\n-     *            must be declared in the parent element of this attribute or ancestors of the\n-     *            parent element of the attribute.\n+     *            The namespace for the attribute. If no corresponding namespace declaration is in\n+     *            scope, then a new namespace declaration will be added to the element. The\n+     *            {@link OMNamespace} may have a <code>null</code> prefix, in which case the method\n+     *            will generate a prefix (if no namespace declaration for the given namespace URI is\n+     *            in scope) or use an existing one.\n      * @return Returns the added attribute.\n      * @throws IllegalArgumentException\n      *             if an attempt is made to create a prefixed attribute with an empty namespace name",
                "deletions": 3
            },
            {
                "sha": "045a0c1ff54348dc04b36513c246ecd5bc016580",
                "filename": "modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java",
                "status": "modified",
                "changes": 16,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-dom/src/main/java/org/apache/axiom/om/impl/dom/ElementImpl.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -59,6 +59,7 @@\n import javax.xml.namespace.NamespaceContext;\n import javax.xml.namespace.QName;\n import javax.xml.stream.XMLStreamException;\n+\n import java.io.ByteArrayOutputStream;\n import java.io.IOException;\n import java.io.Reader;\n@@ -531,17 +532,16 @@ public OMAttribute addAttribute(OMAttribute attr) {\n \n     public OMAttribute addAttribute(String localName, String value,\n                                     OMNamespace ns) {\n+        OMNamespace namespace = null;\n         if (ns != null) {\n-            String uri = ns.getNamespaceURI();\n-            if (uri.length() > 0) {\n-                String prefix = ns.getPrefix();\n-                OMNamespace ns2 = findNamespaceURI(prefix);\n-                if (ns2 == null || !uri.equals(ns2.getNamespaceURI())) {\n-                    declareNamespace(uri, prefix);\n-                }\n+            String namespaceURI = ns.getNamespaceURI();\n+            String prefix = ns.getPrefix();\n+            namespace = findNamespace(namespaceURI, prefix);\n+            if (namespace == null) {\n+                namespace = new OMNamespaceImpl(namespaceURI, prefix != null ? prefix : OMSerializerUtil.getNextNSPrefix());\n             }\n         }\n-        return addAttribute(new AttrImpl(null, localName, ns, value, factory));\n+        return addAttribute(new AttrImpl(null, localName, namespace, value, factory));\n     }\n \n     public OMNamespace addNamespaceDeclaration(String uri, String prefix) {",
                "deletions": 8
            },
            {
                "sha": "21f0c5b4ff96a883a6232400f3ab29b39a677d9c",
                "filename": "modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-impl/src/main/java/org/apache/axiom/om/impl/llom/OMElementImpl.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -593,18 +593,18 @@ public void removeAttribute(OMAttribute attr) {\n         attributes.remove(attr.getQName());\n     }\n \n-    public OMAttribute addAttribute(String attributeName, String value,\n+    public OMAttribute addAttribute(String localName, String value,\n                                     OMNamespace ns) {\n         OMNamespace namespace = null;\n         if (ns != null) {\n             String namespaceURI = ns.getNamespaceURI();\n             String prefix = ns.getPrefix();\n             namespace = findNamespace(namespaceURI, prefix);\n             if (namespace == null) {\n-                namespace = new OMNamespaceImpl(namespaceURI, prefix);\n+                namespace = new OMNamespaceImpl(namespaceURI, prefix != null ? prefix : OMSerializerUtil.getNextNSPrefix());\n             }\n         }\n-        return addAttribute(new OMAttributeImpl(attributeName, namespace, value, this.factory));\n+        return addAttribute(new OMAttributeImpl(localName, namespace, value, this.factory));\n     }\n \n     /**",
                "deletions": 3
            },
            {
                "sha": "1e1c967dd0acf98ef24f600c71939cdd7aba74a0",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/OMTestSuiteBuilder.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -198,6 +198,8 @@ protected void addTests() {\n         addTest(new org.apache.axiom.ts.om.document.sr.TestDTDReaderFromParser(metaFactory, false, false));\n         addTest(new org.apache.axiom.ts.om.element.TestAddAttributeAlreadyOwnedByElement(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddAttributeAlreadyOwnedByOtherElement(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.element.TestAddAttributeGeneratedPrefix(metaFactory));\n+        addTest(new org.apache.axiom.ts.om.element.TestAddAttributeReuseExistingPrefix(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddAttributeWithInvalidNamespace1(metaFactory));\n         addTest(new org.apache.axiom.ts.om.element.TestAddAttributeWithInvalidNamespace2(metaFactory));\n         for (int i=0; i<addAttributeStrategies.length; i++) {",
                "deletions": 0
            },
            {
                "sha": "aef7015a4623b2ae6601dee901a048196ad727c2",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeGeneratedPrefix.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeGeneratedPrefix.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeGeneratedPrefix.java",
                "status": "added",
                "changes": 51,
                "additions": 51,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeGeneratedPrefix.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.element;\n+\n+import java.util.Iterator;\n+\n+import org.apache.axiom.om.OMAttribute;\n+import org.apache.axiom.om.OMElement;\n+import org.apache.axiom.om.OMFactory;\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMNamespace;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+/**\n+ * Tests that when {@link OMElement#addAttribute(String, String, OMNamespace)} is called with an\n+ * {@link OMNamespace} with a <code>null</code> prefix and no namespace declaration for the given\n+ * namespace URI is in scope, the method generates a prefix.\n+ */\n+public class TestAddAttributeGeneratedPrefix extends AxiomTestCase {\n+    public TestAddAttributeGeneratedPrefix(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMFactory factory = metaFactory.getOMFactory();\n+        OMElement element = factory.createOMElement(\"test\", null);\n+        OMAttribute attr = element.addAttribute(\"attr\", \"value\", factory.createOMNamespace(\"urn:test\", null));\n+        OMNamespace ns = attr.getNamespace();\n+        assertTrue(ns.getPrefix().length() > 0);\n+        Iterator it = element.getAllDeclaredNamespaces();\n+        assertTrue(it.hasNext());\n+        assertEquals(ns, it.next());\n+        assertFalse(it.hasNext());\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "1819b88d52f8e05fdb68ef3ea135666cb0fba6cd",
                "filename": "modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeReuseExistingPrefix.java",
                "blob_url": "https://github.com/apache/ws-axiom/blob/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeReuseExistingPrefix.java",
                "raw_url": "https://github.com/apache/ws-axiom/raw/959af604b36b92ffcc79058495ab631ee8d193da/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeReuseExistingPrefix.java",
                "status": "added",
                "changes": 47,
                "additions": 47,
                "contents_url": "https://api.github.com/repos/apache/ws-axiom/contents/modules/axiom-testsuite/src/main/java/org/apache/axiom/ts/om/element/TestAddAttributeReuseExistingPrefix.java?ref=959af604b36b92ffcc79058495ab631ee8d193da",
                "patch": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.axiom.ts.om.element;\n+\n+import org.apache.axiom.om.OMAttribute;\n+import org.apache.axiom.om.OMElement;\n+import org.apache.axiom.om.OMFactory;\n+import org.apache.axiom.om.OMMetaFactory;\n+import org.apache.axiom.om.OMNamespace;\n+import org.apache.axiom.ts.AxiomTestCase;\n+\n+/**\n+ * Tests that when {@link OMElement#addAttribute(String, String, OMNamespace)} is called with an\n+ * {@link OMNamespace} with a <code>null</code> prefix and a namespace declaration for the given\n+ * namespace URI is in scope, the method reuses the existing prefix instead of generating one.\n+ */\n+public class TestAddAttributeReuseExistingPrefix extends AxiomTestCase {\n+    public TestAddAttributeReuseExistingPrefix(OMMetaFactory metaFactory) {\n+        super(metaFactory);\n+    }\n+\n+    protected void runTest() throws Throwable {\n+        OMFactory factory = metaFactory.getOMFactory();\n+        OMElement parent = factory.createOMElement(\"parent\", null);\n+        OMElement element = factory.createOMElement(\"element\", null, parent);\n+        parent.declareNamespace(\"urn:test\", \"p\");\n+        OMAttribute attr = element.addAttribute(\"attr\", \"test\", factory.createOMNamespace(\"urn:test\", null));\n+        assertEquals(\"p\", attr.getPrefix());\n+        assertFalse(element.getAllDeclaredNamespaces().hasNext());\n+    }\n+}",
                "deletions": 0
            }
        ],
        "patched_files": [
            "OMElement.java",
            "OMElementImpl.java",
            "ElementImpl.java",
            "OMTestSuiteBuilder.java"
        ],
        "unit_tests": [
            "OMElementTest.java",
            "ElementImplTest.java",
            "TestAddAttributeGeneratedPrefix.java",
            "TestAddAttributeReuseExistingPrefix.java"
        ]
    }
}