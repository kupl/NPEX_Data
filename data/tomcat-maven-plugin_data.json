[
    {
        "repo": "tomcat-maven-plugin",
        "message": "[MTOMCAT-103] Executable War fails to run with a NullPointerException\ndo not record jar entry starting with / remove it.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/maven-plugin/trunk@1196179 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/tomcat-maven-plugin/commit/c31b4f4f053280d8888a517b93be0208bdd47b88",
        "parent": "https://github.com/apache/tomcat-maven-plugin/commit/0edb98db897d8fbcf3a23b7886b170942bfc4097",
        "bug_id": "tomcat-maven-plugin_1",
        "file": [
            {
                "sha": "b520101c68f3b6c4ae50ed869d935aa7ec69ca30",
                "filename": "tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/AbstractExecWarMojo.java",
                "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/c31b4f4f053280d8888a517b93be0208bdd47b88/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/AbstractExecWarMojo.java",
                "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/c31b4f4f053280d8888a517b93be0208bdd47b88/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/AbstractExecWarMojo.java",
                "status": "modified",
                "changes": 11,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/AbstractExecWarMojo.java?ref=c31b4f4f053280d8888a517b93be0208bdd47b88",
                "patch": "@@ -282,10 +282,11 @@ public void execute()\n \n             if ( \"war\".equals( project.getPackaging() ) )\n             {\n-                os.putArchiveEntry( new JarArchiveEntry( path + \".war\" ) );\n+\n+                os.putArchiveEntry( new JarArchiveEntry( StringUtils.removeStart( path, \"/\" ) + \".war\" ) );\n                 IOUtils.copy( new FileInputStream( projectArtifact.getFile() ), os );\n                 os.closeArchiveEntry();\n-                properties.put( Tomcat7Runner.WARS_KEY, path + \".war|\" + path );\n+                properties.put( Tomcat7Runner.WARS_KEY, StringUtils.removeStart( path, \"/\" ) + \".war|\" + path );\n             }\n \n             if ( \"pom\".equals( project.getPackaging() ) && ( warRunDependencies != null\n@@ -318,13 +319,11 @@ public void execute()\n                         if ( propertyWarValue != null )\n                         {\n                             properties.put( Tomcat7Runner.WARS_KEY,\n-                                            propertyWarValue + \";\" + warFileName + \"|\"\n-                                                + warRunDependency.contextPath );\n+                                            propertyWarValue + \";\" + warFileName + \"|\" + warRunDependency.contextPath );\n                         }\n                         else\n                         {\n-                            properties.put( Tomcat7Runner.WARS_KEY,\n-                                            warFileName + \"|\" + warRunDependency.contextPath );\n+                            properties.put( Tomcat7Runner.WARS_KEY, warFileName + \"|\" + warRunDependency.contextPath );\n                         }\n                     }\n                 }",
                "deletions": 6
            },
            {
                "sha": "5e619223495d7bb8a5e0db41727db4d15765941d",
                "filename": "tomcat7-war-runner/src/main/java/org/apache/tomcat/maven/runner/Tomcat7Runner.java",
                "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/c31b4f4f053280d8888a517b93be0208bdd47b88/tomcat7-war-runner/src/main/java/org/apache/tomcat/maven/runner/Tomcat7Runner.java",
                "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/c31b4f4f053280d8888a517b93be0208bdd47b88/tomcat7-war-runner/src/main/java/org/apache/tomcat/maven/runner/Tomcat7Runner.java",
                "status": "modified",
                "changes": 7,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat7-war-runner/src/main/java/org/apache/tomcat/maven/runner/Tomcat7Runner.java?ref=c31b4f4f053280d8888a517b93be0208bdd47b88",
                "patch": "@@ -343,7 +343,12 @@ private static void expandConfigurationFile( String fileName, File extractDirect\n             inputStream = Thread.currentThread().getContextClassLoader().getResourceAsStream( \"conf/\" + fileName );\n             if ( inputStream != null )\n             {\n-                expand( inputStream, new File( extractDirectory, \"conf/\" + fileName ) );\n+                File confDirectory = new File( extractDirectory, \"conf\" );\n+                if ( !confDirectory.exists() )\n+                {\n+                    confDirectory.mkdirs();\n+                }\n+                expand( inputStream, new File( confDirectory, fileName ) );\n             }\n         }\n         finally",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "tomcat-maven-plugin",
        "message": "[MTOMCAT-134] Empty additionalClasspathDir causes NPE in RunMojo.java\nSubmitted by John Meyer.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/maven-plugin/trunk@1309560 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/tomcat-maven-plugin/commit/935b93a7b827d37cc336f0c92f376d47e006ed4b",
        "parent": "https://github.com/apache/tomcat-maven-plugin/commit/9aa19b782170a965968229052ebdade592933cce",
        "bug_id": "tomcat-maven-plugin_2",
        "file": [
            {
                "sha": "342635711fb84c236ab327290bd830b88322c954",
                "filename": "tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java",
                "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java",
                "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java",
                "status": "modified",
                "changes": 20,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java?ref=935b93a7b827d37cc336f0c92f376d47e006ed4b",
                "patch": "@@ -23,6 +23,7 @@\n import org.apache.catalina.loader.WebappLoader;\n import org.apache.catalina.startup.Embedded;\n import org.apache.commons.io.FileUtils;\n+import org.apache.commons.lang.StringUtils;\n import org.apache.maven.artifact.Artifact;\n import org.apache.maven.plugin.MojoExecutionException;\n import org.apache.tomcat.maven.common.run.ClassLoaderEntriesCalculator;\n@@ -48,7 +49,7 @@\n  *\n  * @author Jurgen Lust\n  * @author Mark Hobson <markhobson@gmail.com>\n- * @version $Id: RunMojo.java 13551 2011-02-09 16:05:47Z olamy $\n+ * @version $Id$\n  * @goal run\n  * @execute phase=\"compile\"\n  * @requiresDependencyResolution test\n@@ -204,13 +205,16 @@ public void run()\n             {\n                 for ( String additionalClasspathDir : additionalClasspathDirs )\n                 {\n-                    File file = new File( additionalClasspathDir );\n-                    if ( file.exists() )\n-                    {\n-                        String fileUri = file.toURI().toString();\n-                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n-                        loader.addRepository( fileUri );\n-                    }\n+                \tif( StringUtils.isNotBlank(additionalClasspathDir))\n+                \t{\n+\t                    File file = new File( additionalClasspathDir );\n+\t                    if ( file.exists() )\n+\t                    {\n+\t                        String fileUri = file.toURI().toString();\n+\t                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n+\t                        loader.addRepository( fileUri );\n+\t                    }\n+                \t}\n                 }\n             }\n         }",
                "deletions": 8
            },
            {
                "sha": "6aadf077e2b4de4f2553e5729cea923764989562",
                "filename": "tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java",
                "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java",
                "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java",
                "status": "modified",
                "changes": 18,
                "additions": 11,
                "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java?ref=935b93a7b827d37cc336f0c92f376d47e006ed4b",
                "patch": "@@ -20,6 +20,7 @@\n \n import org.apache.catalina.loader.WebappLoader;\n import org.apache.commons.io.FileUtils;\n+import org.apache.commons.lang.StringUtils;\n import org.apache.maven.artifact.Artifact;\n import org.apache.maven.plugin.MojoExecutionException;\n import org.apache.tomcat.maven.common.run.ClassLoaderEntriesCalculator;\n@@ -265,13 +266,16 @@ public void run()\n             {\n                 for ( String additionalClasspathDir : additionalClasspathDirs )\n                 {\n-                    File file = new File( additionalClasspathDir );\n-                    if ( file.exists() )\n-                    {\n-                        String fileUri = file.toURI().toString();\n-                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n-                        loader.addRepository( fileUri );\n-                    }\n+                \tif( StringUtils.isNotBlank(additionalClasspathDir))\n+                \t{\n+\t                    File file = new File( additionalClasspathDir );\n+\t                    if ( file.exists() )\n+\t                    {\n+\t                        String fileUri = file.toURI().toString();\n+\t                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n+\t                        loader.addRepository( fileUri );\n+\t                    }\n+                \t}\n                 }\n             }\n         }",
                "deletions": 7
            }
        ]
    }
]