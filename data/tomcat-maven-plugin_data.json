[{"commit": "https://github.com/apache/tomcat-maven-plugin/commit/935b93a7b827d37cc336f0c92f376d47e006ed4b", "parent": "https://github.com/apache/tomcat-maven-plugin/commit/9aa19b782170a965968229052ebdade592933cce", "message": "[MTOMCAT-134] Empty additionalClasspathDir causes NPE in RunMojo.java\nSubmitted by John Meyer.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/maven-plugin/trunk@1309560 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "tomcat-maven-plugin_1", "file": [{"additions": 12, "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java", "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java", "sha": "342635711fb84c236ab327290bd830b88322c954", "changes": 20, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java?ref=935b93a7b827d37cc336f0c92f376d47e006ed4b", "patch": "@@ -23,6 +23,7 @@\n import org.apache.catalina.loader.WebappLoader;\n import org.apache.catalina.startup.Embedded;\n import org.apache.commons.io.FileUtils;\n+import org.apache.commons.lang.StringUtils;\n import org.apache.maven.artifact.Artifact;\n import org.apache.maven.plugin.MojoExecutionException;\n import org.apache.tomcat.maven.common.run.ClassLoaderEntriesCalculator;\n@@ -48,7 +49,7 @@\n  *\n  * @author Jurgen Lust\n  * @author Mark Hobson <markhobson@gmail.com>\n- * @version $Id: RunMojo.java 13551 2011-02-09 16:05:47Z olamy $\n+ * @version $Id$\n  * @goal run\n  * @execute phase=\"compile\"\n  * @requiresDependencyResolution test\n@@ -204,13 +205,16 @@ public void run()\n             {\n                 for ( String additionalClasspathDir : additionalClasspathDirs )\n                 {\n-                    File file = new File( additionalClasspathDir );\n-                    if ( file.exists() )\n-                    {\n-                        String fileUri = file.toURI().toString();\n-                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n-                        loader.addRepository( fileUri );\n-                    }\n+                \tif( StringUtils.isNotBlank(additionalClasspathDir))\n+                \t{\n+\t                    File file = new File( additionalClasspathDir );\n+\t                    if ( file.exists() )\n+\t                    {\n+\t                        String fileUri = file.toURI().toString();\n+\t                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n+\t                        loader.addRepository( fileUri );\n+\t                    }\n+                \t}\n                 }\n             }\n         }", "filename": "tomcat6-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat6/RunMojo.java"}, {"additions": 11, "raw_url": "https://github.com/apache/tomcat-maven-plugin/raw/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java", "blob_url": "https://github.com/apache/tomcat-maven-plugin/blob/935b93a7b827d37cc336f0c92f376d47e006ed4b/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java", "sha": "6aadf077e2b4de4f2553e5729cea923764989562", "changes": 18, "status": "modified", "deletions": 7, "contents_url": "https://api.github.com/repos/apache/tomcat-maven-plugin/contents/tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java?ref=935b93a7b827d37cc336f0c92f376d47e006ed4b", "patch": "@@ -20,6 +20,7 @@\n \n import org.apache.catalina.loader.WebappLoader;\n import org.apache.commons.io.FileUtils;\n+import org.apache.commons.lang.StringUtils;\n import org.apache.maven.artifact.Artifact;\n import org.apache.maven.plugin.MojoExecutionException;\n import org.apache.tomcat.maven.common.run.ClassLoaderEntriesCalculator;\n@@ -265,13 +266,16 @@ public void run()\n             {\n                 for ( String additionalClasspathDir : additionalClasspathDirs )\n                 {\n-                    File file = new File( additionalClasspathDir );\n-                    if ( file.exists() )\n-                    {\n-                        String fileUri = file.toURI().toString();\n-                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n-                        loader.addRepository( fileUri );\n-                    }\n+                \tif( StringUtils.isNotBlank(additionalClasspathDir))\n+                \t{\n+\t                    File file = new File( additionalClasspathDir );\n+\t                    if ( file.exists() )\n+\t                    {\n+\t                        String fileUri = file.toURI().toString();\n+\t                        getLog().debug( \"add file:\" + fileUri + \" as a additionalClasspathDir\" );\n+\t                        loader.addRepository( fileUri );\n+\t                    }\n+                \t}\n                 }\n             }\n         }", "filename": "tomcat7-maven-plugin/src/main/java/org/apache/tomcat/maven/plugin/tomcat7/run/RunMojo.java"}], "repo": "tomcat-maven-plugin"}]
