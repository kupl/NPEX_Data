{
    "commons-jexl_05044a7": {
        "repo": "commons-jexl",
        "message": "JEXL:\nProtect against potential NPE\n\ngit-svn-id: https://svn-us.apache.org/repos/asf/commons/proper/jexl/trunk@1821779 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/commons-jexl/commit/05044a7c4a04886dc78a48f8fd71127496b9709f",
        "parent": "https://github.com/apache/commons-jexl/commit/13cf54fe23674761bf19e087c29139676c363774",
        "bug_id": "commons-jexl_05044a7",
        "file": [
            {
                "sha": "b0c3cae7733e94d9feb4a201c9339e563bd52857",
                "filename": "src/main/java/org/apache/commons/jexl3/internal/introspection/MethodKey.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/05044a7c4a04886dc78a48f8fd71127496b9709f/src/main/java/org/apache/commons/jexl3/internal/introspection/MethodKey.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/05044a7c4a04886dc78a48f8fd71127496b9709f/src/main/java/org/apache/commons/jexl3/internal/introspection/MethodKey.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl3/internal/introspection/MethodKey.java?ref=05044a7c4a04886dc78a48f8fd71127496b9709f",
                "patch": "@@ -373,7 +373,7 @@ private static boolean isInvocationConvertible(\n             return true;\n         }\n         /* system asssignable, both sides must be array or not */\n-        if (formal.isAssignableFrom(actual) && (actual != null && actual.isArray() == formal.isArray())) {\n+        if (actual != null && formal.isAssignableFrom(actual) && actual.isArray() == formal.isArray()) {\n             return true;\n         }\n         /** catch all... */",
                "deletions": 1
            }
        ],
        "patched_files": [
            "MethodKey.java"
        ],
        "unit_tests": [
            "MethodKeyTest.java"
        ]
    },
    "commons-jexl_5f1fcc9": {
        "repo": "commons-jexl",
        "message": "Various MethodKey fixes:\n * Fix potential NPEs.\n * Reduce visibility of many methods\n * Use Void.class as a signature for null arguments\n * Need only one AmbiguousException\nPatch by Henri Biestro <hbiestro at gmail dot com>.\nJEXL-67\n\n\ngit-svn-id: https://svn-us.apache.org/repos/asf/commons/proper/jexl/branches/2.0@802288 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/commons-jexl/commit/5f1fcc9538033d82823bc8e69ba225be5a772194",
        "parent": "https://github.com/apache/commons-jexl/commit/158a6018b030def41d77a514990c44df05b9df4b",
        "bug_id": "commons-jexl_5f1fcc9",
        "file": [
            {
                "sha": "1ed47d686aaaa9ae308884a44af575c6d2487691",
                "filename": "src/main/java/org/apache/commons/jexl/util/introspection/IntrospectorBase.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/IntrospectorBase.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/IntrospectorBase.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl/util/introspection/IntrospectorBase.java?ref=5f1fcc9538033d82823bc8e69ba225be5a772194",
                "patch": "@@ -174,7 +174,7 @@ public CacheMiss() {}\n                         l.add(ictor);\n                     }\n                     // try to find one\n-                    ctor = MethodKey.CONSTRUCTORS.getMostSpecific(l, key.getParameters());\n+                    ctor = key.getMostSpecific(l);\n                     if (ctor != null) {\n                         constructorsMap.put(key, ctor);\n                     } else {",
                "deletions": 1
            },
            {
                "sha": "3ff5c7470a05c6c410065da73f2cf99642a15410",
                "filename": "src/main/java/org/apache/commons/jexl/util/introspection/MethodKey.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/MethodKey.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/MethodKey.java",
                "status": "modified",
                "changes": 50,
                "additions": 33,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl/util/introspection/MethodKey.java?ref=5f1fcc9538033d82823bc8e69ba225be5a772194",
                "patch": "@@ -40,7 +40,7 @@\n  * A key can be constructed either from arguments (array of objects) or from parameters\n  * (array of class).\n  * Roughly 3x faster than string key to access the map & uses less memory.\n- * \n+ *\n  * For the parameters methods:\n  * @author <a href=\"mailto:jvanzyl@apache.org\">Jason van Zyl</a>\n  * @author <a href=\"mailto:bob@werken.com\">Bob McWhirter</a>\n@@ -180,6 +180,26 @@ public String debugString() {\n         return builder.toString();\n     }\n \n+    /**\n+     * Gets the most specific method that is applicable to the parameters of this key.\n+     * @param methods a list of methods.\n+     * @return the most specific method.\n+     * @throws MethodKey.AmbiguousException if there is more than one.\n+     */\n+    public Method getMostSpecific(List<Method> methods) {\n+        return METHODS.getMostSpecific(methods, params);\n+    }\n+\n+    /**\n+     * Gets the most specific constructor that is applicable to the parameters of this key.\n+     * @param methods a list of constructors.\n+     * @return the most specific constructor.\n+     * @throws MethodKey.AmbiguousException if there is more than one.\n+     */\n+    public Constructor<?> getMostSpecific(List<Constructor<?>> methods) {\n+        return CONSTRUCTORS.getMostSpecific(methods, params);\n+    }\n+\n     /**\n      * whether a method/ctor is more specific than a previously compared one.\n      */\n@@ -207,9 +227,9 @@ public String debugString() {\n \n     /**\n      * Utility for parameters matching.\n-     * @param <T> method or contructor\n+     * @param <T> Method or Constructor\n      */\n-     public abstract static class Parameters<T> {\n+     private abstract static class Parameters<T> {\n         /**\n          * Extract the parameter types from its applicable argument.\n          * @param app a method or constructor\n@@ -225,7 +245,7 @@ public String debugString() {\n          * @return the most specific method.\n          * @throws MethodKey.AmbiguousException if there is more than one.\n          */\n-        protected T getMostSpecific(List<T> methods, Class<?>[] classes) {\n+        private T getMostSpecific(List<T> methods, Class<?>[] classes) {\n             LinkedList<T> applicables = getApplicables(methods, classes);\n \n             if (applicables.isEmpty()) {\n@@ -357,7 +377,7 @@ private int moreSpecific(Class<?>[] c1, Class<?>[] c2) {\n          *         formal and actual arguments matches, and argument types are assignable\n          *         to formal types through a method invocation conversion).\n          */\n-        protected LinkedList<T> getApplicables(List<T> methods, Class<?>[] classes) {\n+        private LinkedList<T> getApplicables(List<T> methods, Class<?>[] classes) {\n             LinkedList<T> list = new LinkedList<T>();\n \n             for (Iterator<T> imethod = methods.iterator(); imethod.hasNext();) {\n@@ -438,13 +458,8 @@ private boolean isApplicable(T method, Class<?>[] classes) {\n          */\n         private boolean isConvertible(Class<?> formal, Class<?> actual,\n                 boolean possibleVarArg) {\n-            // if we see Void.class as the class of an argument most likely\n-            // obtained through a MethodKey, we consider it\n-            // as a wildcard; non primitives are thus convertible.\n-            if (actual.equals(Void.class) && !formal.isPrimitive()) {\n-                return true;\n-            }\n-            return isInvocationConvertible(formal, actual, possibleVarArg);\n+            // if we see Void.class, the argument was null\n+            return isInvocationConvertible(formal, actual.equals(Void.class)? null : actual, possibleVarArg);\n         }\n \n         /**\n@@ -458,7 +473,8 @@ private boolean isConvertible(Class<?> formal, Class<?> actual,\n          */\n         private boolean isStrictConvertible(Class<?> formal, Class<?> actual,\n                 boolean possibleVarArg) {\n-            return isStrictInvocationConvertible(formal, actual, possibleVarArg);\n+            // if we see Void.class, the argument was null\n+            return isStrictInvocationConvertible(formal, actual.equals(Void.class)? null : actual, possibleVarArg);\n         }\n \n     }\n@@ -531,7 +547,7 @@ public static boolean isInvocationConvertible(Class<?> formal,\n \n         /* Check for vararg conversion. */\n         if (possibleVarArg && formal.isArray()) {\n-            if (actual.isArray()) {\n+            if (actual != null && actual.isArray()) {\n                 actual = actual.getComponentType();\n             }\n             return isInvocationConvertible(formal.getComponentType(),\n@@ -595,7 +611,7 @@ public static boolean isStrictInvocationConvertible(Class<?> formal,\n \n         /* Check for vararg conversion. */\n         if (possibleVarArg && formal.isArray()) {\n-            if (actual.isArray()) {\n+            if (actual != null && actual.isArray()) {\n                 actual = actual.getComponentType();\n             }\n             return isStrictInvocationConvertible(formal.getComponentType(),\n@@ -607,7 +623,7 @@ public static boolean isStrictInvocationConvertible(Class<?> formal,\n     /**\n      * The parameter matching service for methods.\n      */\n-    public static final Parameters<Method> METHODS = new Parameters<Method>() {\n+    private static final Parameters<Method> METHODS = new Parameters<Method>() {\n         @Override\n         protected Class<?>[] getParameterTypes(Method app) {\n             return app.getParameterTypes();\n@@ -618,7 +634,7 @@ public static boolean isStrictInvocationConvertible(Class<?> formal,\n     /**\n      * The parameter matching service for constructors.\n      */\n-    public static final Parameters<Constructor<?>> CONSTRUCTORS = new Parameters<Constructor<?>>() {\n+    private static final Parameters<Constructor<?>> CONSTRUCTORS = new Parameters<Constructor<?>>() {\n         @Override\n         protected Class<?>[] getParameterTypes(Constructor<?> app) {\n             return app.getParameterTypes();",
                "deletions": 17
            },
            {
                "sha": "beeaf0bab914c8807546e91cc8b0bba14a5bf926",
                "filename": "src/main/java/org/apache/commons/jexl/util/introspection/MethodMap.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/MethodMap.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/5f1fcc9538033d82823bc8e69ba225be5a772194/src/main/java/org/apache/commons/jexl/util/introspection/MethodMap.java",
                "status": "modified",
                "changes": 16,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl/util/introspection/MethodMap.java?ref=5f1fcc9538033d82823bc8e69ba225be5a772194",
                "patch": "@@ -122,21 +122,7 @@ Method find(MethodKey methodKey) throws MethodKey.AmbiguousException {\n         if (methodList == null) {\n             return null;\n         }\n-        return MethodKey.METHODS.getMostSpecific(methodList, methodKey.getParameters());\n+        return methodKey.getMostSpecific(methodList);\n     } // CSON: RedundantThrows\n \n-\n-    /**\n-     * Simple distinguishable exception, used when\n-     * we run across ambiguous overloading.  Caught\n-     * by the introspector.\n-     */\n-    public static class AmbiguousException extends RuntimeException {\n-        /**\n-         * Version Id for serializable.\n-         */\n-        private static final long serialVersionUID = -2314636505414551663L;\n-    }\n-\n-\n }\n\\ No newline at end of file",
                "deletions": 15
            }
        ],
        "patched_files": [
            "MethodKey.java"
        ],
        "unit_tests": [
            "MethodKeyTest.java"
        ]
    },
    "commons-jexl_4e2684b": {
        "repo": "commons-jexl",
        "message": "JEXL-62\nAvoid NPE in Interpreter when () omitted from method with no parameters (e.g. var.hashCode)\nIncludes test case.\n\nThanks for patch by Henri Biestro <hbiestro at gmail dot com>.\n\ngit-svn-id: https://svn-us.apache.org/repos/asf/commons/proper/jexl/branches/2.0@799903 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/commons-jexl/commit/4e2684b3bf72c6b719bd141fe555553158548a6b",
        "parent": "https://github.com/apache/commons-jexl/commit/e42b28d69475b365fbf11db17a0f362417461051",
        "bug_id": "commons-jexl_4e2684b",
        "file": [
            {
                "sha": "7d514a690f1701bbd77c152206461d21d39ce2a6",
                "filename": "src/java/org/apache/commons/jexl/Interpreter.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/4e2684b3bf72c6b719bd141fe555553158548a6b/src/java/org/apache/commons/jexl/Interpreter.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/4e2684b3bf72c6b719bd141fe555553158548a6b/src/java/org/apache/commons/jexl/Interpreter.java",
                "status": "modified",
                "changes": 14,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/java/org/apache/commons/jexl/Interpreter.java?ref=4e2684b3bf72c6b719bd141fe555553158548a6b",
                "patch": "@@ -279,6 +279,7 @@ public Object visit(ASTAssignment node, Object data) {\n         JexlNode propertyNode = null;\n         Object property = null;\n         boolean isVariable = true;\n+        int v = 0;\n         StringBuilder variableName = null;\n         // 1: follow children till penultimate\n         int last = left.jjtGetNumChildren() - 1;\n@@ -293,9 +294,11 @@ public Object visit(ASTAssignment node, Object data) {\n             // if we get null back as a result, check for an ant variable\n             if (isVariable) {\n                 String name = ((ASTIdentifier) objectNode).image;\n-                if (c == 0) {\n+                if (v == 0) {\n                     variableName = new StringBuilder(name);\n-                } else {\n+                    v = 1;\n+                }\n+                for(; v <= c; ++v) {\n                     variableName.append('.');\n                     variableName.append(name);\n                 }\n@@ -958,16 +961,19 @@ public Object visit(ASTReference node, Object data) {\n         StringBuilder variableName = null;\n         Map<String, ?> vars = context.getVars();\n         boolean isVariable = true;\n+        int v = 0;\n         for (int i = 0; i < numChildren; i++) {\n             JexlNode theNode = node.jjtGetChild(i);\n             isVariable &= (theNode instanceof ASTIdentifier);\n             result = theNode.jjtAccept(this, result);\n             // if we get null back a result, check for an ant variable\n             if (result == null && isVariable) {\n                 String name = ((ASTIdentifier) theNode).image;\n-                if (i == 0) {\n+                if (v == 0) {\n                     variableName = new StringBuilder(name);\n-                } else {\n+                    v = 1;\n+                }\n+                for(; v <= i; ++v) {\n                     variableName.append('.');\n                     variableName.append(name);\n                 }",
                "deletions": 4
            },
            {
                "sha": "25f946ff539a7eda19095610c76d515e57b31ee0",
                "filename": "src/test/org/apache/commons/jexl/IssuesTest.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/4e2684b3bf72c6b719bd141fe555553158548a6b/src/test/org/apache/commons/jexl/IssuesTest.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/4e2684b3bf72c6b719bd141fe555553158548a6b/src/test/org/apache/commons/jexl/IssuesTest.java",
                "status": "modified",
                "changes": 31,
                "additions": 31,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/test/org/apache/commons/jexl/IssuesTest.java?ref=4e2684b3bf72c6b719bd141fe555553158548a6b",
                "patch": "@@ -183,4 +183,35 @@ public void test11() throws Exception {\n         }\n     }\n \n+    // JEXL-62\n+    public void test62() throws Exception {\n+        JexlContext ctxt;\n+        JexlEngine jexl = new JexlEngine();\n+        jexl.setSilent(true); // to avoid throwing JexlException on null method call\n+        \n+        Script jscript;\n+\n+        ctxt = JexlHelper.createContext();\n+        jscript = jexl.createScript(\"dummy.hashCode()\");\n+        assertEquals(jscript.getText(), null, jscript.execute(ctxt)); // OK\n+\n+        ctxt.getVars().put(\"dummy\", \"abcd\");\n+        assertEquals(jscript.getText(), Integer.valueOf(\"abcd\".hashCode()), jscript.execute(ctxt)); // OK\n+        \n+        jscript = jexl.createScript(\"dummy.hashCode\");\n+        assertEquals(jscript.getText(), null, jscript.execute(ctxt)); // OK\n+\n+        Expression jexpr;\n+\n+        ctxt = JexlHelper.createContext();\n+        jexpr = jexl.createExpression(\"dummy.hashCode()\");\n+        assertEquals(jexpr.getExpression(), null, jexpr.evaluate(ctxt)); // OK\n+\n+        ctxt.getVars().put(\"dummy\", \"abcd\");\n+        assertEquals(jexpr.getExpression(), Integer.valueOf(\"abcd\".hashCode()), jexpr.evaluate(ctxt)); // OK\n+\n+        jexpr = jexl.createExpression(\"dummy.hashCode\");\n+        assertEquals(jexpr.getExpression(), null, jexpr.evaluate(ctxt)); // OK\n+    }\n+\n }\n\\ No newline at end of file",
                "deletions": 0
            }
        ],
        "patched_files": [
            "Interpreter.java"
        ],
        "unit_tests": [
            "IssuesTest.java"
        ]
    },
    "commons-jexl_dc013ef": {
        "repo": "commons-jexl",
        "message": "Script engine must throw NPE if either parameter is null\n\ngit-svn-id: https://svn-us.apache.org/repos/asf/commons/proper/jexl/branches/2.0@799910 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/commons-jexl/commit/dc013efedf7134dd2da4565c90f1f6f7207d42c6",
        "parent": "https://github.com/apache/commons-jexl/commit/a80683ce2276554f0e7929e5ed3731a5156d64a1",
        "bug_id": "commons-jexl_dc013ef",
        "file": [
            {
                "sha": "fa80364158e8ac6894784f201783bf30e23c3bc3",
                "filename": "src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "status": "modified",
                "changes": 9,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java?ref=dc013efedf7134dd2da4565c90f1f6f7207d42c6",
                "patch": "@@ -75,6 +75,10 @@ public Bindings createBindings() {\n \n     /** {@inheritDoc} */\n     public Object eval(Reader script, ScriptContext context) throws ScriptException {\n+        // This is mandated by JSR-223 (see SCR.5.5.2   Methods)\n+        if (script == null || context == null) {\n+            throw new NullPointerException(\"script and context must be non-null\");\n+        }\n         BufferedReader reader = new BufferedReader(script);\n         StringBuilder buffer = new StringBuilder();\n         try {\n@@ -98,8 +102,9 @@ public Object eval(Reader script, ScriptContext context) throws ScriptException\n     /** {@inheritDoc} */\n     @SuppressWarnings(\"unchecked\")\n     public Object eval(String scriptText, final ScriptContext context) throws ScriptException {\n-        if (scriptText == null) {\n-            return null;\n+        // This is mandated by JSR-223 (see SCR.5.5.2   Methods)\n+        if (scriptText == null || context == null) {\n+            throw new NullPointerException(\"script and context must be non-null\");\n         }\n         // This is mandated by JSR-223 (end of section SCR.4.3.4.1.2 - Script Execution)\n         context.setAttribute(\"context\", context, ScriptContext.ENGINE_SCOPE);",
                "deletions": 2
            },
            {
                "sha": "3f879bf3807fd53c4771e3e3c7ddb7d3fd2837f8",
                "filename": "src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "status": "modified",
                "changes": 21,
                "additions": 21,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java?ref=dc013efedf7134dd2da4565c90f1f6f7207d42c6",
                "patch": "@@ -18,10 +18,12 @@\n \n package org.apache.commons.jexl.scripting;\n \n+import java.io.Reader;\n import java.util.Map;\n \n import javax.script.ScriptEngine;\n import javax.script.ScriptEngineManager;\n+import javax.script.ScriptException;\n \n import junit.framework.TestCase;\n \n@@ -50,6 +52,25 @@ public void testScripting() throws Exception {\n         assertEquals(initialValue,engine.get(\"old\"));\n         assertEquals(newValue,engine.get(\"value\"));\n     }\n+    \n+    public void testNulls() throws Exception {\n+        ScriptEngineManager manager = new ScriptEngineManager();\n+        assertNotNull(\"Manager should not be null\", manager);\n+        ScriptEngine engine = manager.getEngineByName(\"jexl\");\n+        assertNotNull(\"Engine should not be null (name)\", engine);\n+        try {\n+            engine.eval((String)null);\n+            fail(\"Should have caused NPE\");\n+        } catch (NullPointerException e) {\n+            // NOOP\n+        }\n+        try {\n+            engine.eval((Reader)null);\n+            fail(\"Should have caused NPE\");\n+        } catch (NullPointerException e) {\n+            // NOOP\n+        }\n+    }\n \n     public void testEngineNames() throws Exception {\n         ScriptEngine engine;",
                "deletions": 0
            }
        ],
        "patched_files": [
            "JexlScriptEngine.java"
        ],
        "unit_tests": [
            "JexlScriptEngineTest.java"
        ]
    },
    "commons-jexl_9dab666": {
        "repo": "commons-jexl",
        "message": "JEXL-324: fixed grammar for new(arg, ...), made one arg mandatory\n- fixed debugger (belt and suspenders)\nTask #JEXL-324 - JexlEngine.createExpression(\"new()\").getParsedText() throws NPE",
        "commit": "https://github.com/apache/commons-jexl/commit/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8",
        "parent": "https://github.com/apache/commons-jexl/commit/51a981c900b77109ed090a616b2358b80ccb3e9d",
        "bug_id": "commons-jexl_9dab666",
        "file": [
            {
                "sha": "e3ffecc9a6022d98071c372616c0937bd13da98a",
                "filename": "src/main/java/org/apache/commons/jexl3/internal/Debugger.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/main/java/org/apache/commons/jexl3/internal/Debugger.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/main/java/org/apache/commons/jexl3/internal/Debugger.java",
                "status": "modified",
                "changes": 12,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl3/internal/Debugger.java?ref=9dab666d3ecb09fc9ab2e9acd9486ac066e888c8",
                "patch": "@@ -801,10 +801,12 @@ protected Object visit(ASTMapLiteral node, Object data) {\n     protected Object visit(ASTConstructorNode node, Object data) {\n         int num = node.jjtGetNumChildren();\n         builder.append(\"new(\");\n-        accept(node.jjtGetChild(0), data);\n-        for (int i = 1; i < num; ++i) {\n-            builder.append(\", \");\n-            accept(node.jjtGetChild(i), data);\n+        if (num > 0) {\n+            accept(node.jjtGetChild(0), data);\n+            for (int i = 1; i < num; ++i) {\n+                builder.append(\", \");\n+                accept(node.jjtGetChild(i), data);\n+            }\n         }\n         builder.append(\")\");\n         return data;\n@@ -818,7 +820,7 @@ protected Object visit(ASTFunctionNode node, Object data) {\n             builder.append(\":\");\n             accept(node.jjtGetChild(1), data);\n             accept(node.jjtGetChild(2), data);\n-        } else {\n+        } else if (num == 2) {\n             accept(node.jjtGetChild(0), data);\n             accept(node.jjtGetChild(1), data);\n         }",
                "deletions": 5
            },
            {
                "sha": "5cbb9a61504bd8e9be8f838c170b61f2f7d8cd7b",
                "filename": "src/main/java/org/apache/commons/jexl3/parser/Parser.jjt",
                "blob_url": "https://github.com/apache/commons-jexl/blob/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt",
                "raw_url": "https://github.com/apache/commons-jexl/raw/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/main/java/org/apache/commons/jexl3/parser/Parser.jjt?ref=9dab666d3ecb09fc9ab2e9acd9486ac066e888c8",
                "patch": "@@ -70,8 +70,8 @@ public final class Parser extends JexlParser\n         } catch (TokenMgrError xtme) {\n             throw new JexlException.Tokenization(info, xtme).clean();\n         } catch (ParseException xparse) {\n-            Token errortok = token.next;\n-            throw new JexlException.Parsing(info.at(errortok.beginLine, errortok.beginColumn), token.image).clean();\n+            Token errortok = jj_lastpos != null? jj_lastpos : jj_scanpos != null ? jj_scanpos : token;\n+            throw new JexlException.Parsing(info.at(errortok.beginLine, errortok.beginColumn), errortok.image).clean();\n         } finally {\n             token_source.defaultLexState = DEFAULT;\n             cleanup(previous);\n@@ -811,7 +811,7 @@ void FunctionCall() #void : {}\n \n void Constructor() #ConstructorNode() : {}\n {\n-  <NEW> <LPAREN> [ Expression() ( <COMMA> Expression() )* ] <RPAREN>\n+  <NEW> <LPAREN> Expression() ( <COMMA> Expression() )* <RPAREN>\n }\n \n void Parameter() #void :",
                "deletions": 3
            },
            {
                "sha": "a7b590471902238ee224c5a2a5613e0463a0275e",
                "filename": "src/test/java/org/apache/commons/jexl3/Issues300Test.java",
                "blob_url": "https://github.com/apache/commons-jexl/blob/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/test/java/org/apache/commons/jexl3/Issues300Test.java",
                "raw_url": "https://github.com/apache/commons-jexl/raw/9dab666d3ecb09fc9ab2e9acd9486ac066e888c8/src/test/java/org/apache/commons/jexl3/Issues300Test.java",
                "status": "modified",
                "changes": 40,
                "additions": 39,
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/test/java/org/apache/commons/jexl3/Issues300Test.java?ref=9dab666d3ecb09fc9ab2e9acd9486ac066e888c8",
                "patch": "@@ -25,6 +25,7 @@\n import java.util.Map;\n import org.junit.Assert;\n import static org.junit.Assert.assertEquals;\n+import org.junit.Ignore;\n import org.junit.Test;\n \n /**\n@@ -377,5 +378,42 @@ public void test322() throws Exception {\n             Assert.assertEquals(ctls[i], output);\n         }\n     }\n-\n+    \n+    @Ignore\n+    public void test323() throws Exception {\n+        // Create or retrieve an engine\n+        JexlEngine jexl = new JexlBuilder().safe(false).create();\n+        // on recent code: JexlEngine jexl = new JexlBuilder().safe(false).create();\n+\n+        // Populate to identical global variables\n+        JexlContext jc = new MapContext();\n+        jc.set(\"NormalVariable\", null);\n+        jc.set(\"ant.variable\", null);\n+\n+        // Evaluate the value of the normal variable\n+        JexlExpression expression1 = jexl.createExpression(\"NormalVariable\");\n+        Object o1 = expression1.evaluate(jc);\n+        Assert.assertEquals(null, o1);\n+\n+        // Evaluate the value of the ant-style variable\n+        JexlExpression expression2 = jexl.createExpression(\"ant.variable\");\n+        Object o2 = expression2.evaluate(jc); // <-- BUG: throws exception instead of returning null\n+        Assert.assertEquals(null, o2);\n+    }\n+    \n+    @Test\n+    public void test324() throws Exception {\n+        JexlEngine jexl = new JexlBuilder().create();\n+        String src42 = \"new('java.lang.Integer', 42)\";\n+        JexlExpression expr0 = jexl.createExpression(src42);\n+        Assert.assertEquals(42, expr0.evaluate(null));\n+        String parsed = expr0.getParsedText();\n+        Assert.assertEquals(src42, parsed);\n+        try {\n+            JexlExpression expr = jexl.createExpression(\"new()\");\n+            Assert.fail(\"should not parse\");\n+        } catch (JexlException.Parsing xparse) {\n+            Assert.assertTrue(xparse.toString().contains(\"new\"));\n+        }\n+    }\n }",
                "deletions": 1
            }
        ],
        "patched_files": [
            "Debugger.java"
        ],
        "unit_tests": [
            "Issues300Test.java"
        ]
    }
}