{
    "xmlgraphics-batik_05cbb69": {
        "bug_id": "xmlgraphics-batik_05cbb69",
        "commit": "https://github.com/apache/xmlgraphics-batik/commit/05cbb69bbb9d6b1210efde1f339dbea1acef96a3",
        "file": [
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/sources/org/apache/batik/gvt/flow/FlowTextPainter.java",
                "changes": 26,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/gvt/flow/FlowTextPainter.java?ref=05cbb69bbb9d6b1210efde1f339dbea1acef96a3",
                "deletions": 11,
                "filename": "sources/org/apache/batik/gvt/flow/FlowTextPainter.java",
                "patch": "@@ -262,22 +262,26 @@ public static boolean textWrap(AttributedCharacterIterator [] acis,\n         return overflow;\n     }\n \n-    static int [] allocWordMap(int [] wordMap, int sz) {\n+    static int[] allocWordMap(int[] wordMap, int sz) {\n         if (wordMap != null) {\n-            if (sz <= wordMap.length)\n+            if (sz <= wordMap.length) {\n                 return wordMap;\n-            if (sz < wordMap.length*2)\n-                sz = wordMap.length*2;\n+            }\n+            if (sz < wordMap.length * 2) {\n+                sz = wordMap.length * 2;\n+            }\n         }\n \n         // we have a problem when wordMap actually IS null....\n-        int [] ret = new int[sz];\n-        int ext=0;\n-        if (wordMap != null)\n-            ext = wordMap.length;\n-        if (sz < ext) ext = sz;\n-        System.arraycopy( wordMap, 0, ret, 0, ext );\n-        Arrays.fill( ret, ext, sz, -1 );\n+        int[] ret = new int[sz];\n+        int ext = wordMap != null ? wordMap.length : 0;\n+        if (sz < ext) {\n+            ext = sz;\n+        }\n+        if (ext != 0) {\n+            System.arraycopy(wordMap, 0, ret, 0, ext);\n+        }\n+        Arrays.fill(ret, ext, sz, -1);\n \n         return ret;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/sources/org/apache/batik/gvt/flow/FlowTextPainter.java",
                "sha": "85dca6bc5bb759c839815d9b1c687dd827f1d25b",
                "status": "modified"
            },
            {
                "additions": 23,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/JSVGCanvasHandler.java",
                "changes": 34,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-sources/org/apache/batik/swing/JSVGCanvasHandler.java?ref=05cbb69bbb9d6b1210efde1f339dbea1acef96a3",
                "deletions": 11,
                "filename": "test-sources/org/apache/batik/swing/JSVGCanvasHandler.java",
                "patch": "@@ -23,6 +23,7 @@ Licensed to the Apache Software Foundation (ASF) under one or more\n import java.awt.event.WindowAdapter;\n import java.awt.event.WindowEvent;\n import java.awt.event.WindowListener;\n+import java.lang.ref.WeakReference;\n \n import javax.swing.JFrame;\n \n@@ -107,7 +108,7 @@ public static String fmt(String key, Object []args) {\n \n     JFrame     frame = null;\n     JSVGCanvas canvas = null;\n-    UpdateManager updateManager = null;\n+    WeakReference updateManager = null;\n     WindowListener wl = null;\n     InitialRenderListener irl = null;\n     LoadListener ll = null;\n@@ -156,7 +157,7 @@ public void runCanvas(String desc) {\n                 checkRender();\n                 if ( abort) return;\n \n-                if (updateManager == null)\n+                if (updateManager == null || updateManager.get() == null)\n                     return;\n \n                 while (!done) {\n@@ -213,22 +214,24 @@ public void windowClosing(WindowEvent e) {\n     public void scriptDone() {\n         Runnable r = new Runnable() {\n                 public void run() {\n-                    if (updateManager != null)\n-                        updateManager.forceRepaint();\n+                    UpdateManager um = getUpdateManager();\n+                    if (um != null)\n+                        um.forceRepaint();\n                     synchronized(renderMonitor) {\n                         done = true;\n                         failed = false;\n                         renderMonitor.notifyAll();\n                     }\n                 }\n             };\n-        if ((updateManager == null) ||\n-            (!updateManager.isRunning())){\n+        UpdateManager um = getUpdateManager();\n+        if ((um == null) ||\n+            (!um.isRunning())){\n             // Don't run it in this thread or we deadlock the event queue.\n             Thread t = new Thread(r);\n             t.start();\n         } else {\n-            updateManager.getUpdateRunnableQueue().invokeLater(r);\n+            um.getUpdateRunnableQueue().invokeLater(r);\n         }\n     }\n \n@@ -286,10 +289,11 @@ public void checkUpdate() {\n     }\n \n     public void bindHost() {\n+        UpdateManager um = getUpdateManager();\n         RunnableQueue rq;\n-        rq = updateManager.getUpdateRunnableQueue();\n+        rq = um.getUpdateRunnableQueue();\n         rq.invokeLater(new Runnable() {\n-                UpdateManager um = updateManager;\n+                UpdateManager um = getUpdateManager();\n                 public void run() {\n                     ScriptingEnvironment scriptEnv;\n                     scriptEnv = um.getScriptingEnvironment();\n@@ -306,6 +310,13 @@ public void run() {\n             });\n     }\n \n+    protected UpdateManager getUpdateManager() {\n+        if (updateManager != null) {\n+            return (UpdateManager) updateManager.get();\n+        }\n+        return null;\n+    }\n+\n     class UpdateRenderListener implements UpdateManagerListener {\n         public void updateCompleted(UpdateManagerEvent e) {\n             synchronized(renderMonitor){\n@@ -374,9 +385,10 @@ public void documentLoadingCancelled(SVGDocumentLoaderEvent e) {\n         public void svgLoadEventDispatchStarted(SVGLoadEventDispatcherEvent e){\n             SVGLoadEventDispatcher dispatcher;\n             dispatcher = (SVGLoadEventDispatcher)e.getSource();\n-            updateManager = dispatcher.getUpdateManager();\n+            UpdateManager um = dispatcher.getUpdateManager();\n+            updateManager = new WeakReference(um);\n             url = new UpdateRenderListener();\n-            updateManager.addUpdateManagerListener(url);\n+            um.addUpdateManagerListener(url);\n         }\n     }\n     ",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/JSVGCanvasHandler.java",
                "sha": "1e53009e44c70718f8c26e95c32bb9b8ade59cbe",
                "status": "modified"
            },
            {
                "additions": 19,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "changes": 25,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java?ref=05cbb69bbb9d6b1210efde1f339dbea1acef96a3",
                "deletions": 6,
                "filename": "test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "patch": "@@ -20,6 +20,7 @@ Licensed to the Apache Software Foundation (ASF) under one or more\n \n import java.io.File;\n import java.net.MalformedURLException;\n+import java.lang.ref.WeakReference;\n \n import javax.swing.JFrame;\n import javax.swing.SwingUtilities;\n@@ -55,7 +56,19 @@ public JSVGMemoryLeakTest() {\n     boolean done;\n     JSVGCanvasHandler handler;\n     JFrame theFrame;\n-    JSVGCanvas theCanvas;\n+\n+    /**\n+     * A WeakReference to the JSVGCanvas.\n+     */\n+    WeakReference theCanvas;\n+\n+    protected void setTheCanvas(JSVGCanvas c) {\n+        theCanvas = new WeakReference(c);\n+    }\n+\n+    protected JSVGCanvas getTheCanvas() {\n+        return (JSVGCanvas) theCanvas.get();\n+    }\n \n     public static String fmt(String key, Object []args) {\n         return TestMessages.formatMessage(key, args);\n@@ -74,8 +87,8 @@ public TestReport doSomething() throws Exception {\n         SwingUtilities.invokeAndWait( new Runnable() {\n                 public void run() {\n                     // System.out.println(\"In Invoke\");\n-                    theFrame.remove(theCanvas);\n-                    theCanvas.dispose();\n+                    theFrame.remove(getTheCanvas());\n+                    getTheCanvas().dispose();\n \n                     theFrame.dispose();\n                     theFrame=null;\n@@ -119,7 +132,7 @@ public void scriptDone() {\n \n     public void registerElement(Element e, String desc) {\n         registerObjectDesc(e, desc);\n-        UpdateManager um = theCanvas.getUpdateManager();\n+        UpdateManager um = getTheCanvas().getUpdateManager();\n         BridgeContext bc = um.getBridgeContext();\n         GraphicsNode gn = bc.getGraphicsNode(e);\n         if (gn != null)\n@@ -134,7 +147,7 @@ public void registerElement(Element e, String desc) {\n     }\n \n     public void registerResourceContext(String uriSubstring, String desc) {\n-        UpdateManager um = theCanvas.getUpdateManager();\n+        UpdateManager um = getTheCanvas().getUpdateManager();\n         BridgeContext bc = um.getBridgeContext();\n         BridgeContext[] ctxs = bc.getChildContexts();\n         for (int i = 0; i < ctxs.length; i++) {\n@@ -152,7 +165,7 @@ public void registerResourceContext(String uriSubstring, String desc) {\n     /* JSVGCanvasHandler.Delegate Interface */\n     public boolean canvasInit(JSVGCanvas canvas) {\n         // System.err.println(\"In Init\");\n-        theCanvas = canvas;\n+        setTheCanvas(canvas);\n         theFrame  = handler.getFrame();\n \n         File f = new File(getId());",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "sha": "c09a5384d025504301d715cde4c4890c959674fe",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/NullSetSVGDocumentTest.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-sources/org/apache/batik/swing/NullSetSVGDocumentTest.java?ref=05cbb69bbb9d6b1210efde1f339dbea1acef96a3",
                "deletions": 1,
                "filename": "test-sources/org/apache/batik/swing/NullSetSVGDocumentTest.java",
                "patch": "@@ -84,7 +84,7 @@ public void run() {\n \n     /* JSVGCanvasHandler.Delegate Interface */\n     public boolean canvasInit(JSVGCanvas canvas) {\n-        theCanvas = canvas;\n+        setTheCanvas(canvas);\n         theFrame  = handler.getFrame();\n \n         canvas.setDocumentState(JSVGCanvas.ALWAYS_DYNAMIC);",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/05cbb69bbb9d6b1210efde1f339dbea1acef96a3/test-sources/org/apache/batik/swing/NullSetSVGDocumentTest.java",
                "sha": "5edf80ebd54bb7a5946ab38252495a196f23eaff",
                "status": "modified"
            }
        ],
        "message": "1. Fixed memory leak test to avoid false positives.\n2. Avoid NPE in gvt/flow/FlowTextPainter.java.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xmlgraphics/batik/trunk@503369 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/xmlgraphics-batik/commit/3a86644c217b5bc0e9459eabc4ff3df9e711322b",
        "patched_files": [
            "JSVGCanvasHandler.java",
            "FlowTextPainter.java"
        ],
        "repo": "xmlgraphics-batik",
        "unit_tests": [
            "NullSetSVGDocumentTest.java",
            "JSVGMemoryLeakTest.java"
        ]
    },
    "xmlgraphics-batik_24641b5": {
        "bug_id": "xmlgraphics-batik_24641b5",
        "commit": "https://github.com/apache/xmlgraphics-batik/commit/24641b566dfe9655b5bfd0ae31b54c64db2f06ff",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/24641b566dfe9655b5bfd0ae31b54c64db2f06ff/sources/org/apache/batik/bridge/BaseScriptingEnvironment.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/BaseScriptingEnvironment.java?ref=24641b566dfe9655b5bfd0ae31b54c64db2f06ff",
                "deletions": 1,
                "filename": "sources/org/apache/batik/bridge/BaseScriptingEnvironment.java",
                "patch": "@@ -429,7 +429,7 @@ public void loadScripts() {\n                         }\n                     }\n                     if (reader == null) {\n-                        if (mediaType.equals(APPLICATION_ECMASCRIPT)) {\n+                        if (APPLICATION_ECMASCRIPT.equals(mediaType)) {\n                             // No encoding was specified in the MIME type, so\n                             // infer it according to RFC 4329.\n                             if (purl.hasContentTypeParameter(\"version\")) {",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/24641b566dfe9655b5bfd0ae31b54c64db2f06ff/sources/org/apache/batik/bridge/BaseScriptingEnvironment.java",
                "sha": "bd3d9ce44da734ad112cbd5243d5f708d0cbf6e8",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/24641b566dfe9655b5bfd0ae31b54c64db2f06ff/sources/org/apache/batik/util/ParsedURLData.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/util/ParsedURLData.java?ref=24641b566dfe9655b5bfd0ae31b54c64db2f06ff",
                "deletions": 0,
                "filename": "sources/org/apache/batik/util/ParsedURLData.java",
                "patch": "@@ -320,6 +320,9 @@ public String getContentTypeCharset(String userAgent) {\n      */\n     public boolean hasContentTypeParameter(String userAgent, String param) {\n         getContentType(userAgent);\n+        if (contentType == null) {\n+            return false;\n+        }\n         int i = 0;\n         int len = contentType.length();\n         int plen = param.length();\n@@ -367,6 +370,9 @@ public boolean hasContentTypeParameter(String userAgent, String param) {\n      */\n     protected void extractContentTypeParts(String userAgent) {\n         getContentType(userAgent);\n+        if (contentType == null) {\n+            return;\n+        }\n         int i = 0;\n         int len = contentType.length();\n loop1:  while (i < len) {",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/24641b566dfe9655b5bfd0ae31b54c64db2f06ff/sources/org/apache/batik/util/ParsedURLData.java",
                "sha": "7656309dce0c7eb545016d4654bf9fe47bbc2dcf",
                "status": "modified"
            }
        ],
        "message": "1. Avoid NPEs when loading scripts from file: URIs.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xmlgraphics/batik/trunk@488643 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/xmlgraphics-batik/commit/73f1f9d88ea67e74723727d70e3bb71dc8c3eb8c",
        "patched_files": [
            "ParsedURLData.java"
        ],
        "repo": "xmlgraphics-batik",
        "unit_tests": [
            "ParsedURLDataTest.java"
        ]
    },
    "xmlgraphics-batik_2fcac4c": {
        "bug_id": "xmlgraphics-batik_2fcac4c",
        "commit": "https://github.com/apache/xmlgraphics-batik/commit/2fcac4c3828a56f09070673659da147ddf47aad8",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/bridge/SVGGlyphElementBridge.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/SVGGlyphElementBridge.java?ref=2fcac4c3828a56f09070673659da147ddf47aad8",
                "deletions": 1,
                "filename": "sources/org/apache/batik/bridge/SVGGlyphElementBridge.java",
                "patch": "@@ -126,7 +126,8 @@ public Glyph createGlyph(BridgeContext ctx,\n         Shape dShape = null;\n         if (d.length() != 0) {\n             AWTPathProducer app = new AWTPathProducer();\n-            app.setWindingRule(CSSUtilities.convertFillRule(glyphElement));\n+            // Glyph is supposed to use properties from text element.\n+            app.setWindingRule(CSSUtilities.convertFillRule(textElement));\n             try {\n                 PathParser pathParser = new PathParser();\n                 pathParser.setPathHandler(app);",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/bridge/SVGGlyphElementBridge.java",
                "sha": "2339f55853b9ab209087518d68fe68a4f685ded8",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/dom/svg/SVGOMFEPointLightElement.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/dom/svg/SVGOMFEPointLightElement.java?ref=2fcac4c3828a56f09070673659da147ddf47aad8",
                "deletions": 1,
                "filename": "sources/org/apache/batik/dom/svg/SVGOMFEPointLightElement.java",
                "patch": "@@ -106,7 +106,7 @@ public SVGAnimatedNumber getY() {\n      * <b>DOM</b>: Implements {@link SVGFEPointLightElement#getZ()}.\n      */\n     public SVGAnimatedNumber getZ() {\n-        return getAnimatedNumberAttribute(null, SVG_Y_ATTRIBUTE, 0f);\n+        return getAnimatedNumberAttribute(null, SVG_Z_ATTRIBUTE, 0f);\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/dom/svg/SVGOMFEPointLightElement.java",
                "sha": "45b6cce742addd3ec218ae39c7f265db6f0ae417",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/ext/awt/geom/RectListManager.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/ext/awt/geom/RectListManager.java?ref=2fcac4c3828a56f09070673659da147ddf47aad8",
                "deletions": 0,
                "filename": "sources/org/apache/batik/ext/awt/geom/RectListManager.java",
                "patch": "@@ -618,6 +618,7 @@ public void add(RectListManager rlm) {\n     }\n \n     public void mergeRects(int overhead, int lineOverhead) {\n+        if (size == 0) return;\n         Rectangle r, cr, mr;\n         int cost1, cost2, cost3;\n         mr = new Rectangle();\n@@ -708,6 +709,7 @@ public void mergeRects(int overhead, int lineOverhead) {\n         }\n         size = j;\n         r = getBounds();\n+        if (r == null) return;\n         if (overhead + (r.height*lineOverhead) + (r.height*r.width) < area) {\n             rects[0] = r;\n             size=1;",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/2fcac4c3828a56f09070673659da147ddf47aad8/sources/org/apache/batik/ext/awt/geom/RectListManager.java",
                "sha": "245f04ba80d3e711043cab987251d4653d88b40e",
                "status": "modified"
            }
        ],
        "message": "1) Fixed NPE in RectListManager when the rect list was empty.\n2) FePointLightElement now returns the Z attribute not Y when appropriate.\n3) The glyph element's d attribute now uses the winding-rule property value\n   from the text element not from the glyph element (as per the SVG\n   specification)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xmlgraphics/batik/trunk@201321 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/xmlgraphics-batik/commit/0a5a8102897a5b2cf5afc528c5962a83ab3a671d",
        "patched_files": [
            "RectListManager.java"
        ],
        "repo": "xmlgraphics-batik",
        "unit_tests": [
            "RectListManagerTest.java"
        ]
    },
    "xmlgraphics-batik_a7afbd4": {
        "bug_id": "xmlgraphics-batik_a7afbd4",
        "commit": "https://github.com/apache/xmlgraphics-batik/commit/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/CHANGES",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/CHANGES?ref=a7afbd4c9256bcd645a14d6ab485dc2aefe51a21",
                "deletions": 1,
                "filename": "CHANGES",
                "patch": "@@ -16,7 +16,7 @@ Bug fixing is an on-going task, so it is implied in all sub-releases.\n     42543, 42645, 42651, 42697, 42698, 42807, 42961, 42963, 42968,\n     43022, 43043, 43045, 43165, 43194, 43195, 43370, 43418, 43446,\n     43638, 43657, 43744, 43760, 43764, 43787, 43854, 43871, 43904,\n-    43953, 44029, 44092\n+    43953, 44029, 44054, 44092\n \n 2. New features\n ",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/CHANGES",
                "sha": "53981d963193e00a023e148339af826ceea67451",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/sources/org/apache/batik/css/engine/CSSEngine.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/css/engine/CSSEngine.java?ref=a7afbd4c9256bcd645a14d6ab485dc2aefe51a21",
                "deletions": 1,
                "filename": "sources/org/apache/batik/css/engine/CSSEngine.java",
                "patch": "@@ -824,7 +824,7 @@ public void property(String pname, LexicalUnit lu,\n                         styleDeclarationDocumentHandler.styleMap = null;\n                     } catch (Exception e) {\n                         String m = e.getMessage();\n-                        if (m == null) m = \"\";\n+                        if (m == null) m = e.getClass().getName();\n                         String u = ((documentURI == null)?\"<unknown>\":\n                                     documentURI.toString());\n                         String s = Messages.formatMessage",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/sources/org/apache/batik/css/engine/CSSEngine.java",
                "sha": "b4db90f275eb457dd2e486f49b0eb77075904df9",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/sources/org/apache/batik/util/ParsedURL.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/util/ParsedURL.java?ref=a7afbd4c9256bcd645a14d6ab485dc2aefe51a21",
                "deletions": 3,
                "filename": "sources/org/apache/batik/util/ParsedURL.java",
                "patch": "@@ -229,11 +229,12 @@ public ParsedURL(URL baseURL, String urlStr) {\n      *               the missing pieces will be taken from the baseURL.\n      */\n     public ParsedURL(ParsedURL baseURL, String urlStr) {\n-        userAgent = baseURL.getUserAgent();\n-        if (baseURL != null)\n+        if (baseURL != null) {\n+            userAgent = baseURL.getUserAgent();\n             data = parseURL(baseURL, urlStr);\n-        else\n+        } else {\n             data = parseURL(urlStr);\n+        }\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/a7afbd4c9256bcd645a14d6ab485dc2aefe51a21/sources/org/apache/batik/util/ParsedURL.java",
                "sha": "1fbda9122aafe16895bc82372910a694053472ad",
                "status": "modified"
            }
        ],
        "message": "Avoid NPE in ParsedURL constructor.  Fixes bug 44054.\n\nSubmitted by: Jeremias M\u00e4rki <jeremias (at) apache.org>\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xmlgraphics/batik/trunk@606891 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/xmlgraphics-batik/commit/4b319edb9ce72baddb758d4756c756a588977b83",
        "patched_files": [
            "CHANGES",
            "ParsedURL.java"
        ],
        "repo": "xmlgraphics-batik",
        "unit_tests": [
            "ParsedURLTest.java"
        ]
    },
    "xmlgraphics-batik_cb22022": {
        "bug_id": "xmlgraphics-batik_cb22022",
        "commit": "https://github.com/apache/xmlgraphics-batik/commit/cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/build.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/build.xml?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 1,
                "filename": "build.xml",
                "patch": "@@ -1091,7 +1091,7 @@ To display the available targets type:\n     <java fork=\"yes\"\n           classname=\"${class-prefix}.test.xml.XMLTestSuiteRunner\">\n <!--      <jvmarg value=\"-Xrunhprof:format=b\" /> -->\n-<!--      <jvmarg value=\"-Xrunhprof:net=localhost:7001,format=b\" /> -->\n+<!--      <jvmarg value=\"-Xrunhprof:net=localhost:1234,format=b\" /> -->\n       <jvmarg value=\"-Xmx512m\"/>  <jvmarg value=\"-Xms64m\"/>\n       <classpath>\n         <pathelement location=\"${dest}\" />",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/build.xml",
                "sha": "1380de948b0409f59f9f8966d71275151fe5b7f6",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/resources/org/apache/batik/apps/svgbrowser/resources/GUI.properties",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/resources/org/apache/batik/apps/svgbrowser/resources/GUI.properties?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 2,
                "filename": "resources/org/apache/batik/apps/svgbrowser/resources/GUI.properties",
                "patch": "@@ -384,11 +384,11 @@ ToolReload.tooltip   = Reload the current document.\n \n ToolBack.icon      = resources/back.gif\n ToolBack.action    = BackAction\n-ToolBack.tooltip   = Back To The Previous The Document\n+ToolBack.tooltip   = Move back to the previous document.\n \n ToolForward.icon      = resources/forward.gif\n ToolForward.action    = ForwardAction\n-ToolForward.tooltip   = Forward To The Next The Document\n+ToolForward.tooltip   = Move forward to the next document.\n \n ToolPrint.icon      = resources/print.gif\n ToolPrint.action    = PrintAction",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/resources/org/apache/batik/apps/svgbrowser/resources/GUI.properties",
                "sha": "1d82a216fda7f78078f8d4749ca5ab3f231b610e",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/apps/svgbrowser/JSVGViewerFrame.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/apps/svgbrowser/JSVGViewerFrame.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 8,
                "filename": "sources/org/apache/batik/apps/svgbrowser/JSVGViewerFrame.java",
                "patch": "@@ -1948,18 +1948,15 @@ public void setSVGDocument(SVGDocument svgDocument,\n \n         String dt = svgDocumentTitle;\n         if (dt.length() != 0) {\n-            setTitle(title + \":\" + dt);\n+            setTitle(title + \": \" + dt);\n         } else {\n             int i = s.lastIndexOf(\"/\");\n-            if (i == -1) {\n+            if (i == -1)\n                 i = s.lastIndexOf(\"\\\\\");\n-                if (i == -1) {\n-                    setTitle(title + \":\" + s);\n-                } else {\n-                    setTitle(title + \":\" + s.substring(i + 1));\n-                }\n+            if (i == -1) {\n+                setTitle(title + \": \" + s);\n             } else {\n-                setTitle(title + \":\" + s.substring(i + 1));\n+                setTitle(title + \": \" + s.substring(i + 1));\n             }\n         }\n ",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/apps/svgbrowser/JSVGViewerFrame.java",
                "sha": "8cf61e222fcaff4844eaee004b661e46f50aeae3",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/AbstractGraphicsNodeBridge.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/AbstractGraphicsNodeBridge.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/bridge/AbstractGraphicsNodeBridge.java",
                "patch": "@@ -433,4 +433,8 @@ public float getFontSize() {\n         return CSSUtilities.getComputedStyle\n             (e, SVGCSSEngine.FONT_SIZE_INDEX).getFloatValue();\n     }\n+\n+    public void deselectAll() {\n+        ctx.getUserAgent().deselectAll();\n+    }\n }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/AbstractGraphicsNodeBridge.java",
                "sha": "25887ec193c72477a1fd9fddcd863800825bc78b",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGImageElementBridge.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/SVGImageElementBridge.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 1,
                "filename": "sources/org/apache/batik/bridge/SVGImageElementBridge.java",
                "patch": "@@ -713,7 +713,10 @@ public void dispose() {\n             tgt.removeEventListener(SVG_EVENT_MOUSEUP,   listener, false);\n             listener = null;\n         }\n-        subCtx.removeUIEventListeners(imgDocument);\n+        if (subCtx != null) {\n+            subCtx.removeUIEventListeners(imgDocument);\n+        }\n+\n         imgDocument = null;\n         subCtx = null;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGImageElementBridge.java",
                "sha": "746c5563e44cd9533f72f003454db9428378ce4a",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGTextElementBridge.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/SVGTextElementBridge.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/bridge/SVGTextElementBridge.java",
                "patch": "@@ -2028,6 +2028,13 @@ public float getSubStringLength(int charnum, int nchars){\n         public int getCharNumAtPosition(float x , float y){\n             return textBridge.getCharNumAtPosition(e,x,y);\n         }\n+        /**\n+         * Informs the user agent that the text selection should be\n+         * cleared.\n+         */\n+        public void deselectAll() {\n+            textBridge.deselectAll();\n+        }\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGTextElementBridge.java",
                "sha": "46a056edce11b5a668bdd3b82f0a6244431bae08",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGUseElementBridge.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/SVGUseElementBridge.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 8,
                "filename": "sources/org/apache/batik/bridge/SVGUseElementBridge.java",
                "patch": "@@ -144,6 +144,7 @@ public GraphicsNode createGraphicsNode(BridgeContext ctx, Element e) {\n         }\n \n         Element refElement = ctx.getReferencedElement(e, uri);\n+\n         SVGOMDocument document\n             = (SVGOMDocument)e.getOwnerDocument();\n         SVGOMDocument refDocument\n@@ -222,20 +223,15 @@ public GraphicsNode createGraphicsNode(BridgeContext ctx, Element e) {\n         CSSUtilities.computeStyleAndURIs(refElement, localRefElement, uri);\n \n         GVTBuilder builder = ctx.getGVTBuilder();\n-        GraphicsNode refNode = builder.build(theCtx, g);\n+        GraphicsNode refNode = builder.build(ctx, g);\n \n         ///////////////////////////////////////////////////////////////////////\n-        boolean update = true;\n         if (gn == null) {\n             gn = new CompositeGraphicsNode();\n-            update = false;\n-        }\n-\n-        if (update) {\n+        } else {\n             int s = gn.size();\n-            for (int i=0; i<s; i++) {\n+            for (int i=0; i<s; i++)\n                 gn.remove(0);\n-            }\n         }\n \n         gn.getChildren().add(refNode);\n@@ -248,6 +244,7 @@ public GraphicsNode createGraphicsNode(BridgeContext ctx, Element e) {\n         // 'visibility'\n         gn.setVisible(CSSUtilities.convertVisibility(e));\n \n+\n         // 'enable-background'\n         Rectangle2D r = CSSUtilities.convertEnableBackground(e);\n         if (r != null) {",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/SVGUseElementBridge.java",
                "sha": "709ecced4030304a01cf203a7266cfe6d2aa4b3d",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/UserAgent.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/UserAgent.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/bridge/UserAgent.java",
                "patch": "@@ -174,6 +174,11 @@ developed  by the  Apache Software Foundation  (http://www.apache.org/).\"\n      */\n     void setTextSelection(Mark start, Mark end);\n \n+    /**\n+     * Informs the user agent that the text selection should be cleared.\n+     */\n+    void deselectAll();\n+\n     /**\n      * Returns the class name of the XML parser.\n      */",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/UserAgent.java",
                "sha": "65fd4520780f125b40e72307e1dcfd3afd519a44",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/UserAgentAdapter.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/bridge/UserAgentAdapter.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/bridge/UserAgentAdapter.java",
                "patch": "@@ -253,6 +253,11 @@ public void setSVGCursor(Cursor cursor) { }\n      */\n     public void setTextSelection(Mark start, Mark end) { }\n \n+    /**\n+     * This user agent doesn't display text selections so nothing to clear.\n+     */\n+    public void deselectAll() { }\n+\n     /**\n      * Unsupported operation.\n      */",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/bridge/UserAgentAdapter.java",
                "sha": "98ac883a89b4446d0224b556f05d172ba0c5a7e8",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/dom/svg/SVGContext.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/dom/svg/SVGContext.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/dom/svg/SVGContext.java",
                "patch": "@@ -120,4 +120,10 @@ developed  by the  Apache Software Foundation  (http://www.apache.org/).\"\n      * Returns the font-size on the associated element.\n      */\n     float getFontSize();\n+\n+    /**\n+     * Informs the user agent that the text selection should be\n+     * cleared.\n+     */\n+    void deselectAll();\n }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/dom/svg/SVGContext.java",
                "sha": "d8f34a2dea2e0837b9fcf3dac4a4590387a657c5",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/dom/svg/SVGOMSVGElement.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/dom/svg/SVGOMSVGElement.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 5,
                "filename": "sources/org/apache/batik/dom/svg/SVGOMSVGElement.java",
                "patch": "@@ -227,16 +227,16 @@ public SVGRect getViewport() {\n     } \n \n     public float getPixelUnitToMillimeterX( ) {\n-        throw new Error();\n+        return getSVGContext().getPixelUnitToMillimeter();\n     }\n     public float getPixelUnitToMillimeterY( ) {\n-        throw new Error();\n+        return getSVGContext().getPixelUnitToMillimeter();\n     }\n     public float getScreenPixelToMillimeterX( ) {\n-        throw new Error();\n+        return getSVGContext().getPixelUnitToMillimeter();\n     }\n     public float getScreenPixelToMillimeterY( ) {\n-        throw new Error();\n+        return getSVGContext().getPixelUnitToMillimeter();\n     }\n     public boolean getUseCurrentView( ) {\n         throw new Error();\n@@ -359,7 +359,7 @@ public boolean       checkEnclosure ( SVGElement element, SVGRect rect ) {\n         throw new Error();\n     }\n     public void          deselectAll (  ) {\n-        throw new Error();\n+        getSVGContext().deselectAll();\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/dom/svg/SVGOMSVGElement.java",
                "sha": "f4a6acb5064ab659fb5cda8a9cbd5d740933af10",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/gvt/text/ConcreteTextSelector.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/gvt/text/ConcreteTextSelector.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/gvt/text/ConcreteTextSelector.java",
                "patch": "@@ -149,6 +149,7 @@ public void setSelection(Mark begin, Mark end) {\n         if (node != end.getTextNode())\n             throw new Error(\"Markers not from same TextNode\");\n         node.setSelection(begin, end);\n+        selectionNode = node;\n         Object selection = getSelection();\n         Shape  shape     = node.getHighlightShape();\n         dispatchSelectionEvent(new SelectionEvent",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/gvt/text/ConcreteTextSelector.java",
                "sha": "76dbe882b9e3cdd5826a010588fa3e683f9124cc",
                "status": "modified"
            },
            {
                "additions": 32,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/swing/svg/JSVGComponent.java",
                "changes": 36,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/swing/svg/JSVGComponent.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 4,
                "filename": "sources/org/apache/batik/swing/svg/JSVGComponent.java",
                "patch": "@@ -839,7 +839,10 @@ protected CanvasGraphicsNode getCanvasGraphicsNode(GraphicsNode gn) {\n         if (!(gn instanceof CompositeGraphicsNode))\n             return null;\n         CompositeGraphicsNode cgn = (CompositeGraphicsNode)gn;\n-        gn = (GraphicsNode)cgn.getChildren().get(0);\n+        List children = cgn.getChildren();\n+        if (children.size() == 0) \n+            return null;\n+        gn = (GraphicsNode)children.get(0);\n         if (!(gn instanceof CanvasGraphicsNode))\n             return null;\n         return (CanvasGraphicsNode)gn;\n@@ -2401,7 +2404,7 @@ public void run() {\n         }\n         \n         /**\n-         * Informs the user agent that the text selection has changed.\n+         * Informs the user agent that the text selection should changed.\n          * @param start The Mark for the start of the selection.\n          * @param end   The Mark for the end of the selection.\n          */\n@@ -2416,7 +2419,24 @@ public void run() {\n                     });\n             }\n         }\n-        \n+\n+        /**\n+         * Informs the user agent that the text selection should changed.\n+         * @param start The Mark for the start of the selection.\n+         * @param end   The Mark for the end of the selection.\n+         */\n+        public void deselectAll() {\n+            if (EventQueue.isDispatchThread()) {\n+                userAgent.deselectAll();\n+            } else {\n+                EventQueue.invokeLater(new Runnable() {\n+                        public void run() {\n+                            userAgent.deselectAll();\n+                        }\n+                    });\n+            }\n+        }\n+\n         /**\n          * Returns the class name of the XML parser.\n          */\n@@ -3098,7 +3118,15 @@ public void setSVGCursor(Cursor cursor) {\n          * @param end   The Mark for the end of the selection.\n          */\n         public void setTextSelection(Mark start, Mark end) {\n-            JSVGComponent.this.textSelectionManager.setSelection(start, end);\n+            JSVGComponent.this.select(start, end);\n+        }\n+\n+        /**\n+         * Informs the user agent that the text selection should be\n+         * cleared.\n+         */\n+        public void deselectAll() {\n+            JSVGComponent.this.deselectAll();\n         }\n \n         /**",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/swing/svg/JSVGComponent.java",
                "sha": "5dbc50ec411e801ff75da0e34b95fd7404540a1b",
                "status": "modified"
            },
            {
                "additions": 11,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/transcoder/SVGAbstractTranscoder.java",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/transcoder/SVGAbstractTranscoder.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 6,
                "filename": "sources/org/apache/batik/transcoder/SVGAbstractTranscoder.java",
                "patch": "@@ -57,7 +57,8 @@ developed  by the  Apache Software Foundation  (http://www.apache.org/).\"\n import java.net.URL;\n import java.net.MalformedURLException;\n import java.util.StringTokenizer;\n-import java.util.Vector;\n+import java.util.LinkedList;\n+import java.util.List;\n \n import org.apache.batik.bridge.BaseScriptingEnvironment;\n import org.apache.batik.bridge.BridgeContext;\n@@ -272,7 +273,8 @@ protected void transcode(Document document,\n                 throw new TranscoderException(ex);\n             }\n \n-            if (Px.isIdentity() && (width != docWidth || height != docHeight)) {\n+            if (Px.isIdentity() && \n+                (width != docWidth || height != docHeight)) {\n                 // The document has no viewBox, we need to resize it by hand.\n                 // we want to keep the document size ratio\n                 float xscale, yscale;\n@@ -312,7 +314,10 @@ protected CanvasGraphicsNode getCanvasGraphicsNode(GraphicsNode gn) {\n         if (!(gn instanceof CompositeGraphicsNode))\n             return null;\n         CompositeGraphicsNode cgn = (CompositeGraphicsNode)gn;\n-        gn = (GraphicsNode)cgn.getChildren().get(0);\n+        List children = cgn.getChildren();\n+        if (children.size() == 0) \n+            return null;\n+        gn = (GraphicsNode)children.get(0);\n         if (!(gn instanceof CanvasGraphicsNode))\n             return null;\n         return (CanvasGraphicsNode)gn;\n@@ -775,7 +780,7 @@ protected void setImageSize(float docWidth, float docHeight) {\n         /**\n          * Vector containing the allowed script types\n          */\n-        protected Vector scripts;\n+        protected List scripts;\n \n         public SVGAbstractTranscoderUserAgent() {\n             addStdFeatures();\n@@ -984,7 +989,7 @@ public ScriptSecurity getScriptSecurity(String scriptType,\n          * values for the &lt;script&gt; element's type attribute.\n          */\n         protected void computeAllowedScripts(){\n-            scripts = new Vector();\n+            scripts = new LinkedList();\n             if (!SVGAbstractTranscoder.this.hints.containsKey\n                 (KEY_ALLOWED_SCRIPT_TYPES)) {\n                 return;\n@@ -996,7 +1001,7 @@ protected void computeAllowedScripts(){\n                 \n             StringTokenizer st = new StringTokenizer(allowedScripts, \",\");\n             while (st.hasMoreTokens()) {\n-                scripts.addElement(st.nextToken());\n+                scripts.add(st.nextToken());\n             }\n         }\n ",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/transcoder/SVGAbstractTranscoder.java",
                "sha": "bea402a682c138235a68cebd6727cbd43ae170ce",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/transcoder/image/ImageTranscoder.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/transcoder/image/ImageTranscoder.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "sources/org/apache/batik/transcoder/image/ImageTranscoder.java",
                "patch": "@@ -131,6 +131,7 @@ protected void transcode(Document document,\n         // ImageRenderer renderer = rendFactory.createDynamicImageRenderer();\n         ImageRenderer renderer = rendFactory.createStaticImageRenderer();\n         renderer.updateOffScreen(w, h);\n+        // curTxf.translate(0.5, 0.5);\n         renderer.setTransform(curTxf);\n         renderer.setTree(this.root);\n         this.root = null; // We're done with it...",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/transcoder/image/ImageTranscoder.java",
                "sha": "494204bb3aefab376d9ce2d2d947bb79bf85e7c6",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/util/gui/resource/ButtonFactory.java",
                "changes": 9,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/sources/org/apache/batik/util/gui/resource/ButtonFactory.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 2,
                "filename": "sources/org/apache/batik/util/gui/resource/ButtonFactory.java",
                "patch": "@@ -4,7 +4,7 @@\n                    The Apache Software License, Version 1.1\n  ============================================================================\n \n- Copyright (C) 1999-2003 The Apache Software Foundation. All rights reserved.\n+ Copyright (C) 1999-2004 The Apache Software Foundation. All rights reserved.\n \n  Redistribution and use in source and binary forms, with or without modifica-\n  tion, are permitted provided that the following conditions are met:\n@@ -226,7 +226,12 @@ private void initializeButton(AbstractButton b, String name)\n                                                    name+ACTION_SUFFIX);\n \t    }\n \t    b.setAction(a);\n-            b.setText(getString(name+TEXT_SUFFIX));\n+            try {\n+                b.setText(getString(name+TEXT_SUFFIX));\n+            } catch (MissingResourceException mre) {\n+                // not all buttons have text defined so just\n+                // ignore this exception.\n+            }\n \t    if (a instanceof JComponentModifier) {\n \t\t((JComponentModifier)a).addJComponent(b);\n \t    }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/sources/org/apache/batik/util/gui/resource/ButtonFactory.java",
                "sha": "593eae44af4fe6cb5a2bbfa2c8fba56d75604403",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-arabic-5-40.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-arabic-5-40.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-arabic-5-40.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-arabic-5-40.png",
                "sha": "e64c71cca4b71dea321dfa710d9ca182d2ae2efb",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-cyrillic-4-24.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-cyrillic-4-24.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-cyrillic-4-24.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-cyrillic-4-24.png",
                "sha": "8034c9424437ae850e8e981f39374539453d5221",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-greek-0-35.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-greek-0-35.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-greek-0-35.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-greek-0-35.png",
                "sha": "4dd298211bb685d4c9d107943f00180ac430ba41",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-hebrew-10-20.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-hebrew-10-20.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-hebrew-10-20.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-hebrew-10-20.png",
                "sha": "430213d8e7adef052940f5e58bc254e31b6e469d",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-latin-0-20.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-latin-0-20.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-latin-0-20.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-latin-0-20.png",
                "sha": "4a012bc5ffd6ccb50d77f8fba8a2b4afc83a829f",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-latin-extended-0-15.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi-latin-extended-0-15.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi-latin-extended-0-15.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi-latin-extended-0-15.png",
                "sha": "0903c2dbf875b3ca1870887de9fc8d1dc4309bc1",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textBiDi.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textBiDi.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textBiDi.png",
                "sha": "5adf586b6936bf2bd09c12b1bff0dd4c2f41c39c",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textDecoration2.png",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-references/samples/tests/spec/text/textDecoration2.png?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-references/samples/tests/spec/text/textDecoration2.png",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-references/samples/tests/spec/text/textDecoration2.png",
                "sha": "4c6ce30806c1139620f058b0e41f366b002bd1e6",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.jar",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.jar?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 0,
                "filename": "test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.jar",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.jar",
                "sha": "587570e519ae5835ea8157e2fa29150d43f3b86e",
                "status": "modified"
            },
            {
                "additions": 26,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.java",
                "changes": 38,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 12,
                "filename": "test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.java",
                "patch": "@@ -134,7 +134,6 @@ developed  by the  Apache Software Foundation  (http://www.apache.org/).\"\n         {\"RuntimePermission setFactory\", new RuntimePermission(\"setFactory\")}, \n         {\"RuntimePermission setIO\", new RuntimePermission(\"setIO\")}, \n         {\"RuntimePermission modifyThread\", new RuntimePermission(\"modifyThread\")}, \n-        {\"RuntimePermission stopThread\", new RuntimePermission(\"stopThread\")}, \n         {\"RuntimePermission modifyThreadGroup\", new RuntimePermission(\"modifyThreadGroup\")}, \n         {\"RuntimePermission getProtectionDomain\", new RuntimePermission(\"getProtectionDomain\")}, \n         {\"RuntimePermission readFileDescriptor\", new RuntimePermission(\"readFileDescriptor\")}, \n@@ -190,23 +189,38 @@ public void run(final Document document, final Window win){\n         // class has permission to access the server\n         //\n         URL docURL = ((SVGOMDocument)document).getURLObject();\n-        if (docURL != null && docURL.getHost() != null && !\"\".equals(docURL.getHost())) {\n-            permissions = new Object[basePermissions.length + 3][2];\n-            System.arraycopy(basePermissions, 0, \n-                             permissions, 3, basePermissions.length);\n+        if ((docURL != null) && \n+            (docURL.getHost() != null) && \n+            (!\"\".equals(docURL.getHost()))) {\n+\n+            permissions = new Object[basePermissions.length + 4][2];\n \n             String docHost = docURL.getHost();\n             if (docURL.getPort() != -1) {\n                 docHost += \":\" + docURL.getPort();\n             }\n \n-            permissions[0][0] = \"SocketPermission accept \" + docHost;\n-            permissions[0][1] = new SocketPermission(docHost, \"accept\");\n-            permissions[1][0] = \"SocketPermission connect \" + docHost;\n-            permissions[1][1] = new SocketPermission(docHost, \"connect\");\n-            permissions[2][0] = \"SocketPermission resolve \" + docHost;\n-            permissions[2][1] = new SocketPermission(docHost, \"resolve\");\n-            nGrantedTmp = 3;\n+            int i=0;\n+            permissions[i][0] = \"SocketPermission accept \" + docHost;\n+            permissions[i][1] = new SocketPermission(docHost, \"accept\");\n+            i++;\n+\n+            permissions[i][0] = \"SocketPermission connect \" + docHost;\n+            permissions[i][1] = new SocketPermission(docHost, \"connect\");\n+            i++;\n+\n+            permissions[i][0] = \"SocketPermission resolve \" + docHost;\n+            permissions[i][1] = new SocketPermission(docHost, \"resolve\");\n+            i++;\n+            \n+            permissions[i][0] = \"RuntimePermission stopThread\";\n+            permissions[i][1] = new RuntimePermission(\"stopThread\");\n+            i++;\n+\n+            nGrantedTmp = i;\n+\n+            System.arraycopy(basePermissions, 0, permissions, i, \n+                             basePermissions.length);\n         } else {\n             permissions = basePermissions;\n         }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/JarCheckPermissionsDenied.java",
                "sha": "958adaf8af095a7dcc160ec5a3385509af859698",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied.svg",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied.svg?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 7,
                "filename": "test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied.svg",
                "patch": "@@ -116,7 +116,6 @@ var basePermissions = [\n         [\"RuntimePermission setFactory\", new RuntimePermission(\"setFactory\")], \n         [\"RuntimePermission setIO\", new RuntimePermission(\"setIO\")], \n         [\"RuntimePermission modifyThread\", new RuntimePermission(\"modifyThread\")], \n-        [\"RuntimePermission stopThread\", new RuntimePermission(\"stopThread\")], \n         [\"RuntimePermission modifyThreadGroup\", new RuntimePermission(\"modifyThreadGroup\")], \n         [\"RuntimePermission getProtectionDomain\", new RuntimePermission(\"getProtectionDomain\")], \n         [\"RuntimePermission readFileDescriptor\", new RuntimePermission(\"readFileDescriptor\")], \n@@ -159,18 +158,19 @@ function init(){\n             docHost += \":\" + docURL.getPort();\n         }\n \n-        permissions[0] = [\"SocketPermission accept \" + docHost,\n+        nGranted = 0;\n+        permissions[nGranted++] = [\"SocketPermission accept \" + docHost,\n                           new SocketPermission(docHost, \"accept\")];\n-        permissions[1] = [\"SocketPermission connect \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission connect \" + docHost,\n                           new SocketPermission(docHost, \"connect\")];\n-        permissions[2] = [\"SocketPermission resolve \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission resolve \" + docHost,\n                           new SocketPermission(docHost, \"resolve\")];\n-        // permissions.concat(basePermissions);\n+        permissions[nGranted++] = [\"RuntimePermission stopThread\", \n+                                   new RuntimePermission(\"stopThread\")];\n \n         for (var i=0; i<basePermissions.length; i++){\n-            permissions[3+i] = basePermissions[i];\n+            permissions[nGranted+i] = basePermissions[i];\n         }\n-        nGranted = 3;\n     } else {\n         permissions = basePermissions;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied.svg",
                "sha": "ed57b623e35e4800ed012de207315c7cd1726213",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied2.svg",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied2.svg?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 7,
                "filename": "test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied2.svg",
                "patch": "@@ -135,7 +135,6 @@ var basePermissions = [\n         [\"RuntimePermission setFactory\", new RuntimePermission(\"setFactory\")], \n         [\"RuntimePermission setIO\", new RuntimePermission(\"setIO\")], \n         [\"RuntimePermission modifyThread\", new RuntimePermission(\"modifyThread\")], \n-        [\"RuntimePermission stopThread\", new RuntimePermission(\"stopThread\")], \n         [\"RuntimePermission modifyThreadGroup\", new RuntimePermission(\"modifyThreadGroup\")], \n         [\"RuntimePermission getProtectionDomain\", new RuntimePermission(\"getProtectionDomain\")], \n         [\"RuntimePermission readFileDescriptor\", new RuntimePermission(\"readFileDescriptor\")], \n@@ -178,18 +177,19 @@ function init(){\n             docHost += \":\" + docURL.getPort();\n         }\n \n-        permissions[0] = [\"SocketPermission accept \" + docHost,\n+        nGranted = 0;\n+        permissions[nGranted++] = [\"SocketPermission accept \" + docHost,\n                           new SocketPermission(docHost, \"accept\")];\n-        permissions[1] = [\"SocketPermission connect \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission connect \" + docHost,\n                           new SocketPermission(docHost, \"connect\")];\n-        permissions[2] = [\"SocketPermission resolve \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission resolve \" + docHost,\n                           new SocketPermission(docHost, \"resolve\")];\n-        // permissions.concat(basePermissions);\n+        permissions[nGranted++] = [\"RuntimePermission stopThread\", \n+                                   new RuntimePermission(\"stopThread\")];\n \n         for (var i=0; i<basePermissions.length; i++){\n-            permissions[3+i] = basePermissions[i];\n+            permissions[nGranted+i] = basePermissions[i];\n         }\n-        nGranted = 3;\n     } else {\n         permissions = basePermissions;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDenied2.svg",
                "sha": "2d3a7ee1a62f0ba579e8683c0f9b1d3e9bffbc7b",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedEval.svg",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedEval.svg?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 7,
                "filename": "test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedEval.svg",
                "patch": "@@ -135,7 +135,6 @@ var basePermissions = [\n         [\"RuntimePermission setFactory\", new RuntimePermission(\"setFactory\")], \n         [\"RuntimePermission setIO\", new RuntimePermission(\"setIO\")], \n         [\"RuntimePermission modifyThread\", new RuntimePermission(\"modifyThread\")], \n-        [\"RuntimePermission stopThread\", new RuntimePermission(\"stopThread\")], \n         [\"RuntimePermission modifyThreadGroup\", new RuntimePermission(\"modifyThreadGroup\")], \n         [\"RuntimePermission getProtectionDomain\", new RuntimePermission(\"getProtectionDomain\")], \n         [\"RuntimePermission readFileDescriptor\", new RuntimePermission(\"readFileDescriptor\")], \n@@ -178,18 +177,19 @@ function init(){\n             docHost += \":\" + docURL.getPort();\n         }\n \n-        permissions[0] = [\"SocketPermission accept \" + docHost,\n+        nGranted = 0;\n+        permissions[nGranted++] = [\"SocketPermission accept \" + docHost,\n                           new SocketPermission(docHost, \"accept\")];\n-        permissions[1] = [\"SocketPermission connect \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission connect \" + docHost,\n                           new SocketPermission(docHost, \"connect\")];\n-        permissions[2] = [\"SocketPermission resolve \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission resolve \" + docHost,\n                           new SocketPermission(docHost, \"resolve\")];\n-        // permissions.concat(basePermissions);\n+        permissions[nGranted++] = [\"RuntimePermission stopThread\", \n+                                   new RuntimePermission(\"stopThread\")];\n \n         for (var i=0; i<basePermissions.length; i++){\n-            permissions[3+i] = basePermissions[i];\n+            permissions[nGranted+i] = basePermissions[i];\n         }\n-        nGranted = 3;\n     } else {\n         permissions = basePermissions;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedEval.svg",
                "sha": "ed3c82096de62a3a8fa53ccad4e6a3ed48055264",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedFunction.svg",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedFunction.svg?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 7,
                "filename": "test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedFunction.svg",
                "patch": "@@ -135,7 +135,6 @@ var basePermissions = [\n         [\"RuntimePermission setFactory\", new RuntimePermission(\"setFactory\")], \n         [\"RuntimePermission setIO\", new RuntimePermission(\"setIO\")], \n         [\"RuntimePermission modifyThread\", new RuntimePermission(\"modifyThread\")], \n-        [\"RuntimePermission stopThread\", new RuntimePermission(\"stopThread\")], \n         [\"RuntimePermission modifyThreadGroup\", new RuntimePermission(\"modifyThreadGroup\")], \n         [\"RuntimePermission getProtectionDomain\", new RuntimePermission(\"getProtectionDomain\")], \n         [\"RuntimePermission readFileDescriptor\", new RuntimePermission(\"readFileDescriptor\")], \n@@ -178,18 +177,19 @@ function init(){\n             docHost += \":\" + docURL.getPort();\n         }\n \n-        permissions[0] = [\"SocketPermission accept \" + docHost,\n+        nGranted = 0;\n+        permissions[nGranted++] = [\"SocketPermission accept \" + docHost,\n                           new SocketPermission(docHost, \"accept\")];\n-        permissions[1] = [\"SocketPermission connect \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission connect \" + docHost,\n                           new SocketPermission(docHost, \"connect\")];\n-        permissions[2] = [\"SocketPermission resolve \" + docHost,\n+        permissions[nGranted++] = [\"SocketPermission resolve \" + docHost,\n                           new SocketPermission(docHost, \"resolve\")];\n-        // permissions.concat(basePermissions);\n+        permissions[nGranted++] = [\"RuntimePermission stopThread\", \n+                                   new RuntimePermission(\"stopThread\")];\n \n         for (var i=0; i<basePermissions.length; i++){\n-            permissions[3+i] = basePermissions[i];\n+            permissions[nGranted+i] = basePermissions[i];\n         }\n-        nGranted = 3;\n     } else {\n         permissions = basePermissions;\n     }",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-resources/org/apache/batik/bridge/ecmaCheckPermissionsDeniedFunction.svg",
                "sha": "e1b23798017c0023ddfb9966ca99e80bbba4cee7",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "changes": 32,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 11,
                "filename": "test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "patch": "@@ -105,25 +105,35 @@ public TestReport doSomething() throws Exception {\n         SwingUtilities.invokeAndWait( new Runnable() {\n                 public void run() {\n                     // System.out.println(\"In Invoke\");\n-                    theCanvas.dispose();\n                     theFrame.remove(theCanvas);\n+                    theCanvas.dispose();\n+\n                     theFrame.dispose();\n                     theFrame=null;\n                     theCanvas=null;\n                 }\n             });\n \n-        {\n-            // Create a new Frame to take focus for Swing so old one\n-            // can be GC'd.\n-            javax.swing.JFrame jframe = new javax.swing.JFrame(\"FocusFrame\"); \n-            // registerObjectDesc(jframe, \"FocusFrame\");\n-            jframe.setSize(new java.awt.Dimension(40, 50));\n-            jframe.setVisible(true);\n-            jframe.setVisible(false);\n-            jframe.dispose();\n-        }\n+        try  { Thread.sleep(100); } catch (InterruptedException ie) { }\n \n+        SwingUtilities.invokeAndWait( new Runnable() {\n+                public void run() {\n+                    // Create a new Frame to take focus for Swing so old one\n+                    // can be GC'd.\n+                    theFrame = new JFrame(\"FocusFrame\"); \n+                    // registerObjectDesc(jframe, \"FocusFrame\");\n+                    theFrame.setSize(new java.awt.Dimension(40, 50));\n+                    theFrame.setVisible(true);\n+                }});\n+\n+        try  { Thread.sleep(100); } catch (InterruptedException ie) { }\n+        \n+        SwingUtilities.invokeAndWait( new Runnable() {\n+                public void run() {\n+                    theFrame.setVisible(false);\n+                    theFrame.dispose();\n+                }});\n+        \n         handler = null;\n         if (failReport != null) return failReport;\n         DefaultTestReport report = new DefaultTestReport(this);",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-sources/org/apache/batik/swing/JSVGMemoryLeakTest.java",
                "sha": "ca03108659ba87ca7281e9d21a8c9c297cb564dd",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/xmlgraphics-batik/blob/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-sources/org/apache/batik/test/MemoryLeakTest.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/xmlgraphics-batik/contents/test-sources/org/apache/batik/test/MemoryLeakTest.java?ref=cb22022ab74b20ba08ba59a6e76adafea36f5c8b",
                "deletions": 3,
                "filename": "test-sources/org/apache/batik/test/MemoryLeakTest.java",
                "patch": "@@ -78,7 +78,7 @@ developed  by the  Apache Software Foundation  (http://www.apache.org/).\"\n     // (why so large I don't know) - it will bail if the all\n     // the objects of interest are collected sooner so the runtime\n     // is really only a concern for failures.\n-    final static int NUM_GC=120;\n+    final static int NUM_GC=60;\n \n     final static String ERROR_OBJS_NOT_CLEARED = \n         \"MemoryLeakTest.message.error.objs.not.cleared\";\n@@ -154,7 +154,9 @@ public boolean checkObjects(String [] descs) {\n \n         if (objStr.length() > 40) \n             objStr = objStr.substring(0,40) + \"...\" ;\n-        System.err.print(\">>>>> Objects not cleared: \" + objStr + \"\\n\");\n+        System.err.println(\">>>>> Objects not cleared: \" + objStr);\n+        // System.err.println(\"Waiting for heap dump...\");\n+        // try { Thread.sleep(60000); } catch (InterruptedException ie) { }\n         return false;\n     }\n \n@@ -193,7 +195,9 @@ public boolean checkAllObjects() {\n                 if (!passed)\n                     sb.append(\",\");\n                 passed = false;\n+                sb.append(\"'\");\n                 sb.append(wr.getDesc());\n+                sb.append(\"'\");\n             }\n             if (passed) return true;\n         }\n@@ -207,7 +211,9 @@ public boolean checkAllObjects() {\n \n         if (objStr.length() > 40) \n             objStr = objStr.substring(0,40) + \"...\" ;\n-        System.err.print(\">>>>> Objects not cleared: \" + objStr + \"\\n\");\n+        System.err.println(\">>>>> Objects not cleared: \" + objStr);\n+        // System.err.println(\"Waiting for heap dump...\");\n+        // try { Thread.sleep(60000); } catch (InterruptedException ie) { }\n         return false;\n     }\n ",
                "raw_url": "https://github.com/apache/xmlgraphics-batik/raw/cb22022ab74b20ba08ba59a6e76adafea36f5c8b/test-sources/org/apache/batik/test/MemoryLeakTest.java",
                "sha": "d0b694f696fbf684501f2d7f0a6fc335f816261d",
                "status": "modified"
            }
        ],
        "message": "1) Applied patch 28188, fixed tooltip text & title text, thanks Glen\n2) Applied patch 28487, fixed enabled/disabled state fot\n   toolbar buttons, thanks Glen\n3) Added support for 'deselectAll' SVG DOM call.\n4) Fixed NPE regression with Images in a dynamic context.\n5) Fixed rendering regression with use elements in a dynamic context.\n6) Added support for get[Screen]PixelUnitToMillimeterX/Y\n7) Fixed bug in text selection (programatically selected text wouldn't\n   clear properly.\n8) Updated a number of reference images\n9) Permission tests now allow 'stopThread' - modifyThread prevents\n   stopping other threads.\n10) Tweaks to memory leak tests.\nPR: 28188, 28487\nObtained from: Glen Mazza\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/xmlgraphics/batik/trunk@201372 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/xmlgraphics-batik/commit/bb38ef825c3fa978a88361367b77d8e9d386ac0e",
        "patched_files": [
            "ecmaCheckPermissionsDenied2.svg",
            "JSVGViewerFrame.java",
            "SVGOMSVGElement.java",
            "ButtonFactory.java",
            "ImageTranscoder.java",
            "ecmaCheckPermissionsDeniedEval.svg",
            "textBiDi-latin-extended-0-15.png",
            "SVGImageElementBridge.java",
            "textBiDi-arabic-5-40.png",
            "SVGUseElementBridge.java",
            "SVGAbstractTranscoder.java",
            "textBiDi-hebrew-10-20.png",
            "JarCheckPermissionsDenied.jar",
            "textBiDi-cyrillic-4-24.png",
            "AbstractGraphicsNodeBridge.java",
            "textBiDi-latin-0-20.png",
            "ecmaCheckPermissionsDenied.svg",
            "UserAgentAdapter.java",
            "GUI.properties",
            "ecmaCheckPermissionsDeniedFunction.svg",
            "ConcreteTextSelector.java",
            "SVGContext.java",
            "textDecoration2.png",
            "JarCheckPermissionsDenied.java",
            "JSVGComponent.java",
            "build.xml",
            "UserAgent.java",
            "SVGTextElementBridge.java",
            "textBiDi-greek-0-35.png",
            "textBiDi.png"
        ],
        "repo": "xmlgraphics-batik",
        "unit_tests": [
            "MemoryLeakTest.java",
            "JSVGMemoryLeakTest.java"
        ]
    }
}