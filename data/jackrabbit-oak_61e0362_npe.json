[
    {
        "repo": "jackrabbit-oak",
        "commit": "https://github.com/apache/jackrabbit-oak/commit/61e036252f696b699e2581db862e2bb0ffe6468e",
        "bug_id": "jackrabbit-oak_61e0362",
        "message": "OAK-1593 : Guard against NPE in ConfigurationParameters.of(ConfigurationParameters...)\n\ngit-svn-id: https://svn.apache.org/repos/asf/jackrabbit/oak/trunk@1580003 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/jackrabbit-oak/commit/eadb0078a0201ee542c84fde24f362a7e698632b",
        "patched_files": [
            "ConfigurationParameters.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 3,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/61e036252f696b699e2581db862e2bb0ffe6468e/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParameters.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParameters.java?ref=61e036252f696b699e2581db862e2bb0ffe6468e",
                "filename": "oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParameters.java",
                "deletions": 1,
                "sha": "08de2e8c57b5eaff3321b68b9b96299585f87a3a",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/61e036252f696b699e2581db862e2bb0ffe6468e/oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParameters.java",
                "patch": "@@ -83,7 +83,9 @@ private ConfigurationParameters(@Nonnull Map<String, ?> options) {\n     public static ConfigurationParameters of(@Nonnull ConfigurationParameters... params) {\n         Map<String, Object> m = new HashMap<String, Object>();\n         for (ConfigurationParameters cp : params) {\n-            m.putAll(cp.options);\n+            if (cp != null) {\n+                m.putAll(cp.options);\n+            }\n         }\n         return m.isEmpty() ? EMPTY : new ConfigurationParameters(m);\n     }",
                "changes": 4
            },
            {
                "status": "renamed",
                "additions": 20,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/61e036252f696b699e2581db862e2bb0ffe6468e/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParametersTest.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParametersTest.java?ref=61e036252f696b699e2581db862e2bb0ffe6468e",
                "filename": "oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParametersTest.java",
                "previous_filename": "oak-core/src/test/java/org/apache/jackrabbit/oak/security/ConfigurationParametersTest.java",
                "deletions": 2,
                "sha": "8fc6c0279cac506af32de49669867f6816459d8e",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/61e036252f696b699e2581db862e2bb0ffe6468e/oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParametersTest.java",
                "patch": "@@ -14,14 +14,13 @@\n  * See the License for the specific language governing permissions and\n  * limitations under the License.\n  */\n-package org.apache.jackrabbit.oak.security;\n+package org.apache.jackrabbit.oak.spi.security;\n \n import java.util.Calendar;\n import java.util.Collections;\n import java.util.HashMap;\n import java.util.Map;\n \n-import org.apache.jackrabbit.oak.spi.security.ConfigurationParameters;\n import org.junit.After;\n import org.junit.Before;\n import org.junit.Test;\n@@ -33,6 +32,7 @@\n import static junit.framework.Assert.assertTrue;\n import static junit.framework.Assert.fail;\n import static org.junit.Assert.assertArrayEquals;\n+import static org.junit.Assert.assertSame;\n \n public class ConfigurationParametersTest {\n \n@@ -42,6 +42,24 @@ public void setup() {}\n     @After\n     public void tearDown() {}\n \n+    @Test\n+    public void testCreation() {\n+        ConfigurationParameters params = ConfigurationParameters.of(\n+                ConfigurationParameters.EMPTY,\n+                null,\n+                ConfigurationParameters.of(Collections.singletonMap(\"a\", \"a\")));\n+        assertFalse(params.isEmpty());\n+        assertEquals(1, params.size());\n+        assertTrue(params.contains(\"a\"));\n+    }\n+\n+    @Test\n+    public void testCreationFromNull() {\n+        ConfigurationParameters cp = null;\n+        ConfigurationParameters params = ConfigurationParameters.of(new ConfigurationParameters[] {cp});\n+        assertSame(ConfigurationParameters.EMPTY, params);\n+    }\n+\n     @Test\n     public void testContains() {\n         ConfigurationParameters params = ConfigurationParameters.EMPTY;",
                "changes": 22
            }
        ],
        "unit_tests": [
            "ConfigurationParametersTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "oak-core/src/test/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParametersTest.java",
        "buggy_files": [
            "oak-core/src/main/java/org/apache/jackrabbit/oak/spi/security/ConfigurationParameters.java"
        ],
        "fixed": true
    }
]