[
    {
        "repo": "hbase",
        "commit": "https://github.com/apache/hbase/commit/9a4068dcf8caec644e6703ffa365a8649bbd336e",
        "bug_id": "hbase_9a4068d",
        "message": "Revert \"guard against NPE while reading FileTrailer and HFileBlock\"\n\nThis reverts commit 201c8382508da1266d11e04d3c7cbef42e0a256a.\n\nReverted because missing JIRA number. Fixing...",
        "parent": "https://github.com/apache/hbase/commit/edbd0e494d7abaf50319b7650e350d52b195fcc9",
        "patched_files": [
            "HFileBlock.java",
            "FixedFileTrailer.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/hbase/raw/9a4068dcf8caec644e6703ffa365a8649bbd336e/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java",
                "contents_url": "https://api.github.com/repos/apache/hbase/contents/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java?ref=9a4068dcf8caec644e6703ffa365a8649bbd336e",
                "filename": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java",
                "deletions": 2,
                "sha": "7eac9c6eca6be97c4d380c5fe0e1d5a03b14e92f",
                "blob_url": "https://github.com/apache/hbase/blob/9a4068dcf8caec644e6703ffa365a8649bbd336e/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java",
                "patch": "@@ -388,8 +388,7 @@ public static FixedFileTrailer readFromStream(FSDataInputStream istream,\n       bufferSize = (int) fileSize;\n     }\n \n-    HFileUtil.seekOnMultipleSources(istream, seekPoint);\n-\n+    istream.seek(seekPoint);\n     ByteBuffer buf = ByteBuffer.allocate(bufferSize);\n     istream.readFully(buf.array(), buf.arrayOffset(),\n         buf.arrayOffset() + buf.limit());",
                "changes": 3
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/hbase/raw/9a4068dcf8caec644e6703ffa365a8649bbd336e/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java",
                "contents_url": "https://api.github.com/repos/apache/hbase/contents/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java?ref=9a4068dcf8caec644e6703ffa365a8649bbd336e",
                "filename": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java",
                "deletions": 1,
                "sha": "fba15baa0976a0952ed4375277ac1a090b9bc0f7",
                "blob_url": "https://github.com/apache/hbase/blob/9a4068dcf8caec644e6703ffa365a8649bbd336e/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java",
                "patch": "@@ -1512,7 +1512,7 @@ protected int readAtOffset(FSDataInputStream istream, byte [] dest, int destOffs\n       if (!pread && streamLock.tryLock()) {\n         // Seek + read. Better for scanning.\n         try {\n-          HFileUtil.seekOnMultipleSources(istream, fileOffset);\n+          istream.seek(fileOffset);\n \n           long realOffset = istream.getPos();\n           if (realOffset != fileOffset) {",
                "changes": 2
            },
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/hbase/raw/edbd0e494d7abaf50319b7650e350d52b195fcc9/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileUtil.java",
                "contents_url": "https://api.github.com/repos/apache/hbase/contents/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileUtil.java?ref=edbd0e494d7abaf50319b7650e350d52b195fcc9",
                "filename": "hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileUtil.java",
                "deletions": 43,
                "sha": "835450c2a9a8c8227ae4afe469bd0ec9d272dd49",
                "blob_url": "https://github.com/apache/hbase/blob/edbd0e494d7abaf50319b7650e350d52b195fcc9/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileUtil.java",
                "patch": "@@ -1,43 +0,0 @@\n-/**\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-package org.apache.hadoop.hbase.io.hfile;\n-\n-import java.io.IOException;\n-\n-import org.apache.hadoop.fs.FSDataInputStream;\n-\n-public class HFileUtil {\n-\n-  /** guards against NullPointer\n-   * utility which tries to seek on the DFSIS and will try an alternative source\n-   * if the FSDataInputStream throws an NPE HBASE-17501\n-   * @param istream\n-   * @param offset\n-   * @throws IOException\n-   */\n-  static public void seekOnMultipleSources(FSDataInputStream istream, long offset) throws IOException {\n-    try {\n-      // attempt to seek inside of current blockReader\n-      istream.seek(offset);\n-    } catch (NullPointerException e) {\n-      // retry the seek on an alternate copy of the data\n-      // this can occur if the blockReader on the DFSInputStream is null\n-      istream.seekToNewSource(offset);\n-    }\n-  }\n-}",
                "changes": 43
            }
        ],
        "unit_tests": [
            "TestFixedFileTrailer.java",
            "TestHFileBlock.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestFixedFileTrailer.java",
        "buggy_files": [
            "hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java",
            "hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java"
        ],
        "fixed": true
    }
]