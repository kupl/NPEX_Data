{
    "unomi_1868d46": {
        "bug_id": "unomi_1868d46",
        "commit": "https://github.com/apache/unomi/commit/1868d46fc48613a84181de13024e26e5eb3aeadc",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/unomi/blob/1868d46fc48613a84181de13024e26e5eb3aeadc/plugins/baseplugin/src/main/java/org/oasis_open/contextserver/plugins/baseplugin/conditions/PropertyConditionEvaluator.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/unomi/contents/plugins/baseplugin/src/main/java/org/oasis_open/contextserver/plugins/baseplugin/conditions/PropertyConditionEvaluator.java?ref=1868d46fc48613a84181de13024e26e5eb3aeadc",
                "deletions": 2,
                "filename": "plugins/baseplugin/src/main/java/org/oasis_open/contextserver/plugins/baseplugin/conditions/PropertyConditionEvaluator.java",
                "patch": "@@ -162,7 +162,9 @@ public boolean eval(Condition condition, Item item, Map<String, Object> context,\n             }\n         }\n \n-        if(actualValue == null){\n+        if(op == null) {\n+            return false;\n+        } else if(actualValue == null){\n             return op.equals(\"missing\");\n         } else if (op.equals(\"exists\")) {\n             return true;\n@@ -202,7 +204,7 @@ public boolean eval(Condition condition, Item item, Map<String, Object> context,\n         } else if (op.equals(\"endsWith\")) {\n             return actualValue.toString().endsWith(expectedValue);\n         } else if (op.equals(\"matchesRegex\")) {\n-            return Pattern.compile(expectedValue).matcher(actualValue.toString()).matches();\n+            return expectedValue != null && Pattern.compile(expectedValue).matcher(actualValue.toString()).matches();\n         } else if (op.equals(\"in\") || op.equals(\"notIn\") || op.equals(\"all\")) {\n             List<?> expectedValues = (List<?>) condition.getParameter(\"propertyValues\");\n             List<?> expectedValuesInteger = (List<?>) condition.getParameter(\"propertyValuesInteger\");",
                "raw_url": "https://github.com/apache/unomi/raw/1868d46fc48613a84181de13024e26e5eb3aeadc/plugins/baseplugin/src/main/java/org/oasis_open/contextserver/plugins/baseplugin/conditions/PropertyConditionEvaluator.java",
                "sha": "b06d1cc7273a4ef0b2d9ff63238dbbacbfeb816a",
                "status": "modified"
            }
        ],
        "message": "fix NPEs in cxs",
        "parent": "https://github.com/apache/unomi/commit/f8360268a7990cf2fcc592c18123c9bf80b609f7",
        "repo": "unomi",
        "unit_tests": [
            "PropertyConditionEvaluatorTest.java"
        ]
    }
}