[
    {
        "repo": "commons-configuration",
        "commit": "https://github.com/apache/commons-configuration/commit/4930140ec6fdceb7e15d31afa45243dee7d1e217",
        "bug_id": "commons-configuration_4930140",
        "message": "[CONFIGURATION-671] Fixed handling of empty sections in INIConfiguration.\n\nSaving of an INIConfiguration with an empty section caused a NPE. The\ncause was that nodes without children were not detected as section\nnodes. Now a different criterion is used.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/configuration/trunk@1806819 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/commons-configuration/commit/e9dcc716af5014485846d28e174164c2a3720c15",
        "patched_files": [
            "INIConfiguration.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 5,
                "raw_url": "https://github.com/apache/commons-configuration/raw/4930140ec6fdceb7e15d31afa45243dee7d1e217/src/main/java/org/apache/commons/configuration2/INIConfiguration.java",
                "contents_url": "https://api.github.com/repos/apache/commons-configuration/contents/src/main/java/org/apache/commons/configuration2/INIConfiguration.java?ref=4930140ec6fdceb7e15d31afa45243dee7d1e217",
                "filename": "src/main/java/org/apache/commons/configuration2/INIConfiguration.java",
                "deletions": 1,
                "sha": "c9f516ab96610c24cf9ea3e15590c98880472cb1",
                "blob_url": "https://github.com/apache/commons-configuration/blob/4930140ec6fdceb7e15d31afa45243dee7d1e217/src/main/java/org/apache/commons/configuration2/INIConfiguration.java",
                "patch": "@@ -212,6 +212,10 @@\n  * <a href=\"http://commons.apache.org/proper/commons-configuration/userguide/howto_basicfeatures.html\">\n  * Basic features and AbstractConfiguration</a> of the user's guide.\n  * </p>\n+ * <p>\n+ * Note that this configuration does not support properties with null values.\n+ * Such properties are considered to be section nodes.\n+ * </p>\n  *\n  * @author <a\n  *         href=\"http://commons.apache.org/configuration/team-list.html\">Commons\n@@ -942,7 +946,7 @@ private SubnodeConfiguration getGlobalSection()\n      */\n     private static boolean isSectionNode(ImmutableNode node)\n     {\n-        return !node.getChildren().isEmpty();\n+        return node.getValue() == null;\n     }\n \n     /**",
                "changes": 6
            },
            {
                "status": "modified",
                "additions": 21,
                "raw_url": "https://github.com/apache/commons-configuration/raw/4930140ec6fdceb7e15d31afa45243dee7d1e217/src/test/java/org/apache/commons/configuration2/TestINIConfiguration.java",
                "contents_url": "https://api.github.com/repos/apache/commons-configuration/contents/src/test/java/org/apache/commons/configuration2/TestINIConfiguration.java?ref=4930140ec6fdceb7e15d31afa45243dee7d1e217",
                "filename": "src/test/java/org/apache/commons/configuration2/TestINIConfiguration.java",
                "deletions": 0,
                "sha": "30b8722610f11fd041252ceeadf01259a7ca0fcb",
                "blob_url": "https://github.com/apache/commons-configuration/blob/4930140ec6fdceb7e15d31afa45243dee7d1e217/src/test/java/org/apache/commons/configuration2/TestINIConfiguration.java",
                "patch": "@@ -1223,6 +1223,27 @@ public void testExpressionEngineIgnoringCase()\n                 config.getString(\"SECTION1.VAR1\"));\n     }\n \n+    /**\n+     * Tests whether an empty section can be saved. This is related to\n+     * CONFIGURATION-671.\n+     */\n+    @Test\n+    public void testWriteEmptySection()\n+            throws ConfigurationException, IOException\n+    {\n+        final String section = \"[EmptySection]\";\n+        INIConfiguration config = setUpConfig(section);\n+        assertEquals(\"Wrong number of sections\", 1,\n+                config.getSections().size());\n+        assertTrue(\"Section not found\",\n+                config.getSections().contains(\"EmptySection\"));\n+\n+        StringWriter writer = new StringWriter();\n+        config.write(writer);\n+        assertEquals(\"Wrong saved configuration\",\n+                section + LINE_SEPARATOR + LINE_SEPARATOR, writer.toString());\n+    }\n+\n     /**\n      * A thread class for testing concurrent access to the global section.\n      */",
                "changes": 21
            }
        ],
        "unit_tests": [
            "TestINIConfiguration.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/org/apache/commons/configuration2/TestINIConfiguration.java",
        "buggy_files": [
            "src/main/java/org/apache/commons/configuration2/INIConfiguration.java"
        ],
        "fixed": true
    }
]