[
    {
        "repo": "directory-kerby",
        "commit": "https://github.com/apache/directory-kerby/commit/158a6a1c294fe4904277aa592a677082aab0cf74",
        "bug_id": "directory-kerby_158a6a1",
        "message": "DIRKRB-636 - NPE in GssInitCred when a tgt is obtained via JAAS",
        "parent": "https://github.com/apache/directory-kerby/commit/7a33acebb97b9676ce4b284a2ea3f6004a4317ca",
        "patched_files": [
            "GssInitCred.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 0,
                "raw_url": "https://github.com/apache/directory-kerby/raw/158a6a1c294fe4904277aa592a677082aab0cf74/kerby-kerb/integration-test/src/test/java/org/apache/kerby/kerberos/kerb/integration/test/KerbyGssAppTest.java",
                "contents_url": "https://api.github.com/repos/apache/directory-kerby/contents/kerby-kerb/integration-test/src/test/java/org/apache/kerby/kerberos/kerb/integration/test/KerbyGssAppTest.java?ref=158a6a1c294fe4904277aa592a677082aab0cf74",
                "filename": "kerby-kerb/integration-test/src/test/java/org/apache/kerby/kerberos/kerb/integration/test/KerbyGssAppTest.java",
                "deletions": 1,
                "sha": "2e01975557e368e5fcd39bbd77c3848c40c98dcb",
                "blob_url": "https://github.com/apache/directory-kerby/blob/158a6a1c294fe4904277aa592a677082aab0cf74/kerby-kerb/integration-test/src/test/java/org/apache/kerby/kerberos/kerb/integration/test/KerbyGssAppTest.java",
                "patch": "@@ -41,7 +41,6 @@ public void test() throws Exception {\n     }\n \n     @Test\n-    @org.junit.Ignore\n     public void testJAAS() throws Exception {\n         super.testJAAS();\n     }",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 8,
                "raw_url": "https://github.com/apache/directory-kerby/raw/158a6a1c294fe4904277aa592a677082aab0cf74/kerby-kerb/kerb-gssapi/src/main/java/org/apache/kerby/kerberos/kerb/gss/impl/GssInitCred.java",
                "contents_url": "https://api.github.com/repos/apache/directory-kerby/contents/kerby-kerb/kerb-gssapi/src/main/java/org/apache/kerby/kerberos/kerb/gss/impl/GssInitCred.java?ref=158a6a1c294fe4904277aa592a677082aab0cf74",
                "filename": "kerby-kerb/kerb-gssapi/src/main/java/org/apache/kerby/kerberos/kerb/gss/impl/GssInitCred.java",
                "deletions": 0,
                "sha": "fd042519041cf0766ab504b161a91695192ddf86",
                "blob_url": "https://github.com/apache/directory-kerby/blob/158a6a1c294fe4904277aa592a677082aab0cf74/kerby-kerb/kerb-gssapi/src/main/java/org/apache/kerby/kerberos/kerb/gss/impl/GssInitCred.java",
                "patch": "@@ -20,6 +20,8 @@\n package org.apache.kerby.kerberos.kerb.gss.impl;\n \n import org.ietf.jgss.GSSException;\n+import org.ietf.jgss.GSSName;\n+\n import sun.security.jgss.GSSCaller;\n \n import javax.security.auth.kerberos.KerberosTicket;\n@@ -35,6 +37,12 @@ private GssInitCred(GSSCaller caller, GssNameElement name, KerberosTicket ticket\n     }\n \n     public static GssInitCred getInstance(GSSCaller caller, GssNameElement name, int lifeTime) throws GSSException {\n+        if (name == null) {\n+            KerberosTicket ticket = CredUtils.getKerberosTicketFromContext(caller, null, null);\n+            GssNameElement clientName = GssNameElement.getInstance(ticket.getClient().getName(), GSSName.NT_USER_NAME);\n+            return new GssInitCred(caller, clientName, ticket, lifeTime);\n+        }\n+\n         KerberosTicket ticket = CredUtils.getKerberosTicketFromContext(caller, name.getPrincipalName().getName(), null);\n         return new GssInitCred(caller, name, ticket, lifeTime);\n     }",
                "changes": 8
            }
        ],
        "unit_tests": [
            "KerbyGssAppTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "kerby-kerb/integration-test/src/test/java/org/apache/kerby/kerberos/kerb/integration/test/KerbyGssAppTest.java",
        "buggy_files": [
            "kerby-kerb/kerb-gssapi/src/main/java/org/apache/kerby/kerberos/kerb/gss/impl/GssInitCred.java"
        ],
        "fixed": true
    }
]