[
    {
        "repo": "commons-jexl",
        "commit": "https://github.com/apache/commons-jexl/commit/dc013efedf7134dd2da4565c90f1f6f7207d42c6",
        "bug_id": "commons-jexl_dc013ef",
        "message": "Script engine must throw NPE if either parameter is null\n\ngit-svn-id: https://svn-us.apache.org/repos/asf/commons/proper/jexl/branches/2.0@799910 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/commons-jexl/commit/a80683ce2276554f0e7929e5ed3731a5156d64a1",
        "patched_files": [
            "JexlScriptEngine.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/commons-jexl/raw/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java?ref=dc013efedf7134dd2da4565c90f1f6f7207d42c6",
                "filename": "src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "deletions": 2,
                "sha": "fa80364158e8ac6894784f201783bf30e23c3bc3",
                "blob_url": "https://github.com/apache/commons-jexl/blob/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java",
                "patch": "@@ -75,6 +75,10 @@ public Bindings createBindings() {\n \n     /** {@inheritDoc} */\n     public Object eval(Reader script, ScriptContext context) throws ScriptException {\n+        // This is mandated by JSR-223 (see SCR.5.5.2   Methods)\n+        if (script == null || context == null) {\n+            throw new NullPointerException(\"script and context must be non-null\");\n+        }\n         BufferedReader reader = new BufferedReader(script);\n         StringBuilder buffer = new StringBuilder();\n         try {\n@@ -98,8 +102,9 @@ public Object eval(Reader script, ScriptContext context) throws ScriptException\n     /** {@inheritDoc} */\n     @SuppressWarnings(\"unchecked\")\n     public Object eval(String scriptText, final ScriptContext context) throws ScriptException {\n-        if (scriptText == null) {\n-            return null;\n+        // This is mandated by JSR-223 (see SCR.5.5.2   Methods)\n+        if (scriptText == null || context == null) {\n+            throw new NullPointerException(\"script and context must be non-null\");\n         }\n         // This is mandated by JSR-223 (end of section SCR.4.3.4.1.2 - Script Execution)\n         context.setAttribute(\"context\", context, ScriptContext.ENGINE_SCOPE);",
                "changes": 9
            },
            {
                "status": "modified",
                "additions": 21,
                "raw_url": "https://github.com/apache/commons-jexl/raw/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "contents_url": "https://api.github.com/repos/apache/commons-jexl/contents/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java?ref=dc013efedf7134dd2da4565c90f1f6f7207d42c6",
                "filename": "src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "deletions": 0,
                "sha": "3f879bf3807fd53c4771e3e3c7ddb7d3fd2837f8",
                "blob_url": "https://github.com/apache/commons-jexl/blob/dc013efedf7134dd2da4565c90f1f6f7207d42c6/src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
                "patch": "@@ -18,10 +18,12 @@\n \n package org.apache.commons.jexl.scripting;\n \n+import java.io.Reader;\n import java.util.Map;\n \n import javax.script.ScriptEngine;\n import javax.script.ScriptEngineManager;\n+import javax.script.ScriptException;\n \n import junit.framework.TestCase;\n \n@@ -50,6 +52,25 @@ public void testScripting() throws Exception {\n         assertEquals(initialValue,engine.get(\"old\"));\n         assertEquals(newValue,engine.get(\"value\"));\n     }\n+    \n+    public void testNulls() throws Exception {\n+        ScriptEngineManager manager = new ScriptEngineManager();\n+        assertNotNull(\"Manager should not be null\", manager);\n+        ScriptEngine engine = manager.getEngineByName(\"jexl\");\n+        assertNotNull(\"Engine should not be null (name)\", engine);\n+        try {\n+            engine.eval((String)null);\n+            fail(\"Should have caused NPE\");\n+        } catch (NullPointerException e) {\n+            // NOOP\n+        }\n+        try {\n+            engine.eval((Reader)null);\n+            fail(\"Should have caused NPE\");\n+        } catch (NullPointerException e) {\n+            // NOOP\n+        }\n+    }\n \n     public void testEngineNames() throws Exception {\n         ScriptEngine engine;",
                "changes": 21
            }
        ],
        "unit_tests": [
            "JexlScriptEngineTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/org/apache/commons/jexl/scripting/JexlScriptEngineTest.java",
        "buggy_files": [
            "src/java/org/apache/commons/jexl/scripting/JexlScriptEngine.java"
        ],
        "fixed": true
    }
]