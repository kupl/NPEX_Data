[{"commit": "https://github.com/apache/maven-artifact-transfer/commit/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f", "parent": "https://github.com/apache/maven-artifact-transfer/commit/bd608146f0ed6aa724efd65a9535595042784206", "message": "Prevent NPE with dependencyManagement and dependencies\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/shared/trunk@1722498 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "maven-artifact-transfer_1", "file": [{"additions": 1, "raw_url": "https://github.com/apache/maven-artifact-transfer/raw/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/DependencyResolver.java", "blob_url": "https://github.com/apache/maven-artifact-transfer/blob/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/DependencyResolver.java", "sha": "ba840ea8c078d84e5124cb7291d3191002d89a81", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/maven-artifact-transfer/contents/src/main/java/org/apache/maven/shared/dependency/resolve/DependencyResolver.java?ref=b5cc4be6c616c6a1be37dd8cbb183fb6710e409f", "patch": "@@ -50,7 +50,7 @@\n \r\n     /**\r\n      * @param buildingRequest the project building request, never {@code null}\r\n-     * @param dependencies the dependencies to resolve, never {@code null}\r\n+     * @param dependencies the dependencies to resolve, can be {@code null}\r\n      * @param managedDependencies managed dependencies, can be {@code null}\r\n      * @param filter a filter, can be {@code null}\r\n      * @return the resolved dependencies.\r", "filename": "src/main/java/org/apache/maven/shared/dependency/resolve/DependencyResolver.java"}, {"additions": 25, "raw_url": "https://github.com/apache/maven-artifact-transfer/raw/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven30DependencyResolver.java", "blob_url": "https://github.com/apache/maven-artifact-transfer/blob/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven30DependencyResolver.java", "sha": "8f3334a55b9c9cb151e5e71224903147f43dfdeb", "changes": 40, "status": "modified", "deletions": 15, "contents_url": "https://api.github.com/repos/apache/maven-artifact-transfer/contents/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven30DependencyResolver.java?ref=b5cc4be6c616c6a1be37dd8cbb183fb6710e409f", "patch": "@@ -103,31 +103,41 @@\n             (ArtifactTypeRegistry) Invoker.invoke( RepositoryUtils.class, \"newArtifactTypeRegistry\",\r\n                                                    ArtifactHandlerManager.class, artifactHandlerManager );\r\n \r\n-        List<Dependency> aetherDependencies = new ArrayList<Dependency>( mavenDependencies.size() );\r\n-\r\n         final Class<?>[] argClasses =\r\n             new Class<?>[] { org.apache.maven.model.Dependency.class, ArtifactTypeRegistry.class };\r\n \r\n-        for ( org.apache.maven.model.Dependency mavenDependency : mavenDependencies )\r\n-        {\r\n-            Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n+         List<Dependency> aetherDependencies = new ArrayList<Dependency>( mavenDependencies.size() );\r\n \r\n-            Dependency aetherDependency =\r\n-                (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n+         if ( mavenDependencies != null )\r\n+         {\r\n+             aetherDependencies = new ArrayList<Dependency>( mavenDependencies.size() );\r\n \r\n-            aetherDependencies.add( aetherDependency );\r\n-        }\r\n+             for ( org.apache.maven.model.Dependency mavenDependency : mavenDependencies )\r\n+             {\r\n+                 Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n+\r\n+                 Dependency aetherDependency =\r\n+                     (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n \r\n-        List<Dependency> aetherManagedDependencies = new ArrayList<Dependency>( managedMavenDependencies.size() );\r\n+                 aetherDependencies.add( aetherDependency );\r\n+             }\r\n+         }\r\n \r\n-        for ( org.apache.maven.model.Dependency mavenDependency : managedMavenDependencies )\r\n+        List<Dependency> aetherManagedDependencies = null;\r\n+\r\n+        if ( managedMavenDependencies != null )\r\n         {\r\n-            Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n+            aetherManagedDependencies = new ArrayList<Dependency>( managedMavenDependencies.size() );\r\n+\r\n+            for ( org.apache.maven.model.Dependency mavenDependency : managedMavenDependencies )\r\n+            {\r\n+                Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n \r\n-            Dependency aetherDependency =\r\n-                (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n+                Dependency aetherDependency =\r\n+                    (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n \r\n-            aetherManagedDependencies.add( aetherDependency );\r\n+                aetherManagedDependencies.add( aetherDependency );\r\n+            }\r\n         }\r\n \r\n         @SuppressWarnings( \"unchecked\" )\r", "filename": "src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven30DependencyResolver.java"}, {"additions": 25, "raw_url": "https://github.com/apache/maven-artifact-transfer/raw/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven31DependencyResolver.java", "blob_url": "https://github.com/apache/maven-artifact-transfer/blob/b5cc4be6c616c6a1be37dd8cbb183fb6710e409f/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven31DependencyResolver.java", "sha": "bee9d22b3db561ca541c4c3ad1d91d7a9f27ae78", "changes": 40, "status": "modified", "deletions": 15, "contents_url": "https://api.github.com/repos/apache/maven-artifact-transfer/contents/src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven31DependencyResolver.java?ref=b5cc4be6c616c6a1be37dd8cbb183fb6710e409f", "patch": "@@ -102,39 +102,49 @@\n             (ArtifactTypeRegistry) Invoker.invoke( RepositoryUtils.class, \"newArtifactTypeRegistry\",\r\n                                                    ArtifactHandlerManager.class, artifactHandlerManager );\r\n \r\n-        List<Dependency> aetherDeps = new ArrayList<Dependency>( mavenDependencies.size() );\r\n-\r\n         final Class<?>[] argClasses =\r\n             new Class<?>[] { org.apache.maven.model.Dependency.class, ArtifactTypeRegistry.class };\r\n \r\n-        for ( org.apache.maven.model.Dependency mavenDependency : mavenDependencies )\r\n+        List<Dependency> aetherDeps = null;\r\n+\r\n+        if ( mavenDependencies != null )\r\n         {\r\n-            Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n+            aetherDeps = new ArrayList<Dependency>( mavenDependencies.size() );\r\n \r\n-            Dependency aetherDependency =\r\n-                (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n+            for ( org.apache.maven.model.Dependency mavenDependency : mavenDependencies )\r\n+            {\r\n+                Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n \r\n-            aetherDeps.add( aetherDependency );\r\n-        }\r\n+                Dependency aetherDependency =\r\n+                    (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n \r\n-        List<Dependency> aetherManagedDeps = new ArrayList<Dependency>( managedMavenDependencies.size() );\r\n+                aetherDeps.add( aetherDependency );\r\n+            }\r\n+        }\r\n \r\n-        for ( org.apache.maven.model.Dependency mavenDependency : managedMavenDependencies )\r\n+        List<Dependency> aetherManagedDependencies = null;\r\n+        \r\n+        if ( managedMavenDependencies != null )\r\n         {\r\n-            Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n+            aetherManagedDependencies = new ArrayList<Dependency>( managedMavenDependencies.size() );\r\n+\r\n+            for ( org.apache.maven.model.Dependency mavenDependency : managedMavenDependencies )\r\n+            {\r\n+                Object[] args = new Object[] { mavenDependency, typeRegistry };\r\n \r\n-            Dependency aetherDependency =\r\n-                (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n+                Dependency aetherDependency =\r\n+                    (Dependency) Invoker.invoke( RepositoryUtils.class, \"toDependency\", argClasses, args );\r\n \r\n-            aetherManagedDeps.add( aetherDependency );\r\n+                aetherManagedDependencies.add( aetherDependency );\r\n+            }\r\n         }\r\n \r\n         @SuppressWarnings( \"unchecked\" )\r\n         List<RemoteRepository> aetherRepos =\r\n             (List<RemoteRepository>) Invoker.invoke( RepositoryUtils.class, \"toRepos\", List.class,\r\n                                                      buildingRequest.getRemoteRepositories() );\r\n \r\n-        CollectRequest request = new CollectRequest( aetherDeps, aetherManagedDeps, aetherRepos );\r\n+        CollectRequest request = new CollectRequest( aetherDeps, aetherManagedDependencies, aetherRepos );\r\n \r\n         return resolveDependencies( buildingRequest, aetherRepos, filter, request );\r\n     }\r", "filename": "src/main/java/org/apache/maven/shared/dependency/resolve/internal/Maven31DependencyResolver.java"}], "repo": "maven-artifact-transfer"}]
