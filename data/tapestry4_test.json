{
    "tapestry4_02b9cfe": {
        "bug_id": "tapestry4_02b9cfe",
        "commit": "https://github.com/apache/tapestry4/commit/02b9cfe88da6501b9075f8ad2c89c97fed00b3ba",
        "file": [
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/tapestry4/blob/02b9cfe88da6501b9075f8ad2c89c97fed00b3ba/tapestry-framework/src/java/org/apache/tapestry/util/exception/ExceptionAnalyzer.java",
                "changes": 50,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/tapestry-framework/src/java/org/apache/tapestry/util/exception/ExceptionAnalyzer.java?ref=02b9cfe88da6501b9075f8ad2c89c97fed00b3ba",
                "deletions": 28,
                "filename": "tapestry-framework/src/java/org/apache/tapestry/util/exception/ExceptionAnalyzer.java",
                "patch": "@@ -101,30 +101,15 @@ public void setExhaustive(boolean value)\n     }\n \n     protected Throwable buildDescription(Throwable exception)\n-    {\n-        BeanInfo info;\n-        Class exceptionClass;\n-        ExceptionProperty property;\n-        PropertyDescriptor[] descriptors;\n-        PropertyDescriptor descriptor;\n-        Throwable next = null;\n-        int i;\n-        Object value;\n-        Method method;\n-        ExceptionProperty[] properties;\n-        ExceptionDescription description;\n-        String stringValue;\n-        String message;\n-        String[] stackTrace = null;\n-\n+    {   \n         propertyDescriptions.clear();\n-\n-        message = exception.getMessage();\n-        exceptionClass = exception.getClass();\n+        \n+        Class exceptionClass = exception.getClass();\n \n         // Get properties, ignoring those in Throwable and higher\n         // (including the 'message' property).\n \n+        BeanInfo info;\n         try\n         {\n             info = Introspector.getBeanInfo(exceptionClass, Throwable.class);\n@@ -134,13 +119,16 @@ protected Throwable buildDescription(Throwable exception)\n             return null;\n         }\n \n-        descriptors = info.getPropertyDescriptors();\n+        Object value;\n+        Throwable next = null;\n+        String message = exception.getMessage();\n+        PropertyDescriptor[] descriptors = info.getPropertyDescriptors();\n \n-        for (i = 0; i < descriptors.length; i++)\n+        for (int i = 0; i < descriptors.length; i++)\n         {\n-            descriptor = descriptors[i];\n+        \tPropertyDescriptor descriptor = descriptors[i];\n \n-            method = descriptor.getReadMethod();\n+            Method method = descriptor.getReadMethod();\n             if (method == null)\n                 continue;\n \n@@ -175,29 +163,35 @@ protected Throwable buildDescription(Throwable exception)\n                 continue;\n             }\n \n-            stringValue = value.toString().trim();\n+            String stringValue = value.toString();\n+            \n+            if (stringValue == null)\n+            \tcontinue;\n+            \n+            stringValue = stringValue.trim();            \n \n             if (stringValue.length() == 0)\n                 continue;\n \n-            property = new ExceptionProperty(descriptor.getDisplayName(), value);\n+            ExceptionProperty property = new ExceptionProperty(descriptor.getDisplayName(), value);\n \n             propertyDescriptions.add(property);\n         }\n \n         // If exhaustive, or in the deepest exception (where there's no next)\n         // the extract the stack trace.\n-\n+        String[] stackTrace = null;\n+        \n         if (next == null || exhaustive)\n             stackTrace = getStackTrace(exception);\n \n         // Would be nice to sort the properties here.\n \n-        properties = new ExceptionProperty[propertyDescriptions.size()];\n+        ExceptionProperty[] properties = new ExceptionProperty[propertyDescriptions.size()];\n \n         ExceptionProperty[] propArray = (ExceptionProperty[]) propertyDescriptions.toArray(properties);\n \n-        description = new ExceptionDescription(exceptionClass.getName(), message, propArray, stackTrace);\n+        ExceptionDescription description = new ExceptionDescription(exceptionClass.getName(), message, propArray, stackTrace);\n \n         exceptionDescriptions.add(description);\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/02b9cfe88da6501b9075f8ad2c89c97fed00b3ba/tapestry-framework/src/java/org/apache/tapestry/util/exception/ExceptionAnalyzer.java",
                "sha": "1ba34a976df9eade1c2abeb85d17c24cc549ca62",
                "status": "modified"
            },
            {
                "additions": 52,
                "blob_url": "https://github.com/apache/tapestry4/blob/02b9cfe88da6501b9075f8ad2c89c97fed00b3ba/tapestry-framework/src/test/org/apache/tapestry/util/exception/TestExceptionAnalyzer.java",
                "changes": 52,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/tapestry-framework/src/test/org/apache/tapestry/util/exception/TestExceptionAnalyzer.java?ref=02b9cfe88da6501b9075f8ad2c89c97fed00b3ba",
                "deletions": 0,
                "filename": "tapestry-framework/src/test/org/apache/tapestry/util/exception/TestExceptionAnalyzer.java",
                "patch": "@@ -0,0 +1,52 @@\n+package org.apache.tapestry.util.exception;\n+\n+import java.io.ByteArrayOutputStream;\n+import java.io.PrintStream;\n+\n+import org.apache.hivemind.ApplicationRuntimeException;\n+import org.testng.Assert;\n+import org.testng.annotations.Test;\n+\n+@Test\n+public class TestExceptionAnalyzer extends Assert {\n+\t\n+\tpublic void test_report_exception() {\n+\t\tApplicationRuntimeException ex = new ApplicationRuntimeException(\"TAPerrorSTRY\");\t\t\n+\t\t\n+\t\tByteArrayOutputStream stream = new ByteArrayOutputStream();\n+\t\t\n+\t\tnew ExceptionAnalyzer().reportException(ex, new PrintStream(stream));\n+\t\t\n+\t\tString output = stream.toString();\n+\t\t\t\n+\t\tassertTrue(output.contains(\"org.apache.hivemind.ApplicationRuntimeException\"));\n+\t\tassertTrue(output.contains(\"TAPerrorSTRY\"));\n+\t}\n+\t\n+\t// test for TAPESTRY-2570\n+\tpublic void test_with_null_tostring_exception() {\n+\t\tException dummyException = new Exception(\"TAPerrorSTRY\"){\n+\t\t\tpublic Object getDummy() {\n+\t\t\t\treturn new Object(){\n+\t\t\t\t\t@Override\n+\t\t\t\t\tpublic String toString() {\n+\t\t\t\t\t\treturn null;\n+\t\t\t\t\t}\n+\t\t\t\t};\n+\t\t\t}\n+\t\t};\n+\t\tApplicationRuntimeException ex = new ApplicationRuntimeException(dummyException);\n+\t\t\n+\t\tByteArrayOutputStream stream = new ByteArrayOutputStream();\n+\t\t\n+\t\tnew ExceptionAnalyzer().reportException(ex, new PrintStream(stream));\n+\t\t\n+\t\tString output = stream.toString();\n+\t\t\n+\t\tassertTrue(output.contains(\"org.apache.hivemind.ApplicationRuntimeException\"));\n+\t\tassertTrue(output.contains(\"TAPerrorSTRY\"));\n+\t\t\n+\t}\n+\t\n+\t\n+}",
                "raw_url": "https://github.com/apache/tapestry4/raw/02b9cfe88da6501b9075f8ad2c89c97fed00b3ba/tapestry-framework/src/test/org/apache/tapestry/util/exception/TestExceptionAnalyzer.java",
                "sha": "ccc3595474418d1e7f801cc27e5010bf8340e20e",
                "status": "added"
            }
        ],
        "message": "TAPESTRY-2570: Fixed NPE issue when trying to report an exception involving an instance that returns null for toString() + move around some variables definition to improve readability\n\ngit-svn-id: https://svn.apache.org/repos/asf/tapestry/tapestry4/trunk@833891 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/618bae503b4c52bc550413051fd2e3fabf4ffb86",
        "patched_files": [
            "ExceptionAnalyzer.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestExceptionAnalyzer.java"
        ]
    },
    "tapestry4_2303120": {
        "bug_id": "tapestry4_2303120",
        "commit": "https://github.com/apache/tapestry4/commit/23031202a9ebf8455dbe637192e13cc03b9a64ff",
        "file": [
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/tapestry4/blob/23031202a9ebf8455dbe637192e13cc03b9a64ff/framework/src/java/org/apache/tapestry/web/LocalizedWebContextResourceFinder.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/web/LocalizedWebContextResourceFinder.java?ref=23031202a9ebf8455dbe637192e13cc03b9a64ff",
                "deletions": 2,
                "filename": "framework/src/java/org/apache/tapestry/web/LocalizedWebContextResourceFinder.java",
                "patch": "@@ -46,8 +46,18 @@ public LocalizedWebContextResourceFinder(WebContext context)\n     public LocalizedResource resolve(String contextPath, Locale locale)\n     {\n         int dotx = contextPath.lastIndexOf('.');\n-        String basePath = contextPath.substring(0, dotx);\n-        String suffix = contextPath.substring(dotx);\n+        String basePath;\n+        String suffix;\n+        if (dotx >= 0) {\n+        \tbasePath = contextPath.substring(0, dotx);\n+        \tsuffix = contextPath.substring(dotx);\n+        }\n+        else\n+        {\n+        \t// Resource without extension\n+        \tbasePath = contextPath;\n+        \tsuffix = \"\";\n+        }\n \n         LocalizedNameGenerator generator = new LocalizedNameGenerator(basePath, locale, suffix);\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/23031202a9ebf8455dbe637192e13cc03b9a64ff/framework/src/java/org/apache/tapestry/web/LocalizedWebContextResourceFinder.java",
                "sha": "2afefc38bdee17ba3cbfd79aac980b5d087dc68d",
                "status": "modified"
            },
            {
                "additions": 33,
                "blob_url": "https://github.com/apache/tapestry4/blob/23031202a9ebf8455dbe637192e13cc03b9a64ff/framework/src/test/org/apache/tapestry/web/WebContextResourceTest.java",
                "changes": 55,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/web/WebContextResourceTest.java?ref=23031202a9ebf8455dbe637192e13cc03b9a64ff",
                "deletions": 22,
                "filename": "framework/src/test/org/apache/tapestry/web/WebContextResourceTest.java",
                "patch": "@@ -19,17 +19,14 @@\n \n import org.apache.hivemind.Resource;\n import org.apache.hivemind.test.HiveMindTestCase;\n-import org.apache.tapestry.web.WebContextResource;\n-import org.apache.tapestry.web.WebContext;\n-import org.easymock.MockControl;\n \n /**\n  * Tests for {@link org.apache.tapestry.web.WebContextResource}.\n  * \n  * @author Howard M. Lewis Ship\n  * @since 4.0\n  */\n-public class TestWebContextResource extends HiveMindTestCase\n+public class WebContextResourceTest extends HiveMindTestCase\n {\n     private WebContext newContext()\n     {\n@@ -57,11 +54,9 @@ public void testConstructor()\n \n     public void testLocalizationExists() throws Exception\n     {\n-        MockControl control = newControl(WebContext.class);\n-        WebContext context = (WebContext) control.getMock();\n+        WebContext context = newContext();\n \n-        context.getResource(\"/foo/bar/baz_en.html\");\n-        control.setReturnValue(new URL(\"http://foo.com\"));\n+        trainGetResource(context, \"/foo/bar/baz_en.html\", new URL(\"http://foo.com\"));\n \n         replayControls();\n \n@@ -75,16 +70,18 @@ public void testLocalizationExists() throws Exception\n         verifyControls();\n     }\n \n-    public void testLocalizationSame() throws Exception\n+    private void trainGetResource(WebContext context, String path, URL url)\n     {\n-        MockControl control = newControl(WebContext.class);\n-        WebContext context = (WebContext) control.getMock();\n+        context.getResource(path);\n+        setReturnValue(context, url);\n+    }\n \n-        context.getResource(\"/foo/bar/baz_en.html\");\n-        control.setReturnValue(null);\n+    public void testLocalizationSame() throws Exception\n+    {\n+        WebContext context = newContext();\n \n-        context.getResource(\"/foo/bar/baz.html\");\n-        control.setReturnValue(new URL(\"http://foo.com\"));\n+        trainGetResource(context, \"/foo/bar/baz_en.html\", null);\n+        trainGetResource(context, \"/foo/bar/baz.html\", new URL(\"http://foo.com\"));\n \n         replayControls();\n \n@@ -99,14 +96,10 @@ public void testLocalizationSame() throws Exception\n \n     public void testLocalizationMissing() throws Exception\n     {\n-        MockControl control = newControl(WebContext.class);\n-        WebContext context = (WebContext) control.getMock();\n-\n-        context.getResource(\"/foo/bar/baz_en.html\");\n-        control.setReturnValue(null);\n+        WebContext context = newContext();\n \n-        context.getResource(\"/foo/bar/baz.html\");\n-        control.setReturnValue(null);\n+        trainGetResource(context, \"/foo/bar/baz_en.html\", null);\n+        trainGetResource(context, \"/foo/bar/baz.html\", null);\n \n         replayControls();\n \n@@ -130,4 +123,22 @@ public void testGetRelativeResource()\n \n         verifyControls();\n     }\n+\n+    public void testGetExtensionlessResource() throws Exception\n+    {\n+        WebContext context = newContext();\n+\n+        trainGetResource(context, \"/foo/bar/baz_en\", new URL(\"http://foo.com\"));\n+\n+        replayControls();\n+\n+        Resource r1 = new WebContextResource(context, \"/foo/bar/baz\");\n+\n+        Resource r2 = r1.getLocalization(Locale.ENGLISH);\n+\n+        assertEquals(\"/foo/bar/baz_en\", r2.getPath());\n+        assertEquals(Locale.ENGLISH, r2.getLocale());\n+\n+        verifyControls();\n+    }\n }\n\\ No newline at end of file",
                "previous_filename": "framework/src/test/org/apache/tapestry/web/TestWebContextResource.java",
                "raw_url": "https://github.com/apache/tapestry4/raw/23031202a9ebf8455dbe637192e13cc03b9a64ff/framework/src/test/org/apache/tapestry/web/WebContextResourceTest.java",
                "sha": "b05e511edeb597735e1be6b8cafecefc9c283f0d",
                "status": "renamed"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/23031202a9ebf8455dbe637192e13cc03b9a64ff/status.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/status.xml?ref=23031202a9ebf8455dbe637192e13cc03b9a64ff",
                "deletions": 0,
                "filename": "status.xml",
                "patch": "@@ -61,6 +61,7 @@\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-715\">LinkSubmit component should render its body, even when disabled</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-602\">Add annotation to define default value of property</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-723\">The \"empty\" property of StringTranslator is broken</action>\n+      <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-526\" due-to=\"Marcus Brito\">Tapestry throws a NPE if you try to configure an asset without an extension</action>\n     </release>\n     <release version=\"4.0-beta-11\" date=\"Oct 16 2005\">\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-650\">ClassNotFoundException thrown when deserializing an object from a client persistent property</action>",
                "raw_url": "https://github.com/apache/tapestry4/raw/23031202a9ebf8455dbe637192e13cc03b9a64ff/status.xml",
                "sha": "8802b82c317598fec816e558772fe8942f3e0beb",
                "status": "modified"
            }
        ],
        "message": "TAPESTRY-526: Tapestry throws a NPE if you try to configure an asset without an extension\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@329628 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/7d7c4042249a27cc94a4df759647ecdd961f7b68",
        "patched_files": [
            "WebContextResource.java",
            "LocalizedWebContextResourceFinder.java",
            "status.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "WebContextResourceTest.java"
        ]
    },
    "tapestry4_268a857": {
        "bug_id": "tapestry4_268a857",
        "commit": "https://github.com/apache/tapestry4/commit/268a85714cc64daa2d50582c9632ae0889eda3bc",
        "file": [
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/tapestry4/blob/268a85714cc64daa2d50582c9632ae0889eda3bc/framework/src/org/apache/tapestry/valid/ValidationDelegate.java",
                "changes": 9,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/org/apache/tapestry/valid/ValidationDelegate.java?ref=268a85714cc64daa2d50582c9632ae0889eda3bc",
                "deletions": 1,
                "filename": "framework/src/org/apache/tapestry/valid/ValidationDelegate.java",
                "patch": "@@ -62,6 +62,7 @@\n import java.util.List;\n import java.util.Map;\n \n+import org.apache.tapestry.IForm;\n import org.apache.tapestry.IMarkupWriter;\n import org.apache.tapestry.IRender;\n import org.apache.tapestry.IRequestCycle;\n@@ -432,7 +433,13 @@ protected boolean isInError(IFormComponent component)\n         if (_trackingMap == null)\n             return false;\n \n-        String formName = component.getForm().getName();\n+        IForm form = component.getForm();\n+        // if there is no form, the component cannot have been rewound or rendered into a form yet\n+        // so assume it cannot have errors.\n+        if (form == null)\n+            return false;\n+        \n+        String formName = form.getName();\n         Map formMap = (Map) _trackingMap.get(formName);\n \n         if (formMap == null)",
                "raw_url": "https://github.com/apache/tapestry4/raw/268a85714cc64daa2d50582c9632ae0889eda3bc/framework/src/org/apache/tapestry/valid/ValidationDelegate.java",
                "sha": "8d015a18c84ac319a80cbb11c1584bbfc8a67000",
                "status": "modified"
            }
        ],
        "message": "[ 25585 ] ValidationDelegate throws NPE for some new FieldLabel/ValidField\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@243678 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/142eefacf6a50f9cd30f4b9efa69ef16a673b466",
        "patched_files": [
            "ValidationDelegate.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestValidationDelegate.java"
        ]
    },
    "tapestry4_36043f2": {
        "bug_id": "tapestry4_36043f2",
        "commit": "https://github.com/apache/tapestry4/commit/36043f294e52ddc61ff16409be64acb452aa3ee1",
        "file": [
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/tapestry4/blob/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/java/org/apache/tapestry/record/PageClientPropertyPersistenceScope.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/record/PageClientPropertyPersistenceScope.java?ref=36043f294e52ddc61ff16409be64acb452aa3ee1",
                "deletions": 2,
                "filename": "framework/src/java/org/apache/tapestry/record/PageClientPropertyPersistenceScope.java",
                "patch": "@@ -14,6 +14,7 @@\n \n package org.apache.tapestry.record;\n \n+import org.apache.tapestry.IPage;\n import org.apache.tapestry.IRequestCycle;\n import org.apache.tapestry.engine.ServiceEncoding;\n \n@@ -29,7 +30,7 @@\n         AbstractPrefixedClientPropertyPersistenceScope\n {\n     private IRequestCycle _requestCycle;\n-    \n+\n     public PageClientPropertyPersistenceScope()\n     {\n         super(\"state:\");\n@@ -43,7 +44,18 @@ public PageClientPropertyPersistenceScope()\n     public boolean shouldEncodeState(ServiceEncoding encoding, String pageName,\n             PersistentPropertyData data)\n     {\n-        return pageName.equals(_requestCycle.getPage().getPageName());\n+        IPage page = _requestCycle.getPage();\n+\n+        // TAPESTRY-701: if you try to generate a link using, say, page or external service,\n+        // from inside PageValidateListener.pageValidate(), then there may not be an active\n+        // page yet. Seems like the right thing to do is hold onto any properties until\n+        // we know what the active page is.  I know this one is going to cause a fight\n+        // since its not clear whether keeping or discarding is the right way to go.\n+        \n+        if (page == null)\n+            return true;\n+\n+        return pageName.equals(page.getPageName());\n     }\n \n     public void setRequestCycle(IRequestCycle requestCycle)",
                "raw_url": "https://github.com/apache/tapestry4/raw/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/java/org/apache/tapestry/record/PageClientPropertyPersistenceScope.java",
                "sha": "9380aa67b1783dda1d7e96d3af06f821abf40bfd",
                "status": "modified"
            },
            {
                "additions": 122,
                "blob_url": "https://github.com/apache/tapestry4/blob/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/test/org/apache/tapestry/record/ClientPropertyPersistenceStrategyTest.java",
                "changes": 209,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/record/ClientPropertyPersistenceStrategyTest.java?ref=36043f294e52ddc61ff16409be64acb452aa3ee1",
                "deletions": 87,
                "filename": "framework/src/test/org/apache/tapestry/record/ClientPropertyPersistenceStrategyTest.java",
                "patch": "@@ -23,58 +23,66 @@\n import org.apache.tapestry.IRequestCycle;\n import org.apache.tapestry.engine.ServiceEncoding;\n import org.apache.tapestry.web.WebRequest;\n-import org.easymock.MockControl;\n \n /**\n  * Tests for {@link org.apache.tapestry.record.ClientPropertyPersistenceStrategy}.\n  * \n  * @author Howard M. Lewis Ship\n  * @since 4.0\n  */\n-public class TestClientPropertyPersistenceStrategy extends HiveMindTestCase\n+public class ClientPropertyPersistenceStrategyTest extends HiveMindTestCase\n {\n-    public void testInitialize()\n+    private IRequestCycle newCycle()\n     {\n-        MockControl requestc = newControl(WebRequest.class);\n-        WebRequest request = (WebRequest) requestc.getMock();\n+        return (IRequestCycle) newMock(IRequestCycle.class);\n+    }\n \n-        request.getParameterNames();\n-        requestc.setReturnValue(Arrays.asList(new Object[]\n-        { \"foo\", \"state:MyPage\" }));\n+    private PersistentPropertyDataEncoder newEncoder()\n+    {\n+        PersistentPropertyDataEncoderImpl encoder = new PersistentPropertyDataEncoderImpl();\n+        encoder.setClassResolver(getClassResolver());\n \n-        MockControl scopec = newControl(ClientPropertyPersistenceScope.class);\n-        ClientPropertyPersistenceScope scope = (ClientPropertyPersistenceScope) scopec.getMock();\n+        return encoder;\n+    }\n \n-        scope.isParameterForScope(\"foo\");\n-        scopec.setReturnValue(false);\n+    private IPage newPage()\n+    {\n+        return (IPage) newMock(IPage.class);\n+    }\n+\n+    private WebRequest newRequest()\n+    {\n+        return (WebRequest) newMock(WebRequest.class);\n+    }\n \n-        scope.isParameterForScope(\"state:MyPage\");\n-        scopec.setReturnValue(true);\n+    private ClientPropertyPersistenceScope newScope()\n+    {\n+        return (ClientPropertyPersistenceScope) newMock(ClientPropertyPersistenceScope.class);\n+    }\n \n-        scope.extractPageName(\"state:MyPage\");\n-        scopec.setReturnValue(\"MyPage\");\n+    public void testAddParametersForPersistentProperties()\n+    {\n+        WebRequest request = newRequest();\n \n-        request.getParameterValue(\"state:MyPage\");\n-        requestc.setReturnValue(\"ENCODED\");\n+        ServiceEncoding encoding = (ServiceEncoding) newMock(ServiceEncoding.class);\n \n-        MockControl encoderc = newControl(PersistentPropertyDataEncoder.class);\n-        PersistentPropertyDataEncoder encoder = (PersistentPropertyDataEncoder) encoderc.getMock();\n+        trainGetParameterNames(request, new String[]\n+        { \"bar\", \"appstate:MyPage\" });\n \n-        List changes = Collections.singletonList(new PropertyChangeImpl(\"foo\", \"bar\", \"baz\"));\n+        trainGetParameterValue(request, \"appstate:MyPage\", \"ENCODED\");\n \n-        encoder.decodePageChanges(\"ENCODED\");\n-        encoderc.setReturnValue(changes);\n+        encoding.setParameterValue(\"appstate:MyPage\", \"ENCODED\");\n \n         replayControls();\n \n         ClientPropertyPersistenceStrategy strategy = new ClientPropertyPersistenceStrategy();\n         strategy.setRequest(request);\n-        strategy.setScope(scope);\n-        strategy.setEncoder(encoder);\n+        strategy.setScope(new AppClientPropertyPersistenceScope());\n+        strategy.setEncoder(newEncoder());\n \n         strategy.initializeService();\n \n-        assertSame(changes, strategy.getStoredChanges(\"MyPage\"));\n+        strategy.addParametersForPersistentProperties(encoding, false);\n \n         verifyControls();\n     }\n@@ -86,96 +94,62 @@ public void testGetChangesUnknownPage()\n         assertTrue(strategy.getStoredChanges(\"UnknownPage\").isEmpty());\n     }\n \n-    public void testStoreAndRetrieve()\n+    public void testInitialize()\n     {\n-        PropertyChange pc = new PropertyChangeImpl(\"foo\", \"bar\", \"baz\");\n-\n-        ClientPropertyPersistenceStrategy strategy = new ClientPropertyPersistenceStrategy();\n-        strategy.setEncoder(newEncoder());\n-\n-        strategy.store(\"MyPage\", \"foo\", \"bar\", \"baz\");\n+        WebRequest request = newRequest();\n+        ClientPropertyPersistenceScope scope = newScope();\n+        PersistentPropertyDataEncoder encoder = (PersistentPropertyDataEncoder) newMock(PersistentPropertyDataEncoder.class);\n \n-        assertEquals(Collections.singletonList(pc), strategy.getStoredChanges(\"MyPage\"));\n+        trainGetParameterNames(request, new String[]\n+        { \"foo\", \"state:MyPage\" });\n \n-        strategy.discardStoredChanges(\"MyPage\");\n+        trainIsParameterForScope(scope, \"foo\", false);\n+        trainIsParameterForScope(scope, \"state:MyPage\", true);\n \n-        assertEquals(Collections.EMPTY_LIST, strategy.getStoredChanges(\"MyPage\"));\n-    }\n+        trainExtractPageName(scope, \"state:MyPage\", \"MyPage\");\n \n-    public void testAddParametersForPersistentProperties()\n-    {\n-        MockControl requestc = newControl(WebRequest.class);\n-        WebRequest request = (WebRequest) requestc.getMock();\n+        trainGetParameterValue(request, \"state:MyPage\", \"ENCODED\");\n \n-        ServiceEncoding encoding = (ServiceEncoding) newMock(ServiceEncoding.class);\n-\n-        request.getParameterNames();\n-        requestc.setReturnValue(Arrays.asList(new Object[]\n-        { \"bar\", \"appstate:MyPage\" }));\n+        List changes = Collections.singletonList(new PropertyChangeImpl(\"foo\", \"bar\", \"baz\"));\n \n-        request.getParameterValue(\"appstate:MyPage\");\n-        requestc.setReturnValue(\"ENCODED\");\n-\n-        encoding.setParameterValue(\"appstate:MyPage\", \"ENCODED\");\n+        trainDecodePageChanges(encoder, \"ENCODED\", changes);\n \n         replayControls();\n \n         ClientPropertyPersistenceStrategy strategy = new ClientPropertyPersistenceStrategy();\n         strategy.setRequest(request);\n-        strategy.setScope(new AppClientPropertyPersistenceScope());\n-        strategy.setEncoder(newEncoder());\n+        strategy.setScope(scope);\n+        strategy.setEncoder(encoder);\n \n         strategy.initializeService();\n \n-        strategy.addParametersForPersistentProperties(encoding, false);\n+        assertSame(changes, strategy.getStoredChanges(\"MyPage\"));\n \n         verifyControls();\n     }\n \n-    private PersistentPropertyDataEncoder newEncoder()\n-    {\n-        PersistentPropertyDataEncoderImpl encoder = new PersistentPropertyDataEncoderImpl();\n-        encoder.setClassResolver(getClassResolver());\n-\n-        return encoder;\n-    }\n-\n     public void testPageScope()\n     {\n-        MockControl requestc = newControl(WebRequest.class);\n-        WebRequest request = (WebRequest) requestc.getMock();\n-\n-        MockControl cyclec = newControl(IRequestCycle.class);\n-        IRequestCycle cycle = (IRequestCycle) cyclec.getMock();\n-\n-        MockControl pagec = newControl(IPage.class);\n-        IPage page = (IPage) pagec.getMock();\n+        WebRequest request = newRequest();\n+        IRequestCycle cycle = newCycle();\n+        IPage page = newPage();\n \n         ServiceEncoding encoding = (ServiceEncoding) newMock(ServiceEncoding.class);\n \n-        cycle.getPage();\n-        cyclec.setReturnValue(page);\n-\n-        cycle.getPage();\n-        cyclec.setReturnValue(page);\n+        trainGetPage(cycle, page);\n \n-        page.getPageName();\n-        pagec.setReturnValue(\"MyPage\");\n-\n-        page.getPageName();\n-        pagec.setReturnValue(\"MyPage\");\n+        trainGetPageName(page, \"MyPage\");\n \n-        request.getParameterNames();\n-        requestc.setReturnValue(Arrays.asList(new Object[]\n-        { \"foo\", \"state:MyPage\", \"state:OtherPage\" }));\n+        trainGetPage(cycle, page);\n+        trainGetPageName(page, \"MyPage\");\n \n-        request.getParameterValue(\"state:MyPage\");\n-        requestc.setReturnValue(\"ENCODED\");\n+        trainGetParameterNames(request, new String[]\n+        { \"foo\", \"state:MyPage\", \"state:OtherPage\" });\n \n-        request.getParameterValue(\"state:OtherPage\");\n-        requestc.setReturnValue(\"ENCODED\");\n+        trainGetParameterValue(request, \"state:MyPage\", \"ENCODED1\");\n+        trainGetParameterValue(request, \"state:OtherPage\", \"ENCODED2\");\n \n-        encoding.setParameterValue(\"state:MyPage\", \"ENCODED\");\n+        encoding.setParameterValue(\"state:MyPage\", \"ENCODED1\");\n \n         replayControls();\n \n@@ -194,4 +168,65 @@ public void testPageScope()\n         verifyControls();\n \n     }\n+\n+    public void testStoreAndRetrieve()\n+    {\n+        PropertyChange pc = new PropertyChangeImpl(\"foo\", \"bar\", \"baz\");\n+\n+        ClientPropertyPersistenceStrategy strategy = new ClientPropertyPersistenceStrategy();\n+        strategy.setEncoder(newEncoder());\n+\n+        strategy.store(\"MyPage\", \"foo\", \"bar\", \"baz\");\n+\n+        assertEquals(Collections.singletonList(pc), strategy.getStoredChanges(\"MyPage\"));\n+\n+        strategy.discardStoredChanges(\"MyPage\");\n+\n+        assertEquals(Collections.EMPTY_LIST, strategy.getStoredChanges(\"MyPage\"));\n+    }\n+\n+    private void trainDecodePageChanges(PersistentPropertyDataEncoder encoder, String encoded,\n+            List changes)\n+    {\n+        encoder.decodePageChanges(encoded);\n+        setReturnValue(encoder, changes);\n+    }\n+\n+    private void trainExtractPageName(ClientPropertyPersistenceScope scope, String parameterName,\n+            String pageName)\n+    {\n+        scope.extractPageName(parameterName);\n+        setReturnValue(scope, pageName);\n+    }\n+\n+    private void trainGetPage(IRequestCycle cycle, IPage page)\n+    {\n+        cycle.getPage();\n+        setReturnValue(cycle, page);\n+    }\n+\n+    private void trainGetPageName(IPage page, String pageName)\n+    {\n+        page.getPageName();\n+        setReturnValue(page, pageName);\n+    }\n+\n+    private void trainGetParameterNames(WebRequest request, String[] names)\n+    {\n+        request.getParameterNames();\n+        setReturnValue(request, Arrays.asList(names));\n+    }\n+\n+    private void trainGetParameterValue(WebRequest request, String parameterName, String value)\n+    {\n+        request.getParameterValue(parameterName);\n+        setReturnValue(request, value);\n+    }\n+\n+    private void trainIsParameterForScope(ClientPropertyPersistenceScope scope,\n+            String parameterName, boolean result)\n+    {\n+        scope.isParameterForScope(parameterName);\n+        setReturnValue(scope, result);\n+    }\n }\n\\ No newline at end of file",
                "previous_filename": "framework/src/test/org/apache/tapestry/record/TestClientPropertyPersistenceStrategy.java",
                "raw_url": "https://github.com/apache/tapestry4/raw/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/test/org/apache/tapestry/record/ClientPropertyPersistenceStrategyTest.java",
                "sha": "e9bc66ac6845c2948ab3d373ab359dfb7891a2b1",
                "status": "renamed"
            },
            {
                "additions": 128,
                "blob_url": "https://github.com/apache/tapestry4/blob/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/test/org/apache/tapestry/record/PageClientPropertyPersistenceScopeTest.java",
                "changes": 128,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/record/PageClientPropertyPersistenceScopeTest.java?ref=36043f294e52ddc61ff16409be64acb452aa3ee1",
                "deletions": 0,
                "filename": "framework/src/test/org/apache/tapestry/record/PageClientPropertyPersistenceScopeTest.java",
                "patch": "@@ -0,0 +1,128 @@\n+// Copyright 2005 The Apache Software Foundation\r\n+//\r\n+// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n+// you may not use this file except in compliance with the License.\r\n+// You may obtain a copy of the License at\r\n+//\r\n+//     http://www.apache.org/licenses/LICENSE-2.0\r\n+//\r\n+// Unless required by applicable law or agreed to in writing, software\r\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n+// See the License for the specific language governing permissions and\r\n+// limitations under the License.\r\n+\r\n+package org.apache.tapestry.record;\r\n+\r\n+import org.apache.hivemind.test.HiveMindTestCase;\r\n+import org.apache.tapestry.IPage;\r\n+import org.apache.tapestry.IRequestCycle;\r\n+\r\n+/**\r\n+ * Tests for {@link org.apache.tapestry.record.PageClientPropertyPersistenceScope}.\r\n+ * \r\n+ * @author Howard M. Lewis Ship\r\n+ * @since 4.0\r\n+ */\r\n+public class PageClientPropertyPersistenceScopeTest extends HiveMindTestCase\r\n+{\r\n+    protected IRequestCycle newCycle()\r\n+    {\r\n+        return (IRequestCycle) newMock(IRequestCycle.class);\r\n+    }\r\n+\r\n+    protected IPage newPage()\r\n+    {\r\n+        return (IPage) newMock(IPage.class);\r\n+    }\r\n+\r\n+    public void testConstructParameterName()\r\n+    {\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        assertEquals(\"state:MyPage\", scope.constructParameterName(\"MyPage\"));\r\n+    }\r\n+\r\n+    public void testIsParameterForScope()\r\n+    {\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        assertEquals(true, scope.isParameterForScope(\"state:MyPage\"));\r\n+        assertEquals(false, scope.isParameterForScope(\"foo\"));\r\n+        assertEquals(false, scope.isParameterForScope(\"appstate:Foo\"));\r\n+    }\r\n+\r\n+    public void testExtractPageName()\r\n+    {\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        assertEquals(\"MyPage\", scope.extractPageName(\"state:MyPage\"));\r\n+    }\r\n+\r\n+    public void testShouldEncodeState()\r\n+    {\r\n+        IRequestCycle cycle = newCycle();\r\n+        IPage page = newPage();\r\n+\r\n+        trainGetPage(cycle, page);\r\n+        trainGetPageName(page, \"MyPage\");\r\n+\r\n+        replayControls();\r\n+\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        scope.setRequestCycle(cycle);\r\n+\r\n+        assertEquals(true, scope.shouldEncodeState(null, \"MyPage\", null));\r\n+\r\n+        verifyControls();\r\n+    }\r\n+\r\n+    public void testShouldEncodeStateDifferentPage()\r\n+    {\r\n+        IRequestCycle cycle = newCycle();\r\n+        IPage page = newPage();\r\n+\r\n+        trainGetPage(cycle, page);\r\n+        trainGetPageName(page, \"MyPage\");\r\n+\r\n+        replayControls();\r\n+\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        scope.setRequestCycle(cycle);\r\n+\r\n+        assertEquals(false, scope.shouldEncodeState(null, \"OtherPage\", null));\r\n+\r\n+        verifyControls();\r\n+    }\r\n+\r\n+    public void testShouldEncodeStateNoActivePage()\r\n+    {\r\n+        IRequestCycle cycle = newCycle();\r\n+\r\n+        trainGetPage(cycle, null);\r\n+\r\n+        replayControls();\r\n+\r\n+        PageClientPropertyPersistenceScope scope = new PageClientPropertyPersistenceScope();\r\n+\r\n+        scope.setRequestCycle(cycle);\r\n+\r\n+        assertEquals(true, scope.shouldEncodeState(null, \"MyPage\", null));\r\n+\r\n+        verifyControls();\r\n+    }\r\n+\r\n+    private void trainGetPageName(IPage page, String pageName)\r\n+    {\r\n+        page.getPageName();\r\n+        setReturnValue(page, pageName);\r\n+    }\r\n+\r\n+    private void trainGetPage(IRequestCycle cycle, IPage page)\r\n+    {\r\n+        cycle.getPage();\r\n+        setReturnValue(cycle, page);\r\n+    }\r\n+}\r",
                "raw_url": "https://github.com/apache/tapestry4/raw/36043f294e52ddc61ff16409be64acb452aa3ee1/framework/src/test/org/apache/tapestry/record/PageClientPropertyPersistenceScopeTest.java",
                "sha": "333f79030d96ed921503fdce0e5a1c3590942f00",
                "status": "added"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/36043f294e52ddc61ff16409be64acb452aa3ee1/status.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/status.xml?ref=36043f294e52ddc61ff16409be64acb452aa3ee1",
                "deletions": 0,
                "filename": "status.xml",
                "patch": "@@ -67,6 +67,7 @@\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-769\">StateBinding doesn't override isInvariant()</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-768\">FormMessages class has typo in message key for fieldAlreadyPrerendered()</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-275\" due-to=\"Igor Grimaylo\">Single quotes in a localization of DatePicker strings causes a failure</action>\n+      <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-701\">NPE creating a link from pageValidate() when there are client-persistent properties with page scope</action>\n     </release>\n     <release version=\"4.0-beta-13\" date=\"Nov 12 2005\">\n       <action type=\"update\" dev=\"HLS\">Switch to HiveMind 1.1 (final)</action>",
                "raw_url": "https://github.com/apache/tapestry4/raw/36043f294e52ddc61ff16409be64acb452aa3ee1/status.xml",
                "sha": "784e447f2c3978397421239c020056530a776004",
                "status": "modified"
            }
        ],
        "message": "TAPESTRY-701: NPE creating a link from pageValidate() when there are client-persistent properties with page scope\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@348184 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/d2c4a3e7821ecec9d6f2f69b9b27122bf33ac8bb",
        "patched_files": [
            "PageClientPropertyPersistenceScope.java",
            "ClientPropertyPersistenceStrategy.java",
            "status.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "PageClientPropertyPersistenceScopeTest.java",
            "ClientPropertyPersistenceStrategyTest.java"
        ]
    },
    "tapestry4_60f3729": {
        "bug_id": "tapestry4_60f3729",
        "commit": "https://github.com/apache/tapestry4/commit/60f37294052072f87557264172305cb58cc395cc",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/framework/src/net/sf/tapestry/TapestryStrings.properties",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/net/sf/tapestry/TapestryStrings.properties?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "framework/src/net/sf/tapestry/TapestryStrings.properties",
                "patch": "@@ -368,6 +368,7 @@ FieldLabel.no-display-name=Display name not specified and not provided by field\n \n ValidField.no-delegate=No IValidationDelegate is available to ValidField {0}; it is specified as the delegate parameter of Form {1}.\n ValidField.no-type=The type parameter for field {0} was not specified and is required by the field''s validator.\n+ValidField.must-be-contained-by-body=A ValidField using client-side validation must be wrapped by a Body component.\n \n NumberValidator.no-adaptor-for-field=Unable to provide validation for field {0} (value type {1}).\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/framework/src/net/sf/tapestry/TapestryStrings.properties",
                "sha": "7ac909b73472eeb88f5297d6c7d88b56be89e467",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/framework/src/net/sf/tapestry/valid/BaseValidator.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/net/sf/tapestry/valid/BaseValidator.java?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "framework/src/net/sf/tapestry/valid/BaseValidator.java",
                "patch": "@@ -266,6 +266,9 @@ protected void processValidatorScript(String scriptPath, IRequestCycle cycle, IF\n \n         Body body = Body.get(cycle);\n \n+        if (body == null)\n+            throw new RequestCycleException(Tapestry.getString(\"ValidField.must-be-contained-by-body\"), field);\n+\n         body.process(session);\n \n         String functionName = (String) finalSymbols.get(FUNCTION_SYMBOL);",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/framework/src/net/sf/tapestry/valid/BaseValidator.java",
                "sha": "db6daeb04373957b27edf89e5503bac0d53572bb",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/MockTestCase.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/MockTestCase.java?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/MockTestCase.java",
                "patch": "@@ -159,4 +159,16 @@ public void testStrings()\n     {\n         attempt(\"/net/sf/tapestry/junit/mock/TestStrings.xml\");\n     }\n+    \n+    /**\n+     *  Test case for a ValidField with a validator and client-side scripting, but\n+     *  no Body.\n+     * \n+     **/\n+    \n+    public void testValidFieldNoBody()\n+    throws Exception\n+    {\n+        attempt(\"/net/sf/tapestry/junit/mock/TestValidFieldNoBody.xml\");\n+    }\n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/MockTestCase.java",
                "sha": "da095ad846955a393f90fb90ec2a1d54d8c1d4c3",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/TestStrings.xml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/TestStrings.xml?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 4,
                "filename": "junit/src/net/sf/tapestry/junit/mock/TestStrings.xml",
                "patch": "@@ -3,8 +3,6 @@\n <!-- $Id$ -->\n \n \n-<!-- Tests stale session exception with a DirectLink. -->\n-\n <mock-test>\n     <context name=\"mock\"/>\n     \n@@ -14,8 +12,6 @@\n   \t\t\tvalue=\"/net/sf/tapestry/junit/mock/app/Mock.application\"/>\n   \t</servlet>  \t\n   \t\n-  \t<!-- Simulate clicking the link, which should send the\n-  \t     user to the Protected page.  -->\n   \t     \n   \t<request>\n   \t\t<parameter name=\"service\" value=\"page\"/>",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/TestStrings.xml",
                "sha": "b3c72dab2438a5f98fd43b818289756f62a6aa81",
                "status": "modified"
            },
            {
                "additions": 36,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/TestValidFieldNoBody.xml",
                "changes": 36,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/TestValidFieldNoBody.xml?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/TestValidFieldNoBody.xml",
                "patch": "@@ -0,0 +1,36 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<!-- $Id$ -->\n+\n+\n+\n+<mock-test>\n+    <context name=\"mock\"/>\n+    \n+    <servlet name=\"app\" class=\"net.sf.tapestry.ApplicationServlet\">\n+  \t\t<init-parameter\n+  \t\t\tname=\"net.sf.tapestry.application-specification\"\n+  \t\t\tvalue=\"/net/sf/tapestry/junit/mock/app/Mock.application\"/>\n+  \t</servlet>  \t\n+  \t\n+  \t     \n+  \t<request>\n+  \t\t<parameter name=\"service\" value=\"page\"/>\n+  \t\t<parameter name=\"context\" value=\"ValidFieldNoBody\"/>\n+  \t\t\n+\t\n+\t\t<!-- Should get an Exception -->\n+\t\n+\t\t<assert-output name=\"Title\">\n+<![CDATA[\n+<title>Exception</title>\n+]]>\t\t\n+\t\t</assert-output>\n+\t\n+\t\t<assert-output name=\"Message\">\n+\t\tA ValidField using client-side validation must be wrapped by a Body component.\n+\t\t</assert-output>\n+\t\n+\t</request>\n+\t\t  \t\n+</mock-test>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/TestValidFieldNoBody.xml",
                "sha": "1be189a2f73630c2bac0689eb51eb1d9de5c4b37",
                "status": "added"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/Mock.application",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/app/Mock.application?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/app/Mock.application",
                "patch": "@@ -22,6 +22,8 @@\n \n \t<page name=\"Stale\" specification-path=\"/net/sf/tapestry/junit/mock/app/Stale.page\"/>\n \n+\t<page name=\"ValidFieldNoBody\" specification-path=\"/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.page\"/>\n+\n \t\t\n \t<library id=\"lib\" specification-path=\"/net/sf/tapestry/junit/mock/lib/MockLibrary.library\"/>\n \t",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/Mock.application",
                "sha": "edd73db0f3bbda13aa0d28bd546e60850eb063d0",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/Strings.page",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/app/Strings.page?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 1,
                "filename": "junit/src/net/sf/tapestry/junit/mock/app/Strings.page",
                "patch": "@@ -7,7 +7,7 @@\n <page-specification class=\"net.sf.tapestry.html.BasePage\">\n \n   <component id=\"border\" type=\"lib:Border\">\n-  \t<static-binding name=\"title\">StaleSession Test Page</static-binding>\n+  \t<static-binding name=\"title\">Insert Localized Key Test Page</static-binding>\n   </component>\n \n </page-specification>\t\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/Strings.page",
                "sha": "ee9401332055d3b21d068f558fa4266b369a90ea",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.html",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.html?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.html",
                "patch": "@@ -0,0 +1,17 @@\n+<!-- $Id$ -->\n+\n+<span jwcid=\"Shell\">\n+\n+<body>\n+\n+<form jwcid=\"form\">\n+\n+<input jwcid=\"inputNumber\"/>\n+\n+<input type=\"submit\"/>\n+\n+</form>\n+\n+</body>\n+\n+</span>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.html",
                "sha": "65f5752f60c5cadd367c8de0168958c8b8e87510",
                "status": "added"
            },
            {
                "additions": 58,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.java",
                "changes": 58,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.java?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.java",
                "patch": "@@ -0,0 +1,58 @@\n+//\n+// Tapestry Web Application Framework\n+// Copyright (c) 2002 by Howard Lewis Ship\n+//\n+// Howard Lewis Ship\n+// http://sf.net/projects/tapestry\n+// mailto:hship@users.sf.net\n+//\n+// This library is free software.\n+//\n+// You may redistribute it and/or modify it under the terms of the GNU\n+// Lesser General Public License as published by the Free Software Foundation.\n+//\n+// Version 2.1 of the license should be included with this distribution in\n+// the file LICENSE, as well as License.html. If the license is not\n+// included with this distribution, you may find a copy at the FSF web\n+// site at 'www.gnu.org' or 'www.fsf.org', or you may write to the\n+// Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139 USA.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied waranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+// Lesser General Public License for more details.\n+//\n+\n+package net.sf.tapestry.junit.mock.app;\n+\n+import net.sf.tapestry.html.BasePage;\n+\n+/**\n+ *  Page for testing a validator, with client side validation, but no Body.\n+ *\n+ *  @author Howard Lewis Ship\n+ *  @version $Id$\n+ *  @since 2.3\n+ * \n+ **/\n+\n+public class ValidFieldNoBody extends BasePage\n+{\n+    private int _intValue;        \n+    \n+    protected void initialize()\n+    {\n+        _intValue = 10;\n+    }\n+        \n+    public int getIntValue()\n+    {\n+        return _intValue;\n+    }\n+\n+    public void setIntValue(int intValue)\n+    {\n+        _intValue = intValue;\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.java",
                "sha": "e0c8209a9f64835aba54ccadf98892a779136bd8",
                "status": "added"
            },
            {
                "additions": 34,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.page",
                "changes": 34,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.page?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.page",
                "patch": "@@ -0,0 +1,34 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!-- $Id$ -->\n+<!DOCTYPE page-specification PUBLIC \n+\t\"-//Howard Lewis Ship//Tapestry Specification 1.3//EN\" \n+\t\"http://tapestry.sf.net/dtd/Tapestry_1_3.dtd\">\n+\t\n+<page-specification class=\"net.sf.tapestry.junit.mock.app.ValidFieldNoBody\">\n+\n+  <bean name=\"delegate\" class=\"net.sf.tapestry.valid.ValidationDelegate\"/>\n+\n+  <bean name=\"intValidator\" lifecycle=\"render\" class=\"net.sf.tapestry.valid.NumberValidator\">\n+  \t<set-property name=\"required\" expression=\"true\"/>\n+  \t<set-property name=\"clientScriptingEnabled\" expression=\"true\"/>\n+  </bean>\n+  \n+  <component id=\"Shell\" type=\"Shell\">\n+  \t<static-binding name=\"title\">ValidField w/o Body Test Page</static-binding>\n+  </component>\n+\n+  <component id=\"form\" type=\"Form\">\n+  \t<binding name=\"delegate\" expression=\"beans.delegate\"/>\n+  </component>\n+  \n+\n+  <component id=\"inputNumber\" type=\"ValidField\">\n+    <binding name=\"validator\" expression=\"beans.intValidator\"/>\n+    <binding name=\"value\" expression=\"intValue\"/>\n+    <static-binding name=\"displayName\">Integer Field</static-binding>\n+    <static-binding name=\"type\">Integer</static-binding>\n+  </component>  \n+  \n+  \n+\n+</page-specification>\t\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/junit/src/net/sf/tapestry/junit/mock/app/ValidFieldNoBody.page",
                "sha": "ba6d45112838b70d6799e08259c5ed64b202f13c",
                "status": "added"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/60f37294052072f87557264172305cb58cc395cc/web/new.html",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/web/new.html?ref=60f37294052072f87557264172305cb58cc395cc",
                "deletions": 0,
                "filename": "web/new.html",
                "patch": "@@ -39,6 +39,7 @@ <h3>Release 2.3-alpha-1</h3>\n [ 619481 ] use jakarta commons lang Enum\n [ 627478 ] Don't require servlet subclass\n [ 614324 ] Add a param \"raw\" in addition to \"key\"\n+[ 627332 ] NPE in BaseValidator (form without body)\n </pre>\n \n <h3>Release 2.2</h3>",
                "raw_url": "https://github.com/apache/tapestry4/raw/60f37294052072f87557264172305cb58cc395cc/web/new.html",
                "sha": "a3952749d0b203899017bdbdd13f99c5559b2099",
                "status": "modified"
            }
        ],
        "message": "[ 627332 ] NPE in BaseValidator (form without body)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@243003 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/46f26f58cc257ab8665acdf33b3c0cc1615b88e2",
        "patched_files": [
            "ValidFieldNoBody.java",
            "MockTestCase.java",
            "new.java",
            "TapestryStrings.java",
            "Strings.java",
            "Mock.java",
            "BaseValidator.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestStrings.java",
            "TestValidFieldNoBody.java"
        ]
    },
    "tapestry4_909723a": {
        "bug_id": "tapestry4_909723a",
        "commit": "https://github.com/apache/tapestry4/commit/909723a2759dc41524d42e1563ddcad2655b1281",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/909723a2759dc41524d42e1563ddcad2655b1281/framework/src/org/apache/tapestry/valid/PatternValidator.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/org/apache/tapestry/valid/PatternValidator.java?ref=909723a2759dc41524d42e1563ddcad2655b1281",
                "deletions": 1,
                "filename": "framework/src/org/apache/tapestry/valid/PatternValidator.java",
                "patch": "@@ -291,6 +291,6 @@ public String toString()\n             + \"; Script Path: \"\n             + _scriptPath\n             + \"; Pattern Delegate: \"\n-            + _patternDelegate.toString();\n+            + _patternDelegate;\n     }\n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/909723a2759dc41524d42e1563ddcad2655b1281/framework/src/org/apache/tapestry/valid/PatternValidator.java",
                "sha": "98b8eadd2a675caf78b833494411ce0c16efdc9a",
                "status": "modified"
            }
        ],
        "message": "Fixed Bug: 26599; NPE in toString() reported by Michael.Frericks@sparkassen-informatik.de\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@243762 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/528d4e2cb9db38f43a61e07d213d15624dd943aa",
        "patched_files": [
            "PatternValidator.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestPatternValidator.java"
        ]
    },
    "tapestry4_d0e0eb0": {
        "bug_id": "tapestry4_d0e0eb0",
        "commit": "https://github.com/apache/tapestry4/commit/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/descriptor/META-INF/hivemodule.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/annotations/src/descriptor/META-INF/hivemodule.xml?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 1,
                "filename": "annotations/src/descriptor/META-INF/hivemodule.xml",
                "patch": "@@ -101,14 +101,14 @@\n     <worker annotation=\"InjectObject\" object=\"service:InjectObjectAnnotationWorker\"/>\n     <worker annotation=\"InjectComponent\" object=\"instance:InjectComponentAnnotationWorker\"/>\n     <worker annotation=\"InjectState\" object=\"service:InjectStateAnnotationWorker\"/>\n-    <worker annotation=\"InjectAsset\" object=\"instance:InjectAssetAnnotationWorker\"/>\n     <worker annotation=\"Message\" object=\"instance:MessageAnnotationWorker\"/>\n     \n     <!-- These update the component specification with new sub-elements. Later, the \n          existing enhancement workers perform the work, as if the sub-elements were\n          specified in the XML. This is actually a lot easier and just as powerful, and\n          the delegating style will probably go pretty soon.  -->\n          \n+    <worker annotation=\"InjectAsset\" object=\"instance:InjectAssetAnnotationWorker\"/>\n     <worker annotation=\"Persist\" object=\"instance:PersistAnnotationWorker\"/>\n     <worker annotation=\"Bean\" object=\"instance:BeanAnnotationWorker\"/>\n     <worker annotation=\"Asset\" object=\"instance:AssetAnnotationWorker\"/>",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/descriptor/META-INF/hivemodule.xml",
                "sha": "18478a4e0606034609283a6b3bf003e4ddce065d",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/java/org/apache/tapestry/annotations/AssetAnnotationWorker.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/annotations/src/java/org/apache/tapestry/annotations/AssetAnnotationWorker.java?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 0,
                "filename": "annotations/src/java/org/apache/tapestry/annotations/AssetAnnotationWorker.java",
                "patch": "@@ -16,6 +16,7 @@\n \n import java.lang.reflect.Method;\n \n+import org.apache.hivemind.impl.LocationImpl;\n import org.apache.tapestry.enhance.EnhancementOperation;\n import org.apache.tapestry.spec.AssetSpecification;\n import org.apache.tapestry.spec.IAssetSpecification;\n@@ -42,6 +43,11 @@ public void performEnhancement(EnhancementOperation op, IComponentSpecification\n         as.setPath(asset.value());\n         as.setPropertyName(propertyName);\n \n+        // Very important for assets, as they need a location (really, the Resource\n+        // of a location) to figure out what kind of asset they are.\n+\n+        as.setLocation(new LocationImpl(spec.getSpecificationLocation()));\n+\n         spec.addAsset(propertyName, as);\n     }\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/java/org/apache/tapestry/annotations/AssetAnnotationWorker.java",
                "sha": "037545ef1dd6cb1aea314a7dc115453fc32836e4",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/test/org/apache/tapestry/annotations/TestAssetAnnotationWorker.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/annotations/src/test/org/apache/tapestry/annotations/TestAssetAnnotationWorker.java?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 1,
                "filename": "annotations/src/test/org/apache/tapestry/annotations/TestAssetAnnotationWorker.java",
                "patch": "@@ -16,6 +16,9 @@\n \n import java.lang.reflect.Method;\n \n+import org.apache.hivemind.Location;\n+import org.apache.hivemind.Resource;\n+import org.apache.hivemind.impl.LocationImpl;\n import org.apache.tapestry.enhance.EnhancementOperation;\n import org.apache.tapestry.spec.ComponentSpecification;\n import org.apache.tapestry.spec.IAssetSpecification;\n@@ -32,8 +35,10 @@\n {\n     public void testSuccess()\n     {\n+        Resource r = (Resource) newMock(Resource.class);\n         EnhancementOperation op = newOp();\n         IComponentSpecification spec = new ComponentSpecification();\n+        spec.setSpecificationLocation(r);\n \n         replayControls();\n \n@@ -45,7 +50,7 @@ public void testSuccess()\n \n         IAssetSpecification as = spec.getAsset(\"globalStylesheet\");\n         assertEquals(\"/style/global.css\", as.getPath());\n-        assertNull(as.getLocation());\n+        assertEquals(new LocationImpl(r), as.getLocation());\n         assertEquals(\"globalStylesheet\", as.getPropertyName());\n     }\n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/annotations/src/test/org/apache/tapestry/annotations/TestAssetAnnotationWorker.java",
                "sha": "eb9f357f2c12e929079a236208c7caaa5a62583d",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/examples/Workbench/src/context/WEB-INF/Border.jwc",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/context/WEB-INF/Border.jwc?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 4,
                "filename": "examples/Workbench/src/context/WEB-INF/Border.jwc",
                "patch": "@@ -49,10 +49,6 @@\n     </binding>\n   </component>\n \n-  <asset name=\"activeLeft\" path=\"images/tab-active-left.gif\"/>\n-  <asset name=\"activeMid\" path=\"images/tab-active-mid.gif\"/>\n-  <asset name=\"activeRight\" path=\"images/tab-active-right.gif\"/>\n-\n   <asset name=\"inactiveLeft\" path=\"images/tab-inactive-left.gif\"/>\n   <asset name=\"inactiveMid\" path=\"images/tab-inactive-mid.gif\"/>\n   <asset name=\"inactiveRight\" path=\"images/tab-inactive-right.gif\"/>",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/examples/Workbench/src/context/WEB-INF/Border.jwc",
                "sha": "9de8c53d46c904c6b9b1bfa8cfa86a3b8f16b87f",
                "status": "modified"
            },
            {
                "additions": 26,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/examples/Workbench/src/java/org/apache/tapestry/workbench/components/Border.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/components/Border.java?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 9,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/components/Border.java",
                "patch": "@@ -18,6 +18,8 @@\n import org.apache.tapestry.IAsset;\n import org.apache.tapestry.IRequestCycle;\n import org.apache.tapestry.TapestryUtils;\n+import org.apache.tapestry.annotations.Asset;\n+import org.apache.tapestry.annotations.InjectAsset;\n import org.apache.tapestry.annotations.InjectState;\n import org.apache.tapestry.annotations.Message;\n import org.apache.tapestry.event.PageBeginRenderListener;\n@@ -88,25 +90,40 @@ public String getPageTitle()\n         return getMessages().getMessage(getPageName());\n     }\n \n+    // Arbitrary mix of @Asset and @InjectAsset just to\n+    // test the annotations.\n+\n+    @Asset(\"images/tab-active-left.gif\")\n+    public abstract IAsset getActiveLeft();\n+\n+    @InjectAsset(\"inactiveLeft\")\n+    public abstract IAsset getInactiveLeft();\n+\n+    @Asset(\"images/tab-active-mid.gif\")\n+    public abstract IAsset getActiveMid();\n+\n+    @InjectAsset(\"inactiveMid\")\n+    public abstract IAsset getInactiveMid();\n+\n+    @Asset(\"images/tab-active-right.gif\")\n+    public abstract IAsset getActiveRight();\n+\n+    @InjectAsset(\"inactiveRight\")\n+    public abstract IAsset getInactiveRight();\n+\n     public IAsset getLeftTabAsset()\n     {\n-        String name = isActivePage() ? \"activeLeft\" : \"inactiveLeft\";\n-\n-        return getAsset(name);\n+        return isActivePage() ? getActiveLeft() : getInactiveLeft();\n     }\n \n     public IAsset getMidTabAsset()\n     {\n-        String name = isActivePage() ? \"activeMid\" : \"inactiveMid\";\n-\n-        return getAsset(name);\n+        return isActivePage() ? getActiveMid() : getInactiveMid();\n     }\n \n     public IAsset getRightTabAsset()\n     {\n-        String name = isActivePage() ? \"activeRight\" : \"inactiveRight\";\n-\n-        return getAsset(name);\n+        return isActivePage() ? getActiveRight() : getInactiveRight();\n     }\n \n     public void selectPage(IRequestCycle cycle, String newPageName)",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/examples/Workbench/src/java/org/apache/tapestry/workbench/components/Border.java",
                "sha": "6806324450c1383a96a9683f56ca6bc1be14948a",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tapestry4/blob/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/status.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/status.xml?ref=d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf",
                "deletions": 0,
                "filename": "status.xml",
                "patch": "@@ -55,6 +55,7 @@\n     <release version=\"4.0-beta-2\" date=\"unreleased\">\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-356\">FormConditional extends BaseComponent but has no template</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-357\">AbstractComponent: getMessages() and format() were removed, but should have been deprecated</action>\n+      <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-361\">Using @Asset annotation causes NullPointerException</action>\n     </release>\n     <release version=\"4.0-beta-1\" date=\"Jun 24 2005\">\n        <action type=\"add\" dev=\"HLS\">Add InvokeListener component.</action>",
                "raw_url": "https://github.com/apache/tapestry4/raw/d0e0eb05030c4aa8a3d58ede44a79c7deb5c5abf/status.xml",
                "sha": "05538714b2e8042f7ee7d40cf0c82bc2a3161573",
                "status": "modified"
            }
        ],
        "message": "TAPESTRY-361: Using @Asset annotation causes NullPointerException\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@244367 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/8a660425ea9b716a75b24eb83cbd3c07713aba97",
        "patched_files": [
            "AssetAnnotationWorker.java",
            "hivemodule.java",
            "Border.java",
            "status.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestAssetAnnotationWorker.java"
        ]
    },
    "tapestry4_e673815": {
        "bug_id": "tapestry4_e673815",
        "commit": "https://github.com/apache/tapestry4/commit/e673815d0ab3702b4a710d45b8af52868b2f6e09",
        "file": [
            {
                "additions": 13,
                "blob_url": "https://github.com/apache/tapestry4/blob/e673815d0ab3702b4a710d45b8af52868b2f6e09/tapestry-framework/src/java/org/apache/tapestry/engine/encoders/AssetEncoder.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/tapestry-framework/src/java/org/apache/tapestry/engine/encoders/AssetEncoder.java?ref=e673815d0ab3702b4a710d45b8af52868b2f6e09",
                "deletions": 5,
                "filename": "tapestry-framework/src/java/org/apache/tapestry/engine/encoders/AssetEncoder.java",
                "patch": "@@ -67,16 +67,24 @@ public void decode(ServiceEncoding encoding)\n     {\n         if (!encoding.getServletPath().equals(_path))\n             return;\n-        \n+        encoding.setParameterValue(ServiceConstants.SERVICE, Tapestry.ASSET_SERVICE);\n         String pathInfo = encoding.getPathInfo();\n+        if (pathInfo == null)\n+            pathInfo = \"/\";\n         \n         // The lead character is a slash, so find the next slash (the divider between the\n         // digest and the path).\n         int slashx = pathInfo.indexOf('/', 1);\n-        \n-        encoding.setParameterValue(ServiceConstants.SERVICE, Tapestry.ASSET_SERVICE);\n-        encoding.setParameterValue(AssetService.DIGEST, pathInfo.substring(1, slashx));\n-        encoding.setParameterValue(AssetService.PATH, pathInfo.substring(slashx));\n+        if (slashx < 0) \n+        {\n+            encoding.setParameterValue(AssetService.DIGEST, \"\");\n+            encoding.setParameterValue(AssetService.PATH, \"\");\n+        }\n+        else\n+        {\n+            encoding.setParameterValue(AssetService.DIGEST, pathInfo.substring(1, slashx));\n+            encoding.setParameterValue(AssetService.PATH, pathInfo.substring(slashx));\n+        }\n     }\n     \n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/e673815d0ab3702b4a710d45b8af52868b2f6e09/tapestry-framework/src/java/org/apache/tapestry/engine/encoders/AssetEncoder.java",
                "sha": "87cc4df7bc8ca991bb43b27ddc62ee27b9eb03ec",
                "status": "modified"
            },
            {
                "additions": 42,
                "blob_url": "https://github.com/apache/tapestry4/blob/e673815d0ab3702b4a710d45b8af52868b2f6e09/tapestry-framework/src/test/org/apache/tapestry/engine/encoders/AssetEncoderTest.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/tapestry-framework/src/test/org/apache/tapestry/engine/encoders/AssetEncoderTest.java?ref=e673815d0ab3702b4a710d45b8af52868b2f6e09",
                "deletions": 0,
                "filename": "tapestry-framework/src/test/org/apache/tapestry/engine/encoders/AssetEncoderTest.java",
                "patch": "@@ -189,4 +189,46 @@ public void test_Decode_Unprotected()\n \n         verify();\n     }\n+\n+    public void test_Decode_Null_Pathinfo()\n+    {\n+        ServiceEncoding encoding = newEncoding();\n+\n+        trainGetServletPath(encoding, \"/assets\");\n+        trainGetPathInfo(encoding, null);\n+\n+        encoding.setParameterValue(ServiceConstants.SERVICE, Tapestry.ASSET_SERVICE);\n+        encoding.setParameterValue(AssetService.DIGEST, \"\");\n+        encoding.setParameterValue(AssetService.PATH, \"\");\n+\n+        replay();\n+\n+        AssetEncoder encoder = new AssetEncoder();\n+        encoder.setPath(\"/assets\");\n+\n+        encoder.decode(encoding);\n+\n+        verify();\n+    }\n+    \n+    public void test_Decode_Empty_Pathinfo()\n+    {\n+        ServiceEncoding encoding = newEncoding();\n+\n+        trainGetServletPath(encoding, \"/assets\");\n+        trainGetPathInfo(encoding, \"/\");\n+\n+        encoding.setParameterValue(ServiceConstants.SERVICE, Tapestry.ASSET_SERVICE);\n+        encoding.setParameterValue(AssetService.DIGEST, \"\");\n+        encoding.setParameterValue(AssetService.PATH, \"\");         \n+\n+        replay();\n+\n+        AssetEncoder encoder = new AssetEncoder();\n+        encoder.setPath(\"/assets\");\n+\n+        encoder.decode(encoding);\n+\n+        verify();\n+    }\n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/e673815d0ab3702b4a710d45b8af52868b2f6e09/tapestry-framework/src/test/org/apache/tapestry/engine/encoders/AssetEncoderTest.java",
                "sha": "3574387a170734e60b5cc6d5364727ab5f8c4af2",
                "status": "modified"
            }
        ],
        "message": "TAPESTRY-1915: handle NPE and StringIndexOOBE in assetencoder\n\ngit-svn-id: https://svn.apache.org/repos/asf/tapestry/tapestry4/trunk@642446 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/4bb7c2aeb907a93d8c59b80fea3d4a58467ccd79",
        "patched_files": [
            "AssetEncoder.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "AssetEncoderTest.java"
        ]
    },
    "tapestry4_fa15f2e": {
        "bug_id": "tapestry4_fa15f2e",
        "commit": "https://github.com/apache/tapestry4/commit/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
        "file": [
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.java",
                "changes": 130,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 113,
                "filename": "contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.java",
                "patch": "@@ -42,12 +42,6 @@\n {\n     private static final Log LOG = LogFactory.getLog(TreeNodeView.class);\n \n-    private IBinding m_objNodeRenderFactoryBinding;\n-\n-    private IBinding m_objShowNodeImagesBinding;\n-\n-    private IBinding m_objMakeNodeDirectBinding;\n-\n     private Boolean m_objNodeState;\n \n     private Boolean m_objShowNodeImages;\n@@ -62,6 +56,10 @@\n \n     private int m_CurrentForeachConnectImageValue = TreeRowObject.LINE_CONN_IMG;\n \n+    public abstract INodeRenderFactory getNodeRenderFactoryParameter();\n+\n+    public abstract Boolean getShowNodeImages();\n+\n     public TreeNodeView()\n     {\n         super();\n@@ -122,7 +120,7 @@ public void nodeExpandCollaps(IRequestCycle cycle)\n         ComponentAddress objModelSourceAddress = (ComponentAddress) context[2];\n         ITreeModelSource objTreeModelSource = (ITreeModelSource) objModelSourceAddress\n                 .findComponent(cycle);\n-        //ITreeModelSource objTreeModelSource = getTreeModelSource();\n+        // ITreeModelSource objTreeModelSource = getTreeModelSource();\n         ITreeStateModel objStateModel = objTreeModelSource.getTreeModel().getTreeStateModel();\n         boolean bState = objStateModel.isUniqueKeyExpanded(objValueUID);\n \n@@ -156,14 +154,14 @@ public void nodeSelect(IRequestCycle cycle)\n         ComponentAddress objModelSourceAddress = (ComponentAddress) context[2];\n         ITreeModelSource objTreeModelSource = (ITreeModelSource) objModelSourceAddress\n                 .findComponent(cycle);\n-        //ITreeModelSource objTreeModelSource = getTreeModelSource();\n+        // ITreeModelSource objTreeModelSource = getTreeModelSource();\n         ITreeStateModel objStateModel = objTreeModelSource.getTreeModel().getTreeStateModel();\n         Object objSelectedNodeInState = objStateModel.getSelectedNode();\n \n         if (objValueUID.equals(objSelectedNodeInState))\n         {\n-            //do nothing, the selected node in UI is the same as the selected in\n-            //state model. The user should use refresh of back button.\n+            // do nothing, the selected node in UI is the same as the selected in\n+            // state model. The user should use refresh of back button.\n             return;\n         }\n \n@@ -419,27 +417,6 @@ protected void renderComponent(IMarkupWriter arg0, IRequestCycle arg1)\n         m_objNodeState = null;\n     }\n \n-    /**\n-     * Returns the ShowNodeImagesBinding.\n-     * \n-     * @return IBinding\n-     */\n-    public IBinding getShowNodeImagesBinding()\n-    {\n-        return m_objShowNodeImagesBinding;\n-    }\n-\n-    /**\n-     * Sets the ShowNodeImagesBinding.\n-     * \n-     * @param ShowNodeImagesBinding\n-     *            The ShowNodeImagesBinding to set\n-     */\n-    public void setShowNodeImagesBinding(IBinding ShowNodeImagesBinding)\n-    {\n-        m_objShowNodeImagesBinding = ShowNodeImagesBinding;\n-    }\n-\n     /**\n      * Returns the ShowNodeImages.\n      * \n@@ -449,21 +426,15 @@ public Boolean isShowNodeImages()\n     {\n         if (m_objShowNodeImages == null)\n         {\n-            if (getNodeRenderFactoryBinding() == null)\n+            if (isParameterBound(\"nodeRenderFactory\"))\n             {\n-                m_objShowNodeImages = Boolean.TRUE;\n+                m_objShowNodeImages = getShowNodeImages();\n             }\n             else\n             {\n-                if (m_objShowNodeImagesBinding != null)\n-                {\n-                    m_objShowNodeImages = (Boolean) m_objShowNodeImagesBinding.getObject();\n-                }\n-                else\n-                {\n-                    m_objShowNodeImages = Boolean.TRUE;\n-                }\n+                m_objShowNodeImages = Boolean.TRUE;\n             }\n+\n         }\n         return m_objShowNodeImages;\n     }\n@@ -482,7 +453,7 @@ public boolean getShowWithoutImages()\n \n     public String getOffsetStyle()\n     {\n-        //return \"width: \" + getTreeDataView().getTreeDeep() * 15;\n+        // return \"width: \" + getTreeDataView().getTreeDeep() * 15;\n         ITreeRowSource objTreeRowSource = getTreeRowSource();\n         TreeRowObject objTreeRowObject = objTreeRowSource.getTreeRow();\n         int nTreeRowDepth = 0;\n@@ -495,86 +466,19 @@ public String getOffsetStyle()\n         return \"padding-left: \" + nTreeRowDepth * 19 + \"px\";\n     }\n \n-    /**\n-     * Returns the nodeRenderFactoryBinding.\n-     * \n-     * @return IBinding\n-     */\n-    public IBinding getNodeRenderFactoryBinding()\n-    {\n-        return m_objNodeRenderFactoryBinding;\n-    }\n-\n-    /**\n-     * Sets the nodeRenderFactoryBinding.\n-     * \n-     * @param nodeRenderFactoryBinding\n-     *            The nodeRenderFactoryBinding to set\n-     */\n-    public void setNodeRenderFactoryBinding(IBinding nodeRenderFactoryBinding)\n-    {\n-        m_objNodeRenderFactoryBinding = nodeRenderFactoryBinding;\n-    }\n-\n     public INodeRenderFactory getNodeRenderFactory()\n     {\n         if (m_objNodeRenderFactory == null)\n         {\n-            IBinding objBinding = getNodeRenderFactoryBinding();\n-            if (objBinding != null)\n-            {\n-                m_objNodeRenderFactory = (INodeRenderFactory) objBinding.getObject();\n-            }\n+            if (isParameterBound(\"nodeRenderFactory\"))\n+                m_objNodeRenderFactory = getNodeRenderFactoryParameter();\n             else\n-            {\n                 m_objNodeRenderFactory = new SimpleNodeRenderFactory();\n-            }\n         }\n         return m_objNodeRenderFactory;\n     }\n \n-    /**\n-     * Returns the makeNodeDirectBinding.\n-     * \n-     * @return IBinding\n-     */\n-    public IBinding getMakeNodeDirectBinding()\n-    {\n-        return m_objMakeNodeDirectBinding;\n-    }\n-\n-    /**\n-     * Sets the makeNodeDirectBinding.\n-     * \n-     * @param makeNodeDirectBinding\n-     *            The makeNodeDirectBinding to set\n-     */\n-    public void setMakeNodeDirectBinding(IBinding makeNodeDirectBinding)\n-    {\n-        m_objMakeNodeDirectBinding = makeNodeDirectBinding;\n-    }\n-\n-    /**\n-     * Returns the makeNodeDirect.\n-     * \n-     * @return Boolean\n-     */\n-    public boolean getMakeNodeDirect()\n-    {\n-        if (m_objMakeNodeDirect == null)\n-        {\n-            IBinding objBinding = getMakeNodeDirectBinding();\n-            if (objBinding != null)\n-            {\n-                m_objMakeNodeDirect = (Boolean) objBinding.getObject();\n-            }\n-            else\n-            {\n-                m_objMakeNodeDirect = Boolean.TRUE;\n-            }\n-        }\n-        return m_objMakeNodeDirect.booleanValue();\n-    }\n+    public abstract boolean getMakeNodeDirect();\n \n     public boolean getMakeNodeNoDirect()\n     {\n@@ -603,7 +507,7 @@ public String getSelectedID()\n \n     private String getSelectedNodeID()\n     {\n-        //return getTreeDataView().getTreeView().getSelectedNodeID();\n+        // return getTreeDataView().getTreeView().getSelectedNodeID();\n         return \"tree\";\n     }\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.java",
                "sha": "9cc89623bd499e80cc912b874a484535afeadcda",
                "status": "modified"
            },
            {
                "additions": 40,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.jwc",
                "changes": 83,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.jwc?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 43,
                "filename": "contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.jwc",
                "patch": "@@ -16,98 +16,95 @@\n -->\n \n <!DOCTYPE component-specification PUBLIC \n-  \"-//Apache Software Foundation//Tapestry Specification 3.0//EN\" \n-  \"http://jakarta.apache.org/tapestry/dtd/Tapestry_3_0.dtd\">\n+  \"-//Apache Software Foundation//Tapestry Specification 4.0//EN\" \n+  \"http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd\">\n \n <component-specification\n     class=\"org.apache.tapestry.contrib.tree.components.TreeNodeView\"\n     allow-body=\"yes\" allow-informal-parameters=\"yes\">\n \n-    <parameter name=\"showNodeImages\" type=\"boolean\" required=\"no\"\n-               direction=\"custom\"/>\n-    <parameter name=\"makeNodeDirect\" type=\"boolean\" required=\"no\"\n-               direction=\"custom\"/>\n+    <parameter name=\"showNodeImages\" default-value=\"true\"/>\n+    <parameter name=\"makeNodeDirect\" default-value=\"true\"/>\n \n     <parameter name=\"nodeRenderFactory\"\n-               type=\"org.apache.tapestry.contrib.tree.components.INodeRenderFactory\"\n-               required=\"no\" direction=\"custom\"/>\n+                required=\"no\"  property=\"nodeRenderFactoryParameter\"/>\n \n     <reserved-parameter name=\"treedataview\"/>\n     <reserved-parameter name=\"nodeviewdirect\"/>\n \n     <component id=\"expandCollapsDirect\" type=\"DirectLink\">\n-        <binding name=\"parameters\" expression=\"nodeContext\"/>\n-        <binding name=\"listener\" expression=\"listeners.nodeExpandCollaps\"/>\n-        <binding name=\"stateful\" expression=\"false\"/>\n-        <binding name=\"name\" expression=\"selectedID\"/>\n-        <binding name=\"anchor\" expression=\"cleanSelectedID\"/>\n-        <binding name=\"disabled\" expression=\"disableLink\"/>\n+        <binding name=\"parameters\" value=\"nodeContext\"/>\n+        <binding name=\"listener\" value=\"listeners.nodeExpandCollaps\"/>\n+        <binding name=\"stateful\" value=\"false\"/>\n+        <binding name=\"name\" value=\"selectedID\"/>\n+        <binding name=\"anchor\" value=\"cleanSelectedID\"/>\n+        <binding name=\"disabled\" value=\"disableLink\"/>\n     </component>\n \n     <component id=\"nodeDirect\" type=\"DirectLink\">\n-        <binding name=\"parameters\" expression=\"nodeContext\"/>\n-        <binding name=\"listener\" expression=\"listeners.nodeSelect\"/>\n-        <binding name=\"stateful\" expression=\"false\"/>\n-        <binding name=\"name\" expression=\"selectedID\"/>\n-        <binding name=\"anchor\" expression=\"cleanSelectedID\"/>\n+        <binding name=\"parameters\" value=\"nodeContext\"/>\n+        <binding name=\"listener\" value=\"listeners.nodeSelect\"/>\n+        <binding name=\"stateful\" value=\"false\"/>\n+        <binding name=\"name\" value=\"selectedID\"/>\n+        <binding name=\"anchor\" value=\"cleanSelectedID\"/>\n     </component>\n     \n     <component id=\"showImages\" type=\"If\">\n-        <binding name=\"condition\" expression=\"showImages\"/>\n+        <binding name=\"condition\" value=\"showImages\"/>\n     </component>\n \n     <component id=\"showImages2\" copy-of=\"showImages\"/>\n \n     <component id=\"makeNodeDirect\" type=\"If\">\n-        <binding name=\"condition\" expression=\"makeNodeDirect\"/>\n+        <binding name=\"condition\" value=\"makeNodeDirect\"/>\n     </component>\n \n     <component id=\"makeNodeNoDirect\" type=\"If\">\n-        <binding name=\"condition\" expression=\"makeNodeNoDirect\"/>\n+        <binding name=\"condition\" value=\"makeNodeNoDirect\"/>\n     </component>\n \n     <component id=\"imageNode\" type=\"Image\">\n-        <binding name=\"image\" expression=\"nodeImage\"/>\n+        <binding name=\"image\" value=\"nodeImage\"/>\n     </component>\n     <component id=\"imageNode2\" copy-of=\"imageNode\"/>\n \n     <component id=\"insertValue\" type=\"Delegator\">\n-\t\t<binding name=\"delegate\" expression=\"currentRenderer\"/>\n+\t\t<binding name=\"delegate\" value=\"currentRenderer\"/>\n     </component>\n     <component id=\"insertValue2\" copy-of=\"insertValue\"/>\n \n     <component id=\"class\" type=\"Any\">\n-        <static-binding name=\"element\">div</static-binding>\n-        <binding name=\"class\" expression=\"nodeStyleClass\"/>\n+        <binding name=\"element\" value=\"literal:div\"/>\n+        <binding name=\"class\" value=\"nodeStyleClass\"/>\n     </component>\n     \n-    <private-asset name=\"_topCloseNodeImage\" resource-path=\"TopPlus.gif\"/>\n-    <private-asset name=\"_topOpenNodeImage\" resource-path=\"TopMinus.gif\"/>\n-    <private-asset name=\"_topLineImage\" resource-path=\"TopLine.gif\"/>\n+    <asset name=\"_topCloseNodeImage\" path=\"TopPlus.gif\"/>\n+    <asset name=\"_topOpenNodeImage\" path=\"TopMinus.gif\"/>\n+    <asset name=\"_topLineImage\" path=\"TopLine.gif\"/>\n     \n-    <private-asset name=\"_topLastOpenNodeImage\" resource-path=\"TopLastMinus.gif\"/>\n-    <private-asset name=\"_topLastCloseNodeImage\" resource-path=\"TopLastPlus.gif\"/>\n+    <asset name=\"_topLastOpenNodeImage\" path=\"TopLastMinus.gif\"/>\n+    <asset name=\"_topLastCloseNodeImage\" path=\"TopLastPlus.gif\"/>\n     \n-    <private-asset name=\"_middleCloseNodeImage\" resource-path=\"MiddlePlus.gif\"/>\n-    <private-asset name=\"_middleOpenNodeImage\" resource-path=\"MiddleMinus.gif\"/>\n-    <private-asset name=\"_middleCrossLineImage\" resource-path=\"MiddleCrossLine.gif\"/>\n-    <private-asset name=\"_middleLineImage\" resource-path=\"MiddleLine.gif\"/>\n+    <asset name=\"_middleCloseNodeImage\" path=\"MiddlePlus.gif\"/>\n+    <asset name=\"_middleOpenNodeImage\" path=\"MiddleMinus.gif\"/>\n+    <asset name=\"_middleCrossLineImage\" path=\"MiddleCrossLine.gif\"/>\n+    <asset name=\"_middleLineImage\" path=\"MiddleLine.gif\"/>\n     \n-    <private-asset name=\"_bottomCloseNodeImage\" resource-path=\"BottomPlus.gif\"/>\n-    <private-asset name=\"_bottomOpenNodeImage\" resource-path=\"BottomMinus.gif\"/>\n-    <private-asset name=\"_bottomLineImage\" resource-path=\"BottomLine.gif\"/>\n+    <asset name=\"_bottomCloseNodeImage\" path=\"BottomPlus.gif\"/>\n+    <asset name=\"_bottomOpenNodeImage\" path=\"BottomMinus.gif\"/>\n+    <asset name=\"_bottomLineImage\" path=\"BottomLine.gif\"/>\n     \n-    <private-asset name=\"_whiteSpaceImage\" resource-path=\"WhiteSpace.gif\"/>\n+    <asset name=\"_whiteSpaceImage\" path=\"WhiteSpace.gif\"/>\n     \n     <component id=\"showConnectImage\" type=\"If\">\n-        <binding name=\"condition\" expression=\"showConnectImage\"/>\n+        <binding name=\"condition\" value=\"showConnectImage\"/>\n     </component>\n     <component id=\"connectImage\" type=\"Image\">\n-        <binding name=\"image\" expression=\"connectImage\"/>\n+        <binding name=\"image\" value=\"connectImage\"/>\n     </component>\n     <component id=\"foreachConnectImage\" type=\"Foreach\">\n-        <binding name=\"source\" expression=\"foreachConnectImageList\"/>\n-        <binding name=\"value\" expression=\"currentForeachConnectImageValue\"/>\n+        <binding name=\"source\" value=\"foreachConnectImageList\"/>\n+        <binding name=\"value\" value=\"currentForeachConnectImageValue\"/>\n     </component>\n     \n     ",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/TreeNodeView.jwc",
                "sha": "ecbaadb16bd16a967b3030fb3e76218a03d79fc7",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 6,
                "filename": "contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.java",
                "patch": "@@ -56,7 +56,7 @@ public TreeTableDataView()\n     public void initialize()\n     {\n         m_nTreeDeep = -1;\n-        //\t\tm_objTableModel = null;\n+        // m_objTableModel = null;\n         m_objTreeRowObject = null;\n         m_arrAllExpandedNodes = null;\n     }\n@@ -79,7 +79,7 @@ public ITreeModelSource getTreeModelSource()\n         return objSource == null ? getTreeViewParameter() : objSource;\n     }\n \n-    public ArrayList generateNodeList()\n+    public List generateNodeList()\n     {\n         if (m_arrAllExpandedNodes == null)\n         {\n@@ -211,7 +211,7 @@ public ITableModel getTableModel()\n \n     private ITableModel createTableModel()\n     {\n-        ArrayList arrAllNodes = generateNodeList();\n+        List arrAllNodes = generateNodeList();\n         Object[] arrAllExpandedNodes = new Object[arrAllNodes.size()];\n         arrAllNodes.toArray(arrAllExpandedNodes);\n \n@@ -256,20 +256,20 @@ public ITableSessionStateManager getTableSessionStateManager()\n         SimpleTableSessionStateManager objStateManager = new SimpleTableSessionStateManager(\n                 objDataModel, objColumnModel);\n         return objStateManager;\n-        //return NullTableSessionStateManager.NULL_STATE_MANAGER;\n+        // return NullTableSessionStateManager.NULL_STATE_MANAGER;\n     }\n \n     /**\n      * @see org.apache.tapestry.BaseComponent#renderComponent(org.apache.tapestry.IMarkupWriter,\n      *      org.apache.tapestry.IRequestCycle)\n      */\n-    protected void renderComponent(IMarkupWriter arg0, IRequestCycle cycle)\n+    protected void renderComponent(IMarkupWriter writer, IRequestCycle cycle)\n     {\n         Object objExistedTreeModelSource = cycle\n                 .getAttribute(ITreeRowSource.TREE_ROW_SOURCE_ATTRIBUTE);\n         cycle.setAttribute(ITreeRowSource.TREE_ROW_SOURCE_ATTRIBUTE, this);\n \n-        super.renderComponent(arg0, cycle);\n+        super.renderComponent(writer, cycle);\n \n         cycle.setAttribute(ITreeRowSource.TREE_ROW_SOURCE_ATTRIBUTE, objExistedTreeModelSource);\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.java",
                "sha": "a525716101723587d1ead7d470930efd43767f90",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.jwc",
                "changes": 63,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.jwc?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 42,
                "filename": "contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.jwc",
                "patch": "@@ -16,46 +16,25 @@\n -->\n \n <!DOCTYPE component-specification PUBLIC \n-  \"-//Apache Software Foundation//Tapestry Specification 3.0//EN\" \n-  \"http://jakarta.apache.org/tapestry/dtd/Tapestry_3_0.dtd\">\n-\n-<component-specification class=\"org.apache.tapestry.contrib.tree.components.table.TreeTableDataView\"\n-    allow-body=\"yes\" allow-informal-parameters=\"yes\">\n-\n-    <parameter name=\"treeView\"\n-               type=\"org.apache.tapestry.contrib.tree.components.TreeView\"\n-               required=\"no\" direction=\"custom\"/>\n-\n-    <parameter name=\"nodeViewComponentAddress\"\n-               type=\"org.apache.tapestry.util.ComponentAddress\"\n-               required=\"no\" direction=\"custom\"/>\n-\n-    <parameter name=\"nodeRenderFactory\"\n-               type=\"org.apache.tapestry.contrib.tree.components.INodeRenderFactory\"\n-               required=\"no\" direction=\"custom\"/>\n-    \n-\t<parameter name=\"entriesPerTablePage\" \n-\t\ttype=\"int\" \n-\t\trequired=\"no\"\n-\t\tdirection=\"custom\"/>\n-    <parameter name=\"showRootNode\" type=\"boolean\" required=\"no\"\n-               direction=\"custom\"/>\n-\n-    <parameter name=\"tableColunms\"\n-               type=\"java.util.ArrayList\"\n-               required=\"no\" direction=\"custom\"/>\n-\n-    <bean name=\"tableClass\" class=\"org.apache.tapestry.bean.EvenOdd\" lifecycle=\"request\"/>\n-\n-\t<component id=\"table\" type=\"Table\">\n-\t\t<binding name=\"tableModel\" expression=\"tableModel\"/>\n-\t\t<binding name=\"tableSessionStateManager\" expression=\"tableSessionStateManager\"/>\n-\t\t<binding name=\"row\" expression=\"treeRowObject\"/>\n-        <binding name=\"rowsClass\" expression='beans.tableClass.next'/>\n-        <static-binding name=\"class\">treetable</static-binding>\n-        <static-binding name=\"cellspacing\">0</static-binding>\n-        <static-binding name=\"cellpadding\">0</static-binding>\n-        <static-binding name=\"width\">*</static-binding>\n-\t</component>\n-\n+  \"-//Apache Software Foundation//Tapestry Specification 4.0//EN\" \n+  \"http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd\">\n+<component-specification class=\"org.apache.tapestry.contrib.tree.components.table.TreeTableDataView\" allow-body=\"yes\"\n+           allow-informal-parameters=\"yes\">\n+           <parameter name=\"treeView\" required=\"no\"/>\n+           <parameter name=\"nodeViewComponentAddress\" required=\"no\"/>\n+           <parameter name=\"nodeRenderFactory\" required=\"no\"/>\n+           <parameter name=\"entriesPerTablePage\" required=\"no\"/>\n+           <parameter name=\"showRootNode\" required=\"no\"/>\n+           <parameter name=\"tableColunms\" property=\"tableColumnsParameter\" required=\"no\"/>\n+           <bean name=\"tableClass\" class=\"org.apache.tapestry.bean.EvenOdd\" lifecycle=\"request\"/>\n+           <component id=\"table\" type=\"Table\">\n+                      <binding name=\"tableModel\" value=\"tableModel\"/>\n+                      <binding name=\"tableSessionStateManager\" value=\"tableSessionStateManager\"/>\n+                      <binding name=\"row\" value=\"treeRowObject\"/>\n+                      <binding name=\"rowsClass\" value=\"beans.tableClass.next\"/>\n+                      <binding name=\"class\" value=\"literal:treetable\"/>\n+                      <binding name=\"cellspacing\" value=\"literal:0\"/>\n+                      <binding name=\"cellpadding\" value=\"literal:0\"/>\n+                      <binding name=\"width\" value=\"literal:*\"/>\n+           </component>\n </component-specification>",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/contrib/src/java/org/apache/tapestry/contrib/tree/components/table/TreeTableDataView.jwc",
                "sha": "d49d8aed005cfc073aa50e9009803d1e5b59347a",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTree.java",
                "changes": 32,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTree.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 15,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTree.java",
                "patch": "@@ -18,6 +18,7 @@\n import java.util.Collection;\n import java.util.Date;\n \n+import org.apache.tapestry.annotations.InjectObject;\n import org.apache.tapestry.contrib.tree.components.INodeRenderFactory;\n import org.apache.tapestry.contrib.tree.components.TreeView;\n import org.apache.tapestry.contrib.tree.model.ITreeDataModel;\n@@ -28,6 +29,9 @@\n import org.apache.tapestry.contrib.tree.model.ITreeStateModel;\n import org.apache.tapestry.contrib.tree.model.TreeStateEvent;\n import org.apache.tapestry.contrib.tree.simple.SimpleTreeModel;\n+import org.apache.tapestry.engine.IEngineService;\n+import org.apache.tapestry.event.PageDetachListener;\n+import org.apache.tapestry.event.PageEvent;\n import org.apache.tapestry.html.BasePage;\n import org.apache.tapestry.workbench.tree.examples.fsmodel.FileSystem;\n import org.apache.tapestry.workbench.tree.examples.fsmodel.FileSystemDataModel;\n@@ -36,7 +40,7 @@\n import org.apache.tapestry.workbench.tree.examples.fsmodel.NodeRenderFactory;\n \n public abstract class FileSystemTree extends BasePage implements ISelectedFolderSource,\n-        ITreeStateListener\n+        ITreeStateListener, PageDetachListener\n {\n     private ITreeSessionStateManager m_objTreeSessionStateManager = null;\n \n@@ -46,21 +50,18 @@\n \n     private Object m_objValue;\n \n+    @InjectObject(\"engine-service:asset\")\n+    public abstract IEngineService getAssetService();\n+\n     /**\n      * Injected\n      * \n      * @since 4.0\n      */\n     public abstract String getTreeRootDir();\n \n-    public FileSystemTree()\n+    public void pageDetached(PageEvent event)\n     {\n-        super();\n-    }\n-\n-    protected void initialize()\n-    {\n-        super.initialize();\n         m_objDataModel = null;\n         m_objValue = null;\n         m_objTreeSessionStateManager = null;\n@@ -69,18 +70,19 @@ protected void initialize()\n     public void initTableModel()\n     {\n         ITreeNode objParent;\n-        \n+\n         String strRootDir = getTreeRootDir();\n \n         System.out.println(\"strRootDir = \" + strRootDir);\n \n         if (strRootDir == null || \"\".equals(strRootDir))\n         {\n-            objParent = new FileSystem();\n+            objParent = new FileSystem(getAssetService());\n         }\n         else\n         {\n-            FolderObject objFolder = new FolderObject(null, new File(strRootDir), true);\n+            FolderObject objFolder = new FolderObject(null, new File(strRootDir), true,\n+                    getAssetService());\n             objFolder.reload();\n             objParent = objFolder;\n         }\n@@ -131,16 +133,16 @@ public INodeRenderFactory getRenderFactory()\n \n     public ITreeSessionStateManager getSessionStateManager()\n     {\n-        //IPage objPage = getRequestCycle().getPage(\"contrib:TreeNodeViewPage\");\n-        //System.out.println(\"TreeNodeViewPage NamespaceId :\n+        // IPage objPage = getRequestCycle().getPage(\"contrib:TreeNodeViewPage\");\n+        // System.out.println(\"TreeNodeViewPage NamespaceId :\n         // \"+objPage.getNamespace().getNamespaceId());\n \n         if (m_objTreeSessionStateManager == null)\n         {\n             String strRootDir = getTreeRootDir();\n-            //System.out.println(\"strRootDir = \" + strRootDir);\n+            // System.out.println(\"strRootDir = \" + strRootDir);\n \n-            m_objTreeSessionStateManager = new FileSystemStateManager(strRootDir);\n+            m_objTreeSessionStateManager = new FileSystemStateManager(strRootDir, getAssetService());\n         }\n         return m_objTreeSessionStateManager;\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTree.java",
                "sha": "95c4d0eec2fe006ead10b0baacf3c82ecc2dd9d6",
                "status": "modified"
            },
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTreeTable.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTreeTable.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 12,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTreeTable.java",
                "patch": "@@ -19,6 +19,7 @@\n import java.util.Collection;\n import java.util.Date;\n \n+import org.apache.tapestry.annotations.InjectObject;\n import org.apache.tapestry.contrib.table.model.simple.SimpleTableColumn;\n import org.apache.tapestry.contrib.tree.components.INodeRenderFactory;\n import org.apache.tapestry.contrib.tree.components.table.TreeTable;\n@@ -32,6 +33,9 @@\n import org.apache.tapestry.contrib.tree.model.TreeRowObject;\n import org.apache.tapestry.contrib.tree.model.TreeStateEvent;\n import org.apache.tapestry.contrib.tree.simple.SimpleTreeModel;\n+import org.apache.tapestry.engine.IEngineService;\n+import org.apache.tapestry.event.PageDetachListener;\n+import org.apache.tapestry.event.PageEvent;\n import org.apache.tapestry.html.BasePage;\n import org.apache.tapestry.workbench.tree.examples.fsmodel.FileSystem;\n import org.apache.tapestry.workbench.tree.examples.fsmodel.FileSystemDataModel;\n@@ -41,7 +45,7 @@\n import org.apache.tapestry.workbench.tree.examples.fsmodel.NodeRenderFactory;\n \n public abstract class FileSystemTreeTable extends BasePage implements ISelectedFolderSource,\n-        ITreeStateListener\n+        ITreeStateListener, PageDetachListener\n {\n     private ITreeSessionStateManager m_objTreeSessionStateManager = null;\n \n@@ -61,14 +65,11 @@\n \n     public abstract String getTreeRootDir();\n \n-    public FileSystemTreeTable()\n-    {\n-        super();\n-    }\n+    @InjectObject(\"engine-service:asset\")\n+    public abstract IEngineService getAssetService();\n \n-    protected void initialize()\n+    public void pageDetached(PageEvent event)\n     {\n-        super.initialize();\n         m_objDataModel = null;\n         m_objValue = null;\n         m_objTreeSessionStateManager = null;\n@@ -83,11 +84,12 @@ public void initTableModel()\n \n         if (strRootDir == null || \"\".equals(strRootDir))\n         {\n-            objParent = new FileSystem();\n+            objParent = new FileSystem(getAssetService());\n         }\n         else\n         {\n-            FolderObject objFolder = new FolderObject(null, new File(strRootDir), true);\n+            FolderObject objFolder = new FolderObject(null, new File(strRootDir), true,\n+                    getAssetService());\n             objFolder.reload();\n             objParent = objFolder;\n         }\n@@ -141,7 +143,7 @@ public ITreeSessionStateManager getSessionStateManager()\n         if (m_objTreeSessionStateManager == null)\n         {\n             String strRootDir = getTreeRootDir();\n-            m_objTreeSessionStateManager = new FileSystemStateManager(strRootDir);\n+            m_objTreeSessionStateManager = new FileSystemStateManager(strRootDir, getAssetService());\n         }\n         return m_objTreeSessionStateManager;\n     }\n@@ -158,10 +160,10 @@ public ArrayList getTableColumns()\n             {\n                 private static final long serialVersionUID = -8211004113105081255L;\n \n-\t\t\t\tpublic Object getColumnValue(Object objValue)\n+                public Object getColumnValue(Object objValue)\n                 {\n                     TreeRowObject objRowObject = (TreeRowObject) objValue;\n-                    //SFObject objSFObject = (SFObject)objRowObject.getTreeNode();\n+                    // SFObject objSFObject = (SFObject)objRowObject.getTreeNode();\n                     IFileSystemTreeNode objFileSystemTreeNode = (IFileSystemTreeNode) objRowObject\n                             .getTreeNode();\n                     return objFileSystemTreeNode.getDate();\n@@ -229,4 +231,5 @@ public String getSelectedNodeName()\n         }\n         return objSelectedNode.toString();\n     }\n+\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/FileSystemTreeTable.java",
                "sha": "2e06276973d17eafae483111f366d533a1cb5468",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/AssetsHolder.java",
                "changes": 38,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/AssetsHolder.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 16,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/AssetsHolder.java",
                "patch": "@@ -16,26 +16,35 @@\n \n import org.apache.hivemind.impl.DefaultClassResolver;\n import org.apache.hivemind.util.ClasspathResource;\n+import org.apache.hivemind.util.Defense;\n import org.apache.tapestry.asset.PrivateAsset;\n+import org.apache.tapestry.engine.IEngineService;\n \n /**\n- *\n  * @author ceco\n- *\n  */\n public class AssetsHolder\n {\n+    private final IEngineService _assetService;\n+\n+    private final String m_strOpenAssetsURL;\n+\n+    private final String m_strCloseAssetsURL;\n \n-    private String m_strOpenAssetsURL;\n-    private String m_strCloseAssetsURL;\n     private PrivateAsset m_objOpenAsset = null;\n+\n     private PrivateAsset m_objCloseAsset = null;\n+\n     /**\n      * Constructor for AssetsHolder.\n      */\n-    public AssetsHolder(String strOpenAssetsURL, String strCloseAssetsURL)\n+    public AssetsHolder(IEngineService assetService, String strOpenAssetsURL,\n+            String strCloseAssetsURL)\n     {\n-        super();\n+        Defense.notNull(assetService, \"assetService\");\n+\n+        _assetService = assetService;\n+\n         m_strOpenAssetsURL = strOpenAssetsURL;\n         m_strCloseAssetsURL = strCloseAssetsURL;\n     }\n@@ -44,23 +53,20 @@ public PrivateAsset getAssetForOpenNode()\n     {\n         if (m_objOpenAsset == null)\n         {\n-            //m_objOpenAsset = new PrivateAsset(m_strOpenAssetsURL);\n-            m_objOpenAsset =\n-                new PrivateAsset(\n-                    new ClasspathResource(new DefaultClassResolver(), m_strOpenAssetsURL),\n-                    null);\n+            // m_objOpenAsset = new PrivateAsset(m_strOpenAssetsURL);\n+            m_objOpenAsset = new PrivateAsset(new ClasspathResource(new DefaultClassResolver(),\n+                    m_strOpenAssetsURL), _assetService, null);\n         }\n         return m_objOpenAsset;\n     }\n+\n     public PrivateAsset getAssetForCloseNode()\n     {\n         if (m_objCloseAsset == null)\n         {\n-            //m_objCloseAsset = new PrivateAsset(m_strCloseAssetsURL);\n-            m_objCloseAsset =\n-                new PrivateAsset(\n-                    new ClasspathResource(new DefaultClassResolver(), m_strCloseAssetsURL),\n-                    null);\n+            // m_objCloseAsset = new PrivateAsset(m_strCloseAssetsURL);\n+            m_objCloseAsset = new PrivateAsset(new ClasspathResource(new DefaultClassResolver(),\n+                    m_strCloseAssetsURL), _assetService, null);\n         }\n         return m_objCloseAsset;\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/AssetsHolder.java",
                "sha": "4bcfed5dcd88bb08848f29f3e27b5be628fa6f4d",
                "status": "modified"
            },
            {
                "additions": 41,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/Drive.java",
                "changes": 69,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/Drive.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 28,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/Drive.java",
                "patch": "@@ -17,35 +17,48 @@\n import java.io.File;\n \n import org.apache.tapestry.contrib.tree.model.ITreeNode;\n+import org.apache.tapestry.engine.IEngineService;\n \n public class Drive extends FolderObject\n {\n-\tprivate static final long serialVersionUID = -7032714277766590386L;\n-\t\n-\tprivate String m_strType;\n-\tprivate String m_strLabel;\n-\tprivate long m_lSize;\n-\n-\tpublic Drive(ITreeNode objParent, File objFile) {\n-\t\tsuper(objParent, objFile, false);\n-\t}\n-\tpublic long getSize() {\n-\t\treturn m_lSize;\n-\t}\n-\tpublic String getType() {\n-\t\treturn m_strType;\n-\t}\n-\tpublic String getLabel() {\n-\t\treturn m_strLabel;\n-\t}\n-\n-\tpublic AssetsHolder getAssets() {\n-\t\tif (m_objAssetsHolder == null) {\n-\t\t\tm_objAssetsHolder =\n-\t\t\t\tnew AssetsHolder(\n-\t\t\t\t\t\"/org/apache/tapestry/workbench/tree/examples/fsmodel/harddrive.gif\",\n-\t\t\t\t\t\"/org/apache/tapestry/workbench/tree/examples/fsmodel/harddrive.gif\");\n-\t\t}\n-\t\treturn m_objAssetsHolder;\n-\t}\n+    private String m_strType;\n+\n+    private String m_strLabel;\n+\n+    private long m_lSize;\n+\n+    private final IEngineService _assetService;\n+\n+    public Drive(ITreeNode objParent, File objFile, IEngineService assetService)\n+    {\n+        super(objParent, objFile, false, assetService);\n+\n+        _assetService = assetService;\n+    }\n+\n+    public long getSize()\n+    {\n+        return m_lSize;\n+    }\n+\n+    public String getType()\n+    {\n+        return m_strType;\n+    }\n+\n+    public String getLabel()\n+    {\n+        return m_strLabel;\n+    }\n+\n+    public AssetsHolder getAssets()\n+    {\n+        if (m_objAssetsHolder == null)\n+        {\n+            m_objAssetsHolder = new AssetsHolder(_assetService,\n+                    \"/org/apache/tapestry/workbench/tree/examples/fsmodel/harddrive.gif\",\n+                    \"/org/apache/tapestry/workbench/tree/examples/fsmodel/harddrive.gif\");\n+        }\n+        return m_objAssetsHolder;\n+    }\n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/Drive.java",
                "sha": "e4689143cb265dbe429b45c5bfe871eb202874ff",
                "status": "modified"
            },
            {
                "additions": 26,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileObject.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileObject.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 14,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileObject.java",
                "patch": "@@ -19,69 +19,81 @@\n import java.util.Collection;\n \n import org.apache.tapestry.contrib.tree.model.ITreeNode;\n+import org.apache.tapestry.engine.IEngineService;\n \n public class FileObject extends SFObject\n {\n-    private static final long serialVersionUID = -3267574534008265259L;\n-    \n-\tprivate long m_lSize;\n+    private long m_lSize;\n \n-    public FileObject(ITreeNode objParent, File objFile) {\n+    private final IEngineService _assetService;\n+\n+    public FileObject(ITreeNode objParent, File objFile, IEngineService assetService)\n+    {\n         super(objParent, objFile);\n+        _assetService = assetService;\n         init();\n     }\n \n-    protected void init() {\n+    protected void init()\n+    {\n         super.init();\n         m_lSize = m_objFile.length();\n     }\n \n-    public long getSize() {\n+    public long getSize()\n+    {\n         return m_lSize;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#containsChild(ITreeNode)\n      */\n-    public boolean containsChild(ITreeNode node) {\n+    public boolean containsChild(ITreeNode node)\n+    {\n         return false;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getAllowsChildren()\n      */\n-    public boolean getAllowsChildren() {\n+    public boolean getAllowsChildren()\n+    {\n         return false;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildCount()\n      */\n-    public int getChildCount() {\n+    public int getChildCount()\n+    {\n         return 0;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildren()\n      */\n-    public Collection getChildren() {\n+    public Collection getChildren()\n+    {\n         return new ArrayList();\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#isLeaf()\n      */\n-    public boolean isLeaf() {\n+    public boolean isLeaf()\n+    {\n         return true;\n     }\n \n     /**\n      * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getAssets()\n      */\n-    public AssetsHolder getAssets() {\n-        if (m_objAssetsHolder == null) {\n+    public AssetsHolder getAssets()\n+    {\n+        if (m_objAssetsHolder == null)\n+        {\n             final String a = \"/org/apache/tapestry/workbench/tree/examples/fsmodel/file.gif\";\n-            m_objAssetsHolder = new AssetsHolder(a, a);\n+            m_objAssetsHolder = new AssetsHolder(_assetService, a, a);\n         }\n         return m_objAssetsHolder;\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileObject.java",
                "sha": "5151225058900ea8d4313cd10e466a9c62c1bc92",
                "status": "modified"
            },
            {
                "additions": 134,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystem.java",
                "changes": 243,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystem.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 109,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystem.java",
                "patch": "@@ -20,21 +20,25 @@\n import java.util.Vector;\n \n import org.apache.tapestry.contrib.tree.model.ITreeNode;\n+import org.apache.tapestry.engine.IEngineService;\n \n public class FileSystem implements IFileSystemTreeNode\n {\n-    private static final long serialVersionUID = -6214030851378993747L;\n-    \n-\tprivate transient AssetsHolder m_objAssetsHolder = null;\n-    /** @associates <{Drive}>\n+\n+    private transient AssetsHolder m_objAssetsHolder = null;\n+\n+    /**\n+     * @associates <{Drive}>\n      * @supplierCardinality 0..*\n      * @link aggregation\n      */\n     private Vector m_vDrives;\n \n-    public FileSystem()\n+    private final IEngineService _assetService;\n+\n+    public FileSystem(IEngineService assetService)\n     {\n-        //initDrives();\n+        _assetService = assetService;\n     }\n \n     private void initDrives()\n@@ -43,127 +47,148 @@ private void initDrives()\n         File[] arrFile = File.listRoots();\n \n         if (arrFile != null)\n-            for(int i=0; i<arrFile.length; i++)\n+            for (int i = 0; i < arrFile.length; i++)\n             {\n                 File objFile = arrFile[i];\n-                boolean bFloppy = objFile.getAbsolutePath().startsWith(\"A:\") || objFile.getAbsolutePath().startsWith(\"B:\");\n-                if(!bFloppy)\n-                        m_vDrives.addElement(new Drive(this, objFile));\n+                boolean bFloppy = objFile.getAbsolutePath().startsWith(\"A:\")\n+                        || objFile.getAbsolutePath().startsWith(\"B:\");\n+                if (!bFloppy)\n+                    m_vDrives.addElement(new Drive(this, objFile, _assetService));\n             }\n     }\n \n     public Vector getDrives()\n     {\n-    \tif(m_vDrives == null){\n-    \t\tinitDrives();\n-    \t}\n+        if (m_vDrives == null)\n+        {\n+            initDrives();\n+        }\n         return m_vDrives;\n     }\n+\n     public int getChildNumber(Object objChild)\n     {\n-        for(int i=0;i<m_vDrives.size();i++)\n+        for (int i = 0; i < m_vDrives.size(); i++)\n         {\n             Object objChildDrive = m_vDrives.elementAt(i);\n-            if(objChildDrive.equals(objChild))\n+            if (objChildDrive.equals(objChild))\n             {\n                 return i;\n             }\n         }\n         return -1;\n     }\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#containsChild(ITreeNode)\n-\t */\n-\tpublic boolean containsChild(ITreeNode node) {\n-\t\treturn true;\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getAllowsChildren()\n-\t */\n-\tpublic boolean getAllowsChildren() {\n-\t\treturn true;\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildCount()\n-\t */\n-\tpublic int getChildCount() {\n-\t\treturn getDrives().size();\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildren()\n-\t */\n-\tpublic Collection getChildren() {\n-\t\treturn getDrives();\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getParent()\n-\t */\n-\tpublic ITreeNode getParent() {\n-\t\treturn null;\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.contrib.tree.model.ITreeNode#isLeaf()\n-\t */\n-\tpublic boolean isLeaf() {\n-\t\treturn false;\n-\t}\n-\n-\t/**\n-\t * @see java.lang.Object#toString()\n-\t */\n-\tpublic String toString() {\n-\t\treturn getName();\n-\t}\n-\tpublic String getName(){\n-\t\treturn \"FileSystem\";\n-\t}\n-\t\n-\t/**\n-\t * @see java.lang.Object#equals(Object)\n-\t */\n-\tpublic boolean equals(Object arg0) {\n-\t\tif(!(arg0 instanceof FileSystem))\n-\t\t\treturn false;\n-\t\tFileSystem objFileSystem = (FileSystem)arg0;\n-\t\tif(getName().equals(objFileSystem.getName()))\n-\t\t\treturn true;\n-\t\treturn false;\n-\t}\n-\n-\t/**\n-\t * @see java.lang.Object#hashCode()\n-\t */\n-\tpublic int hashCode() {\n-\t\treturn getName().hashCode();\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getAbsolutePath()\n-\t */\n-\tpublic String getAbsolutePath() {\n-\t\treturn \"\";\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getAssets()\n-\t */\n-\tpublic AssetsHolder getAssets() {\n-\t\tif(m_objAssetsHolder == null){\n-\t\t\tm_objAssetsHolder = new AssetsHolder(\"/org/apache/tapestry/workbench/tree/examples/fsmodel/computer.gif\", \"/org/apache/tapestry/workbench/tree/examples/fsmodel/computer.gif\");\n-\t\t}\n-\t\treturn m_objAssetsHolder;\n-\t}\n-\n-\t/**\n-\t * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getObjectDate()\n-\t */\n-\tpublic Date getDate() {\n-\t\treturn null;\n-\t}\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#containsChild(ITreeNode)\n+     */\n+    public boolean containsChild(ITreeNode node)\n+    {\n+        return true;\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getAllowsChildren()\n+     */\n+    public boolean getAllowsChildren()\n+    {\n+        return true;\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildCount()\n+     */\n+    public int getChildCount()\n+    {\n+        return getDrives().size();\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildren()\n+     */\n+    public Collection getChildren()\n+    {\n+        return getDrives();\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getParent()\n+     */\n+    public ITreeNode getParent()\n+    {\n+        return null;\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.contrib.tree.model.ITreeNode#isLeaf()\n+     */\n+    public boolean isLeaf()\n+    {\n+        return false;\n+    }\n+\n+    /**\n+     * @see java.lang.Object#toString()\n+     */\n+    public String toString()\n+    {\n+        return getName();\n+    }\n+\n+    public String getName()\n+    {\n+        return \"FileSystem\";\n+    }\n+\n+    /**\n+     * @see java.lang.Object#equals(Object)\n+     */\n+    public boolean equals(Object arg0)\n+    {\n+        if (!(arg0 instanceof FileSystem))\n+            return false;\n+        FileSystem objFileSystem = (FileSystem) arg0;\n+        if (getName().equals(objFileSystem.getName()))\n+            return true;\n+        return false;\n+    }\n+\n+    /**\n+     * @see java.lang.Object#hashCode()\n+     */\n+    public int hashCode()\n+    {\n+        return getName().hashCode();\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getAbsolutePath()\n+     */\n+    public String getAbsolutePath()\n+    {\n+        return \"\";\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getAssets()\n+     */\n+    public AssetsHolder getAssets()\n+    {\n+        if (m_objAssetsHolder == null)\n+        {\n+            m_objAssetsHolder = new AssetsHolder(_assetService,\n+                    \"/org/apache/tapestry/workbench/tree/examples/fsmodel/computer.gif\",\n+                    \"/org/apache/tapestry/workbench/tree/examples/fsmodel/computer.gif\");\n+        }\n+        return m_objAssetsHolder;\n+    }\n+\n+    /**\n+     * @see org.apache.tapestry.workbench.tree.examples.fsmodel.IFileSystemTreeNode#getObjectDate()\n+     */\n+    public Date getDate()\n+    {\n+        return null;\n+    }\n \n }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystem.java",
                "sha": "02f60c71bb79daacfc335e69e517a0cecdf7a461",
                "status": "modified"
            },
            {
                "additions": 20,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystemStateManager.java",
                "changes": 30,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystemStateManager.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 10,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystemStateManager.java",
                "patch": "@@ -22,47 +22,57 @@\n import org.apache.tapestry.contrib.tree.model.ITreeSessionStateManager;\n import org.apache.tapestry.contrib.tree.model.ITreeStateModel;\n import org.apache.tapestry.contrib.tree.simple.SimpleTreeModel;\n+import org.apache.tapestry.engine.IEngineService;\n \n /**\n  * @author ceco\n  */\n-public class FileSystemStateManager implements ITreeSessionStateManager {\n+public class FileSystemStateManager implements ITreeSessionStateManager\n+{\n     private String m_strRootDir;\n \n+    private final IEngineService _assetService;\n+\n     /**\n      * Constructor for FileSystemStateManager.\n      */\n-    public FileSystemStateManager(String strRootDir) {\n+    public FileSystemStateManager(String strRootDir, IEngineService assetService)\n+    {\n         super();\n         m_strRootDir = strRootDir;\n+        _assetService = assetService;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeSessionStateManager#getSessionState(ITreeModel)\n      */\n-    public Object getSessionState(ITreeModel objModel) {\n+    public Object getSessionState(ITreeModel objModel)\n+    {\n         return objModel.getTreeStateModel();\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeSessionStateManager#getModel(Object)\n      */\n-    public ITreeModel getModel(Object objSessionState) {\n+    public ITreeModel getModel(Object objSessionState)\n+    {\n         ITreeStateModel objStateModel = (ITreeStateModel) objSessionState;\n \n         ITreeNode objParent;\n \n-        if (m_strRootDir == null || \"\".equals(m_strRootDir)) {\n-            objParent = new FileSystem();\n-        } else {\n-            FolderObject objFolder = new FolderObject(null, new File(m_strRootDir), true);\n+        if (m_strRootDir == null || \"\".equals(m_strRootDir))\n+        {\n+            objParent = new FileSystem(_assetService);\n+        }\n+        else\n+        {\n+            FolderObject objFolder = new FolderObject(null, new File(m_strRootDir), true, _assetService);\n             objFolder.reload();\n             objParent = objFolder;\n         }\n \n         ITreeDataModel objDataModel = new FileSystemDataModel(objParent);\n-        ITreeModel objModel = new SimpleTreeModel(objDataModel,\n-                                                    objStateModel);\n+        ITreeModel objModel = new SimpleTreeModel(objDataModel, objStateModel);\n \n         return objModel;\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FileSystemStateManager.java",
                "sha": "1cdc2349d064eeb13d812f41a26a3c4721c6f315",
                "status": "modified"
            },
            {
                "additions": 59,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FolderObject.java",
                "changes": 91,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FolderObject.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 32,
                "filename": "examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FolderObject.java",
                "patch": "@@ -20,12 +20,12 @@\n import java.util.Vector;\n \n import org.apache.tapestry.contrib.tree.model.ITreeNode;\n+import org.apache.tapestry.engine.IEngineService;\n \n public class FolderObject extends SFObject\n {\n-    private static final long serialVersionUID = 8237515756497487278L;\n \n-\t/**\n+    /**\n      * @associates <{File}>\n      * @supplierCardinality 0..*\n      * @link aggregation\n@@ -38,55 +38,77 @@\n      * @link aggregation\n      */\n     private Vector m_vFolders = null;\n+\n     private boolean m_bShared;\n \n-    public FolderObject(ITreeNode objParent, File objFile, boolean bInvokeInit) {\n+    private final IEngineService _assetService;\n+\n+    public FolderObject(ITreeNode objParent, File objFile, boolean bInvokeInit,\n+            IEngineService assetService)\n+    {\n         super(objParent, objFile);\n-        if(bInvokeInit)\n-        \tinit();\n+\n+        _assetService = assetService;\n+\n+        if (bInvokeInit)\n+            init();\n     }\n \n-    public void reload() {\n+    public void reload()\n+    {\n         m_vFolders = new Vector();\n         m_vFiles = new Vector();\n \n         File[] arrFiles = getFile().listFiles();\n \n-        if (arrFiles == null) {\n+        if (arrFiles == null)\n+        {\n             return;\n         }\n \n-        for (int i=0; i<arrFiles.length; i++) {\n-            if (arrFiles[i].isDirectory()) {\n-                m_vFolders.addElement(new FolderObject(this, arrFiles[i], true));\n-            } else {\n-                m_vFiles.addElement(new FileObject(this, arrFiles[i]));\n+        for (int i = 0; i < arrFiles.length; i++)\n+        {\n+            if (arrFiles[i].isDirectory())\n+            {\n+                m_vFolders.addElement(new FolderObject(this, arrFiles[i], true, _assetService));\n+            }\n+            else\n+            {\n+                m_vFiles.addElement(new FileObject(this, arrFiles[i], _assetService));\n             }\n         }\n     }\n \n-    public boolean isShared() {\n+    public boolean isShared()\n+    {\n         return m_bShared;\n     }\n \n-    public Vector getFolders() {\n-        if (m_vFolders == null) {\n+    public Vector getFolders()\n+    {\n+        if (m_vFolders == null)\n+        {\n             reload();\n         }\n         return m_vFolders;\n     }\n \n-    public Vector getFiles() {\n-        if (m_vFiles == null) {\n+    public Vector getFiles()\n+    {\n+        if (m_vFiles == null)\n+        {\n             reload();\n         }\n         return m_vFiles;\n     }\n \n-    public int getChildNumber(Object objChild) {\n-        for(int i = 0; i < m_vFolders.size(); i++) {\n+    public int getChildNumber(Object objChild)\n+    {\n+        for (int i = 0; i < m_vFolders.size(); i++)\n+        {\n             Object objChildFolder = m_vFolders.elementAt(i);\n-            if (objChildFolder.equals(objChild)) {\n+            if (objChildFolder.equals(objChild))\n+            {\n                 return i;\n             }\n         }\n@@ -96,28 +118,32 @@ public int getChildNumber(Object objChild) {\n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#containsChild(ITreeNode)\n      */\n-    public boolean containsChild(ITreeNode node) {\n+    public boolean containsChild(ITreeNode node)\n+    {\n         return true;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getAllowsChildren()\n      */\n-    public boolean getAllowsChildren() {\n+    public boolean getAllowsChildren()\n+    {\n         return true;\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildCount()\n      */\n-    public int getChildCount() {\n+    public int getChildCount()\n+    {\n         return getFolders().size() + getFiles().size();\n     }\n \n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#getChildren()\n      */\n-    public Collection getChildren() {\n+    public Collection getChildren()\n+    {\n         ArrayList arrChildrens = new ArrayList();\n         arrChildrens.addAll(getFolders());\n         arrChildrens.addAll(getFiles());\n@@ -127,19 +153,20 @@ public Collection getChildren() {\n     /**\n      * @see org.apache.tapestry.contrib.tree.model.ITreeNode#isLeaf()\n      */\n-    public boolean isLeaf() {\n+    public boolean isLeaf()\n+    {\n         return false;\n     }\n \n-    private final static String openImage =\n-        \"/org/apache/tapestry/workbench/tree/examples/fsmodel/TreeOpen.gif\";\n+    private final static String openImage = \"/org/apache/tapestry/workbench/tree/examples/fsmodel/TreeOpen.gif\";\n \n-    private final static String closedImage =\n-        \"/org/apache/tapestry/workbench/tree/examples/fsmodel/TreeClosed.gif\";\n+    private final static String closedImage = \"/org/apache/tapestry/workbench/tree/examples/fsmodel/TreeClosed.gif\";\n \n-    public AssetsHolder getAssets() {\n-        if (m_objAssetsHolder == null) {\n-            m_objAssetsHolder = new AssetsHolder(openImage, closedImage);\n+    public AssetsHolder getAssets()\n+    {\n+        if (m_objAssetsHolder == null)\n+        {\n+            m_objAssetsHolder = new AssetsHolder(_assetService, openImage, closedImage);\n         }\n         return m_objAssetsHolder;\n     }",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/examples/Workbench/src/java/org/apache/tapestry/workbench/tree/examples/fsmodel/FolderObject.java",
                "sha": "0482d0a90fb341ded5c89e5eb039310e4cda370c",
                "status": "modified"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/PageSpecificationResolverImpl.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/resolver/PageSpecificationResolverImpl.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 5,
                "filename": "framework/src/java/org/apache/tapestry/resolver/PageSpecificationResolverImpl.java",
                "patch": "@@ -15,6 +15,7 @@\n package org.apache.tapestry.resolver;\n \n import org.apache.commons.logging.Log;\n+import org.apache.hivemind.ApplicationRuntimeException;\n import org.apache.hivemind.Resource;\n import org.apache.hivemind.impl.LocationImpl;\n import org.apache.tapestry.INamespace;\n@@ -60,6 +61,8 @@\n public class PageSpecificationResolverImpl extends AbstractSpecificationResolver implements\n         PageSpecificationResolver\n {\n+    private static final String WEB_INF = \"/WEB-INF/\";\n+\n     /** set by container */\n     private Log _log;\n \n@@ -149,6 +152,12 @@ private void searchForPage(IRequestCycle cycle)\n         if (_log.isDebugEnabled())\n             _log.debug(ResolverMessages.resolvingPage(_simpleName, namespace));\n \n+        // Check with and without the leading slash\n+\n+        if (_simpleName.regionMatches(true, 0, WEB_INF, 0, WEB_INF.length())\n+                || _simpleName.regionMatches(true, 0, WEB_INF, 1, WEB_INF.length() - 1))\n+            throw new ApplicationRuntimeException(ResolverMessages.webInfNotAllowed(_simpleName));\n+\n         String expectedName = _simpleName + \".page\";\n \n         Resource namespaceLocation = namespace.getSpecificationLocation();\n@@ -157,21 +166,21 @@ private void searchForPage(IRequestCycle cycle)\n         // as the library or application specification that's\n         // supposed to contain the page.\n \n-        if (found(namespaceLocation.getRelativeResource(expectedName)))\n+        if (found(namespaceLocation, expectedName))\n             return;\n \n         if (namespace.isApplicationNamespace())\n         {\n \n             // The application namespace gets some extra searching.\n \n-            if (found(getWebInfAppLocation().getRelativeResource(expectedName)))\n+            if (found(getWebInfAppLocation(), expectedName))\n                 return;\n \n-            if (found(getWebInfLocation().getRelativeResource(expectedName)))\n+            if (found(getWebInfLocation(), expectedName))\n                 return;\n \n-            if (found(getContextRoot().getRelativeResource(expectedName)))\n+            if (found(getContextRoot(), expectedName))\n                 return;\n \n             // The wierd one ... where we see if there's a template in the application root\n@@ -247,8 +256,10 @@ private void setupImplicitPage(Resource resource, Resource namespaceLocation)\n         install();\n     }\n \n-    private boolean found(Resource resource)\n+    private boolean found(Resource baseResource, String expectedName)\n     {\n+        Resource resource = baseResource.getRelativeResource(expectedName);\n+\n         if (_log.isDebugEnabled())\n             _log.debug(ResolverMessages.checkingResource(resource));\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/PageSpecificationResolverImpl.java",
                "sha": "a9157650858cf9c6b411315a745077f6152ec9ad",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/ResolverMessages.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/resolver/ResolverMessages.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 0,
                "filename": "framework/src/java/org/apache/tapestry/resolver/ResolverMessages.java",
                "patch": "@@ -83,4 +83,9 @@ public static String componentIsDeprecated(String componentType, Location locati\n         return _formatter.format(\"component-is-deprecated\", componentType, HiveMind\n                 .getLocationString(location));\n     }\n+\n+    static String webInfNotAllowed(String simpleName)\n+    {\n+        return _formatter.format(\"web-inf-not-allowed\", simpleName);\n+    }\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/ResolverMessages.java",
                "sha": "46a7b64b4799305304833043f92c4242f987e410",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/ResolverStrings.properties",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/resolver/ResolverStrings.properties?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 1,
                "filename": "framework/src/java/org/apache/tapestry/resolver/ResolverStrings.properties",
                "patch": "@@ -21,4 +21,5 @@ installing-component=Installing component type ''{0}'' into {1} as {2}.\n installing-page=Installing page ''{0}'' into {1} as {2}.\n found-framework-page=Found page ''{0}'' in framework namespace.\n found-html-template=Found HTML template at {0}.\n-component-is-deprecated=Component ''{0}'' (at {1}) is deprecated, and will likely be removed in a later release. Consult its documentation to find a replacement component.\n\\ No newline at end of file\n+component-is-deprecated=Component ''{0}'' (at {1}) is deprecated, and will likely be removed in a later release. Consult its documentation to find a replacement component.\n+web-inf-not-allowed=Page name ''{0}'' is not valid, as it directly references a file stored in the WEB-INF folder.\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/resolver/ResolverStrings.properties",
                "sha": "f2d8f5f221bdcc867e082f361ee0f2ee3d67408a",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceInnerProxy.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/services/impl/EngineServiceInnerProxy.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 1,
                "filename": "framework/src/java/org/apache/tapestry/services/impl/EngineServiceInnerProxy.java",
                "patch": "@@ -15,6 +15,7 @@\n package org.apache.tapestry.services.impl;\n \n import java.io.IOException;\n+import java.io.Serializable;\n \n import org.apache.hivemind.util.Defense;\n import org.apache.tapestry.IRequestCycle;\n@@ -30,8 +31,10 @@\n  * @since 4.0\n  * @see org.apache.tapestry.services.impl.EngineServiceOuterProxy\n  */\n-public class EngineServiceInnerProxy implements IEngineService\n+public class EngineServiceInnerProxy implements IEngineService, Serializable\n {\n+    private static final long serialVersionUID = -8128030027597659447L;\n+\n     private final String _serviceName;\n \n     private final EngineServiceOuterProxy _outerProxy;",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceInnerProxy.java",
                "sha": "75dfd943ad9350ccebe1bff46efdb12ebb054267",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceOuterProxy.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/services/impl/EngineServiceOuterProxy.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 1,
                "filename": "framework/src/java/org/apache/tapestry/services/impl/EngineServiceOuterProxy.java",
                "patch": "@@ -15,6 +15,7 @@\n package org.apache.tapestry.services.impl;\n \n import java.io.IOException;\n+import java.io.Serializable;\n \n import org.apache.hivemind.util.Defense;\n import org.apache.tapestry.IRequestCycle;\n@@ -32,7 +33,7 @@\n  * @author Howard M. Lewis Ship\n  * @since 4.0\n  */\n-public class EngineServiceOuterProxy implements IEngineService\n+public class EngineServiceOuterProxy implements IEngineService, Serializable\n {\n     private final String _serviceName;\n ",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceOuterProxy.java",
                "sha": "dd8609609c77fa630a65f79c339677e4cff16cfc",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceSource.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/java/org/apache/tapestry/services/impl/EngineServiceSource.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 2,
                "filename": "framework/src/java/org/apache/tapestry/services/impl/EngineServiceSource.java",
                "patch": "@@ -17,11 +17,11 @@\n import org.apache.tapestry.engine.IEngineService;\n \n /**\n- * Interface exposed to XXX that allows {@link IEngineService}&nbsp;proxies to be converted to real\n- * instances.\n+ * Interface that allows {@link IEngineService} proxies to be converted to real instances.\n  * \n  * @author Howard M. Lewis Ship\n  * @since 4.0\n+ * @see org.apache.tapestry.services.impl.EngineServiceInnerProxy\n  */\n public interface EngineServiceSource\n {",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/java/org/apache/tapestry/services/impl/EngineServiceSource.java",
                "sha": "5543f62b285210d5ab40933fa66252dd3bff2033",
                "status": "modified"
            },
            {
                "additions": 79,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/AbstractSpecificationResolverTestCase.java",
                "changes": 81,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/resolver/AbstractSpecificationResolverTestCase.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 2,
                "filename": "framework/src/test/org/apache/tapestry/resolver/AbstractSpecificationResolverTestCase.java",
                "patch": "@@ -20,7 +20,9 @@\n import org.apache.hivemind.Resource;\n import org.apache.hivemind.test.HiveMindTestCase;\n import org.apache.hivemind.util.URLResource;\n+import org.apache.tapestry.INamespace;\n import org.apache.tapestry.IRequestCycle;\n+import org.apache.tapestry.engine.ISpecificationSource;\n import org.apache.tapestry.spec.IComponentSpecification;\n import org.easymock.MockControl;\n \n@@ -64,12 +66,87 @@ protected Resource newResource(String path)\n         return new URLResource(newURL(path));\n     }\n \n-    protected void train(Log log, MockControl control, String message)\n+    protected void train(Log log, String message)\n     {\n         log.isDebugEnabled();\n-        control.setReturnValue(true);\n+        setReturnValue(log, true);\n \n         log.debug(message);\n     }\n \n+    protected Log newLog()\n+    {\n+        return (Log) newMock(Log.class);\n+    }\n+\n+    protected INamespace newNamespace()\n+    {\n+        return (INamespace) newMock(INamespace.class);\n+    }\n+\n+    protected ISpecificationSource newSource()\n+    {\n+        return (ISpecificationSource) newMock(ISpecificationSource.class);\n+    }\n+\n+    protected void trainContainsPage(INamespace namespace, String pageName, boolean containsPage)\n+    {\n+        namespace.containsPage(pageName);\n+        setReturnValue(namespace, containsPage);\n+    }\n+\n+    protected void trainFindPageSpecification(ISpecificationResolverDelegate delegate, IRequestCycle cycle, INamespace application, String pageName, IComponentSpecification spec)\n+    {\n+        delegate.findPageSpecification(cycle, application, pageName);\n+        setReturnValue(delegate, spec);\n+    }\n+\n+    protected void trainGetApplicationNamespace(ISpecificationSource source, INamespace application)\n+    {\n+        source.getApplicationNamespace();\n+        setReturnValue(source, application);\n+    }\n+\n+    protected void trainGetChildNamespace(INamespace child, String name, INamespace application)\n+    {\n+        application.getChildNamespace(name);\n+        setReturnValue(application, child);\n+    }\n+\n+    protected void trainGetFrameworkNamespace(ISpecificationSource source, INamespace framework)\n+    {\n+        source.getFrameworkNamespace();\n+        setReturnValue(source, framework);\n+    }\n+\n+    protected void trainGetNamespaceId(INamespace namespace, String namespaceId)\n+    {\n+        namespace.getNamespaceId();\n+        setReturnValue(namespace, namespaceId);\n+    }\n+\n+    protected void trainGetSpecificationLocation(INamespace namespace, Resource resource)\n+    {\n+        namespace.getSpecificationLocation();\n+        setReturnValue(namespace, resource);\n+    }\n+\n+    protected void trainGetSpecificationLocation(INamespace namespace, Resource root, String path)\n+    {\n+        namespace.getSpecificationLocation();\n+        setReturnValue(namespace, root.getRelativeResource(path));\n+    }\n+\n+    protected void trainIsApplicationNamespace(INamespace namespace, boolean isApplicationNamespace)\n+    {\n+        namespace.isApplicationNamespace();\n+        setReturnValue(namespace, isApplicationNamespace);\n+    }\n+\n+    protected void trainIsDebugEnabled(Log log, boolean isDebugEnabled)\n+    {\n+        log.isDebugEnabled();\n+        setReturnValue(log, isDebugEnabled);\n+    }\n+\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/AbstractSpecificationResolverTestCase.java",
                "sha": "da57e8ba4c6eb193941b25a18674ae0cdb047b17",
                "status": "modified"
            },
            {
                "additions": 352,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/PageSpecificationResolverTest.java",
                "changes": 717,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/resolver/PageSpecificationResolverTest.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 365,
                "filename": "framework/src/test/org/apache/tapestry/resolver/PageSpecificationResolverTest.java",
                "patch": "@@ -17,6 +17,7 @@\n import java.util.List;\n \n import org.apache.commons.logging.Log;\n+import org.apache.hivemind.ApplicationRuntimeException;\n import org.apache.hivemind.Location;\n import org.apache.hivemind.Resource;\n import org.apache.tapestry.INamespace;\n@@ -28,90 +29,99 @@\n import org.apache.tapestry.spec.ComponentSpecification;\n import org.apache.tapestry.spec.IComponentSpecification;\n import org.apache.tapestry.spec.ILibrarySpecification;\n-import org.easymock.MockControl;\n \n /**\n  * Tests for {@link org.apache.tapestry.resolver.PageSpecificationResolverImpl}.\n  * \n  * @author Howard M. Lewis Ship\n  * @since 4.0\n  */\n-public class TestPageSpecificationResolver extends AbstractSpecificationResolverTestCase\n+public class PageSpecificationResolverTest extends AbstractSpecificationResolverTestCase\n {\n     private static class MockApplicationNamespace implements INamespace\n     {\n-        private Resource _specificationLocation;\n-\n         String _pageName;\n \n         IComponentSpecification _specification;\n \n+        private Resource _specificationLocation;\n+\n         MockApplicationNamespace(Resource specificationLocation)\n         {\n             _specificationLocation = specificationLocation;\n         }\n \n-        public String getId()\n+        public String constructQualifiedName(String pageName)\n         {\n             return null;\n         }\n \n-        public String getExtendedId()\n+        public boolean containsComponentType(String type)\n+        {\n+            return false;\n+        }\n+\n+        public boolean containsPage(String name)\n+        {\n+            return false;\n+        }\n+\n+        public List getChildIds()\n         {\n             return null;\n         }\n \n-        public String getNamespaceId()\n+        public INamespace getChildNamespace(String id)\n         {\n             return null;\n         }\n \n-        public INamespace getParentNamespace()\n+        public IComponentSpecification getComponentSpecification(String type)\n         {\n             return null;\n         }\n \n-        public INamespace getChildNamespace(String id)\n+        public String getExtendedId()\n         {\n             return null;\n         }\n \n-        public List getChildIds()\n+        public String getId()\n         {\n             return null;\n         }\n \n-        public IComponentSpecification getPageSpecification(String name)\n+        public Location getLocation()\n         {\n             return null;\n         }\n \n-        public boolean containsPage(String name)\n+        public String getNamespaceId()\n         {\n-            return false;\n+            return null;\n         }\n \n         public List getPageNames()\n         {\n             return null;\n         }\n \n-        public IComponentSpecification getComponentSpecification(String type)\n+        public IComponentSpecification getPageSpecification(String name)\n         {\n             return null;\n         }\n \n-        public boolean containsComponentType(String type)\n+        public INamespace getParentNamespace()\n         {\n-            return false;\n+            return null;\n         }\n \n-        public ILibrarySpecification getSpecification()\n+        public String getPropertyValue(String propertyName)\n         {\n             return null;\n         }\n \n-        public String constructQualifiedName(String pageName)\n+        public ILibrarySpecification getSpecification()\n         {\n             return null;\n         }\n@@ -121,9 +131,8 @@ public Resource getSpecificationLocation()\n             return _specificationLocation;\n         }\n \n-        public boolean isApplicationNamespace()\n+        public void installComponentSpecification(String type, IComponentSpecification specification)\n         {\n-            return true;\n         }\n \n         public void installPageSpecification(String pageName, IComponentSpecification specification)\n@@ -132,122 +141,96 @@ public void installPageSpecification(String pageName, IComponentSpecification sp\n             _specification = specification;\n         }\n \n-        public void installComponentSpecification(String type, IComponentSpecification specification)\n-        {\n-        }\n-\n-        public Location getLocation()\n+        public boolean isApplicationNamespace()\n         {\n-            return null;\n+            return true;\n         }\n \n-        public String getPropertyValue(String propertyName)\n-        {\n-            return null;\n-        }\n+    }\n \n+    private ISpecificationResolverDelegate newDelegate()\n+    {\n+        return (ISpecificationResolverDelegate) newMock(ISpecificationResolverDelegate.class);\n     }\n \n-    private ISpecificationSource newSource(INamespace application, INamespace framework)\n+    private INamespace newNamespace(String pageName, IComponentSpecification spec)\n     {\n-        MockControl control = newControl(ISpecificationSource.class);\n-        ISpecificationSource source = (ISpecificationSource) control.getMock();\n+        INamespace namespace = newNamespace();\n \n-        trainGetApplicationNamespace(control, source, application);\n+        trainContainsPage(namespace, pageName, spec != null);\n \n-        trainGetFrameworkNamespace(control, source, framework);\n+        if (spec != null)\n+            trainGetPageSpecification(namespace, pageName, spec);\n \n-        return source;\n+        return namespace;\n     }\n \n-    private void trainGetFrameworkNamespace(MockControl control, ISpecificationSource source,\n-            INamespace framework)\n+    private ComponentPropertySource newPropertySource(INamespace namespace)\n     {\n-        source.getFrameworkNamespace();\n-        control.setReturnValue(framework);\n-    }\n+        ComponentPropertySource source = (ComponentPropertySource) newMock(ComponentPropertySource.class);\n \n-    private void trainGetApplicationNamespace(MockControl control, ISpecificationSource source,\n-            INamespace application)\n-    {\n-        source.getApplicationNamespace();\n-        control.setReturnValue(application);\n+        source.getNamespaceProperty(namespace, Tapestry.TEMPLATE_EXTENSION_PROPERTY);\n+        setReturnValue(source, \"html\");\n+\n+        return source;\n     }\n \n-    private ISpecificationSource newSource(INamespace application, INamespace framework,\n-            Resource resource, IComponentSpecification pageSpec)\n+    private ISpecificationSource newSource(INamespace application, INamespace framework)\n     {\n-        MockControl control = newControl(ISpecificationSource.class);\n-        ISpecificationSource source = (ISpecificationSource) control.getMock();\n-\n-        source.getApplicationNamespace();\n-        control.setReturnValue(application);\n+        ISpecificationSource source = newSource();\n \n-        source.getFrameworkNamespace();\n-        control.setReturnValue(framework);\n+        trainGetApplicationNamespace(source, application);\n \n-        source.getPageSpecification(resource);\n-        control.setReturnValue(pageSpec);\n+        trainGetFrameworkNamespace(source, framework);\n \n         return source;\n     }\n \n-    private INamespace newNamespace()\n-    {\n-        return (INamespace) newMock(INamespace.class);\n-    }\n-\n-    private INamespace newNamespace(String pageName, IComponentSpecification spec)\n+    private ISpecificationSource newSource(INamespace application, INamespace framework,\n+            Resource resource, IComponentSpecification pageSpec)\n     {\n-        MockControl control = newControl(INamespace.class);\n-        INamespace namespace = (INamespace) control.getMock();\n+        ISpecificationSource source = newSource();\n \n-        namespace.containsPage(pageName);\n-        control.setReturnValue(spec != null);\n+        trainGetApplicationNamespace(source, application);\n \n-        if (spec != null)\n-        {\n-            namespace.getPageSpecification(pageName);\n-            control.setReturnValue(spec);\n-        }\n-\n-        return namespace;\n-    }\n-\n-    private ComponentPropertySource newPropertySource(INamespace namespace)\n-    {\n-        MockControl control = newControl(ComponentPropertySource.class);\n-        ComponentPropertySource source = (ComponentPropertySource) control.getMock();\n+        trainGetFrameworkNamespace(source, framework);\n \n-        source.getNamespaceProperty(namespace, Tapestry.TEMPLATE_EXTENSION_PROPERTY);\n-        control.setReturnValue(\"html\");\n+        trainGetPageSpecification(source, resource, pageSpec);\n \n         return source;\n     }\n \n-    public void testFoundInApplicationNamespace()\n+    public void testExplicitlyInApplicationNamespace()\n     {\n         Resource contextRoot = newResource(\"context/\");\n         IComponentSpecification spec = newSpecification();\n         INamespace application = newNamespace(\"ExistingPage\", spec);\n         INamespace framework = newNamespace();\n-        ISpecificationSource source = newSource(application, framework);\n+\n+        ISpecificationSource source = newSource();\n+\n+        trainGetApplicationNamespace(source, application);\n+        trainGetFrameworkNamespace(source, framework);\n+\n         IRequestCycle cycle = newCycle();\n \n+        trainGetApplicationNamespace(source, application);\n+\n         replayControls();\n \n         PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n         resolver.setContextRoot(contextRoot);\n         resolver.setSpecificationSource(source);\n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"ExistingPage\");\n+        resolver.resolve(cycle, \"application:ExistingPage\");\n \n         assertEquals(\"ExistingPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n+\n     }\n \n     public void testExplicitlyInFrameworkNamespace()\n@@ -257,15 +240,14 @@ public void testExplicitlyInFrameworkNamespace()\n         INamespace application = newNamespace();\n         INamespace framework = newNamespace(\"ExistingPage\", spec);\n \n-        MockControl sourcec = newControl(ISpecificationSource.class);\n-        ISpecificationSource source = (ISpecificationSource) sourcec.getMock();\n+        ISpecificationSource source = newSource();\n \n-        trainGetApplicationNamespace(sourcec, source, application);\n-        trainGetFrameworkNamespace(sourcec, source, framework);\n+        trainGetApplicationNamespace(source, application);\n+        trainGetFrameworkNamespace(source, framework);\n \n         IRequestCycle cycle = newCycle();\n \n-        trainGetFrameworkNamespace(sourcec, source, framework);\n+        trainGetFrameworkNamespace(source, framework);\n \n         replayControls();\n \n@@ -283,38 +265,107 @@ public void testExplicitlyInFrameworkNamespace()\n         verifyControls();\n     }\n \n-    public void testExplicitlyInApplicationNamespace()\n+    public void testFoundAsTemplate()\n     {\n+        Log log = newLog();\n+\n         Resource contextRoot = newResource(\"context/\");\n-        IComponentSpecification spec = newSpecification();\n-        INamespace application = newNamespace(\"ExistingPage\", spec);\n-        INamespace framework = newNamespace();\n \n-        MockControl sourcec = newControl(ISpecificationSource.class);\n-        ISpecificationSource source = (ISpecificationSource) sourcec.getMock();\n+        Resource resource = contextRoot.getRelativeResource(\"TemplatePage.html\");\n \n-        trainGetApplicationNamespace(sourcec, source, application);\n-        trainGetFrameworkNamespace(sourcec, source, framework);\n+        MockApplicationNamespace application = new MockApplicationNamespace(contextRoot\n+                .getRelativeResource(\"WEB-INF/\"));\n \n+        INamespace framework = newNamespace();\n+        ISpecificationSource source = newSource(application, framework);\n         IRequestCycle cycle = newCycle();\n \n-        trainGetApplicationNamespace(sourcec, source, application);\n+        ComponentPropertySource propertySource = newPropertySource(application);\n+\n+        train(log, ResolverMessages.resolvingPage(\"TemplatePage\", application));\n+\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/TemplatePage.page\")));\n+\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/myapp/TemplatePage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/TemplatePage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"TemplatePage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"TemplatePage.html\")));\n+\n+        train(log, ResolverMessages.foundHTMLTemplate(resource));\n+\n+        IComponentSpecification expectedSpec = new ComponentSpecification();\n+        expectedSpec.setPageSpecification(true);\n+        expectedSpec.setSpecificationLocation(resource);\n+\n+        // The toString() on ComponentSpecification means we can't predict\n+        // what the string would be.\n+\n+        trainIsDebugEnabled(log, false);\n \n         replayControls();\n \n         PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n         resolver.setContextRoot(contextRoot);\n         resolver.setSpecificationSource(source);\n+        resolver.setLog(log);\n+        resolver.setApplicationId(\"myapp\");\n+        resolver.setComponentPropertySource(propertySource);\n+\n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"application:ExistingPage\");\n+        resolver.resolve(cycle, \"TemplatePage\");\n+\n+        IComponentSpecification spec = application._specification;\n+\n+        assertEquals(true, spec.isPageSpecification());\n+\n+        // The specification location is used to find relative assets and the like, and is baesd\n+        // on the page name and the namespace location.\n+\n+        assertEquals(contextRoot.getRelativeResource(\"WEB-INF/TemplatePage.page\"), spec\n+                .getSpecificationLocation());\n+\n+        // The Location is used for any error reporting, and should be the actual file\n+        // located, the template.\n+\n+        assertEquals(resource, spec.getLocation().getResource());\n+        assertEquals(\"TemplatePage\", resolver.getSimplePageName());\n+        assertEquals(\"TemplatePage\", application._pageName);\n \n-        assertEquals(\"ExistingPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n+    }\n+\n+    public void testFoundInApplicationNamespace()\n+    {\n+        Resource contextRoot = newResource(\"context/\");\n+        IComponentSpecification spec = newSpecification();\n+        INamespace application = newNamespace(\"ExistingPage\", spec);\n+        INamespace framework = newNamespace();\n+        ISpecificationSource source = newSource(application, framework);\n+        IRequestCycle cycle = newCycle();\n+\n+        replayControls();\n+\n+        PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n+        resolver.setContextRoot(contextRoot);\n+        resolver.setSpecificationSource(source);\n+        resolver.initializeService();\n+\n+        resolver.resolve(cycle, \"ExistingPage\");\n \n+        assertEquals(\"ExistingPage\", resolver.getSimplePageName());\n+        assertSame(spec, resolver.getSpecification());\n+        assertSame(application, resolver.getNamespace());\n+\n+        verifyControls();\n     }\n \n     public void testFoundInChildNamespace()\n@@ -323,12 +374,9 @@ public void testFoundInChildNamespace()\n         IComponentSpecification spec = newSpecification();\n \n         INamespace child = newNamespace(\"ChildPage\", spec);\n+        INamespace application = newNamespace();\n \n-        MockControl control = newControl(INamespace.class);\n-        INamespace application = (INamespace) control.getMock();\n-\n-        application.getChildNamespace(\"foo.bar\");\n-        control.setReturnValue(child);\n+        trainGetChildNamespace(child, \"foo.bar\", application);\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework);\n@@ -350,96 +398,100 @@ public void testFoundInChildNamespace()\n         verifyControls();\n     }\n \n-    public void testFoundInNamespaceFolder()\n+    public void testFoundInContextRootFolder()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n \n         Resource contextRoot = newResource(\"context/\");\n         IComponentSpecification spec = newSpecification();\n \n-        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/NamespacePage.page\");\n+        Resource resource = contextRoot.getRelativeResource(\"ContextRootPage.page\");\n \n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n+        INamespace application = newNamespace();\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework, resource, spec);\n         IRequestCycle cycle = newCycle();\n \n-        trainContainsPage(applicationc, application, \"NamespacePage\", false);\n+        trainContainsPage(application, \"ContextRootPage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"NamespacePage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"ContextRootPage\", application));\n \n         // Pretend the app spec is in the WEB-INF folder\n \n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(resource));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/ContextRootPage.page\")));\n \n-        train(log, logc, ResolverMessages.installingPage(\"NamespacePage\", application, spec));\n+        trainIsApplicationNamespace(application, true);\n \n-        application.installPageSpecification(\"NamespacePage\", spec);\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/myapp/ContextRootPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/ContextRootPage.page\")));\n+        train(log, ResolverMessages.checkingResource(resource));\n+\n+        train(log, ResolverMessages.installingPage(\"ContextRootPage\", application, spec));\n+\n+        application.installPageSpecification(\"ContextRootPage\", spec);\n \n         replayControls();\n \n         PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n         resolver.setContextRoot(contextRoot);\n         resolver.setSpecificationSource(source);\n-        resolver.initializeService();\n         resolver.setLog(log);\n+        resolver.setApplicationId(\"myapp\");\n \n-        resolver.resolve(cycle, \"NamespacePage\");\n+        resolver.initializeService();\n \n-        assertEquals(\"NamespacePage\", resolver.getSimplePageName());\n+        resolver.resolve(cycle, \"ContextRootPage\");\n+\n+        assertEquals(\"ContextRootPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n     }\n \n-    private void trainGetSpecLocation(MockControl control, INamespace namespace, Resource root,\n-            String path)\n-    {\n-        namespace.getSpecificationLocation();\n-        control.setReturnValue(root.getRelativeResource(path));\n-    }\n-\n-    public void testFoundInWebInfAppFolder()\n+    public void testFoundInFramework()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n+        INamespace application = newNamespace();\n \n         Resource contextRoot = newResource(\"context/\");\n         IComponentSpecification spec = newSpecification();\n \n-        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/myapp/MyAppPage.page\");\n-\n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n+        ComponentPropertySource propertySource = newPropertySource(application);\n \n-        INamespace framework = newNamespace();\n-        ISpecificationSource source = newSource(application, framework, resource, spec);\n+        INamespace framework = newNamespace(\"FrameworkPage\", spec);\n+        ISpecificationSource source = newSource(application, framework);\n         IRequestCycle cycle = newCycle();\n \n-        trainContainsPage(applicationc, application, \"MyAppPage\", false);\n+        trainContainsPage(application, \"FrameworkPage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"MyAppPage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"FrameworkPage\", application));\n \n         // Pretend the app spec is in the WEB-INF folder\n \n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/MyAppPage.page\")));\n-\n-        trainIsApplicationNamespace(applicationc, application, true);\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/FrameworkPage.page\")));\n \n-        train(log, logc, ResolverMessages.checkingResource(resource));\n+        trainIsApplicationNamespace(application, true);\n \n-        train(log, logc, ResolverMessages.installingPage(\"MyAppPage\", application, spec));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/myapp/FrameworkPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/FrameworkPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"FrameworkPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"FrameworkPage.html\")));\n \n-        application.installPageSpecification(\"MyAppPage\", spec);\n+        train(log, ResolverMessages.foundFrameworkPage(\"FrameworkPage\"));\n \n         replayControls();\n \n@@ -448,127 +500,98 @@ public void testFoundInWebInfAppFolder()\n         resolver.setSpecificationSource(source);\n         resolver.setLog(log);\n         resolver.setApplicationId(\"myapp\");\n+        resolver.setComponentPropertySource(propertySource);\n \n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"MyAppPage\");\n+        resolver.resolve(cycle, \"FrameworkPage\");\n \n-        assertEquals(\"MyAppPage\", resolver.getSimplePageName());\n+        assertEquals(\"FrameworkPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n-        assertSame(application, resolver.getNamespace());\n+        assertSame(framework, resolver.getNamespace());\n \n         verifyControls();\n     }\n \n-    private void trainIsApplicationNamespace(MockControl control, INamespace namespace,\n-            boolean isApplicationNamespace)\n-    {\n-        namespace.isApplicationNamespace();\n-        control.setReturnValue(isApplicationNamespace);\n-    }\n-\n-    public void testFoundInWebInfFolder()\n+    public void testFoundInNamespaceFolder()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n \n         Resource contextRoot = newResource(\"context/\");\n         IComponentSpecification spec = newSpecification();\n \n-        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/MyWebInfPage.page\");\n+        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/NamespacePage.page\");\n \n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n+        INamespace application = newNamespace();\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework, resource, spec);\n         IRequestCycle cycle = newCycle();\n \n-        application.containsPage(\"MyWebInfPage\");\n-        applicationc.setReturnValue(false);\n-\n-        train(log, logc, ResolverMessages.resolvingPage(\"MyWebInfPage\", application));\n+        trainContainsPage(application, \"NamespacePage\", false);\n \n-        // Pretend the app spec is in the context root folder\n-        // Which isn't really something that happens in a real application\n-        // but is necessary to keep from finding the file too early.\n-\n-        application.getSpecificationLocation();\n-        applicationc.setReturnValue(contextRoot);\n-\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"MyWebInfPage.page\")));\n+        train(log, ResolverMessages.resolvingPage(\"NamespacePage\", application));\n \n-        application.isApplicationNamespace();\n-        applicationc.setReturnValue(true);\n+        // Pretend the app spec is in the WEB-INF folder\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/myapp/MyWebInfPage.page\")));\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(resource));\n+        train(log, ResolverMessages.checkingResource(resource));\n \n-        train(log, logc, ResolverMessages.installingPage(\"MyWebInfPage\", application, spec));\n+        train(log, ResolverMessages.installingPage(\"NamespacePage\", application, spec));\n \n-        application.installPageSpecification(\"MyWebInfPage\", spec);\n+        application.installPageSpecification(\"NamespacePage\", spec);\n \n         replayControls();\n \n         PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n         resolver.setContextRoot(contextRoot);\n         resolver.setSpecificationSource(source);\n-        resolver.setLog(log);\n-        resolver.setApplicationId(\"myapp\");\n-\n         resolver.initializeService();\n+        resolver.setLog(log);\n \n-        resolver.resolve(cycle, \"MyWebInfPage\");\n+        resolver.resolve(cycle, \"NamespacePage\");\n \n-        assertEquals(\"MyWebInfPage\", resolver.getSimplePageName());\n+        assertEquals(\"NamespacePage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n     }\n \n-    public void testFoundInContextRootFolder()\n+    public void testFoundInWebInfAppFolder()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n \n         Resource contextRoot = newResource(\"context/\");\n         IComponentSpecification spec = newSpecification();\n \n-        Resource resource = contextRoot.getRelativeResource(\"ContextRootPage.page\");\n+        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/myapp/MyAppPage.page\");\n \n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n+        INamespace application = newNamespace();\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework, resource, spec);\n         IRequestCycle cycle = newCycle();\n \n-        trainContainsPage(applicationc, application, \"ContextRootPage\", false);\n+        trainContainsPage(application, \"MyAppPage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"ContextRootPage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"MyAppPage\", application));\n \n         // Pretend the app spec is in the WEB-INF folder\n \n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/ContextRootPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/MyAppPage.page\")));\n \n-        trainIsApplicationNamespace(applicationc, application, true);\n+        trainIsApplicationNamespace(application, true);\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/myapp/ContextRootPage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/ContextRootPage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(resource));\n+        train(log, ResolverMessages.checkingResource(resource));\n \n-        train(log, logc, ResolverMessages.installingPage(\"ContextRootPage\", application, spec));\n+        train(log, ResolverMessages.installingPage(\"MyAppPage\", application, spec));\n \n-        application.installPageSpecification(\"ContextRootPage\", spec);\n+        application.installPageSpecification(\"MyAppPage\", spec);\n \n         replayControls();\n \n@@ -580,64 +603,53 @@ public void testFoundInContextRootFolder()\n \n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"ContextRootPage\");\n+        resolver.resolve(cycle, \"MyAppPage\");\n \n-        assertEquals(\"ContextRootPage\", resolver.getSimplePageName());\n+        assertEquals(\"MyAppPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n     }\n \n-    private void trainContainsPage(MockControl control, INamespace namespace, String pageName,\n-            boolean containsPage)\n-    {\n-        namespace.containsPage(pageName);\n-        control.setReturnValue(containsPage);\n-    }\n-\n-    public void testFoundAsTemplate()\n+    public void testFoundInWebInfFolder()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n \n         Resource contextRoot = newResource(\"context/\");\n+        IComponentSpecification spec = newSpecification();\n \n-        Resource resource = contextRoot.getRelativeResource(\"TemplatePage.html\");\n+        Resource resource = contextRoot.getRelativeResource(\"WEB-INF/MyWebInfPage.page\");\n \n-        MockApplicationNamespace application = new MockApplicationNamespace(contextRoot\n-                .getRelativeResource(\"WEB-INF/\"));\n+        INamespace application = newNamespace();\n \n         INamespace framework = newNamespace();\n-        ISpecificationSource source = newSource(application, framework);\n+        ISpecificationSource source = newSource(application, framework, resource, spec);\n         IRequestCycle cycle = newCycle();\n \n-        ComponentPropertySource propertySource = newPropertySource(application);\n+        trainContainsPage(application, \"MyWebInfPage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"TemplatePage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"MyWebInfPage\", application));\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/TemplatePage.page\")));\n+        // Pretend the app spec is in the context root folder\n+        // Which isn't really something that happens in a real application\n+        // but is necessary to keep from finding the file too early.\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/myapp/TemplatePage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/TemplatePage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"TemplatePage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"TemplatePage.html\")));\n+        trainGetSpecificationLocation(application, contextRoot);\n \n-        train(log, logc, ResolverMessages.foundHTMLTemplate(resource));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"MyWebInfPage.page\")));\n \n-        IComponentSpecification expectedSpec = new ComponentSpecification();\n-        expectedSpec.setPageSpecification(true);\n-        expectedSpec.setSpecificationLocation(resource);\n+        trainIsApplicationNamespace(application, true);\n \n-        // The toString() on ComponentSpecification means we can't predict\n-        // what the string would be.\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/myapp/MyWebInfPage.page\")));\n \n-        trainIsDebugEnabled(logc, log, false);\n+        train(log, ResolverMessages.checkingResource(resource));\n+\n+        train(log, ResolverMessages.installingPage(\"MyWebInfPage\", application, spec));\n+\n+        application.installPageSpecification(\"MyWebInfPage\", spec);\n \n         replayControls();\n \n@@ -646,141 +658,107 @@ public void testFoundAsTemplate()\n         resolver.setSpecificationSource(source);\n         resolver.setLog(log);\n         resolver.setApplicationId(\"myapp\");\n-        resolver.setComponentPropertySource(propertySource);\n \n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"TemplatePage\");\n-\n-        IComponentSpecification spec = application._specification;\n-\n-        assertEquals(true, spec.isPageSpecification());\n-\n-        // The specification location is used to find relative assets and the like, and is baesd\n-        // on the page name and the namespace location.\n-\n-        assertEquals(contextRoot.getRelativeResource(\"WEB-INF/TemplatePage.page\"), spec\n-                .getSpecificationLocation());\n-\n-        // The Location is used for any error reporting, and should be the actual file\n-        // located, the template.\n-\n-        assertEquals(resource, spec.getLocation().getResource());\n-        assertEquals(\"TemplatePage\", resolver.getSimplePageName());\n-        assertEquals(\"TemplatePage\", application._pageName);\n+        resolver.resolve(cycle, \"MyWebInfPage\");\n \n+        assertEquals(\"MyWebInfPage\", resolver.getSimplePageName());\n         assertSame(spec, resolver.getSpecification());\n         assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n     }\n \n-    private void trainIsDebugEnabled(MockControl control, Log log, boolean isDebugEnabled)\n-    {\n-        log.isDebugEnabled();\n-        control.setReturnValue(isDebugEnabled);\n-    }\n-\n-    public void testFoundInFramework()\n+    public void testWebInf()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n-\n-        Resource contextRoot = newResource(\"context/\");\n-        IComponentSpecification spec = newSpecification();\n-\n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n-\n-        ComponentPropertySource propertySource = newPropertySource(application);\n+        Log log = newLog();\n+        INamespace application = newNamespace();\n+        INamespace framework = newNamespace();\n \n-        INamespace framework = newNamespace(\"FrameworkPage\", spec);\n         ISpecificationSource source = newSource(application, framework);\n         IRequestCycle cycle = newCycle();\n+        Resource contextRoot = newResource(\"context/\");\n \n-        trainContainsPage(applicationc, application, \"FrameworkPage\", false);\n-\n-        train(log, logc, ResolverMessages.resolvingPage(\"FrameworkPage\", application));\n-\n-        // Pretend the app spec is in the WEB-INF folder\n-\n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainContainsPage(application, \"/WEB-Inf/BadName\", false);\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/FrameworkPage.page\")));\n-\n-        trainIsApplicationNamespace(applicationc, application, true);\n-\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/myapp/FrameworkPage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/FrameworkPage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"FrameworkPage.page\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"FrameworkPage.html\")));\n-\n-        train(log, logc, ResolverMessages.foundFrameworkPage(\"FrameworkPage\"));\n+        trainIsDebugEnabled(log, false);\n \n         replayControls();\n \n         PageSpecificationResolverImpl resolver = new PageSpecificationResolverImpl();\n-        resolver.setContextRoot(contextRoot);\n+\n         resolver.setSpecificationSource(source);\n+        resolver.setContextRoot(contextRoot);\n         resolver.setLog(log);\n-        resolver.setApplicationId(\"myapp\");\n-        resolver.setComponentPropertySource(propertySource);\n \n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"FrameworkPage\");\n+        try\n+        {\n+            resolver.resolve(cycle, \"/WEB-Inf/BadName\");\n+            unreachable();\n+        }\n+        catch (ApplicationRuntimeException ex)\n+        {\n+            assertEquals(\n+                    \"Page name '/WEB-Inf/BadName' is not valid, as it directly references a file stored in the WEB-INF folder.\",\n+                    ex.getMessage());\n+        }\n \n-        assertEquals(\"FrameworkPage\", resolver.getSimplePageName());\n-        assertSame(spec, resolver.getSpecification());\n-        assertSame(framework, resolver.getNamespace());\n+        verifyControls();\n+\n+        trainContainsPage(application, \"web-inf/BadName\", false);\n+\n+        trainIsDebugEnabled(log, false);\n+\n+        replayControls();\n+\n+        try\n+        {\n+            resolver.resolve(cycle, \"web-inf/BadName\");\n+            unreachable();\n+        }\n+        catch (ApplicationRuntimeException ex)\n+        {\n+            assertEquals(\n+                    \"Page name 'web-inf/BadName' is not valid, as it directly references a file stored in the WEB-INF folder.\",\n+                    ex.getMessage());\n+        }\n \n         verifyControls();\n+\n     }\n \n-    public void testProvidedByDelegate()\n+    public void testNotFoundAnywhere()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n+        INamespace application = newNamespace();\n \n         Resource contextRoot = newResource(\"context/\");\n-        IComponentSpecification spec = newSpecification();\n-\n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework);\n         IRequestCycle cycle = newCycle();\n \n-        trainContainsPage(applicationc, application, \"DelegatePage\", false);\n+        trainContainsPage(application, \"MissingPage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"DelegatePage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"MissingPage\", application));\n \n         // Pretend the app spec is in the WEB-INF folder\n \n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/DelegatePage.page\")));\n-\n-        application.isApplicationNamespace();\n-        applicationc.setReturnValue(false);\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/MissingPage.page\")));\n \n-        MockControl delegatec = newControl(ISpecificationResolverDelegate.class);\n-        ISpecificationResolverDelegate delegate = (ISpecificationResolverDelegate) delegatec\n-                .getMock();\n+        trainIsApplicationNamespace(application, false);\n \n-        delegate.findPageSpecification(cycle, application, \"DelegatePage\");\n-        delegatec.setReturnValue(spec);\n+        ISpecificationResolverDelegate delegate = newDelegate();\n \n-        trainIsDebugEnabled(logc, log, false);\n+        trainFindPageSpecification(delegate, cycle, application, \"MissingPage\", null);\n \n-        application.installPageSpecification(\"DelegatePage\", spec);\n+        trainGetNamespaceId(application, \"<application namespace>\");\n \n         replayControls();\n \n@@ -793,52 +771,52 @@ public void testProvidedByDelegate()\n \n         resolver.initializeService();\n \n-        resolver.resolve(cycle, \"DelegatePage\");\n-\n-        assertEquals(\"DelegatePage\", resolver.getSimplePageName());\n-        assertSame(spec, resolver.getSpecification());\n-        assertSame(application, resolver.getNamespace());\n+        try\n+        {\n+            resolver.resolve(cycle, \"MissingPage\");\n+            unreachable();\n+        }\n+        catch (PageNotFoundException ex)\n+        {\n+            assertEquals(\"Page 'MissingPage' not found in <application namespace>.\", ex\n+                    .getMessage());\n+        }\n \n         verifyControls();\n     }\n \n-    public void testNotFoundAnywhere()\n+    public void testProvidedByDelegate()\n     {\n-        MockControl logc = newControl(Log.class);\n-        Log log = (Log) logc.getMock();\n+        Log log = newLog();\n+        INamespace application = newNamespace();\n \n         Resource contextRoot = newResource(\"context/\");\n-\n-        MockControl applicationc = newControl(INamespace.class);\n-        INamespace application = (INamespace) applicationc.getMock();\n+        IComponentSpecification spec = newSpecification();\n \n         INamespace framework = newNamespace();\n         ISpecificationSource source = newSource(application, framework);\n         IRequestCycle cycle = newCycle();\n \n-        trainContainsPage(applicationc, application, \"MissingPage\", false);\n+        trainContainsPage(application, \"DelegatePage\", false);\n \n-        train(log, logc, ResolverMessages.resolvingPage(\"MissingPage\", application));\n+        train(log, ResolverMessages.resolvingPage(\"DelegatePage\", application));\n \n         // Pretend the app spec is in the WEB-INF folder\n \n-        trainGetSpecLocation(applicationc, application, contextRoot, \"WEB-INF/\");\n+        trainGetSpecificationLocation(application, contextRoot, \"WEB-INF/\");\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n-                .getRelativeResource(\"WEB-INF/MissingPage.page\")));\n+        train(log, ResolverMessages.checkingResource(contextRoot\n+                .getRelativeResource(\"WEB-INF/DelegatePage.page\")));\n \n-        application.isApplicationNamespace();\n-        applicationc.setReturnValue(false);\n+        trainIsApplicationNamespace(application, false);\n \n-        MockControl delegatec = newControl(ISpecificationResolverDelegate.class);\n-        ISpecificationResolverDelegate delegate = (ISpecificationResolverDelegate) delegatec\n-                .getMock();\n+        ISpecificationResolverDelegate delegate = newDelegate();\n \n-        delegate.findPageSpecification(cycle, application, \"MissingPage\");\n-        delegatec.setReturnValue(null);\n+        trainFindPageSpecification(delegate, cycle, application, \"DelegatePage\", spec);\n \n-        application.getNamespaceId();\n-        applicationc.setReturnValue(\"<application namespace>\");\n+        trainIsDebugEnabled(log, false);\n+\n+        application.installPageSpecification(\"DelegatePage\", spec);\n \n         replayControls();\n \n@@ -851,17 +829,26 @@ public void testNotFoundAnywhere()\n \n         resolver.initializeService();\n \n-        try\n-        {\n-            resolver.resolve(cycle, \"MissingPage\");\n-            unreachable();\n-        }\n-        catch (PageNotFoundException ex)\n-        {\n-            assertEquals(\"Page 'MissingPage' not found in <application namespace>.\", ex\n-                    .getMessage());\n-        }\n+        resolver.resolve(cycle, \"DelegatePage\");\n+\n+        assertEquals(\"DelegatePage\", resolver.getSimplePageName());\n+        assertSame(spec, resolver.getSpecification());\n+        assertSame(application, resolver.getNamespace());\n \n         verifyControls();\n     }\n+\n+    private void trainGetPageSpecification(INamespace namespace, String pageName,\n+            IComponentSpecification spec)\n+    {\n+        namespace.getPageSpecification(pageName);\n+        setReturnValue(namespace, spec);\n+    }\n+\n+    private void trainGetPageSpecification(ISpecificationSource source, Resource resource,\n+            IComponentSpecification pageSpec)\n+    {\n+        source.getPageSpecification(resource);\n+        setReturnValue(source, pageSpec);\n+    }\n }\n\\ No newline at end of file",
                "previous_filename": "framework/src/test/org/apache/tapestry/resolver/TestPageSpecificationResolver.java",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/PageSpecificationResolverTest.java",
                "sha": "a5912ae3cfcdffc171b48501d9fbbd659998b509",
                "status": "renamed"
            },
            {
                "additions": 25,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/TestComponentSpecificationResolver.java",
                "changes": 50,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/framework/src/test/org/apache/tapestry/resolver/TestComponentSpecificationResolver.java?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 25,
                "filename": "framework/src/test/org/apache/tapestry/resolver/TestComponentSpecificationResolver.java",
                "patch": "@@ -203,13 +203,13 @@ public void testSearchFoundRelative()\n         namespace.containsComponentType(\"MyComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"MyComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"MyComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(specLocation));\n-        train(log, logc, ResolverMessages.installingComponent(\"MyComponent\", namespace, spec));\n+        train(log, ResolverMessages.checkingResource(specLocation));\n+        train(log, ResolverMessages.installingComponent(\"MyComponent\", namespace, spec));\n \n         namespace.installComponentSpecification(\"MyComponent\", spec);\n \n@@ -251,12 +251,12 @@ public void testFoundInFrameworkNamespace()\n         namespace.containsComponentType(\"FrameworkComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"FrameworkComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"FrameworkComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"FrameworkComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n@@ -273,7 +273,7 @@ public void testFoundInFrameworkNamespace()\n         framework.getComponentSpecification(\"FrameworkComponent\");\n         frameworkc.setReturnValue(spec);\n \n-        train(log, logc, ResolverMessages\n+        train(log, ResolverMessages\n                 .installingComponent(\"FrameworkComponent\", namespace, spec));\n         namespace.installComponentSpecification(\"FrameworkComponent\", spec);\n \n@@ -322,12 +322,12 @@ public void testProvidedByDelegate()\n         namespace.containsComponentType(\"DelegateComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"DelegateComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"DelegateComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"DelegateComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n@@ -406,12 +406,12 @@ public void testNotFound()\n         namespace.containsComponentType(\"NotFoundComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"NotFoundComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"NotFoundComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"NotFoundComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n@@ -478,19 +478,19 @@ public void testFoundInAppFolder()\n         namespace.containsComponentType(\"MyAppComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"MyAppComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"MyAppComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"MyAppComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n         namespacec.setReturnValue(true);\n \n-        train(log, logc, ResolverMessages.checkingResource(specLocation));\n-        train(log, logc, ResolverMessages.installingComponent(\"MyAppComponent\", namespace, spec));\n+        train(log, ResolverMessages.checkingResource(specLocation));\n+        train(log, ResolverMessages.installingComponent(\"MyAppComponent\", namespace, spec));\n \n         namespace.installComponentSpecification(\"MyAppComponent\", spec);\n \n@@ -537,21 +537,21 @@ public void testFoundInWebInfFolder()\n         namespace.containsComponentType(\"MyWebInfComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"MyWebInfComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"MyWebInfComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"MyWebInfComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n         namespacec.setReturnValue(true);\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n+        train(log, ResolverMessages.checkingResource(contextRoot\n                 .getRelativeResource(\"WEB-INF/myapp/MyWebInfComponent.jwc\")));\n-        train(log, logc, ResolverMessages.checkingResource(specLocation));\n-        train(log, logc, ResolverMessages.installingComponent(\"MyWebInfComponent\", namespace, spec));\n+        train(log, ResolverMessages.checkingResource(specLocation));\n+        train(log, ResolverMessages.installingComponent(\"MyWebInfComponent\", namespace, spec));\n \n         namespace.installComponentSpecification(\"MyWebInfComponent\", spec);\n \n@@ -598,23 +598,23 @@ public void testFoundInContextRoot()\n         namespace.containsComponentType(\"ContextRootComponent\");\n         namespacec.setReturnValue(false);\n \n-        train(log, logc, ResolverMessages.resolvingComponent(\"ContextRootComponent\", namespace));\n+        train(log, ResolverMessages.resolvingComponent(\"ContextRootComponent\", namespace));\n \n         namespace.getSpecificationLocation();\n         namespacec.setReturnValue(namespaceLocation);\n \n-        train(log, logc, ResolverMessages.checkingResource(namespaceLocation\n+        train(log, ResolverMessages.checkingResource(namespaceLocation\n                 .getRelativeResource(\"ContextRootComponent.jwc\")));\n \n         namespace.isApplicationNamespace();\n         namespacec.setReturnValue(true);\n \n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n+        train(log, ResolverMessages.checkingResource(contextRoot\n                 .getRelativeResource(\"WEB-INF/myapp/ContextRootComponent.jwc\")));\n-        train(log, logc, ResolverMessages.checkingResource(contextRoot\n+        train(log, ResolverMessages.checkingResource(contextRoot\n                 .getRelativeResource(\"WEB-INF/ContextRootComponent.jwc\")));\n-        train(log, logc, ResolverMessages.checkingResource(specLocation));\n-        train(log, logc, ResolverMessages.installingComponent(\n+        train(log, ResolverMessages.checkingResource(specLocation));\n+        train(log, ResolverMessages.installingComponent(\n                 \"ContextRootComponent\",\n                 namespace,\n                 spec));",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/framework/src/test/org/apache/tapestry/resolver/TestComponentSpecificationResolver.java",
                "sha": "7ea17591757562b7b3b4e3a91844a3b2ed59efb5",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tapestry4/blob/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/status.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tapestry4/contents/status.xml?ref=fa15f2eead1418e9e83c3ccc862b1ce5d56e076a",
                "deletions": 0,
                "filename": "status.xml",
                "patch": "@@ -82,6 +82,8 @@\n         ListenerMapSource.createListenerMethodInvoker()</action>\n       <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-387\" due-to=\"Kevin J. Menard, Jr.\">Typographical Errors in\n         Documentation</action>\n+      <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-724\">Tapestry may, in some cases, look for a page class in the wrong package</action>\n+      <action type=\"fix\" dev=\"HLS\" fixes-bug=\"TAPESTRY-783\">contrib:Tree fails with NullPointerException</action>\n     </release>\n     <release version=\"4.0-beta-13\" date=\"Nov 12 2005\">\n       <action type=\"update\" dev=\"HLS\">Switch to HiveMind 1.1 (final)</action>",
                "raw_url": "https://github.com/apache/tapestry4/raw/fa15f2eead1418e9e83c3ccc862b1ce5d56e076a/status.xml",
                "sha": "72424b8df350da253b0c980a066183d4f7c0a57a",
                "status": "modified"
            }
        ],
        "message": "TAPESTRY-783: contrib:Tree fails with NullPointerException\n\ngit-svn-id: https://svn.apache.org/repos/asf/jakarta/tapestry/trunk@351507 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tapestry4/commit/a82331911b7d8d704b2d25594913727b650e323f",
        "patched_files": [
            "FileSystem.java",
            "ComponentSpecificationResolver.java",
            "FileSystemTree.java",
            "PageSpecificationResolver.java",
            "EngineServiceSource.java",
            "TreeTableDataView.java",
            "Drive.java",
            "AbstractSpecificationResolverTestCase.java",
            "ResolverStrings.java",
            "FolderObject.java",
            "ResolverMessages.java",
            "EngineServiceOuterProxy.java",
            "AssetsHolder.java",
            "FileObject.java",
            "FileSystemTreeTable.java",
            "TreeNodeView.java",
            "FileSystemStateManager.java",
            "status.java",
            "EngineServiceInnerProxy.java",
            "PageSpecificationResolverImpl.java"
        ],
        "repo": "tapestry4",
        "unit_tests": [
            "TestEngineServiceOuterProxy.java",
            "TestComponentSpecificationResolver.java",
            "TestEngineServiceInnerProxy.java",
            "PageSpecificationResolverTest.java"
        ]
    }
}