[
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1825] NPE when checkout project with trunk (rev 678311) \n\nfix NPE\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@678536 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/4ca6353a8b50deecbe00d850e9aafdb0e60245bd",
        "parent": "https://github.com/apache/continuum/commit/c244b2171a99dd3825a09b8270a4d27c1dac8763",
        "bug_id": "continuum_1",
        "file": [
            {
                "sha": "f15474ba1e2e211eeae5788df9f633c77340293a",
                "filename": "continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/4ca6353a8b50deecbe00d850e9aafdb0e60245bd/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/4ca6353a8b50deecbe00d850e9aafdb0e60245bd/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "status": "modified",
                "changes": 4,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java?ref=4ca6353a8b50deecbe00d850e9aafdb0e60245bd",
                "patch": "@@ -61,6 +61,10 @@\n \n     protected String getBuildOutput( Project project, BuildResult buildResult )\n     {\n+        if ( buildResult == null )\n+        {\n+            return \"\";\n+        }\n         try\n         {\n             if ( buildResult.getEndTime() != 0 )",
                "deletions": 0
            },
            {
                "sha": "794f1fc29ac3c6828ad758acfdbaf3caf9de4625",
                "filename": "continuum-webapp/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/4ca6353a8b50deecbe00d850e9aafdb0e60245bd/continuum-webapp/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/4ca6353a8b50deecbe00d850e9aafdb0e60245bd/continuum-webapp/pom.xml",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/pom.xml?ref=4ca6353a8b50deecbe00d850e9aafdb0e60245bd",
                "patch": "@@ -561,7 +561,7 @@ under the License.\n       <scope>provided</scope>\n     </dependency>\n   </dependencies>\n-      <profiles>\n+  <profiles>\n     <profile>\n       <id>postgres</id>\n       <dependencies>",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2475] NullPointerException while adding a Maven 2 project if there is already an Ant project in the group\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@918314 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/5ab60a8304925a704884ec8e7332fabd09a88728",
        "parent": "https://github.com/apache/continuum/commit/069be9d62ad5aefa39e535b16d44b308f79a711d",
        "bug_id": "continuum_2",
        "file": [
            {
                "sha": "c156edf32a0763d3f3104a7a918bfd89f2a32640",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/5ab60a8304925a704884ec8e7332fabd09a88728/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/5ab60a8304925a704884ec8e7332fabd09a88728/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 10,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=5ab60a8304925a704884ec8e7332fabd09a88728",
                "patch": "@@ -3744,12 +3744,12 @@ private void checkForDuplicateProjectInGroup( ProjectGroup projectGroup, Project\n             return;\n         }\n \n-        for ( Project project : (List<Project>) projectGroup.getProjects() )\n+        for ( Project project : projectGroup.getProjects() )\n         {\n-\n-            if ( project.getGroupId().equals( projectToCheck.getGroupId() ) &&\n-                project.getArtifactId().equals( projectToCheck.getArtifactId() ) &&\n-                project.getVersion().equals( projectToCheck.getVersion() ) )\n+            // projectToCheck is first in the equals check, as projectToCheck must be a Maven project and will have\n+            // non-null values for each. project may be an Ant or Shell project and have null values.\n+            if ( projectToCheck.getGroupId().equals( project.getGroupId() ) && projectToCheck.getArtifactId().equals(\n+                project.getArtifactId() ) && projectToCheck.getVersion().equals( project.getVersion() ) )\n             {\n                 result.addError( ContinuumProjectBuildingResult.ERROR_DUPLICATE_PROJECTS );\n                 return;",
                "deletions": 5
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1831] When click \"save\" or \"cancel\" button on the Appearance page (with or without making changes), get java.lang.NullPointerException error\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@690520 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
        "parent": "https://github.com/apache/continuum/commit/39ae71953197ca29517c0385add92c32d94d5eda",
        "bug_id": "continuum_3",
        "file": [
            {
                "sha": "88ea2bf7a5df6460bfa118f83a3636a52beaff25",
                "filename": "continuum-webapp/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/pom.xml",
                "status": "modified",
                "changes": 12,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/pom.xml?ref=86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
                "patch": "@@ -176,6 +176,18 @@ under the License.\n               <goal>java</goal>\n             </goals>\n           </execution>\n+          <execution>\n+            <id>appearence model classes</id>\n+            <configuration>\n+              <model>src/main/mdo/appearance-models.mdo</model>\n+              <version>1.0.0</version>\n+            </configuration>\n+            <goals>\n+              <goal>java</goal>\n+              <goal>xpp3-reader</goal>\n+              <goal>xpp3-writer</goal>\n+            </goals>\n+          </execution>          \n         </executions>\n       </plugin>\n       <plugin>",
                "deletions": 0
            },
            {
                "sha": "46f36ab08338ba6702dbe62c85e7d7a4308ffb6e",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureFooterAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureFooterAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureFooterAction.java",
                "status": "modified",
                "changes": 5,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureFooterAction.java?ref=86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
                "patch": "@@ -18,9 +18,10 @@\n  */\n package org.apache.maven.continuum.web.action.admin;\n \n+import java.io.IOException;\n+\n import org.apache.maven.continuum.web.action.component.AbstractFooterAction;\n import org.apache.maven.continuum.web.appareance.AppareanceConfiguration;\n-import org.codehaus.plexus.registry.RegistryException;\n \n /**\n  * @author <a href=\"mailto:olamy@apache.org\">olamy</a>\n@@ -38,7 +39,7 @@\n     private AppareanceConfiguration appareanceConfiguration;\n \n     public String saveFooter()\n-        throws RegistryException\n+        throws IOException\n     {\n         appareanceConfiguration.saveFooter( getFooter() );\n         return SUCCESS;",
                "deletions": 2
            },
            {
                "sha": "3f4019adfbcc6a97b6b6b402a4e79a28f31b08f5",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/AppareanceConfiguration.java",
                "blob_url": "https://github.com/apache/continuum/blob/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/AppareanceConfiguration.java",
                "raw_url": "https://github.com/apache/continuum/raw/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/AppareanceConfiguration.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/AppareanceConfiguration.java?ref=86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
                "patch": "@@ -18,6 +18,8 @@\n  */\n package org.apache.maven.continuum.web.appareance;\n \n+import java.io.IOException;\n+\n import org.codehaus.plexus.registry.RegistryException;\n \n /**\n@@ -33,7 +35,7 @@\n      * @throws RegistryException\n      */\n     public void saveFooter( String footerHtmlContent )\n-        throws RegistryException;\n+        throws IOException;\n \n     /**\n      * If no user configuration a default one will be user ",
                "deletions": 1
            },
            {
                "sha": "bf744748871b9663afd1c292d0396f80666d2602",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/DefaultAppareanceConfiguration.java",
                "blob_url": "https://github.com/apache/continuum/blob/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/DefaultAppareanceConfiguration.java",
                "raw_url": "https://github.com/apache/continuum/raw/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/DefaultAppareanceConfiguration.java",
                "status": "modified",
                "changes": 80,
                "additions": 53,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/appareance/DefaultAppareanceConfiguration.java?ref=86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
                "patch": "@@ -18,13 +18,21 @@\n  */\n package org.apache.maven.continuum.web.appareance;\n \n+import java.io.File;\n+import java.io.FileWriter;\n+import java.io.IOException;\n import java.util.Calendar;\n \n+import org.apache.continuum.web.appearance.ContinuumAppearance;\n+import org.apache.continuum.web.appearance.io.xpp3.ContinuumAppearanceModelsXpp3Reader;\n+import org.apache.continuum.web.appearance.io.xpp3.ContinuumAppearanceModelsXpp3Writer;\n import org.codehaus.plexus.personality.plexus.lifecycle.phase.Initializable;\n import org.codehaus.plexus.personality.plexus.lifecycle.phase.InitializationException;\n-import org.codehaus.plexus.registry.Registry;\n-import org.codehaus.plexus.registry.RegistryException;\n+import org.codehaus.plexus.util.ReaderFactory;\n import org.codehaus.plexus.util.StringUtils;\n+import org.codehaus.plexus.util.xml.pull.XmlPullParserException;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n /**\n  * @author <a href=\"mailto:olamy@apache.org\">olamy</a>\n@@ -35,31 +43,47 @@\n public class DefaultAppareanceConfiguration\n     implements AppareanceConfiguration, Initializable\n {\n-\n-    private String FOOTER_REGISTRY_KEY = \"footer\";\n-    \n-    private String REGISTRY_SECTION_KEY = \"org.apache.maven.continuum.user\";\n+    private Logger log = LoggerFactory.getLogger( getClass() );\n     \n     private String footer;\n     \n-    /**\n-     * @plexus.requirement role-hint=\"commons-configuration\"\n-     */\n-    private Registry registry;\n+    public static final String APPEARANCE_FILE_NAME = \"continuum-appearance.xml\";\n     \n+    private ContinuumAppearance continuumAppearance = new ContinuumAppearance(); \n+   \n     // ------------------------------------------------\n     //  Plexus Lifecycle\n     // ------------------------------------------------\n     \n     public void initialize()\n         throws InitializationException\n     {\n-        Registry continuumRegistry = getContinuumRegistry();\n-        if (continuumRegistry != null)\n+        \n+        File appearanceConfFile = getAppearanceConfigurationFile();\n+\n+        if ( appearanceConfFile.exists() )\n         {\n-            this.footer = continuumRegistry.getString( FOOTER_REGISTRY_KEY );\n+            try\n+            {\n+                ContinuumAppearanceModelsXpp3Reader appearanceReader = new ContinuumAppearanceModelsXpp3Reader();\n+                this.continuumAppearance = appearanceReader.read( ReaderFactory\n+                    .newXmlReader( appearanceConfFile ) );\n+                if ( continuumAppearance != null )\n+                {\n+                    this.footer = continuumAppearance.getFooter();\n+                }\n+            }\n+            catch ( IOException e )\n+            {\n+                log.warn( \"skip IOException reading appearance file \" + APPEARANCE_FILE_NAME + \", msg \"\n+                    + e.getMessage() );\n+            }\n+            catch ( XmlPullParserException e )\n+            {\n+                log.warn( \"skip XmlPullParserException reading appearance file \" + APPEARANCE_FILE_NAME + \", msg \"\n+                    + e.getMessage() );\n+            }\n         }\n-\n         if ( StringUtils.isEmpty( this.footer ) )\n         {\n             // initiate with default footer (save in registry ?)\n@@ -79,23 +103,19 @@ public String getFooter()\n      * @see org.apache.maven.continuum.web.appareance.AppareanceConfiguration#saveFooter(java.lang.String)\n      */\n     public void saveFooter( String footerHtmlContent )\n-        throws RegistryException\n+        throws IOException\n     {\n-        Registry continuumRegistry = getContinuumRegistry();\n-        \n-        continuumRegistry.setString( FOOTER_REGISTRY_KEY, footerHtmlContent );\n-        continuumRegistry.save();\n+        continuumAppearance.setFooter( footerHtmlContent );\n+        ContinuumAppearanceModelsXpp3Writer writer = new ContinuumAppearanceModelsXpp3Writer();\n+        File confFile = getAppearanceConfigurationFile();\n+        if (!confFile.exists())\n+        {\n+            confFile.getParentFile().mkdirs();\n+        }\n+        writer.write( new FileWriter( confFile ), continuumAppearance );\n         this.footer = footerHtmlContent;\n     }\n \n-    // ------------------------------------------------\n-    //  Internal stuff\n-    // ------------------------------------------------\n-\n-    private Registry getContinuumRegistry()\n-    {\n-        return registry.getSection( REGISTRY_SECTION_KEY );\n-    }\n \n     private String getDefaultFooter()\n     {\n@@ -110,4 +130,10 @@ private String getDefaultFooter()\n         return stringBuilder.toString();\n     }    \n     \n+    \n+    private File getAppearanceConfigurationFile()\n+    {\n+        return new File( System.getProperty( \"appserver.base\" ) + File.separator + \"conf\" + File.separator\n+            + APPEARANCE_FILE_NAME );\n+    }\n }",
                "deletions": 27
            },
            {
                "sha": "de0020921227f2a4dcf11443303858fa107b64db",
                "filename": "continuum-webapp/src/main/mdo/appearance-models.mdo",
                "blob_url": "https://github.com/apache/continuum/blob/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/mdo/appearance-models.mdo",
                "raw_url": "https://github.com/apache/continuum/raw/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25/continuum-webapp/src/main/mdo/appearance-models.mdo",
                "status": "added",
                "changes": 25,
                "additions": 25,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/mdo/appearance-models.mdo?ref=86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
                "patch": "@@ -0,0 +1,25 @@\n+<model>\n+  <id>continuum-appearance-models</id>\n+  <name>ContinuumAppearanceModels</name>\n+  <defaults>\n+    <default>\n+      <key>package</key>\n+      <value>org.apache.continuum.web.appearance</value>\n+    </default>\n+  </defaults>\n+  <classes>\n+    <class rootElement=\"true\">\n+      <name>ContinuumAppearance</name>\n+      <version>1.0.0</version>\n+      <fields>\n+        <field>\n+          <name>footer</name>\n+          <version>1.0.0</version>\n+          <description></description>\n+          <type>String</type>\n+          <required>false</required>\n+        </field>\n+      </fields>\n+    </class>\n+  </classes>\n+</model>\n\\ No newline at end of file",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1521] NullPointerException in StarTeam changelog command\nupgrade maven-scn version to 1.1-SNAPSHOT\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@608083 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/3f57d72ae464fe2a3d4cf7283774ebdc3afe8eb3",
        "parent": "https://github.com/apache/continuum/commit/1ea470fead857941e7ee3b2554ca3134cea993f0",
        "bug_id": "continuum_4",
        "file": [
            {
                "sha": "728549e4121586c3cc3d48517d655d88d162a98e",
                "filename": "pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/3f57d72ae464fe2a3d4cf7283774ebdc3afe8eb3/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/3f57d72ae464fe2a3d4cf7283774ebdc3afe8eb3/pom.xml",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/pom.xml?ref=3f57d72ae464fe2a3d4cf7283774ebdc3afe8eb3",
                "patch": "@@ -818,7 +818,7 @@\n     <continuumWebappVersion>${pom.version}</continuumWebappVersion>\n     <maven.version>2.0.6</maven.version>\n     <wagon.version>1.0-beta-2</wagon.version>\n-    <maven-scm.version>1.0</maven-scm.version>\n+    <maven-scm.version>1.1-SNAPSHOT</maven-scm.version>\n     <redback.version>1.0-alpha-4</redback.version>\n     <mail-sender.version>1.0-alpha-7</mail-sender.version>\n   </properties>",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fixed NPE when agent attempts to locate artifact repo by name.\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1671304 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/082f919a5ac520417850f0cb101fb5f1ac107365",
        "parent": "https://github.com/apache/continuum/commit/c1334fa92bd06a6792d3e952c22cc27c535ca648",
        "bug_id": "continuum_5",
        "file": [
            {
                "sha": "47f97b69d4b7c6ddc23ebeeffa6a3b0932c31928",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/ContinuumBuildAgentServiceImpl.java",
                "blob_url": "https://github.com/apache/continuum/blob/082f919a5ac520417850f0cb101fb5f1ac107365/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/ContinuumBuildAgentServiceImpl.java",
                "raw_url": "https://github.com/apache/continuum/raw/082f919a5ac520417850f0cb101fb5f1ac107365/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/ContinuumBuildAgentServiceImpl.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/ContinuumBuildAgentServiceImpl.java?ref=082f919a5ac520417850f0cb101fb5f1ac107365",
                "patch": "@@ -374,8 +374,8 @@ private ArtifactRepository getArtifactRepository( int projectId )\n         org.apache.continuum.model.repository.LocalRepository localRepo = null;\n         try\n         {\n-            LocalRepository agentRepo = null;\n-            buildAgentConfigurationService.getLocalRepositoryByName( buildContext.getLocalRepository() );\n+            LocalRepository agentRepo = buildAgentConfigurationService.getLocalRepositoryByName(\n+                buildContext.getLocalRepository() );\n             localRepo = localRepositoryHelper.convertAgentRepo( agentRepo );\n         }\n         catch ( BuildAgentConfigurationException e )",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "fix possible NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@685328 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68",
        "parent": "https://github.com/apache/continuum/commit/b0553318aeb3fb484b64e6484da87f64e440c3ff",
        "bug_id": "continuum_6",
        "file": [
            {
                "sha": "d30f70d66b0c6998f4bddc34fa4327569961d61c",
                "filename": "continuum-commons/src/main/java/org/apache/maven/continuum/utils/ContinuumUrlValidator.java",
                "blob_url": "https://github.com/apache/continuum/blob/4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68/continuum-commons/src/main/java/org/apache/maven/continuum/utils/ContinuumUrlValidator.java",
                "raw_url": "https://github.com/apache/continuum/raw/4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68/continuum-commons/src/main/java/org/apache/maven/continuum/utils/ContinuumUrlValidator.java",
                "status": "modified",
                "changes": 26,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/main/java/org/apache/maven/continuum/utils/ContinuumUrlValidator.java?ref=4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68",
                "patch": "@@ -101,8 +101,6 @@\n \n     private static final String AUTHORITY_PATTERN = \"/^([\" + AUTHORITY_CHARS + \"]*)(:\\\\d*)?(.*)?/\";\n \n-    //                                                                            1                          2  3       4\n-\n     private static final int PARSE_AUTHORITY_HOST_IP = 1;\n \n     private static final int PARSE_AUTHORITY_PORT = 2;\n@@ -252,24 +250,26 @@ public boolean isValid( String value )\n         {\n             String authority = matchUrlPat.group( PARSE_URL_AUTHORITY );\n \n-            if ( authority.indexOf( \"@\" ) != -1 )\n+            if ( authority != null )\n             {\n-                String userPassword = authority.substring( 0, authority.indexOf( \"@\" ) );\n+                if ( authority.indexOf( \"@\" ) != -1 )\n+                {\n+                    String userPassword = authority.substring( 0, authority.indexOf( \"@\" ) );\n \n-                authority = authority.substring( authority.indexOf( \"@\" ) + 1 );\n+                    authority = authority.substring( authority.indexOf( \"@\" ) + 1 );\n \n-                if ( userPassword.indexOf( \":\" ) == -1 ||\n-                     userPassword.indexOf( \":\" ) == 0 ||\n-                     userPassword.indexOf( \":\" ) == userPassword.length() - 1 )\n+                    if ( userPassword.indexOf( \":\" ) == -1 || userPassword.indexOf( \":\" ) == 0\n+                        || userPassword.indexOf( \":\" ) == userPassword.length() - 1 )\n+                    {\n+                        return false;\n+                    }\n+                }\n+                if ( !isValidAuthority( authority ) )\n                 {\n                     return false;\n-                }\n+                }                \n             }\n \n-            if ( !isValidAuthority( authority ) )\n-            {\n-                return false;\n-            }\n \n             if ( !isValidQuery( matchUrlPat.group( PARSE_URL_QUERY ) ) )\n             {",
                "deletions": 13
            },
            {
                "sha": "171cbc232d5209e071a4effbdff846289ef5f77b",
                "filename": "continuum-commons/src/test/java/org/apache/maven/continuum/utils/ContinuumUrlValidatorTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68/continuum-commons/src/test/java/org/apache/maven/continuum/utils/ContinuumUrlValidatorTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68/continuum-commons/src/test/java/org/apache/maven/continuum/utils/ContinuumUrlValidatorTest.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/maven/continuum/utils/ContinuumUrlValidatorTest.java?ref=4df1f2fd16cfb9e357fa95b169d1c61c4f5e5b68",
                "patch": "@@ -115,4 +115,5 @@ public void testSuccessHttpsfisheye()\n         assertTrue( new ContinuumUrlValidator()\n             .validate( \"https://fisheye6.atlassian.com/browse/~raw,r=680040/continuum/trunk/pom.xml\" ) );\n     }\n+   \n }",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@585430 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/d2955a16c50b80fec5c01e334f2f866ba5758435",
        "parent": "https://github.com/apache/continuum/commit/bd9e8a7e188efb2d1be30f344acb190f2c12a790",
        "bug_id": "continuum_7",
        "file": [
            {
                "sha": "f7dc63506dba48d340ae64e8108d9f588372faff",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/d2955a16c50b80fec5c01e334f2f866ba5758435/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/d2955a16c50b80fec5c01e334f2f866ba5758435/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java?ref=d2955a16c50b80fec5c01e334f2f866ba5758435",
                "patch": "@@ -65,7 +65,7 @@ public String cancelBuilds()\n         throws ContinuumException\n     {\n         // first we remove from the build queue\n-        if ( getSelectedProjects().isEmpty() )\n+        if ( getSelectedProjects() != null && getSelectedProjects().isEmpty() )\n         {\n             return SUCCESS;\n         }",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@531802 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/7f3014ce975b106da8d94d0dfac2c469aac01857",
        "parent": "https://github.com/apache/continuum/commit/f45e3bf6c513cf77b207befb028974fca0fea6f0",
        "bug_id": "continuum_8",
        "file": [
            {
                "sha": "454d8d9497f67bfb767ccfaad469e22395ce6420",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "blob_url": "https://github.com/apache/continuum/blob/7f3014ce975b106da8d94d0dfac2c469aac01857/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "raw_url": "https://github.com/apache/continuum/raw/7f3014ce975b106da8d94d0dfac2c469aac01857/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java?ref=7f3014ce975b106da8d94d0dfac2c469aac01857",
                "patch": "@@ -348,7 +348,7 @@ private ScmRepository getScmRepository( Project project, boolean useCredentialsC\n         {\n             //Remove the clientspec name, so it will be recalcuated between each command for each project\n             //instead of use the same for all projects\n-            System.setProperty( \"maven.scm.perforce.clientspec.name\", null );\n+            System.setProperty( \"maven.scm.perforce.clientspec.name\", \"\" );\n         }\n \n         return repository;",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@358368 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/47011b5fb22db0088fb78741f61f5e0399bbb4a9",
        "parent": "https://github.com/apache/continuum/commit/01a3348ff7e7eb63689582ad6920b16c17725bd4",
        "bug_id": "continuum_9",
        "file": [
            {
                "sha": "8f2fbb2e63af97a6af7ff911aa9c0d250fc9b0ec",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/SummaryAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/47011b5fb22db0088fb78741f61f5e0399bbb4a9/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/SummaryAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/47011b5fb22db0088fb78741f61f5e0399bbb4a9/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/SummaryAction.java",
                "status": "modified",
                "changes": 23,
                "additions": 15,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/SummaryAction.java?ref=47011b5fb22db0088fb78741f61f5e0399bbb4a9",
                "patch": "@@ -96,18 +96,24 @@ else if ( project.getState() == 4 )\n \n                 model.setBuildNumber( project.getBuildNumber() );\n \n-                BuildResult buildInSuccess = (BuildResult) buildResultsInSuccess.get( new Integer( project.getId() ) );\n-\n-                if ( buildInSuccess != null )\n+                if ( buildResultsInSuccess != null )\n                 {\n-                    model.setBuildInSuccessId( buildInSuccess.getId() );\n-                }\n+                    BuildResult buildInSuccess = (BuildResult) buildResultsInSuccess.get( new Integer( project.getId() ) );\n \n-                BuildResult latestBuild = (BuildResult) buildResults.get( new Integer( project.getId() ) );\n+                    if ( buildInSuccess != null )\n+                    {\n+                        model.setBuildInSuccessId( buildInSuccess.getId() );\n+                    }\n+                }\n \n-                if ( latestBuild != null )\n+                if ( buildResults != null )\n                 {\n-                    model.setLatestBuildId( latestBuild.getId() );\n+                    BuildResult latestBuild = (BuildResult) buildResults.get( new Integer( project.getId() ) );\n+\n+                    if ( latestBuild != null )\n+                    {\n+                        model.setLatestBuildId( latestBuild.getId() );\n+                    }\n                 }\n \n                 summary.add( model );\n@@ -119,6 +125,7 @@ else if ( project.getState() == 4 )\n         {\n             e.printStackTrace();\n         }\n+\n         return SUCCESS;\n     }\n ",
                "deletions": 8
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@332328 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/a0469a24abdfea603c356294e2f8f85342587c5f",
        "parent": "https://github.com/apache/continuum/commit/d661e274c79f439d15da304752313ee2c1221296",
        "bug_id": "continuum_10",
        "file": [
            {
                "sha": "1eb9d3920401034ccdf0658232839e6221fd93df",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "blob_url": "https://github.com/apache/continuum/blob/a0469a24abdfea603c356294e2f8f85342587c5f/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "raw_url": "https://github.com/apache/continuum/raw/a0469a24abdfea603c356294e2f8f85342587c5f/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java?ref=a0469a24abdfea603c356294e2f8f85342587c5f",
                "patch": "@@ -388,7 +388,7 @@ private String writeCommandLine( String commandLine )\n     {\n         String cmd = commandLine;\n         \n-        if ( cmd.startsWith( \"svn\" ) )\n+        if ( cmd != null && cmd.startsWith( \"svn\" ) )\n         {\n             String pwdString = \"--password\";\n ",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@329893 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c",
        "parent": "https://github.com/apache/continuum/commit/27e394a6857c81c458c13ad3a8938265a3ceaf48",
        "bug_id": "continuum_11",
        "file": [
            {
                "sha": "e41334265ea421d3ee2931f89b8b29c31f15359c",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "status": "modified",
                "changes": 11,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java?ref=26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c",
                "patch": "@@ -317,7 +317,12 @@ private void buildComplete( Project project, BuildResult build, String buildOutp\n \n     private String generateSubject( Project project, BuildResult build )\n     {\n-        int state = build.getState();\n+        int state = -1;\n+\n+        if ( build != null )\n+        {\n+            state = build.getState();\n+        }\n \n         if ( state == ContinuumProjectState.OK )\n         {\n@@ -333,9 +338,9 @@ else if ( state == ContinuumProjectState.ERROR )\n         }\n         else\n         {\n-            getLogger().warn( \"Unknown build state \" + build.getState() + \" for project \" + project.getId() );\n+            getLogger().warn( \"Unknown build state \" + state + \" for project \" + project.getId() );\n \n-            return \"[continuum] ERROR: Unknown build state \" + build.getState() + \" for \" + project.getName() + \" project\";\n+            return \"[continuum] ERROR: Unknown build state \" + state + \" for \" + project.getName() + \" project\";\n         }\n     }\n ",
                "deletions": 3
            },
            {
                "sha": "db5bf9d8a6b8d0b7336e7886e4a79f38fda5e70a",
                "filename": "continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "status": "modified",
                "changes": 11,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java?ref=26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c",
                "patch": "@@ -163,7 +163,12 @@ private void buildComplete( Project project, BuildResult build, Map configuratio\n     private String generateMessage( Project project, BuildResult build )\n         throws ContinuumException\n     {\n-        int state = build.getState();\n+        int state = -1;\n+\n+        if ( build != null )\n+        {\n+            state = build.getState();\n+        }\n \n         String message;\n \n@@ -181,9 +186,9 @@ else if ( state == ContinuumProjectState.ERROR )\n         }\n         else\n         {\n-            getLogger().warn( \"Unknown build state \" + build.getState() + \" for project \" + project.getId() );\n+            getLogger().warn( \"Unknown build state \" + state + \" for project \" + project.getId() );\n \n-            message = \"ERROR: Unknown build state \" + build.getState() + \" for \" + project.getName() + \" project\";\n+            message = \"ERROR: Unknown build state \" + state + \" for \" + project.getName() + \" project\";\n         }\n \n         return message + \" \" + getReportUrl( project, build, configurationService );",
                "deletions": 3
            },
            {
                "sha": "4c1bef0c2d0a69a12901e29c2a0b4adb016bcfdb",
                "filename": "continuum-notifiers/continuum-notifier-jabber/src/main/java/org/apache/maven/continuum/notification/jabber/JabberContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-notifiers/continuum-notifier-jabber/src/main/java/org/apache/maven/continuum/notification/jabber/JabberContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c/continuum-notifiers/continuum-notifier-jabber/src/main/java/org/apache/maven/continuum/notification/jabber/JabberContinuumNotifier.java",
                "status": "modified",
                "changes": 11,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-jabber/src/main/java/org/apache/maven/continuum/notification/jabber/JabberContinuumNotifier.java?ref=26908f1b7dae9db7a1bbbe9ac5716d2de4a88e1c",
                "patch": "@@ -121,7 +121,12 @@ public void sendNotification( String source, Set recipients, Map configuration,\n     private String generateMessage( Project project, BuildResult build )\n         throws ContinuumException\n     {\n-        int state = build.getState();\n+        int state = -1;\n+\n+        if ( build != null )\n+        {\n+            state = build.getState();\n+        }\n \n         String message;\n \n@@ -139,9 +144,9 @@ else if ( state == ContinuumProjectState.ERROR )\n         }\n         else\n         {\n-            getLogger().warn( \"Unknown build state \" + build.getState() + \" for project \" + project.getId() );\n+            getLogger().warn( \"Unknown build state \" + state + \" for project \" + project.getId() );\n \n-            message = \"ERROR: Unknown build state \" + build.getState() + \" for \" + project.getName() + \" project\";\n+            message = \"ERROR: Unknown build state \" + state + \" for \" + project.getName() + \" project\";\n         }\n \n         return message + \" \" + getReportUrl( project, build, configurationService );",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@264766 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/eb599c0b34b83f0c8db7f1fc10d89da468c46eae",
        "parent": "https://github.com/apache/continuum/commit/ee771aefb39c686a9ccb84889ef2ba517ced8acf",
        "bug_id": "continuum_12",
        "file": [
            {
                "sha": "bc42f318881acb8c7d47e1885a2f1c1cda968de3",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/eb599c0b34b83f0c8db7f1fc10d89da468c46eae/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/eb599c0b34b83f0c8db7f1fc10d89da468c46eae/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "status": "modified",
                "changes": 41,
                "additions": 26,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java?ref=eb599c0b34b83f0c8db7f1fc10d89da468c46eae",
                "patch": "@@ -236,25 +236,36 @@ public void build( int projectId, int trigger )\n     private String convertScmResultToError( ScmResult result )\n     {\n         String error = \"\";\n-        if ( result.getProviderMessage() != null )\n-        {\n-            error = \"Provider message: \" + StringUtils.clean( result.getProviderMessage() ) +\n-                System.getProperty( \"line.separator\" );\n-        }\n-        if ( result.getCommandOutput() != null )\n+\n+        if ( scmResult == null )\n         {\n-            error += \"Command output: \" + System.getProperty( \"line.separator\" );\n-            error += \"-------------------------------------------------------------------------------\" +\n-                System.getProperty( \"line.separator\" );\n-            error += StringUtils.clean( result.getCommandOutput() ) + System.getProperty( \"line.separator\" );\n-            error += \"-------------------------------------------------------------------------------\" +\n-                System.getProperty( \"line.separator\" );\n+            error = \"Scm result is null.\";\n         }\n-        if ( result.getException() != null )\n+        else\n         {\n-            error += \"Exception:\" + System.getProperty( \"line.separator\" );\n-            error += result.getException();\n+            if ( result.getProviderMessage() != null )\n+            {\n+                error = \"Provider message: \" + StringUtils.clean( result.getProviderMessage() ) +\n+                    System.getProperty( \"line.separator\" );\n+            }\n+\n+            if ( result.getCommandOutput() != null )\n+            {\n+                error += \"Command output: \" + System.getProperty( \"line.separator\" );\n+                error += \"-------------------------------------------------------------------------------\" +\n+                    System.getProperty( \"line.separator\" );\n+                error += StringUtils.clean( result.getCommandOutput() ) + System.getProperty( \"line.separator\" );\n+                error += \"-------------------------------------------------------------------------------\" +\n+                    System.getProperty( \"line.separator\" );\n+            }\n+\n+            if ( result.getException() != null )\n+            {\n+                error += \"Exception:\" + System.getProperty( \"line.separator\" );\n+                error += result.getException();\n+            }\n         }\n+\n         return error;\n     }\n ",
                "deletions": 15
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2666] added a check to prevent NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1164024 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/bb9ada70dcb2ad5b097da6acf28b6807f64455ca",
        "parent": "https://github.com/apache/continuum/commit/aa018da3b68cf46d943a6cedbaec8ddd5982bb51",
        "bug_id": "continuum_13",
        "file": [
            {
                "sha": "3ec7fdede33062b55cb917c7dd934abf04c3f64f",
                "filename": "continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "blob_url": "https://github.com/apache/continuum/blob/bb9ada70dcb2ad5b097da6acf28b6807f64455ca/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "raw_url": "https://github.com/apache/continuum/raw/bb9ada70dcb2ad5b097da6acf28b6807f64455ca/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java?ref=bb9ada70dcb2ad5b097da6acf28b6807f64455ca",
                "patch": "@@ -2221,7 +2221,10 @@ public int removeBuildAgentGroup( String name )\n         ConfigurationService configurationService = continuum.getConfiguration();\n         org.apache.continuum.configuration.BuildAgentGroupConfiguration buildAgentGroupConfiguration =\n             configurationService.getBuildAgentGroup( name );\n-        configurationService.removeBuildAgentGroup( buildAgentGroupConfiguration );\n+        if ( buildAgentGroupConfiguration != null )\n+        {\n+            configurationService.removeBuildAgentGroup( buildAgentGroupConfiguration );\n+        }\n \n         return 0;\n     }",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "fixed NPE in logging with debug enabled\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1153792 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/2928493eb7f43bf0e4f0b669a671b7f5ffa37b00",
        "parent": "https://github.com/apache/continuum/commit/def5446a319e9adcb5a6fd070eab754369d6a301",
        "bug_id": "continuum_14",
        "file": [
            {
                "sha": "cc2c8865cfc33180b5852af0fef09a87e6b7dbb3",
                "filename": "continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/2928493eb7f43bf0e4f0b669a671b7f5ffa37b00/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/2928493eb7f43bf0e4f0b669a671b7f5ffa37b00/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "status": "modified",
                "changes": 3,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java?ref=2928493eb7f43bf0e4f0b669a671b7f5ffa37b00",
                "patch": "@@ -256,16 +256,13 @@ public void prepareBuildProjects( Map<Integer, Integer>projectsBuildDefinitionsM\n                     // get overall distributed build queue from build agent group\n                     log.info( \"Getting the least busy build agent from the build agent group\" );\n                     overallDistributedBuildQueue = getOverallDistributedBuildQueueByAgentGroup( projectsBuildDefinitionsMap );\n-                    log.debug( \"Building project in the least busy agent {} within the build agent group\", \n-                               overallDistributedBuildQueue.getBuildAgentUrl() );\n                 }\n             }\n             else\n             {\n                 // project does not have build agent group\n                 log.info( \"Project does not have a build agent group, getting the least busy build agent\" );\n                 overallDistributedBuildQueue = getOverallDistributedBuildQueue();\n-                log.debug( \"Building project in the least busy agent {}\", overallDistributedBuildQueue.getBuildAgentUrl() );\n             }\n         }\n ",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2169] fixed NPE in getText when using execAndWait interceptors\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@955116 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/6020ef74a6d42be5b5de3f45ca32c3acdb6975f2",
        "parent": "https://github.com/apache/continuum/commit/7ec08a786a1517ae889ea5e5df2857c47b0defce",
        "bug_id": "continuum_15",
        "file": [
            {
                "sha": "0b57be2616db454b94185a0df2d870cdc359e3fa",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddMavenProjectAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/6020ef74a6d42be5b5de3f45ca32c3acdb6975f2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddMavenProjectAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/6020ef74a6d42be5b5de3f45ca32c3acdb6975f2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddMavenProjectAction.java",
                "status": "modified",
                "changes": 22,
                "additions": 22,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddMavenProjectAction.java?ref=6020ef74a6d42be5b5de3f45ca32c3acdb6975f2",
                "patch": "@@ -41,6 +41,13 @@\n import org.apache.struts2.interceptor.ServletRequestAware;\n import org.codehaus.plexus.util.StringUtils;\n \n+import com.opensymphony.xwork2.ActionContext;\n+import com.opensymphony.xwork2.config.ConfigurationManager;\n+import com.opensymphony.xwork2.config.providers.XWorkConfigurationProvider;\n+import com.opensymphony.xwork2.inject.Container;\n+import com.opensymphony.xwork2.util.ValueStack;\n+import com.opensymphony.xwork2.util.ValueStackFactory;\n+\n /**\n  * Action to add a Maven project to Continuum, either Maven 1 or Maven 2.\n  *\n@@ -107,6 +114,21 @@ public String execute()\n             return REQUIRES_AUTHORIZATION;\n         }\n \n+        // ctan: hack for WW-3161\n+        if ( ActionContext.getContext() == null )\n+        {\n+            // This fix allow initialization of ActionContext.getContext() to avoid NPE\n+\n+            ConfigurationManager configurationManager = new ConfigurationManager();\n+            configurationManager.addContainerProvider( new XWorkConfigurationProvider() );\n+            com.opensymphony.xwork2.config.Configuration config = configurationManager.getConfiguration();\n+            Container container = config.getContainer();\n+    \n+            ValueStack stack = container.getInstance( ValueStackFactory.class ).createValueStack();\n+            stack.getContext().put( ActionContext.CONTAINER, container );\n+            ActionContext.setContext( new ActionContext( stack.getContext() ) );\n+        }\n+\n         boolean checkProtocol = true;\n \n         if ( !StringUtils.isEmpty( pomUrl ) )",
                "deletions": 0
            },
            {
                "sha": "d63e4de73b9b82997d232101405532b1d50a5cc5",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/6020ef74a6d42be5b5de3f45ca32c3acdb6975f2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/6020ef74a6d42be5b5de3f45ca32c3acdb6975f2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "status": "modified",
                "changes": 27,
                "additions": 27,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java?ref=6020ef74a6d42be5b5de3f45ca32c3acdb6975f2",
                "patch": "@@ -38,6 +38,13 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n+import com.opensymphony.xwork2.ActionContext;\n+import com.opensymphony.xwork2.config.ConfigurationManager;\n+import com.opensymphony.xwork2.config.providers.XWorkConfigurationProvider;\n+import com.opensymphony.xwork2.inject.Container;\n+import com.opensymphony.xwork2.util.ValueStack;\n+import com.opensymphony.xwork2.util.ValueStackFactory;\n+\n /**\n  * @author Nick Gonzalez\n  * @version $Id$\n@@ -92,6 +99,8 @@\n     public void validate()\n     {\n         clearErrorsAndMessages();\n+        initializeActionContext();\n+        \n         try\n         {\n             if ( ( projectName != null ) && !( projectName.trim().length() > 0 ) )\n@@ -254,6 +263,24 @@ private void initializeProjectGroupName()\n         }\n     }\n \n+    private void initializeActionContext()\n+    {\n+        // ctan: hack for WW-3161\n+        if ( ActionContext.getContext() == null )\n+        {\n+            // This fix allow initialization of ActionContext.getContext() to avoid NPE\n+\n+            ConfigurationManager configurationManager = new ConfigurationManager();\n+            configurationManager.addContainerProvider( new XWorkConfigurationProvider() );\n+            com.opensymphony.xwork2.config.Configuration config = configurationManager.getConfiguration();\n+            Container container = config.getContainer();\n+    \n+            ValueStack stack = container.getInstance( ValueStackFactory.class ).createValueStack();\n+            stack.getContext().put( ActionContext.CONTAINER, container );\n+            ActionContext.setContext( new ActionContext( stack.getContext() ) );\n+        }\n+    }\n+\n     public String getProjectName()\n     {\n         return projectName;",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "prevent NPE when build result or project is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@954720 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/7ec08a786a1517ae889ea5e5df2857c47b0defce",
        "parent": "https://github.com/apache/continuum/commit/11898fcbe925820547cea78f93ee55773f97e976",
        "bug_id": "continuum_16",
        "file": [
            {
                "sha": "0e3e43b16be196164ae1b8fa08d2aa9f953dc60c",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/7ec08a786a1517ae889ea5e5df2857c47b0defce/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/7ec08a786a1517ae889ea5e5df2857c47b0defce/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java",
                "status": "modified",
                "changes": 13,
                "additions": 11,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifier.java?ref=7ec08a786a1517ae889ea5e5df2857c47b0defce",
                "patch": "@@ -251,8 +251,17 @@ public void sendMessage( String messageId, MessageContext context )\n         Project project = context.getProject();\n         List<ProjectNotifier> notifiers = context.getNotifiers();\n         BuildResult build = context.getBuildResult();\n-        log.error( \"br state=\"+build.getState() );\n-        log.error( \"project state=\"+project.getState() );\n+\n+        if ( build != null )\n+        {\n+            log.error( \"br state=\"+build.getState() );\n+        }\n+\n+        if ( project != null )\n+        {\n+            log.error( \"project state=\"+project.getState() );\n+        }\n+\n         BuildDefinition buildDefinition = context.getBuildDefinition();\n         ProjectScmRoot projectScmRoot = context.getProjectScmRoot();\n ",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "prevent NPE when no build agent is configured\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@933469 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/25d29887ce4425feaf9a9e34d6dec31d0a83110c",
        "parent": "https://github.com/apache/continuum/commit/713871418757e4a42255ed5a1442251eb4e0dbd7",
        "bug_id": "continuum_17",
        "file": [
            {
                "sha": "8efae1ebe3c0ccd3ed80ba5b20906ab8f55f88da",
                "filename": "continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/25d29887ce4425feaf9a9e34d6dec31d0a83110c/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/25d29887ce4425feaf9a9e34d6dec31d0a83110c/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java?ref=25d29887ce4425feaf9a9e34d6dec31d0a83110c",
                "patch": "@@ -123,7 +123,7 @@ public void initialize()\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n \n-        if ( agents != null )\n+        if ( !agents.isEmpty() )\n         {\n             synchronized( overallDistributedBuildQueues )\n             {\n@@ -173,7 +173,7 @@ public void reload()\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n \n-        if ( agents != null )\n+        if ( agents.isEmpty() )\n         {\n             return;\n         }",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "prevent NPE when no build agent is configured\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@933461 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/713871418757e4a42255ed5a1442251eb4e0dbd7",
        "parent": "https://github.com/apache/continuum/commit/694d881d7ac74cd211e9d66d91afb53d882b3f76",
        "bug_id": "continuum_18",
        "file": [
            {
                "sha": "764ee86f3e65b0a34bd833bb3b7ed70139294b5a",
                "filename": "continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/713871418757e4a42255ed5a1442251eb4e0dbd7/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/713871418757e4a42255ed5a1442251eb4e0dbd7/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java?ref=713871418757e4a42255ed5a1442251eb4e0dbd7",
                "patch": "@@ -173,6 +173,11 @@ public void reload()\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n \n+        if ( agents != null )\n+        {\n+            return;\n+        }\n+\n         synchronized( overallDistributedBuildQueues )\n         {\n             for ( BuildAgentConfiguration agent : agents )",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2419] added check if map contains key to prevent NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@897759 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/8a8b91f0b3ae8717c51eeb58ae5a2d0b614a76d3",
        "parent": "https://github.com/apache/continuum/commit/7d69de49203ba1c30ba16effe3949997778a7e64",
        "bug_id": "continuum_19",
        "file": [
            {
                "sha": "9c805ac5c9cbbb53be4d8e895a31d958f6252d70",
                "filename": "continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/8a8b91f0b3ae8717c51eeb58ae5a2d0b614a76d3/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/8a8b91f0b3ae8717c51eeb58ae5a2d0b614a76d3/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java?ref=8a8b91f0b3ae8717c51eeb58ae5a2d0b614a76d3",
                "patch": "@@ -142,6 +142,11 @@ public void executeTask( Task task )\n \n             for ( Project project : sortedProjects )\n             {\n+                if ( !projectsAndBuildDefinitions.containsKey( project.getId() ) )\n+                {\n+                    continue;\n+                }\n+\n                 int buildDefinitionId = projectsAndBuildDefinitions.get( project.getId() );\n                 BuildDefinition buildDef = buildDefinitionDao.getBuildDefinition( buildDefinitionId );\n                 BuildResult buildResult = buildResultDao.getLatestBuildResultForProject( project.getId() );",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "more java5 + license + format + some potential NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@751864 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/01281c88543b3bae3de371a0313638feb25126ff",
        "parent": "https://github.com/apache/continuum/commit/390ea968d05f278f42fe4510a7fffa867d3e024d",
        "bug_id": "continuum_20",
        "file": [
            {
                "sha": "14b605006e446b03036d4c6fd486734a23e148c3",
                "filename": "continuum-api/src/main/java/org/apache/continuum/dao/DaoUtils.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/dao/DaoUtils.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/dao/DaoUtils.java",
                "status": "modified",
                "changes": 1,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-api/src/main/java/org/apache/continuum/dao/DaoUtils.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -21,7 +21,6 @@\n \n import org.apache.maven.continuum.store.ContinuumStoreException;\n \n-import javax.jdo.PersistenceManagerFactory;\n import java.util.Map;\n \n /**",
                "deletions": 1
            },
            {
                "sha": "af1efcfde002be6e642752bfb35b9584fc2a4677",
                "filename": "continuum-api/src/main/java/org/apache/continuum/taskqueue/PrepareBuildProjectsTask.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/taskqueue/PrepareBuildProjectsTask.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/taskqueue/PrepareBuildProjectsTask.java",
                "status": "modified",
                "changes": 32,
                "additions": 25,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-api/src/main/java/org/apache/continuum/taskqueue/PrepareBuildProjectsTask.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -1,5 +1,24 @@\n package org.apache.continuum.taskqueue;\n \n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n import java.util.Map;\n \n import org.codehaus.plexus.taskqueue.Task;\n@@ -19,9 +38,8 @@\n \n     private int projectScmRootId;\n \n-    public PrepareBuildProjectsTask( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger,\n-                                     int projectGroupId, String projectGroupName, String scmRootAddress,\n-                                     int projectScmRootId )\n+    public PrepareBuildProjectsTask( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger, int projectGroupId,\n+                                     String projectGroupName, String scmRootAddress, int projectScmRootId )\n     {\n         this.projectsBuildDefinitionsMap = projectsBuildDefinitionsMap;\n         this.trigger = trigger;\n@@ -30,18 +48,18 @@ public PrepareBuildProjectsTask( Map<Integer, Integer> projectsBuildDefinitionsM\n         this.scmRootAddress = scmRootAddress;\n         this.projectScmRootId = projectScmRootId;\n     }\n-    \n+\n     public long getMaxExecutionTime()\n     {\n         // TODO Auto-generated method stub\n         return 0;\n     }\n-    \n+\n     public Map<Integer, Integer> getProjectsBuildDefinitionsMap()\n     {\n         return projectsBuildDefinitionsMap;\n     }\n-    \n+\n     public void setProjectsBuildDefinitionsMap( Map<Integer, Integer> projectsBuildDefinitionsMap )\n     {\n         this.projectsBuildDefinitionsMap = projectsBuildDefinitionsMap;\n@@ -56,7 +74,7 @@ public void setTrigger( int trigger )\n     {\n         this.trigger = trigger;\n     }\n-    \n+\n     public int getHashCode()\n     {\n         return this.hashCode();",
                "deletions": 7
            },
            {
                "sha": "35eb71d7ec79e308e122eac4bf6377e7b6a61b60",
                "filename": "continuum-api/src/main/java/org/apache/continuum/taskqueue/manager/TaskQueueManagerException.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/taskqueue/manager/TaskQueueManagerException.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/taskqueue/manager/TaskQueueManagerException.java",
                "status": "modified",
                "changes": 19,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-api/src/main/java/org/apache/continuum/taskqueue/manager/TaskQueueManagerException.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -1,5 +1,24 @@\n package org.apache.continuum.taskqueue.manager;\n \n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n public class TaskQueueManagerException\n     extends Exception\n {",
                "deletions": 0
            },
            {
                "sha": "49f86eaa8a177847cb5606fdf11d746b41e390de",
                "filename": "continuum-api/src/main/java/org/apache/continuum/utils/shell/DefaultShellCommandHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/utils/shell/DefaultShellCommandHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-api/src/main/java/org/apache/continuum/utils/shell/DefaultShellCommandHelper.java",
                "status": "modified",
                "changes": 41,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-api/src/main/java/org/apache/continuum/utils/shell/DefaultShellCommandHelper.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -69,7 +69,7 @@ public ExecutionResult executeShellCommand( File workingDirectory, String execut\n \n     /**\n      * Make the command line\n-     * \n+     *\n      * @param workingDirectory\n      * @param executable\n      * @param arguments\n@@ -90,9 +90,8 @@ protected Commandline createCommandline( File workingDirectory, String executabl\n \n         if ( environments != null && !environments.isEmpty() )\n         {\n-            for ( Iterator<String> iterator = environments.keySet().iterator(); iterator.hasNext(); )\n+            for ( String key : environments.keySet() )\n             {\n-                String key = iterator.next();\n                 String value = environments.get( key );\n                 cl.addEnvironment( key, value );\n             }\n@@ -106,10 +105,8 @@ protected Commandline createCommandline( File workingDirectory, String executabl\n \n         if ( arguments != null )\n         {\n-            for ( int i = 0; i < arguments.length; i++ )\n+            for ( String argument : arguments )\n             {\n-                String argument = arguments[i];\n-\n                 cl.createArgument().setValue( argument );\n             }\n         }\n@@ -161,8 +158,8 @@ public void killProcess( long idCommand )\n         CommandLineUtils.killProcess( idCommand );\n     }\n \n-    public void executeGoals( File workingDirectory, String executable, String goals, boolean interactive, String arguments,\n-                              ReleaseResult relResult, Map<String, String> environments )\n+    public void executeGoals( File workingDirectory, String executable, String goals, boolean interactive,\n+                              String arguments, ReleaseResult relResult, Map<String, String> environments )\n         throws Exception\n     {\n         Commandline cl = new Commandline();\n@@ -174,8 +171,8 @@ public void executeGoals( File workingDirectory, String executable, String goals\n         executeGoals( workingDirectory, executable, goals, interactive, argument.getParts(), relResult, environments );\n     }\n \n-    public void executeGoals( File workingDirectory, String executable, String goals, boolean interactive, String[] arguments,\n-                              ReleaseResult relResult, Map<String, String> environments )\n+    public void executeGoals( File workingDirectory, String executable, String goals, boolean interactive,\n+                              String[] arguments, ReleaseResult relResult, Map<String, String> environments )\n         throws Exception\n     {\n         if ( executable == null )\n@@ -190,10 +187,10 @@ public void executeGoals( File workingDirectory, String executable, String goals\n             // accept both space and comma, so the old way still work\n             String[] tokens = StringUtils.split( goals, \", \" );\n \n-            for ( int i = 0; i < tokens.length; ++i )\n-    \t\t{\n-                cl.createArgument().setValue( tokens[i] );\n-    \t\t}\n+            for ( String token : tokens )\n+            {\n+                cl.createArgument().setValue( token );\n+            }\n         }\n \n         cl.createArgument().setValue( \"--no-plugin-updates\" );\n@@ -209,16 +206,16 @@ public void executeGoals( File workingDirectory, String executable, String goals\n \n         try\n         {\n-    \t\trelResult.appendInfo( \"Executing: \" + cl.toString() );\n-    \t\tlog.info( \"Executing: \" + cl.toString() );\n+            relResult.appendInfo( \"Executing: \" + cl.toString() );\n+            log.info( \"Executing: \" + cl.toString() );\n \n-    \t\tint result = CommandLineUtils.executeCommandLine( cl, stdOut, stdErr );\n+            int result = CommandLineUtils.executeCommandLine( cl, stdOut, stdErr );\n \n-    \t\tif ( result != 0 )\n-    \t\t{\n-    \t\t    throw new MavenExecutorException( \"Maven execution failed, exit code: \\'\" + result + \"\\'\", result,\n-    \t\t                                      stdOut.toString(), stdErr.toString() );\n-    \t\t}\n+            if ( result != 0 )\n+            {\n+                throw new MavenExecutorException( \"Maven execution failed, exit code: \\'\" + result + \"\\'\", result,\n+                                                  stdOut.toString(), stdErr.toString() );\n+            }\n         }\n         catch ( CommandLineException e )\n         {",
                "deletions": 22
            },
            {
                "sha": "208c6b507f484640ebe4161c6baa0b53efb6cf2a",
                "filename": "continuum-base/continuum-configuration/src/main/java/org/apache/continuum/configuration/DefaultContinuumConfiguration.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-base/continuum-configuration/src/main/java/org/apache/continuum/configuration/DefaultContinuumConfiguration.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-base/continuum-configuration/src/main/java/org/apache/continuum/configuration/DefaultContinuumConfiguration.java",
                "status": "modified",
                "changes": 108,
                "additions": 54,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-base/continuum-configuration/src/main/java/org/apache/continuum/configuration/DefaultContinuumConfiguration.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -31,7 +31,6 @@\n import org.apache.continuum.configuration.model.ContinuumConfigurationModel;\n import org.apache.continuum.configuration.model.io.xpp3.ContinuumConfigurationModelXpp3Reader;\n import org.apache.continuum.configuration.model.io.xpp3.ContinuumConfigurationModelXpp3Writer;\n-import org.codehaus.plexus.util.ReaderFactory;\n import org.codehaus.plexus.util.xml.pull.XmlPullParserException;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -92,7 +91,7 @@ public void save()\n     {\n         if ( !configurationFile.exists() )\n         {\n-            configurationFile.getParentFile().mkdir();\n+            configurationFile.getParentFile().mkdirs();\n         }\n         save( configurationFile );\n     }\n@@ -111,15 +110,15 @@ public void setGeneralConfiguration( GeneralConfiguration generalConfiguration )\n     {\n         this.generalConfiguration = generalConfiguration;\n     }\n-    \n+\n     public void reload( File file )\n         throws ContinuumConfigurationException\n     {\n         try\n         {\n             ContinuumConfigurationModelXpp3Reader configurationXpp3Reader = new ContinuumConfigurationModelXpp3Reader();\n-            ContinuumConfigurationModel configuration = configurationXpp3Reader\n-                .read( new InputStreamReader( new FileInputStream( file ) ) );\n+            ContinuumConfigurationModel configuration =\n+                configurationXpp3Reader.read( new InputStreamReader( new FileInputStream( file ) ) );\n \n             this.generalConfiguration = new GeneralConfiguration();\n \n@@ -128,14 +127,14 @@ public void reload( File file )\n             if ( StringUtils.isNotEmpty( configuration.getBuildOutputDirectory() ) )\n             {\n                 // TODO take care if file exists ?\n-                this.generalConfiguration.setBuildOutputDirectory( new File( configuration\n-                    .getBuildOutputDirectory() ) );\n+                this.generalConfiguration.setBuildOutputDirectory(\n+                    new File( configuration.getBuildOutputDirectory() ) );\n             }\n             if ( StringUtils.isNotEmpty( configuration.getDeploymentRepositoryDirectory() ) )\n             {\n                 // TODO take care if file exists ?\n-                this.generalConfiguration.setDeploymentRepositoryDirectory( new File( configuration\n-                    .getDeploymentRepositoryDirectory() ) );\n+                this.generalConfiguration.setDeploymentRepositoryDirectory(\n+                    new File( configuration.getDeploymentRepositoryDirectory() ) );\n             }\n             if ( StringUtils.isNotEmpty( configuration.getWorkingDirectory() ) )\n             {\n@@ -144,51 +143,55 @@ public void reload( File file )\n             }\n             if ( configuration.getProxyConfiguration() != null )\n             {\n-                ProxyConfiguration proxyConfiguration = new ProxyConfiguration( configuration\n-                    .getProxyConfiguration().getProxyHost(), configuration.getProxyConfiguration()\n-                    .getProxyPassword(), configuration.getProxyConfiguration().getProxyPort(), configuration\n-                    .getProxyConfiguration().getProxyUser() );\n+                ProxyConfiguration proxyConfiguration =\n+                    new ProxyConfiguration( configuration.getProxyConfiguration().getProxyHost(),\n+                                            configuration.getProxyConfiguration().getProxyPassword(),\n+                                            configuration.getProxyConfiguration().getProxyPort(),\n+                                            configuration.getProxyConfiguration().getProxyUser() );\n                 this.generalConfiguration.setProxyConfiguration( proxyConfiguration );\n             }\n             if ( StringUtils.isNotEmpty( configuration.getReleaseOutputDirectory() ) )\n             {\n                 // TODO take care if file exists?\n-                this.generalConfiguration.setReleaseOutputDirectory( new File( configuration\n-                    .getReleaseOutputDirectory() ) );\n+                this.generalConfiguration.setReleaseOutputDirectory(\n+                    new File( configuration.getReleaseOutputDirectory() ) );\n             }\n             if ( configuration.getBuildAgents() != null )\n             {\n                 List<BuildAgentConfiguration> buildAgents = new ArrayList<BuildAgentConfiguration>();\n \n-                List<org.apache.continuum.configuration.model.BuildAgentConfiguration> agents = configuration.getBuildAgents();\n+                List<org.apache.continuum.configuration.model.BuildAgentConfiguration> agents =\n+                    configuration.getBuildAgents();\n                 for ( org.apache.continuum.configuration.model.BuildAgentConfiguration agent : agents )\n                 {\n-                    BuildAgentConfiguration buildAgent = new BuildAgentConfiguration( agent.getUrl(),\n-                                                                                      agent.getDescription(),\n-                                                                                      agent.isEnabled() );\n+                    BuildAgentConfiguration buildAgent =\n+                        new BuildAgentConfiguration( agent.getUrl(), agent.getDescription(), agent.isEnabled() );\n                     buildAgents.add( buildAgent );\n                 }\n-                \n+\n                 this.generalConfiguration.setBuildAgents( buildAgents );\n             }\n             if ( configuration.getBuildAgentGroups() != null )\n             {\n                 List<BuildAgentGroupConfiguration> buildAgentGroups = new ArrayList<BuildAgentGroupConfiguration>();\n-                List<org.apache.continuum.configuration.model.BuildAgentGroupConfiguration> groups = configuration.getBuildAgentGroups();\n-                \n+                List<org.apache.continuum.configuration.model.BuildAgentGroupConfiguration> groups =\n+                    configuration.getBuildAgentGroups();\n+\n                 for ( org.apache.continuum.configuration.model.BuildAgentGroupConfiguration group : groups )\n                 {\n-                    List <BuildAgentConfiguration> agents = new ArrayList<BuildAgentConfiguration>();\n-                    List<org.apache.continuum.configuration.model.BuildAgentConfiguration> modelAgents =  group.getBuildAgents();                   \n+                    List<BuildAgentConfiguration> agents = new ArrayList<BuildAgentConfiguration>();\n+                    List<org.apache.continuum.configuration.model.BuildAgentConfiguration> modelAgents =\n+                        group.getBuildAgents();\n                     for ( org.apache.continuum.configuration.model.BuildAgentConfiguration modelAgent : modelAgents )\n                     {\n-                        BuildAgentConfiguration buildAgent = new BuildAgentConfiguration( modelAgent.getUrl(),\n-                                                                                          modelAgent.getDescription(),\n-                                                                                          modelAgent.isEnabled() ) ;\n+                        BuildAgentConfiguration buildAgent =\n+                            new BuildAgentConfiguration( modelAgent.getUrl(), modelAgent.getDescription(),\n+                                                         modelAgent.isEnabled() );\n                         agents.add( buildAgent );\n                     }\n \n-                    BuildAgentGroupConfiguration groupAgent = new BuildAgentGroupConfiguration( group.getName(),agents );\n+                    BuildAgentGroupConfiguration groupAgent =\n+                        new BuildAgentGroupConfiguration( group.getName(), agents );\n                     buildAgentGroups.add( groupAgent );\n                 }\n \n@@ -205,7 +208,7 @@ public void reload( File file )\n             log.error( e.getMessage(), e );\n             throw new RuntimeException( e.getMessage(), e );\n         }\n-        \n+\n     }\n \n     public void save( File file )\n@@ -220,68 +223,66 @@ public void save( File file )\n             // normally not null but NPE free is better !\n             if ( this.generalConfiguration.getBuildOutputDirectory() != null )\n             {\n-                configurationModel.setBuildOutputDirectory( this.generalConfiguration.getBuildOutputDirectory()\n-                    .getPath() );\n+                configurationModel.setBuildOutputDirectory(\n+                    this.generalConfiguration.getBuildOutputDirectory().getPath() );\n             }\n             if ( this.generalConfiguration.getWorkingDirectory() != null )\n             {\n                 configurationModel.setWorkingDirectory( this.generalConfiguration.getWorkingDirectory().getPath() );\n             }\n             if ( this.generalConfiguration.getDeploymentRepositoryDirectory() != null )\n             {\n-                configurationModel.setDeploymentRepositoryDirectory( this.generalConfiguration\n-                    .getDeploymentRepositoryDirectory().getPath() );\n+                configurationModel.setDeploymentRepositoryDirectory(\n+                    this.generalConfiguration.getDeploymentRepositoryDirectory().getPath() );\n             }\n             if ( this.generalConfiguration.getProxyConfiguration() != null )\n             {\n-                configurationModel\n-                    .setProxyConfiguration( new org.apache.continuum.configuration.model.ProxyConfiguration() );\n+                configurationModel.setProxyConfiguration(\n+                    new org.apache.continuum.configuration.model.ProxyConfiguration() );\n                 configurationModel.getProxyConfiguration().setProxyHost(\n-                                                                         this.generalConfiguration\n-                                                                             .getProxyConfiguration().getProxyHost() );\n+                    this.generalConfiguration.getProxyConfiguration().getProxyHost() );\n                 configurationModel.getProxyConfiguration().setProxyPassword(\n-                                                                             this.generalConfiguration\n-                                                                                 .getProxyConfiguration()\n-                                                                                 .getProxyPassword() );\n+                    this.generalConfiguration.getProxyConfiguration().getProxyPassword() );\n                 configurationModel.getProxyConfiguration().setProxyPort(\n-                                                                         this.generalConfiguration\n-                                                                             .getProxyConfiguration().getProxyPort() );\n+                    this.generalConfiguration.getProxyConfiguration().getProxyPort() );\n                 configurationModel.getProxyConfiguration().setProxyHost(\n-                                                                         this.generalConfiguration\n-                                                                             .getProxyConfiguration().getProxyHost() );\n+                    this.generalConfiguration.getProxyConfiguration().getProxyHost() );\n             }\n             if ( this.generalConfiguration.getReleaseOutputDirectory() != null )\n             {\n-                configurationModel.setReleaseOutputDirectory( this.generalConfiguration.getReleaseOutputDirectory()\n-                    .getPath() );\n+                configurationModel.setReleaseOutputDirectory(\n+                    this.generalConfiguration.getReleaseOutputDirectory().getPath() );\n             }\n             if ( this.generalConfiguration.getBuildAgents() != null )\n             {\n-                List buildAgents = new ArrayList();\n+                List<org.apache.continuum.configuration.model.BuildAgentConfiguration> buildAgents =\n+                    new ArrayList<org.apache.continuum.configuration.model.BuildAgentConfiguration>();\n \n                 for ( BuildAgentConfiguration agent : this.generalConfiguration.getBuildAgents() )\n                 {\n-                    org.apache.continuum.configuration.model.BuildAgentConfiguration buildAgent = \n+                    org.apache.continuum.configuration.model.BuildAgentConfiguration buildAgent =\n                         new org.apache.continuum.configuration.model.BuildAgentConfiguration();\n                     buildAgent.setUrl( agent.getUrl() );\n                     buildAgent.setDescription( agent.getDescription() );\n                     buildAgent.setEnabled( agent.isEnabled() );\n-                    \n+\n                     buildAgents.add( buildAgent );\n                 }\n                 configurationModel.setBuildAgents( buildAgents );\n             }\n             if ( this.generalConfiguration.getBuildAgentGroups() != null )\n             {\n-                List buildAgentGroups = new ArrayList();\n+                List<org.apache.continuum.configuration.model.BuildAgentGroupConfiguration> buildAgentGroups =\n+                    new ArrayList<org.apache.continuum.configuration.model.BuildAgentGroupConfiguration>();\n \n                 for ( BuildAgentGroupConfiguration group : this.generalConfiguration.getBuildAgentGroups() )\n                 {\n                     org.apache.continuum.configuration.model.BuildAgentGroupConfiguration buildAgentGroup =\n                         new org.apache.continuum.configuration.model.BuildAgentGroupConfiguration();\n                     buildAgentGroup.setName( group.getName() );\n \n-                    List buildAgents = new ArrayList();\n+                    List<org.apache.continuum.configuration.model.BuildAgentConfiguration> buildAgents =\n+                        new ArrayList<org.apache.continuum.configuration.model.BuildAgentConfiguration>();\n \n                     if ( group.getBuildAgents() != null )\n                     {\n@@ -312,10 +313,9 @@ public void save( File file )\n         {\n             throw new ContinuumConfigurationException( e.getMessage(), e );\n         }\n-        \n+\n     }\n \n-    \n     // ----------------------------------------\n     //  Spring injection\n     // ----------------------------------------\n@@ -330,5 +330,5 @@ public void setConfigurationFile( File configurationFile )\n     {\n         this.configurationFile = configurationFile;\n     }\n-    \n+\n }",
                "deletions": 54
            },
            {
                "sha": "6f1cdfe1a61fbd9ebd7e6dd9f3c70837ec49f66a",
                "filename": "continuum-base/continuum-configuration/src/test/java/org/apache/continuum/configuration/TestDefaultContinuumConfiguration.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-base/continuum-configuration/src/test/java/org/apache/continuum/configuration/TestDefaultContinuumConfiguration.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-base/continuum-configuration/src/test/java/org/apache/continuum/configuration/TestDefaultContinuumConfiguration.java",
                "status": "modified",
                "changes": 50,
                "additions": 29,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-base/continuum-configuration/src/test/java/org/apache/continuum/configuration/TestDefaultContinuumConfiguration.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -45,16 +45,16 @@ protected void setUp()\n         throws Exception\n     {\n         log.info( \"appserver.base : \" + System.getProperty( \"appserver.base\" ) );\n-        \n+\n         File originalConf = new File( getBasedir(), \"src/test/resources/conf/continuum.xml\" );\n-        \n+\n         File confUsed = new File( getBasedir(), confFile );\n         if ( confUsed.exists() )\n         {\n             confUsed.delete();\n         }\n         FileUtils.copyFile( originalConf, confUsed );\n-        \n+\n         super.setUp();\n     }\n \n@@ -70,17 +70,17 @@ public void testLoad()\n         assertEquals( \"http://test\", generalConfiguration.getBaseUrl() );\n         assertEquals( new File( \"myBuildOutputDir\" ), generalConfiguration.getBuildOutputDirectory() );\n         assertNotNull( generalConfiguration.getBuildAgents() );\n-        org.apache.continuum.configuration.BuildAgentConfiguration buildAgentConfig = generalConfiguration.getBuildAgents().get( 0 );\n+        org.apache.continuum.configuration.BuildAgentConfiguration buildAgentConfig =\n+            generalConfiguration.getBuildAgents().get( 0 );\n         assertEquals( \"http://buildagent/xmlrpc\", buildAgentConfig.getUrl() );\n         assertEquals( \"linux\", buildAgentConfig.getDescription() );\n         assertTrue( buildAgentConfig.isEnabled() );\n \n         // agent group tests        \n         assertNotNull( \"agent group\", generalConfiguration.getBuildAgentGroups() );\n-        BuildAgentGroupConfiguration buildAgentGroupConfig =\n-            generalConfiguration.getBuildAgentGroups().get( 0 );\n-        assertEquals(\"group-agent-1\", buildAgentGroupConfig.getName() );        \n-        BuildAgentConfiguration agentConfig = (BuildAgentConfiguration) buildAgentGroupConfig.getBuildAgents().get( 0 );\n+        BuildAgentGroupConfiguration buildAgentGroupConfig = generalConfiguration.getBuildAgentGroups().get( 0 );\n+        assertEquals( \"group-agent-1\", buildAgentGroupConfig.getName() );\n+        BuildAgentConfiguration agentConfig = buildAgentGroupConfig.getBuildAgents().get( 0 );\n         assertEquals( \"http://buildagent/xmlrpc\", agentConfig.getUrl() );\n         assertEquals( \"linux\", agentConfig.getDescription() );\n     }\n@@ -101,7 +101,7 @@ public void testDefaultConfiguration()\n         generalConfiguration.setProxyConfiguration( new ProxyConfiguration() );\n         generalConfiguration.getProxyConfiguration().setProxyHost( \"localhost\" );\n         generalConfiguration.getProxyConfiguration().setProxyPort( 8080 );\n-        File targetDir = new File(getBasedir(), \"target\");\n+        File targetDir = new File( getBasedir(), \"target\" );\n         generalConfiguration.setBuildOutputDirectory( targetDir );\n         BuildAgentConfiguration buildAgentConfiguration = new BuildAgentConfiguration();\n         buildAgentConfiguration.setUrl( \"http://buildagent/test\" );\n@@ -117,7 +117,7 @@ public void testDefaultConfiguration()\n         buildAgents.add( buildAgentConfiguration );\n         buildAgents.add( buildAgentConfiguration2 );\n         BuildAgentGroupConfiguration buildAgentGroupConfiguration = new BuildAgentGroupConfiguration();\n-        buildAgentGroupConfiguration.setName( \"secret-agent\" );        \n+        buildAgentGroupConfiguration.setName( \"secret-agent\" );\n         buildAgentGroupConfiguration.setBuildAgents( buildAgents );\n \n         List<BuildAgentGroupConfiguration> buildAgentGroups = new ArrayList<BuildAgentGroupConfiguration>();\n@@ -134,23 +134,31 @@ public void testDefaultConfiguration()\n         assertTrue( contents.indexOf( \"8080\" ) > 0 );\n         assertTrue( contents.indexOf( \"http://buildagent/test\" ) > 0 );\n         assertTrue( contents.indexOf( \"windows xp\" ) > 0 );\n-        assertTrue( contents.indexOf( \"http://buildagent-node-2/test\" )> 0);\n-        assertTrue( contents.indexOf( \"linux\" )> 0);\n-        assertTrue( contents.indexOf( \"secret-agent\" )> 0);       \n+        assertTrue( contents.indexOf( \"http://buildagent-node-2/test\" ) > 0 );\n+        assertTrue( contents.indexOf( \"linux\" ) > 0 );\n+        assertTrue( contents.indexOf( \"secret-agent\" ) > 0 );\n \n         configuration.reload();\n         assertEquals( \"http://test/zloug\", configuration.getGeneralConfiguration().getBaseUrl() );\n         assertEquals( \"localhost\", configuration.getGeneralConfiguration().getProxyConfiguration().getProxyHost() );\n         assertEquals( 8080, configuration.getGeneralConfiguration().getProxyConfiguration().getProxyPort() );\n-        assertEquals(targetDir.getPath(), configuration.getGeneralConfiguration().getBuildOutputDirectory().getPath());\n-        assertEquals( \"http://buildagent/test\", configuration.getGeneralConfiguration().getBuildAgents().get( 0 ).getUrl() );        \n+        assertEquals( targetDir.getPath(),\n+                      configuration.getGeneralConfiguration().getBuildOutputDirectory().getPath() );\n+        assertEquals( \"http://buildagent/test\",\n+                      configuration.getGeneralConfiguration().getBuildAgents().get( 0 ).getUrl() );\n         assertFalse( configuration.getGeneralConfiguration().getBuildAgents().get( 0 ).isEnabled() );\n-        assertEquals( \"http://buildagent-node-2/test\", configuration.getGeneralConfiguration().getBuildAgents().get( 1 ).getUrl() );\n-        assertTrue(configuration.getGeneralConfiguration().getBuildAgents().get( 1 ).isEnabled());\n-\n-        assertEquals(\"secret-agent\", configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getName());\n-        assertEquals(\"http://buildagent/test\",configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getUrl() );\n-        assertEquals(\"http://buildagent-node-2/test\",configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).getUrl() );\n+        assertEquals( \"http://buildagent-node-2/test\",\n+                      configuration.getGeneralConfiguration().getBuildAgents().get( 1 ).getUrl() );\n+        assertTrue( configuration.getGeneralConfiguration().getBuildAgents().get( 1 ).isEnabled() );\n+\n+        assertEquals( \"secret-agent\",\n+                      configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getName() );\n+        assertEquals( \"http://buildagent/test\",\n+                      configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getBuildAgents().get(\n+                          0 ).getUrl() );\n+        assertEquals( \"http://buildagent-node-2/test\",\n+                      configuration.getGeneralConfiguration().getBuildAgentGroups().get( 0 ).getBuildAgents().get(\n+                          1 ).getUrl() );\n         log.info( \"generalConfiguration \" + configuration.getGeneralConfiguration().toString() );\n     }\n }",
                "deletions": 21
            },
            {
                "sha": "c501c390882f865040031f9afad948601de0f025",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckWorkingDirectoryAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckWorkingDirectoryAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckWorkingDirectoryAction.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckWorkingDirectoryAction.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -37,7 +37,7 @@\n      * @plexus.requirement\n      */\n     BuildAgentConfigurationService buildAgentConfigurationService;\n-    \n+\n     public void execute( Map context )\n         throws Exception\n     {\n@@ -54,7 +54,7 @@ public void execute( Map context )\n \n         File[] files = workingDirectory.listFiles();\n \n-        context.put( ContinuumBuildAgentUtil.KEY_WORKING_DIRECTORY_EXISTS, Boolean.valueOf( files.length > 0 ) );\n+        context.put( ContinuumBuildAgentUtil.KEY_WORKING_DIRECTORY_EXISTS, files.length > 0 );\n     }\n \n }",
                "deletions": 2
            },
            {
                "sha": "a76c439a5baeec6ed9bbfc51f2e71d4cd6762bd6",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckoutProjectAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckoutProjectAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckoutProjectAction.java",
                "status": "modified",
                "changes": 13,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/action/CheckoutProjectAction.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -69,15 +69,18 @@ public void execute( Map context )\n \n         try\n         {\n-            String scmUserName = ContinuumBuildAgentUtil.getString( context, ContinuumBuildAgentUtil.KEY_SCM_USERNAME, \"\" );\n-            String scmPassword = ContinuumBuildAgentUtil.getString( context, ContinuumBuildAgentUtil.KEY_SCM_PASSWORD, \"\" );\n+            String scmUserName =\n+                ContinuumBuildAgentUtil.getString( context, ContinuumBuildAgentUtil.KEY_SCM_USERNAME, \"\" );\n+            String scmPassword =\n+                ContinuumBuildAgentUtil.getString( context, ContinuumBuildAgentUtil.KEY_SCM_PASSWORD, \"\" );\n \n             ContinuumScmConfiguration config =\n                 createScmConfiguration( project, workingDirectory, scmUserName, scmPassword );\n \n             String tag = config.getTag();\n-            getLogger().info( \"Checking out project: '\" + project.getName() + \"', id: '\" + project.getId() + \"' \" +\n-                \"to '\" + workingDirectory + \"'\" + ( tag != null ? \" with branch/tag \" + tag + \".\" : \".\" ) );\n+            getLogger().info(\n+                \"Checking out project: '\" + project.getName() + \"', id: '\" + project.getId() + \"' \" + \"to '\" +\n+                    workingDirectory + \"'\" + ( tag != null ? \" with branch/tag \" + tag + \".\" : \".\" ) );\n \n             CheckOutScmResult checkoutResult = scm.checkout( config );\n             //if ( StringUtils.isNotEmpty( checkoutResult.getRelativePathProjectDirectory() ) )\n@@ -213,7 +216,7 @@ private String getValidationMessages( ScmRepositoryException ex )\n         {\n             for ( Iterator<String> i = messages.iterator(); i.hasNext(); )\n             {\n-                message.append( (String) i.next() );\n+                message.append( i.next() );\n \n                 if ( i.hasNext() )\n                 {",
                "deletions": 5
            },
            {
                "sha": "23d306dae9a7dbd12466f64e3b76feb1fc464ea5",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "status": "modified",
                "changes": 60,
                "additions": 31,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -197,8 +197,8 @@ public void initialize()\n      * @param defaultExecutable\n      * @return The executable path\n      */\n-    protected String findExecutable( Project project, String executable, String defaultExecutable,\n-                                     boolean resolveExecutable, File workingDirectory )\n+    protected String findExecutable( String executable, String defaultExecutable, boolean resolveExecutable,\n+                                     File workingDirectory )\n     {\n         // ----------------------------------------------------------------------\n         // If we're not searching the path for the executable, prefix the\n@@ -225,11 +225,11 @@ protected String findExecutable( Project project, String executable, String defa\n \n             if ( e == null )\n             {\n-                log.warn( \"Could not find the executable '\" + executable + \"' in this path: \" );\n+                log.debug( \"Could not find the executable '\" + executable + \"' in this path: \" );\n \n                 for ( String element : path )\n                 {\n-                    log.warn( element );\n+                    log.debug( element );\n                 }\n \n                 actualExecutable = defaultExecutable;\n@@ -251,25 +251,25 @@ protected String findExecutable( Project project, String executable, String defa\n         return actualExecutable;\n     }\n \n-    protected ContinuumAgentBuildExecutionResult executeShellCommand( Project project, String executable, String arguments,\n-                                                                 File output, Map<String, String> environments )\n+    protected ContinuumAgentBuildExecutionResult executeShellCommand( Project project, String executable,\n+                                                                      String arguments, File output,\n+                                                                      Map<String, String> environments )\n         throws ContinuumAgentBuildExecutorException, ContinuumAgentBuildCancelledException\n     {\n \n         File workingDirectory = getWorkingDirectory( project.getId() );\n \n-        String actualExecutable =\n-            findExecutable( project, executable, defaultExecutable, resolveExecutable, workingDirectory );\n+        String actualExecutable = findExecutable( executable, defaultExecutable, resolveExecutable, workingDirectory );\n \n         // ----------------------------------------------------------------------\n         // Execute the build\n         // ----------------------------------------------------------------------\n \n         try\n         {\n-            ExecutionResult result = getShellCommandHelper().executeShellCommand( workingDirectory, actualExecutable,\n-                                                                                  arguments, output, project.getId(),\n-                                                                                  environments );\n+            ExecutionResult result =\n+                getShellCommandHelper().executeShellCommand( workingDirectory, actualExecutable, arguments, output,\n+                                                             project.getId(), environments );\n \n             log.info( \"Exit code: \" + result.getExitCode() );\n \n@@ -290,8 +290,9 @@ protected ContinuumAgentBuildExecutionResult executeShellCommand( Project projec\n         }\n         catch ( Exception e )\n         {\n-            throw new ContinuumAgentBuildExecutorException( \"Error while executing shell command. \" +\n-                \"The most common error is that '\" + executable + \"' \" + \"is not in your path.\", e );\n+            throw new ContinuumAgentBuildExecutorException(\n+                \"Error while executing shell command. \" + \"The most common error is that '\" + executable + \"' \" +\n+                    \"is not in your path.\", e );\n         }\n     }\n \n@@ -310,17 +311,15 @@ protected Properties getContinuumSystemProperties( Project project )\n \n     protected String getBuildFileForProject( BuildDefinition buildDefinition )\n     {\n-        String buildFile = StringUtils.clean( buildDefinition.getBuildFile() );\n-        \n-        return buildFile;\n+        return StringUtils.clean( buildDefinition.getBuildFile() );\n     }\n \n     protected void updateProject( Project project )\n         throws ContinuumAgentBuildExecutorException\n     {\n         Map projectMap = new HashMap();\n \n-        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, new Integer( project.getId() ) );\n+        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, project.getId() );\n         projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, project.getVersion() );\n         projectMap.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, project.getArtifactId() );\n         projectMap.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, project.getGroupId() );\n@@ -365,8 +364,10 @@ protected void updateProject( Project project )\n             projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_URL, \"\" );\n         }\n         projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_PARENT, getProjectParent( project.getParent() ) );\n-        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPERS, getProjectDevelopers( project.getDevelopers() ) );\n-        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEPENDENCIES, getProjectDependencies( project.getDependencies() ) );\n+        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPERS,\n+                        getProjectDevelopers( project.getDevelopers() ) );\n+        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEPENDENCIES,\n+                        getProjectDependencies( project.getDependencies() ) );\n         projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_NOTIFIERS, getProjectNotifiers( project.getNotifiers() ) );\n \n         try\n@@ -463,14 +464,14 @@ protected Map getProjectParent( ProjectDependency parent )\n                 {\n                     map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_TYPE, \"\" );\n                 }\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_FROM, new Integer( notifier.getFrom() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_RECIPIENT_TYPE, new Integer( notifier.getRecipientType() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_ENABLED, new Boolean( notifier.isEnabled() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_ERROR, new Boolean( notifier.isSendOnError() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_SUCCESS, new Boolean( notifier.isSendOnSuccess() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_FAILURE, new Boolean( notifier.isSendOnFailure() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_SCMFAILURE, new Boolean( notifier.isSendOnScmFailure() ) );\n-                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_WARNING, new Boolean( notifier.isSendOnWarning() ) );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_FROM, notifier.getFrom() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_RECIPIENT_TYPE, notifier.getRecipientType() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_ENABLED, notifier.isEnabled() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_ERROR, notifier.isSendOnError() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_SUCCESS, notifier.isSendOnSuccess() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_FAILURE, notifier.isSendOnFailure() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_SCMFAILURE, notifier.isSendOnScmFailure() );\n+                map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_SEND_ON_WARNING, notifier.isSendOnWarning() );\n             }\n         }\n         return pNotifiers;\n@@ -479,15 +480,16 @@ protected Map getProjectParent( ProjectDependency parent )\n     public boolean isBuilding( Project project )\n     {\n         return project.getState() == ContinuumProjectState.BUILDING ||\n-               getShellCommandHelper().isRunning( project.getId() );\n+            getShellCommandHelper().isRunning( project.getId() );\n     }\n \n     public void killProcess( Project project )\n     {\n         getShellCommandHelper().killProcess( project.getId() );\n     }\n \n-    public List<Artifact> getDeployableArtifacts( Project project, File workingDirectory, BuildDefinition buildDefinition )\n+    public List<Artifact> getDeployableArtifacts( Project project, File workingDirectory,\n+                                                  BuildDefinition buildDefinition )\n         throws ContinuumAgentBuildExecutorException\n     {\n         // Not supported by this builder",
                "deletions": 29
            },
            {
                "sha": "005b4e220456aca929d5f9c577b45a849bbd01e4",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/manager/DefaultBuildAgentBuildExecutorManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/manager/DefaultBuildAgentBuildExecutorManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/manager/DefaultBuildAgentBuildExecutorManager.java",
                "status": "modified",
                "changes": 11,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/manager/DefaultBuildAgentBuildExecutorManager.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -20,7 +20,6 @@\n  */\n \n import java.util.HashMap;\n-import java.util.Iterator;\n import java.util.Map;\n \n import org.apache.continuum.buildagent.build.execution.ContinuumAgentBuildExecutor;\n@@ -40,7 +39,7 @@\n     /**\n      * @plexus.requirement role=\"org.apache.continuum.buildagent.build.execution.ContinuumAgentBuildExecutor\"\n      */\n-    private Map executors;\n+    private Map<String, ContinuumAgentBuildExecutor> executors;\n \n     // ----------------------------------------------------------------------\n     // Component Lifecycle\n@@ -50,7 +49,7 @@ public void initialize()\n     {\n         if ( executors == null )\n         {\n-            executors = new HashMap();\n+            executors = new HashMap<String, ContinuumAgentBuildExecutor>();\n         }\n \n         if ( executors.size() == 0 )\n@@ -61,9 +60,9 @@ public void initialize()\n         {\n             log.info( \"Build executors:\" );\n \n-            for ( Iterator it = executors.keySet().iterator(); it.hasNext(); )\n+            for ( String key : executors.keySet() )\n             {\n-                log.info( \"  \" + it.next().toString() );\n+                log.info( \"  \" + key );\n             }\n         }\n     }\n@@ -75,7 +74,7 @@ public void initialize()\n     public ContinuumAgentBuildExecutor getBuildExecutor( String builderType )\n         throws ContinuumException\n     {\n-        ContinuumAgentBuildExecutor executor = (ContinuumAgentBuildExecutor) executors.get( builderType );\n+        ContinuumAgentBuildExecutor executor = executors.get( builderType );\n \n         if ( executor == null )\n         {",
                "deletions": 6
            },
            {
                "sha": "50b632bc6376e34fcc1c59e3c43b1e90e34d4311",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelper.java",
                "status": "modified",
                "changes": 19,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelper.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -1,5 +1,24 @@\n package org.apache.continuum.buildagent.build.execution.maven.m1;\n \n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n import java.io.File;\n \n import org.apache.maven.continuum.model.project.Project;",
                "deletions": 0
            },
            {
                "sha": "0c7669149f087a6af40c29a644de364548cbe711",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelperException.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelperException.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelperException.java",
                "status": "modified",
                "changes": 19,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/BuildAgentMavenOneMetadataHelperException.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -1,5 +1,24 @@\n package org.apache.continuum.buildagent.build.execution.maven.m1;\n \n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n public class BuildAgentMavenOneMetadataHelperException\n     extends Exception\n {",
                "deletions": 0
            },
            {
                "sha": "889289ab130ac246fe9679f2188ecb508b84bf3b",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/DefaultBuildAgentMavenOneMetadataHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/DefaultBuildAgentMavenOneMetadataHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/DefaultBuildAgentMavenOneMetadataHelper.java",
                "status": "modified",
                "changes": 21,
                "additions": 20,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m1/DefaultBuildAgentMavenOneMetadataHelper.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -1,5 +1,24 @@\n package org.apache.continuum.buildagent.build.execution.maven.m1;\n \n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n import java.io.File;\n import java.io.FileNotFoundException;\n import java.io.FileReader;\n@@ -324,7 +343,7 @@ public void mapMetadata( ContinuumProjectBuildingResult result, File metadata, P\n         else\n         {\n             project.setDescription( shortDescription );\n-        \n+\n         }\n \n         project.setScmUrl( scmConnection );",
                "deletions": 1
            },
            {
                "sha": "e905fe543f72ecc9444d3b755cbc1ba87bb9620f",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m2/DefaultBuildAgentMavenBuilderHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m2/DefaultBuildAgentMavenBuilderHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m2/DefaultBuildAgentMavenBuilderHelper.java",
                "status": "modified",
                "changes": 37,
                "additions": 18,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/maven/m2/DefaultBuildAgentMavenBuilderHelper.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -75,8 +75,8 @@\n import org.slf4j.LoggerFactory;\n \n /**\n- * @plexus.component role=\"org.apache.continuum.buildagent.build.execution.maven.m2.BuildAgentMavenBuilderHelper\" \n- * role-hint=\"default\" \n+ * @plexus.component role=\"org.apache.continuum.buildagent.build.execution.maven.m2.BuildAgentMavenBuilderHelper\"\n+ * role-hint=\"default\"\n  */\n public class DefaultBuildAgentMavenBuilderHelper\n     implements BuildAgentMavenBuilderHelper, Contextualizable, Initializable\n@@ -104,7 +104,7 @@\n     private ArtifactRepositoryLayout defaultRepositoryLayout;\n \n     private PlexusContainer container;\n-    \n+\n     public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File file )\n     {\n         MavenProject project;\n@@ -166,8 +166,7 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n \n             if ( cause instanceof ArtifactNotFoundException )\n             {\n-                result.addError( ContinuumProjectBuildingResult.ERROR_ARTIFACT_NOT_FOUND,\n-                                 ( (ArtifactNotFoundException) cause ).toString() );\n+                result.addError( ContinuumProjectBuildingResult.ERROR_ARTIFACT_NOT_FOUND, ( cause ).toString() );\n                 return null;\n             }\n \n@@ -323,7 +322,7 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n         {\n             List<ProjectDeveloper> developers = new ArrayList<ProjectDeveloper>();\n \n-            for ( Developer d : (List<Developer>)mavenProject.getDevelopers() )\n+            for ( Developer d : (List<Developer>) mavenProject.getDevelopers() )\n             {\n                 ProjectDeveloper cd = new ProjectDeveloper();\n \n@@ -364,7 +363,7 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n \n         List<ProjectDependency> dependencies = new ArrayList<ProjectDependency>();\n \n-        for ( Dependency dependency : (List<Dependency>)mavenProject.getDependencies() )\n+        for ( Dependency dependency : (List<Dependency>) mavenProject.getDependencies() )\n         {\n             ProjectDependency cd = new ProjectDependency();\n \n@@ -377,7 +376,7 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n             dependencies.add( cd );\n         }\n \n-        for ( Plugin dependency : (List<Plugin>)mavenProject.getBuildPlugins() )\n+        for ( Plugin dependency : (List<Plugin>) mavenProject.getBuildPlugins() )\n         {\n             ProjectDependency cd = new ProjectDependency();\n \n@@ -390,7 +389,7 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n             dependencies.add( cd );\n         }\n \n-        for ( ReportPlugin dependency : (List<ReportPlugin>)mavenProject.getReportPlugins() )\n+        for ( ReportPlugin dependency : (List<ReportPlugin>) mavenProject.getReportPlugins() )\n         {\n             ProjectDependency cd = new ProjectDependency();\n \n@@ -403,7 +402,7 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n             dependencies.add( cd );\n         }\n \n-        for ( Extension dependency : (List<Extension>)mavenProject.getBuildExtensions() )\n+        for ( Extension dependency : (List<Extension>) mavenProject.getBuildExtensions() )\n         {\n             ProjectDependency cd = new ProjectDependency();\n \n@@ -477,13 +476,13 @@ private String getScmUrl( MavenProject project )\n     }\n \n     private List<ProjectNotifier> getNotifiers( ContinuumProjectBuildingResult result, MavenProject mavenProject,\n-                               Project continuumProject )\n+                                                Project continuumProject )\n     {\n         List<ProjectNotifier> notifiers = new ArrayList<ProjectNotifier>();\n \n         if ( mavenProject.getCiManagement() != null && mavenProject.getCiManagement().getNotifiers() != null )\n         {\n-            for ( Notifier projectNotifier : (List<Notifier>)mavenProject.getCiManagement().getNotifiers() )\n+            for ( Notifier projectNotifier : (List<Notifier>) mavenProject.getCiManagement().getNotifiers() )\n             {\n                 ProjectNotifier notifier = new ProjectNotifier();\n \n@@ -547,10 +546,10 @@ private Settings getSettings()\n \n     private ArtifactRepository getRepository( Settings settings )\n     {\n-        return artifactRepositoryFactory.createArtifactRepository( \"local\", \"file://\" + settings.getLocalRepository(), \n+        return artifactRepositoryFactory.createArtifactRepository( \"local\", \"file://\" + settings.getLocalRepository(),\n                                                                    defaultRepositoryLayout, null, null );\n     }\n-    \n+\n     public String getProjectName( MavenProject project )\n     {\n         String name = project.getName();\n@@ -562,7 +561,7 @@ public String getProjectName( MavenProject project )\n \n         return name;\n     }\n-    \n+\n     private void writeSettings( Settings settings )\n     {\n         StringWriter sWriter = new StringWriter();\n@@ -620,7 +619,7 @@ private void writePom( MavenProject project )\n             log.warn( \"Cannot serialize POM to XML.\", e );\n         }\n     }\n-    \n+\n     private void writeActiveProfileStatement( MavenProject project )\n     {\n         List<Profile> profiles = project.getActiveProfiles();\n@@ -644,8 +643,8 @@ private void writeActiveProfileStatement( MavenProject project )\n \n             for ( Profile profile : profiles )\n             {\n-                message.append( \"\\n - \" ).append( profile.getId() ).append( \" (source: \" )\n-                    .append( profile.getSource() ).append( \")\" );\n+                message.append( \"\\n - \" ).append( profile.getId() ).append( \" (source: \" ).append(\n+                    profile.getSource() ).append( \")\" );\n             }\n \n         }\n@@ -676,7 +675,7 @@ public void initialize()\n             throw new InitializationException( \"Can't initialize '\" + getClass().getName() + \"'\", e );\n         }\n     }\n-    \n+\n     /**\n      * @todo [BP] this might not be required if there is a better way to pass\n      * them in. It doesn't feel quite right.",
                "deletions": 19
            },
            {
                "sha": "8cf047fded838699854fb3f1d94a457e674ee504",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/configuration/DefaultBuildAgentConfiguration.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/configuration/DefaultBuildAgentConfiguration.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/configuration/DefaultBuildAgentConfiguration.java",
                "status": "modified",
                "changes": 23,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/configuration/DefaultBuildAgentConfiguration.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -84,19 +84,21 @@ public void reload( File file )\n     {\n         try\n         {\n-            ContinuumBuildAgentConfigurationModelXpp3Reader configurationXpp3Reader = \n+            ContinuumBuildAgentConfigurationModelXpp3Reader configurationXpp3Reader =\n                 new ContinuumBuildAgentConfigurationModelXpp3Reader();\n-            ContinuumBuildAgentConfigurationModel configuration = configurationXpp3Reader\n-                .read( new InputStreamReader( new FileInputStream( file ) ) );\n+            ContinuumBuildAgentConfigurationModel configuration =\n+                configurationXpp3Reader.read( new InputStreamReader( new FileInputStream( file ) ) );\n \n             this.generalBuildAgentConfiguration = new GeneralBuildAgentConfiguration();\n             if ( StringUtils.isNotEmpty( configuration.getBuildOutputDirectory() ) )\n             {\n-                this.generalBuildAgentConfiguration.setBuildOutputDirectory( new File( configuration.getBuildOutputDirectory() ) );\n+                this.generalBuildAgentConfiguration.setBuildOutputDirectory(\n+                    new File( configuration.getBuildOutputDirectory() ) );\n             }\n             if ( StringUtils.isNotEmpty( configuration.getWorkingDirectory() ) )\n             {\n-                this.generalBuildAgentConfiguration.setWorkingDirectory( new File( configuration.getWorkingDirectory() ) );\n+                this.generalBuildAgentConfiguration.setWorkingDirectory(\n+                    new File( configuration.getWorkingDirectory() ) );\n             }\n             this.generalBuildAgentConfiguration.setContinuumServerUrl( configuration.getContinuumServerUrl() );\n             this.generalBuildAgentConfiguration.setInstallations( configuration.getInstallations() );\n@@ -118,7 +120,7 @@ public void save()\n     {\n         if ( !configurationFile.exists() )\n         {\n-            configurationFile.getParentFile().mkdir();\n+            configurationFile.getParentFile().mkdirs();\n         }\n         save( configurationFile );\n     }\n@@ -131,16 +133,19 @@ public void save( File file )\n             ContinuumBuildAgentConfigurationModel configurationModel = new ContinuumBuildAgentConfigurationModel();\n             if ( this.generalBuildAgentConfiguration.getBuildOutputDirectory() != null )\n             {\n-                configurationModel.setBuildOutputDirectory( this.generalBuildAgentConfiguration.getBuildOutputDirectory().getPath() );\n+                configurationModel.setBuildOutputDirectory(\n+                    this.generalBuildAgentConfiguration.getBuildOutputDirectory().getPath() );\n             }\n             if ( this.generalBuildAgentConfiguration.getWorkingDirectory() != null )\n             {\n-                configurationModel.setWorkingDirectory( this.generalBuildAgentConfiguration.getWorkingDirectory().getPath() );\n+                configurationModel.setWorkingDirectory(\n+                    this.generalBuildAgentConfiguration.getWorkingDirectory().getPath() );\n             }\n             configurationModel.setContinuumServerUrl( this.generalBuildAgentConfiguration.getContinuumServerUrl() );\n             configurationModel.setInstallations( this.generalBuildAgentConfiguration.getInstallations() );\n \n-            ContinuumBuildAgentConfigurationModelXpp3Writer writer = new ContinuumBuildAgentConfigurationModelXpp3Writer();\n+            ContinuumBuildAgentConfigurationModelXpp3Writer writer =\n+                new ContinuumBuildAgentConfigurationModelXpp3Writer();\n             FileWriter fileWriter = new FileWriter( file );\n             writer.write( fileWriter, configurationModel );\n         }",
                "deletions": 9
            },
            {
                "sha": "ca425621683451702cdc649f0341a8ad786f9f1e",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/BuildProjectTaskExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/BuildProjectTaskExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/BuildProjectTaskExecutor.java",
                "status": "modified",
                "changes": 69,
                "additions": 35,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/BuildProjectTaskExecutor.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -160,28 +160,26 @@ private void initializeBuildContext( BuildContext buildContext )\n         projectGroup.setId( buildContext.getProjectGroupId() );\n         projectGroup.setName( buildContext.getProjectGroupName() );\n         project.setProjectGroup( projectGroup );\n-        \n+\n         actionContext.put( ContinuumBuildAgentUtil.KEY_PROJECT, project );\n-        actionContext.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION, BuildContextToBuildDefinition.getBuildDefinition( buildContext ) );\n+        actionContext.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION,\n+                           BuildContextToBuildDefinition.getBuildDefinition( buildContext ) );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION_ID, buildContext.getBuildDefinitionId() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_TRIGGER, buildContext.getTrigger() );\n-        actionContext.put( ContinuumBuildAgentUtil.KEY_ENVIRONMENTS, getEnvironments( buildContext.getBuildDefinitionId(), \n-                                                                                      getInstallationType( buildContext ) ) );\n+        actionContext.put( ContinuumBuildAgentUtil.KEY_ENVIRONMENTS,\n+                           getEnvironments( buildContext.getBuildDefinitionId(),\n+                                            getInstallationType( buildContext ) ) );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_LOCAL_REPOSITORY, buildContext.getLocalRepository() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_SCM_RESULT, buildContext.getScmResult() );\n         buildContext.setActionContext( actionContext );\n \n         buildContext.setBuildStartTime( System.currentTimeMillis() );\n     }\n-    \n+\n     private boolean checkScmResult( BuildContext buildContext )\n     {\n-        if ( buildContext.getScmResult() == null || !buildContext.getScmResult().isSuccess() )\n-        {\n-            return false;\n-        }\n+        return !( buildContext.getScmResult() == null || !buildContext.getScmResult().isSuccess() );\n \n-        return true;\n     }\n \n     private void startBuild( BuildContext buildContext )\n@@ -206,13 +204,13 @@ private void endBuild( BuildContext buildContext )\n         BuildResult buildResult = buildContext.getBuildResult();\n \n         Map<String, Object> result = new HashMap<String, Object>();\n-        result.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, new Integer( buildContext.getProjectId() ) );\n-        result.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION_ID, new Integer( buildContext.getBuildDefinitionId() ) );\n-        result.put( ContinuumBuildAgentUtil.KEY_TRIGGER, new Integer( buildContext.getTrigger() ) );\n-        result.put( ContinuumBuildAgentUtil.KEY_BUILD_STATE, new Integer( buildResult.getState() ) );\n-        result.put( ContinuumBuildAgentUtil.KEY_START_TIME, new Long( buildResult.getStartTime() ).toString() );\n-        result.put( ContinuumBuildAgentUtil.KEY_END_TIME, new Long( buildResult.getEndTime() ).toString() );\n-        result.put( ContinuumBuildAgentUtil.KEY_BUILD_EXIT_CODE, new Integer( buildResult.getExitCode() ) );\n+        result.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, buildContext.getProjectId() );\n+        result.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION_ID, buildContext.getBuildDefinitionId() );\n+        result.put( ContinuumBuildAgentUtil.KEY_TRIGGER, buildContext.getTrigger() );\n+        result.put( ContinuumBuildAgentUtil.KEY_BUILD_STATE, buildResult.getState() );\n+        result.put( ContinuumBuildAgentUtil.KEY_START_TIME, Long.toString( buildResult.getStartTime() ) );\n+        result.put( ContinuumBuildAgentUtil.KEY_END_TIME, Long.toString( buildResult.getEndTime() ) );\n+        result.put( ContinuumBuildAgentUtil.KEY_BUILD_EXIT_CODE, buildResult.getExitCode() );\n         if ( buildContext.getLatestUpdateDate() != null )\n         {\n             result.put( ContinuumBuildAgentUtil.KEY_LATEST_UPDATE_DATE, buildContext.getLatestUpdateDate() );\n@@ -247,16 +245,17 @@ private void endBuild( BuildContext buildContext )\n         catch ( ContinuumException e )\n         {\n             log.error( \"Failed to return build result for project '\" + buildContext.getProjectName() + \"'\", e );\n-            throw new TaskExecutionException( \"Failed to return build result for project '\" + buildContext.getProjectName() + \"'\", e );\n+            throw new TaskExecutionException(\n+                \"Failed to return build result for project '\" + buildContext.getProjectName() + \"'\", e );\n         }\n     }\n \n     private void performAction( String actionName, BuildContext context )\n         throws TaskExecutionException\n     {\n-        String error = null;\n-        TaskExecutionException exception = null;\n-    \n+        String error;\n+        TaskExecutionException exception;\n+\n         try\n         {\n             log.info( \"Performing action \" + actionName );\n@@ -271,13 +270,13 @@ private void performAction( String actionName, BuildContext context )\n         catch ( ScmRepositoryException e )\n         {\n             error = getValidationMessages( e ) + \"\\n\" + ContinuumBuildAgentUtil.throwableToString( e );\n-    \n+\n             exception = new TaskExecutionException( \"SCM error while executing '\" + actionName + \"'\", e );\n         }\n         catch ( ScmException e )\n         {\n             error = ContinuumBuildAgentUtil.throwableToString( e );\n-    \n+\n             exception = new TaskExecutionException( \"SCM error while executing '\" + actionName + \"'\", e );\n         }\n         catch ( Exception e )\n@@ -294,7 +293,7 @@ private void performAction( String actionName, BuildContext context )\n     private void updateBuildResult( BuildContext context, String error )\n     {\n         context.setBuildResult( ContinuumBuildAgentUtil.getBuildResult( context.getActionContext(), null ) );\n-        \n+\n         if ( context.getBuildResult() == null )\n         {\n             BuildResult build = new BuildResult();\n@@ -346,7 +345,7 @@ private String getBuildOutputText( int projectId )\n         try\n         {\n             File buildOutputFile = buildAgentConfigurationService.getBuildOutputFile( projectId );\n-        \n+\n             if ( buildOutputFile.exists() )\n             {\n                 return StringEscapeUtils.escapeHtml( FileUtils.fileRead( buildOutputFile ) );\n@@ -371,14 +370,15 @@ private String getBuildOutputText( int projectId )\n         catch ( ContinuumException e )\n         {\n             log.error( \"Error while retrieving environments of build definition: \" + buildDefinitionId, e );\n-            throw new TaskExecutionException( \"Error while retrieving environments of build definition: \" + buildDefinitionId, e );\n+            throw new TaskExecutionException(\n+                \"Error while retrieving environments of build definition: \" + buildDefinitionId, e );\n         }\n     }\n \n     private String getInstallationType( BuildContext buildContext )\n     {\n         String executorId = buildContext.getExecutorId();\n-        \n+\n         if ( ContinuumBuildExecutorConstants.MAVEN_TWO_BUILD_EXECUTOR.equals( executorId ) )\n         {\n             return BuildAgentInstallationService.MAVEN2_TYPE;\n@@ -399,9 +399,9 @@ private boolean shouldBuild( BuildContext context )\n         throws TaskExecutionException\n     {\n         Map map = new HashMap();\n-        map.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, new Integer( context.getProjectId() ) );\n-        map.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION_ID, new Integer( context.getBuildDefinitionId() ) );\n-        map.put( ContinuumBuildAgentUtil.KEY_TRIGGER, new Integer( context.getTrigger() ) );\n+        map.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, context.getProjectId() );\n+        map.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION_ID, context.getBuildDefinitionId() );\n+        map.put( ContinuumBuildAgentUtil.KEY_TRIGGER, context.getTrigger() );\n         map.put( ContinuumBuildAgentUtil.KEY_SCM_CHANGES, getScmChanges( context.getScmResult() ) );\n         map.put( ContinuumBuildAgentUtil.KEY_MAVEN_PROJECT, getMavenProject( context ) );\n         if ( context.getLatestUpdateDate() != null )\n@@ -428,7 +428,7 @@ private List getScmChanges( ScmResult scmResult )\n         {\n             for ( Object obj : scmResult.getChanges() )\n             {\n-                ChangeSet changeSet = (ChangeSet) obj; \n+                ChangeSet changeSet = (ChangeSet) obj;\n \n                 Map map = new HashMap();\n                 if ( StringUtils.isNotEmpty( changeSet.getAuthor() ) )\n@@ -491,7 +491,7 @@ private List getScmChanges( ScmResult scmResult )\n                 }\n                 else\n                 {\n-                    map.put( ContinuumBuildAgentUtil.KEY_CHANGEFILE_STATUS, \"\" );   \n+                    map.put( ContinuumBuildAgentUtil.KEY_CHANGEFILE_STATUS, \"\" );\n                 }\n                 scmChangeFiles.add( map );\n             }\n@@ -506,7 +506,8 @@ private Map getMavenProject( BuildContext context )\n \n         try\n         {\n-            ContinuumAgentBuildExecutor buildExecutor = buildAgentBuildExecutorManager.getBuildExecutor( context.getExecutorId() );\n+            ContinuumAgentBuildExecutor buildExecutor =\n+                buildAgentBuildExecutorManager.getBuildExecutor( context.getExecutorId() );\n \n             BuildDefinition buildDefinition = BuildContextToBuildDefinition.getBuildDefinition( context );\n \n@@ -527,7 +528,7 @@ private Map getMavenProject( BuildContext context )\n         }\n         catch ( ContinuumException e )\n         {\n-            log.error( \"Error getting build executor\", e );   \n+            log.error( \"Error getting build executor\", e );\n         }\n \n         return mavenProject;",
                "deletions": 34
            },
            {
                "sha": "5606c4cd83b602cc0dad519c678d833423b0969b",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/PrepareBuildProjectsTaskExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/PrepareBuildProjectsTaskExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/PrepareBuildProjectsTaskExecutor.java",
                "status": "modified",
                "changes": 105,
                "additions": 54,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/execution/PrepareBuildProjectsTaskExecutor.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -93,18 +93,18 @@ public void executeTask( Task task )\n \n                     log.info( \"Starting prepare build\" );\n                     startPrepareBuild( buildContext );\n-                    \n+\n                     log.info( \"Initializing prepare build\" );\n                     initializeActionContext( buildContext );\n-                    \n+\n                     try\n                     {\n                         if ( buildDef.isBuildFresh() )\n                         {\n                             log.info( \"Clean up working directory\" );\n                             cleanWorkingDirectory( buildContext );\n                         }\n-            \n+\n                         log.info( \"Updating working directory\" );\n                         updateWorkingDirectory( buildContext );\n \n@@ -142,11 +142,12 @@ private void startPrepareBuild( BuildContext buildContext )\n         throws TaskExecutionException\n     {\n         Map<String, Object> actionContext = buildContext.getActionContext();\n-        \n-        if ( actionContext == null || !( ContinuumBuildAgentUtil.getScmRootState( actionContext ) == ContinuumProjectState.UPDATING ) ) \n+\n+        if ( actionContext == null ||\n+            !( ContinuumBuildAgentUtil.getScmRootState( actionContext ) == ContinuumProjectState.UPDATING ) )\n         {\n             Map<String, Object> map = new HashMap<String, Object>();\n-            map.put( ContinuumBuildAgentUtil.KEY_PROJECT_GROUP_ID, new Integer( buildContext.getProjectGroupId() ) );\n+            map.put( ContinuumBuildAgentUtil.KEY_PROJECT_GROUP_ID, buildContext.getProjectGroupId() );\n             map.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_ADDRESS, buildContext.getScmRootAddress() );\n \n             try\n@@ -159,97 +160,96 @@ private void startPrepareBuild( BuildContext buildContext )\n             }\n         }\n     }\n-    \n+\n     private void initializeActionContext( BuildContext buildContext )\n     {\n         Map<String, Object> actionContext = new HashMap<String, Object>();\n-    \n+\n         actionContext.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, buildContext.getProjectId() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_PROJECT, BuildContextToProject.getProject( buildContext ) );\n-        actionContext.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION, BuildContextToBuildDefinition.getBuildDefinition( buildContext ) );\n+        actionContext.put( ContinuumBuildAgentUtil.KEY_BUILD_DEFINITION,\n+                           BuildContextToBuildDefinition.getBuildDefinition( buildContext ) );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_STATE, ContinuumProjectState.UPDATING );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_PROJECT_GROUP_ID, buildContext.getProjectGroupId() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_ADDRESS, buildContext.getScmRootAddress() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_OLD_SCM_RESULT, buildContext.getOldScmResult() );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_LATEST_UPDATE_DATE, buildContext.getLatestUpdateDate() );\n-    \n+\n         buildContext.setActionContext( actionContext );\n     }\n-    \n+\n     private boolean checkProjectScmRoot( Map context )\n     {\n-        if ( context != null && ContinuumBuildAgentUtil.getScmRootState( context ) == ContinuumProjectState.ERROR )\n-        {\n-            return false;\n-        }\n-    \n-        return true;\n+        return !( context != null &&\n+            ContinuumBuildAgentUtil.getScmRootState( context ) == ContinuumProjectState.ERROR );\n+\n     }\n-    \n+\n     private void cleanWorkingDirectory( BuildContext buildContext )\n         throws TaskExecutionException\n     {\n         performAction( \"clean-agent-working-directory\", buildContext );\n     }\n-    \n+\n     private void updateWorkingDirectory( BuildContext buildContext )\n         throws TaskExecutionException\n     {\n         Map<String, Object> actionContext = buildContext.getActionContext();\n-    \n+\n         performAction( \"check-agent-working-directory\", buildContext );\n-        \n+\n         boolean workingDirectoryExists =\n             ContinuumBuildAgentUtil.getBoolean( actionContext, ContinuumBuildAgentUtil.KEY_WORKING_DIRECTORY_EXISTS );\n-    \n+\n         ScmResult scmResult;\n-    \n-        Date date = null;\n-    \n+\n+        Date date;\n+\n         if ( workingDirectoryExists )\n         {\n             performAction( \"update-agent-working-directory\", buildContext );\n-    \n+\n             scmResult = ContinuumBuildAgentUtil.getUpdateScmResult( actionContext, null );\n-    \n+\n             date = ContinuumBuildAgentUtil.getLatestUpdateDate( actionContext );\n-    \n+\n             if ( date == null )\n             {\n                 // try to get latest update date from change log because sometimes date in the changefile is 0\n                 performAction( \"changelog-agent-project\", buildContext );\n-    \n+\n                 date = ContinuumBuildAgentUtil.getLatestUpdateDate( actionContext );\n             }\n         }\n         else\n         {\n             Project project = ContinuumBuildAgentUtil.getProject( actionContext );\n-    \n+\n             actionContext.put( ContinuumBuildAgentUtil.KEY_WORKING_DIRECTORY,\n-                               buildAgentConfigurationService.getWorkingDirectory( project.getId() ).getAbsolutePath() );\n-    \n+                               buildAgentConfigurationService.getWorkingDirectory(\n+                                   project.getId() ).getAbsolutePath() );\n+\n             performAction( \"checkout-agent-project\", buildContext );\n-    \n+\n             scmResult = ContinuumBuildAgentUtil.getCheckoutScmResult( actionContext, null );\n-    \n+\n             performAction( \"changelog-agent-project\", buildContext );\n-    \n+\n             date = ContinuumBuildAgentUtil.getLatestUpdateDate( actionContext );\n         }\n-    \n+\n         buildContext.setScmResult( scmResult );\n         buildContext.setLatestUpdateDate( date );\n         actionContext.put( ContinuumBuildAgentUtil.KEY_SCM_RESULT, scmResult );\n     }\n-    \n+\n     private void endProjectPrepareBuild( BuildContext buildContext )\n         throws TaskExecutionException\n     {\n         Map<String, Object> context = buildContext.getActionContext();\n-    \n+\n         ScmResult scmResult = ContinuumBuildAgentUtil.getScmResult( context, null );\n-    \n+\n         if ( scmResult == null || !scmResult.isSuccess() )\n         {\n             context.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_STATE, ContinuumProjectState.ERROR );\n@@ -259,21 +259,24 @@ private void endProjectPrepareBuild( BuildContext buildContext )\n             buildContext.setScmResult( scmResult );\n         }\n     }\n-    \n+\n     private void endPrepareBuild( Map context )\n         throws TaskExecutionException\n     {\n         if ( context != null )\n         {\n             Map<String, Object> result = new HashMap<String, Object>();\n-            result.put( ContinuumBuildAgentUtil.KEY_PROJECT_GROUP_ID, new Integer( ContinuumBuildAgentUtil.getProjectGroupId( context ) ) );\n-            result.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_ADDRESS, ContinuumBuildAgentUtil.getScmRootAddress( context ) );\n-            result.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_STATE, new Integer( ContinuumBuildAgentUtil.getScmRootState( context ) ) );\n-            \n+            result.put( ContinuumBuildAgentUtil.KEY_PROJECT_GROUP_ID,\n+                        ContinuumBuildAgentUtil.getProjectGroupId( context ) );\n+            result.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_ADDRESS,\n+                        ContinuumBuildAgentUtil.getScmRootAddress( context ) );\n+            result.put( ContinuumBuildAgentUtil.KEY_SCM_ROOT_STATE,\n+                        ContinuumBuildAgentUtil.getScmRootState( context ) );\n+\n             if ( ContinuumBuildAgentUtil.getScmRootState( context ) == ContinuumProjectState.ERROR )\n             {\n                 String error = convertScmResultToError( ContinuumBuildAgentUtil.getScmResult( context, null ) );\n-                \n+\n                 if ( StringUtils.isEmpty( error ) )\n                 {\n                     result.put( ContinuumBuildAgentUtil.KEY_SCM_ERROR, \"\" );\n@@ -349,7 +352,7 @@ private void performAction( String actionName, BuildContext buildContext )\n         throws TaskExecutionException\n     {\n         TaskExecutionException exception = null;\n-    \n+\n         try\n         {\n             log.info( \"Performing action \" + actionName );\n@@ -364,16 +367,16 @@ private void performAction( String actionName, BuildContext buildContext )\n         {\n             exception = new TaskExecutionException( \"Error executing action '\" + actionName + \"'\", e );\n         }\n-        \n+\n         ScmResult result = new ScmResult();\n-        \n+\n         result.setSuccess( false );\n-        \n+\n         result.setException( ContinuumBuildAgentUtil.throwableToString( exception ) );\n \n         buildContext.setScmResult( result );\n         buildContext.getActionContext().put( ContinuumBuildAgentUtil.KEY_UPDATE_SCM_RESULT, result );\n-        \n+\n         throw exception;\n     }\n \n@@ -413,7 +416,7 @@ private void buildProjects( List<BuildContext> buildContexts )\n     {\n         Map map = new HashMap();\n         map.put( ContinuumBuildAgentUtil.KEY_BUILD_CONTEXTS, buildContexts );\n-        \n+\n         BuildContext context = new BuildContext();\n         context.setActionContext( map );\n ",
                "deletions": 51
            },
            {
                "sha": "cf8383307109034003b19fd5dc65806a1a5ea9bd",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/utils/ContinuumBuildAgentUtil.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/utils/ContinuumBuildAgentUtil.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/utils/ContinuumBuildAgentUtil.java",
                "status": "modified",
                "changes": 20,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/utils/ContinuumBuildAgentUtil.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -541,25 +541,25 @@ public static String getString( Map context, String key, String defaultValue )\n \n     public static boolean getBoolean( Map context, String key )\n     {\n-        return ( (Boolean) getObject( context, key ) ).booleanValue();\n+        return (Boolean) getObject( context, key );\n     }\n-    \n+\n     public static boolean getBoolean( Map context, String key, boolean defaultValue )\n     {\n-        return ( (Boolean) getObject( context, key, Boolean.valueOf( defaultValue ) ) ).booleanValue();\n-    }    \n+        return (Boolean) getObject( context, key, defaultValue );\n+    }\n \n     public static int getInteger( Map context, String key )\n     {\n         Object obj = getObject( context, key, null );\n-        \n+\n         if ( obj == null )\n         {\n             return 0;\n         }\n         else\n         {\n-            return ( (Integer) obj ).intValue();\n+            return (Integer) obj;\n         }\n     }\n \n@@ -578,7 +578,7 @@ public static List getList( Map context, String key )\n             if ( obj instanceof Object[] )\n             {\n                 Object[] objA = (Object[]) obj;\n-    \n+\n                 for ( Object o : objA )\n                 {\n                     if ( o instanceof Map )\n@@ -705,7 +705,7 @@ public static String throwableMessagesToString( Throwable error )\n         Map<String, Object> result = new HashMap<String, Object>();\n         ScmResult scmResult = buildContext.getScmResult();\n \n-        result.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, new Integer( buildContext.getProjectId() ) );\n+        result.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, buildContext.getProjectId() );\n         if ( StringUtils.isEmpty( scmResult.getCommandLine() ) )\n         {\n             result.put( ContinuumBuildAgentUtil.KEY_SCM_COMMAND_LINE, \"\" );\n@@ -738,7 +738,7 @@ public static String throwableMessagesToString( Throwable error )\n         {\n             result.put( ContinuumBuildAgentUtil.KEY_SCM_EXCEPTION, scmResult.getException() );\n         }\n-        result.put( ContinuumBuildAgentUtil.KEY_SCM_SUCCESS, new Boolean( scmResult.isSuccess() ) );\n+        result.put( ContinuumBuildAgentUtil.KEY_SCM_SUCCESS, scmResult.isSuccess() );\n         result.put( ContinuumBuildAgentUtil.KEY_SCM_CHANGES, getScmChanges( scmResult ) );\n \n         return result;\n@@ -764,7 +764,7 @@ public static String throwableMessagesToString( Throwable error )\n                 {\n                     changeSet.put( ContinuumBuildAgentUtil.KEY_CHANGESET_AUTHOR, \"\" );\n                 }\n-                if ( StringUtils.isNotEmpty( cs.getComment() ) ) \n+                if ( StringUtils.isNotEmpty( cs.getComment() ) )\n                 {\n                     changeSet.put( ContinuumBuildAgentUtil.KEY_CHANGESET_COMMENT, cs.getComment() );\n                 }",
                "deletions": 10
            },
            {
                "sha": "100d8e29389c131a24e4b944986228719deb0e3b",
                "filename": "continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java",
                "status": "modified",
                "changes": 65,
                "additions": 36,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/DistributedBuildProjectTaskExecutor.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -105,8 +105,8 @@ public void executeTask( Task task )\n             SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( buildAgentUrl ) );\n \n             log.info( \"initializing buildContext\" );\n-            List buildContext = initializeBuildContext( prepareBuildTask.getProjectsBuildDefinitionsMap(), \n-                                                        prepareBuildTask.getTrigger(), \n+            List buildContext = initializeBuildContext( prepareBuildTask.getProjectsBuildDefinitionsMap(),\n+                                                        prepareBuildTask.getTrigger(),\n                                                         prepareBuildTask.getScmRootAddress() );\n \n             startTime = System.currentTimeMillis();\n@@ -126,8 +126,8 @@ public void executeTask( Task task )\n         }\n     }\n \n-    private List initializeBuildContext( Map<Integer, Integer> projectsAndBuildDefinitions, \n-                                         int trigger, String scmRootAddress )\n+    private List initializeBuildContext( Map<Integer, Integer> projectsAndBuildDefinitions, int trigger,\n+                                         String scmRootAddress )\n         throws ContinuumException\n     {\n         List buildContext = new ArrayList();\n@@ -151,26 +151,27 @@ private List initializeBuildContext( Map<Integer, Integer> projectsAndBuildDefin\n             }\n \n             for ( Project project : projects )\n-            {                \n+            {\n                 int buildDefinitionId = projectsAndBuildDefinitions.get( project.getId() );\n                 BuildDefinition buildDef = buildDefinitionDao.getBuildDefinition( buildDefinitionId );\n                 BuildResult buildResult = buildResultDao.getLatestBuildResultForProject( project.getId() );\n \n                 Map context = new HashMap();\n-                \n-                context.put( ContinuumBuildConstant.KEY_PROJECT_GROUP_ID, new Integer( project.getProjectGroup().getId() ) );\n+\n+                context.put( ContinuumBuildConstant.KEY_PROJECT_GROUP_ID, project.getProjectGroup().getId() );\n                 context.put( ContinuumBuildConstant.KEY_PROJECT_GROUP_NAME, project.getProjectGroup().getName() );\n                 context.put( ContinuumBuildConstant.KEY_SCM_ROOT_ADDRESS, scmRootAddress );\n-                context.put( ContinuumBuildConstant.KEY_PROJECT_ID, new Integer( project.getId() ) );\n+                context.put( ContinuumBuildConstant.KEY_PROJECT_ID, project.getId() );\n                 context.put( ContinuumBuildConstant.KEY_PROJECT_NAME, project.getName() );\n                 context.put( ContinuumBuildConstant.KEY_PROJECT_VERSION, project.getVersion() );\n                 context.put( ContinuumBuildConstant.KEY_EXECUTOR_ID, project.getExecutorId() );\n-                context.put( ContinuumBuildConstant.KEY_PROJECT_BUILD_NUMBER, new Integer( project.getBuildNumber() ) );\n+                context.put( ContinuumBuildConstant.KEY_PROJECT_BUILD_NUMBER, project.getBuildNumber() );\n                 context.put( ContinuumBuildConstant.KEY_SCM_URL, project.getScmUrl() );\n-                context.put( ContinuumBuildConstant.KEY_PROJECT_STATE, new Integer( project.getState() ) );\n+                context.put( ContinuumBuildConstant.KEY_PROJECT_STATE, project.getState() );\n                 if ( buildResult != null )\n                 {\n-                    context.put( ContinuumBuildConstant.KEY_LATEST_UPDATE_DATE, new Date( buildResult.getStartTime() ) );\n+                    context.put( ContinuumBuildConstant.KEY_LATEST_UPDATE_DATE,\n+                                 new Date( buildResult.getStartTime() ) );\n                 }\n \n                 LocalRepository localRepo = project.getProjectGroup().getLocalRepository();\n@@ -202,7 +203,7 @@ private List initializeBuildContext( Map<Integer, Integer> projectsAndBuildDefin\n                     context.put( ContinuumBuildConstant.KEY_SCM_PASSWORD, project.getScmPassword() );\n                 }\n \n-                context.put( ContinuumBuildConstant.KEY_BUILD_DEFINITION_ID, new Integer( buildDefinitionId ) );\n+                context.put( ContinuumBuildConstant.KEY_BUILD_DEFINITION_ID, buildDefinitionId );\n                 context.put( ContinuumBuildConstant.KEY_BUILD_FILE, buildDef.getBuildFile() );\n                 context.put( ContinuumBuildConstant.KEY_GOALS, buildDef.getGoals() );\n \n@@ -214,12 +215,14 @@ private List initializeBuildContext( Map<Integer, Integer> projectsAndBuildDefin\n                 {\n                     context.put( ContinuumBuildConstant.KEY_ARGUMENTS, buildDef.getArguments() );\n                 }\n-                context.put( ContinuumBuildConstant.KEY_TRIGGER, new Integer( trigger ) );\n-                context.put( ContinuumBuildConstant.KEY_BUILD_FRESH, new Boolean( buildDef.isBuildFresh() ) );\n-                context.put( ContinuumBuildConstant.KEY_ALWAYS_BUILD, new Boolean( buildDef.isAlwaysBuild() ) );\n-                context.put( ContinuumBuildConstant.KEY_OLD_SCM_CHANGES, getOldScmChanges( project.getId(), buildDefinitionId ) );\n+                context.put( ContinuumBuildConstant.KEY_TRIGGER, trigger );\n+                context.put( ContinuumBuildConstant.KEY_BUILD_FRESH, buildDef.isBuildFresh() );\n+                context.put( ContinuumBuildConstant.KEY_ALWAYS_BUILD, buildDef.isAlwaysBuild() );\n+                context.put( ContinuumBuildConstant.KEY_OLD_SCM_CHANGES,\n+                             getOldScmChanges( project.getId(), buildDefinitionId ) );\n                 context.put( ContinuumBuildConstant.KEY_BUILD_AGENT_URL, buildAgentUrl );\n-                context.put( ContinuumBuildConstant.KEY_MAX_JOB_EXEC_TIME, new Integer( buildDef.getSchedule().getMaxJobExecutionTime() ) );\n+                context.put( ContinuumBuildConstant.KEY_MAX_JOB_EXEC_TIME,\n+                             buildDef.getSchedule().getMaxJobExecutionTime() );\n \n                 buildContext.add( context );\n             }\n@@ -237,7 +240,9 @@ private void createResult( PrepareBuildProjectsTask task, String error )\n     {\n         try\n         {\n-            ProjectScmRoot scmRoot = projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( task.getProjectGroupId(), task.getScmRootAddress() );\n+            ProjectScmRoot scmRoot =\n+                projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( task.getProjectGroupId(),\n+                                                                                    task.getScmRootAddress() );\n \n             if ( scmRoot.getState() == ContinuumProjectState.UPDATING )\n             {\n@@ -254,9 +259,10 @@ private void createResult( PrepareBuildProjectsTask task, String error )\n                     Project project = projectDao.getProject( projectId );\n                     BuildDefinition buildDef = buildDefinitionDao.getBuildDefinition( buildDefinitionId );\n                     BuildResult latestBuildResult = buildResultDao.\n-                                                        getLatestBuildResultForBuildDefinition( projectId, buildDefinitionId );\n-                    if ( latestBuildResult == null || ( latestBuildResult.getStartTime() >= startTime && latestBuildResult.getEndTime() > 0 && \n-                           latestBuildResult.getEndTime() < endTime ) || latestBuildResult.getStartTime() < startTime )\n+                        getLatestBuildResultForBuildDefinition( projectId, buildDefinitionId );\n+                    if ( latestBuildResult == null ||\n+                        ( latestBuildResult.getStartTime() >= startTime && latestBuildResult.getEndTime() > 0 &&\n+                            latestBuildResult.getEndTime() < endTime ) || latestBuildResult.getStartTime() < startTime )\n                     {\n                         BuildResult buildResult = new BuildResult();\n                         buildResult.setBuildDefinition( buildDef );\n@@ -288,7 +294,8 @@ private List getOldScmChanges( int projectId, int buildDefinitionId )\n \n         if ( oldBuildResult != null )\n         {\n-            ScmResult scmResult = getOldScmResults( projectId, oldBuildResult.getBuildNumber(), oldBuildResult.getEndTime() );\n+            ScmResult scmResult =\n+                getOldScmResults( projectId, oldBuildResult.getBuildNumber(), oldBuildResult.getEndTime() );\n \n             scmChanges = getScmChanges( scmResult );\n         }\n@@ -304,7 +311,7 @@ private List getScmChanges( ScmResult scmResult )\n         {\n             for ( Object obj : scmResult.getChanges() )\n             {\n-                ChangeSet changeSet = (ChangeSet) obj; \n+                ChangeSet changeSet = (ChangeSet) obj;\n \n                 Map map = new HashMap();\n                 if ( StringUtils.isNotEmpty( changeSet.getAuthor() ) )\n@@ -367,7 +374,7 @@ private List getScmChanges( ScmResult scmResult )\n                 }\n                 else\n                 {\n-                    map.put( ContinuumBuildConstant.KEY_CHANGEFILE_STATUS, \"\" );   \n+                    map.put( ContinuumBuildConstant.KEY_CHANGEFILE_STATUS, \"\" );\n                 }\n                 scmChangeFiles.add( map );\n             }\n@@ -379,19 +386,19 @@ private ScmResult getOldScmResults( int projectId, long startId, long fromDate )\n         throws ContinuumStoreException\n     {\n         List<BuildResult> results = buildResultDao.getBuildResultsForProjectFromId( projectId, startId );\n-    \n+\n         ScmResult res = new ScmResult();\n-    \n+\n         if ( results != null && results.size() > 0 )\n         {\n             for ( BuildResult result : results )\n             {\n                 ScmResult scmResult = result.getScmResult();\n-    \n+\n                 if ( scmResult != null )\n                 {\n                     List<ChangeSet> changes = scmResult.getChanges();\n-    \n+\n                     if ( changes != null )\n                     {\n                         for ( ChangeSet changeSet : changes )\n@@ -409,7 +416,7 @@ private ScmResult getOldScmResults( int projectId, long startId, long fromDate )\n                 }\n             }\n         }\n-    \n+\n         return res;\n     }\n }",
                "deletions": 29
            },
            {
                "sha": "e6f630720dc83c7585b3a7f04cba8001d7f5ae10",
                "filename": "continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/ThreadedDistributedBuildTaskQueueExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/ThreadedDistributedBuildTaskQueueExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/ThreadedDistributedBuildTaskQueueExecutor.java",
                "status": "modified",
                "changes": 21,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-builder/src/main/java/org/apache/continuum/builder/distributed/executor/ThreadedDistributedBuildTaskQueueExecutor.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -51,13 +51,19 @@\n \n     private Logger log = LoggerFactory.getLogger( this.getClass() );\n \n-    /** @requirement */\n+    /**\n+     * @requirement\n+     */\n     private TaskQueue queue;\n \n-    /** @requirement */\n+    /**\n+     * @requirement\n+     */\n     private DistributedBuildTaskExecutor executor;\n \n-    /** @configuration */\n+    /**\n+     * @configuration\n+     */\n     private String name;\n \n     // ----------------------------------------------------------------------\n@@ -91,8 +97,8 @@ public void run()\n                 }\n                 catch ( InterruptedException e )\n                 {\n-                    log.info( \"Executor thread interrupted, command: \"\n-                        + ( command == SHUTDOWN ? \"Shutdown\" : command == CANCEL_TASK ? \"Cancel task\" : \"Unknown\" ) );\n+                    log.info( \"Executor thread interrupted, command: \" +\n+                        ( command == SHUTDOWN ? \"Shutdown\" : command == CANCEL_TASK ? \"Cancel task\" : \"Unknown\" ) );\n                     continue;\n                 }\n \n@@ -212,8 +218,9 @@ private void cancel( Future future )\n                 }\n                 else\n                 {\n-                    log.warn( \"Task not cancelled (Flags: done: \" + future.isDone() + \" cancelled: \"\n-                        + future.isCancelled() + \")\" );\n+                    log.warn(\n+                        \"Task not cancelled (Flags: done: \" + future.isDone() + \" cancelled: \" + future.isCancelled() +\n+                            \")\" );\n                 }\n             }\n             else",
                "deletions": 7
            },
            {
                "sha": "77921389c714aa538a1fb8d0247f43bba1803724",
                "filename": "continuum-commons/src/main/java/org/apache/continuum/installation/DefaultInstallationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/main/java/org/apache/continuum/installation/DefaultInstallationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/main/java/org/apache/continuum/installation/DefaultInstallationService.java",
                "status": "modified",
                "changes": 18,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/main/java/org/apache/continuum/installation/DefaultInstallationService.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -24,7 +24,6 @@\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.HashMap;\n-import java.util.Iterator;\n import java.util.List;\n import java.util.Map;\n import java.util.Properties;\n@@ -56,9 +55,8 @@\n /**\n  * @author <a href=\"mailto:olamy@codehaus.org\">olamy</a>\n  * @version $Id$\n- * TODO use some cache mechanism to prevent always reading from store ?\n+ *          TODO use some cache mechanism to prevent always reading from store ?\n  * @since 13 juin 07\n- * \n  */\n @Service(\"installationService\")\n public class DefaultInstallationService\n@@ -90,8 +88,8 @@ public void initialize()\n                               new ExecutorConfigurator( \"java\", \"bin\", \"JAVA_HOME\", \"-version\" ) );\n         this.typesValues.put( InstallationService.MAVEN1_TYPE,\n                               new ExecutorConfigurator( \"maven\", \"bin\", \"MAVEN_HOME\", \"-v\" ) );\n-        this.typesValues\n-            .put( InstallationService.MAVEN2_TYPE, new ExecutorConfigurator( \"mvn\", \"bin\", \"M2_HOME\", \"-v\" ) );\n+        this.typesValues.put( InstallationService.MAVEN2_TYPE,\n+                              new ExecutorConfigurator( \"mvn\", \"bin\", \"M2_HOME\", \"-v\" ) );\n     }\n \n     /**\n@@ -120,7 +118,7 @@ public Installation add( Installation installation, boolean automaticProfile )\n                 \"Installation with name \" + installation.getName() + \" already exists\" );\n         }\n         // TODO must be done in the same transaction\n-        Installation storedOne = null;\n+        Installation storedOne;\n         try\n         {\n             String envVarName = this.getEnvVar( installation.getType() );\n@@ -402,15 +400,14 @@ public void consumeLine( String line )\n             if ( StringUtils.isNotEmpty( path ) )\n             {\n                 executable.append( path ).append( File.separator );\n-                executable.append( executorConfigurator.getRelativePath() + File.separator );\n+                executable.append( executorConfigurator.getRelativePath() ).append( File.separator );\n                 commandline.addEnvironment( executorConfigurator.getEnvVar(), path );\n             }\n             //Installations are env var they must be add if exists\n             Map<String, String> environments = getEnvVars( profile );\n             // no null check we use a private method just here\n-            for ( Iterator<String> iterator = environments.keySet().iterator(); iterator.hasNext(); )\n+            for ( String key : environments.keySet() )\n             {\n-                String key = iterator.next();\n                 String value = environments.get( key );\n                 commandline.addEnvironment( key, value );\n             }\n@@ -441,8 +438,7 @@ public void consumeLine( String line )\n         }\n         catch ( CommandLineException e )\n         {\n-            log.error(\n-                \"fail to execute \" + executable + \" with arg \" + executorConfigurator.getVersionArgument() );\n+            log.error( \"fail to execute \" + executable + \" with arg \" + executorConfigurator.getVersionArgument() );\n             throw new InstallationException( e.getMessage(), e );\n         }\n     }",
                "deletions": 11
            },
            {
                "sha": "f5a2dc0a04ffa48973d891c7c3bc54659891ff66",
                "filename": "continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "status": "modified",
                "changes": 72,
                "additions": 39,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -65,7 +65,7 @@\n \n     @Resource\n     private SystemConfigurationDao systemConfigurationDao;\n-        \n+\n     @Resource\n     private BuildQueueService buildQueueService;\n \n@@ -101,7 +101,7 @@ public void setScheduleDao( ScheduleDao scheduleDao )\n     {\n         this.scheduleDao = scheduleDao;\n     }\n-    \n+\n     public BuildQueueService getBuildQueueService()\n     {\n         return buildQueueService;\n@@ -111,7 +111,7 @@ public void setBuildQueueService( BuildQueueService buildQueueService )\n     {\n         this.buildQueueService = buildQueueService;\n     }\n-    \n+\n     public SystemConfigurationDao getSystemConfigurationDao()\n     {\n         return systemConfigurationDao;\n@@ -168,7 +168,7 @@ public void setUrl( String url )\n         generalConfiguration.setBaseUrl( url );\n     }\n \n-    /** \n+    /**\n      * @see org.apache.maven.continuum.configuration.ConfigurationService#getBuildOutputDirectory()\n      */\n     public File getBuildOutputDirectory()\n@@ -345,7 +345,7 @@ public void updateBuildAgent( BuildAgentConfiguration buildAgent )\n                 {\n                     agent.setDescription( buildAgent.getDescription() );\n                     agent.setEnabled( buildAgent.isEnabled() );\n-                    \n+\n                     return;\n                 }\n             }\n@@ -413,7 +413,7 @@ public void updateBuildAgentGroup( BuildAgentGroupConfiguration buildAgentGroup\n                 if ( groups.getName().equals( buildAgentGroup.getName() ) )\n                 {\n                     groups.setName( buildAgentGroup.getName() );\n-                    groups.setBuildAgents( buildAgentGroup.getBuildAgents()  );\n+                    groups.setBuildAgents( buildAgentGroup.getBuildAgents() );\n \n                     return;\n                 }\n@@ -446,7 +446,7 @@ public void addBuildAgent( BuildAgentGroupConfiguration buildAgentGroup, BuildAg\n                 }\n             }\n             generalConfiguration.setBuildAgentGroups( buildAgentGroupConfiguration );\n-        }        \n+        }\n     }\n \n     public void removeBuildAgent( BuildAgentGroupConfiguration buildAgentGroup, BuildAgentConfiguration buildAgent )\n@@ -492,7 +492,7 @@ public BuildAgentGroupConfiguration getBuildAgentGroup( String name )\n         return null;\n     }\n \n-    public BuildAgentConfiguration getBuildAgent(String url)\n+    public BuildAgentConfiguration getBuildAgent( String url )\n     {\n         List<BuildAgentConfiguration> buildAgents = generalConfiguration.getBuildAgents();\n         if ( buildAgents == null )\n@@ -502,7 +502,7 @@ public BuildAgentConfiguration getBuildAgent(String url)\n \n         for ( BuildAgentConfiguration agent : buildAgents )\n         {\n-            if ( agent.getUrl().equals(url ) )\n+            if ( agent.getUrl().equals( url ) )\n             {\n                 return agent;\n             }\n@@ -584,17 +584,17 @@ public File getReleaseOutputDirectory( int projectGroupId )\n         {\n             return null;\n         }\n-        \n+\n         File dir = new File( getReleaseOutputDirectory(), Integer.toString( projectGroupId ) );\n-        \n+\n         try\n         {\n             dir = dir.getCanonicalFile();\n         }\n         catch ( IOException e )\n         {\n         }\n-        \n+\n         return dir;\n     }\n \n@@ -607,7 +607,7 @@ public File getReleaseOutputFile( int projectGroupId, String name )\n         {\n             return null;\n         }\n-        \n+\n         if ( !dir.exists() && !dir.mkdirs() )\n         {\n             throw new ConfigurationException(\n@@ -639,17 +639,17 @@ public String getReleaseOutput( int projectGroupId, String name )\n             return null;\n         }\n     }\n-    \n+\n     public int getNumberOfBuildsInParallel()\n     {\n         return generalConfiguration.getNumberOfBuildsInParallel();\n     }\n-    \n+\n     public void setNumberOfBuildsInParallel( int num )\n     {\n         generalConfiguration.setNumberOfBuildsInParallel( num );\n     }\n-    \n+\n     // ----------------------------------------------------------------------\n     //\n     // ----------------------------------------------------------------------\n@@ -663,7 +663,7 @@ public File getFile( String filename )\n \n         File f = null;\n \n-        if ( filename != null && filename.length() != 0 )\n+        if ( filename.length() != 0 )\n         {\n             f = new File( filename );\n \n@@ -675,7 +675,11 @@ public File getFile( String filename )\n \n         try\n         {\n-            return f.getCanonicalFile();\n+            if ( f != null )\n+            {\n+                return f.getCanonicalFile();\n+            }\n+            return null;\n         }\n         catch ( IOException e )\n         {\n@@ -740,7 +744,8 @@ public void store()\n     }\n \n     public Schedule getDefaultSchedule()\n-        throws ContinuumStoreException, ConfigurationLoadingException, ContinuumConfigurationException, BuildQueueServiceException\n+        throws ContinuumStoreException, ConfigurationLoadingException, ContinuumConfigurationException,\n+        BuildQueueServiceException\n     {\n         // Schedule\n         Schedule defaultSchedule = scheduleDao.getScheduleByName( DEFAULT_SCHEDULE_NAME );\n@@ -754,28 +759,29 @@ public Schedule getDefaultSchedule()\n \n         return defaultSchedule;\n     }\n-    \n+\n     public BuildQueue getDefaultBuildQueue()\n         throws BuildQueueServiceException\n-    {     \n+    {\n         BuildQueue defaultBuildQueue = buildQueueService.getBuildQueueByName( DEFAULT_BUILD_QUEUE_NAME );\n-    \n+\n         if ( defaultBuildQueue == null )\n         {\n             defaultBuildQueue = createDefaultBuildQueue();\n-            \n+\n             defaultBuildQueue = buildQueueService.addBuildQueue( defaultBuildQueue );\n         }\n-    \n+\n         return defaultBuildQueue;\n     }\n-    \n+\n     // ----------------------------------------------------------------------\n     //\n     // ----------------------------------------------------------------------\n \n     private Schedule createDefaultSchedule()\n-        throws ConfigurationLoadingException, ContinuumConfigurationException, ContinuumStoreException, BuildQueueServiceException\n+        throws ConfigurationLoadingException, ContinuumConfigurationException, ContinuumStoreException,\n+        BuildQueueServiceException\n     {\n \n         log.info( \"create Default Schedule\" );\n@@ -795,22 +801,22 @@ private Schedule createDefaultSchedule()\n         schedule.setCronExpression( systemConf.getDefaultScheduleCronExpression() );\n \n         schedule.setActive( true );\n-        \n+\n         BuildQueue buildQueue = getDefaultBuildQueue();\n-        \n+\n         schedule.addBuildQueue( buildQueue );\n \n         return schedule;\n     }\n-    \n+\n     private BuildQueue createDefaultBuildQueue()\n     {\n         log.info( \"create Default Build Queue\" );\n-        \n+\n         BuildQueue buildQueue = new BuildQueue();\n-        \n-        buildQueue.setName( DEFAULT_BUILD_QUEUE_NAME );        \n-        \n+\n+        buildQueue.setName( DEFAULT_BUILD_QUEUE_NAME );\n+\n         return buildQueue;\n     }\n }",
                "deletions": 33
            },
            {
                "sha": "6163b395af075f32eac235f2c66e834bc21cead1",
                "filename": "continuum-commons/src/test/java/org/apache/continuum/installation/DefaultInstallationServiceTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/installation/DefaultInstallationServiceTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/installation/DefaultInstallationServiceTest.java",
                "status": "modified",
                "changes": 28,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/continuum/installation/DefaultInstallationServiceTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -39,34 +39,14 @@\n public class DefaultInstallationServiceTest\n     extends AbstractContinuumTest\n {\n-    private static final String DEFAULT_INSTALLATION_NAME = \"defaultInstallation\";\n-\n     private static final String NEW_INSTALLATION_NAME = \"newInstallation\";\n \n-    //public Installation defaultInstallation;\n-\n     protected void setUp()\n         throws Exception\n     {\n         super.setUp();\n         DaoUtils daoUtils = (DaoUtils) lookup( DaoUtils.class.getName() );\n         daoUtils.eraseDatabase();\n-        /*if ( getInstallationService().getAllInstallations().isEmpty() )\n-        {\n-            defaultInstallation = createDefault();\n-            ContinuumStore store = getStore();\n-            defaultInstallation = store.addInstallation( defaultInstallation );\n-        }*/\n-    }\n-\n-    private Installation createDefaultInstallation()\n-    {\n-        Installation installation = new Installation();\n-        installation.setType( \"description\" );\n-        installation.setName( DEFAULT_INSTALLATION_NAME );\n-        installation.setVarName( \"varName\" );\n-        installation.setVarValue( \"varValue\" );\n-        return installation;\n     }\n \n     private InstallationService getInstallationService()\n@@ -82,7 +62,7 @@ private Installation addInstallation( String name, String varName, String varVal\n     {\n \n         Installation installation = new Installation();\n-        installation.setType( InstallationService.JDK_TYPE );\n+        installation.setType( type );\n         installation.setName( name );\n         installation.setVarName( varName );\n         installation.setVarValue( varValue );\n@@ -110,7 +90,7 @@ public void testAddDuplicateInstallation()\n         assertEquals( \"bar\", getted.getVarValue() );\n         try\n         {\n-            added = this.addInstallation( NEW_INSTALLATION_NAME, null, \"bar\", InstallationService.JDK_TYPE );\n+            this.addInstallation( NEW_INSTALLATION_NAME, null, \"bar\", InstallationService.JDK_TYPE );\n             fail( \"not in AlreadyExistsInstallationException\" );\n         }\n         catch ( AlreadyExistsInstallationException e )\n@@ -210,11 +190,11 @@ public void testAddInstallationAutomaticProfile()\n         installation.setName( \"automaticJdk\" );\n         installation.setVarName( \"automaticvarName\" );\n         installation.setVarValue( \"automaticvarValue\" );\n-        installation = getInstallationService().add( installation, true );\n+        getInstallationService().add( installation, true );\n         ProfileService profileService = (ProfileService) lookup( ProfileService.ROLE, \"default\" );\n         List<Profile> profiles = profileService.getAllProfiles();\n         assertEquals( 1, profiles.size() );\n-        Profile profile = (Profile) profiles.get( 0 );\n+        Profile profile = profiles.get( 0 );\n         assertEquals( \"automaticJdk\", profile.getName() );\n         Installation jdk = profile.getJdk();\n         assertNotNull( jdk );",
                "deletions": 24
            },
            {
                "sha": "bb20b553db40a0187593bcfb8504f6eebc67b302",
                "filename": "continuum-commons/src/test/java/org/apache/continuum/profile/DefaultProfileServiceTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/profile/DefaultProfileServiceTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/profile/DefaultProfileServiceTest.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/continuum/profile/DefaultProfileServiceTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -168,7 +168,7 @@ public void testAddDuplicateProfile()\n         defaultProfile.setName( name );\n         try\n         {\n-            getted = getProfileService().addProfile( defaultProfile );\n+            getProfileService().addProfile( defaultProfile );\n             fail( \"no AlreadyExistsProfileException with an already exist name \" );\n         }\n         catch ( AlreadyExistsProfileException e )\n@@ -274,7 +274,7 @@ public void testRemoveInstallationLinkedToAProfile()\n         Profile profile = getProfileService().getProfile( jdk1mvn205.getId() );\n         getProfileService().setJdkInProfile( profile, jdk2 );\n \n-        profile = getProfileService().getProfile( jdk1mvn205.getId() );\n+        getProfileService().getProfile( jdk1mvn205.getId() );\n         InstallationService installationService = (InstallationService) lookup( InstallationService.ROLE, \"default\" );\n         installationService.delete( jdk2 );\n     }",
                "deletions": 2
            },
            {
                "sha": "a1c0c82c0e1019a25e5d5ac94b40d6a64b94ef43",
                "filename": "continuum-commons/src/test/java/org/apache/continuum/utils/ContinuumUtilsTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/utils/ContinuumUtilsTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/utils/ContinuumUtilsTest.java",
                "status": "modified",
                "changes": 2,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/continuum/utils/ContinuumUtilsTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -19,8 +19,6 @@\n  * under the License.\n  */\n \n-import org.apache.continuum.utils.ContinuumUtils;\n-\n import junit.framework.TestCase;\n \n /**",
                "deletions": 2
            },
            {
                "sha": "02fc6ae5ef99b83563a2325fe831ec92d9621d44",
                "filename": "continuum-commons/src/test/java/org/apache/continuum/utils/ProjectSorterTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/utils/ProjectSorterTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/continuum/utils/ProjectSorterTest.java",
                "status": "modified",
                "changes": 12,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/continuum/utils/ProjectSorterTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -61,11 +61,11 @@ public void testBasicNestedProjectStructure()\n \n         assertNotNull( sortedList );\n \n-        Project p1 = (Project) sortedList.get( 0 );\n+        Project p1 = sortedList.get( 0 );\n         assertEquals( top.getArtifactId(), p1.getArtifactId() );\n-        Project p2 = (Project) sortedList.get( 1 );\n+        Project p2 = sortedList.get( 1 );\n         assertEquals( c1.getArtifactId(), p2.getArtifactId() );\n-        Project p3 = (Project) sortedList.get( 2 );\n+        Project p3 = sortedList.get( 2 );\n         assertEquals( c2.getArtifactId(), p3.getArtifactId() );\n     }\n \n@@ -96,11 +96,11 @@ public void testIncompleteNestedProjectStructure()\n \n         assertNotNull( sortedList );\n \n-        Project p1 = (Project) sortedList.get( 0 );\n+        Project p1 = sortedList.get( 0 );\n         assertEquals( top.getArtifactId(), p1.getArtifactId() );\n-        Project p2 = (Project) sortedList.get( 1 );\n+        Project p2 = sortedList.get( 1 );\n         assertEquals( c1.getArtifactId(), p2.getArtifactId() );\n-        Project p3 = (Project) sortedList.get( 2 );\n+        Project p3 = sortedList.get( 2 );\n         assertEquals( c2.getArtifactId(), p3.getArtifactId() );\n \n     }",
                "deletions": 6
            },
            {
                "sha": "fceaf588dc6ba02d757fc46807cfab7636ee7a06",
                "filename": "continuum-commons/src/test/java/org/apache/maven/continuum/configuration/ConfigurationServiceTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/maven/continuum/configuration/ConfigurationServiceTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-commons/src/test/java/org/apache/maven/continuum/configuration/ConfigurationServiceTest.java",
                "status": "modified",
                "changes": 22,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/test/java/org/apache/maven/continuum/configuration/ConfigurationServiceTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -65,8 +65,8 @@ public void testLoad()\n         log.info( \"myBuildOutputDir \" + new File( getBasedir(), \"target/myBuildOutputDir\" ).getAbsolutePath() );\n \n         log.info( \"getBuildOutputDirectory \" + service.getBuildOutputDirectory().getAbsolutePath() );\n-        assertEquals( new File( getBasedir(), \"target/myBuildOutputDir\" ).getAbsolutePath(), service\n-            .getBuildOutputDirectory().getAbsolutePath() );\n+        assertEquals( new File( getBasedir(), \"target/myBuildOutputDir\" ).getAbsolutePath(),\n+                      service.getBuildOutputDirectory().getAbsolutePath() );\n     }\n \n     public void testConfigurationService()\n@@ -91,7 +91,7 @@ public void testConfigurationService()\n //        assertEquals( \"working-directory\", service.getWorkingDirectory().getName() );\n \n         assertEquals( \"check # build agents\", 1, service.getBuildAgents().size() );\n-        \n+\n         service.setUrl( \"http://test/zloug\" );\n         service.setBuildOutputDirectory( new File( \"testBuildOutputDir\" ) );\n \n@@ -106,7 +106,7 @@ public void testConfigurationService()\n         service.reload();\n \n         assertEquals( \"http://test/zloug\", service.getUrl() );\n-        assertEquals( \"check # build agents\", 2, service.getBuildAgents().size() );        \n+        assertEquals( \"check # build agents\", 2, service.getBuildAgents().size() );\n         assertEquals( \"http://test/xmlrpc\", service.getBuildAgents().get( 1 ).getUrl() );\n         assertEquals( \"windows\", service.getBuildAgents().get( 1 ).getDescription() );\n         assertFalse( service.getBuildAgents().get( 1 ).isEnabled() );\n@@ -130,9 +130,9 @@ public void testConfigurationService()\n         service.reload();\n         assertEquals( \"check # build agent groups\", 1, service.getBuildAgentGroups().size() );\n         assertEquals( \"group-1\", service.getBuildAgentGroups().get( 0 ).getName() );\n-        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription());\n+        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription() );\n \n-        BuildAgentConfiguration buildAgent2 = new BuildAgentConfiguration( \"http://machine-1/xmlrpc\", \"node-1\", true);\n+        BuildAgentConfiguration buildAgent2 = new BuildAgentConfiguration( \"http://machine-1/xmlrpc\", \"node-1\", true );\n         //buildAgentGroup.addBuildAgent( buildAgent2 );\n         service.addBuildAgent( buildAgentGroup, buildAgent2 );\n \n@@ -142,20 +142,18 @@ public void testConfigurationService()\n         assertEquals( \"check # build agent groups\", 1, service.getBuildAgentGroups().size() );\n         assertEquals( \"check # build agent groups\", 2, service.getBuildAgentGroups().get( 0 ).getBuildAgents().size() );\n         assertEquals( \"group-1\", service.getBuildAgentGroups().get( 0 ).getName() );\n-        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription());     \n+        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription() );\n         assertEquals( \"http://machine-1/xmlrpc\",\n                       service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).getUrl() );\n-        assertEquals( \"node-1\",\n-                      service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).getDescription() );\n-        assertEquals( true,\n-                      service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).isEnabled() );\n+        assertEquals( \"node-1\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).getDescription() );\n+        assertEquals( true, service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 1 ).isEnabled() );\n \n         service.removeBuildAgent( buildAgentGroup, buildAgent2 );\n         service.store();\n         service.reload();\n \n         assertEquals( \"check # build agent groups\", 1, service.getBuildAgentGroups().size() );\n         assertEquals( \"group-1\", service.getBuildAgentGroups().get( 0 ).getName() );\n-        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription());\n+        assertEquals( \"windows\", service.getBuildAgentGroups().get( 0 ).getBuildAgents().get( 0 ).getDescription() );\n     }\n }",
                "deletions": 12
            },
            {
                "sha": "fdbc82bc5b078b6242dd4de0191b0c31f6d4ce67",
                "filename": "continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "status": "modified",
                "changes": 165,
                "additions": 91,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -150,11 +150,13 @@ public void initialize()\n                 {\n                     try\n                     {\n-                        SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( agent.getUrl() ) );\n-                        \n+                        SlaveBuildAgentTransportClient client =\n+                            new SlaveBuildAgentTransportClient( new URL( agent.getUrl() ) );\n+\n                         if ( client.ping() )\n                         {\n-                            log.info( \"agent is enabled, add TaskQueueExecutor for build agent '\" + agent.getUrl() + \"'\" );\n+                            log.info(\n+                                \"agent is enabled, add TaskQueueExecutor for build agent '\" + agent.getUrl() + \"'\" );\n                             addTaskQueueExecutor( agent.getUrl() );\n                         }\n                         else\n@@ -169,12 +171,14 @@ public void initialize()\n                     }\n                     catch ( ContinuumException e )\n                     {\n-                        throw new InitializationException( \"Error while initializing distributed build task queue executors\", e );\n+                        throw new InitializationException(\n+                            \"Error while initializing distributed build task queue executors\", e );\n                     }\n                     catch ( Exception e )\n                     {\n                         agent.setEnabled( false );\n-                        log.info( \"unable to ping build agent '\" + agent.getUrl() + \"': \" + ContinuumUtils.throwableToString( e ) );\n+                        log.info( \"unable to ping build agent '\" + agent.getUrl() + \"': \" +\n+                            ContinuumUtils.throwableToString( e ) );\n                     }\n                 }\n             }\n@@ -185,15 +189,16 @@ public void reload()\n         throws ContinuumException\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n-        \n+\n         for ( BuildAgentConfiguration agent : agents )\n         {\n             if ( agent.isEnabled() && !taskQueueExecutors.containsKey( agent.getUrl() ) )\n             {\n                 try\n                 {\n-                    SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( agent.getUrl() ) );\n-                    \n+                    SlaveBuildAgentTransportClient client =\n+                        new SlaveBuildAgentTransportClient( new URL( agent.getUrl() ) );\n+\n                     if ( client.ping() )\n                     {\n                         log.info( \"agent is enabled, add TaskQueueExecutor for build agent '\" + agent.getUrl() + \"'\" );\n@@ -212,7 +217,8 @@ public void reload()\n                 catch ( Exception e )\n                 {\n                     agent.setEnabled( false );\n-                    log.info( \"unable to ping build agent '\" + agent.getUrl() + \"': \" + ContinuumUtils.throwableToString( e ) );\n+                    log.info( \"unable to ping build agent '\" + agent.getUrl() + \"': \" +\n+                        ContinuumUtils.throwableToString( e ) );\n                 }\n             }\n             else if ( !agent.isEnabled() && taskQueueExecutors.containsKey( agent.getUrl() ) )\n@@ -227,7 +233,8 @@ public void removeAgentFromTaskQueueExecutor( String buildAgentUrl )\n         throws ContinuumException\n     {\n         log.info( \"remove TaskQueueExecutor for build agent '\" + buildAgentUrl + \"'\" );\n-        ThreadedDistributedBuildTaskQueueExecutor executor = (ThreadedDistributedBuildTaskQueueExecutor) taskQueueExecutors.get( buildAgentUrl );\n+        ThreadedDistributedBuildTaskQueueExecutor executor =\n+            (ThreadedDistributedBuildTaskQueueExecutor) taskQueueExecutors.get( buildAgentUrl );\n \n         if ( executor == null )\n         {\n@@ -254,7 +261,7 @@ public void removeAgentFromTaskQueueExecutor( String buildAgentUrl )\n     public boolean isBuildAgentBusy( String buildAgentUrl )\n     {\n         DistributedBuildTaskQueueExecutor executor = taskQueueExecutors.get( buildAgentUrl );\n-        \n+\n         if ( executor != null && executor.getCurrentTask() != null )\n         {\n             log.info( \"build agent '\" + buildAgentUrl + \"' is busy\" );\n@@ -269,9 +276,9 @@ private void addTaskQueueExecutor( String url )\n         throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             DistributedBuildTaskQueueExecutor taskQueueExecutor = (DistributedBuildTaskQueueExecutor) container.\n-                                                                          lookup( DistributedBuildTaskQueueExecutor.class, \"distributed-build-project\" );\n+                lookup( DistributedBuildTaskQueueExecutor.class, \"distributed-build-project\" );\n             taskQueueExecutor.setBuildAgentUrl( url );\n             taskQueueExecutors.put( url, taskQueueExecutor );\n         }\n@@ -284,38 +291,41 @@ private void addTaskQueueExecutor( String url )\n     public void cancelDistributedBuild( String buildAgentUrl, int projectGroupId, String scmRootAddress )\n         throws ContinuumException\n     {\n-        DistributedBuildTaskQueueExecutor taskQueueExecutor = (DistributedBuildTaskQueueExecutor) taskQueueExecutors.get( buildAgentUrl );\n+        DistributedBuildTaskQueueExecutor taskQueueExecutor = taskQueueExecutors.get( buildAgentUrl );\n \n         if ( taskQueueExecutor != null )\n         {\n             if ( taskQueueExecutor.getCurrentTask() != null )\n             {\n                 if ( taskQueueExecutor.getCurrentTask() instanceof PrepareBuildProjectsTask )\n                 {\n-                    PrepareBuildProjectsTask currentTask = (PrepareBuildProjectsTask) taskQueueExecutor.getCurrentTask();\n-                    \n-                    if ( currentTask.getProjectGroupId() == projectGroupId && \n-                         currentTask.getScmRootAddress().equals( scmRootAddress ) )\n+                    PrepareBuildProjectsTask currentTask = (PrepareBuildProjectsTask) taskQueueExecutor.getCurrentTask()\n+                        ;\n+\n+                    if ( currentTask.getProjectGroupId() == projectGroupId &&\n+                        currentTask.getScmRootAddress().equals( scmRootAddress ) )\n                     {\n-                        log.info( \"cancelling task for project group \" + projectGroupId + \n-                                  \" with scm root address \" + scmRootAddress );\n+                        log.info( \"cancelling task for project group \" + projectGroupId + \" with scm root address \" +\n+                            scmRootAddress );\n                         taskQueueExecutor.cancelTask( currentTask );\n \n                         try\n                         {\n-                            SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( buildAgentUrl ) );\n+                            SlaveBuildAgentTransportClient client =\n+                                new SlaveBuildAgentTransportClient( new URL( buildAgentUrl ) );\n                             client.cancelBuild();\n                         }\n                         catch ( Exception e )\n                         {\n                             log.error( \"Error while cancelling build in build agent '\" + buildAgentUrl + \"'\" );\n-                            throw new ContinuumException( \"Error while cancelling build in build agent '\" + buildAgentUrl + \"'\", e );\n+                            throw new ContinuumException(\n+                                \"Error while cancelling build in build agent '\" + buildAgentUrl + \"'\", e );\n                         }\n                     }\n                     else\n                     {\n-                        log.info( \"current task not for project group \" + projectGroupId + \n-                                  \" with scm root address \" + scmRootAddress );\n+                        log.info( \"current task not for project group \" + projectGroupId + \" with scm root address \" +\n+                            scmRootAddress );\n                     }\n                 }\n                 else\n@@ -366,7 +376,7 @@ public void updateBuildResult( Map context )\n             // ----------------------------------------------------------------------\n \n             BuildResult buildResult = convertMapToBuildResult( context );\n-            \n+\n             if ( buildResult.getState() != ContinuumProjectState.CANCELLED )\n             {\n                 buildResult.setBuildDefinition( buildDefinition );\n@@ -385,7 +395,7 @@ else if ( oldBuildResult != null )\n                 }\n \n                 buildResultDao.addBuildResult( project, buildResult );\n-            \n+\n                 project.setOldState( project.getState() );\n                 project.setState( ContinuumBuildConstant.getBuildState( context ) );\n                 project.setBuildNumber( buildNumber );\n@@ -400,10 +410,11 @@ else if ( oldBuildResult != null )\n             projectDao.updateProject( project );\n \n             File buildOutputFile = configurationService.getBuildOutputFile( buildResult.getId(), project.getId() );\n-            \n+\n             FileWriter fstream = new FileWriter( buildOutputFile );\n-            BufferedWriter out = new BufferedWriter(fstream);\n-            out.write( ContinuumBuildConstant.getBuildOutput( context ) == null ? \"\" : ContinuumBuildConstant.getBuildOutput( context ) );\n+            BufferedWriter out = new BufferedWriter( fstream );\n+            out.write( ContinuumBuildConstant.getBuildOutput( context ) == null ? \"\"\n+                : ContinuumBuildConstant.getBuildOutput( context ) );\n             out.close();\n \n             if ( buildResult.getState() != ContinuumProjectState.CANCELLED )\n@@ -433,10 +444,11 @@ public void prepareBuildFinished( Map context )\n \n         try\n         {\n-            ProjectScmRoot scmRoot = projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroupId, scmRootAddress );\n-            \n+            ProjectScmRoot scmRoot =\n+                projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroupId, scmRootAddress );\n+\n             String error = ContinuumBuildConstant.getScmError( context );\n-            \n+\n             if ( StringUtils.isEmpty( error ) )\n             {\n                 scmRoot.setState( ContinuumProjectState.UPDATED );\n@@ -463,12 +475,12 @@ public void prepareBuildFinished( Map context )\n \n         for ( String url : taskQueueExecutors.keySet() )\n         {\n-            DistributedBuildTaskQueueExecutor taskQueueExecutor = (DistributedBuildTaskQueueExecutor) taskQueueExecutors.get( url );\n+            DistributedBuildTaskQueueExecutor taskQueueExecutor = taskQueueExecutors.get( url );\n \n             if ( taskQueueExecutor.getCurrentTask() != null )\n             {\n                 PrepareBuildProjectsTask task = (PrepareBuildProjectsTask) taskQueueExecutor.getCurrentTask();\n-                \n+\n                 map.put( url, task );\n             }\n         }\n@@ -484,7 +496,7 @@ public void prepareBuildFinished( Map context )\n         try\n         {\n             SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( buildAgentUrl ) );\n-            \n+\n             List<Map> installationsList = client.getAvailableInstallations();\n \n             for ( Map context : installationsList )\n@@ -496,15 +508,15 @@ public void prepareBuildFinished( Map context )\n                 installation.setVarValue( ContinuumBuildConstant.getInstallationVarValue( context ) );\n                 installations.add( installation );\n             }\n-            \n+\n             return installations;\n         }\n         catch ( Exception e )\n         {\n             throw new ContinuumException( \"Unable to get available installations of build agent\", e );\n         }\n     }\n-    \n+\n     public void startProjectBuild( int projectId )\n         throws ContinuumException\n     {\n@@ -528,8 +540,9 @@ public void startPrepareBuild( Map context )\n         {\n             int projectGroupId = ContinuumBuildConstant.getProjectGroupId( context );\n             String scmRootAddress = ContinuumBuildConstant.getScmRootAddress( context );\n-            \n-            ProjectScmRoot scmRoot = projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroupId, scmRootAddress );\n+\n+            ProjectScmRoot scmRoot =\n+                projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroupId, scmRootAddress );\n             scmRoot.setOldState( scmRoot.getState() );\n             scmRoot.setState( ContinuumProjectState.UPDATING );\n             projectScmRootDao.updateProjectScmRoot( scmRoot );\n@@ -545,9 +558,9 @@ public void startPrepareBuild( Map context )\n         throws ContinuumException\n     {\n         Map<String, Object> map = new HashMap<String, Object>();\n-        \n+\n         String buildAgentUrl = getBuildAgent( projectId );\n-        \n+\n         if ( buildAgentUrl == null )\n         {\n             return null;\n@@ -558,7 +571,7 @@ public void startPrepareBuild( Map context )\n             SlaveBuildAgentTransportClient client = new SlaveBuildAgentTransportClient( new URL( buildAgentUrl ) );\n \n             Map result = client.getBuildResult( projectId );\n-            \n+\n             if ( result != null )\n             {\n                 int buildDefinitionId = ContinuumBuildConstant.getBuildDefinitionId( result );\n@@ -576,7 +589,7 @@ public void startPrepareBuild( Map context )\n                 buildResult.setScmResult( getScmResult( result ) );\n \n                 String buildOutput = ContinuumBuildConstant.getBuildOutput( result );\n-                \n+\n                 map.put( ContinuumBuildConstant.KEY_BUILD_RESULT, buildResult );\n                 map.put( ContinuumBuildConstant.KEY_BUILD_OUTPUT, buildOutput );\n             }\n@@ -745,6 +758,7 @@ public String getFileContent( int projectId, String directory, String filename )\n         }\n         return \"\";\n     }\n+\n     public boolean shouldBuild( Map context )\n     {\n         try\n@@ -759,7 +773,8 @@ public boolean shouldBuild( Map context )\n \n             BuildDefinition buildDefinition = buildDefinitionDao.getBuildDefinition( buildDefinitionId );\n \n-            BuildResult oldBuildResult = buildResultDao.getLatestBuildResultForBuildDefinition( projectId, buildDefinitionId );\n+            BuildResult oldBuildResult =\n+                buildResultDao.getLatestBuildResultForBuildDefinition( projectId, buildDefinitionId );\n \n             List<ProjectDependency> modifiedDependencies = getModifiedDependencies( oldBuildResult, context );\n \n@@ -814,8 +829,8 @@ else if ( date != null && changes.isEmpty() )\n \n             if ( project.getOldState() != ContinuumProjectState.NEW &&\n                 project.getOldState() != ContinuumProjectState.CHECKEDOUT &&\n-                trigger != ContinuumProjectState.TRIGGER_FORCED &&\n-                project.getState() != ContinuumProjectState.NEW && project.getState() != ContinuumProjectState.CHECKEDOUT )\n+                project.getState() != ContinuumProjectState.NEW &&\n+                project.getState() != ContinuumProjectState.CHECKEDOUT )\n             {\n                 // Check SCM changes\n                 allChangesUnknown = checkAllChangesUnknown( changes );\n@@ -846,7 +861,8 @@ else if ( date != null && changes.isEmpty() )\n             if ( !shouldBuild && ( ( !allChangesUnknown && !changes.isEmpty() ) ||\n                 project.getExecutorId().equals( ContinuumBuildExecutorConstants.MAVEN_TWO_BUILD_EXECUTOR ) ) )\n             {\n-                shouldBuild = shouldBuild( changes, buildDefinition, project, getMavenProjectVersion( context ), getMavenProjectModules( context ) );\n+                shouldBuild = shouldBuild( changes, buildDefinition, project, getMavenProjectVersion( context ),\n+                                           getMavenProjectModules( context ) );\n             }\n \n             if ( shouldBuild )\n@@ -872,15 +888,15 @@ else if ( date != null && changes.isEmpty() )\n         return false;\n     }\n \n-    private boolean shouldBuild( List<ChangeSet> changes, BuildDefinition buildDefinition, Project project, \n+    private boolean shouldBuild( List<ChangeSet> changes, BuildDefinition buildDefinition, Project project,\n                                  String mavenProjectVersion, List<String> mavenProjectModules )\n     {\n         //Check if it's a recursive build\n         boolean isRecursive = false;\n-        if (StringUtils.isNotEmpty( buildDefinition.getArguments() ) )\n+        if ( StringUtils.isNotEmpty( buildDefinition.getArguments() ) )\n         {\n             isRecursive = buildDefinition.getArguments().indexOf( \"-N\" ) < 0 &&\n-                buildDefinition.getArguments().indexOf( \"--non-recursive\" ) < 0 ;\n+                buildDefinition.getArguments().indexOf( \"--non-recursive\" ) < 0;\n         }\n \n         if ( isRecursive && changes != null && !changes.isEmpty() )\n@@ -898,7 +914,7 @@ private boolean shouldBuild( List<ChangeSet> changes, BuildDefinition buildDefin\n             return true;\n         }\n \n-        if ( changes.isEmpty() )\n+        if ( changes == null || changes.isEmpty() )\n         {\n             if ( log.isInfoEnabled() )\n             {\n@@ -933,12 +949,12 @@ private boolean shouldBuild( List<ChangeSet> changes, BuildDefinition buildDefin\n                         if ( log.isDebugEnabled() )\n                         {\n                             log.debug( \"changeFile.name \" + file.getName() + \" removed because in a module\" );\n-                        }                    \n+                        }\n                         files.remove( file );\n                         found = true;\n                         break;\n                     }\n-                    if (log.isDebugEnabled())\n+                    if ( log.isDebugEnabled() )\n                     {\n                         log.debug( \"not removing file \" + file.getName() + \" not in module \" + module );\n                     }\n@@ -990,38 +1006,39 @@ private boolean checkAllChangesUnknown( List<ChangeSet> changes )\n         {\n             return null;\n         }\n-    \n+\n         try\n         {\n             Project project = projectDao.getProjectWithAllDetails( ContinuumBuildConstant.getProjectId( context ) );\n             List<ProjectDependency> dependencies = project.getDependencies();\n-    \n+\n             if ( dependencies == null )\n             {\n                 dependencies = new ArrayList<ProjectDependency>();\n             }\n-    \n+\n             if ( project.getParent() != null )\n             {\n                 dependencies.add( project.getParent() );\n             }\n-    \n+\n             if ( dependencies.isEmpty() )\n             {\n                 return null;\n             }\n-    \n+\n             List<ProjectDependency> modifiedDependencies = new ArrayList<ProjectDependency>();\n-    \n+\n             for ( ProjectDependency dep : dependencies )\n             {\n                 Project dependencyProject =\n                     projectDao.getProject( dep.getGroupId(), dep.getArtifactId(), dep.getVersion() );\n-    \n+\n                 if ( dependencyProject != null )\n                 {\n                     List buildResults = buildResultDao.getBuildResultsInSuccessForProject( dependencyProject.getId(),\n-                                                                                           oldBuildResult.getEndTime() );\n+                                                                                           oldBuildResult.getEndTime() )\n+                        ;\n                     if ( buildResults != null && !buildResults.isEmpty() )\n                     {\n                         log.debug( \"Dependency changed: \" + dep.getGroupId() + \":\" + dep.getArtifactId() + \":\" +\n@@ -1030,36 +1047,36 @@ private boolean checkAllChangesUnknown( List<ChangeSet> changes )\n                     }\n                     else\n                     {\n-                        log.debug( \"Dependency not changed: \" + dep.getGroupId() + \":\" + dep.getArtifactId() +\n-                            \":\" + dep.getVersion() );\n+                        log.debug( \"Dependency not changed: \" + dep.getGroupId() + \":\" + dep.getArtifactId() + \":\" +\n+                            dep.getVersion() );\n                     }\n                 }\n                 else\n                 {\n-                    log.debug( \"Skip non Continuum project: \" + dep.getGroupId() + \":\" + dep.getArtifactId() +\n-                        \":\" + dep.getVersion() );\n+                    log.debug( \"Skip non Continuum project: \" + dep.getGroupId() + \":\" + dep.getArtifactId() + \":\" +\n+                        dep.getVersion() );\n                 }\n             }\n-    \n+\n             return modifiedDependencies;\n         }\n         catch ( ContinuumStoreException e )\n         {\n             log.warn( \"Can't get the project dependencies\", e );\n         }\n-    \n+\n         return null;\n     }\n \n     private String getBuildAgent( int projectId )\n         throws ContinuumException\n     {\n         Map<String, PrepareBuildProjectsTask> map = getDistributedBuildProjects();\n-        \n+\n         for ( String url : map.keySet() )\n         {\n             PrepareBuildProjectsTask task = map.get( url );\n-            \n+\n             for ( Integer id : task.getProjectsBuildDefinitionsMap().keySet() )\n             {\n                 if ( projectId == id )\n@@ -1068,7 +1085,7 @@ private String getBuildAgent( int projectId )\n                 }\n             }\n         }\n-        \n+\n         return null;\n     }\n \n@@ -1122,9 +1139,9 @@ private String getJavaHomeValue( BuildDefinition buildDefinition )\n         return envVars;\n     }\n \n-    private List getScmChanges( Map context )\n+    private List<ChangeSet> getScmChanges( Map context )\n     {\n-        List changes = new ArrayList();\n+        List<ChangeSet> changes = new ArrayList<ChangeSet>();\n         List<Map> scmChanges = ContinuumBuildConstant.getScmChanges( context );\n \n         if ( scmChanges != null )\n@@ -1164,7 +1181,7 @@ private void setChangeFiles( ChangeSet changeSet, Map context )\n     private ProjectDependency getProjectParent( Map context )\n     {\n         Map map = ContinuumBuildConstant.getProjectParent( context );\n-        \n+\n         if ( map != null && map.size() > 0 )\n         {\n             ProjectDependency parent = new ProjectDependency();\n@@ -1183,7 +1200,7 @@ private ProjectDependency getProjectParent( Map context )\n         List<ProjectDependency> projectDependencies = new ArrayList<ProjectDependency>();\n \n         List<Map> dependencies = ContinuumBuildConstant.getProjectDependencies( context );\n-        \n+\n         if ( dependencies != null )\n         {\n             for ( Map map : dependencies )",
                "deletions": 74
            },
            {
                "sha": "44a093382395eadc9fcc47525ea6d3732cca9729",
                "filename": "continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "status": "modified",
                "changes": 297,
                "additions": 156,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -59,12 +59,12 @@\n import org.slf4j.LoggerFactory;\n \n /**\n- * Parallel builds manager. \n- * \n+ * Parallel builds manager.\n+ *\n  * @author <a href=\"mailto:oching@apache.org\">Maria Odea Ching</a>\n  * @version $Id$\n  */\n-public class ParallelBuildsManager    \n+public class ParallelBuildsManager\n     implements BuildsManager, Contextualizable\n {\n     private Logger log = LoggerFactory.getLogger( ParallelBuildsManager.class );\n@@ -84,16 +84,17 @@\n \n     @Resource\n     private ConfigurationService configurationService;\n-        \n+\n     @Resource\n     private BuildQueueService buildQueueService;\n \n     private PlexusContainer container;\n-    \n+\n     /**\n      * @see BuildsManager#buildProject(int, BuildDefinition, String, int, ScmResult)\n      */\n-    public void buildProject( int projectId, BuildDefinition buildDefinition, String projectName, int trigger, ScmResult scmResult )\n+    public void buildProject( int projectId, BuildDefinition buildDefinition, String projectName, int trigger,\n+                              ScmResult scmResult )\n         throws BuildManagerException\n     {\n         try\n@@ -106,10 +107,10 @@ public void buildProject( int projectId, BuildDefinition buildDefinition, String\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while checking if the project is already in queue: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while checking if the project is already in queue: \" + e.getMessage() );\n         }\n-        \n+\n         OverallBuildQueue overallBuildQueue =\n             getOverallBuildQueue( projectId, BUILD_QUEUE, buildDefinition.getSchedule().getBuildQueues() );\n \n@@ -120,10 +121,12 @@ public void buildProject( int projectId, BuildDefinition buildDefinition, String\n         }\n \n         Task buildTask =\n-            new BuildProjectTask( projectId, buildDefinition.getId(), trigger, projectName, buildDefinitionLabel, scmResult );\n+            new BuildProjectTask( projectId, buildDefinition.getId(), trigger, projectName, buildDefinitionLabel,\n+                                  scmResult );\n         try\n         {\n-            log.info( \"Project '\" + projectName + \"' added to overall build queue '\" + overallBuildQueue.getName() + \"'.\" );\n+            log.info(\n+                \"Project '\" + projectName + \"' added to overall build queue '\" + overallBuildQueue.getName() + \"'.\" );\n             overallBuildQueue.addToBuildQueue( buildTask );\n         }\n         catch ( TaskQueueException e )\n@@ -160,17 +163,18 @@ public void buildProjects( List<Project> projects, Map<Integer, BuildDefinition>\n \n         if ( firstProjectId != 0 )\n         {\n-            BuildDefinition buildDef = projectsBuildDefinitionsMap.get( firstProjectId ); \n+            BuildDefinition buildDef = projectsBuildDefinitionsMap.get( firstProjectId );\n             OverallBuildQueue overallBuildQueue =\n                 getOverallBuildQueue( firstProjectId, BUILD_QUEUE, buildDef.getSchedule().getBuildQueues() );\n \n             if ( overallBuildQueue != null )\n-            {                \n+            {\n                 for ( Project project : projects )\n                 {\n                     try\n                     {\n-                        if ( isInQueue( project.getId(), BUILD_QUEUE, projectsBuildDefinitionsMap.get( project.getId() ).getId() ) )\n+                        if ( isInQueue( project.getId(), BUILD_QUEUE,\n+                                        projectsBuildDefinitionsMap.get( project.getId() ).getId() ) )\n                         {\n                             log.warn( \"Project '\" + project.getId() + \"' - '\" + project.getName() +\n                                 \"' is already in build queue.\" );\n@@ -200,13 +204,13 @@ public void buildProjects( List<Project> projects, Map<Integer, BuildDefinition>\n                     {\n                         log.info( \"Project '\" + project.getId() + \"' - '\" + project.getName() +\n                             \"' added to overall build queue '\" + overallBuildQueue.getName() + \"'.\" );\n-                        \n+\n                         overallBuildQueue.addToBuildQueue( buildTask );\n                     }\n                     catch ( TaskQueueException e )\n                     {\n-                        throw new BuildManagerException( \"Error occurred while adding project to build queue: \" +\n-                            e.getMessage() );\n+                        throw new BuildManagerException(\n+                            \"Error occurred while adding project to build queue: \" + e.getMessage() );\n                     }\n                 }\n             }\n@@ -226,7 +230,7 @@ public boolean cancelBuildInQueue( int buildQueueId )\n     {\n         synchronized ( overallBuildQueues )\n         {\n-            OverallBuildQueue overallBuildQueue = null;            \n+            OverallBuildQueue overallBuildQueue = null;\n             overallBuildQueue = overallBuildQueues.get( buildQueueId );\n             if ( overallBuildQueue != null )\n             {\n@@ -296,14 +300,15 @@ public boolean cancelBuild( int projectId )\n             }\n             else\n             {\n-                synchronized( overallBuildQueues )\n+                synchronized ( overallBuildQueues )\n                 {\n                     Set<Integer> keySet = overallBuildQueues.keySet();\n-                    for( Integer key : keySet )\n+                    for ( Integer key : keySet )\n                     {\n                         overallBuildQueue = overallBuildQueues.get( key );\n-                        BuildProjectTask buildTask = (BuildProjectTask) overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask();\n-                        if( buildTask != null && buildTask.getProjectId() == projectId )\n+                        BuildProjectTask buildTask =\n+                            (BuildProjectTask) overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask();\n+                        if ( buildTask != null && buildTask.getProjectId() == projectId )\n                         {\n                             overallBuildQueue.cancelBuildTask( projectId );\n                             return true;\n@@ -317,7 +322,7 @@ public boolean cancelBuild( int projectId )\n         {\n             throw new BuildManagerException( \"Error occurred while cancelling build: \" + e.getMessage() );\n         }\n-        \n+\n         return true;\n     }\n \n@@ -336,14 +341,15 @@ public boolean cancelCheckout( int projectId )\n             }\n             else\n             {\n-                synchronized( overallBuildQueues )\n+                synchronized ( overallBuildQueues )\n                 {\n                     Set<Integer> keySet = overallBuildQueues.keySet();\n-                    for( Integer key : keySet )\n+                    for ( Integer key : keySet )\n                     {\n                         overallBuildQueue = overallBuildQueues.get( key );\n-                        CheckOutTask checkoutTask = (CheckOutTask) overallBuildQueue.getCheckoutTaskQueueExecutor().getCurrentTask();                        \n-                        if( checkoutTask != null && checkoutTask.getProjectId() == projectId )\n+                        CheckOutTask checkoutTask =\n+                            (CheckOutTask) overallBuildQueue.getCheckoutTaskQueueExecutor().getCurrentTask();\n+                        if ( checkoutTask != null && checkoutTask.getProjectId() == projectId )\n                         {\n                             overallBuildQueue.cancelCheckoutTask( projectId );\n                             return true;\n@@ -378,8 +384,8 @@ public void checkoutProject( int projectId, String projectName, File workingDire\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while checking if the project is already in queue: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while checking if the project is already in queue: \" + e.getMessage() );\n         }\n \n         OverallBuildQueue overallBuildQueue =\n@@ -388,19 +394,22 @@ public void checkoutProject( int projectId, String projectName, File workingDire\n             new CheckOutTask( projectId, workingDirectory, projectName, scmUsername, scmPassword );\n         try\n         {\n-            if( overallBuildQueue != null )\n+            if ( overallBuildQueue != null )\n             {\n-                log.info( \"Project '\" + projectName + \"' added to overall build queue '\" + overallBuildQueue.getName() + \"'.\" );\n+                log.info( \"Project '\" + projectName + \"' added to overall build queue '\" + overallBuildQueue.getName() +\n+                    \"'.\" );\n                 overallBuildQueue.addToCheckoutQueue( checkoutTask );\n             }\n             else\n             {\n-                throw new BuildManagerException( \"Unable to add project to checkout queue. No overall build queue configured.\" );\n+                throw new BuildManagerException(\n+                    \"Unable to add project to checkout queue. No overall build queue configured.\" );\n             }\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while adding project to checkout queue: \" + e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while adding project to checkout queue: \" + e.getMessage() );\n         }\n     }\n \n@@ -457,22 +466,23 @@ public boolean isInAnyCheckoutQueue( int projectId )\n      */\n     public boolean isAnyProjectCurrentlyBeingCheckedOut( int[] projectIds )\n         throws BuildManagerException\n-    {        \n-        for( int i = 0; i < projectIds.length; i++ )\n+    {\n+        for ( int projectId : projectIds )\n         {\n             Map<String, Task> checkouts = getCurrentCheckouts();\n             Set<String> keySet = checkouts.keySet();\n-            for( String key : keySet )\n+            for ( String key : keySet )\n             {\n                 CheckOutTask task = (CheckOutTask) checkouts.get( key );\n-                if( task.getProjectId() == projectIds[i] )\n+                if ( task.getProjectId() == projectId )\n                 {\n                     return true;\n                 }\n             }\n         }\n         return false;\n     }\n+\n     /**\n      * @see BuildsManager#isInPrepareBuildQueue(int)\n      */\n@@ -514,14 +524,15 @@ public boolean isInPrepareBuildQueue( int projectId )\n     public boolean isProjectInAnyCurrentBuild( int projectId )\n         throws BuildManagerException\n     {\n-        synchronized( overallBuildQueues )\n+        synchronized ( overallBuildQueues )\n         {\n             Set<Integer> keys = overallBuildQueues.keySet();\n-            for( Integer key : keys )\n+            for ( Integer key : keys )\n             {\n                 OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n-                BuildProjectTask task = (BuildProjectTask) overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask();\n-                if( task != null && task.getProjectId() == projectId )\n+                BuildProjectTask task =\n+                    (BuildProjectTask) overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask();\n+                if ( task != null && task.getProjectId() == projectId )\n                 {\n                     return true;\n                 }\n@@ -533,21 +544,24 @@ public boolean isProjectInAnyCurrentBuild( int projectId )\n     /**\n      * @see BuildsManager#prepareBuildProjects(Map, int, int, String, String, int)\n      */\n-    public void prepareBuildProjects( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger, int projectGroupId, String projectGroupName, String scmRootAddress, int scmRootId )\n+    public void prepareBuildProjects( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger,\n+                                      int projectGroupId, String projectGroupName, String scmRootAddress,\n+                                      int scmRootId )\n         throws BuildManagerException\n     {\n         try\n-        {            \n+        {\n             PrepareBuildProjectsTask task =\n-                new PrepareBuildProjectsTask( projectsBuildDefinitionsMap, trigger, projectGroupId, projectGroupName, scmRootAddress, scmRootId );\n-            \n+                new PrepareBuildProjectsTask( projectsBuildDefinitionsMap, trigger, projectGroupId, projectGroupName,\n+                                              scmRootAddress, scmRootId );\n+\n             log.info( \"Queueing prepare-build-project task '\" + task + \"' to prepare-build queue.\" );\n             prepareBuildQueue.put( task );\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while creating prepare-build-project task: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while creating prepare-build-project task: \" + e.getMessage() );\n         }\n     }\n \n@@ -571,8 +585,8 @@ public void removeProjectFromBuildQueue( int projectId )\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while removing project from build queue: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while removing project from build queue: \" + e.getMessage() );\n         }\n     }\n \n@@ -596,8 +610,8 @@ public void removeProjectFromBuildQueue( int projectId, int buildDefinitionId, i\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while removing project from build queue: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while removing project from build queue: \" + e.getMessage() );\n         }\n     }\n \n@@ -621,8 +635,8 @@ public void removeProjectFromCheckoutQueue( int projectId )\n         }\n         catch ( TaskQueueException e )\n         {\n-            throw new BuildManagerException( \"Error occurred while removing project from checkout queue: \" +\n-                e.getMessage() );\n+            throw new BuildManagerException(\n+                \"Error occurred while removing project from checkout queue: \" + e.getMessage() );\n         }\n     }\n \n@@ -631,25 +645,25 @@ public void removeProjectFromCheckoutQueue( int projectId )\n      */\n     public void removeProjectsFromBuildQueue( int[] projectIds )\n     {\n-        for ( int i = 0; i < projectIds.length; i++ )\n+        for ( int projectId : projectIds )\n         {\n             try\n             {\n-                OverallBuildQueue overallBuildQueue =\n-                    getOverallBuildQueueWhereProjectIsQueued( projectIds[i], BUILD_QUEUE );\n+                OverallBuildQueue overallBuildQueue = getOverallBuildQueueWhereProjectIsQueued( projectId, BUILD_QUEUE )\n+                    ;\n                 if ( overallBuildQueue != null )\n                 {\n-                    overallBuildQueue.removeProjectFromBuildQueue( projectIds[i] );\n+                    overallBuildQueue.removeProjectFromBuildQueue( projectId );\n                 }\n                 else\n                 {\n-                    log.error( \"Project '\" + projectIds[i] + \"' not found in any of the build queues.\" );\n+                    log.error( \"Project '\" + projectId + \"' not found in any of the build queues.\" );\n                     continue;\n                 }\n             }\n             catch ( TaskQueueException e )\n             {\n-                log.error( \"Error occurred while removing project '\" + projectIds[i] + \"' from build queue.\" );\n+                log.error( \"Error occurred while removing project '\" + projectId + \"' from build queue.\" );\n                 continue;\n             }\n         }\n@@ -660,25 +674,25 @@ public void removeProjectsFromBuildQueue( int[] projectIds )\n      */\n     public void removeProjectsFromCheckoutQueue( int[] projectIds )\n     {\n-        for ( int i = 0; i < projectIds.length; i++ )\n+        for ( int projectId : projectIds )\n         {\n             try\n             {\n                 OverallBuildQueue overallBuildQueue =\n-                    getOverallBuildQueueWhereProjectIsQueued( projectIds[i], CHECKOUT_QUEUE );\n+                    getOverallBuildQueueWhereProjectIsQueued( projectId, CHECKOUT_QUEUE );\n                 if ( overallBuildQueue != null )\n                 {\n-                    overallBuildQueue.removeProjectFromCheckoutQueue( projectIds[i] );\n+                    overallBuildQueue.removeProjectFromCheckoutQueue( projectId );\n                 }\n                 else\n                 {\n-                    log.error( \"Project '\" + projectIds[i] + \"' not found in any of the checkout queues.\" );\n+                    log.error( \"Project '\" + projectId + \"' not found in any of the checkout queues.\" );\n                     continue;\n                 }\n             }\n             catch ( TaskQueueException e )\n             {\n-                log.error( \"Error occurred while removing project '\" + projectIds[i] + \"' from checkout queue.\" );\n+                log.error( \"Error occurred while removing project '\" + projectId + \"' from checkout queue.\" );\n                 continue;\n             }\n         }\n@@ -698,7 +712,7 @@ public void removeProjectsFromCheckoutQueueWithHashcodes( int[] hashcodes )\n                 for ( Integer key : keySet )\n                 {\n                     OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n-                    overallBuildQueue.removeTasksFromCheckoutQueueWithHashCodes( hashcodes );                   \n+                    overallBuildQueue.removeTasksFromCheckoutQueueWithHashCodes( hashcodes );\n                 }\n             }\n         }\n@@ -731,7 +745,7 @@ public void removeProjectsFromBuildQueueWithHashcodes( int[] hashcodes )\n             throw new BuildManagerException( \"Error encountered while removing project(s) from build queue.\", e );\n         }\n     }\n-    \n+\n     public boolean removeProjectGroupFromPrepareBuildQueue( int projectGroupId, String scmRootAddress )\n         throws BuildManagerException\n     {\n@@ -754,7 +768,7 @@ public boolean removeProjectGroupFromPrepareBuildQueue( int projectGroupId, Stri\n             throw new BuildManagerException( \"Error while getting the prepare build projects task in queue\", e );\n         }\n     }\n-    \n+\n     /**\n      * @see BuildsManager#addOverallBuildQueue(BuildQueue)\n      */\n@@ -768,7 +782,7 @@ public void addOverallBuildQueue( BuildQueue buildQueue )\n                 OverallBuildQueue overallBuildQueue = (OverallBuildQueue) container.lookup( OverallBuildQueue.class );\n                 overallBuildQueue.setId( buildQueue.getId() );\n                 overallBuildQueue.setName( buildQueue.getName() );\n-                \n+\n                 if ( overallBuildQueues.get( buildQueue.getId() ) == null )\n                 {\n                     log.info( \"Adding overall build queue to map : \" + overallBuildQueue.getName() );\n@@ -780,7 +794,7 @@ public void addOverallBuildQueue( BuildQueue buildQueue )\n                 }\n             }\n             catch ( ComponentLookupException e )\n-            {                \n+            {\n                 throw new BuildManagerException( \"Error creating overall build queue.\", e );\n             }\n         }\n@@ -796,7 +810,7 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n         List<CheckOutTask> checkoutTasks = null;\n \n         synchronized ( overallBuildQueues )\n-        {                        \n+        {\n             OverallBuildQueue overallBuildQueue = overallBuildQueues.get( overallBuildQueueId );\n             if ( overallBuildQueue.getName().equals( ConfigurationService.DEFAULT_BUILD_QUEUE_NAME ) )\n             {\n@@ -805,8 +819,8 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n \n             try\n             {\n-                if( overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask() != null ||\n-                                overallBuildQueue.getCheckoutTaskQueueExecutor().getCurrentTask() != null )\n+                if ( overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask() != null ||\n+                    overallBuildQueue.getCheckoutTaskQueueExecutor().getCurrentTask() != null )\n                 {\n                     throw new BuildManagerException( \"Cannot remove build queue. A task is currently executing.\" );\n                 }\n@@ -824,34 +838,32 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n             catch ( TaskQueueException e )\n             {\n                 throw new BuildManagerException(\n-                                                 \"Cannot remove build queue. An error occurred while retrieving queued tasks.\" );\n+                    \"Cannot remove build queue. An error occurred while retrieving queued tasks.\" );\n             }\n             catch ( ComponentLifecycleException e )\n             {\n                 throw new BuildManagerException(\n-                                                 \"Cannot remove build queue. An error occurred while destroying the build queue: \" +\n-                                                     e.getMessage() );\n+                    \"Cannot remove build queue. An error occurred while destroying the build queue: \" +\n+                        e.getMessage() );\n             }\n             catch ( StoppingException e )\n             {\n                 throw new BuildManagerException(\n-                                                \"Cannot remove build queue. An error occurred while stopping the build queue: \" +\n-                                                    e.getMessage() );\n+                    \"Cannot remove build queue. An error occurred while stopping the build queue: \" + e.getMessage() );\n             }\n \n             this.overallBuildQueues.remove( overallBuildQueueId );\n             log.info( \"Removed overall build queue '\" + overallBuildQueueId + \"' from build queues map.\" );\n         }\n \n-        \n         for ( Task task : tasks )\n-        {            \n+        {\n             BuildProjectTask buildTask = (BuildProjectTask) task;\n             try\n             {\n                 BuildDefinition buildDefinition =\n                     buildDefinitionDao.getBuildDefinition( buildTask.getBuildDefinitionId() );\n-            \n+\n                 buildProject( buildTask.getProjectId(), buildDefinition, buildTask.getProjectName(),\n                               buildTask.getTrigger(), buildTask.getScmResult() );\n             }\n@@ -868,14 +880,14 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n             {\n                 BuildDefinition buildDefinition = buildDefinitionDao.getDefaultBuildDefinition( task.getProjectId() );\n                 checkoutProject( task.getProjectId(), task.getProjectName(), task.getWorkingDirectory(),\n-                                 task.getScmUserName(), task.getScmPassword(), buildDefinition );            \n+                                 task.getScmUserName(), task.getScmPassword(), buildDefinition );\n             }\n             catch ( ContinuumStoreException e )\n             {\n                 log.error( \"Unable to queue checkout task for project '\" + task.getProjectName() + \"'\" );\n                 continue;\n             }\n-        }        \n+        }\n     }\n \n     public Map<Integer, OverallBuildQueue> getOverallBuildQueues()\n@@ -889,19 +901,19 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n     public Map<String, Task> getCurrentBuilds()\n         throws BuildManagerException\n     {\n-        synchronized( overallBuildQueues )\n+        synchronized ( overallBuildQueues )\n         {\n-            Map<String, Task> currentBuilds = new HashMap<String, Task>();            \n+            Map<String, Task> currentBuilds = new HashMap<String, Task>();\n             Set<Integer> keys = overallBuildQueues.keySet();\n-            for( Integer key : keys )\n+            for ( Integer key : keys )\n             {\n-                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );                \n+                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n                 Task task = overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask();\n-                if( task != null )\n+                if ( task != null )\n                 {\n                     currentBuilds.put( overallBuildQueue.getName(), task );\n-                }                \n-            }            \n+                }\n+            }\n             return currentBuilds;\n         }\n     }\n@@ -912,20 +924,20 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n     public Map<String, Task> getCurrentCheckouts()\n         throws BuildManagerException\n     {\n-        synchronized( overallBuildQueues )\n+        synchronized ( overallBuildQueues )\n         {\n             Map<String, Task> currentCheckouts = new HashMap<String, Task>();\n             Set<Integer> keys = overallBuildQueues.keySet();\n-            for( Integer key : keys )\n+            for ( Integer key : keys )\n             {\n-                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );                \n+                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n                 Task task = overallBuildQueue.getCheckoutTaskQueueExecutor().getCurrentTask();\n-                if( task != null )\n+                if ( task != null )\n                 {\n                     currentCheckouts.put( overallBuildQueue.getName(), task );\n-                }                \n-            }            \n-            return currentCheckouts;           \n+                }\n+            }\n+            return currentCheckouts;\n         }\n     }\n \n@@ -948,8 +960,9 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n                 }\n                 catch ( TaskQueueException e )\n                 {\n-                    throw new BuildManagerException( \"Error occurred while getting projects in build queue '\" +\n-                        overallBuildQueue.getName() + \"'.\", e );\n+                    throw new BuildManagerException(\n+                        \"Error occurred while getting projects in build queue '\" + overallBuildQueue.getName() + \"'.\",\n+                        e );\n                 }\n             }\n             return queuedBuilds;\n@@ -975,24 +988,27 @@ public void removeOverallBuildQueue( int overallBuildQueueId )\n                 }\n                 catch ( TaskQueueException e )\n                 {\n-                    throw new BuildManagerException( \"Error occurred while getting projects in build queue '\" +\n-                        overallBuildQueue.getName() + \"'.\", e );\n+                    throw new BuildManagerException(\n+                        \"Error occurred while getting projects in build queue '\" + overallBuildQueue.getName() + \"'.\",\n+                        e );\n                 }\n             }\n             return queuedCheckouts;\n         }\n     }\n-    \n+\n     /**\n      * @see BuildsManager#cancelAllPrepareBuilds()\n      */\n-    public boolean cancelAllPrepareBuilds() throws BuildManagerException\n+    public boolean cancelAllPrepareBuilds()\n+        throws BuildManagerException\n     {\n         try\n         {\n-            TaskQueueExecutor executor = ( TaskQueueExecutor ) container.lookup( TaskQueueExecutor.class, \"prepare-build-project\" );\n-            Task task = executor.getCurrentTask();            \n-            if( task != null )\n+            TaskQueueExecutor executor =\n+                (TaskQueueExecutor) container.lookup( TaskQueueExecutor.class, \"prepare-build-project\" );\n+            Task task = executor.getCurrentTask();\n+            if ( task != null )\n             {\n                 executor.cancelTask( task );\n             }\n@@ -1001,22 +1017,22 @@ public boolean cancelAllPrepareBuilds() throws BuildManagerException\n         {\n             throw new BuildManagerException( \"Error looking up prepare-build-queue.\", e );\n         }\n-        \n+\n         return false;\n     }\n \n     /**\n      * @see BuildsManager#isBuildInProgress()\n      */\n     public boolean isBuildInProgress()\n-    {        \n-        synchronized( overallBuildQueues )\n+    {\n+        synchronized ( overallBuildQueues )\n         {\n             Set<Integer> keySet = overallBuildQueues.keySet();\n-            for( Integer key : keySet )\n+            for ( Integer key : keySet )\n             {\n                 OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n-                if( overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask() != null )\n+                if ( overallBuildQueue.getBuildTaskQueueExecutor().getCurrentTask() != null )\n                 {\n                     return true;\n                 }\n@@ -1111,16 +1127,16 @@ private OverallBuildQueue getOverallBuildQueue( int projectId, int typeOfQueue,\n             }\n \n             int size = 0;\n-            int idx = 0;            \n+            int idx = 0;\n             int allowedBuilds = configurationService.getNumberOfBuildsInParallel();\n-            \n+\n             try\n             {\n                 int count = 1;\n                 for ( BuildQueue buildQueue : buildQueues )\n-                {            \n-                    if( count <= allowedBuilds )\n-                    {   \n+                {\n+                    if ( count <= allowedBuilds )\n+                    {\n                         OverallBuildQueue overallBuildQueue = overallBuildQueues.get( buildQueue.getId() );\n                         if ( overallBuildQueue != null )\n                         {\n@@ -1133,31 +1149,31 @@ else if ( typeOfQueue == CHECKOUT_QUEUE )\n                             {\n                                 taskQueue = overallBuildQueue.getCheckoutQueue();\n                             }\n-                            \n+\n                             if ( idx == 0 )\n                             {\n                                 size = taskQueue.getQueueSnapshot().size();\n                                 whereToBeQueued = overallBuildQueue;\n                             }\n-    \n+\n                             if ( taskQueue.getQueueSnapshot().size() < size )\n                             {\n                                 whereToBeQueued = overallBuildQueue;\n                                 size = taskQueue.getQueueSnapshot().size();\n                             }\n-    \n+\n                             idx++;\n                         }\n                         else\n                         {\n-                            log.error( \"Build queue not found.\" );                            \n+                            log.error( \"Build queue not found.\" );\n                         }\n                         count++;\n                     }\n                     else\n                     {\n                         break;\n-                    }   \n+                    }\n                 }\n             }\n             catch ( TaskQueueException e )\n@@ -1168,12 +1184,12 @@ else if ( typeOfQueue == CHECKOUT_QUEUE )\n \n         // use default overall build queue if none is configured\n         if ( whereToBeQueued == null )\n-        {                \n+        {\n             Set<Integer> keySet = overallBuildQueues.keySet();\n-            for( Integer key : keySet )\n+            for ( Integer key : keySet )\n             {\n-                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );                \n-                if( overallBuildQueue.getName().equals( ConfigurationService.DEFAULT_BUILD_QUEUE_NAME ) )\n+                OverallBuildQueue overallBuildQueue = overallBuildQueues.get( key );\n+                if ( overallBuildQueue.getName().equals( ConfigurationService.DEFAULT_BUILD_QUEUE_NAME ) )\n                 {\n                     return overallBuildQueue;\n                 }\n@@ -1182,26 +1198,26 @@ else if ( typeOfQueue == CHECKOUT_QUEUE )\n \n         return whereToBeQueued;\n     }\n-    \n+\n     public void contextualize( Context context )\n         throws ContextException\n     {\n-        container = (PlexusContainer) context.get( PlexusConstants.PLEXUS_KEY ); \n-        \n+        container = (PlexusContainer) context.get( PlexusConstants.PLEXUS_KEY );\n+\n         synchronized ( overallBuildQueues )\n         {\n             try\n             {\n                 // create all the build queues configured in the database, not just the default!               \n                 List<BuildQueue> buildQueues = buildQueueService.getAllBuildQueues();\n-                for( BuildQueue buildQueue : buildQueues )\n-                {   \n+                for ( BuildQueue buildQueue : buildQueues )\n+                {\n                     createOverallBuildQueue( buildQueue );\n-                }               \n+                }\n \n                 // add default overall build queue if not yet added to the map\n                 BuildQueue defaultBuildQueue = configurationService.getDefaultBuildQueue();\n-                if( overallBuildQueues.get( defaultBuildQueue.getId() ) == null )\n+                if ( overallBuildQueues.get( defaultBuildQueue.getId() ) == null )\n                 {\n                     createOverallBuildQueue( defaultBuildQueue );\n                 }\n@@ -1221,32 +1237,31 @@ public void setContainer( PlexusContainer container )\n     {\n         this.container = container;\n     }\n-    \n+\n     private OverallBuildQueue createOverallBuildQueue( BuildQueue defaultBuildQueue )\n         throws ComponentLookupException\n     {\n-        OverallBuildQueue overallBuildQueue =\n-            (OverallBuildQueue) container.lookup( OverallBuildQueue.class );\n+        OverallBuildQueue overallBuildQueue = (OverallBuildQueue) container.lookup( OverallBuildQueue.class );\n         overallBuildQueue.setId( defaultBuildQueue.getId() );\n         overallBuildQueue.setName( defaultBuildQueue.getName() );\n-    \n+\n         overallBuildQueues.put( overallBuildQueue.getId(), overallBuildQueue );\n-        \n+\n         return overallBuildQueue;\n     }\n-    \n+\n     public TaskQueue getPrepareBuildQueue()\n     {\n         return prepareBuildQueue;\n     }\n-    \n+\n     public void setPrepareBuildQueue( TaskQueue prepareBuildQueue )\n     {\n         this.prepareBuildQueue = prepareBuildQueue;\n     }\n-    \n+\n     // for unit tests.. \n-    \n+\n     public void setOverallBuildQueues( Map<Integer, OverallBuildQueue> overallBuildQueues )\n     {\n         this.overallBuildQueues = overallBuildQueues;\n@@ -1261,7 +1276,7 @@ public void setBuildQueueService( BuildQueueService buildQueueService )\n     {\n         this.buildQueueService = buildQueueService;\n     }\n-    \n+\n     public void setBuildDefinitionDao( BuildDefinitionDao buildDefinitionDao )\n     {\n         this.buildDefinitionDao = buildDefinitionDao;",
                "deletions": 141
            },
            {
                "sha": "11c57136edbf82237f6f3aaa9b38adac6eb15735",
                "filename": "continuum-core/src/main/java/org/apache/continuum/taskqueue/DefaultOverallBuildQueue.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/taskqueue/DefaultOverallBuildQueue.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/taskqueue/DefaultOverallBuildQueue.java",
                "status": "modified",
                "changes": 63,
                "additions": 28,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/taskqueue/DefaultOverallBuildQueue.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -41,26 +41,26 @@\n \n /**\n  * \"Overall\" build queue which has a checkout queue and a build queue.\n- * \n+ *\n  * @author <a href=\"mailto:oching@apache.org\">Maria Odea Ching</a>\n  * @version $Id$\n  */\n-public class DefaultOverallBuildQueue   \n+public class DefaultOverallBuildQueue\n     implements OverallBuildQueue\n {\n     @Resource\n     private BuildDefinitionDao buildDefinitionDao;\n-    \n+\n     private TaskQueueExecutor buildTaskQueueExecutor;\n-    \n+\n     private TaskQueueExecutor checkoutTaskQueueExecutor;\n \n     private int id;\n \n     private String name;\n-    \n+\n     private Logger log = LoggerFactory.getLogger( DefaultOverallBuildQueue.class );\n-    \n+\n     public int getId()\n     {\n         return id;\n@@ -175,11 +175,7 @@ public boolean removeProjectsFromCheckoutQueue( int[] projectsId )\n                 }\n             }\n         }\n-        if ( !tasks.isEmpty() )\n-        {\n-            return getCheckoutQueue().removeAll( tasks );\n-        }\n-        return false;\n+        return !tasks.isEmpty() && getCheckoutQueue().removeAll( tasks );\n     }\n \n     /**\n@@ -244,7 +240,7 @@ public boolean isInBuildQueue( int projectId )\n     public boolean isInBuildQueue( int projectId, int buildDefinitionId )\n         throws TaskQueueException\n     {\n-        List<Task> queue = getProjectsInBuildQueue();        \n+        List<Task> queue = getProjectsInBuildQueue();\n         for ( Task task : queue )\n         {\n             BuildProjectTask buildTask = (BuildProjectTask) task;\n@@ -259,7 +255,8 @@ public boolean isInBuildQueue( int projectId, int buildDefinitionId )\n                 }\n                 else\n                 {\n-                    if ( buildTask.getProjectId() == projectId && buildTask.getBuildDefinitionId() == buildDefinitionId )\n+                    if ( buildTask.getProjectId() == projectId &&\n+                        buildTask.getBuildDefinitionId() == buildDefinitionId )\n                     {\n                         return true;\n                     }\n@@ -275,27 +272,27 @@ public boolean isInBuildQueue( int projectId, int buildDefinitionId )\n     public void cancelBuildTask( int projectId )\n     {\n         BuildProjectTask task = (BuildProjectTask) buildTaskQueueExecutor.getCurrentTask();\n-        if( task != null && task.getProjectId() == projectId )\n+        if ( task != null && task.getProjectId() == projectId )\n         {\n-            log.info( \"Cancelling build task for project '\" + projectId + \"' in task executor '\" +\n-                                 buildTaskQueueExecutor );\n+            log.info(\n+                \"Cancelling build task for project '\" + projectId + \"' in task executor '\" + buildTaskQueueExecutor );\n             buildTaskQueueExecutor.cancelTask( task );\n-        }        \n+        }\n     }\n-    \n+\n     /**\n      * @see OverallBuildQueue#cancelCheckoutTask(int)\n      */\n     public void cancelCheckoutTask( int projectId )\n         throws TaskQueueException\n     {\n         CheckOutTask task = (CheckOutTask) checkoutTaskQueueExecutor.getCurrentTask();\n-        if( task != null && task.getProjectId() == projectId )\n+        if ( task != null && task.getProjectId() == projectId )\n         {\n             log.info( \"Cancelling checkout task for project '\" + projectId + \"' in task executor '\" +\n-                                 checkoutTaskQueueExecutor );\n-            checkoutTaskQueueExecutor.cancelTask( task );            \n-        }    \n+                checkoutTaskQueueExecutor );\n+            checkoutTaskQueueExecutor.cancelTask( task );\n+        }\n     }\n \n     /**\n@@ -304,26 +301,26 @@ public void cancelCheckoutTask( int projectId )\n     public boolean cancelCurrentBuild()\n     {\n         Task task = buildTaskQueueExecutor.getCurrentTask();\n-        if( task != null )\n+        if ( task != null )\n         {\n             return buildTaskQueueExecutor.cancelTask( task );\n         }\n-        \n+\n         log.info( \"No build task currently executing on build executor: \" + buildTaskQueueExecutor );\n         return false;\n     }\n-    \n+\n     /**\n      * @see OverallBuildQueue#cancelCurrentCheckout()\n      */\n     public boolean cancelCurrentCheckout()\n     {\n         Task task = checkoutTaskQueueExecutor.getCurrentTask();\n-        if( task != null )\n+        if ( task != null )\n         {\n             return checkoutTaskQueueExecutor.cancelTask( task );\n         }\n-        \n+\n         log.info( \"No checkout task currently executing on checkout task executor: \" + checkoutTaskQueueExecutor );\n         return false;\n     }\n@@ -392,12 +389,8 @@ public boolean removeProjectsFromBuildQueue( int[] projectIds )\n         {\n             log.info( \"cancel build for project \" + buildProjectTask.getProjectId() );\n         }\n-        if ( !tasks.isEmpty() )\n-        {\n-            return getBuildQueue().removeAll( tasks );\n-        }\n \n-        return false;\n+        return !tasks.isEmpty() && getBuildQueue().removeAll( tasks );\n     }\n \n     /**\n@@ -435,20 +428,20 @@ public void removeProjectsFromBuildQueueWithHashCodes( int[] hashCodes )\n         }\n     }\n \n-    /** \n+    /**\n      * @see OverallBuildQueue#getCheckoutQueue()\n      */\n     public TaskQueue getCheckoutQueue()\n     {\n-        return ( ( ParallelBuildsThreadedTaskQueueExecutor ) checkoutTaskQueueExecutor ).getQueue();\n+        return ( (ParallelBuildsThreadedTaskQueueExecutor) checkoutTaskQueueExecutor ).getQueue();\n     }\n \n     /**\n      * @see OverallBuildQueue#getBuildQueue()\n      */\n     public TaskQueue getBuildQueue()\n     {\n-        return ( ( ParallelBuildsThreadedTaskQueueExecutor ) buildTaskQueueExecutor ).getQueue();\n+        return ( (ParallelBuildsThreadedTaskQueueExecutor) buildTaskQueueExecutor ).getQueue();\n     }\n \n     /**",
                "deletions": 35
            },
            {
                "sha": "824ffa72a552c90438d48fe3d4efd302413a678b",
                "filename": "continuum-core/src/main/java/org/apache/continuum/taskqueue/manager/DefaultTaskQueueManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/taskqueue/manager/DefaultTaskQueueManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/continuum/taskqueue/manager/DefaultTaskQueueManager.java",
                "status": "modified",
                "changes": 139,
                "additions": 65,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/taskqueue/manager/DefaultTaskQueueManager.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -58,7 +58,7 @@\n public class DefaultTaskQueueManager\n     implements TaskQueueManager, Contextualizable\n {\n-\tprivate Logger log = LoggerFactory.getLogger( DefaultTaskQueueManager.class );\n+    private Logger log = LoggerFactory.getLogger( DefaultTaskQueueManager.class );\n \n     /**\n      * @plexus.requirement role-hint=\"distributed-build-project\"\n@@ -74,12 +74,12 @@\n      * @plexus.requirement role-hint=\"prepare-release\"\n      */\n     private TaskQueue prepareReleaseQueue;\n-    \n+\n     /**\n      * @plexus.requirement role-hint=\"perform-release\"\n      */\n     private TaskQueue performReleaseQueue;\n-    \n+\n     /**\n      * @plexus.requirement\n      */\n@@ -89,12 +89,12 @@\n      * @plexus.requirement\n      */\n     private PurgeConfigurationService purgeConfigurationService;\n-    \n+\n     /**\n-     * @plexus.requirement role-hint=\"parallel\" \n+     * @plexus.requirement role-hint=\"parallel\"\n      */\n     private BuildsManager buildsManager;\n-    \n+\n     private PlexusContainer container;\n \n     public TaskQueue getDistributedBuildQueue()\n@@ -131,7 +131,8 @@ public boolean isInDistributedBuildQueue( int projectGroupId, String scmRootAddr\n             {\n                 if ( task != null )\n                 {\n-                    if ( task.getProjectGroupId() == projectGroupId && task.getScmRootAddress().equals( scmRootAddress ) )\n+                    if ( task.getProjectGroupId() == projectGroupId &&\n+                        task.getScmRootAddress().equals( scmRootAddress ) )\n                     {\n                         return true;\n                     }\n@@ -145,12 +146,12 @@ public boolean isInDistributedBuildQueue( int projectGroupId, String scmRootAddr\n             throw new TaskQueueManagerException( \"Error while getting the tasks in distributed build queue\", e );\n         }\n     }\n-    \n+\n     public boolean isInPurgeQueue( int purgeConfigId )\n         throws TaskQueueManagerException\n     {\n         List<PurgeTask> queue = getAllPurgeConfigurationsInPurgeQueue();\n-    \n+\n         for ( PurgeTask task : queue )\n         {\n             if ( task != null && task.getPurgeConfigurationId() == purgeConfigId )\n@@ -160,13 +161,13 @@ public boolean isInPurgeQueue( int purgeConfigId )\n         }\n         return false;\n     }\n-    \n+\n     public boolean isRepositoryInPurgeQueue( int repositoryId )\n         throws TaskQueueManagerException\n     {\n         List<RepositoryPurgeConfiguration> repoPurgeConfigs =\n             purgeConfigurationService.getRepositoryPurgeConfigurationsByRepository( repositoryId );\n-    \n+\n         for ( RepositoryPurgeConfiguration repoPurge : repoPurgeConfigs )\n         {\n             if ( isInPurgeQueue( repoPurge.getId() ) )\n@@ -176,53 +177,53 @@ public boolean isRepositoryInPurgeQueue( int repositoryId )\n         }\n         return false;\n     }\n-    \n+\n     public boolean isRepositoryInUse( int repositoryId )\n         throws TaskQueueManagerException\n     {\n-    \ttry\n-    \t{\n-    \t\tMap<String, Task> currentBuilds = buildsManager.getCurrentBuilds();\n-    \t\tSet<String> keys = currentBuilds.keySet();\n-    \t\t\n-    \t\tfor( String key : keys )\n-    \t\t{\n-    \t\t\tTask task = currentBuilds.get( key );\n-    \t\t\tif ( task != null && task instanceof BuildProjectTask )\n+        try\n+        {\n+            Map<String, Task> currentBuilds = buildsManager.getCurrentBuilds();\n+            Set<String> keys = currentBuilds.keySet();\n+\n+            for ( String key : keys )\n+            {\n+                Task task = currentBuilds.get( key );\n+                if ( task != null && task instanceof BuildProjectTask )\n                 {\n                     int projectId = ( (BuildProjectTask) task ).getProjectId();\n-        \n+\n                     Project project = projectDao.getProject( projectId );\n                     LocalRepository repository = project.getProjectGroup().getLocalRepository();\n-        \n+\n                     if ( repository != null && repository.getId() == repositoryId )\n                     {\n                         return true;\n                     }\n                 }\n-    \t\t}\n+            }\n \n             return false;\n-    \t}\n-    \tcatch ( BuildManagerException e )\n-    \t{\n-    \t\tlog.error( \"Error occured while getting current builds: \" + e.getMessage() );\n-    \t\tthrow new TaskQueueManagerException( e.getMessage(), e );\n-    \t}\n-    \tcatch ( ContinuumStoreException e )\n-    \t{\n-    \t\tlog.error( \"Error occured while getting project details: \" + e.getMessage() );\n-    \t\tthrow new TaskQueueManagerException( e.getMessage(), e );\n-    \t}\n+        }\n+        catch ( BuildManagerException e )\n+        {\n+            log.error( \"Error occured while getting current builds: \" + e.getMessage() );\n+            throw new TaskQueueManagerException( e.getMessage(), e );\n+        }\n+        catch ( ContinuumStoreException e )\n+        {\n+            log.error( \"Error occured while getting project details: \" + e.getMessage() );\n+            throw new TaskQueueManagerException( e.getMessage(), e );\n+        }\n     }\n-    \n+\n     public boolean isProjectInReleaseStage( String releaseId )\n         throws TaskQueueManagerException\n     {\n-        Task prepareTask = getCurrentTask( \"prepare-release\" );        \n-        if( prepareTask != null && prepareTask instanceof PrepareReleaseProjectTask )\n+        Task prepareTask = getCurrentTask( \"prepare-release\" );\n+        if ( prepareTask != null && prepareTask instanceof PrepareReleaseProjectTask )\n         {\n-            if( ( ( PrepareReleaseProjectTask ) prepareTask ).getReleaseId().equals( releaseId ) )\n+            if ( ( (PrepareReleaseProjectTask) prepareTask ).getReleaseId().equals( releaseId ) )\n             {\n                 return true;\n             }\n@@ -232,9 +233,9 @@ public boolean isProjectInReleaseStage( String releaseId )\n                 {\n                     // check if in queue\n                     List<Task> tasks = prepareReleaseQueue.getQueueSnapshot();\n-                    for( Task prepareReleaseTask : tasks )\n+                    for ( Task prepareReleaseTask : tasks )\n                     {\n-                        if( ( ( PrepareReleaseProjectTask) prepareReleaseTask ).getReleaseId().equals( releaseId ) ) \n+                        if ( ( (PrepareReleaseProjectTask) prepareReleaseTask ).getReleaseId().equals( releaseId ) )\n                         {\n                             return true;\n                         }\n@@ -246,11 +247,11 @@ public boolean isProjectInReleaseStage( String releaseId )\n                 }\n             }\n         }\n-        \n-        Task performTask = getCurrentTask( \"perform-release\" );        \n-        if( performTask != null && performTask instanceof PerformReleaseProjectTask )\n+\n+        Task performTask = getCurrentTask( \"perform-release\" );\n+        if ( performTask != null && performTask instanceof PerformReleaseProjectTask )\n         {\n-            if( ( ( PerformReleaseProjectTask ) performTask ).getReleaseId().equals( releaseId ) )\n+            if ( ( (PerformReleaseProjectTask) performTask ).getReleaseId().equals( releaseId ) )\n             {\n                 return true;\n             }\n@@ -260,9 +261,9 @@ public boolean isProjectInReleaseStage( String releaseId )\n                 {\n                     // check if in queue\n                     List<Task> tasks = performReleaseQueue.getQueueSnapshot();\n-                    for( Task performReleaseTask : tasks )\n+                    for ( Task performReleaseTask : tasks )\n                     {\n-                        if( ( ( PerformReleaseProjectTask) performReleaseTask ).getReleaseId().equals( releaseId ) ) \n+                        if ( ( (PerformReleaseProjectTask) performReleaseTask ).getReleaseId().equals( releaseId ) )\n                         {\n                             return true;\n                         }\n@@ -274,28 +275,23 @@ public boolean isProjectInReleaseStage( String releaseId )\n                 }\n             }\n         }\n-                \n+\n         return false;\n     }\n \n     public boolean releaseInProgress()\n         throws TaskQueueManagerException\n     {\n         Task task = getCurrentTask( \"perform-release\" );\n-    \n-        if ( task != null && task instanceof PerformReleaseProjectTask )\n-        {\n-            return true;\n-        }\n-    \n-        return false;\n+\n+        return task != null && task instanceof PerformReleaseProjectTask;\n     }\n \n     public void removeFromDistributedBuildQueue( int projectGroupId, String scmRootAddress )\n         throws TaskQueueManagerException\n     {\n         List<PrepareBuildProjectsTask> queue = getDistributedBuildProjectsInQueue();\n-        \n+\n         for ( PrepareBuildProjectsTask task : queue )\n         {\n             if ( task.getProjectGroupId() == projectGroupId && task.getScmRootAddress().equals( scmRootAddress ) )\n@@ -309,7 +305,7 @@ public boolean removeFromPurgeQueue( int purgeConfigId )\n         throws TaskQueueManagerException\n     {\n         List<PurgeTask> queue = getAllPurgeConfigurationsInPurgeQueue();\n-    \n+\n         for ( PurgeTask task : queue )\n         {\n             if ( task != null && task.getPurgeConfigurationId() == purgeConfigId )\n@@ -327,16 +323,16 @@ public boolean removeFromPurgeQueue( int[] purgeConfigIds )\n         {\n             return false;\n         }\n-    \n+\n         if ( purgeConfigIds.length < 1 )\n         {\n             return false;\n         }\n-    \n+\n         List<PurgeTask> queue = getAllPurgeConfigurationsInPurgeQueue();\n-    \n+\n         List<PurgeTask> tasks = new ArrayList<PurgeTask>();\n-    \n+\n         for ( PurgeTask task : queue )\n         {\n             if ( task != null )\n@@ -347,21 +343,16 @@ public boolean removeFromPurgeQueue( int[] purgeConfigIds )\n                 }\n             }\n         }\n-    \n-        if ( !tasks.isEmpty() )\n-        {\n-            return purgeQueue.removeAll( tasks );\n-        }\n-    \n-        return false;\n+\n+        return !tasks.isEmpty() && purgeQueue.removeAll( tasks );\n     }\n-    \n+\n     public void removeRepositoryFromPurgeQueue( int repositoryId )\n         throws TaskQueueManagerException\n     {\n         List<RepositoryPurgeConfiguration> repoPurgeConfigs =\n             purgeConfigurationService.getRepositoryPurgeConfigurationsByRepository( repositoryId );\n-    \n+\n         for ( RepositoryPurgeConfiguration repoPurge : repoPurgeConfigs )\n         {\n             removeFromPurgeQueue( repoPurge.getId() );\n@@ -372,7 +363,7 @@ public void removeTasksFromDistributedBuildQueueWithHashCodes( int[] hashCodes )\n         throws TaskQueueManagerException\n     {\n         List<PrepareBuildProjectsTask> queue = getDistributedBuildProjectsInQueue();\n-        \n+\n         for ( PrepareBuildProjectsTask task : queue )\n         {\n             if ( ArrayUtils.contains( hashCodes, task.hashCode() ) )\n@@ -381,13 +372,13 @@ public void removeTasksFromDistributedBuildQueueWithHashCodes( int[] hashCodes )\n             }\n         }\n     }\n-    \n+\n     public void contextualize( Context context )\n         throws ContextException\n     {\n         container = (PlexusContainer) context.get( PlexusConstants.PLEXUS_KEY );\n     }\n-    \n+\n     private List<PurgeTask> getAllPurgeConfigurationsInPurgeQueue()\n         throws TaskQueueManagerException\n     {\n@@ -400,7 +391,7 @@ public void contextualize( Context context )\n             throw new TaskQueueManagerException( \"Error while getting the purge configs in purge queue\", e );\n         }\n     }\n-    \n+\n     private Task getCurrentTask( String task )\n         throws TaskQueueManagerException\n     {",
                "deletions": 74
            },
            {
                "sha": "29829ce3ce7bf2a3bdda47256fb51b4f733ce5ab",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 485,
                "additions": 208,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -177,7 +177,7 @@\n      * @plexus.requirement\n      */\n     private ProjectScmRootDao projectScmRootDao;\n-    \n+\n     /**\n      * @plexus.requirement\n      */\n@@ -255,12 +255,12 @@\n      * @plexus.requirement\n      */\n     private TaskQueueManager taskQueueManager;\n-    \n+\n     /**\n      * @plexus.requirement role-hint=\"parallel\"\n      */\n     private BuildsManager parallelBuildsManager;\n-        \n+\n     /**\n      * @plexus.requirement\n      */\n@@ -318,7 +318,7 @@ public RepositoryService getRepositoryService()\n     {\n         return repositoryService;\n     }\n-    \n+\n     public TaskQueueManager getTaskQueueManager()\n     {\n         return taskQueueManager;\n@@ -328,7 +328,7 @@ public PurgeConfigurationService getPurgeConfigurationService()\n     {\n         return purgeConfigurationService;\n     }\n-    \n+\n     public BuildsManager getBuildsManager()\n     {\n         return parallelBuildsManager;\n@@ -391,45 +391,45 @@ public void removeProjectGroup( int projectGroupId )\n         ProjectGroup projectGroup = getProjectGroupWithProjects( projectGroupId );\n \n         if ( projectGroup != null )\n-        {   \n+        {\n             List<Project> projects = projectGroup.getProjects();\n             int[] projectIds = new int[projects.size()];\n-            \n+\n             int idx = 0;\n-            for( Project project : projects )\n+            for ( Project project : projects )\n             {\n                 projectIds[idx] = project.getId();\n                 idx++;\n             }\n-            \n+\n             // check if any project is still being checked out\n             // canceling the checkout and proceeding with the delete results to a cannot delete directory error!\n             try\n-            {            \n-                if( parallelBuildsManager.isAnyProjectCurrentlyBeingCheckedOut( projectIds ) )\n+            {\n+                if ( parallelBuildsManager.isAnyProjectCurrentlyBeingCheckedOut( projectIds ) )\n                 {\n                     throw new ContinuumException(\n-                                                  \"Unable to delete group. At least one project in group is still being checked out.\" );\n+                        \"Unable to delete group. At least one project in group is still being checked out.\" );\n                 }\n             }\n             catch ( BuildManagerException e )\n             {\n                 throw new ContinuumException( \"Unable to delete group.\", e );\n             }\n-        \n+\n             for ( int i = 0; i < projectIds.length; i++ )\n             {\n                 removeProject( projectIds[i] );\n             }\n-        }\n \n-        log.info( \"Remove project group \" + projectGroup.getName() + \"(\" + projectGroup.getId() + \")\" );\n+            log.info( \"Remove project group \" + projectGroup.getName() + \"(\" + projectGroup.getId() + \")\" );\n \n-        Map context = new HashMap();\n-        context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, new Integer( projectGroup.getId() ) );\n-        executeAction( \"remove-assignable-roles\", context );\n+            Map context = new HashMap();\n+            context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, projectGroup.getId() );\n+            executeAction( \"remove-assignable-roles\", context );\n \n-        projectGroupDao.removeProjectGroup( projectGroup );\n+            projectGroupDao.removeProjectGroup( projectGroup );\n+        }\n     }\n \n     public void addProjectGroup( ProjectGroup projectGroup )\n@@ -459,11 +459,11 @@ public void addProjectGroup( ProjectGroup projectGroup )\n             {\n                 ProjectGroup new_pg = projectGroupDao.addProjectGroup( projectGroup );\n \n-                buildDefinitionService.addBuildDefinitionTemplateToProjectGroup( new_pg.getId(), buildDefinitionService\n-                    .getDefaultMavenTwoBuildDefinitionTemplate() );\n+                buildDefinitionService.addBuildDefinitionTemplateToProjectGroup( new_pg.getId(),\n+                                                                                 buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate() );\n \n                 Map context = new HashMap();\n-                context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, new Integer( new_pg.getId() ) );\n+                context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, new_pg.getId() );\n                 executeAction( \"add-assignable-roles\", context );\n \n                 log.info( \"Added new project group: \" + new_pg.getName() );\n@@ -624,7 +624,8 @@ public void removeProject( int projectId )\n         {\n             Project project = getProjectWithBuilds( projectId );\n \n-            List<ContinuumReleaseResult> releaseResults = releaseResultDao.getContinuumReleaseResultsByProject( projectId );\n+            List<ContinuumReleaseResult> releaseResults =\n+                releaseResultDao.getContinuumReleaseResultsByProject( projectId );\n \n             ProjectScmRoot scmRoot = getProjectScmRootByProject( projectId );\n \n@@ -635,7 +636,8 @@ public void removeProject( int projectId )\n                     releaseResultDao.removeContinuumReleaseResult( releaseResult );\n                 }\n \n-                File releaseOutputDirectory = configurationService.getReleaseOutputDirectory( project.getProjectGroup().getId() );\n+                File releaseOutputDirectory =\n+                    configurationService.getReleaseOutputDirectory( project.getProjectGroup().getId() );\n \n                 if ( releaseOutputDirectory != null )\n                 {\n@@ -654,14 +656,14 @@ public void removeProject( int projectId )\n             log.info( \"Remove project \" + project.getName() + \"(\" + projectId + \")\" );\n \n             try\n-            {                \n+            {\n                 parallelBuildsManager.removeProjectFromCheckoutQueue( projectId );\n-                \n-                parallelBuildsManager.removeProjectFromBuildQueue( projectId );                \n-                \n+\n+                parallelBuildsManager.removeProjectFromBuildQueue( projectId );\n+\n                 //parallelBuildsManager.cancelCheckout( projectId );\n-                \n-                parallelBuildsManager.cancelBuild( projectId );                \n+\n+                parallelBuildsManager.cancelBuild( projectId );\n             }\n             catch ( BuildManagerException e )\n             {\n@@ -707,13 +709,13 @@ public void checkoutProject( int projectId )\n     {\n         Map<String, Object> context = new HashMap<String, Object>();\n \n-        context.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n+        context.put( AbstractContinuumAction.KEY_PROJECT_ID, projectId );\n \n         try\n         {\n             BuildDefinition buildDefinition = buildDefinitionDao.getDefaultBuildDefinition( projectId );\n             context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, buildDefinition );\n-            \n+\n             executeAction( \"add-project-to-checkout-queue\", context );\n         }\n         catch ( ContinuumStoreException e )\n@@ -774,15 +776,15 @@ public void buildProjectsWithBuildDefinition( List<Project> projects, List<Build\n         throws ContinuumException\n     {\n         Collection<Project> filteredProjectsList = getProjectsNotInReleaseStage( projects );\n-        \n+\n         prepareBuildProjects( filteredProjectsList, bds, true, ContinuumProjectState.TRIGGER_FORCED );\n     }\n \n     public void buildProjectsWithBuildDefinition( List<Project> projects, int buildDefinitionId )\n         throws ContinuumException\n     {\n         Collection<Project> filteredProjectsList = getProjectsNotInReleaseStage( projects );\n-        \n+\n         prepareBuildProjects( filteredProjectsList, buildDefinitionId, ContinuumProjectState.TRIGGER_FORCED );\n     }\n \n@@ -807,9 +809,9 @@ public void buildProjects( int trigger )\n \n             projectsList = getProjects();\n         }\n-        \n-        Collection<Project> filteredProjectsList = getProjectsNotInReleaseStage( projectsList );    \n-        \n+\n+        Collection<Project> filteredProjectsList = getProjectsNotInReleaseStage( projectsList );\n+\n         prepareBuildProjects( filteredProjectsList, null, true, trigger );\n     }\n \n@@ -837,7 +839,7 @@ public void buildProjects( int trigger, int buildDefinitionId )\n         }\n \n         Collection<Project> filteredProjectsList = getProjectsNotInReleaseStage( projectsList );\n-        \n+\n         prepareBuildProjects( filteredProjectsList, buildDefinitionId, trigger );\n     }\n \n@@ -851,8 +853,8 @@ public void buildProjectGroup( int projectGroupId )\n         throws ContinuumException\n     {\n         List<BuildDefinition> groupDefaultBDs = null;\n-        \n-        if( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n+\n+        if ( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n         {\n             groupDefaultBDs = getDefaultBuildDefinitionsForProjectGroup( projectGroupId );\n \n@@ -870,7 +872,7 @@ public void buildProjectGroup( int projectGroupId )\n     public void buildProjectGroupWithBuildDefinition( int projectGroupId, int buildDefinitionId )\n         throws ContinuumException\n     {\n-        if( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n+        if ( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n         {\n             List<BuildDefinition> bds = new ArrayList<BuildDefinition>();\n             BuildDefinition bd = getBuildDefinition( buildDefinitionId );\n@@ -892,22 +894,24 @@ private void buildProjectGroupWithBuildDefinition( int projectGroupId, List<Buil\n                                                        boolean checkDefaultBuildDefinitionForProject )\n         throws ContinuumException\n     {\n-        if( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n+        if ( !isAnyProjectInGroupInReleaseStage( projectGroupId ) )\n         {\n             Collection<Project> projectsList;\n-    \n+\n             try\n             {\n-                projectsList = getProjectsInBuildOrder( projectDao.getProjectsWithDependenciesByGroupId( projectGroupId ) );\n+                projectsList =\n+                    getProjectsInBuildOrder( projectDao.getProjectsWithDependenciesByGroupId( projectGroupId ) );\n             }\n             catch ( CycleDetectedException e )\n             {\n                 log.warn( \"Cycle detected while sorting projects for building, falling back to unsorted build.\" );\n-    \n+\n                 projectsList = getProjects();\n             }\n-            \n-            prepareBuildProjects( projectsList, bds, checkDefaultBuildDefinitionForProject, ContinuumProjectState.TRIGGER_FORCED );\n+\n+            prepareBuildProjects( projectsList, bds, checkDefaultBuildDefinitionForProject,\n+                                  ContinuumProjectState.TRIGGER_FORCED );\n         }\n     }\n \n@@ -954,31 +958,33 @@ public void buildProjects( Schedule schedule )\n \n         for ( Project project : projectsList )\n         {\n-            List<Integer> buildDefIds = (List<Integer>) projectsMap.get( new Integer( project.getId() ) );\n+            List<Integer> buildDefIds = (List<Integer>) projectsMap.get( project.getId() );\n \n             if ( buildDefIds != null && !buildDefIds.isEmpty() )\n             {\n                 for ( Integer buildDefId : buildDefIds )\n                 {\n                     try\n                     {\n-                        if ( buildDefId != null && !parallelBuildsManager.isInAnyBuildQueue( project.getId(), buildDefId.intValue() ) &&\n-                                !parallelBuildsManager.isInAnyCheckoutQueue( project.getId() ) && !parallelBuildsManager.isInPrepareBuildQueue( project.getId() ) )\n+                        if ( buildDefId != null &&\n+                            !parallelBuildsManager.isInAnyBuildQueue( project.getId(), buildDefId ) &&\n+                            !parallelBuildsManager.isInAnyCheckoutQueue( project.getId() ) &&\n+                            !parallelBuildsManager.isInPrepareBuildQueue( project.getId() ) )\n                         {\n                             ProjectScmRoot scmRoot = getProjectScmRootByProject( project.getId() );\n \n                             Map<Integer, Integer> projectsAndBuildDefinitionsMap = map.get( scmRoot );\n-                            \n+\n                             if ( projectsAndBuildDefinitionsMap == null )\n                             {\n                                 projectsAndBuildDefinitionsMap = new HashMap<Integer, Integer>();\n                             }\n-                            \n+\n                             projectsAndBuildDefinitionsMap.put( project.getId(), buildDefId );\n-                            \n+\n                             map.put( scmRoot, projectsAndBuildDefinitionsMap );\n                         }\n-                    } \n+                    }\n                     catch ( BuildManagerException e )\n                     {\n                         throw new ContinuumException( e.getMessage(), e );\n@@ -1005,8 +1011,8 @@ public void buildProjectWithBuildDefinition( int projectId, int buildDefinitionI\n     public void buildProject( int projectId, int trigger )\n         throws ContinuumException\n     {\n-        Project project = getProject( projectId );        \n-        if( isProjectInReleaseStage( project ) )\n+        Project project = getProject( projectId );\n+        if ( isProjectInReleaseStage( project ) )\n         {\n             throw new ContinuumException( \"Project (id=\" + projectId + \") is currently in release stage.\" );\n         }\n@@ -1020,9 +1026,9 @@ public void buildProject( int projectId, int trigger )\n \n         try\n         {\n-            if ( parallelBuildsManager.isInAnyBuildQueue( projectId, buildDef.getId() ) || \n-                            parallelBuildsManager.isInAnyCheckoutQueue( projectId ) ||\n-                            parallelBuildsManager.isInPrepareBuildQueue( projectId ) )           \n+            if ( parallelBuildsManager.isInAnyBuildQueue( projectId, buildDef.getId() ) ||\n+                parallelBuildsManager.isInAnyCheckoutQueue( projectId ) ||\n+                parallelBuildsManager.isInPrepareBuildQueue( projectId ) )\n             {\n                 return;\n             }\n@@ -1034,26 +1040,26 @@ public void buildProject( int projectId, int trigger )\n \n         Map<Integer, Integer> projectsBuildDefinitionsMap = new HashMap<Integer, Integer>();\n         projectsBuildDefinitionsMap.put( projectId, buildDef.getId() );\n-        \n+\n         ProjectScmRoot scmRoot = getProjectScmRootByProject( projectId );\n-        prepareBuildProjects( projectsBuildDefinitionsMap, trigger, scmRoot.getScmRootAddress(), \n+        prepareBuildProjects( projectsBuildDefinitionsMap, trigger, scmRoot.getScmRootAddress(),\n                               scmRoot.getProjectGroup().getId(), scmRoot.getId() );\n     }\n \n     public void buildProject( int projectId, int buildDefinitionId, int trigger )\n         throws ContinuumException\n     {\n         Project project = getProject( projectId );\n-        if( isProjectInReleaseStage( project ) )\n+        if ( isProjectInReleaseStage( project ) )\n         {\n             throw new ContinuumException( \"Project (id=\" + projectId + \") is currently in release stage.\" );\n         }\n-        \n+\n         try\n         {\n-            if ( parallelBuildsManager.isInAnyBuildQueue( projectId, buildDefinitionId ) || \n-                            parallelBuildsManager.isInAnyCheckoutQueue( projectId ) ||\n-                            parallelBuildsManager.isInPrepareBuildQueue( projectId ))\n+            if ( parallelBuildsManager.isInAnyBuildQueue( projectId, buildDefinitionId ) ||\n+                parallelBuildsManager.isInAnyCheckoutQueue( projectId ) ||\n+                parallelBuildsManager.isInPrepareBuildQueue( projectId ) )\n             {\n                 return;\n             }\n@@ -1067,7 +1073,7 @@ public void buildProject( int projectId, int buildDefinitionId, int trigger )\n         projectsBuildDefinitionsMap.put( projectId, buildDefinitionId );\n \n         ProjectScmRoot scmRoot = getProjectScmRootByProject( projectId );\n-        prepareBuildProjects( projectsBuildDefinitionsMap, trigger, scmRoot.getScmRootAddress(), \n+        prepareBuildProjects( projectsBuildDefinitionsMap, trigger, scmRoot.getScmRootAddress(),\n                               scmRoot.getProjectGroup().getId(), scmRoot.getId() );\n     }\n \n@@ -1154,7 +1160,7 @@ public String getBuildOutput( int projectId, int buildId )\n         {\n             if ( buildResultsIterator.hasNext() )\n             {\n-                BuildResult buildResult = (BuildResult) buildResultsIterator.next();\n+                BuildResult buildResult = buildResultsIterator.next();\n \n                 if ( buildResult.getId() == buildResultId )\n                 {\n@@ -1172,7 +1178,7 @@ public String getBuildOutput( int projectId, int buildId )\n             return null;\n         }\n \n-        BuildResult buildResult = (BuildResult) buildResultsIterator.next();\n+        BuildResult buildResult = buildResultsIterator.next();\n \n         List<ChangeSet> changes = null;\n \n@@ -1195,7 +1201,7 @@ public String getBuildOutput( int projectId, int buildId )\n                 return changes;\n             }\n \n-            buildResult = (BuildResult) buildResultsIterator.next();\n+            buildResult = buildResultsIterator.next();\n         }\n \n         if ( changes == null )\n@@ -1251,8 +1257,7 @@ public ContinuumProjectBuildingResult addMavenOneProject( String metadataUrl, bo\n         {\n             return executeAddProjectsFromMetadataActivity( metadataUrl, MavenOneContinuumProjectBuilder.ID,\n                                                            getDefaultProjectGroup().getId(), checkProtocol,\n-                                                           buildDefinitionService\n-                                                               .getDefaultMavenOneBuildDefinitionTemplate().getId() );\n+                                                           buildDefinitionService.getDefaultMavenOneBuildDefinitionTemplate().getId() );\n         }\n         catch ( BuildDefinitionServiceException e )\n         {\n@@ -1314,8 +1319,8 @@ public ContinuumProjectBuildingResult addMavenTwoProject( String metadataUrl, bo\n         try\n         {\n             return executeAddProjectsFromMetadataActivity( metadataUrl, MavenTwoContinuumProjectBuilder.ID, -1,\n-                                                           checkProtocol, buildDefinitionService\n-                .getDefaultMavenTwoBuildDefinitionTemplate().getId() );\n+                                                           checkProtocol,\n+                                                           buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate().getId() );\n         }\n         catch ( BuildDefinitionServiceException e )\n         {\n@@ -1344,8 +1349,7 @@ public ContinuumProjectBuildingResult addMavenTwoProject( String metadataUrl, in\n         {\n             return executeAddProjectsFromMetadataActivity( metadataUrl, MavenTwoContinuumProjectBuilder.ID,\n                                                            projectGroupId, checkProtocol, useCredentialsCache, true,\n-                                                           buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate()\n-                                                               .getId() );\n+                                                           buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate().getId() );\n         }\n         catch ( BuildDefinitionServiceException e )\n         {\n@@ -1362,8 +1366,8 @@ public ContinuumProjectBuildingResult addMavenTwoProject( String metadataUrl, in\n         {\n             return executeAddProjectsFromMetadataActivity( metadataUrl, MavenTwoContinuumProjectBuilder.ID,\n                                                            projectGroupId, checkProtocol, useCredentialsCache,\n-                                                           recursiveProjects, buildDefinitionService\n-                .getDefaultMavenTwoBuildDefinitionTemplate().getId() );\n+                                                           recursiveProjects,\n+                                                           buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate().getId() );\n         }\n         catch ( BuildDefinitionServiceException e )\n         {\n@@ -1478,10 +1482,10 @@ private int executeAddProjectFromScmActivity( Project project, int groupId )\n \n         context.put( AbstractContinuumAction.KEY_UNVALIDATED_PROJECT_GROUP, projectGroup );\n \n-        context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, new Integer( projectGroup.getId() ) );\n-        \n+        context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, projectGroup.getId() );\n+\n         // used by BuildManager to determine on which build queue will the project be put\n-        context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, ( BuildDefinition ) project.getBuildDefinitions().get( 0 ) );\n+        context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, project.getBuildDefinitions().get( 0 ) );\n \n         executeAction( \"validate-project\", context );\n \n@@ -1494,7 +1498,7 @@ private int executeAddProjectFromScmActivity( Project project, int groupId )\n \n         executeAction( \"add-assignable-roles\", context );\n \n-        return ( (Integer) context.get( AbstractContinuumAction.KEY_PROJECT_ID ) ).intValue();\n+        return (Integer) context.get( AbstractContinuumAction.KEY_PROJECT_ID );\n     }\n \n     private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( String metadataUrl,\n@@ -1535,11 +1539,9 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n \n         context.put( CreateProjectsFromMetadataAction.KEY_URL, metadataUrl );\n \n-        context.put( CreateProjectsFromMetadataAction.KEY_LOAD_RECURSIVE_PROJECTS, Boolean\n-            .valueOf( loadRecursiveProjects ) );\n+        context.put( CreateProjectsFromMetadataAction.KEY_LOAD_RECURSIVE_PROJECTS, loadRecursiveProjects );\n \n-        context.put( CreateProjectsFromMetadataAction.KEY_SCM_USE_CREDENTIALS_CACHE, Boolean\n-            .valueOf( useCredentialsCache ) );\n+        context.put( CreateProjectsFromMetadataAction.KEY_SCM_USE_CREDENTIALS_CACHE, useCredentialsCache );\n \n         context.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n \n@@ -1548,8 +1550,8 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n         {\n             try\n             {\n-                context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION_TEMPLATE, buildDefinitionService\n-                    .getBuildDefinitionTemplate( buildDefintionTemplateId ) );\n+                context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION_TEMPLATE,\n+                             buildDefinitionService.getBuildDefinitionTemplate( buildDefintionTemplateId ) );\n             }\n             catch ( BuildDefinitionServiceException e )\n             {\n@@ -1562,8 +1564,9 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n \n         executeAction( \"create-projects-from-metadata\", context );\n \n-        ContinuumProjectBuildingResult result = (ContinuumProjectBuildingResult) context\n-            .get( CreateProjectsFromMetadataAction.KEY_PROJECT_BUILDING_RESULT );\n+        ContinuumProjectBuildingResult result =\n+            (ContinuumProjectBuildingResult) context.get( CreateProjectsFromMetadataAction.KEY_PROJECT_BUILDING_RESULT )\n+            ;\n \n         if ( log.isInfoEnabled() )\n         {\n@@ -1599,14 +1602,11 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n             throw new ContinuumException( \"The project building result has to contain exactly one project group.\" );\n         }\n \n-        ProjectGroup projectGroup = (ProjectGroup) result.getProjectGroups().iterator().next();\n-\n+        ProjectGroup projectGroup = result.getProjectGroups().iterator().next();\n \n         ProjectScmRoot projectScmRoot;\n \n-\n         boolean projectGroupCreation = false;\n-        \n \n         try\n         {\n@@ -1618,13 +1618,11 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n \n                     projectGroupId = projectGroup.getId();\n \n-                    log.info(\n-                        \"Using existing project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n+                    log.info( \"Using existing project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n                 }\n                 catch ( ContinuumObjectNotFoundException e )\n                 {\n-                    log.info(\n-                        \"Creating project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n+                    log.info( \"Creating project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n \n                     Map pgContext = new HashMap();\n \n@@ -1637,20 +1635,20 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n                     executeAction( \"store-project-group\", pgContext );\n \n                     projectGroupId = AbstractContinuumAction.getProjectGroupId( pgContext );\n-                    \n+\n                     projectGroupCreation = true;\n                 }\n             }\n \n             projectGroup = projectGroupDao.getProjectGroupWithBuildDetailsByProjectGroupId( projectGroupId );\n \n             String url = (String) context.get( CreateProjectsFromMetadataAction.KEY_URL );\n-            \n+\n             projectScmRoot = getProjectScmRootByProjectGroupAndScmRootAddress( projectGroup.getId(), url );\n-            \n+\n             if ( projectScmRoot == null )\n             {\n-                projectScmRoot = createProjectScmRoot( projectGroup, url );\n+                createProjectScmRoot( projectGroup, url );\n             }\n \n             /* add the project group loaded from database, which has more info, like id */\n@@ -1701,17 +1699,17 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n                 // if no group creation \n                 if ( !projectGroupCreation && buildDefintionTemplateId > 0 )\n                 {\n-                    buildDefinitionService.addTemplateInProject( buildDefintionTemplateId, projectDao\n-                        .getProject( project.getId() ) );\n-                }                \n-                \n+                    buildDefinitionService.addTemplateInProject( buildDefintionTemplateId,\n+                                                                 projectDao.getProject( project.getId() ) );\n+                }\n+\n                 context.put( AbstractContinuumAction.KEY_UNVALIDATED_PROJECT, project );\n                 //\n                 //            executeAction( \"validate-project\", context );\n                 //\n                 //            executeAction( \"store-project\", context );\n                 //\n-                context.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( project.getId() ) );\n+                context.put( AbstractContinuumAction.KEY_PROJECT_ID, project.getId() );\n \n                 if ( !StringUtils.isEmpty( scmUserName ) )\n                 {\n@@ -1727,17 +1725,21 @@ protected ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity(\n                 // olamy  : read again the project to have values because store.updateProjectGroup( projectGroup ); \n                 // remove object data -> we don't display the project name in the build queue\n                 context.put( AbstractContinuumAction.KEY_PROJECT, projectDao.getProject( project.getId() ) );\n-                \n+\n                 BuildDefinition defaultBuildDefinition = null;\n-                if( projectBuilderId.equals( MavenTwoContinuumProjectBuilder.ID ) )\n+                if ( projectBuilderId.equals( MavenTwoContinuumProjectBuilder.ID ) )\n                 {\n-                    defaultBuildDefinition = ( BuildDefinition ) buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate().getBuildDefinitions().get( 0 );\n+                    defaultBuildDefinition =\n+                        (BuildDefinition) buildDefinitionService.getDefaultMavenTwoBuildDefinitionTemplate().getBuildDefinitions().get(\n+                            0 );\n                 }\n-                else if( projectBuilderId.equals( MavenOneContinuumProjectBuilder.ID ) )\n+                else if ( projectBuilderId.equals( MavenOneContinuumProjectBuilder.ID ) )\n                 {\n-                    defaultBuildDefinition = ( BuildDefinition ) buildDefinitionService.getDefaultMavenOneBuildDefinitionTemplate().getBuildDefinitions().get( 0 );\n+                    defaultBuildDefinition =\n+                        (BuildDefinition) buildDefinitionService.getDefaultMavenOneBuildDefinitionTemplate().getBuildDefinitions().get(\n+                            0 );\n                 }\n-                    \n+\n                 // used by BuildManager to determine on which build queue will the project be put\n                 context.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, defaultBuildDefinition );\n \n@@ -1757,7 +1759,7 @@ else if( projectBuilderId.equals( MavenOneContinuumProjectBuilder.ID ) )\n             throw new ContinuumException( \"Error adding projects from modules\", e );\n         }\n \n-        context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, new Integer( projectGroup.getId() ) );\n+        context.put( AbstractContinuumAction.KEY_PROJECT_GROUP_ID, projectGroup.getId() );\n         // add the relevent security administration roles for this project\n         if ( addAssignableRoles )\n         {\n@@ -1868,52 +1870,6 @@ public ProjectNotifier updateGroupNotifier( int projectGroupId, ProjectNotifier\n         return addGroupNotifier( projectGroupId, notifier );\n     }\n \n-    /*\n-    public ProjectNotifier updateNotifier( int projectId, int notifierId, Map configuration )\n-        throws ContinuumException\n-    {\n-        Project project = getProjectWithAllDetails( projectId );\n-\n-        ProjectNotifier notifier = getNotifier( projectId, notifierId );\n-\n-        String notifierType = notifier.getType();\n-\n-        // I remove notifier then add it instead of update it due to a ClassCastException in jpox\n-        project.removeNotifier( notifier );\n-\n-        updateProject( project );\n-\n-        return addNotifier( projectId, notifierType, configuration );\n-    }\n-\n-    private Properties createNotifierProperties( Map configuration )\n-    {\n-        Properties notifierProperties = new Properties();\n-\n-        for ( Iterator i = configuration.keySet().iterator(); i.hasNext(); )\n-        {\n-            Object key = i.next();\n-\n-            Object value = configuration.get( key );\n-\n-            if ( value instanceof String )\n-            {\n-                String val = (String) value;\n-                if ( !\"sendOnSuccess\".equals( val ) && !\"sendOnFailure\".equals( val ) && !\"sendOnError\".equals( val ) &&\n-                    !\"sendOnWarning\".equals( val ) )\n-                {\n-                    if ( !StringUtils.isEmpty( val ) )\n-                    {\n-                        notifierProperties.setProperty( (String) key, val );\n-                    }\n-                }\n-            }\n-        }\n-\n-        return notifierProperties;\n-    }\n-    */\n-\n     public ProjectNotifier addNotifier( int projectId, ProjectNotifier notifier )\n         throws ContinuumException\n     {\n@@ -1980,42 +1936,6 @@ public ProjectNotifier addGroupNotifier( int projectGroupId, ProjectNotifier not\n         return notif;\n     }\n \n-    /*\n-    public ProjectNotifier addNotifier( int projectId, String notifierType, Map configuration )\n-        throws ContinuumException\n-    {\n-        ProjectNotifier notifier = new ProjectNotifier();\n-\n-        notifier.setType( notifierType );\n-\n-        // ----------------------------------------------------------------------\n-        // Needs to be properties ... but data comes in via a Map\n-        // ----------------------------------------------------------------------\n-\n-        Properties notifierProperties = createNotifierProperties( configuration );\n-\n-        boolean sendOnSuccess = convertBoolean( (String) configuration.get( \"sendOnSuccess\" ) );\n-\n-        notifier.setSendOnSuccess( sendOnSuccess );\n-\n-        boolean sendOnFailure = convertBoolean( (String) configuration.get( \"sendOnFailure\" ) );\n-\n-        notifier.setSendOnFailure( sendOnFailure );\n-\n-        boolean sendOnError = convertBoolean( (String) configuration.get( \"sendOnError\" ) );\n-\n-        notifier.setSendOnError( sendOnError );\n-\n-        boolean sendOnWarning = convertBoolean( (String) configuration.get( \"sendOnWarning\" ) );\n-\n-        notifier.setSendOnWarning( sendOnWarning );\n-\n-        notifier.setConfiguration( notifierProperties );\n-\n-        return addNotifier( projectId, notifier );\n-    }\n-    */\n-\n     public void removeNotifier( int projectId, int notifierId )\n         throws ContinuumException\n     {\n@@ -2382,7 +2302,7 @@ public void updateSchedule( int scheduleId, Map<String, String> configuration )\n \n         schedule.setDelay( Integer.parseInt( configuration.get( \"schedule.delay\" ) ) );\n \n-        schedule.setActive( Boolean.valueOf( configuration.get( \"schedule.active\" ) ).booleanValue() );\n+        schedule.setActive( Boolean.valueOf( configuration.get( \"schedule.active\" ) ) );\n \n         updateSchedule( schedule, true );\n     }\n@@ -2631,8 +2551,8 @@ public void initialize()\n \n                 try\n                 {\n-                    log.info( \"Fix project state for project \" + project.getId() + \":\" + project.getName() +\n-                        \":\" + project.getVersion() );\n+                    log.info( \"Fix project state for project \" + project.getId() + \":\" + project.getName() + \":\" +\n+                        project.getVersion() );\n \n                     projectDao.updateProject( project );\n \n@@ -2664,7 +2584,7 @@ public void initialize()\n                 try\n                 {\n                     log.info( \"Fix state for projectScmRoot \" + projectScmRoot.getScmRootAddress() );\n-                    \n+\n                     projectScmRootDao.updateProjectScmRoot( projectScmRoot );\n                 }\n                 catch ( ContinuumStoreException e )\n@@ -3223,7 +3143,8 @@ public ContinuumReleaseResult getContinuumReleaseResult( int releaseResultId )\n         return releaseResultDao.getContinuumReleaseResultsByProjectGroup( projectGroupId );\n     }\n \n-    public ContinuumReleaseResult getContinuumReleaseResult( int projectId, String releaseGoal, long startTime, long endTime )\n+    public ContinuumReleaseResult getContinuumReleaseResult( int projectId, String releaseGoal, long startTime,\n+                                                             long endTime )\n         throws ContinuumException\n     {\n         try\n@@ -3232,7 +3153,9 @@ public ContinuumReleaseResult getContinuumReleaseResult( int projectId, String r\n         }\n         catch ( ContinuumStoreException e )\n         {\n-            throw new ContinuumException( \"Error while retrieving continuumReleaseResult of projectId \" + projectId + \" with releaseGoal: \" + releaseGoal, e);\n+            throw new ContinuumException(\n+                \"Error while retrieving continuumReleaseResult of projectId \" + projectId + \" with releaseGoal: \" +\n+                    releaseGoal, e );\n         }\n     }\n \n@@ -3245,7 +3168,8 @@ public String getReleaseOutput( int releaseResultId )\n \n         try\n         {\n-            return configurationService.getReleaseOutput( projectGroup.getId(), \"releases-\" + releaseResult.getStartTime() );\n+            return configurationService.getReleaseOutput( projectGroup.getId(),\n+                                                          \"releases-\" + releaseResult.getStartTime() );\n         }\n         catch ( ConfigurationException e )\n         {\n@@ -3280,12 +3204,12 @@ public ProjectScmRoot getProjectScmRootByProject( int projectId )\n     {\n         Project project = getProject( projectId );\n         ProjectGroup group = getProjectGroupByProjectId( projectId );\n-        \n+\n         List<ProjectScmRoot> scmRoots = getProjectScmRootByProjectGroup( group.getId() );\n-        \n+\n         for ( ProjectScmRoot scmRoot : scmRoots )\n         {\n-            if( project.getScmUrl() != null && project.getScmUrl().startsWith( scmRoot.getScmRootAddress() ) )\n+            if ( project.getScmUrl() != null && project.getScmUrl().startsWith( scmRoot.getScmRootAddress() ) )\n             {\n                 return scmRoot;\n             }\n@@ -3331,31 +3255,35 @@ private void removeProjectScmRoot( ProjectScmRoot projectScmRoot )\n             {\n                 projectScmRootDao.removeProjectScmRoot( projectScmRoot );\n             }\n-    \t\tcatch ( ContinuumStoreException e )\n-    \t\t{\n-    \t\t    log.error( \"Failed to remove project scm root '\" + projectScmRoot.getScmRootAddress() + \"'\", e );\n-    \t\t    throw new ContinuumException( \"Error while removing project scm root '\" + projectScmRoot.getScmRootAddress() + \"'\", e );\n-    \t\t}\n+            catch ( ContinuumStoreException e )\n+            {\n+                log.error( \"Failed to remove project scm root '\" + projectScmRoot.getScmRootAddress() + \"'\", e );\n+                throw new ContinuumException(\n+                    \"Error while removing project scm root '\" + projectScmRoot.getScmRootAddress() + \"'\", e );\n+            }\n         }\n         else\n         {\n-            log.info( \"Project scm root '\" + projectScmRoot.getScmRootAddress() + \"' still has projects, not removing\" );\n+            log.info(\n+                \"Project scm root '\" + projectScmRoot.getScmRootAddress() + \"' still has projects, not removing\" );\n         }\n     }\n \n-    public BuildQueue addBuildQueue( BuildQueue buildQueue ) throws ContinuumException\n+    public BuildQueue addBuildQueue( BuildQueue buildQueue )\n+        throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             return buildQueueService.addBuildQueue( buildQueue );\n         }\n         catch ( BuildQueueServiceException e )\n         {\n             throw new ContinuumException( \"Error adding build queue to the database.\", e );\n         }\n     }\n-    \n-    public BuildQueue getBuildQueue( int buildQueueId ) throws ContinuumException\n+\n+    public BuildQueue getBuildQueue( int buildQueueId )\n+        throws ContinuumException\n     {\n         try\n         {\n@@ -3366,73 +3294,78 @@ public BuildQueue getBuildQueue( int buildQueueId ) throws ContinuumException\n             throw new ContinuumException( \"Error retrieving build queue.\", e );\n         }\n     }\n-    \n-    public BuildQueue getBuildQueueByName( String buildQueueName ) throws ContinuumException\n+\n+    public BuildQueue getBuildQueueByName( String buildQueueName )\n+        throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             return buildQueueService.getBuildQueueByName( buildQueueName );\n         }\n         catch ( BuildQueueServiceException e )\n         {\n             throw new ContinuumException( \"Error retrieving build queue.\", e );\n         }\n     }\n-    \n-    public void removeBuildQueue( BuildQueue buildQueue ) throws ContinuumException\n+\n+    public void removeBuildQueue( BuildQueue buildQueue )\n+        throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             buildQueueService.removeBuildQueue( buildQueue );\n         }\n         catch ( BuildQueueServiceException e )\n         {\n             throw new ContinuumException( \"Error deleting build queue from database.\", e );\n         }\n     }\n-    \n-    public BuildQueue storeBuildQueue( BuildQueue buildQueue ) throws ContinuumException\n+\n+    public BuildQueue storeBuildQueue( BuildQueue buildQueue )\n+        throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             return buildQueueService.updateBuildQueue( buildQueue );\n         }\n         catch ( BuildQueueServiceException e )\n         {\n             throw new ContinuumException( \"Error updating build queue.\", e );\n         }\n     }\n-    \n-    public List<BuildQueue> getAllBuildQueues() throws ContinuumException\n+\n+    public List<BuildQueue> getAllBuildQueues()\n+        throws ContinuumException\n     {\n         try\n-        {            \n+        {\n             return buildQueueService.getAllBuildQueues();\n         }\n         catch ( BuildQueueServiceException e )\n         {\n             throw new ContinuumException( \"Error adding build queue.\", e );\n         }\n     }\n-   \n+\n     private void prepareBuildProjects( Collection<Project> projects, List<BuildDefinition> bds,\n-                                      boolean checkDefaultBuildDefinitionForProject, int trigger )\n+                                       boolean checkDefaultBuildDefinitionForProject, int trigger )\n         throws ContinuumException\n     {\n         Map<ProjectScmRoot, Map<Integer, Integer>> map = new HashMap<ProjectScmRoot, Map<Integer, Integer>>();\n \n         for ( Project project : projects )\n         {\n             int projectId = project.getId();\n-            \n+\n             try\n             {\n                 // check if project already in queue\n-                if ( parallelBuildsManager.isInAnyBuildQueue( projectId ) || parallelBuildsManager.isProjectInAnyCurrentBuild( projectId ) )\n+                if ( parallelBuildsManager.isInAnyBuildQueue( projectId ) ||\n+                    parallelBuildsManager.isProjectInAnyCurrentBuild( projectId ) )\n                 {\n                     continue;\n                 }\n-                \n+\n                 if ( parallelBuildsManager.isInAnyCheckoutQueue( projectId ) )\n                 {\n                     parallelBuildsManager.removeProjectFromCheckoutQueue( projectId );\n@@ -3442,7 +3375,7 @@ private void prepareBuildProjects( Collection<Project> projects, List<BuildDefin\n             {\n                 throw new ContinuumException( e.getMessage(), e );\n             }\n-            \n+\n             int buildDefId = -1;\n \n             if ( bds != null )\n@@ -3509,7 +3442,7 @@ private void prepareBuildProjects( Collection<Project> projects, List<BuildDefin\n     private void prepareBuildProjects( Collection<Project> projects, int buildDefinitionId, int trigger )\n         throws ContinuumException\n     {\n-        Map<ProjectScmRoot, Map<Integer,Integer>> map = new HashMap<ProjectScmRoot, Map<Integer, Integer>>();\n+        Map<ProjectScmRoot, Map<Integer, Integer>> map = new HashMap<ProjectScmRoot, Map<Integer, Integer>>();\n \n         for ( Project project : projects )\n         {\n@@ -3518,27 +3451,28 @@ private void prepareBuildProjects( Collection<Project> projects, int buildDefini\n             try\n             {\n                 // check if project already in queue\n-                if ( parallelBuildsManager.isInAnyBuildQueue( projectId ) || parallelBuildsManager.isProjectInAnyCurrentBuild( projectId ) )\n+                if ( parallelBuildsManager.isInAnyBuildQueue( projectId ) ||\n+                    parallelBuildsManager.isProjectInAnyCurrentBuild( projectId ) )\n                 {\n                     continue;\n                 }\n-                \n+\n                 if ( parallelBuildsManager.isInAnyCheckoutQueue( projectId ) )\n                 {\n                     parallelBuildsManager.removeProjectFromCheckoutQueue( projectId );\n                 }\n-                \n+\n                 ProjectScmRoot scmRoot = getProjectScmRootByProject( projectId );\n \n                 Map<Integer, Integer> projectsAndBuildDefinitionsMap = map.get( scmRoot );\n-                \n+\n                 if ( projectsAndBuildDefinitionsMap == null )\n                 {\n                     projectsAndBuildDefinitionsMap = new HashMap<Integer, Integer>();\n                 }\n-                \n+\n                 projectsAndBuildDefinitionsMap.put( projectId, buildDefinitionId );\n-                \n+\n                 map.put( scmRoot, projectsAndBuildDefinitionsMap );\n             }\n             catch ( BuildManagerException e )\n@@ -3560,31 +3494,30 @@ private void prepareBuildProjects( Map<ProjectScmRoot, Map<Integer, Integer>> ma\n         }\n     }\n \n-    private void prepareBuildProjects( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger, \n+    private void prepareBuildProjects( Map<Integer, Integer> projectsBuildDefinitionsMap, int trigger,\n                                        String scmRootAddress, int projectGroupId, int scmRootId )\n         throws ContinuumException\n     {\n         ProjectGroup group = getProjectGroup( projectGroupId );\n-        \n+\n         try\n         {\n             if ( configurationService.isDistributedBuildEnabled() )\n             {\n                 if ( !taskQueueManager.isInDistributedBuildQueue( projectGroupId, scmRootAddress ) )\n                 {\n-                    PrepareBuildProjectsTask task = new PrepareBuildProjectsTask( projectsBuildDefinitionsMap, trigger,\n-                                                                      projectGroupId, group.getName(), \n-                                                                      scmRootAddress, scmRootId );\n-                    \n+                    PrepareBuildProjectsTask task =\n+                        new PrepareBuildProjectsTask( projectsBuildDefinitionsMap, trigger, projectGroupId,\n+                                                      group.getName(), scmRootAddress, scmRootId );\n+\n                     taskQueueManager.getDistributedBuildQueue().put( task );\n                 }\n             }\n             else\n             {\n-        \t    parallelBuildsManager.prepareBuildProjects(\n-\t\t\t\t\tprojectsBuildDefinitionsMap, trigger, projectGroupId,\n-\t\t\t\t\tgroup.getName(), scmRootAddress, scmRootId );\n-\t\t    }\n+                parallelBuildsManager.prepareBuildProjects( projectsBuildDefinitionsMap, trigger, projectGroupId,\n+                                                            group.getName(), scmRootAddress, scmRootId );\n+            }\n         }\n         catch ( TaskQueueManagerException e )\n         {\n@@ -3594,7 +3527,7 @@ private void prepareBuildProjects( Map<Integer, Integer> projectsBuildDefinition\n         {\n             throw logAndCreateException( \"Error while creating enqueuing object.\", e );\n         }\n-        catch( BuildManagerException e )\n+        catch ( BuildManagerException e )\n         {\n             throw logAndCreateException( \"Error while creating enqueuing object.\", e );\n         }\n@@ -3607,7 +3540,8 @@ private void createProjectScmRootForProjectGroup( ProjectGroup projectGroup )\n \n         try\n         {\n-            projectsList = getProjectsInBuildOrder( projectDao.getProjectsWithDependenciesByGroupId( projectGroup.getId() ) );\n+            projectsList =\n+                getProjectsInBuildOrder( projectDao.getProjectsWithDependenciesByGroupId( projectGroup.getId() ) );\n         }\n         catch ( CycleDetectedException e )\n         {\n@@ -3626,13 +3560,14 @@ private void createProjectScmRootForProjectGroup( ProjectGroup projectGroup )\n             }\n         }\n     }\n-    \n+\n     private ProjectScmRoot createProjectScmRoot( ProjectGroup projectGroup, String url )\n         throws ContinuumException\n     {\n         try\n         {\n-            ProjectScmRoot scmRoot = projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroup.getId(), url );\n+            ProjectScmRoot scmRoot =\n+                projectScmRootDao.getProjectScmRootByProjectGroupAndScmRootAddress( projectGroup.getId(), url );\n \n             if ( scmRoot != null )\n             {\n@@ -3652,67 +3587,63 @@ private ProjectScmRoot createProjectScmRoot( ProjectGroup projectGroup, String u\n             throw new ContinuumException( \"Error while creating project scm root with scm root address:\" + url );\n         }\n     }\n-    \n-    private boolean isProjectInReleaseStage( Project project ) throws ContinuumException\n-    {           \n-        String releaseId = project.getGroupId() + \":\" + project.getArtifactId();        \n+\n+    private boolean isProjectInReleaseStage( Project project )\n+        throws ContinuumException\n+    {\n+        String releaseId = project.getGroupId() + \":\" + project.getArtifactId();\n         try\n         {\n-            if( taskQueueManager.isProjectInReleaseStage( releaseId ) )\n-            {\n-                return true;\n-            }\n-            return false;\n+            return taskQueueManager.isProjectInReleaseStage( releaseId );\n         }\n         catch ( TaskQueueManagerException e )\n         {\n-            throw new ContinuumException( \"Error occurred while checking if project is currently being released.\",  e );\n+            throw new ContinuumException( \"Error occurred while checking if project is currently being released.\", e );\n         }\n     }\n-    \n+\n     private boolean isAnyProjectInGroupInReleaseStage( int projectGroupId )\n         throws ContinuumException\n     {\n         Collection<Project> projects = getProjectsInGroup( projectGroupId );\n-        for( Project project : projects )\n+        for ( Project project : projects )\n         {\n-            if( isProjectInReleaseStage( project ) )\n+            if ( isProjectInReleaseStage( project ) )\n             {\n                 throw new ContinuumException( \"Cannot build project group. Project (id=\" + project.getId() +\n                     \") in group is currently in release stage.\" );\n             }\n-        }        \n+        }\n         return false;\n     }\n-    \n+\n     private Collection<Project> getProjectsNotInReleaseStage( Collection<Project> projectsList )\n         throws ContinuumException\n     {\n         // filter the projects to be built\n         // projects that are in the release stage will not be built\n         Collection<Project> filteredProjectsList = new ArrayList<Project>();\n-        for( Project project : projectsList )\n+        for ( Project project : projectsList )\n         {\n-            if( !isProjectInReleaseStage( project ) )\n+            if ( !isProjectInReleaseStage( project ) )\n             {\n                 filteredProjectsList.add( project );\n             }\n             else\n             {\n                 log.warn(\n-                                  \"Project (id=\" + project.getId() +\n-                                      \") will not be built. It is currently in the release stage.\" );\n+                    \"Project (id=\" + project.getId() + \") will not be built. It is currently in the release stage.\" );\n             }\n         }\n         return filteredProjectsList;\n     }\n-    \n+\n     void setTaskQueueManager( TaskQueueManager taskQueueManager )\n     {\n         this.taskQueueManager = taskQueueManager;\n     }\n-    \n-    void setProjectDao( ProjectDao  projectDao )\n+\n+    void setProjectDao( ProjectDao projectDao )\n     {\n         this.projectDao = projectDao;\n     }",
                "deletions": 277
            },
            {
                "sha": "8e0ee486dc8aed9d2a630e7bba76046c77031126",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/execution/manager/DefaultBuildExecutorManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/maven/continuum/execution/manager/DefaultBuildExecutorManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/main/java/org/apache/maven/continuum/execution/manager/DefaultBuildExecutorManager.java",
                "status": "modified",
                "changes": 5,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/execution/manager/DefaultBuildExecutorManager.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -26,7 +26,6 @@\n import org.slf4j.LoggerFactory;\n \n import java.util.HashMap;\n-import java.util.Iterator;\n import java.util.Map;\n \n /**\n@@ -64,9 +63,9 @@ public void initialize()\n         {\n             log.info( \"Build executors:\" );\n \n-            for ( Iterator it = executors.keySet().iterator(); it.hasNext(); )\n+            for ( String key : executors.keySet() )\n             {\n-                log.info( \"  \" + it.next().toString() );\n+                log.info( \"  \" + key );\n             }\n         }\n     }",
                "deletions": 3
            },
            {
                "sha": "1737362bb1d061a1c26488c2515e69a263ec18d0",
                "filename": "continuum-core/src/test/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilderTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/test/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilderTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-core/src/test/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilderTest.java",
                "status": "modified",
                "changes": 22,
                "additions": 9,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/test/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilderTest.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -36,8 +36,8 @@\n import java.io.File;\n import java.net.URL;\n import java.util.HashMap;\n-import java.util.Iterator;\n import java.util.Map;\n+import java.util.List;\n \n /**\n  * @author <a href=\"mailto:trygvis@inamo.no\">Trygve Laugst&oslash;l</a>\n@@ -277,7 +277,7 @@ public void testCreateProjectsWithModuleswithParentPomIsntPomXml()\n \n         assertEquals( 1, result.getErrors().size() );\n \n-        assertEquals( ContinuumProjectBuildingResult.ERROR_POM_NOT_FOUND, result.getErrors().get( 0 ).toString() );\n+        assertEquals( ContinuumProjectBuildingResult.ERROR_POM_NOT_FOUND, result.getErrors().get( 0 ) );\n \n         // ----------------------------------------------------------------------\n         // Assert the project group built\n@@ -287,7 +287,7 @@ public void testCreateProjectsWithModuleswithParentPomIsntPomXml()\n \n         assertEquals( 1, result.getProjectGroups().size() );\n \n-        ProjectGroup projectGroup = (ProjectGroup) result.getProjectGroups().iterator().next();\n+        ProjectGroup projectGroup = result.getProjectGroups().iterator().next();\n \n         assertEquals( \"projectGroup.groupId\", \"org.apache.maven.continuum\", projectGroup.getGroupId() );\n \n@@ -305,12 +305,10 @@ public void testCreateProjectsWithModuleswithParentPomIsntPomXml()\n \n         assertEquals( 9, result.getProjects().size() );\n \n-        Map projects = new HashMap();\n+        Map<String, Project> projects = new HashMap<String, Project>();\n \n-        for ( Iterator it = result.getProjects().iterator(); it.hasNext(); )\n+        for ( Project project : result.getProjects() )\n         {\n-            Project project = (Project) it.next();\n-\n             assertNotNull( project.getName() );\n \n             projects.put( project.getName(), project );\n@@ -329,10 +327,10 @@ public void testCreateProjectsWithModuleswithParentPomIsntPomXml()\n         assertMavenTwoProject( \"Continuum Jabber Notifier\", projects );\n \n         assertEquals( \"continuum-parent-notifiers\",\n-                      ( (Project) projects.get( \"Continuum IRC Notifier\" ) ).getParent().getArtifactId() );\n+                      ( projects.get( \"Continuum IRC Notifier\" ) ).getParent().getArtifactId() );\n \n         assertEquals( \"continuum-parent-notifiers\",\n-                      ( (Project) projects.get( \"Continuum Jabber Notifier\" ) ).getParent().getArtifactId() );\n+                      ( projects.get( \"Continuum Jabber Notifier\" ) ).getParent().getArtifactId() );\n \n         assertDependency( \"Continuum Model\", \"Continuum Web\", projects );\n     }\n@@ -390,7 +388,7 @@ public void testCreateProjectWithoutModules()\n \n         assertEquals( 1, result.getProjectGroups().size() );\n \n-        ProjectGroup projectGroup = (ProjectGroup) result.getProjectGroups().get( 0 );\n+        ProjectGroup projectGroup = result.getProjectGroups().get( 0 );\n \n         assertEquals( \"projectGroup.groupId\", \"org.apache.maven.continuum\", projectGroup.getGroupId() );\n \n@@ -417,10 +415,8 @@ private void assertDependency( String dep, String proj, Map projects )\n \n         assertNotNull( p.getDependencies() );\n \n-        for ( Iterator i = p.getDependencies().iterator(); i.hasNext(); )\n+        for ( ProjectDependency pd : (List<ProjectDependency>) p.getDependencies() )\n         {\n-            ProjectDependency pd = (ProjectDependency) i.next();\n-\n             if ( pd.getArtifactId().equals( dependency.getArtifactId() ) &&\n                 pd.getGroupId().equals( dependency.getGroupId() ) && pd.getVersion().equals( dependency.getVersion() ) )\n             {",
                "deletions": 13
            },
            {
                "sha": "2af52db25f04218f39431ed8c454f0932e93e249",
                "filename": "continuum-store/src/main/java/org/apache/continuum/dao/BuildDefinitionDaoImpl.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-store/src/main/java/org/apache/continuum/dao/BuildDefinitionDaoImpl.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-store/src/main/java/org/apache/continuum/dao/BuildDefinitionDaoImpl.java",
                "status": "modified",
                "changes": 12,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/main/java/org/apache/continuum/dao/BuildDefinitionDaoImpl.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -51,16 +51,16 @@\n     implements BuildDefinitionDao\n {\n     private Logger log = LoggerFactory.getLogger( BuildDefinitionDaoImpl.class );\n-    \n+\n     /**\n-    * @plexus.requirement role=\"org.apache.continuum.dao.ProjectDao\"\n-    */\n+     * @plexus.requirement role=\"org.apache.continuum.dao.ProjectDao\"\n+     */\n     @Resource\n     private ProjectDao projectDao;\n \n     /**\n-    * @plexus.requirement role=\"org.apache.continuum.dao.ProjectGroupDao\"\n-    */    \n+     * @plexus.requirement role=\"org.apache.continuum.dao.ProjectGroupDao\"\n+     */\n     @Resource\n     private ProjectGroupDao projectGroupDao;\n \n@@ -352,7 +352,7 @@ public BuildDefinition getDefaultBuildDefinition( int projectId )\n \n             query.setFilter( \"this.schedule.id == scheduleId\" );\n \n-            List result = (List) query.execute( new Integer( scheduleId ) );\n+            List result = (List) query.execute( scheduleId );\n \n             return result == null ? Collections.EMPTY_LIST : (List) pm.detachCopyAll( result );\n         }",
                "deletions": 6
            },
            {
                "sha": "f7f66068cde51d31dafd180168aceee119465676",
                "filename": "continuum-store/src/main/java/org/apache/continuum/dao/DaoUtilsImpl.java",
                "blob_url": "https://github.com/apache/continuum/blob/01281c88543b3bae3de371a0313638feb25126ff/continuum-store/src/main/java/org/apache/continuum/dao/DaoUtilsImpl.java",
                "raw_url": "https://github.com/apache/continuum/raw/01281c88543b3bae3de371a0313638feb25126ff/continuum-store/src/main/java/org/apache/continuum/dao/DaoUtilsImpl.java",
                "status": "modified",
                "changes": 9,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/main/java/org/apache/continuum/dao/DaoUtilsImpl.java?ref=01281c88543b3bae3de371a0313638feb25126ff",
                "patch": "@@ -160,7 +160,7 @@ private void closePersistenceManagerFactory( PersistenceManagerFactory pmf, int\n         Map<Integer, Integer> projectSource = getProjectIdsAndBuildDefinitionsIdsBySchedule( scheduleId );\n         Map<Integer, Integer> projectGroupSource = getProjectGroupIdsAndBuildDefinitionsIdsBySchedule( scheduleId );\n \n-        Map aggregate = new HashMap();\n+        Map<Integer, Integer> aggregate = new HashMap<Integer, Integer>();\n \n         // start out by checking if we have projects with this scheduleId\n         if ( projectSource != null )\n@@ -176,11 +176,11 @@ private void closePersistenceManagerFactory( PersistenceManagerFactory pmf, int\n             for ( Iterator i = projectGroupSource.keySet().iterator(); i.hasNext(); )\n             {\n                 Integer projectGroupId = (Integer) i.next();\n-                List projectsInGroup = projectDao.getProjectsInGroup( projectGroupId.intValue() );\n+                List projectsInGroup = projectDao.getProjectsInGroup( projectGroupId );\n \n                 for ( Iterator j = projectsInGroup.iterator(); j.hasNext(); )\n                 {\n-                    Integer projectId = new Integer( ( (Project) j.next() ).getId() );\n+                    Integer projectId = ( (Project) j.next() ).getId();\n                     if ( !aggregate.keySet().contains( projectId ) )\n                     {\n                         aggregate.put( projectId, projectGroupSource.get( projectGroupId ) );\n@@ -222,7 +222,7 @@ private void closePersistenceManagerFactory( PersistenceManagerFactory pmf, int\n \n             query.setResult( \"this.id, buildDef.id\" );\n \n-            List result = (List) query.execute( new Integer( scheduleId ) );\n+            List result = (List) query.execute( scheduleId );\n \n             Map projects = new HashMap();\n \n@@ -333,5 +333,4 @@ private void closePersistenceManagerFactory( PersistenceManagerFactory pmf, int\n         }\n         return null;\n     }\n-\n }",
                "deletions": 5
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1886] fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@698083 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/cbb86dad03b19e6d2e2c0053960c45fde33904d6",
        "parent": "https://github.com/apache/continuum/commit/499796e177b6340284ce4e1377efa888833e8e19",
        "bug_id": "continuum_21",
        "file": [
            {
                "sha": "c4aca43ea0967c254f91359820de625e14efdd87",
                "filename": "continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/cbb86dad03b19e6d2e2c0053960c45fde33904d6/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/cbb86dad03b19e6d2e2c0053960c45fde33904d6/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "status": "modified",
                "changes": 22,
                "additions": 17,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-commons/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java?ref=cbb86dad03b19e6d2e2c0053960c45fde33904d6",
                "patch": "@@ -247,16 +247,18 @@ public String getBuildOutput( int buildId, int projectId )\n     public File getReleaseOutputDirectory()\n     {\n         File releaseOutputDirectory = generalConfiguration.getReleaseOutputDirectory();\n-        if ( releaseOutputDirectory == null )\n-        {\n-            releaseOutputDirectory = getFile( systemConf.getReleaseOutputDirectory() );\n-            setReleaseOutputDirectory( releaseOutputDirectory );\n-        }\n+\n         return releaseOutputDirectory;\n     }\n \n     public void setReleaseOutputDirectory( File releaseOutputDirectory )\n     {\n+        if ( releaseOutputDirectory == null )\n+        {\n+            generalConfiguration.setReleaseOutputDirectory( releaseOutputDirectory );\n+            return;\n+        }\n+\n         File f = releaseOutputDirectory;\n         try\n         {\n@@ -314,6 +316,11 @@ public File getBuildOutputFile( int buildId, int projectId )\n \n     public File getReleaseOutputDirectory( int projectGroupId )\n     {\n+        if ( getReleaseOutputDirectory() == null )\n+        {\n+            return null;\n+        }\n+        \n         File dir = new File( getReleaseOutputDirectory(), Integer.toString( projectGroupId ) );\n         \n         try\n@@ -332,6 +339,11 @@ public File getReleaseOutputFile( int projectGroupId, String name )\n     {\n         File dir = getReleaseOutputDirectory( projectGroupId );\n \n+        if ( dir == null )\n+        {\n+            return null;\n+        }\n+        \n         if ( !dir.exists() && !dir.mkdirs() )\n         {\n             throw new ConfigurationException(",
                "deletions": 5
            },
            {
                "sha": "c3eb5d012a5d10c07d7f1564c7d5f9c01987b160",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/cbb86dad03b19e6d2e2c0053960c45fde33904d6/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/cbb86dad03b19e6d2e2c0053960c45fde33904d6/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 10,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=cbb86dad03b19e6d2e2c0053960c45fde33904d6",
                "patch": "@@ -802,16 +802,20 @@ public void removeProject( int projectId )\n             Project project = getProjectWithBuilds( projectId );\n \n             List<ContinuumReleaseResult> releaseResults = releaseResultDao.getContinuumReleaseResultsByProject( projectId );\n-            \n+\n             try\n             {\n                 for ( ContinuumReleaseResult releaseResult : releaseResults )\n                 {\n                     releaseResultDao.removeContinuumReleaseResult( releaseResult );\n                 }\n-                \n+\n                 File releaseOutputDirectory = configurationService.getReleaseOutputDirectory( project.getProjectGroup().getId() );\n-                FileUtils.deleteDirectory( releaseOutputDirectory );\n+\n+                if ( releaseOutputDirectory != null )\n+                {\n+                    FileUtils.deleteDirectory( releaseOutputDirectory );\n+                }\n             }\n             catch ( ContinuumStoreException e )\n             {",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1548] fix NPE in IRC Notifier \n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@592180 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f",
        "parent": "https://github.com/apache/continuum/commit/d4ccf56c214ac0cbea31a2de429fe5c14da76611",
        "bug_id": "continuum_22",
        "file": [
            {
                "sha": "79b27d70755029d4fcfba9fbc42b4c5415712b6f",
                "filename": "continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "status": "modified",
                "changes": 8,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java?ref=5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f",
                "patch": "@@ -190,7 +190,7 @@ protected BuildResult getPreviousBuild( Project project, BuildDefinition buildDe\n         {\n             if ( buildDef != null )\n             {\n-                builds = store.getBuildResultsByBuildDefinition( project.getId(), buildDef.getId(), 0, 2 );\n+                builds = getContinuumStore().getBuildResultsByBuildDefinition( project.getId(), buildDef.getId(), 0, 2 );\n \n                 if ( builds.size() < 2 )\n                 {\n@@ -214,7 +214,7 @@ protected BuildResult getPreviousBuild( Project project, BuildDefinition buildDe\n                 //Normally, it isn't possible, buildDef should be != null\n                 if ( project.getId() > 0 )\n                 {\n-                    project = store.getProjectWithBuilds( project.getId() );\n+                    project = getContinuumStore().getProjectWithBuilds( project.getId() );\n                 }\n                 builds = project.getBuildResults();\n \n@@ -241,4 +241,8 @@ protected BuildResult getPreviousBuild( Project project, BuildDefinition buildDe\n         }\n     }\n \n+    protected ContinuumStore getContinuumStore()\n+    {\n+        return this.store;\n+    }\n }",
                "deletions": 2
            },
            {
                "sha": "45ec539d1b453ac7fd58c2984b94564b9fd2288a",
                "filename": "continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java",
                "status": "modified",
                "changes": 10,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-irc/src/main/java/org/apache/maven/continuum/notification/irc/IrcContinuumNotifier.java?ref=5aaddbdc1a94bb5284ccf6d84fcfe34cfe59123f",
                "patch": "@@ -28,6 +28,7 @@\n import org.apache.maven.continuum.notification.AbstractContinuumNotifier;\n import org.apache.maven.continuum.notification.ContinuumNotificationDispatcher;\n import org.apache.maven.continuum.project.ContinuumProjectState;\n+import org.apache.maven.continuum.store.ContinuumStore;\n import org.codehaus.plexus.notification.NotificationException;\n import org.codehaus.plexus.personality.plexus.lifecycle.phase.Disposable;\n import org.codehaus.plexus.util.StringUtils;\n@@ -63,6 +64,11 @@\n     // Requirements\n     // ----------------------------------------------------------------------\n \n+    /**\n+     * @plexus.requirement role-hint=\"jdo\"\n+     */\n+    private ContinuumStore store;    \n+    \n     /**\n      * @plexus.requirement\n      */\n@@ -506,4 +512,8 @@ public void unknown( String a, String b, String c, String d )\n         }\n     }\n \n+    protected ContinuumStore getContinuumStore()\n+    {\n+        return this.store;\n+    }    \n }",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "fix NPE with shell projects\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@575807 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/82b9754ff343467720c328d3ad7017bb147df676",
        "parent": "https://github.com/apache/continuum/commit/7c7a5ce757e746538763f7ebb674ab9f40cc79ed",
        "bug_id": "continuum_23",
        "file": [
            {
                "sha": "72299f9679f27ee1ddd65f0afd67ba0b863c3dd1",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildDefinitionAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/82b9754ff343467720c328d3ad7017bb147df676/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildDefinitionAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/82b9754ff343467720c328d3ad7017bb147df676/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildDefinitionAction.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildDefinitionAction.java?ref=82b9754ff343467720c328d3ad7017bb147df676",
                "patch": "@@ -183,7 +183,10 @@ public String input()\n                 {\n                     checkAddProjectBuildDefinitionAuthorization( getProjectGroupName() );\n                     BuildDefinition bd = getContinuum().getDefaultBuildDefinition( projectId );\n-                    preDefinedBuildFile = bd.getBuildFile();\n+                    if ( bd != null )\n+                    {\n+                        preDefinedBuildFile = bd.getBuildFile();\n+                    }\n                 }\n                 else\n                 {",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix possible NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@563500 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/e3e73d2cdcc0edc382182c8fc629059ea86458c7",
        "parent": "https://github.com/apache/continuum/commit/76fa3a3918ae869783bdad75f23f8746405b4784",
        "bug_id": "continuum_24",
        "file": [
            {
                "sha": "f2736595339fe0174a1bc0059622a2bec1daddcb",
                "filename": "continuum-core/src/main/resources/org/apache/maven/continuum/notification/mail/templates/common.vm",
                "blob_url": "https://github.com/apache/continuum/blob/e3e73d2cdcc0edc382182c8fc629059ea86458c7/continuum-core/src/main/resources/org/apache/maven/continuum/notification/mail/templates/common.vm",
                "raw_url": "https://github.com/apache/continuum/raw/e3e73d2cdcc0edc382182c8fc629059ea86458c7/continuum-core/src/main/resources/org/apache/maven/continuum/notification/mail/templates/common.vm",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/resources/org/apache/maven/continuum/notification/mail/templates/common.vm?ref=e3e73d2cdcc0edc382182c8fc629059ea86458c7",
                "patch": "@@ -74,7 +74,7 @@ Files changed:\n #end\n #end\n #end\n-#if ( $changesSinceLastSuccess )\n+#if ( $changesSinceLastSuccess && $changesSinceLastSuccess.changes )\n ****************************************************************************\n SCM Changes since last success:\n ****************************************************************************",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1314] Fix possible NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@548370 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/39022c52b85da655928fd83ab9837f824961bae2",
        "parent": "https://github.com/apache/continuum/commit/16b760703d2f64e30dddc7e20a0cbc4444ec3c6d",
        "bug_id": "continuum_25",
        "file": [
            {
                "sha": "00e1c0456182eace4e8cba2d0c89041b0f433976",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/39022c52b85da655928fd83ab9837f824961bae2/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/39022c52b85da655928fd83ab9837f824961bae2/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 23,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=39022c52b85da655928fd83ab9837f824961bae2",
                "patch": "@@ -478,18 +478,21 @@ public boolean isInBuildingQueue( int projectId, int buildDefinitionId )\n         {\n             BuildProjectTask task = (BuildProjectTask) it.next();\n \n-            if ( buildDefinitionId < 0 )\n+            if ( task != null )\n             {\n-                if ( task.getProjectId() == projectId )\n+                if ( buildDefinitionId < 0 )\n                 {\n-                    return true;\n+                    if ( task.getProjectId() == projectId )\n+                    {\n+                        return true;\n+                    }\n                 }\n-            }\n-            else\n-            {\n-                if ( task.getProjectId() == projectId && task.getBuildDefinitionId() == buildDefinitionId )\n+                else\n                 {\n-                    return true;\n+                    if ( task.getProjectId() == projectId && task.getBuildDefinitionId() == buildDefinitionId )\n+                    {\n+                        return true;\n+                    }\n                 }\n             }\n         }\n@@ -515,7 +518,7 @@ public boolean isInCheckoutQueue( int projectId )\n         {\n             CheckOutTask task = (CheckOutTask) it.next();\n \n-            if ( task.getProjectId() == projectId )\n+            if ( task != null && task.getProjectId() == projectId )\n             {\n                 return true;\n             }\n@@ -1418,7 +1421,7 @@ private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( S\n         for ( Iterator i = projects.iterator(); i.hasNext(); )\n         {\n             Project project = (Project) i.next();\n-            \n+\n             project.setScmUseCache( useCredentialsCache );\n \n             projectGroup.addProject( project );",
                "deletions": 10
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "fixed possible NPE when scm is not SVN\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@500734 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/8f92170b80d227569948a3a8ad33269ba734f9ca",
        "parent": "https://github.com/apache/continuum/commit/f98221600cec03e8feed2a32d09ffac08c515874",
        "bug_id": "continuum_26",
        "file": [
            {
                "sha": "ff2952af6b4e970abcf16ef234517de143ce86b8",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/8f92170b80d227569948a3a8ad33269ba734f9ca/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/8f92170b80d227569948a3a8ad33269ba734f9ca/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "status": "modified",
                "changes": 8,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java?ref=8f92170b80d227569948a3a8ad33269ba734f9ca",
                "patch": "@@ -301,8 +301,12 @@ private Properties getReleaseProperties()\n             p.setProperty( \"password\", scmPassword );\n         }\n \n+        if ( StringUtils.isNotEmpty( scmTagBase ) )\n+        {\n+            p.setProperty( \"tagBase\", scmTagBase );\n+        }\n+\n         p.setProperty( \"tag\", scmTag );\n-        p.setProperty( \"tagBase\", scmTagBase );\n         p.setProperty( \"prepareGoals\", prepareGoals );\n \n         return p;\n@@ -450,6 +454,6 @@ public void setPrepareGoals( String prepareGoals )\n \n     public void validate()\n     {\n-        \n+\n     }\n }",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1067] Fix NPE\nSubmitted by: Edwin Punzalan\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@488324 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/7626675877c4d63af5238fbb122ebc14fce98855",
        "parent": "https://github.com/apache/continuum/commit/223d4853bd2056d05736487432fb930f7d29653b",
        "bug_id": "continuum_27",
        "file": [
            {
                "sha": "aa0f0e388b49827ed266e4b3731c5c1d1764baa9",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePerformAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/7626675877c4d63af5238fbb122ebc14fce98855/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePerformAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/7626675877c4d63af5238fbb122ebc14fce98855/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePerformAction.java",
                "status": "modified",
                "changes": 1,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePerformAction.java?ref=7626675877c4d63af5238fbb122ebc14fce98855",
                "patch": "@@ -103,7 +103,6 @@ public String executeFromScm()\n         descriptor.setScmReleaseLabel( scmTag );\n         descriptor.setScmTagBase( scmTagBase );\n \n-        String releaseId;\n         do\n         {\n             releaseId = String.valueOf( System.currentTimeMillis() );",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1057] Fix possible NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@487511 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/3825848967cbce25eea61e6943253d5982a9bfa2",
        "parent": "https://github.com/apache/continuum/commit/22f87ffc7de7910470167f0de45f8bd0a15e96a7",
        "bug_id": "continuum_28",
        "file": [
            {
                "sha": "40de85b9c0ad43b59f393f7bc92ded98484ea1ec",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/3825848967cbce25eea61e6943253d5982a9bfa2/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/3825848967cbce25eea61e6943253d5982a9bfa2/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java?ref=3825848967cbce25eea61e6943253d5982a9bfa2",
                "patch": "@@ -192,6 +192,11 @@ public File getBuildOutputFile( int buildId, int projectId )\n \n     public File getFile( String filename )\n     {\n+        if ( filename == null )\n+        {\n+            return null;\n+        }\n+\n         File f = null;\n \n         if ( filename != null && filename.length() != 0 )",
                "deletions": 0
            },
            {
                "sha": "f1700a2706fe0432fd1aaf0ebf6249fcb9eafeff",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigurationAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/3825848967cbce25eea61e6943253d5982a9bfa2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigurationAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/3825848967cbce25eea61e6943253d5982a9bfa2/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigurationAction.java",
                "status": "modified",
                "changes": 18,
                "additions": 15,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigurationAction.java?ref=3825848967cbce25eea61e6943253d5982a9bfa2",
                "patch": "@@ -61,11 +61,23 @@ public void prepare()\n     {\n         ConfigurationService configuration = getContinuum().getConfiguration();\n \n-        workingDirectory = configuration.getWorkingDirectory().getAbsolutePath();\n+        File workingDirectoryFile = configuration.getWorkingDirectory();\n+        if ( workingDirectoryFile != null )\n+        {\n+            workingDirectory = workingDirectoryFile.getAbsolutePath();\n+        }\n \n-        buildOutputDirectory = configuration.getBuildOutputDirectory().getAbsolutePath();\n+        File buildOutputDirectoryFile = configuration.getBuildOutputDirectory();\n+        if ( buildOutputDirectoryFile != null )\n+        {\n+            buildOutputDirectory = buildOutputDirectoryFile.getAbsolutePath();\n+        }\n \n-        deploymentRepositoryDirectory = configuration.getDeploymentRepositoryDirectory().getAbsolutePath();\n+        File deploymentRepositoryDirectoryFile = configuration.getDeploymentRepositoryDirectory();\n+        if ( deploymentRepositoryDirectoryFile != null )\n+        {\n+            deploymentRepositoryDirectory = deploymentRepositoryDirectoryFile.getAbsolutePath();\n+        }\n \n         baseUrl = configuration.getUrl();\n ",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "prevent an NPE\nSubmitted by: Franz Allen Valencia See\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@486538 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/67766539def23eba7b00c5db1c683f57af85cd99",
        "parent": "https://github.com/apache/continuum/commit/d7d0c741af2f6aec9c377e402c191c744be28026",
        "bug_id": "continuum_29",
        "file": [
            {
                "sha": "7d6b67aef1d8a76bd1f807de5c1a138692a94269",
                "filename": "continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "blob_url": "https://github.com/apache/continuum/blob/67766539def23eba7b00c5db1c683f57af85cd99/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "raw_url": "https://github.com/apache/continuum/raw/67766539def23eba7b00c5db1c683f57af85cd99/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "status": "modified",
                "changes": 20,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java?ref=67766539def23eba7b00c5db1c683f57af85cd99",
                "patch": "@@ -223,20 +223,24 @@ public Map getAggregatedProjectIdsAndBuildDefinitionIdsBySchedule( int scheduleI\n \n         // iterate through the project groups and make sure we are not walking over projects that\n         // might define their own build definitions\n-        for ( Iterator i = projectGroupSource.keySet().iterator(); i.hasNext(); )\n+        if ( projectGroupSource != null )\n         {\n-            Integer projectGroupId = (Integer) i.next();\n-            List projectsInGroup = getProjectsInGroup( projectGroupId.intValue() );\n-\n-            for ( Iterator j = projectsInGroup.iterator(); j.hasNext(); )\n+        \tfor ( Iterator i = projectGroupSource.keySet().iterator(); i.hasNext(); )\n             {\n-                Integer projectId = new Integer( ( (Project) j.next() ).getId() );\n-                if ( !aggregate.keySet().contains( projectId ) )\n+                Integer projectGroupId = (Integer) i.next();\n+                List projectsInGroup = getProjectsInGroup( projectGroupId.intValue() );\n+\n+                for ( Iterator j = projectsInGroup.iterator(); j.hasNext(); )\n                 {\n-                    aggregate.put( projectId, projectGroupSource.get( projectGroupId ) );\n+                    Integer projectId = new Integer( ( (Project) j.next() ).getId() );\n+                    if ( !aggregate.keySet().contains( projectId ) )\n+                    {\n+                        aggregate.put( projectId, projectGroupSource.get( projectGroupId ) );\n+                    }\n                 }\n             }\n         }\n+        \n         return aggregate;\n     }\n ",
                "deletions": 8
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-937] Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@449054 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/7fb976baf6cb13756a09081ec01079ae877f2c31",
        "parent": "https://github.com/apache/continuum/commit/9dab3daa0adb920f50020e882b3366f34f5b4e66",
        "bug_id": "continuum_30",
        "file": [
            {
                "sha": "f5ad99ffbf4abdda9bee227db419ebb710cb72e4",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "blob_url": "https://github.com/apache/continuum/blob/7fb976baf6cb13756a09081ec01079ae877f2c31/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "raw_url": "https://github.com/apache/continuum/raw/7fb976baf6cb13756a09081ec01079ae877f2c31/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java?ref=7fb976baf6cb13756a09081ec01079ae877f2c31",
                "patch": "@@ -283,7 +283,7 @@ private String getValidationMessages( ScmRepositoryException ex )\n \n         StringBuffer message = new StringBuffer();\n \n-        if ( !messages.isEmpty() )\n+        if ( messages != null && !messages.isEmpty() )\n         {\n             for ( Iterator i = messages.iterator(); i.hasNext(); )\n             {",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Upgrade dep on plexus-quartz: contains NPE fix\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@442587 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/b3dfd3a2368b723581068e10416d08f9904b1def",
        "parent": "https://github.com/apache/continuum/commit/54119d009f46fcdba38cfca65fc5ee3e35462979",
        "bug_id": "continuum_31",
        "file": [
            {
                "sha": "92324ac30996630391414662b02c06d0bbe13abb",
                "filename": "pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/b3dfd3a2368b723581068e10416d08f9904b1def/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/b3dfd3a2368b723581068e10416d08f9904b1def/pom.xml",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/pom.xml?ref=b3dfd3a2368b723581068e10416d08f9904b1def",
                "patch": "@@ -368,7 +368,7 @@\n       <dependency>\n         <groupId>org.codehaus.plexus</groupId>\n         <artifactId>plexus-quartz</artifactId>\n-        <version>1.0-alpha-2</version>\n+        <version>1.0-alpha-3-SNAPSHOT</version>\n       </dependency>\n       <dependency>\n         <groupId>org.codehaus.plexus</groupId>",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-453] Fix NPE in working directory\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@349427 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/d181ee17be1b6f0c002a3cd09c64f7636c8f2160",
        "parent": "https://github.com/apache/continuum/commit/5264306d544c06e0e9b540aa2cfd3b6d3c639401",
        "bug_id": "continuum_32",
        "file": [
            {
                "sha": "d86355b984fde9374458cfa82ba4986849b6f96c",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/d181ee17be1b6f0c002a3cd09c64f7636c8f2160/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/d181ee17be1b6f0c002a3cd09c64f7636c8f2160/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 41,
                "additions": 22,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=d181ee17be1b6f0c002a3cd09c64f7636c8f2160",
                "patch": "@@ -1235,30 +1235,33 @@ private List getFiles( File baseDirectory, String currentSubDirectory, String us\n \n         String[] files = workingDirectory.list();\n \n-        for ( int i = 0; i < files.length; i++ )\n+        if ( files != null )\n         {\n-            File current = new File( workingDirectory, files[i] );\n+            for ( int i = 0; i < files.length; i++ )\n+            {\n+                File current = new File( workingDirectory, files[i] );\n \n-            String currentFile = null;\n+                String currentFile = null;\n \n-            if ( currentSubDirectory == null )\n-            {\n-                currentFile = files[i];\n-            }\n-            else\n-            {\n-                currentFile = currentSubDirectory + \"/\" + files[i];\n-            }\n+                if ( currentSubDirectory == null )\n+                {\n+                    currentFile = files[i];\n+                }\n+                else\n+                {\n+                    currentFile = currentSubDirectory + \"/\" + files[i];\n+                }\n \n-            if ( userDirectory != null && current.isDirectory() && userDirectory.startsWith( currentFile ) )\n-            {\n-                dirs.add( current );\n+                if ( userDirectory != null && current.isDirectory() && userDirectory.startsWith( currentFile ) )\n+                {\n+                    dirs.add( current );\n \n-                dirs.add( getFiles( baseDirectory, currentFile, userDirectory ) );\n-            }\n-            else\n-            {\n-                dirs.add( current );\n+                    dirs.add( getFiles( baseDirectory, currentFile, userDirectory ) );\n+                }\n+                else\n+                {\n+                    dirs.add( current );\n+                }\n             }\n         }\n ",
                "deletions": 19
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix possible NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@331889 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/b9219b6f67d5bac4c8b70e95e793a9d77f3cb245",
        "parent": "https://github.com/apache/continuum/commit/40731f8a4b75ea295b44f95100c83cebcba60478",
        "bug_id": "continuum_33",
        "file": [
            {
                "sha": "82687af58080dd75f3137950daf78d9d45f43333",
                "filename": "continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/b9219b6f67d5bac4c8b70e95e793a9d77f3cb245/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/b9219b6f67d5bac4c8b70e95e793a9d77f3cb245/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "status": "modified",
                "changes": 13,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java?ref=b9219b6f67d5bac4c8b70e95e793a9d77f3cb245",
                "patch": "@@ -42,13 +42,16 @@ public String getReportUrl( Project project, BuildResult build, ConfigurationSer\n \n             StringBuffer buf = new StringBuffer( configurationService.getUrl() );\n \n-            if ( !buf.toString().endsWith( \"/\" ) )\n+            if ( project != null || build != null )\n             {\n-                buf.append( \"/\" );\n-            }\n+                if ( !buf.toString().endsWith( \"/\" ) )\n+                {\n+                    buf.append( \"/\" );\n+                }\n \n-            buf.append( \"target/ProjectBuild.vm/view/ProjectBuild/id/\" ).append( project.getId() ).append(\n-                \"/buildId/\" ).append( build.getId() );\n+                buf.append( \"target/ProjectBuild.vm/view/ProjectBuild/id/\" ).append( project.getId() ).append(\n+                    \"/buildId/\" ).append( build.getId() );\n+            }\n \n             return buf.toString();\n         }",
                "deletions": 5
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE when admin doesn't allow guest users\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@328168 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/9064327e1ab3073753bcd6f6f15fe8023a6c9ebf",
        "parent": "https://github.com/apache/continuum/commit/e76768ca3389b6af5cb31d90cef0d37fcfb4b6ea",
        "bug_id": "continuum_34",
        "file": [
            {
                "sha": "1f2df496453ec0985d3310cb655e41ddca992762",
                "filename": "continuum-web/src/main/java/org/apache/maven/continuum/web/action/InitializationChecker.java",
                "blob_url": "https://github.com/apache/continuum/blob/9064327e1ab3073753bcd6f6f15fe8023a6c9ebf/continuum-web/src/main/java/org/apache/maven/continuum/web/action/InitializationChecker.java",
                "raw_url": "https://github.com/apache/continuum/raw/9064327e1ab3073753bcd6f6f15fe8023a6c9ebf/continuum-web/src/main/java/org/apache/maven/continuum/web/action/InitializationChecker.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-web/src/main/java/org/apache/maven/continuum/web/action/InitializationChecker.java?ref=9064327e1ab3073753bcd6f6f15fe8023a6c9ebf",
                "patch": "@@ -159,7 +159,9 @@ public void execute( Map map )\n         }\n         else\n         {\n-            UserGroup guestGroup = store.getUserGroup( \"guest\" );\n+            configuration.setGuestAccountEnabled( false );\n+\n+            UserGroup guestGroup = store.getUserGroup( ContinuumSecurity.GUEST_GROUP_NAME );\n \n             guestGroup.setPermissions( null );\n ",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2083] (CONTINUUM-1952) [CONTINUUM-1859] [CONTINUUM-2124] \nAdded Selenium test for:\n'Project name already exist' when adding shell project\nIntermittently the project is just not added\nNPE when building shell project\nNPE on first delete attempt of project group containing shell project\n(Same problems occur with Ant projects)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@752910 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/39ecd4e560f58d3043c9f25c754202ac06f1fb82",
        "parent": "https://github.com/apache/continuum/commit/8ac4d4d295ed95f244410c97bf4c26de6bed1227",
        "bug_id": "continuum_35",
        "file": [
            {
                "sha": "2450b62b2ed10907aa608210de2de8b94f4ac33c",
                "filename": "continuum-webapp-test/src/test/selenium-ide/continuum_failing_test_suite.html",
                "blob_url": "https://github.com/apache/continuum/blob/39ecd4e560f58d3043c9f25c754202ac06f1fb82/continuum-webapp-test/src/test/selenium-ide/continuum_failing_test_suite.html",
                "raw_url": "https://github.com/apache/continuum/raw/39ecd4e560f58d3043c9f25c754202ac06f1fb82/continuum-webapp-test/src/test/selenium-ide/continuum_failing_test_suite.html",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp-test/src/test/selenium-ide/continuum_failing_test_suite.html?ref=39ecd4e560f58d3043c9f25c754202ac06f1fb82",
                "patch": "@@ -10,6 +10,7 @@\n <tr><td><b>Test Suite</b></td></tr>\n <tr><td><a href=\"add_and_edit_project_level_build_definition.html\">add_and_edit_project_level_build_definition.html</a></td></tr>\n <tr><td><a href=\"test_project_group_homepage_url.html\">test_project_group_homepage_url</a></td></tr>\n+<tr><td><a href=\"test_shell_project.html\">test_shell_project</a></td></tr>\n </tbody></table>\n </body>\n </html>",
                "deletions": 0
            },
            {
                "sha": "00bc4627a6ed3941da30a5570a75482951c5524f",
                "filename": "continuum-webapp-test/src/test/selenium-ide/test_shell_project.html",
                "blob_url": "https://github.com/apache/continuum/blob/39ecd4e560f58d3043c9f25c754202ac06f1fb82/continuum-webapp-test/src/test/selenium-ide/test_shell_project.html",
                "raw_url": "https://github.com/apache/continuum/raw/39ecd4e560f58d3043c9f25c754202ac06f1fb82/continuum-webapp-test/src/test/selenium-ide/test_shell_project.html",
                "status": "added",
                "changes": 126,
                "additions": 126,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp-test/src/test/selenium-ide/test_shell_project.html?ref=39ecd4e560f58d3043c9f25c754202ac06f1fb82",
                "patch": "@@ -0,0 +1,126 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n+<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n+<head profile=\"http://selenium-ide.openqa.org/profiles/test-case\">\n+<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />\n+<link rel=\"selenium.base\" href=\"\" />\n+<title>test_shell_project</title>\n+</head>\n+<body>\n+<table cellpadding=\"1\" cellspacing=\"1\" border=\"1\">\n+<thead>\n+<tr><td rowspan=\"1\" colspan=\"3\">test_shell_project</td></tr>\n+</thead><tbody>\n+<tr>\n+\t<td>open</td>\n+\t<td>/continuum/groupSummary.action</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>link=Show Project Groups</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>addProjectGroup</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>type</td>\n+\t<td>addProjectGroup_name</td>\n+\t<td>Shell Test</td>\n+</tr>\n+<tr>\n+\t<td>type</td>\n+\t<td>addProjectGroup_groupId</td>\n+\t<td>shell-test</td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>addProjectGroup_</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>link=Shell Test</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>select</td>\n+\t<td>preferredExecutor</td>\n+\t<td>label=Add Shell Project</td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>//input[@value='Add']</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>type</td>\n+\t<td>addProject_projectName</td>\n+\t<td>Good Shell Project</td>\n+</tr>\n+<tr>\n+\t<td>type</td>\n+\t<td>addProject_projectVersion</td>\n+\t<td>1.0</td>\n+</tr>\n+<tr>\n+\t<td>type</td>\n+\t<td>addProject_projectScmUrl</td>\n+\t<td>https://svn.apache.org/repos/asf/continuum/sandbox/examples/shell</td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>addProject_</td>\n+\t<td></td>\n+</tr>\n+<!--Either the project was not added, OR you get-->\n+<!--Error - \"Project name already exist\" (however, project is added)-->\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>link=Show Project Groups</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>link=Shell Test</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>click</td>\n+\t<td>//img[@alt='Build Now']</td>\n+\t<td></td>\n+</tr>\n+<!--Error - java.lang.NullPointerException-->\n+<tr>\n+\t<td>clickAndWait</td>\n+\t<td>link=Show Project Groups</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>click</td>\n+\t<td>link=Shell Test</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>click</td>\n+\t<td>remove</td>\n+\t<td></td>\n+</tr>\n+<tr>\n+\t<td>click</td>\n+\t<td>removeProjectGroup_</td>\n+\t<td></td>\n+</tr>\n+<!--Error - java.lang.NullPointerException on first delete attempt (second seems to work) -->\n+<tr>\n+\t<td>assertTextNotPresent</td>\n+\t<td>Shell Test</td>\n+\t<td></td>\n+</tr>\n+\n+</tbody></table>\n+</body>\n+</html>",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2643] set default Timezone in ConnectionInfo to prevent NPE during xmlrpc calls\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1154111 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/d6444243949ee2a9696bdb0e9b2496328cca0204",
        "parent": "https://github.com/apache/continuum/commit/2928493eb7f43bf0e4f0b669a671b7f5ffa37b00",
        "bug_id": "continuum_36",
        "file": [
            {
                "sha": "5a65dbd935933eb402dc422ed369e8009ea894dc",
                "filename": "continuum-distributed/continuum-distributed-master/continuum-distributed-master-client/src/main/java/org/apache/continuum/distributed/transport/master/MasterBuildAgentTransportClient.java",
                "blob_url": "https://github.com/apache/continuum/blob/d6444243949ee2a9696bdb0e9b2496328cca0204/continuum-distributed/continuum-distributed-master/continuum-distributed-master-client/src/main/java/org/apache/continuum/distributed/transport/master/MasterBuildAgentTransportClient.java",
                "raw_url": "https://github.com/apache/continuum/raw/d6444243949ee2a9696bdb0e9b2496328cca0204/continuum-distributed/continuum-distributed-master/continuum-distributed-master-client/src/main/java/org/apache/continuum/distributed/transport/master/MasterBuildAgentTransportClient.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-distributed/continuum-distributed-master/continuum-distributed-master-client/src/main/java/org/apache/continuum/distributed/transport/master/MasterBuildAgentTransportClient.java?ref=d6444243949ee2a9696bdb0e9b2496328cca0204",
                "patch": "@@ -25,6 +25,7 @@\n \n import java.net.URL;\n import java.util.Map;\n+import java.util.TimeZone;\n \n import com.atlassian.xmlrpc.ConnectionInfo;\n import org.slf4j.Logger;\n@@ -58,6 +59,7 @@ public MasterBuildAgentTransportClient( URL serviceUrl, String login, String pas\n         ConnectionInfo connectionInfo = new ConnectionInfo();\n         connectionInfo.setUsername( login );\n         connectionInfo.setPassword( password );\n+        connectionInfo.setTimeZone( TimeZone.getDefault() );\n \n         this.masterServerUrl = serviceUrl.toString();\n ",
                "deletions": 0
            },
            {
                "sha": "95f06b9547c1a8b0751f2dcb2e9b35f3c5fffd04",
                "filename": "continuum-distributed/continuum-distributed-slave/continuum-distributed-slave-client/src/main/java/org/apache/continuum/distributed/transport/slave/SlaveBuildAgentTransportClient.java",
                "blob_url": "https://github.com/apache/continuum/blob/d6444243949ee2a9696bdb0e9b2496328cca0204/continuum-distributed/continuum-distributed-slave/continuum-distributed-slave-client/src/main/java/org/apache/continuum/distributed/transport/slave/SlaveBuildAgentTransportClient.java",
                "raw_url": "https://github.com/apache/continuum/raw/d6444243949ee2a9696bdb0e9b2496328cca0204/continuum-distributed/continuum-distributed-slave/continuum-distributed-slave-client/src/main/java/org/apache/continuum/distributed/transport/slave/SlaveBuildAgentTransportClient.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-distributed/continuum-distributed-slave/continuum-distributed-slave-client/src/main/java/org/apache/continuum/distributed/transport/slave/SlaveBuildAgentTransportClient.java?ref=d6444243949ee2a9696bdb0e9b2496328cca0204",
                "patch": "@@ -27,6 +27,7 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Properties;\n+import java.util.TimeZone;\n \n import com.atlassian.xmlrpc.ConnectionInfo;\n import org.slf4j.Logger;\n@@ -58,6 +59,7 @@ public SlaveBuildAgentTransportClient( URL serviceUrl, String login, String pass\n         ConnectionInfo connectionInfo = new ConnectionInfo();\n         connectionInfo.setUsername( login );\n         connectionInfo.setPassword( password );\n+        connectionInfo.setTimeZone( TimeZone.getDefault() );\n \n         buildAgentUrl = serviceUrl.toString();\n ",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2169] some more fix for NPE in getText when using execAndWait interceptor\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@955142 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/edae448f4eb99d571cb3ab6da2104f05f2affbba",
        "parent": "https://github.com/apache/continuum/commit/7fb8684cb6299282b0260b1f7baaed1c4451a8b9",
        "bug_id": "continuum_37",
        "file": [
            {
                "sha": "5ba1fe87ad6259214a8d6d093f7940e16d8ad21b",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/edae448f4eb99d571cb3ab6da2104f05f2affbba/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/edae448f4eb99d571cb3ab6da2104f05f2affbba/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java?ref=edae448f4eb99d571cb3ab6da2104f05f2affbba",
                "patch": "@@ -138,6 +138,7 @@ public String add()\n         throws ContinuumException\n     {\n         initializeProjectGroupName();\n+        initializeActionContext();\n \n         try\n         {",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "revert previous changes. should check if null to prevent NPE when no build agent is configured\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@933472 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/ad594f2c2160a8f8ff6ac70b7f67ffb1302a21e9",
        "parent": "https://github.com/apache/continuum/commit/25d29887ce4425feaf9a9e34d6dec31d0a83110c",
        "bug_id": "continuum_38",
        "file": [
            {
                "sha": "f5905805d03b10a94062db2a807ba1dd7a09a969",
                "filename": "continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/ad594f2c2160a8f8ff6ac70b7f67ffb1302a21e9/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/ad594f2c2160a8f8ff6ac70b7f67ffb1302a21e9/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/builder/distributed/manager/DefaultDistributedBuildManager.java?ref=ad594f2c2160a8f8ff6ac70b7f67ffb1302a21e9",
                "patch": "@@ -123,7 +123,7 @@ public void initialize()\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n \n-        if ( !agents.isEmpty() )\n+        if ( agents != null )\n         {\n             synchronized( overallDistributedBuildQueues )\n             {\n@@ -173,7 +173,7 @@ public void reload()\n     {\n         List<BuildAgentConfiguration> agents = configurationService.getBuildAgents();\n \n-        if ( agents.isEmpty() )\n+        if ( agents == null )\n         {\n             return;\n         }",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "fixed potential NPE\nmerge -r 822552:822553 of 1.3.x branch\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@822554 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/a21abb0a4444395b0ac39c3813f4ef390538cdc3",
        "parent": "https://github.com/apache/continuum/commit/5a4a57324b8fef56976c2ac1685ede80464de9d9",
        "bug_id": "continuum_39",
        "file": [
            {
                "sha": "5ce32139b957a45eada339cef8d9c0bccdabe3cd",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/a21abb0a4444395b0ac39c3813f4ef390538cdc3/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/a21abb0a4444395b0ac39c3813f4ef390538cdc3/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=a21abb0a4444395b0ac39c3813f4ef390538cdc3",
                "patch": "@@ -3268,6 +3268,11 @@ public ProjectScmRoot getProjectScmRootByProjectGroupAndScmRootAddress( int proj\n     private void removeProjectScmRoot( ProjectScmRoot projectScmRoot )\n         throws ContinuumException\n     {\n+        if ( projectScmRoot == null )\n+        {\n+            return;\n+        }\n+\n         //get all projects in the group\n         ProjectGroup group = getProjectGroupWithProjects( projectScmRoot.getProjectGroup().getId() );\n ",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2318] - NPE when adding Ant/Shell Projects\nmerge r 808371:808372 from 1.3.x branch\n- added tests\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@808373 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/509a9d025d597d77038090dbed37dbe17df9594c",
        "parent": "https://github.com/apache/continuum/commit/90f6b26b4d5f6e7dd98ecee000054b3f883d8778",
        "bug_id": "continuum_40",
        "file": [
            {
                "sha": "4a1fe32c97a6ebca8be26b6e98d020a1edc934f9",
                "filename": "continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/AddProjectActionTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/509a9d025d597d77038090dbed37dbe17df9594c/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/AddProjectActionTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/509a9d025d597d77038090dbed37dbe17df9594c/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/AddProjectActionTest.java",
                "status": "added",
                "changes": 136,
                "additions": 136,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/AddProjectActionTest.java?ref=509a9d025d597d77038090dbed37dbe17df9594c",
                "patch": "@@ -0,0 +1,136 @@\n+package org.apache.maven.continuum.web.action;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+\n+import org.apache.maven.continuum.web.action.stub.AddProjectActionStub;\n+import org.apache.maven.continuum.Continuum;\n+import org.apache.maven.continuum.model.project.Project;\n+import org.jmock.Mock;\n+import org.jmock.MockObjectTestCase;\n+\n+/**\n+ * Test for {@link AddProjectAction}\n+ *\n+ * @author <a href=\"mailto:jzurbano@apache.org\">jzurbano</a>\n+ */\n+public class AddProjectActionTest\n+    extends MockObjectTestCase\n+{\n+    private final AddProjectActionStub action;\n+\n+    private final Mock continuumMock;\n+\n+    public AddProjectActionTest()\n+    {\n+        action = new AddProjectActionStub();\n+        continuumMock = new Mock( Continuum.class );\n+        action.setContinuum( (Continuum) continuumMock.proxy() );\n+    }\n+\n+    public void testAddProjectNullValues()\n+        throws Exception\n+    {\n+        action.setProjectName( null );\n+        action.setProjectVersion( null );\n+        action.setProjectScmUrl( null );\n+        \n+        action.validate();\n+    }\n+    \n+    /**\n+     * Test add of Ant project\n+     *\n+     * @throws Exception\n+     */\n+    public void testAddAntProject()\n+        throws Exception\n+    {\n+        String scmUrl = \"scm:svn:http://project/scm/url/test/build.xml\";\n+        \n+        List<Project> projects = createProjectList();\n+        continuumMock.expects( once() ).method( \"getProjects\" ).will( returnValue( projects ) );\n+        continuumMock.expects( once() ).method( \"addProject\" ).will( returnValue( 3 ) );\n+        \n+        action.setProjectName( \"Ant Test Project\" );\n+        action.setProjectVersion( \"1.0-SNAPSHOT\" );\n+        action.setProjectScmUrl( scmUrl );\n+        action.setProjectType( \"ant\" );\n+        action.setSelectedProjectGroup( 1 );\n+        action.setBuildDefintionTemplateId( 1 );\n+        \n+        action.validate();\n+        action.add();\n+        continuumMock.verify();\n+        \n+    }\n+\n+    /**\n+     * Test add of Shell project\n+     *\n+     * @throws Exception\n+     */\n+    public void testAddShellProject()\n+        throws Exception\n+    {\n+        String scmUrl = \"scm:svn:http://project/scm/url/test/run.sh\";\n+        \n+        List<Project> projects = createProjectList();\n+        continuumMock.expects( once() ).method( \"getProjects\" ).will( returnValue( projects ) );\n+        continuumMock.expects( once() ).method( \"addProject\" ).will( returnValue( 3 ) );\n+        \n+        action.setProjectName( \"Shell Test Project\" );\n+        action.setProjectVersion( \"1.0-SNAPSHOT\" );\n+        action.setProjectScmUrl( scmUrl );\n+        action.setProjectType( \"shell\" );\n+        action.setSelectedProjectGroup( 1 );\n+        action.setBuildDefintionTemplateId( 1 );\n+        \n+        action.validate();\n+        action.add();\n+        continuumMock.verify();\n+    }\n+    \n+    private List<Project> createProjectList()\n+    {\n+        List<Project> projects = new ArrayList<Project>();\n+        \n+        Project project1 = createProject( \"scm:svn:http://project/scm/url/test-1/run.sh\", \"Shell Test Project 1\", \"1.0-SNAPSHOT\", 1 );\n+        Project project2 = createProject( \"scm:svn:http://project/scm/url/test-2/build.xml\", \"Ant Test Project 1\", \"1.0-SNAPSHOT\", 2 );\n+        \n+        projects.add( project1 );\n+        projects.add( project2 );\n+        \n+        return projects;\n+    }\n+    \n+    private Project createProject( String scmUrl, String name, String version, int id )\n+    {\n+        Project project = new Project();\n+        project.setId( id );\n+        project.setName( name );\n+        project.setVersion( version );\n+        project.setScmUrl( scmUrl );\n+        \n+        return project;\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "e42f89106285c5d17c2fb990556116279d775d89",
                "filename": "continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/stub/AddProjectActionStub.java",
                "blob_url": "https://github.com/apache/continuum/blob/509a9d025d597d77038090dbed37dbe17df9594c/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/stub/AddProjectActionStub.java",
                "raw_url": "https://github.com/apache/continuum/raw/509a9d025d597d77038090dbed37dbe17df9594c/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/stub/AddProjectActionStub.java",
                "status": "added",
                "changes": 57,
                "additions": 57,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/test/java/org/apache/maven/continuum/web/action/stub/AddProjectActionStub.java?ref=509a9d025d597d77038090dbed37dbe17df9594c",
                "patch": "@@ -0,0 +1,57 @@\n+package org.apache.maven.continuum.web.action.stub;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import org.apache.maven.continuum.web.action.AddProjectAction;\n+\n+/**\n+ * Stub for {@link AddProjectAction}\n+ *\n+ * @author <a href=\"mailto:jzurbano@apache.org\">jzurbano</a>\n+ */\n+public class AddProjectActionStub\n+    extends AddProjectAction\n+{\n+    public String input()\n+    {\n+        return INPUT;\n+    }\n+\n+    private void initializeProjectGroupName()\n+    {\n+        setProjectGroupName( \"Test Project Group\" );\n+    }\n+\n+    private boolean isAuthorizedToAddProjectToGroup( String projectGroupName )\n+    {\n+        return true;\n+    }\n+    \n+    protected void checkAddProjectGroupAuthorization()\n+    {\n+        // skip authorization check\n+    }\n+    \n+    protected void checkAddProjectToGroupAuthorization( String projectGroupName )\n+    {\n+        // skip authorization check\n+    }\n+}\n+",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2318] - NPE when adding Ant/Shell Projects\nmerge r 808274:808275 from 1.3.x branch\n- added null checks\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@808276 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/90f6b26b4d5f6e7dd98ecee000054b3f883d8778",
        "parent": "https://github.com/apache/continuum/commit/c31b0f60e70805f856e227eb82913eed3d21c5e1",
        "bug_id": "continuum_41",
        "file": [
            {
                "sha": "9b24cfc3ab7c5185eb441b25e3100cc1058fbaa4",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/90f6b26b4d5f6e7dd98ecee000054b3f883d8778/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/90f6b26b4d5f6e7dd98ecee000054b3f883d8778/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectAction.java?ref=90f6b26b4d5f6e7dd98ecee000054b3f883d8778",
                "patch": "@@ -92,15 +92,15 @@ public void validate()\n         clearErrorsAndMessages();\n         try\n         {\n-            if ( !( projectName.trim().length() > 0 ) )\n+            if ( ( projectName != null ) && !( projectName.trim().length() > 0 ) )\n             {\n                 addActionError( getText( \"addProject.name.required\" ) );\n             }\n-            if ( !( projectVersion.trim().length() > 0 ) )\n+            if ( ( projectVersion != null ) && !( projectVersion.trim().length() > 0 ) )\n             {\n                 addActionError( getText( \"addProject.version.required\" ) );\n             }\n-            if ( !( projectScmUrl.trim().length() > 0 ) )\n+            if ( ( projectScmUrl != null ) && !( projectScmUrl.trim().length() > 0 ) )\n             {\n                 addActionError( getText( \"addProject.scmUrl.required\" ) );\n             }",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2320] prevent NPE in build agent task queue manager\nmerge -r 802672:802673 from 1.3.x branch\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@802674 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/c71b0af51883414ae3a5dbf6619c7b09e39bf4a4",
        "parent": "https://github.com/apache/continuum/commit/093996f086ba158a07f9b7bc20f73d49c527b2a1",
        "bug_id": "continuum_42",
        "file": [
            {
                "sha": "66e7dfe577e227a043cacb971649d26bed5d3e03",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/manager/DefaultBuildAgentTaskQueueManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/c71b0af51883414ae3a5dbf6619c7b09e39bf4a4/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/manager/DefaultBuildAgentTaskQueueManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/c71b0af51883414ae3a5dbf6619c7b09e39bf4a4/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/manager/DefaultBuildAgentTaskQueueManager.java",
                "status": "modified",
                "changes": 22,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/taskqueue/manager/DefaultBuildAgentTaskQueueManager.java?ref=c71b0af51883414ae3a5dbf6619c7b09e39bf4a4",
                "patch": "@@ -117,8 +117,11 @@ private void removeProjectsFromBuildQueue()\n             {\n                 for ( BuildProjectTask task : queues )\n                 {\n-                    log.info( \"remove project '\" + task.getProjectName() + \"' from build queue\" );\n-                    buildAgentBuildQueue.remove( task );\n+                    if ( task != null )\n+                    {\n+                        log.info( \"remove project '\" + task.getProjectName() + \"' from build queue\" );\n+                        buildAgentBuildQueue.remove( task );\n+                    }\n                 }\n             }\n             else\n@@ -186,7 +189,7 @@ public boolean isProjectInBuildQueue( int projectId )\n             {\n                 for ( BuildProjectTask task : queues )\n                 {\n-                    if ( task.getProjectId() == projectId )\n+                    if ( task != null && task.getProjectId() == projectId )\n                     {\n                         log.info( \"project already in build queue\" );\n                         return true;\n@@ -217,8 +220,9 @@ public boolean isInPrepareBuildQueue( int projectGroupId, BuildTrigger buildTrig\n             {\n                 for ( PrepareBuildProjectsTask task : queues )\n                 {\n-                \tif ( task.getProjectGroupId() == projectGroupId && task.getBuildTrigger().getTrigger() == buildTrigger.getTrigger() &&\n-                        task.getScmRootAddress().equals( scmRootAddress ) )\n+                \tif ( task != null && task.getProjectGroupId() == projectGroupId && \n+                             task.getBuildTrigger().getTrigger() == buildTrigger.getTrigger() &&\n+                             task.getScmRootAddress().equals( scmRootAddress ) )\n                     {\n                         log.info( \"projects already in build queue\" );\n                         return true;\n@@ -300,7 +304,7 @@ public boolean removeFromPrepareBuildQueue( int projectGroupId, int scmRootId )\n         {\n             for ( PrepareBuildProjectsTask task : tasks )\n             {\n-                if ( task.getProjectGroupId() == projectGroupId && task.getScmRootId() == scmRootId )\n+                if ( task != null && task.getProjectGroupId() == projectGroupId && task.getScmRootId() == scmRootId )\n                 {\n                     return getPrepareBuildQueue().remove( task );\n                 }\n@@ -319,7 +323,7 @@ public void removeFromPrepareBuildQueue( int[] hashCodes )\n         {\n             for ( PrepareBuildProjectsTask task : tasks )\n             {\n-                if ( ArrayUtils.contains( hashCodes, task.getHashCode() ) )\n+                if ( task != null && ArrayUtils.contains( hashCodes, task.getHashCode() ) )\n                 {\n                     getPrepareBuildQueue().remove( task );\n                 }\n@@ -336,7 +340,7 @@ public boolean removeFromBuildQueue( int projectId, int buildDefinitionId )\n         {\n             for ( BuildProjectTask task : tasks )\n             {\n-                if ( task.getProjectId() == projectId && task.getBuildDefinitionId() == buildDefinitionId )\n+                if ( task != null && task.getProjectId() == projectId && task.getBuildDefinitionId() == buildDefinitionId )\n                 {\n                     return getBuildQueue().remove( task );\n                 }\n@@ -355,7 +359,7 @@ public void removeFromBuildQueue( int[] hashCodes )\n         {\n             for ( BuildProjectTask task : tasks )\n             {\n-                if ( ArrayUtils.contains( hashCodes, task.getHashCode() ) )\n+                if ( task != null && ArrayUtils.contains( hashCodes, task.getHashCode() ) )\n                 {\n                     getBuildQueue().remove( task );\n                 }",
                "deletions": 9
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2295]\n- more on preventing NPE when scm result is null\n- added unit test\nmerge -r 793474:793475 from 1.3.x branch\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@793478 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/a5161d919fc0788407aa2036384e6bb282d942f4",
        "parent": "https://github.com/apache/continuum/commit/697428182e590e4411737d9e6666edcffd8a2572",
        "bug_id": "continuum_43",
        "file": [
            {
                "sha": "d857f069e12d766bf1c003ca9bd2ee743e1ee11a",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/a5161d919fc0788407aa2036384e6bb282d942f4/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/a5161d919fc0788407aa2036384e6bb282d942f4/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "status": "modified",
                "changes": 16,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java?ref=a5161d919fc0788407aa2036384e6bb282d942f4",
                "patch": "@@ -485,11 +485,14 @@ protected boolean shouldBuild( BuildContext context )\n             project.getState() != ContinuumProjectState.NEW && project.getState() != ContinuumProjectState.CHECKEDOUT )\n         {\n             // Check SCM changes\n-            allChangesUnknown = checkAllChangesUnknown( context.getScmResult().getChanges() );\n+            if ( context.getScmResult() != null )\n+            {\n+                allChangesUnknown = checkAllChangesUnknown( context.getScmResult().getChanges() );\n+            }\n \n             if ( allChangesUnknown )\n             {\n-                if ( !context.getScmResult().getChanges().isEmpty() )\n+                if ( context.getScmResult() != null && !context.getScmResult().getChanges().isEmpty() )\n                 {\n                     log.info(\n                         \"The project was not built because all changes are unknown (maybe local modifications or ignored files not defined in your SCM tool.\" );\n@@ -510,14 +513,19 @@ protected boolean shouldBuild( BuildContext context )\n         }\n \n         // Check changes\n-        if ( !shouldBuild && ( ( !allChangesUnknown && !context.getScmResult().getChanges().isEmpty() ) ||\n+        if ( !shouldBuild && ( ( !allChangesUnknown && context.getScmResult() != null && !context.getScmResult().getChanges().isEmpty() ) ||\n             project.getExecutorId().equals( ContinuumBuildExecutorConstants.MAVEN_TWO_BUILD_EXECUTOR ) ) )\n         {\n             try\n             {\n                 ContinuumBuildExecutor executor = buildExecutorManager.getBuildExecutor( project.getExecutorId() );\n \n-                if ( context.getScmResult() != null )\n+                if ( executor == null )\n+                {\n+                    log.warn( \"No continuum build executor found for project \" + project.getId() + \n+                              \" with executor '\" + project.getExecutorId() + \"'\" );\n+                }\n+                else if ( context.getScmResult() != null )\n                 {\n                     shouldBuild = executor.shouldBuild( context.getScmResult().getChanges(), project,\n                                                         workingDirectoryService.getWorkingDirectory( project ),",
                "deletions": 4
            },
            {
                "sha": "2195e4a74f5191535c86cc5556ad1221e863620f",
                "filename": "continuum-core/src/test/java/org/apache/maven/continuum/buildcontroller/DefaultBuildControllerTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/a5161d919fc0788407aa2036384e6bb282d942f4/continuum-core/src/test/java/org/apache/maven/continuum/buildcontroller/DefaultBuildControllerTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/a5161d919fc0788407aa2036384e6bb282d942f4/continuum-core/src/test/java/org/apache/maven/continuum/buildcontroller/DefaultBuildControllerTest.java",
                "status": "modified",
                "changes": 10,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/test/java/org/apache/maven/continuum/buildcontroller/DefaultBuildControllerTest.java?ref=a5161d919fc0788407aa2036384e6bb282d942f4",
                "patch": "@@ -185,6 +185,16 @@ public void testWithDependencyChanges()\n         assertTrue( controller.shouldBuild( context ) );\n     }\n \n+    public void testWithNullScmResult()\n+        throws Exception\n+    {\n+        BuildContext context = getContext( +1 );\n+        context.setScmResult( null );\n+        controller.checkProjectDependencies( context );\n+        assertEquals( 0, context.getModifiedDependencies().size() );\n+        assertFalse( controller.shouldBuild( context ) );\n+    }\n+\n     private File getWorkingDirectory()\n         throws Exception\n     {",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2295] prevent NPE when scmResult is null or scmResult.changes is null\nmerge -r 793464:793465 from 1.3.x branch\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@793466 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/697428182e590e4411737d9e6666edcffd8a2572",
        "parent": "https://github.com/apache/continuum/commit/ec30595bae2f6326e95facd8248024a70c953467",
        "bug_id": "continuum_44",
        "file": [
            {
                "sha": "f7f4a66967cd862a2ac25fee667e7a15b8047ea9",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/697428182e590e4411737d9e6666edcffd8a2572/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/697428182e590e4411737d9e6666edcffd8a2572/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "status": "modified",
                "changes": 10,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java?ref=697428182e590e4411737d9e6666edcffd8a2572",
                "patch": "@@ -516,9 +516,13 @@ protected boolean shouldBuild( BuildContext context )\n             try\n             {\n                 ContinuumBuildExecutor executor = buildExecutorManager.getBuildExecutor( project.getExecutorId() );\n-                shouldBuild = executor.shouldBuild( context.getScmResult().getChanges(), project,\n-                                                    workingDirectoryService.getWorkingDirectory( project ),\n-                                                    context.getBuildDefinition() );\n+\n+                if ( context.getScmResult() != null )\n+                {\n+                    shouldBuild = executor.shouldBuild( context.getScmResult().getChanges(), project,\n+                                                        workingDirectoryService.getWorkingDirectory( project ),\n+                                                        context.getBuildDefinition() );\n+                }\n             }\n             catch ( Exception e )\n             {",
                "deletions": 3
            },
            {
                "sha": "6cc1ddf3fd52498f01660a3cc4faa399903685e1",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/697428182e590e4411737d9e6666edcffd8a2572/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/697428182e590e4411737d9e6666edcffd8a2572/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java?ref=697428182e590e4411737d9e6666edcffd8a2572",
                "patch": "@@ -398,10 +398,10 @@ public boolean shouldBuild( List<ChangeSet> changes, Project continuumProject, F\n         //Check if it's a recursive build\n         boolean isRecursive = false;\n         if (StringUtils.isNotEmpty( buildDefinition.getArguments() ) )\n-            {\n+        {\n             isRecursive =  buildDefinition.getArguments().indexOf( \"-N\" ) < 0 &&\n                 buildDefinition.getArguments().indexOf( \"--non-recursive\" ) < 0 ;\n-            }\n+        }\n         if ( isRecursive && changes != null && !changes.isEmpty() )\n         {\n             if ( log.isInfoEnabled() )\n@@ -413,7 +413,7 @@ public boolean shouldBuild( List<ChangeSet> changes, Project continuumProject, F\n \n         MavenProject project = getMavenProject( continuumProject, workingDirectory, buildDefinition );\n \n-        if ( changes.isEmpty() )\n+        if ( changes == null || changes.isEmpty() )\n         {\n             if ( log.isInfoEnabled() )\n             {",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix potential NPE\nmerge 787649:787650 from continuum-1.3.x branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@787651 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/6346f5e0044e9fe2d2d0fb4ecadbf9af31cc80a8",
        "parent": "https://github.com/apache/continuum/commit/57b3f83cc3b41cd05b1afc7040a8a2b91306580a",
        "bug_id": "continuum_45",
        "file": [
            {
                "sha": "334a83d2527ee63834b51767d6c212df13f73a50",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/core/action/CheckWorkingDirectoryAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/6346f5e0044e9fe2d2d0fb4ecadbf9af31cc80a8/continuum-core/src/main/java/org/apache/maven/continuum/core/action/CheckWorkingDirectoryAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/6346f5e0044e9fe2d2d0fb4ecadbf9af31cc80a8/continuum-core/src/main/java/org/apache/maven/continuum/core/action/CheckWorkingDirectoryAction.java",
                "status": "modified",
                "changes": 9,
                "additions": 9,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/core/action/CheckWorkingDirectoryAction.java?ref=6346f5e0044e9fe2d2d0fb4ecadbf9af31cc80a8",
                "patch": "@@ -23,6 +23,7 @@\n import java.util.Map;\n \n import org.apache.continuum.dao.ProjectDao;\n+import org.apache.maven.continuum.ContinuumException;\n import org.apache.maven.continuum.model.project.Project;\n import org.apache.maven.continuum.utils.WorkingDirectoryService;\n \n@@ -63,6 +64,14 @@ public void execute( Map context )\n \n         File[] files = workingDirectory.listFiles();\n \n+        if ( files == null )\n+        {\n+            //workingDirectory isn't a directory but a file. Not possible in theory.\n+            String msg = workingDirectory.getAbsolutePath() + \" isn't a directory but a file.\";\n+            getLogger().error( msg );\n+            throw new ContinuumException( msg );\n+        }\n+\n         setWorkingDirectoryExist( context, files.length > 0 );\n     }\n ",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2205] Fix NPE on httpError page\nmerge 778997:778998 from continuum-1.3.x branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@778999 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/33dcd207fcdbd8c07618ea6508debec643c7e472",
        "parent": "https://github.com/apache/continuum/commit/7bb88dd876bb81ecef50a71a829bf7f394a84dd2",
        "bug_id": "continuum_46",
        "file": [
            {
                "sha": "394cad1450ac9223320d77519d2239a863f6f1a7",
                "filename": "continuum-webapp/src/main/java/org/apache/continuum/web/action/error/HttpError.java",
                "blob_url": "https://github.com/apache/continuum/blob/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/java/org/apache/continuum/web/action/error/HttpError.java",
                "raw_url": "https://github.com/apache/continuum/raw/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/java/org/apache/continuum/web/action/error/HttpError.java",
                "status": "added",
                "changes": 51,
                "additions": 51,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/continuum/web/action/error/HttpError.java?ref=33dcd207fcdbd8c07618ea6508debec643c7e472",
                "patch": "@@ -0,0 +1,51 @@\n+package org.apache.continuum.web.action.error;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import org.apache.maven.continuum.web.action.ContinuumActionSupport;\n+\n+/**\n+ * AboutAction:\n+ *\n+ * @author: Emmanuel Venisse <evenisse@apache.org>\n+ * @version: $Id:$\n+ * @plexus.component role=\"com.opensymphony.xwork2.Action\" role-hint=\"httpError\"\n+ */\n+public class HttpError\n+    extends ContinuumActionSupport\n+{\n+    private int errorCode;\n+\n+    public String execute()\n+        throws Exception\n+    {\n+        return SUCCESS;\n+    }\n+\n+    public int getErrorCode()\n+    {\n+        return errorCode;\n+    }\n+\n+    public void setErrorCode( int errorCode )\n+    {\n+        this.errorCode = errorCode;\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "9c0410074d9e3c6292b9ec958dd7cf4afbf7ef36",
                "filename": "continuum-webapp/src/main/resources/struts.xml",
                "blob_url": "https://github.com/apache/continuum/blob/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/resources/struts.xml",
                "raw_url": "https://github.com/apache/continuum/raw/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/resources/struts.xml",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/struts.xml?ref=33dcd207fcdbd8c07618ea6508debec643c7e472",
                "patch": "@@ -164,11 +164,14 @@\n       <result type=\"redirect-action\">groupSummary</result>\n     </action>\n \n+    <action name=\"httpError\" class=\"httpError\">\n+      <result name=\"success\">/WEB-INF/jsp/error/httpError.jsp</result>\n+    </action>\n+\n     <action name=\"about\" class=\"about\">\n       <result name=\"success\">/WEB-INF/jsp/about.jsp</result>\n     </action>\n \n-\n     <action name=\"companyInfo\" class=\"companyInfo\">\n       <result name=\"success\">/WEB-INF/jsp/components/companyLogo.jsp</result>\n       <interceptor-ref name=\"basicStack\" />",
                "deletions": 1
            },
            {
                "sha": "9845b57bd78fc01992b9895ed81843effa0ac400",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/jsp/error/httpError.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/WEB-INF/jsp/error/httpError.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/WEB-INF/jsp/error/httpError.jsp",
                "status": "modified",
                "changes": 101,
                "additions": 37,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/jsp/error/httpError.jsp?ref=33dcd207fcdbd8c07618ea6508debec643c7e472",
                "patch": "@@ -33,79 +33,52 @@\n       <c:when test=\"${param.errorCode == 404}\">\n         <s:text name=\"error.404.title\"/>\n       </c:when>\n-      <c:when test=\"${param.errorCode == 405}\">\n-        <s:text name=\"error.405.title\"/>\n+      <c:when test=\"${param.errorCode == 500}\">\n+        <s:text name=\"error.500.title\"/>\n       </c:when>\n       <c:otherwise>\n         <s:text name=\"error.page.title\"/>\n       </c:otherwise>\n     </c:choose>\n   </title>\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"<s:url value=\"/css/tigris.css\" includeParams=\"none\"/>\" media=\"screen\"/>\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"<s:url value=\"/css/print.css\" includeParams=\"none\"/>\" media=\"print\"/>\n-  <link rel=\"stylesheet\" type=\"text/css\" href=\"<s:url value=\"/css/extremecomponents.css\" includeParams=\"none\"/>\" media=\"screen\"/>\n-  <link rel=\"shortcut icon\" href=\"<s:url value=\"/favicon.ico\" includeParams=\"none\"/>\" type=\"image/x-icon\"/>\n-\n-  <script src=\"<s:url value=\"/scripts/tigris.js\" includeParams=\"none\"/>\" type=\"text/javascript\"></script>\n </head>\n \n-<body onload=\"focus()\" marginwidth=\"0\" marginheight=\"0\" class=\"composite\">\n-<s:include value=\"/WEB-INF/jsp/navigations/DefaultTop.jsp\"/>\n-\n-<table id=\"main\" border=\"0\" cellpadding=\"4\" cellspacing=\"0\" width=\"100%\">\n-  <tbody>\n-    <tr valign=\"top\">\n-      <td id=\"leftcol\" width=\"180\">\n-        <br/> <br/>\n-        <s:include value=\"/WEB-INF/jsp/navigations/Menu.jsp\"/>\n-      </td>\n-      <td width=\"86%\">\n-        <br/>\n-\n-        <div id=\"bodycol\">\n-          <div class=\"app\">\n-            <div id=\"axial\" class=\"h3\">\n-              <h3>\n-                <c:choose>\n-                  <c:when test=\"${param.errorCode == 403}\">\n-                    <s:text name=\"error.403.section.title\"/>\n-                  </c:when>\n-                  <c:when test=\"${param.errorCode == 404}\">\n-                    <s:text name=\"error.404.section.title\"/>\n-                  </c:when>\n-                  <c:when test=\"${param.errorCode == 405}\">\n-                    <s:text name=\"error.405.section.title\"/>\n-                  </c:when>\n-                  <c:otherwise>\n-                    The URL requested results to an unknown error.\n-                  </c:otherwise>\n-                </c:choose>\n-              </h3>\n+<body>\n+  <div id=\"h3\">\n+    <h3>\n+      <c:choose>\n+        <c:when test=\"${param.errorCode == 403}\">\n+          <s:text name=\"error.403.section.title\"/>\n+        </c:when>\n+        <c:when test=\"${param.errorCode == 404}\">\n+          <s:text name=\"error.404.section.title\"/>\n+        </c:when>\n+        <c:when test=\"${param.errorCode == 500}\">\n+          <s:text name=\"error.500.section.title\"/>\n+        </c:when>\n+        <c:otherwise>\n+          The URL requested results to an unknown error (Error <s:property value=\"errorCode\"/>).\n+        </c:otherwise>\n+      </c:choose>\n+    </h3>\n \n-              <div class=\"errormessage\">\n-                <c:choose>\n-                  <c:when test=\"${param.errorCode == 403}\">\n-                    <s:text name=\"error.403.message\"/>\n-                  </c:when>\n-                  <c:when test=\"${param.errorCode == 404}\">\n-                    <s:text name=\"error.404.message\"/>\n-                  </c:when>\n-                  <c:when test=\"${param.errorCode == 405}\">\n-                    <s:text name=\"error.405.message\"/>\n-                  </c:when>\n-                  <c:otherwise>\n-                    The URL requested results to an unknown error.\n-                  </c:otherwise>\n-                </c:choose>\n-              </div>\n-            </div>\n-          </div>\n-        </div>\n-      </td>\n-    </tr>\n-  </tbody>\n-</table>\n-<s:include value=\"/WEB-INF/jsp/navigations/DefaultBottom.jsp\"/>\n+    <div class=\"errormessage\">\n+      <c:choose>\n+        <c:when test=\"${param.errorCode == 403}\">\n+          <s:text name=\"error.403.message\"/>\n+        </c:when>\n+        <c:when test=\"${param.errorCode == 404}\">\n+          <s:text name=\"error.404.message\"/>\n+        </c:when>\n+        <c:when test=\"${param.errorCode == 500}\">\n+          <s:text name=\"error.500.message\"/>\n+        </c:when>\n+        <c:otherwise>\n+          The URL requested results to an unknown error (Error <s:property value=\"errorCode\"/>).\n+        </c:otherwise>\n+      </c:choose>\n+    </div>\n+  </div>\n </body>\n </html>\n </s:i18n>\n\\ No newline at end of file",
                "deletions": 64
            },
            {
                "sha": "0d7e3640015019bde72d84878c3d53d5d4c93af3",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "blob_url": "https://github.com/apache/continuum/blob/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "raw_url": "https://github.com/apache/continuum/raw/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/web.xml?ref=33dcd207fcdbd8c07618ea6508debec643c7e472",
                "patch": "@@ -138,15 +138,15 @@\n   \n   <error-page>\n     <error-code>403</error-code>\n-    <location>/WEB-INF/jsp/error/httpError.jsp?errorCode=403</location>\n+    <location>/httpError.jsp?errorCode=403</location>\n   </error-page>\n   <error-page>\n     <error-code>404</error-code>\n-    <location>/WEB-INF/jsp/error/httpError.jsp?errorCode=404</location>\n+    <location>/httpError.jsp?errorCode=404</location>\n   </error-page>\n   <error-page>\n     <error-code>500</error-code>\n-    <location>/WEB-INF/jsp/error/httpError.jsp?errorCode=500</location>\n+    <location>/httpError.jsp?errorCode=500</location>\n   </error-page>\n \n   <!-- [jspc-maven-plugin:post-compiled-jsps-as-servlets] -->",
                "deletions": 3
            },
            {
                "sha": "26bd9c50cc34b90c658a9b5c09888a2987211ced",
                "filename": "continuum-webapp/src/main/webapp/httpError.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/httpError.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/33dcd207fcdbd8c07618ea6508debec643c7e472/continuum-webapp/src/main/webapp/httpError.jsp",
                "status": "added",
                "changes": 20,
                "additions": 20,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/httpError.jsp?ref=33dcd207fcdbd8c07618ea6508debec643c7e472",
                "patch": "@@ -0,0 +1,20 @@\n+<%--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one\n+  ~ or more contributor license agreements.  See the NOTICE file\n+  ~ distributed with this work for additional information\n+  ~ regarding copyright ownership.  The ASF licenses this file\n+  ~ to you under the Apache License, Version 2.0 (the\n+  ~ \"License\"); you may not use this file except in compliance\n+  ~ with the License.  You may obtain a copy of the License at\n+  ~\n+  ~   http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing,\n+  ~ software distributed under the License is distributed on an\n+  ~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+  ~ KIND, either express or implied.  See the License for the\n+  ~ specific language governing permissions and limitations\n+  ~ under the License.\n+  --%>\n+\n+<% response.sendRedirect(  request.getContextPath() + \"/httpError.action?errorCode=\"+ request.getParameter( \"errorCode\" ) ); %>",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2179] prevent NPE when updating project from working copy on build agents. \nmerge -r 765979:765980 from 1.3.x branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@765981 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/c633b5f0e91bc3f624df46631944e5cdaa1117ac",
        "parent": "https://github.com/apache/continuum/commit/5afd913ae9ccac0766a13300b9c594944b6e7633",
        "bug_id": "continuum_47",
        "file": [
            {
                "sha": "a0e730c07254909070282aef81925d1e3cfc15cd",
                "filename": "continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/c633b5f0e91bc3f624df46631944e5cdaa1117ac/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/c633b5f0e91bc3f624df46631944e5cdaa1117ac/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java",
                "status": "modified",
                "changes": 74,
                "additions": 65,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-buildagent/continuum-buildagent-core/src/main/java/org/apache/continuum/buildagent/build/execution/AbstractBuildExecutor.java?ref=c633b5f0e91bc3f624df46631944e5cdaa1117ac",
                "patch": "@@ -320,9 +320,30 @@ protected void updateProject( Project project )\n         Map<String, Object> projectMap = new HashMap<String, Object>();\n \n         projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_ID, project.getId() );\n-        projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, project.getVersion() );\n-        projectMap.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, project.getArtifactId() );\n-        projectMap.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, project.getGroupId() );\n+        if ( StringUtils.isNotEmpty( project.getVersion() ) )\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, project.getVersion() );\n+        }\n+        else\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, \"\" );\n+        }\n+        if ( StringUtils.isNotEmpty( project.getArtifactId() ) )\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, project.getArtifactId() );\n+        }\n+        else\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, \"\" );\n+        }\n+        if ( StringUtils.isNotEmpty( project.getGroupId() ) )\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, project.getGroupId() );\n+        }\n+        else\n+        {\n+            projectMap.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, \"\" );\n+        }\n         if ( StringUtils.isNotEmpty( project.getName() ) )\n         {\n             projectMap.put( ContinuumBuildAgentUtil.KEY_PROJECT_NAME, project.getName() );\n@@ -390,8 +411,22 @@ protected void updateProject( Project project )\n             {\n                 Map<String, String> map = new HashMap<String, String>();\n                 map.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_NAME, developer.getName() );\n-                map.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_EMAIL, developer.getEmail() );\n-                map.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_SCMID, developer.getScmId() );\n+                if ( StringUtils.isNotEmpty( developer.getEmail() ) )\n+                {\n+                \tmap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_EMAIL, developer.getEmail() );\n+                }\n+                else\n+                {\n+                \tmap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_EMAIL, \"\" );\n+                }\n+                if ( StringUtils.isNotEmpty( developer.getScmId() ) )\n+                {\n+                \tmap.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_SCMID, developer.getScmId() );\n+                }\n+                else\n+                {\n+                    map.put( ContinuumBuildAgentUtil.KEY_PROJECT_DEVELOPER_SCMID, \"\" );\n+                }\n \n                 pDevelopers.add( map );\n             }\n@@ -405,9 +440,30 @@ protected void updateProject( Project project )\n \n         if ( parent != null )\n         {\n-            map.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, parent.getGroupId() );\n-            map.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, parent.getArtifactId() );\n-            map.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, parent.getVersion() );\n+            if ( StringUtils.isNotEmpty( parent.getGroupId() ) )\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, parent.getGroupId() );\n+            }\n+            else\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_GROUP_ID, \"\" );\n+            }\n+            if ( StringUtils.isNotEmpty( parent.getArtifactId() ) )\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, parent.getArtifactId() );\n+            }\n+            else\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_ARTIFACT_ID, \"\" );\n+            }\n+            if ( StringUtils.isNotEmpty( parent.getVersion() ) )\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, parent.getVersion() );\n+            }\n+            else\n+            {\n+                map.put( ContinuumBuildAgentUtil.KEY_PROJECT_VERSION, \"\" );\n+            }\n         }\n         return map;\n     }\n@@ -455,7 +511,7 @@ protected void updateProject( Project project )\n                 }\n                 else\n                 {\n-\n+                    map.put( ContinuumBuildAgentUtil.KEY_NOTIFIER_CONFIGURATION, \"\" );\n                 }\n                 if ( StringUtils.isNotBlank( notifier.getType() ) )\n                 {",
                "deletions": 9
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "merge -r 706091:706092 from continuum-1.2.x branch\n- fixed NPE when saving project group\n- [CONTINUUM-1937] rename variable\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@706093 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/ee68a344e4836d89c7102031f3b836ebf265b75e",
        "parent": "https://github.com/apache/continuum/commit/7485718815f4a138dab26a0c629ec9df74495407",
        "bug_id": "continuum_48",
        "file": [
            {
                "sha": "71911c47e77272ef8b92bb20ca207b5c114ce6b8",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/ee68a344e4836d89c7102031f3b836ebf265b75e/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/ee68a344e4836d89c7102031f3b836ebf265b75e/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "status": "modified",
                "changes": 23,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java?ref=ee68a344e4836d89c7102031f3b836ebf265b75e",
                "patch": "@@ -362,11 +362,11 @@ public String edit()\n \n         repositories = getContinuum().getRepositoryService().getAllLocalRepositories();\n \n-        Collection<Project> projects = getContinuum().getProjectsInGroupWithDependencies( projectGroup.getId() );\n-        if ( projects != null && projects.size() > 0 )\n+        Collection<Project> projList = getContinuum().getProjectsInGroupWithDependencies( projectGroup.getId() );\n+        if ( projList != null && projList.size() > 0 )\n         {\n             Project rootProject = ( getContinuum().getProjectsInBuildOrder( projects ) ).get( 0 );\n-        \n+\n             if (rootProject != null)\n             {\n                 setUrl( rootProject.getUrl() );\n@@ -453,13 +453,16 @@ else if ( name.trim().equals( \"\" ) )\n \n         getContinuum().updateProjectGroup( projectGroup );\n \n-        Project rootProject = ( getContinuum().getProjectsInBuildOrder( getContinuum()\n-            .getProjectsInGroupWithDependencies( projectGroupId ) ) ).get( 0 );\n-        \n-        rootProject.setUrl( url );\n-        \n-        getContinuum().updateProject( rootProject );\n-        \n+        Collection<Project> projectList = getContinuum().getProjectsInGroupWithDependencies( projectGroupId );\n+        if ( projectList != null && projectList.size() > 0 )\n+        {\n+            Project rootProject = ( getContinuum().getProjectsInBuildOrder( projectList ) ).get( 0 );\n+\n+            rootProject.setUrl( url );\n+\n+            getContinuum().updateProject( rootProject );\n+        }\n+\n         Iterator keys = projects.keySet().iterator();\n         while ( keys.hasNext() )\n         {",
                "deletions": 10
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "merge -r 706085:706086 from continuum-1.2.x branch\n[CONTINUUM-1937] fixed NPE when editing project group\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@706089 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/7485718815f4a138dab26a0c629ec9df74495407",
        "parent": "https://github.com/apache/continuum/commit/db313db8de18ce754805e0772af91f7c5403559f",
        "bug_id": "continuum_49",
        "file": [
            {
                "sha": "f4126cdeba8ac9ccef0829b1ca16d00ade231e1f",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/7485718815f4a138dab26a0c629ec9df74495407/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/7485718815f4a138dab26a0c629ec9df74495407/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "status": "modified",
                "changes": 14,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java?ref=7485718815f4a138dab26a0c629ec9df74495407",
                "patch": "@@ -362,14 +362,16 @@ public String edit()\n \n         repositories = getContinuum().getRepositoryService().getAllLocalRepositories();\n \n-        Project rootProject = ( getContinuum().getProjectsInBuildOrder( getContinuum()\n-            .getProjectsInGroupWithDependencies( projectGroup.getId() ) ) ).get( 0 );\n-        \n-        if (rootProject != null)\n+        Collection<Project> projects = getContinuum().getProjectsInGroupWithDependencies( projectGroup.getId() );\n+        if ( projects != null && projects.size() > 0 )\n         {\n-            setUrl( rootProject.getUrl() );\n-        }\n+            Project rootProject = ( getContinuum().getProjectsInBuildOrder( projects ) ).get( 0 );\n         \n+            if (rootProject != null)\n+            {\n+                setUrl( rootProject.getUrl() );\n+            }\n+        }\n         return SUCCESS;\n     }\n ",
                "deletions": 6
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "merge -r 701752:701753 from continuum-1.2.x branch [CONTINUUM-1572] fixed NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@701757 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/1badd65b7453d54314eb44f4a0a3bfaa9e737b84",
        "parent": "https://github.com/apache/continuum/commit/1663e51520414aeef4d2356c270000820cbfb277",
        "bug_id": "continuum_50",
        "file": [
            {
                "sha": "bec0dd6a394703b79c4cdf2de90d12c552727923",
                "filename": "continuum-release/src/main/resources/META-INF/plexus/components.xml",
                "blob_url": "https://github.com/apache/continuum/blob/1badd65b7453d54314eb44f4a0a3bfaa9e737b84/continuum-release/src/main/resources/META-INF/plexus/components.xml",
                "raw_url": "https://github.com/apache/continuum/raw/1badd65b7453d54314eb44f4a0a3bfaa9e737b84/continuum-release/src/main/resources/META-INF/plexus/components.xml",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-release/src/main/resources/META-INF/plexus/components.xml?ref=1badd65b7453d54314eb44f4a0a3bfaa9e737b84",
                "patch": "@@ -46,6 +46,9 @@\n         <requirement>\n           <role>org.apache.maven.continuum.utils.WorkingDirectoryService</role>\n         </requirement>\n+        <requirement>\n+          <role>org.apache.maven.continuum.installation.InstallationService</role>\n+        </requirement>\n       </requirements>\n     </component>\n ",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "CONTINUUM-1863 Guard against NPE when clicking Appearance menu button\nmerged r690610 from 1.2.x branch\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@690611 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/40bacf6c9f32316d15cf0f8cfc1474c51aa76626",
        "parent": "https://github.com/apache/continuum/commit/86be7979f0f1c34e260eb9b242ec5fe9aa9eee25",
        "bug_id": "continuum_51",
        "file": [
            {
                "sha": "f1046b22fe9260b0975bf9c09e003c25515b10e8",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureAppearanceAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/40bacf6c9f32316d15cf0f8cfc1474c51aa76626/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureAppearanceAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/40bacf6c9f32316d15cf0f8cfc1474c51aa76626/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureAppearanceAction.java",
                "status": "modified",
                "changes": 9,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ConfigureAppearanceAction.java?ref=40bacf6c9f32316d15cf0f8cfc1474c51aa76626",
                "patch": "@@ -138,13 +138,16 @@ public void prepare()\n             for ( String profileId : profileIds )\n             {\n                 Profile profile = profilesAsMap.get( profileId );\n-                List<Repository> repos = profile.getRepositories();\n-                if ( repos != null && !repos.isEmpty() )\n+                if (profile != null)\n                 {\n-                    for ( Repository repo : repos )\n+                    List<Repository> repos = profile.getRepositories();\n+                    if ( repos != null && !repos.isEmpty() )\n                     {\n+                        for ( Repository repo : repos )\n+                        {\n                         remoteRepositories.add( artifactRepositoryFactory.createArtifactRepository( repo.getId(), repo\n                             .getUrl(), layout, null, null ) );\n+                        }\n                     }\n                 }\n             }",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix some NPE with LDAP integration and improve a lot performance on the members page\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@661400 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/04a244815215667ff6e2a0d4068d80fba8439f19",
        "parent": "https://github.com/apache/continuum/commit/99bdd676a3e2d070083b09a5a3a83e26465e9767",
        "bug_id": "continuum_52",
        "file": [
            {
                "sha": "50ea3bd47416a3ad64afda7d78f5c5ad00f5a74c",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ContinuumActionSupport.java",
                "blob_url": "https://github.com/apache/continuum/blob/04a244815215667ff6e2a0d4068d80fba8439f19/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ContinuumActionSupport.java",
                "raw_url": "https://github.com/apache/continuum/raw/04a244815215667ff6e2a0d4068d80fba8439f19/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ContinuumActionSupport.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ContinuumActionSupport.java?ref=04a244815215667ff6e2a0d4068d80fba8439f19",
                "patch": "@@ -505,7 +505,7 @@ private ActionContext getContext()\n      *\n      * @return the security system\n      */\n-    private SecuritySystem getSecuritySystem()\n+    protected SecuritySystem getSecuritySystem()\n     {\n         return securitySystem;\n     }",
                "deletions": 1
            },
            {
                "sha": "cd9ad4b8dd8cd8e9e33cd2af67f282cab1a7cd81",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/04a244815215667ff6e2a0d4068d80fba8439f19/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/04a244815215667ff6e2a0d4068d80fba8439f19/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "status": "modified",
                "changes": 104,
                "additions": 71,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java?ref=04a244815215667ff6e2a0d4068d80fba8439f19",
                "patch": "@@ -32,10 +32,10 @@\n import org.codehaus.plexus.redback.rbac.RbacManagerException;\n import org.codehaus.plexus.redback.rbac.RbacObjectNotFoundException;\n import org.codehaus.plexus.redback.rbac.Role;\n+import org.codehaus.plexus.redback.rbac.UserAssignment;\n import org.codehaus.plexus.redback.role.RoleManager;\n import org.codehaus.plexus.redback.role.RoleManagerException;\n import org.codehaus.plexus.redback.users.User;\n-import org.codehaus.plexus.redback.users.UserManager;\n import org.codehaus.plexus.util.StringUtils;\n \n import java.util.ArrayList;\n@@ -66,11 +66,6 @@\n         FILTER_CRITERIA.put( \"email\", \"Email contains\" );\n     }\n \n-    /**\n-     * @plexus.requirement role-hint=\"configurable\"\n-     */\n-    private UserManager manager;\n-\n     /**\n      * @plexus.requirement role-hint=\"cached\"\n      */\n@@ -533,25 +528,49 @@ private boolean isParentInProjectGroup( ProjectDependency parent, Collection pro\n \n     private void populateProjectGroupUsers( ProjectGroup group )\n     {\n-        List users;\n+        List<User> users = new ArrayList<User>();\n \n-        if ( StringUtils.isEmpty( filterKey ) )\n+        try\n         {\n-            // REVIEW: for caching in the user manager\n-            users = manager.getUsers( ascending );\n+            List<Role> roles = rbac.getAllRoles();\n+            List<String> roleNames = new ArrayList<String>();\n+            for ( Role r : roles )\n+            {\n+                if ( r.getName().indexOf( projectGroup.getName() ) > -1 )\n+                {\n+                    roleNames.add( r.getName() );\n+                }\n+            }\n+            List<UserAssignment> userAssignments = rbac.getUserAssignmentsForRoles( roleNames );\n+            for ( UserAssignment ua : userAssignments )\n+            {\n+                User u = getSecuritySystem().getUserManager().findUser( ua.getPrincipal() );\n+                if ( u != null )\n+                {\n+                    users.add( u );\n+                }\n+            }\n         }\n-        else\n+        catch ( Exception e )\n+        {\n+            getLogger().error( \"Can't get the users list\", e );\n+        }\n+\n+        if ( !StringUtils.isEmpty( filterKey ) )\n         {\n-            users = findUsers( filterProperty, filterKey, ascending );\n+            users = findUsers( users, filterProperty, filterKey, ascending );\n         }\n \n         projectGroupUsers = new ArrayList();\n \n-        for ( Iterator i = users.iterator(); i.hasNext(); )\n+        if ( users == null )\n         {\n-            ProjectGroupUserBean pgUser = new ProjectGroupUserBean();\n+            return;\n+        }\n \n-            User user = (User) i.next();\n+        for ( User user : users )\n+        {\n+            ProjectGroupUserBean pgUser = new ProjectGroupUserBean();\n \n             pgUser.setUser( user );\n \n@@ -584,28 +603,47 @@ private void populateProjectGroupUsers( ProjectGroup group )\n         }\n     }\n \n-    private List findUsers( String searchProperty, String searchKey, boolean orderAscending )\n+    private List<User> findUsers( List<User> users, String searchProperty, String searchKey, boolean orderAscending )\n     {\n-        List users = null;\n-\n-        if ( \"username\".equals( searchProperty ) )\n-        {\n-            users = manager.findUsersByUsernameKey( searchKey, orderAscending );\n-        }\n-        else if ( \"fullName\".equals( getFilterProperty() ) )\n+        List<User> userList = new ArrayList<User>();\n+        for ( User user : users )\n         {\n-            users = manager.findUsersByFullNameKey( searchKey, orderAscending );\n-        }\n-        else if ( \"email\".equals( getFilterProperty() ) )\n-        {\n-            users = manager.findUsersByEmailKey( searchKey, orderAscending );\n-        }\n-        else\n-        {\n-            users = Collections.EMPTY_LIST;\n+            if ( \"username\".equals( searchProperty ) )\n+            {\n+                String username = user.getUsername();\n+                if ( username != null )\n+                {\n+                    if ( username.toLowerCase().indexOf( searchKey.toLowerCase() ) >= 0 )\n+                    {\n+                        userList.add( user );\n+                    }\n+                }\n+            }\n+            else if ( \"fullName\".equals( searchProperty ) )\n+            {\n+                String fullname = user.getFullName();\n+                if ( fullname != null )\n+                {\n+                    if ( fullname.toLowerCase().indexOf( searchKey.toLowerCase() ) >= 0 )\n+                    {\n+                        userList.add( user );\n+                    }\n+                }\n+            }\n+            else if ( \"email\".equals( searchProperty ) )\n+            {\n+                String email = user.getEmail();\n+                if ( email != null )\n+                {\n+                    if ( email.toLowerCase().indexOf( searchKey.toLowerCase() ) >= 0 )\n+                    {\n+                        userList.add( user );\n+                    }\n+                }\n+            }\n         }\n \n-        return users;\n+        return userList;\n     }\n \n     public int getProjectGroupId()",
                "deletions": 33
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1725] Using the Cancel Button without an selected project will produce NPE\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@656051 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/46dc103b5f6fa39c5cf89d77acfc81d583703e91",
        "parent": "https://github.com/apache/continuum/commit/46fe9cbd519b03d8ee2898b7c80e0019e42e2d12",
        "bug_id": "continuum_53",
        "file": [
            {
                "sha": "179f550dd60bd51046d7df75b19d87f24790d310",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/46dc103b5f6fa39c5cf89d77acfc81d583703e91/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/46dc103b5f6fa39c5cf89d77acfc81d583703e91/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "status": "modified",
                "changes": 3,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java?ref=46dc103b5f6fa39c5cf89d77acfc81d583703e91",
                "patch": "@@ -64,8 +64,7 @@ public String execute()\n     public String cancelBuilds()\n         throws ContinuumException\n     {\n-        // first we remove from the build queue\n-        if ( getSelectedProjects() != null && getSelectedProjects().isEmpty() )\n+        if ( getSelectedProjects() == null || getSelectedProjects().isEmpty() )\n         {\n             return SUCCESS;\n         }",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1527] Fix NPE when Releasing without <configuration> node in the maven-release-plugin\nSubmitted by: Yudong Wang\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@586422 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/9e1693147f9bd94014fd3295662877ebc228cc2b",
        "parent": "https://github.com/apache/continuum/commit/a7e7b8e7c545972ff185d52bb132d1c9548aaf22",
        "bug_id": "continuum_54",
        "file": [
            {
                "sha": "69d473fb6567170d9bc270839d482d9e14cfb724",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/9e1693147f9bd94014fd3295662877ebc228cc2b/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/9e1693147f9bd94014fd3295662877ebc228cc2b/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java",
                "status": "modified",
                "changes": 49,
                "additions": 26,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ReleasePrepareAction.java?ref=9e1693147f9bd94014fd3295662877ebc228cc2b",
                "patch": "@@ -99,8 +99,8 @@ public String input()\n         scmUsername = project.getScmUsername();\n         scmPassword = project.getScmPassword();\n         scmTag = project.getScmTag();\n-        String workingDirectory = getContinuum().getWorkingDirectory(project.getId()).getPath();\n-        \n+        String workingDirectory = getContinuum().getWorkingDirectory( project.getId() ).getPath();\n+\n         String scmUrl = project.getScmUrl();\n         if ( scmUrl.startsWith( SCM_SVN_PROTOCOL_PREFIX ) )\n         {\n@@ -139,28 +139,31 @@ private void getReleasePluginParameters( String workingDirectory, String pomFile\n                 {\n                     Xpp3Dom dom = (Xpp3Dom) plugin.getConfiguration();\n \n-                    Xpp3Dom configuration = dom.getChild( \"releaseLabel\" );\n-                    if ( configuration != null )\n-                    {\n-                        scmTag = configuration.getValue();\n-                    }\n-\n-                    configuration = dom.getChild( \"tag\" );\n-                    if ( configuration != null )\n-                    {\n-                        scmTag = configuration.getValue();\n-                    }\n-\n-                    configuration = dom.getChild( \"tagBase\" );\n-                    if ( configuration != null )\n-                    {\n-                        scmTagBase = configuration.getValue();\n-                    }\n-\n-                    configuration = dom.getChild( \"preparationGoals\" );\n-                    if ( configuration != null )\n+                    if ( dom != null )\n                     {\n-                        prepareGoals = configuration.getValue();\n+                        Xpp3Dom configuration = dom.getChild( \"releaseLabel\" );\n+                        if ( configuration != null )\n+                        {\n+                            scmTag = configuration.getValue();\n+                        }\n+\n+                        configuration = dom.getChild( \"tag\" );\n+                        if ( configuration != null )\n+                        {\n+                            scmTag = configuration.getValue();\n+                        }\n+\n+                        configuration = dom.getChild( \"tagBase\" );\n+                        if ( configuration != null )\n+                        {\n+                            scmTagBase = configuration.getValue();\n+                        }\n+\n+                        configuration = dom.getChild( \"preparationGoals\" );\n+                        if ( configuration != null )\n+                        {\n+                            prepareGoals = configuration.getValue();\n+                        }\n                     }\n                 }\n             }",
                "deletions": 23
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1508] fix NPE with add button in editProfile when installations list is empty\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@581997 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975",
        "parent": "https://github.com/apache/continuum/commit/8377c9795354179ab622f958b3ca3256b1f6d67f",
        "bug_id": "continuum_55",
        "file": [
            {
                "sha": "783845c276d8ca22af0490ac4c99a0f12ac2c6cf",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ProfileAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ProfileAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ProfileAction.java",
                "status": "modified",
                "changes": 9,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/admin/ProfileAction.java?ref=8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975",
                "patch": "@@ -151,9 +151,12 @@ public String addInstallation()\n         throws Exception\n     {\n         Installation installation = installationService.getInstallation( this.getInstallationId() );\n-        profileService.addInstallationInProfile( profile, installation );\n-        // read again\n-        this.profile = profileService.getProfile( profile.getId() );\n+        if ( installation != null )\n+        {\n+            profileService.addInstallationInProfile( profile, installation );\n+            // read again\n+            this.profile = profileService.getProfile( profile.getId() );\n+        }\n         return SUCCESS;\n     }\n ",
                "deletions": 3
            },
            {
                "sha": "d2b46501b000b37525eb5fe6823c0d705eb6f407",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "status": "modified",
                "changes": 21,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp?ref=8ca6d242b8cfe2cc50f3d49b4f1566efd0f5b975",
                "patch": "@@ -101,14 +101,19 @@\n                     </tr>\n                   </tbody>\n                 </table>\n-                <ww:form action=\"addInstallationProfile!addInstallation.action\" method=\"get\">\n-                  <ww:hidden name=\"profile.id\" />\n-                  <div class=\"functnbar3\">\n-                    <!-- can't use default profile to display this select -->\n-                    <ww:select theme=\"profile\" name=\"installationId\" list=\"allInstallations\" listKey=\"installationId\" listValue=\"name\" />\n-                    <ww:submit value=\"%{getText('add')}\"/>\n-                  </div>\n-                </ww:form>\n+                <ww:if test=\"${!empty allInstallations}\">\n+                  <ww:form action=\"addInstallationProfile!addInstallation.action\" method=\"get\">\n+                    <ww:hidden name=\"profile.id\" />\n+                    <div class=\"functnbar3\">\n+                      <!-- can't use default profile to display this select -->\n+                      <ww:select theme=\"profile\" name=\"installationId\" list=\"allInstallations\" listKey=\"installationId\" listValue=\"name\" />\n+                      <ww:submit value=\"%{getText('add')}\"/>\n+                    </div>\n+                  </ww:form>\n+                </ww:if>\n+                <ww:else>\n+                  <div class=\"warningmessage\" style=\"color: red\"><ww:text name=\"profile.no.installations\" /></div>\n+                </ww:else>\n               </div>              \n             </td>\n           </tr>",
                "deletions": 8
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE if the group doesn't contains a default builddef\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@564617 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/b3595ed302f4c29b933fa006d20d226543da4ea4",
        "parent": "https://github.com/apache/continuum/commit/24db48feafaf0e71ac645eb3f94cf5582e9e17a4",
        "bug_id": "continuum_56",
        "file": [
            {
                "sha": "4094677508f4854ee4a6dc02cf04e1f3ac05edab",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/b3595ed302f4c29b933fa006d20d226543da4ea4/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/b3595ed302f4c29b933fa006d20d226543da4ea4/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 7,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=b3595ed302f4c29b933fa006d20d226543da4ea4",
                "patch": "@@ -720,7 +720,12 @@ public void buildProjectGroup( int projectGroupId )\n                 \" doens't have a default build definition, this should be impossible, it should always have a default definition set.\" );\n         }\n \n-        buildProjectGroupWithBuildDefinition( projectGroupId, groupDefaultBD.getId(), true );\n+        int buildDefinitionId = -1;\n+        if ( groupDefaultBD != null )\n+        {\n+            buildDefinitionId = groupDefaultBD.getId();\n+        }\n+        buildProjectGroupWithBuildDefinition( projectGroupId, buildDefinitionId, true );\n     }\n \n     /**",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1374] Fix NPE when JAVA_HOME isn't defined\nSubmitted by: Olivier Lamy\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@563824 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/31e6a7e41824139001a0ab43ccb067220a8cd6a4",
        "parent": "https://github.com/apache/continuum/commit/9706f7cb7808db4359df1143e411efbc8bd336a9",
        "bug_id": "continuum_57",
        "file": [
            {
                "sha": "5d7dbb95b32e7d882e8d931416f4175e1f6c9e12",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/installation/DefaultInstallationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/31e6a7e41824139001a0ab43ccb067220a8cd6a4/continuum-core/src/main/java/org/apache/maven/continuum/installation/DefaultInstallationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/31e6a7e41824139001a0ab43ccb067220a8cd6a4/continuum-core/src/main/java/org/apache/maven/continuum/installation/DefaultInstallationService.java",
                "status": "modified",
                "changes": 25,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/installation/DefaultInstallationService.java?ref=31e6a7e41824139001a0ab43ccb067220a8cd6a4",
                "patch": "@@ -59,10 +59,10 @@\n      * @plexus.requirement role-hint=\"jdo\"\n      */\n     private ContinuumStore store;\n-    \n+\n     /**\n      * @plexus.requirement role-hint=\"default\"\n-     */    \n+     */\n     private ProfileService profileService;\n \n     private Map<String, ExecutorConfigurator> typesValues;\n@@ -254,7 +254,13 @@ public String getEnvVar( String type )\n             Properties systemEnvVars = CommandLineUtils.getSystemEnvVars( false );\n \n             String javaHome = (String) systemEnvVars.get( \"JAVA_HOME\" );\n+            // olamy : JAVA_HOME can not exists with a mac user\n+            if ( StringUtils.isEmpty( javaHome ) )\n+            {\n+                return getJavaHomeInformations( System.getProperty( \"java.home\" ) );\n+            }\n             return getJavaHomeInformations( javaHome );\n+\n         }\n         catch ( IOException e )\n         {\n@@ -274,6 +280,10 @@ public String getEnvVar( String type )\n     public List<String> getJdkInformations( Installation installation )\n         throws InstallationException\n     {\n+        if ( installation == null )\n+        {\n+            return getDefaultJdkInformations();\n+        }\n         if ( StringUtils.isEmpty( installation.getVarValue() ) )\n         {\n             return getDefaultJdkInformations();\n@@ -299,16 +309,7 @@ public String getEnvVar( String type )\n         Commandline commandline = new Commandline();\n \n         String executable = javaHome + File.separator + \"bin\" + File.separator + \"java\";\n-        /*\n-        if ( Os.isFamily( Os.FAMILY_DOS ) )\n-        {\n-            executable = \"%JAVA_HOME%\\\\bin\\\\java\";\n-        }\n-        else\n-        {\n-            executable = \"$JAVA_HOME/bin/java\";\n-        }\n-        */\n+\n         commandline.setExecutable( executable );\n         commandline.addArguments( new String[]{\"-version\"} );\n         final List<String> cliOutput = new ArrayList<String>();",
                "deletions": 12
            },
            {
                "sha": "473f0177eff5d1923f168ac4bd6597ccdd47544a",
                "filename": "continuum-core/src/test/java/org/apache/maven/continuum/installation/DefaultInstallationServiceTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/31e6a7e41824139001a0ab43ccb067220a8cd6a4/continuum-core/src/test/java/org/apache/maven/continuum/installation/DefaultInstallationServiceTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/31e6a7e41824139001a0ab43ccb067220a8cd6a4/continuum-core/src/test/java/org/apache/maven/continuum/installation/DefaultInstallationServiceTest.java",
                "status": "modified",
                "changes": 19,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/test/java/org/apache/maven/continuum/installation/DefaultInstallationServiceTest.java?ref=31e6a7e41824139001a0ab43ccb067220a8cd6a4",
                "patch": "@@ -1,13 +1,14 @@\n package org.apache.maven.continuum.installation;\n \n-import java.util.List;\n-\n import org.apache.maven.continuum.AbstractContinuumTest;\n import org.apache.maven.continuum.execution.ExecutorConfigurator;\n import org.apache.maven.continuum.model.system.Installation;\n import org.apache.maven.continuum.model.system.Profile;\n import org.apache.maven.continuum.profile.ProfileService;\n import org.apache.maven.continuum.store.ContinuumStore;\n+import org.codehaus.plexus.util.StringUtils;\n+\n+import java.util.List;\n \n /*\n  * Licensed to the Apache Software Foundation (ASF) under one\n@@ -149,7 +150,11 @@ public void testgetJdkInformations()\n         throws Exception\n     {\n         InstallationService installationService = (InstallationService) lookup( InstallationService.ROLE, \"default\" );\n-        String javaHome = System.getProperty( \"JAVA_HOME\" );\n+        String javaHome = System.getenv( \"JAVA_HOME\" );\n+        if ( StringUtils.isEmpty( javaHome ) )\n+        {\n+            javaHome = System.getProperty( \"java.home\" );\n+        }\n         Installation installation = new Installation();\n         installation.setName( \"test\" );\n         installation.setType( InstallationService.JDK_TYPE );\n@@ -164,7 +169,11 @@ public void testgetJdkInformationsWithCommonMethod()\n     {\n         InstallationService installationService = (InstallationService) lookup( InstallationService.ROLE, \"default\" );\n         ExecutorConfigurator java = installationService.getExecutorConfigurator( InstallationService.JDK_TYPE );\n-        String javaHome = System.getProperty( \"JAVA_HOME\" );\n+        String javaHome = System.getenv( \"JAVA_HOME\" );\n+        if ( StringUtils.isEmpty( javaHome ) )\n+        {\n+            javaHome = System.getProperty( \"java.home\" );\n+        }\n         List<String> infos = installationService.getExecutorConfiguratorVersion( javaHome, java );\n         System.out.println( infos );\n         assertNotNull( infos );\n@@ -179,7 +188,7 @@ public void testgetMvnVersionWithCommonMethod()\n         List<String> infos = installationService.getExecutorConfiguratorVersion( javaHome, java );\n         assertNotNull( infos );\n     }\n-    \n+\n     public void testAddInstallationAutomaticProfile()\n         throws Exception\n     {",
                "deletions": 5
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1372] Fix possible NPE when adding a new project group\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@563524 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/c33a1db04c3840d720416d8198bcf549f4c6dd2b",
        "parent": "https://github.com/apache/continuum/commit/f99f98100db1b263c9052e497340340514372761",
        "bug_id": "continuum_58",
        "file": [
            {
                "sha": "358e9575aecb5d164faa553e752da96067da4710",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/c33a1db04c3840d720416d8198bcf549f4c6dd2b/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/c33a1db04c3840d720416d8198bcf549f4c6dd2b/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectGroupAction.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/AddProjectGroupAction.java?ref=c33a1db04c3840d720416d8198bcf549f4c6dd2b",
                "patch": "@@ -65,7 +65,7 @@ else if ( name != null && !name.equals( \"\" ) )\n             while ( iterator.hasNext() )\n             {\n                 ProjectGroup projectGroup = (ProjectGroup) iterator.next();\n-                if ( projectGroup.getName().equals( name ) )\n+                if ( name.equals( projectGroup.getName() ) )\n                 {\n                     addActionError( \"projectGroup.error.name.already.exists\" );\n                     break;",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1337] Fix NPE during profile creation\nSubmitted by: Olivier Lamy\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@554654 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/deebb8377f582ea485df49e92b7b6dcdd138ba33",
        "parent": "https://github.com/apache/continuum/commit/23ff451b6c706d041eff2f9ceda1c386c3fef05e",
        "bug_id": "continuum_59",
        "file": [
            {
                "sha": "d283b5f3651f13aa76ba1592755791acec2f6e9f",
                "filename": "continuum-webapp/src/main/resources/localization/Continuum.properties",
                "blob_url": "https://github.com/apache/continuum/blob/deebb8377f582ea485df49e92b7b6dcdd138ba33/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "raw_url": "https://github.com/apache/continuum/raw/deebb8377f582ea485df49e92b7b6dcdd138ba33/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/localization/Continuum.properties?ref=deebb8377f582ea485df49e92b7b6dcdd138ba33",
                "patch": "@@ -594,7 +594,7 @@ profile.jdk.name.label = Jdk name\n profile.jdk.name.message = The JDK name\n profile.jdk.path.label = Jdk path\n profile.jdk.path.message = The JDK Path (JAVA_HOME value)\n-\n+profile.no.installations = No installations available\n # ----------------------------------------------------------------------\n # Page: Installations List\n # ----------------------------------------------------------------------",
                "deletions": 1
            },
            {
                "sha": "86897c98c30c1bf9b4b2cce28e4b702da75d86b1",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/deebb8377f582ea485df49e92b7b6dcdd138ba33/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/deebb8377f582ea485df49e92b7b6dcdd138ba33/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp",
                "status": "modified",
                "changes": 11,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/jsp/admin/editProfile.jsp?ref=deebb8377f582ea485df49e92b7b6dcdd138ba33",
                "patch": "@@ -65,7 +65,7 @@\n           </ww:form>\n           </td>\n         </tr>\n-        <ww:if test=\"profile.id != ''\">\n+        <ww:if test=\"profile.id != '' && ${not empty allInstallations} \">\n           <tr>\n             <td>\n               <ww:form action=\"addInstallationProfile!addInstallation.action\" method=\"get\">\n@@ -114,6 +114,15 @@\n             </td>\n           </tr>\n         </ww:if>\n+        <ww:else>\n+          <tr>\n+            <td>\n+              <ww:if test=\"${empty allInstallations}\">\n+                <div class=\"warningmessage\" style=\"color: red\"><ww:text name=\"profile.no.installations\" /></div>\n+              </ww:if>\n+            </td>\n+          </tr> \n+        </ww:else>\n       </table>\n     </div>\n   </body>",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1203] Fix NPE when the config file doesn't exist in user directory\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@516053 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
        "parent": "https://github.com/apache/continuum/commit/4b2d003e81386cb58b5c0afad9157f657cac7a57",
        "bug_id": "continuum_60",
        "file": [
            {
                "sha": "505214bebaace7cf300d4abc20cfb8f90477b156",
                "filename": "continuum-plexus-runtime/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-plexus-runtime/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-plexus-runtime/pom.xml",
                "status": "modified",
                "changes": 19,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-plexus-runtime/pom.xml?ref=48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
                "patch": "@@ -143,6 +143,25 @@\n           <finalName>continuum</finalName>\n         </configuration>\n       </plugin>\n+      <plugin>\n+        <artifactId>maven-antrun-plugin</artifactId>\n+        <executions>\n+          <execution>\n+            <id>config</id>\n+            <phase>process-resources</phase>\n+            <configuration>\n+              <tasks>\n+                <copy todir=\"target/plexus-continuum-runtime/conf\">\n+                  <fileset dir=\"src/main/appserver/conf\" />\n+                </copy>\n+              </tasks>\n+            </configuration>\n+            <goals>\n+              <goal>run</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n     </plugins>\n   </build>\n </project>",
                "deletions": 0
            },
            {
                "sha": "9afb8335238f2902e88ae09564e4d7feb4ed53ed",
                "filename": "continuum-plexus-runtime/src/main/appserver/conf/shared.xml",
                "blob_url": "https://github.com/apache/continuum/blob/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-plexus-runtime/src/main/appserver/conf/shared.xml",
                "raw_url": "https://github.com/apache/continuum/raw/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-plexus-runtime/src/main/appserver/conf/shared.xml",
                "status": "added",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-plexus-runtime/src/main/appserver/conf/shared.xml?ref=48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
                "patch": "@@ -0,0 +1 @@\n+<configuration />",
                "deletions": 0
            },
            {
                "sha": "2729d88c10eadbd622b9e5925df98c411a95e506",
                "filename": "continuum-webapp/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/pom.xml",
                "status": "modified",
                "changes": 20,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/pom.xml?ref=48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
                "patch": "@@ -227,6 +227,24 @@\n           </excludes>\n         </configuration>\n       </plugin>\n+      <plugin>\n+        <artifactId>maven-antrun-plugin</artifactId>\n+        <executions>\n+          <execution>\n+            <phase>generate-resources</phase>\n+            <goals>\n+              <goal>run</goal>\n+            </goals>\n+            <configuration>\n+              <tasks>\n+                <copy todir=\"${project.build.directory}/appserver-base\">\n+                  <fileset dir=\"src/appserver-base\" />\n+                </copy>\n+              </tasks>\n+            </configuration>\n+          </execution>\n+        </executions>\n+      </plugin>\n     </plugins>\n   </build>\n   <dependencies>\n@@ -237,7 +255,7 @@\n     <dependency>\n       <groupId>org.codehaus.plexus.registry</groupId>\n       <artifactId>plexus-registry-commons</artifactId>\n-      <version>1.0-alpha-1</version>\n+      <version>1.0-alpha-2-SNAPSHOT</version>\n     </dependency>\n     <dependency>\n       <groupId>org.apache.maven.shared</groupId>",
                "deletions": 1
            },
            {
                "sha": "9afb8335238f2902e88ae09564e4d7feb4ed53ed",
                "filename": "continuum-webapp/src/appserver-base/conf/shared.xml",
                "blob_url": "https://github.com/apache/continuum/blob/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/src/appserver-base/conf/shared.xml",
                "raw_url": "https://github.com/apache/continuum/raw/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/src/appserver-base/conf/shared.xml",
                "status": "added",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/appserver-base/conf/shared.xml?ref=48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
                "patch": "@@ -0,0 +1 @@\n+<configuration />",
                "deletions": 0
            },
            {
                "sha": "cccb378f8b369b6773302f411b6e512aa980fcc8",
                "filename": "continuum-webapp/src/main/resources/META-INF/plexus/application.xml",
                "blob_url": "https://github.com/apache/continuum/blob/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/src/main/resources/META-INF/plexus/application.xml",
                "raw_url": "https://github.com/apache/continuum/raw/48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7/continuum-webapp/src/main/resources/META-INF/plexus/application.xml",
                "status": "modified",
                "changes": 6,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/META-INF/plexus/application.xml?ref=48e7d11bed7cc88d2b9827c7f8b4f41238f9b7b7",
                "patch": "@@ -59,19 +59,23 @@\n           <xml fileName=\"${user.home}/.m2/continuum.xml\" config-optional=\"true\" config-name=\"org.apache.maven.continuum\"\n                config-at=\"org.apache.maven.continuum\" config-forceCreate=\"true\"/>\n           <xml fileName=\"${user.home}/.m2/shared.xml\" config-optional=\"true\"\n-               config-name=\"org.apache.maven.shared.app\" config-at=\"org.apache.maven.shared.app\"\n+               config-name=\"org.apache.maven.shared.app.user\" config-at=\"org.apache.maven.shared.app\"\n                config-forceCreate=\"true\"/>\n           <properties fileName=\"${user.home}/.m2/security.properties\" config-optional=\"true\"\n                       config-at=\"org.codehaus.plexus.security\"/>\n           <properties fileName=\"${user.home}/.m2/continuum.properties\" config-optional=\"true\"\n                       config-at=\"org.codehaus.plexus.security\"/>\n           <xml fileName=\"${appserver.base}/conf/continuum.xml\" config-optional=\"true\"\n                config-at=\"org.apache.maven.continuum\"/>\n+          <xml fileName=\"${appserver.base}/conf/shared.xml\" config-optional=\"true\"\n+               config-name=\"org.apache.maven.shared.app.base\" config-at=\"org.apache.maven.shared.app\"/>\n           <xml fileName=\"${appserver.base}/conf/common.xml\" config-optional=\"true\"/>\n           <properties fileName=\"${appserver.base}/conf/security.properties\" config-optional=\"true\"\n                       config-at=\"org.codehaus.plexus.security\"/>\n           <xml fileName=\"${appserver.home}/conf/continuum.xml\" config-optional=\"true\"\n                config-at=\"org.apache.maven.continuum\"/>\n+          <xml fileName=\"${appserver.home}/conf/shared.xml\" config-optional=\"true\"\n+               config-at=\"org.apache.maven.shared.app\"/>\n           <xml fileName=\"${appserver.home}/conf/common.xml\" config-optional=\"true\"/>\n           <properties fileName=\"${appserver.home}/conf/security.properties\" config-optional=\"true\"\n                       config-at=\"org.codehaus.plexus.security\"/>",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "o Fix NPE when user try to release an empty group\no Print release error messages instead of exception\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@510046 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3",
        "parent": "https://github.com/apache/continuum/commit/ff5ebdbe246bd8da5aeb772885532d03fdf38c78",
        "bug_id": "continuum_61",
        "file": [
            {
                "sha": "be3cb7efa926e99b3dd22204222c9ed10896bf9e",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "status": "modified",
                "changes": 14,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java?ref=120e5fc0504188e4aba6c83e0ed1981bbfcc47f3",
                "patch": "@@ -398,13 +398,19 @@ public String release()\n                             {\n                                 //currently, we have no provisions for releasing 2 or more parents\n                                 //at the same time, this will be implemented in the future\n-                                throw new ContinuumException(\n-                                    \"Cannot release two or more parent projects in the same project group at the same time.\" );\n+                                addActionError( \"projectGroup.release.error.severalParentProjects\" );\n+                                return INPUT;\n                             }\n                         }\n                     }\n                 }\n \n+                if ( parent == null )\n+                {\n+                    addActionError( \"projectGroup.release.error.emptyGroup\" );\n+                    return INPUT;\n+                }\n+\n                 releaseProjectId = parent.getId();\n \n                 if ( allBuildsOk )\n@@ -413,8 +419,8 @@ public String release()\n                 }\n                 else\n                 {\n-                    throw new ContinuumException(\n-                        \"Cannot release project group: one or more projects in the group were not built successfully.\" );\n+                    addActionError( \"projectGroup.release.error.projectNotInSuccess\" );\n+                    return INPUT;\n                 }\n             }\n         }",
                "deletions": 4
            },
            {
                "sha": "c41017898042ef68859556f9d202fb60db6d7d66",
                "filename": "continuum-webapp/src/main/resources/localization/Continuum.properties",
                "blob_url": "https://github.com/apache/continuum/blob/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "raw_url": "https://github.com/apache/continuum/raw/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/localization/Continuum.properties?ref=120e5fc0504188e4aba6c83e0ed1981bbfcc47f3",
                "patch": "@@ -138,6 +138,9 @@ projectGroup.tab.summary = Project Group Summary\n projectGroup.tab.members = Members\n projectGroup.tab.buildDefinitions = Build Definitions\n projectGroup.tab.notifiers = Notifiers\n+projectGroup.release.error.emptyGroup = Cannot release an empty group.\n+projectGroup.release.error.severalParentProjects = Cannot release two or more parent projects in the same project group at the same time.\n+projectGroup.release.error.projectNotInSuccess = Cannot release project group: one or more projects in the group were not built successfully.\n \n # ----------------------------------------------------------------------\n # Page: Add Project Group",
                "deletions": 0
            },
            {
                "sha": "749d6ab3320c7dbecf60e29862aef099e13befac",
                "filename": "continuum-webapp/src/main/resources/xwork.xml",
                "blob_url": "https://github.com/apache/continuum/blob/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/resources/xwork.xml",
                "raw_url": "https://github.com/apache/continuum/raw/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/resources/xwork.xml",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/xwork.xml?ref=120e5fc0504188e4aba6c83e0ed1981bbfcc47f3",
                "patch": "@@ -278,6 +278,7 @@\n     </action>\n     \n     <action name=\"releaseProjectGroup\" class=\"projectGroup\" method=\"release\">\n+      <result name=\"input\">/WEB-INF/jsp/projectGroupSummary.jsp</result>\n       <result name=\"success\" type=\"redirect-action\">\n         <param name=\"actionName\">releasePromptGoal</param>\n         <param name=\"projectId\">${releaseProjectId}</param>",
                "deletions": 0
            },
            {
                "sha": "df34c2b72ac0c67958a456aa827df5c2b07d8f2a",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/jsp/projectGroupSummary.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/webapp/WEB-INF/jsp/projectGroupSummary.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/120e5fc0504188e4aba6c83e0ed1981bbfcc47f3/continuum-webapp/src/main/webapp/WEB-INF/jsp/projectGroupSummary.jsp",
                "status": "modified",
                "changes": 8,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/jsp/projectGroupSummary.jsp?ref=120e5fc0504188e4aba6c83e0ed1981bbfcc47f3",
                "patch": "@@ -81,6 +81,14 @@\n     <pss:ifAnyAuthorized permissions=\"continuum-build-group,continuum-remove-group\" resource=\"${projectGroup.name}\">\n       <h3>Project Group Actions</h3>\n \n+      <c:if test=\"${!empty actionErrors}\">\n+        <div class=\"errormessage\">\n+          <c:forEach items=\"${actionErrors}\" var=\"actionError\">\n+            <p><ww:text name=\"${actionError}\"/></p>\n+          </c:forEach>\n+        </div>\n+      </c:if>\n+\n       <div class=\"functnbar3\">\n         <table>\n           <tr>",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1011] Fix NPE in DefaultMavenBuilderHelper and remove some deprecated methods\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@478588 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/e0c60d29f58a20aa704e7573d1ce522a691d95db",
        "parent": "https://github.com/apache/continuum/commit/8a9179bc973c7f179a7629e1732b11afe0381ce1",
        "bug_id": "continuum_62",
        "file": [
            {
                "sha": "65e96e34dede3204aa6c89090a72759ab8a5a503",
                "filename": "continuum-api/src/main/java/org/apache/maven/continuum/project/builder/ContinuumProjectBuildingResult.java",
                "blob_url": "https://github.com/apache/continuum/blob/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-api/src/main/java/org/apache/maven/continuum/project/builder/ContinuumProjectBuildingResult.java",
                "raw_url": "https://github.com/apache/continuum/raw/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-api/src/main/java/org/apache/maven/continuum/project/builder/ContinuumProjectBuildingResult.java",
                "status": "modified",
                "changes": 42,
                "additions": 33,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-api/src/main/java/org/apache/maven/continuum/project/builder/ContinuumProjectBuildingResult.java?ref=e0c60d29f58a20aa704e7573d1ce522a691d95db",
                "patch": "@@ -20,12 +20,13 @@\n import org.apache.maven.continuum.model.project.ProjectGroup;\n \n import java.util.ArrayList;\n+import java.util.Iterator;\n import java.util.List;\n \n /**\n  * Holder for results of adding projects to Continuum. Contains added projects, project groups\n  * and errors that happened during the add.\n- * \n+ *\n  * @author <a href=\"mailto:trygvis@inamo.no\">Trygve Laugst&oslash;l</a>\n  * @author <a href=\"mailto:carlos@apache.org\">Carlos Sanchez</a>\n  * @version $Id$\n@@ -60,7 +61,8 @@\n \n     public static final String ERROR_MISSING_NOTIFIER_TYPE = \"add.project.missing.notifier.type.error\";\n \n-    public static final String ERROR_MISSING_NOTIFIER_CONFIGURATION = \"add.project.missing.notifier.configuration.error\";\n+    public static final String ERROR_MISSING_NOTIFIER_CONFIGURATION =\n+        \"add.project.missing.notifier.configuration.error\";\n \n     public static final String ERROR_METADATA_TRANSFER = \"add.project.metadata.transfer.error\";\n \n@@ -109,7 +111,7 @@ public List getProjectGroups()\n \n     /**\n      * Add a warning that happened during adding the project to Continuum.\n-     * \n+     *\n      * @param warningKey warning id (so it can be internationalized later)\n      * @deprecated Use {@link #addError(String)} instead\n      */\n@@ -120,7 +122,7 @@ public void addWarning( String warningKey )\n \n     /**\n      * Add an error that happened during adding the project to Continuum.\n-     * \n+     *\n      * @param errorKey error id (so it can be internationalized later)\n      */\n     public void addError( String errorKey )\n@@ -130,7 +132,7 @@ public void addError( String errorKey )\n \n     /**\n      * Add an error that happened during adding the project to Continuum.\n-     * \n+     *\n      * @param errorKey error id (so it can be internationalized later)\n      */\n     public void addError( String errorKey, Object param )\n@@ -141,7 +143,7 @@ public void addError( String errorKey, Object param )\n \n     /**\n      * Add an error that happened during adding the project to Continuum.\n-     * \n+     *\n      * @param errorKey error id (so it can be internationalized later)\n      */\n     public void addError( String errorKey, Object params[] )\n@@ -153,7 +155,7 @@ public void addError( String errorKey, Object params[] )\n     /**\n      * Get the warnings that happened during adding the project to Continuum.\n      * There is an entry with the warning key (so it can be internationalized later) for each warning.\n-     * \n+     *\n      * @return {@link List} &lt; {@link String} >\n      * @deprecated Use {@link #getErrors()} instead\n      */\n@@ -165,7 +167,7 @@ public List getWarnings()\n     /**\n      * Get the errors that happened during adding the project to Continuum.\n      * There is an entry with the error key (so it can be internationalized later) for each error.\n-     * \n+     *\n      * @return {@link List} &lt; {@link String} >\n      */\n     public List getErrors()\n@@ -175,11 +177,33 @@ public List getErrors()\n \n     /**\n      * Quick check to see if there are any errors.\n-     * \n+     *\n      * @return boolean indicating if there are any errors.\n      */\n     public boolean hasErrors()\n     {\n         return ( errors != null ) && ( !errors.isEmpty() );\n     }\n+\n+    /**\n+     * Returns a string representation of the errors.\n+     *\n+     * @return a string representation of the errors.\n+     */\n+    public String getErrorsAsString()\n+    {\n+        if ( !hasErrors() )\n+        {\n+            return null;\n+        }\n+\n+        StringBuffer message = new StringBuffer();\n+        for ( Iterator i = errors.iterator(); i.hasNext(); )\n+        {\n+            String error = (String) i.next();\n+            message.append( error );\n+            message.append( \"\\n\" );\n+        }\n+        return message.toString();\n+    }\n }",
                "deletions": 9
            },
            {
                "sha": "1afa6255d79a6212c14c5f50c881427e00a36804",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/DefaultMavenBuilderHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/DefaultMavenBuilderHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/DefaultMavenBuilderHelper.java",
                "status": "modified",
                "changes": 81,
                "additions": 37,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/DefaultMavenBuilderHelper.java?ref=e0c60d29f58a20aa704e7573d1ce522a691d95db",
                "patch": "@@ -72,10 +72,8 @@\n  * @author <a href=\"mailto:trygvis@inamo.no\">Trygve Laugst&oslash;l</a>\n  * @author <a href=\"mailto:evenisse@apache.org\">Emmanuel Venisse</a>\n  * @version $Id$\n- *\n- * @plexus.component\n- *   role=\"org.apache.maven.continuum.execution.maven.m2.MavenBuilderHelper\"\n- *   role-hint=\"default\"\n+ * @plexus.component role=\"org.apache.maven.continuum.execution.maven.m2.MavenBuilderHelper\"\n+ * role-hint=\"default\"\n  */\n public class DefaultMavenBuilderHelper\n     extends AbstractLogEnabled\n@@ -118,29 +116,29 @@\n     // ----------------------------------------------------------------------\n     // MavenBuilderHelper Implementation\n     // ----------------------------------------------------------------------\n-    /**\n-     * @deprecated use {@link #mapMavenProjectToContinuumProject(ContinuumProjectBuildingResult, MavenProject, Project, boolean)} instead.\n-     */\n-    public void mapMetadataToProject( File metadata, Project continuumProject )\n-        throws MavenBuilderHelperException\n-    {\n-        // todo this is deprecated so it shouldn't be used anyway so just set false for groupPom boolean and clean up later\n-        mapMavenProjectToContinuumProject( getMavenProject( metadata ), continuumProject, false );\n-    }\n \n-    /**\n-     * @deprecated use {@link #mapMavenProjectToContinuumProject(ContinuumProjectBuildingResult, MavenProject, Project, boolean)} instead.\n-     */\n-    public void mapMavenProjectToContinuumProject( MavenProject mavenProject, Project continuumProject, boolean groupPom )\n-        throws MavenBuilderHelperException\n+    public void mapMetadataToProject( ContinuumProjectBuildingResult result, File metadata, Project continuumProject )\n     {\n-        mapMavenProjectToContinuumProject( new ContinuumProjectBuildingResult(), mavenProject, continuumProject, groupPom );\n+        MavenProject mavenProject = getMavenProject( result, metadata );\n+\n+        if ( mavenProject == null )\n+        {\n+            //result is already populated\n+            return;\n+        }\n+\n+        mapMavenProjectToContinuumProject( result, mavenProject, continuumProject, false );\n     }\n-    \n-    public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult result, MavenProject mavenProject, Project continuumProject, boolean groupPom )\n-        throws MavenBuilderHelperException\n+\n+    public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult result, MavenProject mavenProject,\n+                                                   Project continuumProject, boolean groupPom )\n     {\n-    \n+        if ( mavenProject == null )\n+        {\n+            result.addError( ContinuumProjectBuildingResult.ERROR_UNKNOWN, \"The maven project is null\" );\n+            return;\n+        }\n+\n         // ----------------------------------------------------------------------\n         // Name\n         // ----------------------------------------------------------------------\n@@ -332,20 +330,11 @@ public void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult re\n             }\n         }\n     }\n-    \n-    /**\n-     * @deprecated use {@link #getMavenProject(ContinuumProjectBuildingResult, File)} instead.\n-     */\n-    public MavenProject getMavenProject( File file )\n-    throws MavenBuilderHelperException\n-    {\n-        return getMavenProject( new ContinuumProjectBuildingResult(), file );\n-    }\n \n     public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File file )\n     {\n         MavenProject project;\n-        \n+\n         try\n         {\n             //   TODO: This seems like code that is shared with DefaultMaven, so it should be moved to the project\n@@ -372,8 +361,8 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n             StringBuffer messages = new StringBuffer();\n \n             Throwable cause = e.getCause();\n-            \n-            if( cause != null )\n+\n+            if ( cause != null )\n             {\n                 while ( ( cause.getCause() != null ) && ( cause instanceof ProjectBuildingException ) )\n                 {\n@@ -409,7 +398,7 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n             result.addError( ContinuumProjectBuildingResult.ERROR_PROJECT_BUILDING, e.getMessage() );\n \n             String msg = \"Cannot build maven project from \" + file + \" (\" + e.getMessage() + \").\\n\" + messages;\n-            \n+\n             file.delete();\n \n             getLogger().error( msg );\n@@ -419,12 +408,14 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n         // TODO catch all exceptions is bad\n         catch ( Exception e )\n         {\n+            result.addError( ContinuumProjectBuildingResult.ERROR_PROJECT_BUILDING, e.getMessage() );\n+\n             String msg = \"Cannot build maven project from \" + file + \" (\" + e.getMessage() + \").\";\n \n             file.delete();\n-            \n+\n             getLogger().error( msg );\n-            \n+\n             return null;\n         }\n \n@@ -438,9 +429,9 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n         if ( scm == null )\n         {\n             result.addError( ContinuumProjectBuildingResult.ERROR_MISSING_SCM, getProjectName( project ) );\n-            \n+\n             getLogger().error( \"Missing 'scm' element in the \" + getProjectName( project ) + \" POM.\" );\n-            \n+\n             return null;\n         }\n \n@@ -449,9 +440,10 @@ public MavenProject getMavenProject( ContinuumProjectBuildingResult result, File\n         if ( StringUtils.isEmpty( url ) )\n         {\n             result.addError( ContinuumProjectBuildingResult.ERROR_MISSING_SCM_CONNECTION, getProjectName( project ) );\n-            \n-            getLogger().error( \"Missing 'connection' element in the 'scm' element in the \" + getProjectName( project ) + \" POM.\" );\n-            \n+\n+            getLogger().error(\n+                \"Missing 'connection' element in the 'scm' element in the \" + getProjectName( project ) + \" POM.\" );\n+\n             return null;\n         }\n \n@@ -484,7 +476,8 @@ private String getScmUrl( MavenProject project )\n         return project.getScm().getConnection();\n     }\n \n-    private List getNotifiers( ContinuumProjectBuildingResult result, MavenProject mavenProject, Project continuumProject )\n+    private List getNotifiers( ContinuumProjectBuildingResult result, MavenProject mavenProject,\n+                               Project continuumProject )\n     {\n         List notifiers = new ArrayList();\n ",
                "deletions": 44
            },
            {
                "sha": "01a16c61e829397e97f122cbfeb35e8ccc897350",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenBuilderHelper.java",
                "blob_url": "https://github.com/apache/continuum/blob/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenBuilderHelper.java",
                "raw_url": "https://github.com/apache/continuum/raw/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenBuilderHelper.java",
                "status": "modified",
                "changes": 18,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenBuilderHelper.java?ref=e0c60d29f58a20aa704e7573d1ce522a691d95db",
                "patch": "@@ -31,23 +31,10 @@\n {\n     String ROLE = MavenBuilderHelper.class.getName();\n \n-    void mapMetadataToProject( File metadata, Project project )\n-        throws MavenBuilderHelperException;\n-\n-    /**\n-     * @deprecated use {@link #getMavenProject(ContinuumProjectBuildingResult, File)} instead.\n-     */\n-    MavenProject getMavenProject( File file )\n-        throws MavenBuilderHelperException;\n+    void mapMetadataToProject( ContinuumProjectBuildingResult result, File metadata, Project project );\n \n     MavenProject getMavenProject( ContinuumProjectBuildingResult result, File file );\n \n-    /**\n-     * @deprecated use {@link #mapMavenProjectToContinuumProject(ContinuumProjectBuildingResult, MavenProject, Project, boolean)} instead.\n-     */\n-    void mapMavenProjectToContinuumProject( MavenProject mavenProject, Project continuumProject, boolean groupPom )\n-        throws MavenBuilderHelperException;\n-\n     /**\n      *\n      * @param result\n@@ -56,8 +43,7 @@ void mapMavenProjectToContinuumProject( MavenProject mavenProject, Project conti\n      * @param groupPom map this project as if it is being used to initialize a project group\n      */\n     void mapMavenProjectToContinuumProject( ContinuumProjectBuildingResult result, MavenProject mavenProject,\n-                                            Project continuumProject, boolean groupPom )\n-        throws MavenBuilderHelperException;\n+                                            Project continuumProject, boolean groupPom );\n \n     ArtifactRepository getLocalRepository();\n }",
                "deletions": 16
            },
            {
                "sha": "c98f932fb849c388d621f60bc6f20f75454fa429",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java",
                "status": "modified",
                "changes": 149,
                "additions": 80,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/execution/maven/m2/MavenTwoBuildExecutor.java?ref=e0c60d29f58a20aa704e7573d1ce522a691d95db",
                "patch": "@@ -24,24 +24,25 @@\n import org.apache.maven.continuum.execution.ContinuumBuildExecutorException;\n import org.apache.maven.continuum.model.project.BuildDefinition;\n import org.apache.maven.continuum.model.project.Project;\n+import org.apache.maven.continuum.model.scm.SuiteResult;\n+import org.apache.maven.continuum.model.scm.TestCaseFailure;\n+import org.apache.maven.continuum.model.scm.TestResult;\n+import org.apache.maven.continuum.project.builder.ContinuumProjectBuildingResult;\n import org.apache.maven.project.MavenProject;\n import org.apache.maven.project.MavenProjectHelper;\n import org.apache.maven.project.artifact.ProjectArtifactMetadata;\n-import org.apache.maven.continuum.model.scm.TestResult;\n-import org.apache.maven.continuum.model.scm.SuiteResult;\n-import org.apache.maven.continuum.model.scm.TestCaseFailure;\n-import org.codehaus.plexus.util.StringUtils;\n import org.codehaus.plexus.util.DirectoryScanner;\n-import org.codehaus.plexus.util.xml.pull.XmlPullParser;\n+import org.codehaus.plexus.util.StringUtils;\n import org.codehaus.plexus.util.xml.pull.MXParser;\n+import org.codehaus.plexus.util.xml.pull.XmlPullParser;\n import org.codehaus.plexus.util.xml.pull.XmlPullParserException;\n-  \n+\n import java.io.File;\n+import java.io.FileNotFoundException;\n import java.io.FileReader;\n+import java.io.IOException;\n import java.util.ArrayList;\n import java.util.List;\n-import java.io.IOException;\n-import java.io.FileNotFoundException;\n \n /**\n  * @author <a href=\"mailto:trygvis@inamo.no\">Trygve Laugst&oslash;l</a>\n@@ -118,13 +119,13 @@ public void updateProjectFromCheckOut( File workingDirectory, Project project, B\n             throw new ContinuumBuildExecutorException( \"Could not find Maven project descriptor.\" );\n         }\n \n-        try\n-        {\n-            builderHelper.mapMetadataToProject( f, project );\n-        }\n-        catch ( MavenBuilderHelperException e )\n+        ContinuumProjectBuildingResult result = new ContinuumProjectBuildingResult();\n+\n+        builderHelper.mapMetadataToProject( result, f, project );\n+\n+        if ( result.hasErrors() )\n         {\n-            throw new ContinuumBuildExecutorException( \"Error while mapping metadata.\", e );\n+            throw new ContinuumBuildExecutorException( \"Error while mapping metadata:\" + result.getErrorsAsString() );\n         }\n     }\n \n@@ -162,14 +163,14 @@ public List getDeployableArtifacts( File workingDirectory, BuildDefinition build\n \n         MavenProject project;\n \n-        try\n-        {\n-            project = builderHelper.getMavenProject( f );\n-        }\n-        catch ( MavenBuilderHelperException e )\n+        ContinuumProjectBuildingResult result = new ContinuumProjectBuildingResult();\n+\n+        project = builderHelper.getMavenProject( result, f );\n+\n+        if ( result.hasErrors() )\n         {\n             throw new ContinuumBuildExecutorException(\n-                \"Unable to read the Maven project descriptor '\" + f + \"': \" + e.getMessage(), e );\n+                \"Unable to read the Maven project descriptor '\" + f + \"': \" + result.getErrorsAsString() );\n         }\n \n         List artifacts = new ArrayList( 1 );\n@@ -253,64 +254,71 @@ public List getDeployableArtifacts( File workingDirectory, BuildDefinition build\n         return artifacts;\n     }\n \n-    public TestResult getTestResults(Project project)\n-            throws ContinuumBuildExecutorException {\n-        return getTestResults(getWorkingDirectory(project));\n+    public TestResult getTestResults( Project project )\n+        throws ContinuumBuildExecutorException\n+    {\n+        return getTestResults( getWorkingDirectory( project ) );\n     }\n \n-    private TestResult getTestResults(File workingDir)\n-            throws ContinuumBuildExecutorException {\n+    private TestResult getTestResults( File workingDir )\n+        throws ContinuumBuildExecutorException\n+    {\n         DirectoryScanner scanner = new DirectoryScanner();\n-        scanner.setBasedir(workingDir);\n-        scanner.setIncludes(new String[] {\n-                \"**/target/surefire-reports/TEST-*.xml\",\n-                \"**/target/surefire-it-reports/TEST-*.xml\"\n-        });\n+        scanner.setBasedir( workingDir );\n+        scanner.setIncludes(\n+            new String[]{\"**/target/surefire-reports/TEST-*.xml\", \"**/target/surefire-it-reports/TEST-*.xml\"} );\n         scanner.scan();\n \n         TestResult testResult = new TestResult();\n         int testCount = 0;\n         int failureCount = 0;\n         int totalTime = 0;\n         String[] testResultFiles = scanner.getIncludedFiles();\n-        for (int i = 0; i < testResultFiles.length; i++) {\n-            File xmlFile = new File(workingDir, testResultFiles[i]);\n+        for ( int i = 0; i < testResultFiles.length; i++ )\n+        {\n+            File xmlFile = new File( workingDir, testResultFiles[i] );\n             SuiteResult suite = new SuiteResult();\n-            try {\n+            try\n+            {\n                 XmlPullParser parser = new MXParser();\n-                parser.setInput(new FileReader(xmlFile));\n-                if (parser.next() != XmlPullParser.START_TAG || !\"testsuite\".equals(parser.getName())) {\n+                parser.setInput( new FileReader( xmlFile ) );\n+                if ( parser.next() != XmlPullParser.START_TAG || !\"testsuite\".equals( parser.getName() ) )\n+                {\n                     continue;\n                 }\n \n-                suite.setName(parser.getAttributeValue(null, \"name\"));\n+                suite.setName( parser.getAttributeValue( null, \"name\" ) );\n \n-                int suiteFailureCount =\n-                        Integer.parseInt(parser.getAttributeValue(null, \"errors\")) +\n-                        Integer.parseInt(parser.getAttributeValue(null, \"failures\"));\n+                int suiteFailureCount = Integer.parseInt( parser.getAttributeValue( null, \"errors\" ) ) +\n+                    Integer.parseInt( parser.getAttributeValue( null, \"failures\" ) );\n \n-                long suiteTotalTime =\n-                        (long) (1000 * Double.parseDouble(parser.getAttributeValue(null, \"time\")));\n+                long suiteTotalTime = (long) ( 1000 * Double.parseDouble( parser.getAttributeValue( null, \"time\" ) ) );\n \n                 // TODO: add tests attribute to testsuite element so we only\n                 // have to parse the rest of the file if there are failures\n                 int suiteTestCount = 0;\n-                while (!(parser.next() == XmlPullParser.END_TAG && \"testsuite\".equals(parser.getName()))) {\n-                    if (parser.getEventType() == XmlPullParser.START_TAG && \"testcase\".equals(parser.getName())) {\n+                while ( !( parser.next() == XmlPullParser.END_TAG && \"testsuite\".equals( parser.getName() ) ) )\n+                {\n+                    if ( parser.getEventType() == XmlPullParser.START_TAG && \"testcase\".equals( parser.getName() ) )\n+                    {\n                         suiteTestCount++;\n-                        String name = parser.getAttributeValue(null, \"name\");\n-                        do {\n+                        String name = parser.getAttributeValue( null, \"name\" );\n+                        do\n+                        {\n                             parser.next();\n-                        } while (parser.getEventType() != XmlPullParser.START_TAG &&\n-                                 parser.getEventType() != XmlPullParser.END_TAG);\n-                        if (parser.getEventType() == XmlPullParser.START_TAG &&\n-                                (\"error\".equals(parser.getName()) || \"failure\".equals(parser.getName()))) {\n+                        }\n+                        while ( parser.getEventType() != XmlPullParser.START_TAG &&\n+                            parser.getEventType() != XmlPullParser.END_TAG );\n+                        if ( parser.getEventType() == XmlPullParser.START_TAG &&\n+                            ( \"error\".equals( parser.getName() ) || \"failure\".equals( parser.getName() ) ) )\n+                        {\n                             TestCaseFailure failure = new TestCaseFailure();\n-                            failure.setName(name);\n-                            if (parser.next() == XmlPullParser.TEXT) {\n-                                failure.setException(parser.getText());\n+                            failure.setName( name );\n+                            if ( parser.next() == XmlPullParser.TEXT )\n+                            {\n+                                failure.setException( parser.getText() );\n                             }\n-                            suite.addFailure(failure);\n+                            suite.addFailure( failure );\n                         }\n                     }\n                 }\n@@ -319,25 +327,28 @@ private TestResult getTestResults(File workingDir)\n                 failureCount += suiteFailureCount;\n                 totalTime += suiteTotalTime;\n \n-                suite.setTestCount(suiteTestCount);\n-                suite.setFailureCount(suiteFailureCount);\n-                suite.setTotalTime(suiteTotalTime);\n-            } catch (XmlPullParserException xppex) {\n-                throw new ContinuumBuildExecutorException(\n-                        \"Error parsing file: \" + xmlFile, xppex);\n-            } catch (FileNotFoundException fnfex) {\n-                throw new ContinuumBuildExecutorException(\n-                        \"Test file not found\", fnfex);\n-            } catch (IOException ioex) {\n-                throw new ContinuumBuildExecutorException(\n-                        \"Parsing error for file: \" + xmlFile, ioex);\n+                suite.setTestCount( suiteTestCount );\n+                suite.setFailureCount( suiteFailureCount );\n+                suite.setTotalTime( suiteTotalTime );\n+            }\n+            catch ( XmlPullParserException xppex )\n+            {\n+                throw new ContinuumBuildExecutorException( \"Error parsing file: \" + xmlFile, xppex );\n+            }\n+            catch ( FileNotFoundException fnfex )\n+            {\n+                throw new ContinuumBuildExecutorException( \"Test file not found\", fnfex );\n+            }\n+            catch ( IOException ioex )\n+            {\n+                throw new ContinuumBuildExecutorException( \"Parsing error for file: \" + xmlFile, ioex );\n             }\n-            testResult.addSuiteResult(suite);\n+            testResult.addSuiteResult( suite );\n         }\n \n-        testResult.setTestCount(testCount);\n-        testResult.setFailureCount(failureCount);\n-        testResult.setTotalTime(totalTime);\n+        testResult.setTestCount( testCount );\n+        testResult.setFailureCount( failureCount );\n+        testResult.setTotalTime( totalTime );\n \n         return testResult;\n     }",
                "deletions": 69
            },
            {
                "sha": "454bef16810f147e76d3d39c2e5f4f267c97eb0e",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilder.java",
                "blob_url": "https://github.com/apache/continuum/blob/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilder.java",
                "raw_url": "https://github.com/apache/continuum/raw/e0c60d29f58a20aa704e7573d1ce522a691d95db/continuum-core/src/main/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilder.java",
                "status": "modified",
                "changes": 33,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/project/builder/maven/MavenTwoContinuumProjectBuilder.java?ref=e0c60d29f58a20aa704e7573d1ce522a691d95db",
                "patch": "@@ -18,21 +18,20 @@\n \n import org.apache.maven.continuum.execution.maven.m2.MavenBuilderHelper;\n import org.apache.maven.continuum.execution.maven.m2.MavenTwoBuildExecutor;\n-import org.apache.maven.continuum.execution.maven.m2.MavenBuilderHelperException;\n import org.apache.maven.continuum.initialization.DefaultContinuumInitializer;\n import org.apache.maven.continuum.model.project.BuildDefinition;\n import org.apache.maven.continuum.model.project.Project;\n import org.apache.maven.continuum.model.project.ProjectGroup;\n-import org.apache.maven.continuum.model.project.Schedule;\n import org.apache.maven.continuum.model.project.ProjectNotifier;\n+import org.apache.maven.continuum.model.project.Schedule;\n import org.apache.maven.continuum.project.builder.AbstractContinuumProjectBuilder;\n import org.apache.maven.continuum.project.builder.ContinuumProjectBuilder;\n import org.apache.maven.continuum.project.builder.ContinuumProjectBuilderException;\n import org.apache.maven.continuum.project.builder.ContinuumProjectBuildingResult;\n import org.apache.maven.continuum.store.ContinuumStore;\n import org.apache.maven.continuum.store.ContinuumStoreException;\n-import org.apache.maven.project.MavenProject;\n import org.apache.maven.model.Notifier;\n+import org.apache.maven.project.MavenProject;\n import org.codehaus.plexus.util.StringUtils;\n \n import java.io.FileNotFoundException;\n@@ -47,10 +46,8 @@\n /**\n  * @author <a href=\"mailto:trygvis@inamo.no\">Trygve Laugst&oslash;l</a>\n  * @version $Id$\n- *\n- * @plexus.component\n- *   role=\"org.apache.maven.continuum.project.builder.ContinuumProjectBuilder\"\n- *   role-hint=\"maven-two-builder\"\n+ * @plexus.component role=\"org.apache.maven.continuum.project.builder.ContinuumProjectBuilder\"\n+ * role-hint=\"maven-two-builder\"\n  */\n public class MavenTwoContinuumProjectBuilder\n     extends AbstractContinuumProjectBuilder\n@@ -196,29 +193,27 @@ private void readModules( URL url, ContinuumProjectBuildingResult result, boolea\n             if ( username != null && StringUtils.isNotEmpty( username ) )\n             {\n                 continuumProject.setScmUsername( username );\n-                \n+\n                 if ( password != null && StringUtils.isNotEmpty( password ) )\n                 {\n                     continuumProject.setScmPassword( password );\n                 }\n             }\n \n-            try\n-            {\n-                builderHelper.mapMavenProjectToContinuumProject( result, mavenProject, continuumProject, groupPom );\n-            }\n-            catch ( MavenBuilderHelperException e )\n+            builderHelper.mapMavenProjectToContinuumProject( result, mavenProject, continuumProject, groupPom );\n+\n+            if ( result.hasErrors() )\n             {\n-                getLogger().info( \"Error adding project: Unknown error mapping project \" + url, e );\n-                result.addError( ContinuumProjectBuildingResult.ERROR_MISSING_SCM_CONNECTION );\n+                getLogger().info(\n+                    \"Error adding project: Unknown error mapping project \" + url + \": \" + result.getErrorsAsString() );\n                 return;\n             }\n \n             // Rewrite scmurl from the one found in added project due to a bug in scm url resolution\n             // for projects that doesn't have module name != artifactId\n-            if ( StringUtils.isNotEmpty( scmUrl))\n+            if ( StringUtils.isNotEmpty( scmUrl ) )\n             {\n-                continuumProject.setScmUrl( scmUrl);\n+                continuumProject.setScmUrl( scmUrl );\n             }\n             else\n             {\n@@ -271,7 +266,7 @@ private void readModules( URL url, ContinuumProjectBuildingResult result, boolea\n                 continue;\n             }\n \n-            readModules( moduleUrl, result, false, username, password, scmUrl+\"/\"+module );\n+            readModules( moduleUrl, result, false, username, password, scmUrl + \"/\" + module );\n         }\n     }\n \n@@ -311,7 +306,6 @@ private ProjectGroup buildProjectGroup( MavenProject mavenProject, ContinuumProj\n \n         projectGroup.setDescription( mavenProject.getDescription() );\n \n-\n         //\n         // group lvl notifiers\n         //\n@@ -357,7 +351,6 @@ private ProjectGroup buildProjectGroup( MavenProject mavenProject, ContinuumProj\n             projectGroup.setNotifiers( notifiers );\n         }\n \n-\n         return projectGroup;\n     }\n }",
                "deletions": 20
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-780] Fix NPE when the date of the changeset is null.\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@447887 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/2afae3ed75ae2f5d36189a1f70200338f843474e",
        "parent": "https://github.com/apache/continuum/commit/59de1d9f3b72b396ad0db2f0c3163942c9c25928",
        "bug_id": "continuum_63",
        "file": [
            {
                "sha": "d5935aa19c35a57f4cd76724fbf6dfdb3ba83603",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "blob_url": "https://github.com/apache/continuum/blob/2afae3ed75ae2f5d36189a1f70200338f843474e/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "raw_url": "https://github.com/apache/continuum/raw/2afae3ed75ae2f5d36189a1f70200338f843474e/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scm/DefaultContinuumScm.java?ref=2afae3ed75ae2f5d36189a1f70200338f843474e",
                "patch": "@@ -411,7 +411,10 @@ private ScmResult convertScmResult( UpdateScmResult scmResult )\n \n                 change.setComment( scmChangeSet.getComment() );\n \n-                change.setDate( scmChangeSet.getDate().getTime() );\n+                if ( scmChangeSet.getDate() != null )\n+                {\n+                    change.setDate( scmChangeSet.getDate().getTime() );\n+                }\n \n                 if ( scmChangeSet.getFiles() != null )\n                 {",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "rollback rev.431371. ContinuumException is never thrown by actionManager and the test generate a NPE due to bad DefaultContinuum initialization\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@441176 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/3a0cb10739d88b46cedb25a009bd174599ffb4fd",
        "parent": "https://github.com/apache/continuum/commit/d8745a4804cb7eec0c1a3193ab744bb3081f4ab0",
        "bug_id": "continuum_64",
        "file": [
            {
                "sha": "2aa4be7d6579fba1e5ef53cf49b11f1139cc65c7",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/3a0cb10739d88b46cedb25a009bd174599ffb4fd/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/3a0cb10739d88b46cedb25a009bd174599ffb4fd/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 18,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=3a0cb10739d88b46cedb25a009bd174599ffb4fd",
                "patch": "@@ -170,16 +170,6 @@ public void run()\n         } );\n     }\n \n-    public void setActionManager( ActionManager actionManager )\n-    {\n-        this.actionManager = actionManager;\n-    }\n-\n-    public ActionManager getActionManager()\n-    {\n-        return actionManager;\n-    }\n-\n     // ----------------------------------------------------------------------\n     // Project Groups\n     // ----------------------------------------------------------------------\n@@ -2253,23 +2243,19 @@ public Collection getBuildResultsForProject( int projectId )\n     // Workflow\n     // ----------------------------------------------------------------------\n \n-    protected void executeAction( String actionName, Map context )\n+    private void executeAction( String actionName, Map context )\n         throws ContinuumException\n     {\n         try\n         {\n-            Action action = getActionManager().lookup( actionName );\n+            Action action = actionManager.lookup( actionName );\n \n             action.execute( context );\n         }\n         catch ( ActionNotFoundException e )\n         {\n             throw new ContinuumException( \"Error while executing the action '\" + actionName + \"'.\", e );\n         }\n-        catch ( ContinuumException e )\n-        {\n-            throw e;\n-        }\n         catch ( Exception e )\n         {\n             getLogger().info( \"exception\", e );",
                "deletions": 16
            },
            {
                "sha": "1c0bb64be8724c8d1b7df5a95d0e0f4f94967936",
                "filename": "continuum-core/src/test/java/org/apache/maven/continuum/DefaultContinuumUnitTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/d8745a4804cb7eec0c1a3193ab744bb3081f4ab0/continuum-core/src/test/java/org/apache/maven/continuum/DefaultContinuumUnitTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/d8745a4804cb7eec0c1a3193ab744bb3081f4ab0/continuum-core/src/test/java/org/apache/maven/continuum/DefaultContinuumUnitTest.java",
                "status": "removed",
                "changes": 67,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/test/java/org/apache/maven/continuum/DefaultContinuumUnitTest.java?ref=d8745a4804cb7eec0c1a3193ab744bb3081f4ab0",
                "patch": "@@ -1,67 +0,0 @@\n-package org.apache.maven.continuum;\n-\n-/*\n- * Copyright 2006 The Apache Software Foundation.\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-import java.util.Collections;\n-\n-import org.codehaus.plexus.action.Action;\n-import org.codehaus.plexus.action.ActionManager;\n-import org.jmock.Mock;\n-import org.jmock.MockObjectTestCase;\n-\n-/**\n- * Test for {@link DefaultContinuum}.\n- *\n- * @author <a href=\"mailto:carlos@apache.org\">Carlos Sanchez</a>\n- * @version $Id$\n- */\n-public class DefaultContinuumUnitTest\n-    extends MockObjectTestCase\n-{\n-\n-    public void testExecuteAction()\n-        throws Exception\n-    {\n-        DefaultContinuum continuum = new DefaultContinuum();\n-\n-        Mock actionMock = new Mock( Action.class );\n-\n-        Mock actionManagerMock = new Mock( ActionManager.class );\n-\n-        actionManagerMock.expects( once() ).will( returnValue( actionMock.proxy() ) );\n-\n-        continuum.setActionManager( (ActionManager) actionManagerMock.proxy() );\n-\n-        actionMock.expects( once() ).will( throwException( new ContinuumException( \"\" ) ) );\n-\n-        String exceptionName = ContinuumException.class.getName();\n-        try\n-        {\n-            continuum.executeAction( \"\", Collections.EMPTY_MAP );\n-            fail( exceptionName + \" must have been thrown\" );\n-        }\n-        catch ( ContinuumException e )\n-        {\n-            //expected, check for twice wrapped exception\n-            if ( e.getCause() != null )\n-            {\n-                assertFalse( exceptionName + \" is wrapped in \" + exceptionName, e.getCause().getClass()\n-                    .equals( ContinuumException.class ) );\n-            }\n-        }\n-    }\n-}",
                "deletions": 67
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Fix NPE when an error occurs before a buildResult is created (for instance\nwhen SCM action fails)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@439592 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/3d92c93cc65cce71d4d37f652e1be1020ed19fd8",
        "parent": "https://github.com/apache/continuum/commit/2d77ce4541a3a21d11ab3d8ba81f282c92728b36",
        "bug_id": "continuum_65",
        "file": [
            {
                "sha": "4919287909209f7461cba47b03030aaa3ff84552",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/3d92c93cc65cce71d4d37f652e1be1020ed19fd8/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/3d92c93cc65cce71d4d37f652e1be1020ed19fd8/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "status": "modified",
                "changes": 54,
                "additions": 31,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java?ref=3d92c93cc65cce71d4d37f652e1be1020ed19fd8",
                "patch": "@@ -74,8 +74,10 @@\n     // ----------------------------------------------------------------------\n \n     /**\n+     * @param projectId\n+     * @param buildDefinitionId\n+     * @param trigger\n      * @throws TaskExecutionException\n-     * @todo structure of this method is a bit of a mess (too much exception/finally code)\n      */\n     public void build( int projectId, int buildDefinitionId, int trigger )\n         throws TaskExecutionException\n@@ -150,8 +152,7 @@ public void build( int projectId, int buildDefinitionId, int trigger )\n     }\n \n     /**\n-     * Checks if the build should be marked as ERROR and notifies\n-     * the end of the build.\n+     * Checks if the build should be marked as ERROR and notifies the end of the build.\n      *\n      * @param context\n      * @throws TaskExecutionException\n@@ -187,17 +188,25 @@ private void updateBuildResult( BuildContext context, String error )\n     {\n         BuildResult build = context.getBuildResult();\n \n-        build.setError( error );\n-\n-        try\n+        if ( build == null )\n         {\n-            store.updateBuildResult( build );\n-\n-            build = store.getBuildResult( build.getId() );\n+            build = makeAndStoreBuildResult( context, error );\n         }\n-        catch ( ContinuumStoreException e )\n+        else\n         {\n-            throw new TaskExecutionException( \"Error updating build result\", e );\n+\n+            build.setError( error );\n+\n+            try\n+            {\n+                store.updateBuildResult( build );\n+\n+                build = store.getBuildResult( build.getId() );\n+            }\n+            catch ( ContinuumStoreException e )\n+            {\n+                throw new TaskExecutionException( \"Error updating build result\", e );\n+            }\n         }\n \n         context.getProject().setState( build.getState() );\n@@ -292,8 +301,7 @@ private BuildContext initializeBuildContext( int projectId, int buildDefinitionI\n \n         actionContext.put( AbstractContinuumAction.KEY_TRIGGER, new Integer( trigger ) );\n \n-        actionContext\n-            .put( AbstractContinuumAction.KEY_FIRST_RUN, Boolean.valueOf( context.getOldBuildResult() == null ) );\n+        actionContext.put( AbstractContinuumAction.KEY_FIRST_RUN, Boolean.valueOf( context.getOldBuildResult() == null ) );\n \n         return context;\n     }\n@@ -305,8 +313,8 @@ private void updateWorkingDirectory( BuildContext buildContext )\n \n         performAction( \"check-working-directory\", buildContext );\n \n-        boolean workingDirectoryExists = AbstractContinuumAction\n-            .getBoolean( actionContext, AbstractContinuumAction.KEY_WORKING_DIRECTORY_EXISTS );\n+        boolean workingDirectoryExists = AbstractContinuumAction.getBoolean( actionContext,\n+                                                                             AbstractContinuumAction.KEY_WORKING_DIRECTORY_EXISTS );\n \n         ScmResult scmResult;\n \n@@ -320,8 +328,8 @@ private void updateWorkingDirectory( BuildContext buildContext )\n         {\n             Project project = (Project) actionContext.get( AbstractContinuumAction.KEY_PROJECT );\n \n-            actionContext.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, workingDirectoryService\n-                .getWorkingDirectory( project ).getAbsolutePath() );\n+            actionContext.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY,\n+                               workingDirectoryService.getWorkingDirectory( project ).getAbsolutePath() );\n \n             performAction( \"checkout-project\", buildContext );\n \n@@ -391,9 +399,9 @@ private void performAction( String actionName, BuildContext context )\n     private boolean shouldBuild( BuildContext context )\n         throws TaskExecutionException\n     {\n-        //oldBuildResult != null &&\n-        //        List changes, Project project, int trigger )\n-        //        scmResult.getChanges(), project, trigger ) )\n+        // oldBuildResult != null &&\n+        // List changes, Project project, int trigger )\n+        // scmResult.getChanges(), project, trigger ) )\n \n         boolean allChangesUnknown = checkAllChangesUnknown( context.getScmResult().getChanges() );\n \n@@ -506,8 +514,8 @@ private String convertScmResultToError( ScmResult result )\n     private BuildResult makeAndStoreBuildResult( BuildContext context, String error )\n         throws TaskExecutionException\n     {\n-        //        Project project, ScmResult scmResult, long startTime, int trigger )\n-        //        project, scmResult, startTime, trigger );\n+        // Project project, ScmResult scmResult, long startTime, int trigger )\n+        // project, scmResult, startTime, trigger );\n \n         BuildResult build = new BuildResult();\n \n@@ -585,7 +593,7 @@ private ScmResult getOldScmResult( int projectId, long fromDate )\n     }\n \n     /**\n-     *  Merges scm results so we'll have all changes since last execution of current build definition\n+     * Merges scm results so we'll have all changes since last execution of current build definition\n      */\n     private void mergeScmResults( BuildContext context )\n     {",
                "deletions": 23
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "PR: CONTINUUM-519\nSubmitted by: Dan Tran\n\nFix NPE in buildProjects.\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@358304 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/01a3348ff7e7eb63689582ad6920b16c17725bd4",
        "parent": "https://github.com/apache/continuum/commit/aad00a7f2919eb61e98933a96c5737c7aba19b0b",
        "bug_id": "continuum_66",
        "file": [
            {
                "sha": "3e639d343bdca18f74310dc3c24369fbdd1ba196",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/01a3348ff7e7eb63689582ad6920b16c17725bd4/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/01a3348ff7e7eb63689582ad6920b16c17725bd4/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=01a3348ff7e7eb63689582ad6920b16c17725bd4",
                "patch": "@@ -365,12 +365,12 @@ public void buildProjects( Schedule schedule )\n         {\n             Project p = (Project) projectIterator.next();\n \n-            int buildDefId = ( (Integer) projectsMap.get( new Integer( p.getId() ) ) ).intValue();\n+            Integer buildDefId = ( (Integer) projectsMap.get( new Integer( p.getId() ) ) );\n \n-            if ( !isInBuildingQueue( p.getId() ) && !isInCheckoutQueue( p.getId() ) )\n+            if ( buildDefId != null && !isInBuildingQueue( p.getId() ) && !isInCheckoutQueue( p.getId() ) )\n             {\n                 //TODO: Fix trigger name\n-                buildProject( p.getId(), buildDefId, ContinuumProjectState.TRIGGER_UNKNOWN, false );\n+                buildProject( p.getId(), buildDefId.intValue(), ContinuumProjectState.TRIGGER_UNKNOWN, false );\n             }\n         }\n     }",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2346] NPE in log on forced build and project never builds\nImprovised error description so that an informative message can be displayed to user\nSubmitted by: Gwen Harold Autencio\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1140475 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/d8471bfaa6b9aa4789f38b03c61c3f46b0449033",
        "parent": "https://github.com/apache/continuum/commit/3d2a27421fb4bbca803d1bcd3ee446efefc313ce",
        "bug_id": "continuum_67",
        "file": [
            {
                "sha": "7c7c4718823f51e25c811d6b6f8c78a1849e51d1",
                "filename": "continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/d8471bfaa6b9aa4789f38b03c61c3f46b0449033/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/d8471bfaa6b9aa4789f38b03c61c3f46b0449033/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java",
                "status": "modified",
                "changes": 8,
                "additions": 8,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/buildmanager/ParallelBuildsManager.java?ref=d8471bfaa6b9aa4789f38b03c61c3f46b0449033",
                "patch": "@@ -186,6 +186,14 @@ public void buildProjects( List<Project> projects, Map<Integer, BuildDefinition>\n         if ( firstProjectId != 0 )\n         {\n             BuildDefinition buildDef = projectsBuildDefinitionsMap.get( firstProjectId );\n+            \n+            if ( buildDef.getArguments() == null || buildDef.getBuildFile() == null || buildDef.getGoals() == null || buildDef.getSchedule() == null )\n+            {\n+                log.error( \"Null values set on build definition (id=\" + buildDef.getId() + \")\" );\n+                throw new BuildManagerException( \"Unable to build project due to null values set on \" +\n+                                                 \"( GOALS , ARGUMENTS , BUILD_FILE, SCHEDULE_ID_OID ) of BUILDDEFINITION ID : \" \n+                                                 + buildDef.getId() + \" Please notify your system adminitrator\");\n+            }\n             OverallBuildQueue overallBuildQueue = getOverallBuildQueueWhereProjectsInGroupAreQueued( projectGroupId );\n \n             if ( overallBuildQueue == null )",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2581]\n- fixed NPE in rewrite-pom-phase\n- fixed ClassCastException when invoking getListener()\n- throw an exception when agent is unreachable while doing a release perform\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@1036488 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
        "parent": "https://github.com/apache/continuum/commit/55fab8a78d99c85fe139b1e3ea44f0500a10ce93",
        "bug_id": "continuum_68",
        "file": [
            {
                "sha": "d0bceeaeb050cf2cbc63e9cf5e22c61917d13897",
                "filename": "continuum-core/src/main/java/org/apache/continuum/release/distributed/manager/DefaultDistributedReleaseManager.java",
                "blob_url": "https://github.com/apache/continuum/blob/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-core/src/main/java/org/apache/continuum/release/distributed/manager/DefaultDistributedReleaseManager.java",
                "raw_url": "https://github.com/apache/continuum/raw/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-core/src/main/java/org/apache/continuum/release/distributed/manager/DefaultDistributedReleaseManager.java",
                "status": "modified",
                "changes": 12,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/continuum/release/distributed/manager/DefaultDistributedReleaseManager.java?ref=cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
                "patch": "@@ -409,12 +409,14 @@ public void releasePerform( int projectId, String releaseId, String goals, Strin\n     \n                 addReleaseInProgress( releaseId, \"perform\", projectId, username );\n             }\n+            else\n+            {\n+                // call reload in case we disable the build agent\n+                distributedBuildManager.reload();\n \n-            // call reload in case we disable the build agent\n-            distributedBuildManager.reload();\n-\n-            throw new ContinuumReleaseException( \"Failed to perform release of \" + releaseId + \n-                                                 \" because the build agent \" + buildAgentUrl + \" is not available\" );\n+                throw new ContinuumReleaseException( \"Failed to perform release of \" + releaseId + \n+                                                     \" because the build agent \" + buildAgentUrl + \" is not available\" );\n+            }\n         }\n         catch ( MalformedURLException e )\n         {",
                "deletions": 5
            },
            {
                "sha": "97d0ee6a8d27eb727f699f63213d3204de7ffc51",
                "filename": "continuum-xmlrpc/continuum-xmlrpc-server/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/pom.xml",
                "status": "modified",
                "changes": 25,
                "additions": 25,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/continuum-xmlrpc-server/pom.xml?ref=cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
                "patch": "@@ -122,6 +122,31 @@ under the License.\n       <version>2.4</version>\n       <scope>provided</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.jmock</groupId>\n+      <artifactId>jmock</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.jmock</groupId>\n+      <artifactId>jmock-junit3</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>cglib</groupId>\n+      <artifactId>cglib-nodep</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.objenesis</groupId>\n+      <artifactId>objenesis</artifactId>  \n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.slf4j</groupId>\n+      <artifactId>slf4j-simple</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n \n   <build>",
                "deletions": 0
            },
            {
                "sha": "105e7e4c8aca00fb2883ee998830a24443e279ff",
                "filename": "continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "blob_url": "https://github.com/apache/continuum/blob/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "raw_url": "https://github.com/apache/continuum/raw/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java",
                "status": "modified",
                "changes": 33,
                "additions": 28,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/continuum-xmlrpc-server/src/main/java/org/apache/maven/continuum/xmlrpc/server/ContinuumServiceImpl.java?ref=cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
                "patch": "@@ -73,7 +73,6 @@\n import org.apache.maven.continuum.xmlrpc.system.Profile;\n import org.apache.maven.continuum.xmlrpc.system.SystemConfiguration;\n import org.apache.maven.scm.provider.svn.repository.SvnScmProviderRepository;\n-import org.apache.maven.shared.release.ReleaseResult;\n import org.codehaus.plexus.redback.authorization.AuthorizationException;\n import org.codehaus.plexus.redback.role.RoleManager;\n import org.codehaus.plexus.redback.role.RoleManagerException;\n@@ -3009,7 +3008,7 @@ public int releaseRollback( int projectId, String releaseId )\n \n             // set scm tag and scm tag base if no values yet\n             // scm tag\n-            if ( params.get( \"scm-tag\") == null )\n+            if ( StringUtils.isBlank( (String) params.get( \"scm-tag\" ) ) )\n             {\n                 String scmTag;\n                 if ( project.getScmTag() != null )\n@@ -3037,7 +3036,7 @@ public int releaseRollback( int projectId, String releaseId )\n             }\n \n             // scm tagbase\n-            if ( params.get( \"scm-tagbase\") == null )\n+            if ( StringUtils.isBlank( (String) params.get( \"scm-tagbase\") ) )\n             {\n                 if ( project.getScmUrl().startsWith( \"scm:svn\" ) )\n                 {\n@@ -3090,13 +3089,13 @@ private ReleaseListenerSummary processListenerMap( Map context )\n         value = context.get( \"release-phases\" );\n         if ( value != null )\n         {\n-            listenerSummary.setPhases( (List<String>) value );\n+            listenerSummary.setPhases( getList( value ) );\n         }\n \n         value = context.get( \"completed-release-phases\" );\n         if ( value != null )\n         {\n-            listenerSummary.setPhases( (List<String>) value );\n+            listenerSummary.setCompletedPhases( getList( value ) );\n         }\n \n         return listenerSummary;\n@@ -3107,4 +3106,28 @@ private ReleaseListenerSummary populateReleaseListenerSummary( org.apache.contin\n     {\n         return (ReleaseListenerSummary) mapper.map( listener, ReleaseListenerSummary.class );\n     }\n+\n+    private List getList( Object obj )\n+    {\n+        List<Object> list = new ArrayList<Object>();\n+\n+        if ( obj instanceof Object[] )\n+        {\n+            Object[] objA = (Object[]) obj;\n+\n+            list.addAll( Arrays.asList( objA ) );\n+        }\n+        else\n+        {\n+            list = (List<Object>) obj;\n+        }\n+\n+        return list;\n+    }\n+\n+    // testing\n+    public void setContinuum( Continuum continuum )\n+    {\n+        this.continuum = continuum;\n+    }\n }",
                "deletions": 5
            },
            {
                "sha": "402daf520db6b5b27efbf87de14e6d9340bf2429",
                "filename": "continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplStub.java",
                "blob_url": "https://github.com/apache/continuum/blob/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplStub.java",
                "raw_url": "https://github.com/apache/continuum/raw/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplStub.java",
                "status": "added",
                "changes": 14,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplStub.java?ref=cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
                "patch": "@@ -0,0 +1,14 @@\n+package org.apache.continuum.xmlrpc.server;\n+\n+import org.apache.maven.continuum.ContinuumException;\n+import org.apache.maven.continuum.xmlrpc.server.ContinuumServiceImpl;\n+\n+public class ContinuumServiceImplStub\n+    extends ContinuumServiceImpl\n+{\n+    protected void checkBuildProjectInGroupAuthorization( String resource )\n+        throws ContinuumException\n+    {\n+        // do nothing\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "25081207b0e48f35babd2f4b0c358869f3062fc6",
                "filename": "continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplTest.java",
                "status": "added",
                "changes": 149,
                "additions": 149,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/continuum-xmlrpc-server/src/test/java/org/apache/continuum/xmlrpc/server/ContinuumServiceImplTest.java?ref=cca18bc5b712197fbbd4cf42aa34fb6f86c82d1f",
                "patch": "@@ -0,0 +1,149 @@\n+package org.apache.continuum.xmlrpc.server;\n+\n+import java.util.Arrays;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import org.apache.continuum.release.distributed.manager.DistributedReleaseManager;\n+import org.apache.maven.continuum.Continuum;\n+import org.apache.maven.continuum.configuration.ConfigurationService;\n+import org.apache.maven.continuum.model.project.Project;\n+import org.apache.maven.continuum.model.project.ProjectGroup;\n+import org.apache.maven.continuum.release.ContinuumReleaseManager;\n+import org.apache.maven.continuum.xmlrpc.project.ReleaseListenerSummary;\n+import org.apache.maven.continuum.xmlrpc.server.ContinuumServiceImpl;\n+import org.codehaus.plexus.spring.PlexusInSpringTestCase;\n+import org.jmock.Expectations;\n+import org.jmock.Mockery;\n+import org.jmock.integration.junit3.JUnit3Mockery;\n+import org.jmock.lib.legacy.ClassImposteriser;\n+\n+import com.sun.tools.javac.code.Attribute.Array;\n+\n+public class ContinuumServiceImplTest\n+    extends PlexusInSpringTestCase\n+{\n+    private ContinuumServiceImpl continuumService;\n+\n+    private Mockery context;\n+\n+    private Continuum continuum;\n+\n+    private DistributedReleaseManager distributedReleaseManager;\n+\n+    private ContinuumReleaseManager releaseManager;\n+\n+    private ConfigurationService configurationService;\n+\n+    private Project project;\n+\n+    private Map<String, Object> params;\n+\n+    @Override\n+    public void setUp()\n+        throws Exception\n+    {\n+        super.setUp();\n+\n+        context = new JUnit3Mockery();\n+        context.setImposteriser( ClassImposteriser.INSTANCE );\n+\n+        continuumService = new ContinuumServiceImplStub();\n+        continuum = context.mock( Continuum.class );\n+        continuumService.setContinuum( continuum );\n+\n+        distributedReleaseManager = context.mock( DistributedReleaseManager.class );\n+        releaseManager = context.mock( ContinuumReleaseManager.class );\n+        configurationService = context.mock( ConfigurationService.class );\n+\n+        ProjectGroup projectGroup = new ProjectGroup();\n+        projectGroup.setName( \"test-group\" );\n+\n+        project = new Project();\n+        project.setId( 1 );\n+        project.setProjectGroup( projectGroup );\n+        project.setVersion( \"1.0-SNAPSHOT\" );\n+        project.setArtifactId( \"continuum-test\" );\n+        project.setScmUrl( \"scm:svn:http://svn.test.org/repository/project\" );\n+    }\n+\n+    public void testGetReleasePluginParameters()\n+        throws Exception\n+    {\n+        params = new HashMap<String, Object>();\n+        params.put( \"scm-tag\", \"\" );\n+        params.put( \"scm-tagbase\", \"\" );    \n+\n+        context.checking( new Expectations()\n+        {\n+            {\n+                one( continuum ).getProject( 1 );\n+                will( returnValue( project ) );\n+\n+                one( continuum ).getConfiguration();\n+                will( returnValue( configurationService ) );\n+\n+                one( configurationService ).isDistributedBuildEnabled();\n+                will( returnValue( true ) );\n+\n+                one( continuum ).getDistributedReleaseManager();\n+                will( returnValue( distributedReleaseManager ) );\n+\n+                one( distributedReleaseManager ).getReleasePluginParameters( 1, \"pom.xml\" );\n+                will( returnValue( params ) );\n+\n+                one( continuum ).getReleaseManager();\n+                will( returnValue( releaseManager ) );\n+\n+                one( releaseManager ).sanitizeTagName( \"scm:svn:http://svn.test.org/repository/project\",\n+                                                       \"continuum-test-1.0\" );\n+            }\n+        } );\n+\n+        Map<String, Object> releaseParams = continuumService.getReleasePluginParameters( 1 );\n+        assertEquals( \"continuum-test-1.0\", releaseParams.get( \"scm-tag\" ) );\n+        assertEquals( \"http://svn.test.org/repository/project/tags\", releaseParams.get( \"scm-tagbase\" ) );\n+\n+        context.assertIsSatisfied();\n+    }\n+\n+    public void testGetListenerWithDistributedBuilds()\n+        throws Exception\n+    {\n+        final Map map = getListenerMap();\n+\n+        context.checking( new Expectations()\n+        {\n+            {\n+                one( continuum ).getProject( 1 );\n+                will( returnValue( project ) );\n+\n+                one( continuum ).getConfiguration();\n+                will( returnValue( configurationService ) );\n+\n+                one( configurationService ).isDistributedBuildEnabled();\n+                will( returnValue( true ) );\n+\n+                one( continuum ).getDistributedReleaseManager();\n+                will( returnValue( distributedReleaseManager ) );\n+\n+                one( distributedReleaseManager ).getListener( \"releaseId-1\" );\n+                will( returnValue( map ) );\n+            }\n+        } );\n+\n+        ReleaseListenerSummary summary = continuumService.getListener( 1, \"releaseId-1\" );\n+        assertNotNull( summary );\n+        assertEquals( \"incomplete-phase\", summary.getPhases().get( 0 ) );\n+        assertEquals( \"completed-phase\", summary.getCompletedPhases().get( 0 ) );\n+    }\n+\n+    private Map<String, Object> getListenerMap()\n+    {\n+        Map<String, Object> map = new HashMap<String, Object>();\n+ \n+        map.put( \"release-phases\", Arrays.asList( \"incomplete-phase\" ) );\n+        map.put( \"completed-release-phases\", Arrays.asList( \"completed-phase\" ) );\n+        return map;\n+    }\n+}",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2144] initialize list of repositories and projects when validation error occurs when editing project group with empty or spaces only to avoid NPE\n\nSubmitted By: Jose Morales Martinez\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@757384 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/b23d38a40f0190f5630616fce1c224ee43e59113",
        "parent": "https://github.com/apache/continuum/commit/0222891743c242a2189e1793856048eeec42ea89",
        "bug_id": "continuum_69",
        "file": [
            {
                "sha": "dd2f20bf4614b9925f2cefbfb30f02b11a51a312",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/b23d38a40f0190f5630616fce1c224ee43e59113/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/b23d38a40f0190f5630616fce1c224ee43e59113/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java",
                "status": "modified",
                "changes": 106,
                "additions": 58,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ProjectGroupAction.java?ref=b23d38a40f0190f5630616fce1c224ee43e59113",
                "patch": "@@ -19,6 +19,15 @@\n  * under the License.\n  */\n \n+import java.util.ArrayList;\n+import java.util.Collection;\n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Iterator;\n+import java.util.LinkedHashMap;\n+import java.util.List;\n+import java.util.Map;\n+\n import org.apache.continuum.buildmanager.BuildManagerException;\n import org.apache.continuum.buildmanager.BuildsManager;\n import org.apache.continuum.model.project.ProjectScmRoot;\n@@ -45,15 +54,6 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.Collections;\n-import java.util.HashMap;\n-import java.util.Iterator;\n-import java.util.LinkedHashMap;\n-import java.util.List;\n-import java.util.Map;\n-\n /**\n  * ProjectGroupAction:\n  *\n@@ -164,8 +164,9 @@ public String summary()\n \n                 if ( !buildDefinition.isDefaultForProject() )\n                 {\n-                    String key = StringUtils.isEmpty( buildDefinition.getDescription() ) ? buildDefinition.getGoals()\n-                        : buildDefinition.getDescription();\n+                    String key =\n+                        StringUtils.isEmpty( buildDefinition.getDescription() ) ? buildDefinition.getGoals()\n+                                        : buildDefinition.getDescription();\n                     buildDefinitions.put( key, Integer.valueOf( buildDefinition.getId() ) );\n                 }\n             }\n@@ -184,13 +185,14 @@ public String summary()\n                 int nbAntProjects = 0;\n                 int nbShellProjects = 0;\n \n-                // get the projects according to build order (first project in the group is the root project)            \n+                // get the projects according to build order (first project in the group is the root project)\n                 try\n                 {\n-                    Project rootProject = ( getContinuum().getProjectsInBuildOrder(\n-                        getContinuum().getProjectsInGroupWithDependencies( projectGroupId ) ) ).get( 0 );\n-                    if ( \"maven2\".equals( rootProject.getExecutorId() ) ||\n-                        \"maven-1\".equals( rootProject.getExecutorId() ) )\n+                    Project rootProject =\n+                        ( getContinuum().getProjectsInBuildOrder( getContinuum().getProjectsInGroupWithDependencies(\n+                                                                                                                     projectGroupId ) ) ).get( 0 );\n+                    if ( \"maven2\".equals( rootProject.getExecutorId() )\n+                        || \"maven-1\".equals( rootProject.getExecutorId() ) )\n                     {\n                         url = rootProject.getUrl();\n                     }\n@@ -310,19 +312,9 @@ public String remove()\n         return SUCCESS;\n     }\n \n-    public String edit()\n-        throws ContinuumException, CycleDetectedException\n+    private void initialize()\n+        throws ContinuumException\n     {\n-        try\n-        {\n-            checkModifyProjectGroupAuthorization( getProjectGroupName() );\n-        }\n-        catch ( AuthorizationRequiredException authzE )\n-        {\n-            addActionError( authzE.getMessage() );\n-            return REQUIRES_AUTHORIZATION;\n-        }\n-\n         try\n         {\n             checkManageLocalRepositoriesAuthorization();\n@@ -335,10 +327,6 @@ public String edit()\n \n         projectGroup = getContinuum().getProjectGroupWithProjects( projectGroupId );\n \n-        name = projectGroup.getName();\n-\n-        description = projectGroup.getDescription();\n-\n         projectList = projectGroup.getProjects();\n \n         if ( projectList != null )\n@@ -372,6 +360,29 @@ public String edit()\n                 projectGroups.put( new Integer( pg.getId() ), pg.getName() );\n             }\n         }\n+        repositories = getContinuum().getRepositoryService().getAllLocalRepositories();\n+    }\n+\n+    public String edit()\n+        throws ContinuumException, CycleDetectedException\n+    {\n+        try\n+        {\n+            checkModifyProjectGroupAuthorization( getProjectGroupName() );\n+        }\n+        catch ( AuthorizationRequiredException authzE )\n+        {\n+            addActionError( authzE.getMessage() );\n+            return REQUIRES_AUTHORIZATION;\n+        }\n+\n+        initialize();\n+\n+        name = projectGroup.getName();\n+\n+        description = projectGroup.getDescription();\n+\n+        projectList = projectGroup.getProjects();\n \n         if ( projectGroup.getLocalRepository() != null )\n         {\n@@ -382,8 +393,6 @@ public String edit()\n             repositoryId = -1;\n         }\n \n-        repositories = getContinuum().getRepositoryService().getAllLocalRepositories();\n-\n         Collection<Project> projList = getContinuum().getProjectsInGroupWithDependencies( projectGroup.getId() );\n         if ( projList != null && projList.size() > 0 )\n         {\n@@ -415,12 +424,10 @@ public String save()\n             if ( name.equals( \"\" ) )\n             {\n                 addActionError( getText( \"projectGroup.error.name.required\" ) );\n-                return INPUT;\n             }\n             else if ( name.trim().equals( \"\" ) )\n             {\n                 addActionError( getText( \"projectGroup.error.name.cannot.be.spaces\" ) );\n-                return INPUT;\n             }\n             else\n             {\n@@ -430,10 +437,14 @@ else if ( name.trim().equals( \"\" ) )\n                     if ( name.equals( projectGroup.getName() ) && projectGroup.getId() != projectGroupId )\n                     {\n                         addActionError( getText( \"projectGroup.error.name.already.exists\" ) );\n-                        return INPUT;\n                     }\n                 }\n             }\n+            if ( hasActionErrors() )\n+            {\n+                initialize();\n+                return INPUT;\n+            }\n         }\n \n         projectGroup = getContinuum().getProjectGroupWithProjects( projectGroupId );\n@@ -442,7 +453,7 @@ else if ( name.trim().equals( \"\" ) )\n         // todo convert everything like to work off of string keys\n         if ( !name.equals( projectGroup.getName() ) )\n         {\n-            //CONTINUUM-1502\n+            // CONTINUUM-1502\n             name = name.trim();\n             try\n             {\n@@ -503,15 +514,14 @@ else if ( name.trim().equals( \"\" ) )\n                 }\n             }\n \n-            ProjectGroup newProjectGroup = getContinuum().getProjectGroupWithProjects( new Integer( id[0] ).intValue() )\n-                ;\n+            ProjectGroup newProjectGroup = getContinuum().getProjectGroupWithProjects( new Integer( id[0] ).intValue() );\n \n             if ( newProjectGroup.getId() != projectGroup.getId() && isAuthorized( newProjectGroup.getName() ) )\n             {\n                 logger.info( \"Moving project \" + project.getName() + \" to project group \" + newProjectGroup.getName() );\n                 project.setProjectGroup( newProjectGroup );\n \n-                //CONTINUUM-1512\n+                // CONTINUUM-1512\n                 Collection<BuildResult> results = getContinuum().getBuildResultsForProject( project.getId() );\n                 for ( BuildResult br : results )\n                 {\n@@ -570,8 +580,8 @@ public String release()\n             return REQUIRES_AUTHORIZATION;\n         }\n \n-        //get the parent of the group by finding the parent project\n-        //i.e., the project that doesn't have a parent, or it's parent is not in the group.\n+        // get the parent of the group by finding the parent project\n+        // i.e., the project that doesn't have a parent, or it's parent is not in the group.\n \n         Project parent = null;\n \n@@ -602,8 +612,8 @@ public String release()\n                     }\n                     else\n                     {\n-                        //currently, we have no provisions for releasing 2 or more parents\n-                        //at the same time, this will be implemented in the future\n+                        // currently, we have no provisions for releasing 2 or more parents\n+                        // at the same time, this will be implemented in the future\n                         addActionError( getText( \"projectGroup.release.error.severalParentProjects\" ) );\n                         return INPUT;\n                     }\n@@ -648,9 +658,9 @@ private boolean isParentInProjectGroup( ProjectDependency parent, Collection pro\n \n             if ( parent != null )\n             {\n-                if ( ( project.getArtifactId().equals( parent.getArtifactId() ) ) &&\n-                    ( project.getGroupId().equals( parent.getGroupId() ) ) &&\n-                    ( project.getVersion().equals( parent.getVersion() ) ) )\n+                if ( ( project.getArtifactId().equals( parent.getArtifactId() ) )\n+                    && ( project.getGroupId().equals( parent.getGroupId() ) )\n+                    && ( project.getVersion().equals( parent.getVersion() ) ) )\n                 {\n                     result = true;\n                 }",
                "deletions": 48
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-2140] fix backup/restore of ContinuumReleaseResult, BuildDefinitionTemplate, DirectoryPurgeConfiguration, and RepositoryPurgeConfiguration.\n\nTODO:\nInclude the RepositoryPurgeConfiguration during restore. Comment out for now because of NPE, which is caused by how the RepositoryPurgeConfiguration is being written by ContinuumStaxWriter (LocalRepository first before the id).\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/continuum/trunk@756477 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/c25b540206d3970e33e9a6e8d1222e17010ac407",
        "parent": "https://github.com/apache/continuum/commit/15165d67dd0e6fca440dadea418cbf3b0373353e",
        "bug_id": "continuum_70",
        "file": [
            {
                "sha": "34d832c56f42057599df4790fcf8ef359b6c2056",
                "filename": "continuum-data-management/data-management-jdo/src/main/java/org/apache/maven/continuum/management/JdoDataManagementTool.java",
                "blob_url": "https://github.com/apache/continuum/blob/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-data-management/data-management-jdo/src/main/java/org/apache/maven/continuum/management/JdoDataManagementTool.java",
                "raw_url": "https://github.com/apache/continuum/raw/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-data-management/data-management-jdo/src/main/java/org/apache/maven/continuum/management/JdoDataManagementTool.java",
                "status": "modified",
                "changes": 66,
                "additions": 66,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-data-management/data-management-jdo/src/main/java/org/apache/maven/continuum/management/JdoDataManagementTool.java?ref=c25b540206d3970e33e9a6e8d1222e17010ac407",
                "patch": "@@ -19,6 +19,8 @@\n  * under the License.\n  */\n \n+import org.apache.continuum.dao.BuildDefinitionTemplateDao;\n+import org.apache.continuum.dao.ContinuumReleaseResultDao;\n import org.apache.continuum.dao.DaoUtils;\n import org.apache.continuum.dao.DirectoryPurgeConfigurationDao;\n import org.apache.continuum.dao.InstallationDao;\n@@ -30,9 +32,13 @@\n import org.apache.continuum.dao.ScheduleDao;\n import org.apache.continuum.dao.SystemConfigurationDao;\n import org.apache.continuum.model.project.ProjectScmRoot;\n+import org.apache.continuum.model.release.ContinuumReleaseResult;\n+import org.apache.continuum.model.repository.DirectoryPurgeConfiguration;\n import org.apache.continuum.model.repository.LocalRepository;\n+import org.apache.continuum.model.repository.RepositoryPurgeConfiguration;\n import org.apache.continuum.utils.ProjectSorter;\n import org.apache.maven.continuum.model.project.BuildDefinition;\n+import org.apache.maven.continuum.model.project.BuildDefinitionTemplate;\n import org.apache.maven.continuum.model.project.ContinuumDatabase;\n import org.apache.maven.continuum.model.project.Project;\n import org.apache.maven.continuum.model.project.ProjectGroup;\n@@ -129,6 +135,16 @@\n      */\n     private ProjectScmRootDao projectScmRootDao;\n \n+    /**\n+     * @plexus.requirement\n+     */\n+    private BuildDefinitionTemplateDao buildDefinitionTemplateDao;\n+\n+    /**\n+     * @plexus.requirement\n+     */\n+    private ContinuumReleaseResultDao releaseResultDao;\n+\n     protected static final String BUILDS_XML = \"builds.xml\";\n \n     /**\n@@ -169,6 +185,15 @@ public void backupDatabase( File backupDirectory )\n         database.setDirectoryPurgeConfigurations( directoryPurgeConfigurationDao.getAllDirectoryPurgeConfigurations() );\n \n         database.setProjectScmRoots( projectScmRootDao.getAllProjectScmRoots() );\n+        try\n+        {\n+            database.setBuildDefinitionTemplates( buildDefinitionTemplateDao.getAllBuildDefinitionTemplate() );\n+        }\n+        catch ( ContinuumStoreException e )\n+        {\n+        }\n+\n+        database.setContinuumReleaseResults( releaseResultDao.getAllContinuumReleaseResults() );\n \n         ContinuumStaxWriter writer = new ContinuumStaxWriter();\n \n@@ -337,6 +362,47 @@ public void restoreDatabase( File backupDirectory )\n                 continue;\n             }\n         }\n+\n+        /*\n+        for ( RepositoryPurgeConfiguration repoPurge : (List<RepositoryPurgeConfiguration>) database.getRepositoryPurgeConfigurations() )\n+        {\n+            repoPurge.setRepository( localRepositories.get( \n+                                     Integer.valueOf( repoPurge.getRepository().getId() ) ) );\n+\n+            if ( repoPurge.getSchedule() != null )\n+            {\n+                repoPurge.setSchedule( schedules.get( \n+                                       Integer.valueOf( repoPurge.getSchedule().getId() ) ) );\n+            }\n+\n+            repoPurge = (RepositoryPurgeConfiguration) PlexusJdoUtils.addObject( pmf.getPersistenceManager(), repoPurge );\n+        }*/\n+\n+        for ( DirectoryPurgeConfiguration dirPurge : (List<DirectoryPurgeConfiguration>) database.getDirectoryPurgeConfigurations() )\n+        {\n+            if ( dirPurge.getSchedule() != null )\n+            {\n+                dirPurge.setSchedule( schedules.get(\n+                                      Integer.valueOf( dirPurge.getSchedule().getId() ) ) );\n+            }\n+\n+            dirPurge = (DirectoryPurgeConfiguration) PlexusJdoUtils.addObject( pmf.getPersistenceManager(), dirPurge );\n+        }\n+\n+        for ( ContinuumReleaseResult releaseResult : (List<ContinuumReleaseResult>) database.getContinuumReleaseResults() )\n+        {\n+            releaseResult.setProjectGroup( projectGroups.get( \n+                                           Integer.valueOf( releaseResult.getProjectGroup().getId() ) ) );\n+\n+            releaseResult =\n+                (ContinuumReleaseResult) PlexusJdoUtils.addObject( pmf.getPersistenceManager(), releaseResult );\n+        }\n+\n+        for ( BuildDefinitionTemplate template : (List<BuildDefinitionTemplate>) database.getBuildDefinitionTemplates() )\n+        {\n+            template = \n+                (BuildDefinitionTemplate) PlexusJdoUtils.addObject( pmf.getPersistenceManager(), template );\n+        }\n     }\n     \n     private List<Project> getProjectsByGroupIdWithDependencies( PersistenceManagerFactory pmf, int projectGroupId )",
                "deletions": 0
            },
            {
                "sha": "76f2fbf2cee1558860cafe170c3955ff5935bd18",
                "filename": "continuum-data-management/data-management-jdo/src/test/resources/expected.xml",
                "blob_url": "https://github.com/apache/continuum/blob/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-data-management/data-management-jdo/src/test/resources/expected.xml",
                "raw_url": "https://github.com/apache/continuum/raw/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-data-management/data-management-jdo/src/test/resources/expected.xml",
                "status": "modified",
                "changes": 7,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-data-management/data-management-jdo/src/test/resources/expected.xml?ref=c25b540206d3970e33e9a6e8d1222e17010ac407",
                "patch": "@@ -549,4 +549,11 @@\n       <projectGroup id=\"2\"></projectGroup>\n     </projectScmRoot>\n   </projectScmRoots>\n+  <continuumReleaseResults>\n+    <continuumReleaseResult>\n+      <id>1</id>\n+      <projectGroup id=\"2\"></projectGroup>\n+      <releaseGoal>releaseGoal</releaseGoal>\n+    </continuumReleaseResult>\n+  </continuumReleaseResults>\n </continuumDatabase>",
                "deletions": 0
            },
            {
                "sha": "158684bd43e96b2815f28dc79294e5efc581f8d9",
                "filename": "continuum-model/src/main/mdo/continuum.xml",
                "blob_url": "https://github.com/apache/continuum/blob/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-model/src/main/mdo/continuum.xml",
                "raw_url": "https://github.com/apache/continuum/raw/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-model/src/main/mdo/continuum.xml",
                "status": "modified",
                "changes": 18,
                "additions": 18,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-model/src/main/mdo/continuum.xml?ref=c25b540206d3970e33e9a6e8d1222e17010ac407",
                "patch": "@@ -108,6 +108,24 @@\n           </association>\n           <defaultValue>new java.util.ArrayList()</defaultValue>\n         </field>\n+        <field>\n+          <name>continuumReleaseResults</name>\n+          <version>1.1.3+</version>\n+          <association java.init=\"field\">\n+            <type>ContinuumReleaseResult</type>\n+            <multiplicity>*</multiplicity>\n+          </association>\n+          <defaultValue>new java.util.ArrayList()</defaultValue>\n+        </field>\n+        <field>\n+          <name>buildDefinitionTemplates</name>\n+          <version>1.1.3+</version>\n+          <association java.init=\"field\">\n+            <type>BuildDefinitionTemplate</type>\n+            <multiplicity>*</multiplicity>\n+          </association>\n+          <defaultValue>new java.util.ArrayList()</defaultValue>\n+        </field>\n       </fields>\n     </class>\n ",
                "deletions": 0
            },
            {
                "sha": "46eab047159fb3e5b4c6339fe1ae9946fd26d42a",
                "filename": "continuum-store/src/test/java/org/apache/maven/continuum/store/AbstractContinuumStoreTestCase.java",
                "blob_url": "https://github.com/apache/continuum/blob/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-store/src/test/java/org/apache/maven/continuum/store/AbstractContinuumStoreTestCase.java",
                "raw_url": "https://github.com/apache/continuum/raw/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-store/src/test/java/org/apache/maven/continuum/store/AbstractContinuumStoreTestCase.java",
                "status": "modified",
                "changes": 66,
                "additions": 60,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/test/java/org/apache/maven/continuum/store/AbstractContinuumStoreTestCase.java?ref=c25b540206d3970e33e9a6e8d1222e17010ac407",
                "patch": "@@ -141,6 +141,8 @@\n \n     protected ProjectScmRoot testProjectScmRoot;\n \n+    protected ContinuumReleaseResult testContinuumReleaseResult;\n+\n     private SystemConfiguration systemConfiguration;\n \n     @Override\n@@ -541,7 +543,7 @@ protected void createBuildDatabase( boolean addToStore, boolean isTestFromDataMa\n \n         if ( addToStore )\n         {\n-            projectGroupDao.addProjectGroup( group );\n+            group = projectGroupDao.addProjectGroup( group );\n             defaultProjectGroup.setId( group.getId() );\n             testProject1.setId( project1.getId() );\n             testProject2.setId( project2.getId() );\n@@ -582,6 +584,7 @@ protected void createBuildDatabase( boolean addToStore, boolean isTestFromDataMa\n         }\n         else\n         {\n+            group.setId( 2 );\n             testProjectGroup2.setId( 2 ); // from expected.xml, continuum-data-management\n         }\n \n@@ -632,10 +635,29 @@ protected void createBuildDatabase( boolean addToStore, boolean isTestFromDataMa\n         }\n         \n         testProjectScmRoot = createTestProjectScmRoot( \"scmRootAddress1\", 1, 0, \"error1\", group );\n-        \n+        ProjectScmRoot scmRoot = createTestProjectScmRoot( testProjectScmRoot );\n+\n         if ( addToStore )\n         {\n-            projectScmRootDao.addProjectScmRoot( testProjectScmRoot );\n+            scmRoot = projectScmRootDao.addProjectScmRoot( scmRoot );\n+            testProjectScmRoot.setId( scmRoot.getId() );\n+        }\n+        else\n+        {\n+            testProjectScmRoot.setId( 1 );\n+        }\n+\n+        testContinuumReleaseResult = createTestContinuumReleaseResult( group, null, \"releaseGoal\", 0, 0, 0 );\n+        ContinuumReleaseResult releaseResult = createTestContinuumReleaseResult( testContinuumReleaseResult );\n+\n+        if ( addToStore )\n+        {\n+            releaseResult = releaseResultDao.addContinuumReleaseResult( releaseResult );\n+            testContinuumReleaseResult.setId( releaseResult.getId() );\n+        }\n+        else\n+        {\n+            testContinuumReleaseResult.setId( 1 );\n         }\n     }\n \n@@ -819,7 +841,26 @@ protected void assertBuildDatabase()\n         store.addProjectGroup( group );\n         testProjectGroup2.setId( group.getId() );\n */\n-        assertSystemConfiguration( systemConfiguration, systemConfigurationDao.getSystemConfiguration() );        \n+        assertSystemConfiguration( systemConfiguration, systemConfigurationDao.getSystemConfiguration() );\n+\n+        assertLocalRepositoryEquals( testLocalRepository1, localRepositoryDao.getLocalRepository( testLocalRepository1.getId() ) );\n+        assertLocalRepositoryEquals( testLocalRepository2, localRepositoryDao.getLocalRepository( testLocalRepository2.getId() ) );\n+        assertLocalRepositoryEquals( testLocalRepository3, localRepositoryDao.getLocalRepository( testLocalRepository3.getId() ) );\n+\n+/*\n+        assertRepositoryPurgeConfigurationEquals( testRepoPurgeConfiguration1,\n+                                                  repositoryPurgeConfigurationDao.getRepositoryPurgeConfiguration( testRepoPurgeConfiguration1.getId() ) );\n+        assertRepositoryPurgeConfigurationEquals( testRepoPurgeConfiguration2,\n+                                                  repositoryPurgeConfigurationDao.getRepositoryPurgeConfiguration( testRepoPurgeConfiguration2.getId() ) );\n+        assertRepositoryPurgeConfigurationEquals( testRepoPurgeConfiguration3,\n+                                                  repositoryPurgeConfigurationDao.getRepositoryPurgeConfiguration( testRepoPurgeConfiguration3.getId() ) );\n+\n+        assertDirectoryPurgeConfigurationEquals( testDirectoryPurgeConfig, \n+                                                 directoryPurgeConfigurationDao.getDirectoryPurgeConfiguration( testDirectoryPurgeConfig.getId() ) );\n+*/\n+        assertProjectScmRootEquals( testProjectScmRoot, projectScmRootDao.getProjectScmRoot( testProjectScmRoot.getId() ) );\n+\n+        assertReleaseResultEquals( testContinuumReleaseResult, releaseResultDao.getContinuumReleaseResult( testContinuumReleaseResult.getId() ) );\n     }\n \n     private void assertSystemConfiguration( SystemConfiguration expected, SystemConfiguration actual )\n@@ -1430,6 +1471,12 @@ protected static ProjectScmRoot createTestProjectScmRoot( String scmRootAddress,\n         return projectScmRoot;\n     }\n \n+    protected static ProjectScmRoot createTestProjectScmRoot( ProjectScmRoot scmRoot )\n+    {\n+        return createTestProjectScmRoot( scmRoot.getScmRootAddress(), scmRoot.getState(), scmRoot.getOldState(), \n+                                         scmRoot.getError(), scmRoot.getProjectGroup() );\n+    }\n+\n     protected static void assertProjectScmRootEquals( ProjectScmRoot expectedConfig, ProjectScmRoot actualConfig )\n     {\n         assertEquals( \"compare project scm root - id\", expectedConfig.getId(), actualConfig.getId() );\n@@ -1454,7 +1501,14 @@ protected static ContinuumReleaseResult createTestContinuumReleaseResult( Projec\n         \n         return releaseResult;\n     }\n-    \n+\n+    protected static ContinuumReleaseResult createTestContinuumReleaseResult( ContinuumReleaseResult releaseResult )\n+    {\n+        return createTestContinuumReleaseResult( releaseResult.getProjectGroup(), releaseResult.getProject(), \n+                                                 releaseResult.getReleaseGoal(), releaseResult.getResultCode(),\n+                                                 releaseResult.getStartTime(), releaseResult.getEndTime() );\n+    }\n+\n     protected static void assertReleaseResultEquals( ContinuumReleaseResult expectedConfig, \n                                                      ContinuumReleaseResult actualConfig )\n     {\n@@ -1468,7 +1522,7 @@ protected static void assertReleaseResultEquals( ContinuumReleaseResult expected\n         assertEquals( \"compare continuum release result - endTime\", expectedConfig.getEndTime(),\n                       actualConfig.getEndTime() );\n     }\n-    \n+\n     /**\n      * Setup JDO Factory\n      *",
                "deletions": 6
            },
            {
                "sha": "9fa4c456c268177feb9c738bcbd3c4b43eb01180",
                "filename": "continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/c25b540206d3970e33e9a6e8d1222e17010ac407/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "status": "modified",
                "changes": 6,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java?ref=c25b540206d3970e33e9a6e8d1222e17010ac407",
                "patch": "@@ -1300,9 +1300,9 @@ public void testRemoveProjectWithReleaseResult()\n         releaseResult = releaseResultDao.addContinuumReleaseResult( releaseResult );\n         \n         List<ContinuumReleaseResult> releaseResults = releaseResultDao.getAllContinuumReleaseResults();\n-        assertEquals( \"check size of continuum release results\", 1, releaseResults.size() );\n+        assertEquals( \"check size of continuum release results\", 2, releaseResults.size() );\n         \n-        ContinuumReleaseResult retrievedResult = releaseResults.get( 0 );\n+        ContinuumReleaseResult retrievedResult = releaseResults.get( 1 );\n         assertReleaseResultEquals( releaseResult, retrievedResult );\n         assertProjectGroupEquals( group, retrievedResult.getProjectGroup() );\n         assertProjectEquals( project, retrievedResult.getProject() );\n@@ -1312,7 +1312,7 @@ public void testRemoveProjectWithReleaseResult()\n         assertFalse( projectDao.getProjectsInGroup( group.getId() ).contains( project ) );\n         \n         releaseResults = releaseResultDao.getAllContinuumReleaseResults();\n-        assertEquals( \"check size of continuum release results\", 0, releaseResults.size() );\n+        assertEquals( \"check size of continuum release results\", 1, releaseResults.size() );\n     }\n     // ----------------------------------------------------------------------\n     //  HELPER METHODS",
                "deletions": 3
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "[CONTINUUM-1355] No admin user found after Tomcat shutdown (Tomcat doesn't shutdown properly)\nupgrade ehcache version to disable shutdownHook which failed with NPE.\nlook issue for more details\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@578388 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/54009b0de4667b2e2b42648a55a230967b953d8f",
        "parent": "https://github.com/apache/continuum/commit/33d7d66cce578e4b55da5dc01563f13aec06a969",
        "bug_id": "continuum_71",
        "file": [
            {
                "sha": "9e07c459550d4b395879c5c2f0f9ce8a926b3260",
                "filename": "continuum-webapp/pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/54009b0de4667b2e2b42648a55a230967b953d8f/continuum-webapp/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/54009b0de4667b2e2b42648a55a230967b953d8f/continuum-webapp/pom.xml",
                "status": "modified",
                "changes": 4,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/pom.xml?ref=54009b0de4667b2e2b42648a55a230967b953d8f",
                "patch": "@@ -445,6 +445,10 @@\n       <groupId>org.codehaus.plexus.redback</groupId>\n       <artifactId>redback-taglib</artifactId>\n     </dependency>\n+    <dependency>\n+      <groupId>net.sf.ehcache</groupId>\n+      <artifactId>ehcache</artifactId>\n+    </dependency>    \n     <dependency>\n       <groupId>org.codehaus.plexus</groupId>\n       <artifactId>plexus-jdo2</artifactId>",
                "deletions": 0
            },
            {
                "sha": "7afbe0ab178ee2b7f1f7a5eb9b15ce8688ff9389",
                "filename": "pom.xml",
                "blob_url": "https://github.com/apache/continuum/blob/54009b0de4667b2e2b42648a55a230967b953d8f/pom.xml",
                "raw_url": "https://github.com/apache/continuum/raw/54009b0de4667b2e2b42648a55a230967b953d8f/pom.xml",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/pom.xml?ref=54009b0de4667b2e2b42648a55a230967b953d8f",
                "patch": "@@ -450,6 +450,11 @@\n         <artifactId>redback-legacy</artifactId>\n         <version>${pom.version}</version>\n       </dependency>\n+      <dependency>\n+        <groupId>net.sf.ehcache</groupId>\n+        <artifactId>ehcache</artifactId>\n+        <version>1.3.0</version>\n+      </dependency>\n       <dependency>\n         <groupId>org.apache.maven.shared</groupId>\n         <artifactId>maven-app-configuration-model</artifactId>",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Added 'maxJobExecutionTime' field to Schedule;\n\nUpdated edit/show schedule pages (and label properties) for this new field;\n\nDefaultContinuum now sets the max job execution time on the Task,\nretrieved from schedule for the given buildId;\n(Also removed never-executing code from DefaultContinuum and fixed an NPE).\n\nAdded a CancelBuildAction and made it available from the StateCell, displayed\nin build history/build overviews.\n\nTODO: When a build is cancelled, it the build number is incorrect\n(either 0 or the highest one, depending on when it's cancelled).\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@442951 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
        "parent": "https://github.com/apache/continuum/commit/a23c7092b03468ffe0b1d5effcd94d6c73bf09dc",
        "bug_id": "continuum_72",
        "file": [
            {
                "sha": "ed03eff7e75253a29a58bf29213b7f1b041e3e6c",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 32,
                "additions": 11,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -191,7 +191,6 @@ public ProjectGroup getProjectGroup( int projectGroupId )\n         throw new ContinuumException( \"invalid group id\" );\n     }\n \n-\n     public ProjectGroup getProjectGroupByProjectId( int projectId )\n         throws ContinuumException\n     {\n@@ -415,7 +414,6 @@ public void buildProjects()\n         buildProjects( ContinuumProjectState.TRIGGER_FORCED );\n     }\n \n-\n     /**\n      * fire of the builds of all projects across all project groups using their default build definitions\n      *\n@@ -450,16 +448,11 @@ public void buildProjects( int trigger )\n             {\n                 buildDefId = new Integer( store.getDefaultBuildDefinition( project.getId() ).getId() );\n             }\n-            catch (ContinuumStoreException e)\n+            catch ( ContinuumStoreException e )\n             {\n                 throw new ContinuumException(\n                     \"Project (id=\" + project.getId() + \" doens't have a default build definition, this should be impossible, parent should have default definition set.\" );\n             }\n-            if ( buildDefId == null )\n-            {\n-                throw new ContinuumException(\n-                    \"Project (id=\" + project.getId() + \" doens't have a default build definition, this should be even more impossible since store should have throw exception\" );\n-            }\n \n             buildProject( project, buildDefId.intValue(), trigger );\n         }\n@@ -479,7 +472,7 @@ public void buildProjectGroup( int projectGroupId )\n \n         try\n         {\n-            projectsList = getProjectsInBuildOrder( store.getProjectsWithDependenciesByGroupId( projectGroupId ));\n+            projectsList = getProjectsInBuildOrder( store.getProjectsWithDependenciesByGroupId( projectGroupId ) );\n         }\n         catch ( CycleDetectedException e )\n         {\n@@ -500,16 +493,11 @@ public void buildProjectGroup( int projectGroupId )\n             {\n                 buildDefId = new Integer( store.getDefaultBuildDefinition( project.getId() ).getId() );\n             }\n-            catch (ContinuumStoreException e)\n+            catch ( ContinuumStoreException e )\n             {\n                 throw new ContinuumException(\n                     \"Project (id=\" + project.getId() + \" doens't have a default build definition, this should be impossible, parent should have default definition set.\" );\n             }\n-            if ( buildDefId == null )\n-            {\n-                throw new ContinuumException(\n-                    \"Project (id=\" + project.getId() + \" doens't have a default build definition, this should be even more impossible since store should have throw exception\" );\n-            }\n \n             buildProject( project, buildDefId.intValue(), ContinuumProjectState.TRIGGER_FORCED );\n         }\n@@ -543,8 +531,6 @@ public void buildProjects( Schedule schedule )\n                 getLogger().info( \"No projects to build for schedule \" + schedule );\n                 return;\n             }\n-\n-\n         }\n         catch ( ContinuumStoreException e )\n         {\n@@ -597,7 +583,7 @@ public void buildProjects( Schedule schedule )\n                 }\n \n                 // iterate through the project build definitions and build\n-                List buildDefIds = (List) projectsMap.get( new Integer( project.getId() ) );\n+                List buildDefIds = projectsMap == null ? null : (List) projectsMap.get( new Integer( project.getId() ) );\n \n                 if ( buildDefIds != null && !buildDefIds.isEmpty() )\n                 {\n@@ -706,7 +692,7 @@ private synchronized void buildProject( Project project, int buildDefinitionId,\n                 if ( executor.isBuilding( project ) )\n                 {\n                     // project is building\n-                    getLogger().info( \"Project '\" + project.getName() + \"' always running.\" );\n+                    getLogger().info( \"Project '\" + project.getName() + \"' already being built.\" );\n \n                     return;\n                 }\n@@ -723,7 +709,12 @@ private synchronized void buildProject( Project project, int buildDefinitionId,\n             getLogger().info(\n                 \"Enqueuing '\" + project.getName() + \"' (Build definition id=\" + buildDefinitionId + \").\" );\n \n-            buildQueue.put( new BuildProjectTask( project.getId(), buildDefinitionId, trigger ) );\n+            BuildProjectTask task = new BuildProjectTask( project.getId(), buildDefinitionId, trigger );\n+\n+            task.setMaxExecutionTime( store.getBuildDefinition( buildDefinitionId ).getSchedule()\n+                .getMaxJobExecutionTime() );\n+\n+            buildQueue.put( task );\n         }\n         catch ( ContinuumStoreException e )\n         {\n@@ -1337,7 +1328,6 @@ public BuildDefinition getBuildDefinition( int buildDefinitionId )\n         }\n     }\n \n-\n     public List getBuildDefinitionsForProject( int projectId )\n         throws ContinuumException\n     {",
                "deletions": 21
            },
            {
                "sha": "befeb4c9fa389aa3d427105bdf57a279891ace92",
                "filename": "continuum-core/src/main/resources/META-INF/plexus/components.xml",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-core/src/main/resources/META-INF/plexus/components.xml",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-core/src/main/resources/META-INF/plexus/components.xml",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/resources/META-INF/plexus/components.xml?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -174,7 +174,7 @@\n           </property>\n         </updateProperties>\n       </configuration>\n-      \n+\n     </component>\n \n     <component>\n@@ -430,6 +430,7 @@\n       <role>org.codehaus.plexus.taskqueue.execution.TaskQueueExecutor</role>\n       <role-hint>build-project</role-hint>\n       <implementation>org.codehaus.plexus.taskqueue.execution.ThreadedTaskQueueExecutor</implementation>\n+      <instantiation-strategy>singleton</instantiation-strategy>\n       <requirements>\n         <requirement>\n           <role>org.codehaus.plexus.taskqueue.execution.TaskExecutor</role>\n@@ -475,6 +476,7 @@\n       <role>org.codehaus.plexus.taskqueue.execution.TaskQueueExecutor</role>\n       <role-hint>check-out-project</role-hint>\n       <implementation>org.codehaus.plexus.taskqueue.execution.ThreadedTaskQueueExecutor</implementation>\n+      <instantiation-strategy>singleton</instantiation-strategy>\n       <requirements>\n         <requirement>\n           <role>org.codehaus.plexus.taskqueue.execution.TaskExecutor</role>",
                "deletions": 1
            },
            {
                "sha": "429bf8d7018979de1438c29f35215b983e622a4c",
                "filename": "continuum-model/src/main/mdo/continuum.mdo",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-model/src/main/mdo/continuum.mdo",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-model/src/main/mdo/continuum.mdo",
                "status": "modified",
                "changes": 10,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-model/src/main/mdo/continuum.mdo?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -804,6 +804,16 @@\n           <version>1.0.0+</version>\n           <type>int</type>\n         </field>\n+        <field>\n+          <name>maxJobExecutionTime</name>\n+          <description>\n+            Maximum execution time of a job in seconds before it's\n+            terminated.\n+          </description>\n+          <version>1.0.0+</version>\n+          <type>int</type>\n+          <defaultValue>3600</defaultValue>\n+        </field>\n         <field>\n           <name>cronExpression</name>\n           <version>1.0.0+</version>",
                "deletions": 0
            },
            {
                "sha": "2253a9ea65a349690be94e7bdcd8d3faedfdc864",
                "filename": "continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "status": "modified",
                "changes": 2,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -36,6 +36,7 @@\n import org.codehaus.plexus.personality.plexus.lifecycle.phase.InitializationException;\n \n import javax.jdo.Extent;\n+import javax.jdo.FetchPlan;\n import javax.jdo.JDOHelper;\n import javax.jdo.JDOUserException;\n import javax.jdo.PersistenceManager;\n@@ -1404,6 +1405,7 @@ private PersistenceManager getPersistenceManager()\n         PersistenceManager pm = pmf.getPersistenceManager();\n \n         pm.getFetchPlan().setMaxFetchDepth( -1 );\n+        pm.getFetchPlan().setDetachmentOptions( FetchPlan.DETACH_LOAD_FIELDS );\n \n         return pm;\n     }",
                "deletions": 0
            },
            {
                "sha": "32f69736329bba3254433c1ea49964a21d212284",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java",
                "status": "added",
                "changes": 77,
                "additions": 77,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/CancelBuildAction.java?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -0,0 +1,77 @@\n+package org.apache.maven.continuum.web.action;\n+\n+/*\n+ * Copyright 2004-2006 The Apache Software Foundation.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import org.apache.maven.continuum.ContinuumException;\n+import org.apache.maven.continuum.buildqueue.BuildProjectTask;\n+import org.codehaus.plexus.taskqueue.Task;\n+import org.codehaus.plexus.taskqueue.execution.TaskQueueExecutor;\n+\n+/**\n+ * @author <a href=\"mailto:evenisse@apache.org\">Emmanuel Venisse</a>\n+ * @version $Id$\n+ *\n+ * @plexus.component role=\"com.opensymphony.xwork.Action\" role-hint=\"cancelBuild\"\n+ */\n+public class CancelBuildAction\n+    extends ContinuumActionSupport\n+{\n+    /** @plexus.requirement role-hint='build-project' */\n+    private TaskQueueExecutor taskQueueExecutor;\n+\n+    private int projectId;\n+\n+    public String execute()\n+        throws ContinuumException\n+    {\n+        Task task = taskQueueExecutor.getCurrentTask();\n+\n+        getLogger().info(\"TaskQueueExecutor: \" + taskQueueExecutor );\n+\n+        if ( task != null )\n+        {\n+            if ( task instanceof BuildProjectTask )\n+            {\n+                if ( ( (BuildProjectTask) task ).getProjectId() == projectId )\n+                {\n+                    getLogger().info( \"Cancelling task for project \" + projectId );\n+                    taskQueueExecutor.cancelTask( task );\n+                }\n+                else\n+                {\n+                    getLogger().warn( \"Current task is not for the given projectId (\" + projectId + \"): \"\n+                        + ( (BuildProjectTask) task ).getProjectId() + \"; not cancelling\" );\n+                }\n+            }\n+            else\n+            {\n+                getLogger().warn( \"Current task not a BuildProjectTask - not cancelling\" );\n+            }\n+        }\n+        else\n+        {\n+            getLogger().warn( \"No task running - not cancelling\" );\n+        }\n+\n+        return SUCCESS;\n+    }\n+\n+    public void setProjectId( int projectId )\n+    {\n+        this.projectId = projectId;\n+    }\n+}",
                "deletions": 0
            },
            {
                "sha": "310d8da8deb40c447b41e43a3df3f8934e7b7dfd",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ScheduleAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ScheduleAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ScheduleAction.java",
                "status": "modified",
                "changes": 51,
                "additions": 29,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/ScheduleAction.java?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -23,8 +23,7 @@\n \n /**\n  * @author Nik Gonzalez\n- * @plexus.component role=\"com.opensymphony.xwork.Action\"\n- * role-hint=\"schedule\"\n+ * @plexus.component role=\"com.opensymphony.xwork.Action\" role-hint=\"schedule\"\n  */\n public class ScheduleAction\n     extends ContinuumActionSupport\n@@ -47,6 +46,8 @@\n \n     private boolean confirmed;\n \n+    private int maxJobExecutionTime;\n+\n     public String summary()\n         throws ContinuumException\n     {\n@@ -63,10 +64,11 @@ public String input()\n             {\n                 schedule = getContinuum().getSchedule( id );\n                 active = schedule.isActive();\n-                cronExpression= schedule.getCronExpression();\n+                cronExpression = schedule.getCronExpression();\n                 description = schedule.getDescription();\n                 name = schedule.getName();\n                 delay = schedule.getDelay();\n+                maxJobExecutionTime = schedule.getMaxJobExecutionTime();\n             }\n             catch ( ContinuumException e )\n             {\n@@ -83,14 +85,7 @@ public String save()\n         {\n             try\n             {\n-                Schedule schedule = new Schedule();\n-                schedule.setActive( active );\n-                schedule.setCronExpression( cronExpression );\n-                schedule.setDelay( delay );\n-                schedule.setDescription( description );\n-                schedule.setName( name );\n-\n-                getContinuum().addSchedule( schedule );\n+                getContinuum().addSchedule( setFields( new Schedule() ) );\n             }\n             catch ( ContinuumException e )\n             {\n@@ -101,19 +96,9 @@ public String save()\n         }\n         else\n         {\n-\n             try\n             {\n-                schedule = getContinuum().getSchedule( id );\n-\n-                schedule.setActive( active );\n-                schedule.setCronExpression( cronExpression );\n-                schedule.setDelay( delay );\n-                schedule.setDescription( description );\n-                schedule.setName( name );\n-\n-                getContinuum().updateSchedule( schedule );\n-\n+                getContinuum().updateSchedule( setFields( getContinuum().getSchedule( id ) ) );\n             }\n             catch ( ContinuumException e )\n             {\n@@ -125,6 +110,18 @@ public String save()\n         }\n     }\n \n+    private Schedule setFields( Schedule schedule )\n+    {\n+        schedule.setActive( active );\n+        schedule.setCronExpression( cronExpression );\n+        schedule.setDelay( delay );\n+        schedule.setDescription( description );\n+        schedule.setName( name );\n+        schedule.setMaxJobExecutionTime( maxJobExecutionTime );\n+\n+        return schedule;\n+    }\n+\n     public String confirm()\n         throws ContinuumException\n     {\n@@ -233,4 +230,14 @@ public void setConfirmed( boolean confirmed )\n     {\n         this.confirmed = confirmed;\n     }\n+\n+    public int getMaxJobExecutionTime()\n+    {\n+        return maxJobExecutionTime;\n+    }\n+\n+    public void setMaxJobExecutionTime( int maxJobExecutionTime )\n+    {\n+        this.maxJobExecutionTime = maxJobExecutionTime;\n+    }\n }",
                "deletions": 22
            },
            {
                "sha": "36ec9c4307ec937c84a56d3bb0f3608c235aa07e",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/view/StateCell.java",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/view/StateCell.java",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/java/org/apache/maven/continuum/web/view/StateCell.java",
                "status": "modified",
                "changes": 64,
                "additions": 42,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/view/StateCell.java?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -18,6 +18,8 @@\n \n import com.opensymphony.webwork.ServletActionContext;\n import com.opensymphony.webwork.views.util.UrlHelper;\n+\n+import org.apache.maven.continuum.project.ContinuumProjectState;\n import org.apache.maven.continuum.web.model.ProjectSummary;\n import org.apache.maven.continuum.web.util.StateGenerator;\n import org.extremecomponents.table.bean.Column;\n@@ -39,35 +41,53 @@ protected String getCellValue( TableModel tableModel, Column column )\n     {\n         ProjectSummary project = (ProjectSummary) tableModel.getCurrentRowBean();\n \n-        int latestBuildId = project.getLatestBuildId();\n-\n-        String state = StateGenerator.generate( project.getState(), tableModel.getContext().getContextPath() );\n-\n-        if ( project.getState() == 1 || project.getState() == 2 || project.getState() == 3 || project.getState() == 4 )\n+        switch ( project.getState() )\n         {\n-            if ( latestBuildId != -1 && !StateGenerator.NEW.equals( state ) )\n+            case ContinuumProjectState.NEW:\n+            case ContinuumProjectState.OK:\n+            case ContinuumProjectState.FAILED:\n+            case ContinuumProjectState.ERROR:\n             {\n-                HashMap params = new HashMap();\n-\n-                params.put( \"projectId\", new Integer( project.getId() ) );\n-\n-                params.put( \"projectName\", project.getName() );\n+                String state = StateGenerator.generate( project.getState(), tableModel.getContext().getContextPath() );\n \n-                params.put( \"buildId\", new Integer( latestBuildId ) );\n-\n-                String url = UrlHelper.buildUrl( \"/buildResult.action\", ServletActionContext.getRequest(),\n-                                                 ServletActionContext.getResponse(), params );\n+                if ( project.getLatestBuildId() != -1 && !StateGenerator.NEW.equals( state ) )\n+                {\n+                    return createActionLink( \"buildResult\", project, state );\n+                }\n+                else\n+                {\n+                    return state;\n+                }\n+            }\n \n-                return \"<a href=\\\"\" + url + \"\\\">\" + state + \"</a>\";\n+            case ContinuumProjectState.BUILDING:\n+            {\n+                return StateGenerator.generate( project.getState(), tableModel.getContext().getContextPath() ) + \" \"\n+                    + createActionLink( \"cancelBuild\", project, \"(cancel)\" );\n             }\n-            else\n+\n+            default:\n             {\n-                return state;\n+                return \"&nbsp;\";\n             }\n         }\n-        else\n-        {\n-            return \"&nbsp;\";\n-        }\n+    }\n+\n+    private static String createActionLink( String action, ProjectSummary project, String state )\n+    {\n+        HashMap params = new HashMap();\n+\n+        params.put( \"projectId\", new Integer( project.getId() ) );\n+\n+        params.put( \"projectName\", project.getName() );\n+\n+        params.put( \"buildId\", new Integer( project.getLatestBuildId() ) );\n+\n+        String url = UrlHelper.buildUrl( \"/\" + action + \".action\",\n+                                         ServletActionContext.getRequest(),\n+                                         ServletActionContext.getResponse(),\n+                                         params );\n+\n+        return \"<a href=\\\"\" + url + \"\\\">\" + state + \"</a>\";\n     }\n }",
                "deletions": 22
            },
            {
                "sha": "bdbdb6d08bbabbe72feb07316a286a7bb6f8da18",
                "filename": "continuum-webapp/src/main/resources/localization/Continuum.properties",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/resources/localization/Continuum.properties",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/localization/Continuum.properties?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -116,7 +116,7 @@ add.project.missing.name.error = Missing 'name' element in the POM.\n add.project.missing.repository.error = Missing 'repository' element in the POM.\n add.project.missing.scm.error = Missing 'scm' element in the POM.\n add.project.missing.scm.connection.error = Missing 'connection' sub-element in the 'scm' element in the POM.\n-add.project.missing.notifier.type.error = Missing 'type' sub-element in the 'notifier' element in the POM. \n+add.project.missing.notifier.type.error = Missing 'type' sub-element in the 'notifier' element in the POM.\n add.project.missing.notifier.configuration.error = Missing 'configuration' sub-element in the 'notifier' element in the POM.\n add.project.metadata.transfer.error = Transfer of Metadata has failed.\n add.project.unknown.error = The specified resource cannot be accessed. Please try again later or contact your administrator.\n@@ -333,6 +333,7 @@ schedules.table.name = Name\n schedules.table.description = Description\n schedules.table.delay = Quiet Period\n schedules.table.cronExpression = Cron Expression\n+schedules.table.maxJobExecutionTime = Max Job Time\n \n # ----------------------------------------------------------------------\n # Page: Add/EditSchedule\n@@ -348,6 +349,8 @@ schedule.description.label = Description\n schedule.description.message = Enter a description of the schedule\n schedule.cronExpression.label = Cron Expression\n schedule.cronExpression.message = Enter the cron expression. Format is described there : <a href=\"http://www.opensymphony.com/quartz/api/org/quartz/CronTrigger.html\" target=\"_blank\">Syntax<a>\n+schedule.maxJobExecutionTime.label = Maximum job execution time (seconds)\n+schedule.maxJobExecutionTime.message = Enter the maxmimum number of seconds a job may execute in this schedule before it's terminated.\n schedule.quietPeriod.label = Quiet Period (seconds)\n schedule.quietPeriod.message = Enter a quiet period period for this schedule\n schedule.enabled.label = Enabled",
                "deletions": 1
            },
            {
                "sha": "6fdf5077d7031b2afa94c669d1e3661b711397d3",
                "filename": "continuum-webapp/src/main/resources/xwork.xml",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/resources/xwork.xml",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/resources/xwork.xml",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/resources/xwork.xml?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -298,6 +298,9 @@\n       <result name=\"success\" type=\"chain\">schedules</result>\n     </action>\n \n+    <action name=\"cancelBuild\" class=\"cancelBuild\">\n+      <result name=\"success\" type=\"chain\">buildResults</result>\n+    </action>\n \n   </package>\n ",
                "deletions": 0
            },
            {
                "sha": "d896d90609e35164a568b8927f6834d7f31b4b94",
                "filename": "continuum-webapp/src/main/webapp/editSchedule.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/webapp/editSchedule.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/webapp/editSchedule.jsp",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/editSchedule.jsp?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -3,7 +3,7 @@\n <html>\n   <ww:i18n name=\"localization.Continuum\">\n <head>\n-<title><ww:text name=\"editSchedule.page.title\"/></title>              \n+<title><ww:text name=\"editSchedule.page.title\"/></title>\n </head>\n <body>\n <div class=\"app\">\n@@ -24,6 +24,9 @@\n             <ww:textfield label=\"%{getText('schedule.cronExpression.label')}\" name=\"cronExpression\" required=\"true\">\n                 <ww:param name=\"desc\"><p><ww:text name=\"schedule.cronExpression.message\"/></p></ww:param>\n             </ww:textfield>\n+            <ww:textfield label=\"%{getText('schedule.maxJobExecutionTime.label')}\" name=\"maxJobExecutionTime\" required=\"true\">\n+                <ww:param name=\"desc\"><p><ww:text name=\"schedule.maxJobExecutionTime.message\"/></p></ww:param>\n+            </ww:textfield>\n             <ww:textfield label=\"%{getText('schedule.quietPeriod.label')}\" name=\"delay\">\n                 <ww:param name=\"desc\"><p><ww:text name=\"schedule.quietPeriod.message\"/></p></ww:param>\n             </ww:textfield>",
                "deletions": 1
            },
            {
                "sha": "0d0a348e550f798d2b4e25fa663dcabd0b4325c0",
                "filename": "continuum-webapp/src/main/webapp/schedules.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/webapp/schedules.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/84aaf797fda2ebf4b6caa36b0d29341a4ab5b372/continuum-webapp/src/main/webapp/schedules.jsp",
                "status": "modified",
                "changes": 1,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/schedules.jsp?ref=84aaf797fda2ebf4b6caa36b0d29341a4ab5b372",
                "patch": "@@ -21,6 +21,7 @@\n             <ec:column property=\"description\" title=\"schedules.table.description\"/>\n             <ec:column property=\"delay\" title=\"schedules.table.delay\"/>\n             <ec:column property=\"cronExpression\" title=\"schedules.table.cronExpression\"/>\n+            <ec:column property=\"maxJobExecutionTime\" title=\"schedules.table.maxJobExecutionTime\"/>\n             <ec:column property=\"actions\" title=\"&nbsp;\">\n                 <ww:url id=\"editScheduleUrl\" action=\"schedule\">\n                   <ww:param name=\"id\" value=\"${pageScope.schedule.id}\"/>",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Refactored the DefaultBuildController to have better exception\nhandling. Cleaned up the code and added a BuildContext bean to store\nall build related information so it can be passed around to the different methods.\n\nThe rest is code cleanup:\n* Remove unused code (private methods that were not called, unused variables, unused imports)\n* Recorganize declarations of local variables to their proper scope\n* Fix possible NPE's\n* Remove bogus null/non-null checks.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@430587 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/ec0736031a9430cdff926f0e153f1ce0e045bd4b",
        "parent": "https://github.com/apache/continuum/commit/d90c5caea4dab0842272f05bda21302b43d23c95",
        "bug_id": "continuum_73",
        "file": [
            {
                "sha": "1f1d9b88e176e8b462939dc5871b8dd0fb611b44",
                "filename": "continuum-cc/src/main/java/org/apache/maven/continuum/project/builder/cc/CruiseControlProjectBuilder.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-cc/src/main/java/org/apache/maven/continuum/project/builder/cc/CruiseControlProjectBuilder.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-cc/src/main/java/org/apache/maven/continuum/project/builder/cc/CruiseControlProjectBuilder.java",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-cc/src/main/java/org/apache/maven/continuum/project/builder/cc/CruiseControlProjectBuilder.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -280,6 +280,9 @@ else if ( modifactionset.getName().equals( \"svn\" ) )\n                     \"Unsupported modification set found '\" + modifactionset.getName() + \"'.\" );\n             }\n \n+            // FIXME: this break ensures that null-checks for scmURL above\n+            // are useless - scmURL is always null. Either remove the break or drop\n+            // the checks.\n             break;\n         }\n ",
                "deletions": 0
            },
            {
                "sha": "84d79d3d21d94d9a2f434d2dc4ea482649ea9fce",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java",
                "status": "modified",
                "changes": 104,
                "additions": 55,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/DefaultContinuum.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -24,9 +24,7 @@\n import org.apache.maven.continuum.configuration.ConfigurationService;\n import org.apache.maven.continuum.configuration.ConfigurationStoringException;\n import org.apache.maven.continuum.core.action.AbstractContinuumAction;\n-import org.apache.maven.continuum.core.action.AddProjectToCheckOutQueueAction;\n import org.apache.maven.continuum.core.action.CreateProjectsFromMetadata;\n-import org.apache.maven.continuum.core.action.StoreProjectAction;\n import org.apache.maven.continuum.execution.ContinuumBuildExecutor;\n import org.apache.maven.continuum.execution.manager.BuildExecutorManager;\n import org.apache.maven.continuum.initialization.ContinuumInitializationException;\n@@ -156,8 +154,6 @@\n \n     public DefaultContinuum()\n     {\n-        super();\n-\n         Runtime.getRuntime().addShutdownHook( new Thread()\n         {\n             public void run()\n@@ -342,7 +338,7 @@ public void checkoutProject( int projectId )\n     {\n         Map context = new HashMap();\n \n-        context.put( AddProjectToCheckOutQueueAction.KEY_PROJECT_ID, new Integer( projectId ) );\n+        context.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n \n         executeAction( \"add-project-to-checkout-queue\", context );\n     }\n@@ -402,8 +398,8 @@ public void buildProjects( int trigger )\n \n             if ( buildDefId == null )\n             {\n-                throw new ContinuumException(\n-                    \"Project (id=\" + project.getId() + \" doens't have a default build definition.\" );\n+                throw new ContinuumException( \"Project (id=\" + project.getId()\n+                    + \" doens't have a default build definition.\" );\n             }\n \n             buildProject( project, buildDefId.intValue(), trigger );\n@@ -424,6 +420,7 @@ public void buildProjects( Schedule schedule )\n             if ( projectsMap == null )\n             {\n                 // We don't have projects attached to this schedule\n+                getLogger().info( \"No projects to build for schedule \" + schedule );\n                 return;\n             }\n \n@@ -440,25 +437,34 @@ public void buildProjects( Schedule schedule )\n             projectsList = getProjects();\n         }\n \n+        getLogger().info( \"Building \" + projectsList.size() + \" projects\" );\n+\n         for ( Iterator projectIterator = projectsList.iterator(); projectIterator.hasNext(); )\n         {\n             Project project = (Project) projectIterator.next();\n \n+            // FIXME: if store.getProjectIdsAndBuildDefinitionsIdsBySchedule above throws a CycleDetectedException,\n+            // then projectsMap is null.\n             List buildDefIds = (List) projectsMap.get( new Integer( project.getId() ) );\n \n             if ( buildDefIds != null && !buildDefIds.isEmpty() )\n             {\n+                getLogger().info( \"Processing \" + buildDefIds.size() + \" build definitions for project \" + project );\n                 for ( Iterator buildDefinitionIterator = buildDefIds.iterator(); buildDefinitionIterator.hasNext(); )\n                 {\n                     Integer buildDefId = (Integer) buildDefinitionIterator.next();\n \n-                    if ( buildDefId != null && !isInBuildingQueue( project.getId(), buildDefId.intValue() ) &&\n-                        !isInCheckoutQueue( project.getId() ) )\n+                    if ( buildDefId != null && !isInBuildingQueue( project.getId(), buildDefId.intValue() )\n+                        && !isInCheckoutQueue( project.getId() ) )\n                     {\n                         buildProject( project, buildDefId.intValue(), ContinuumProjectState.TRIGGER_SCHEDULED, false );\n                     }\n                 }\n             }\n+            else\n+            {\n+                getLogger().info( \"No build definitions, not building for project \" + project );\n+            }\n         }\n     }\n \n@@ -474,7 +480,6 @@ public void buildProjectWithBuildDefinition( int projectId, int buildDefinitionI\n         buildProject( projectId, buildDefinitionId, ContinuumProjectState.TRIGGER_FORCED );\n     }\n \n-\n     public void buildProject( int projectId, int trigger )\n         throws ContinuumException\n     {\n@@ -535,10 +540,10 @@ private synchronized void buildProject( Project project, int buildDefinitionId,\n \n         try\n         {\n-            if ( project.getState() != ContinuumProjectState.NEW &&\n-                project.getState() != ContinuumProjectState.CHECKEDOUT &&\n-                project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED &&\n-                project.getState() != ContinuumProjectState.ERROR )\n+            if ( project.getState() != ContinuumProjectState.NEW\n+                && project.getState() != ContinuumProjectState.CHECKEDOUT\n+                && project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED\n+                && project.getState() != ContinuumProjectState.ERROR )\n             {\n                 ContinuumBuildExecutor executor = executorManager.getBuildExecutor( project.getExecutorId() );\n \n@@ -559,8 +564,7 @@ private synchronized void buildProject( Project project, int buildDefinitionId,\n                 }\n             }\n \n-            getLogger().info(\n-                \"Enqueuing '\" + project.getName() + \"' (Build definition id=\" + buildDefinitionId + \").\" );\n+            getLogger().info( \"Enqueuing '\" + project.getName() + \"' (Build definition id=\" + buildDefinitionId + \").\" );\n \n             buildQueue.put( new BuildProjectTask( project.getId(), buildDefinitionId, trigger ) );\n         }\n@@ -763,7 +767,7 @@ private int executeAddProjectFromScmActivity( Project project )\n         //\n         // ----------------------------------------------------------------------\n \n-        context.put( CreateProjectsFromMetadata.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n+        context.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n \n         context.put( AbstractContinuumAction.KEY_UNVALIDATED_PROJECT, project );\n \n@@ -782,7 +786,7 @@ private int executeAddProjectFromScmActivity( Project project )\n \n         executeAction( \"add-project-to-checkout-queue\", context );\n \n-        return ( (Integer) context.get( StoreProjectAction.KEY_PROJECT_ID ) ).intValue();\n+        return ( (Integer) context.get( AbstractContinuumAction.KEY_PROJECT_ID ) ).intValue();\n     }\n \n     private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( String metadataUrl,\n@@ -795,16 +799,16 @@ private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( S\n \n         context.put( CreateProjectsFromMetadata.KEY_URL, metadataUrl );\n \n-        context.put( CreateProjectsFromMetadata.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n+        context.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n \n         // ----------------------------------------------------------------------\n         // Create the projects from the URL\n         // ----------------------------------------------------------------------\n \n         executeAction( \"create-projects-from-metadata\", context );\n \n-        ContinuumProjectBuildingResult result =\n-            (ContinuumProjectBuildingResult) context.get( CreateProjectsFromMetadata.KEY_PROJECT_BUILDING_RESULT );\n+        ContinuumProjectBuildingResult result = (ContinuumProjectBuildingResult) context\n+            .get( CreateProjectsFromMetadata.KEY_PROJECT_BUILDING_RESULT );\n \n         if ( result.getProjects() != null )\n         {\n@@ -849,15 +853,16 @@ private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( S\n                 projectGroup = store.getProjectGroupByGroupIdWithProjects( projectGroup.getGroupId() );\n \n                 getLogger().info(\n-                    \"Using existing project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n+                                  \"Using existing project group with the group id: '\" + projectGroup.getGroupId()\n+                                      + \"'.\" );\n             }\n             catch ( ContinuumObjectNotFoundException e )\n             {\n                 getLogger().info( \"Creating project group with the group id: '\" + projectGroup.getGroupId() + \"'.\" );\n \n                 Map pgContext = new HashMap();\n \n-                pgContext.put( CreateProjectsFromMetadata.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n+                pgContext.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, getWorkingDirectory() );\n \n                 pgContext.put( AbstractContinuumAction.KEY_UNVALIDATED_PROJECT_GROUP, projectGroup );\n \n@@ -900,11 +905,11 @@ private ContinuumProjectBuildingResult executeAddProjectsFromMetadataActivity( S\n                 context = new HashMap();\n \n                 context.put( AbstractContinuumAction.KEY_UNVALIDATED_PROJECT, project );\n-//\n-//            executeAction( \"validate-project\", context );\n-//\n-//            executeAction( \"store-project\", context );\n-//\n+                //\n+                //            executeAction( \"validate-project\", context );\n+                //\n+                //            executeAction( \"store-project\", context );\n+                //\n                 context.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( project.getId() ) );\n \n                 executeAction( \"add-project-to-checkout-queue\", context );\n@@ -992,8 +997,8 @@ private Properties createNotifierProperties( Map configuration )\n             if ( value instanceof String )\n             {\n                 String val = (String) value;\n-                if ( !\"sendOnSuccess\".equals( val ) && !\"sendOnFailure\".equals( val ) && !\"sendOnError\".equals( val ) &&\n-                    !\"sendOnWarning\".equals( val ) )\n+                if ( !\"sendOnSuccess\".equals( val ) && !\"sendOnFailure\".equals( val ) && !\"sendOnError\".equals( val )\n+                    && !\"sendOnWarning\".equals( val ) )\n                 {\n                     if ( !StringUtils.isEmpty( val ) )\n                     {\n@@ -1541,8 +1546,8 @@ public void updateConfiguration( Map configuration )\n \n             if ( configuration.get( \"conf.workingDirectory\" ) != null )\n             {\n-                configurationService.setWorkingDirectory(\n-                    configurationService.getFile( (String) configuration.get( \"conf.workingDirectory\" ) ) );\n+                configurationService.setWorkingDirectory( configurationService.getFile( (String) configuration\n+                    .get( \"conf.workingDirectory\" ) ) );\n             }\n             else\n             {\n@@ -1551,8 +1556,8 @@ public void updateConfiguration( Map configuration )\n \n             if ( configuration.get( \"conf.buildOutputDirectory\" ) != null )\n             {\n-                configurationService.setBuildOutputDirectory(\n-                    configurationService.getFile( (String) configuration.get( \"conf.buildOutputDirectory\" ) ) );\n+                configurationService.setBuildOutputDirectory( configurationService.getFile( (String) configuration\n+                    .get( \"conf.buildOutputDirectory\" ) ) );\n             }\n             else\n             {\n@@ -1561,8 +1566,8 @@ public void updateConfiguration( Map configuration )\n \n             if ( configuration.get( \"conf.deploymentRepositoryDirectory\" ) != null )\n             {\n-                configurationService.setDeploymentRepositoryDirectory( configurationService.getFile(\n-                    (String) configuration.get( \"conf.deploymentRepositoryDirectory\" ) ) );\n+                configurationService.setDeploymentRepositoryDirectory( configurationService\n+                    .getFile( (String) configuration.get( \"conf.deploymentRepositoryDirectory\" ) ) );\n             }\n \n             if ( configuration.get( \"conf.url\" ) != null )\n@@ -1909,16 +1914,16 @@ public void initialize()\n         {\n             if ( !wdFile.isDirectory() )\n             {\n-                throw new InitializationException(\n-                    \"The specified working directory isn't a directory: \" + \"'\" + wdFile.getAbsolutePath() + \"'.\" );\n+                throw new InitializationException( \"The specified working directory isn't a directory: \" + \"'\"\n+                    + wdFile.getAbsolutePath() + \"'.\" );\n             }\n         }\n         else\n         {\n             if ( !wdFile.mkdirs() )\n             {\n-                throw new InitializationException(\n-                    \"Could not making the working directory: \" + \"'\" + wdFile.getAbsolutePath() + \"'.\" );\n+                throw new InitializationException( \"Could not making the working directory: \" + \"'\"\n+                    + wdFile.getAbsolutePath() + \"'.\" );\n             }\n         }\n \n@@ -1945,10 +1950,10 @@ public void initialize()\n                 }\n             }\n \n-            if ( project.getState() != ContinuumProjectState.NEW &&\n-                project.getState() != ContinuumProjectState.CHECKEDOUT &&\n-                project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED &&\n-                project.getState() != ContinuumProjectState.ERROR )\n+            if ( project.getState() != ContinuumProjectState.NEW\n+                && project.getState() != ContinuumProjectState.CHECKEDOUT\n+                && project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED\n+                && project.getState() != ContinuumProjectState.ERROR )\n             {\n                 int state = project.getState();\n \n@@ -1958,8 +1963,9 @@ public void initialize()\n \n                 try\n                 {\n-                    getLogger().info( \"Fix project state for project \" + project.getId() + \":\" + project.getName() +\n-                        \":\" + project.getVersion() );\n+                    getLogger().info(\n+                                      \"Fix project state for project \" + project.getId() + \":\" + project.getName()\n+                                          + \":\" + project.getVersion() );\n \n                     store.updateProject( project );\n \n@@ -1976,8 +1982,9 @@ public void initialize()\n                 }\n             }\n \n-            getLogger().info( \" \" + project.getId() + \":\" + project.getName() + \":\" + project.getVersion() + \":\" +\n-                project.getExecutorId() );\n+            getLogger().info(\n+                              \" \" + project.getId() + \":\" + project.getName() + \":\" + project.getVersion() + \":\"\n+                                  + project.getExecutorId() );\n         }\n     }\n \n@@ -2282,7 +2289,6 @@ public Collection getProjectsInGroup( int projectGroupId )\n         }\n     }\n \n-\n     // ----------------------------------------------------------------------\n     // Private Utilities\n     // ----------------------------------------------------------------------",
                "deletions": 49
            },
            {
                "sha": "0c6d3631bc9a1298b0ade67f5bc1163c65d914ee",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildContext.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildContext.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildContext.java",
                "status": "added",
                "changes": 129,
                "additions": 129,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildContext.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -0,0 +1,129 @@\n+package org.apache.maven.continuum.buildcontroller;\n+\n+import org.apache.maven.continuum.core.action.AbstractContinuumAction;\n+import org.apache.maven.continuum.model.project.BuildDefinition;\n+import org.apache.maven.continuum.model.project.BuildResult;\n+import org.apache.maven.continuum.model.project.Project;\n+import org.apache.maven.continuum.model.scm.ScmResult;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+/**\n+ *\n+ * This class holds build context information.\n+ *\n+ * @author <a href=\"mailto:kenney@apache.org\">Kenney Westerhof</a>\n+ *\n+ */\n+public class BuildContext\n+{\n+\n+    private long startTime;\n+\n+    private Project project;\n+\n+    private BuildDefinition buildDefinition;\n+\n+    private BuildResult oldBuildResult;\n+\n+    private ScmResult oldScmResult;\n+\n+    private Map actionContext;\n+\n+    private ScmResult scmResult;\n+\n+    private int trigger;\n+\n+    private BuildResult buildResult;\n+\n+    public void setStartTime( long startTime )\n+    {\n+        this.startTime = startTime;\n+    }\n+\n+    public long getStartTime()\n+    {\n+        return startTime;\n+    }\n+\n+    public void setProject( Project project )\n+    {\n+        this.project = project;\n+    }\n+\n+    public Project getProject()\n+    {\n+        return project;\n+    }\n+\n+    public void setBuildDefinition( BuildDefinition buildDefinition )\n+    {\n+        this.buildDefinition = buildDefinition;\n+    }\n+\n+    public BuildDefinition getBuildDefinition()\n+    {\n+        return buildDefinition;\n+    }\n+\n+    public void setBuildResult( BuildResult build )\n+    {\n+        this.buildResult = build;\n+    }\n+\n+    public BuildResult getBuildResult()\n+    {\n+        return buildResult;\n+    }\n+\n+    public void setOldBuildResult( BuildResult buildResult )\n+    {\n+        this.oldBuildResult = buildResult;\n+    }\n+\n+    public BuildResult getOldBuildResult()\n+    {\n+        return oldBuildResult;\n+    }\n+\n+    public void setOldScmResult( ScmResult oldScmResult )\n+    {\n+        this.oldScmResult = oldScmResult;\n+    }\n+\n+    public ScmResult getOldScmResult()\n+    {\n+        return oldScmResult;\n+    }\n+\n+    public void setScmResult( ScmResult scmResult )\n+    {\n+        this.scmResult = scmResult;\n+    }\n+\n+    public ScmResult getScmResult()\n+    {\n+        return scmResult;\n+    }\n+\n+    public Map getActionContext()\n+    {\n+        if ( actionContext == null )\n+        {\n+            actionContext = new HashMap();\n+        }\n+        return actionContext;\n+    }\n+\n+    public int getTrigger()\n+    {\n+        return trigger;\n+    }\n+\n+    public void setTrigger( int trigger )\n+    {\n+        this.trigger = trigger;\n+    }\n+\n+}",
                "deletions": 0
            },
            {
                "sha": "923aad990400d345553f18fe59c85f06fc5bb20e",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildController.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/BuildController.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -1,5 +1,7 @@\n package org.apache.maven.continuum.buildcontroller;\n \n+import org.codehaus.plexus.taskqueue.execution.TaskExecutionException;\n+\n /*\n  * Copyright 2004-2005 The Apache Software Foundation.\n  *\n@@ -24,5 +26,6 @@\n {\n     String ROLE = BuildController.class.getName();\n \n-    void build( int projectId, int buildDefinitionId, int trigger );\n+    void build( int projectId, int buildDefinitionId, int trigger )\n+        throws TaskExecutionException;\n }",
                "deletions": 1
            },
            {
                "sha": "cd985c6babc520f7a337472234c8c08a1fbd722a",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java",
                "status": "modified",
                "changes": 619,
                "additions": 381,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/buildcontroller/DefaultBuildController.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -26,15 +26,17 @@\n import org.apache.maven.continuum.notification.ContinuumNotificationDispatcher;\n import org.apache.maven.continuum.project.ContinuumProjectState;\n import org.apache.maven.continuum.scm.ContinuumScmException;\n+import org.apache.maven.continuum.store.ContinuumObjectNotFoundException;\n import org.apache.maven.continuum.store.ContinuumStore;\n import org.apache.maven.continuum.store.ContinuumStoreException;\n import org.apache.maven.continuum.utils.ContinuumUtils;\n import org.apache.maven.continuum.utils.WorkingDirectoryService;\n import org.codehaus.plexus.action.ActionManager;\n+import org.codehaus.plexus.action.ActionNotFoundException;\n import org.codehaus.plexus.logging.AbstractLogEnabled;\n+import org.codehaus.plexus.taskqueue.execution.TaskExecutionException;\n import org.codehaus.plexus.util.StringUtils;\n \n-import java.util.HashMap;\n import java.util.Iterator;\n import java.util.List;\n import java.util.Map;\n@@ -72,311 +74,387 @@\n     // ----------------------------------------------------------------------\n \n     /**\n+     * @throws TaskExecutionException\n      * @todo structure of this method is a bit of a mess (too much exception/finally code)\n      */\n     public void build( int projectId, int buildDefinitionId, int trigger )\n+        throws TaskExecutionException\n     {\n-        long startTime = System.currentTimeMillis();\n+        getLogger().info( \"Initializing build\" );\n+        BuildContext context = initializeBuildContext( projectId, buildDefinitionId, trigger );\n \n-        // ----------------------------------------------------------------------\n-        // Initialize the context\n-        // ----------------------------------------------------------------------\n+        getLogger().info( \"Starting build\" );\n+        startBuild( context );\n \n-        // if these calls fail we're screwed anyway\n-        // and it will only be logged through the logger.\n+        try\n+        {\n+            // ----------------------------------------------------------------------\n+            // TODO: Centralize the error handling from the SCM related actions.\n+            // ContinuumScmResult should return a ContinuumScmResult from all\n+            // methods, even in a case of failure.\n+            // ----------------------------------------------------------------------\n+            getLogger().info( \"Updating working dir\" );\n+            updateWorkingDirectory( context );\n+\n+            getLogger().info( \"Merging SCM results\" );\n+            mergeScmResults( context );\n+\n+            if ( !checkScmResult( context ) )\n+            {\n+                getLogger().info( \"Error updating from SCM, not building\" );\n+                return;\n+            }\n \n-        Project project;\n+            if ( !shouldBuild( context ) )\n+            {\n+                getLogger().info( \"No changes, not building\" );\n+                return;\n+            }\n \n-        BuildDefinition buildDefinition;\n+            getLogger().info( \"Changes found, building\" );\n \n-        BuildResult oldBuildResult = null;\n+            Map actionContext = context.getActionContext();\n \n-        BuildResult build = null;\n+            performAction( \"update-project-from-working-directory\", context );\n \n-        try\n-        {\n-            project = store.getProject( projectId );\n+            performAction( \"execute-builder\", context );\n \n-            project.setOldState( project.getState() );\n+            performAction( \"deploy-artifact\", context );\n \n-            project.setState( ContinuumProjectState.BUILDING );\n+            String s = (String) actionContext.get( AbstractContinuumAction.KEY_BUILD_ID );\n \n-            store.updateProject( project );\n+            if ( s != null )\n+            {\n+                try\n+                {\n+                    context.setBuildResult( store.getBuildResult( Integer.valueOf( s ).intValue() ) );\n+                }\n+                catch ( NumberFormatException e )\n+                {\n+                    throw new TaskExecutionException( \"Internal error: build id not an integer\", e );\n+                }\n+                catch ( ContinuumObjectNotFoundException e )\n+                {\n+                    throw new TaskExecutionException( \"Internal error: Cannot find build result\", e );\n+                }\n+                catch ( ContinuumStoreException e )\n+                {\n+                    throw new TaskExecutionException( \"Error loading build result\", e );\n+                }\n+            }\n+        }\n+        finally\n+        {\n+            endBuild( context );\n+        }\n+    }\n \n-            buildDefinition = store.getBuildDefinition( buildDefinitionId );\n+    /**\n+     * Checks if the build should be marked as ERROR and notifies\n+     * the end of the build.\n+     *\n+     * @param context\n+     * @throws TaskExecutionException\n+     */\n+    private void endBuild( BuildContext context )\n+        throws TaskExecutionException\n+    {\n+        Project project = context.getProject();\n \n-            notifierDispatcher.buildStarted( project );\n-        }\n-        catch ( ContinuumStoreException ex )\n+        if ( project.getState() != ContinuumProjectState.NEW && project.getState() != ContinuumProjectState.CHECKEDOUT\n+            && project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED\n+            && project.getState() != ContinuumProjectState.ERROR )\n         {\n-            getLogger().error( \"Internal error while getting the project.\", ex );\n+            try\n+            {\n+                project.setState( ContinuumProjectState.ERROR );\n \n-            return;\n+                store.updateProject( project );\n+            }\n+            catch ( ContinuumStoreException e )\n+            {\n+                throw new TaskExecutionException( \"Error storing the project\", e );\n+            }\n+            finally\n+            {\n+                notifierDispatcher.buildComplete( project, context.getBuildResult() );\n+            }\n         }\n+    }\n+\n+    private void updateBuildResult( BuildContext context, String error )\n+        throws TaskExecutionException\n+    {\n+        BuildResult build = context.getBuildResult();\n+\n+        build.setError( error );\n \n         try\n         {\n-            oldBuildResult = store.getBuildResult( buildDefinition.getLatestBuildId() );\n+            store.updateBuildResult( build );\n+\n+            build = store.getBuildResult( build.getId() );\n         }\n-        catch ( ContinuumStoreException ex )\n+        catch ( ContinuumStoreException e )\n         {\n-            // Nothing to do\n+            throw new TaskExecutionException( \"Error updating build result\", e );\n         }\n \n-        ScmResult oldScmResult = null;\n+        context.getProject().setState( build.getState() );\n \n-        if ( oldBuildResult != null )\n+        try\n         {\n-            oldScmResult = getOldScmResult( project, oldBuildResult.getEndTime() );\n+            store.updateProject( context.getProject() );\n         }\n-\n-        // ----------------------------------------------------------------------\n-        // TODO: Centralize the error handling from the SCM related actions.\n-        // ContinuumScmResult should return a ContinuumScmResult from all\n-        // methods, even in a case of failure.\n-        // ----------------------------------------------------------------------\n-\n-        try\n+        catch ( ContinuumStoreException e )\n         {\n-            Map actionContext = new HashMap();\n-\n-            actionContext.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n-\n-            actionContext.put( AbstractContinuumAction.KEY_PROJECT, project );\n-\n-            actionContext.put( AbstractContinuumAction.KEY_BUILD_DEFINITION_ID, new Integer( buildDefinitionId ) );\n-\n-            actionContext.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, buildDefinition );\n-\n-            actionContext.put( AbstractContinuumAction.KEY_TRIGGER, new Integer( trigger ) );\n-\n-            actionContext.put( AbstractContinuumAction.KEY_FIRST_RUN, Boolean.valueOf( oldBuildResult == null ) );\n-\n-            ScmResult scmResult = null;\n-\n-            try\n-            {\n-                actionManager.lookup( \"check-working-directory\" ).execute( actionContext );\n-\n-                boolean workingDirectoryExists = AbstractContinuumAction.getBoolean( actionContext,\n-                                                                                     AbstractContinuumAction.KEY_WORKING_DIRECTORY_EXISTS );\n+            throw new TaskExecutionException( \"Error updating project\", e );\n+        }\n+    }\n \n-                if ( workingDirectoryExists )\n-                {\n-                    actionManager.lookup( \"update-working-directory-from-scm\" ).execute( actionContext );\n+    private void startBuild( BuildContext context )\n+        throws TaskExecutionException\n+    {\n \n-                    scmResult = AbstractContinuumAction.getUpdateScmResult( actionContext, null );\n-                }\n-                else\n-                {\n-                    actionContext.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY,\n-                                       workingDirectoryService.getWorkingDirectory( project ).getAbsolutePath() );\n+        Project project = context.getProject();\n \n-                    actionManager.lookup( \"checkout-project\" ).execute( actionContext );\n+        project.setOldState( project.getState() );\n \n-                    scmResult = AbstractContinuumAction.getCheckoutResult( actionContext, null );\n-                }\n+        project.setState( ContinuumProjectState.BUILDING );\n \n-                // ----------------------------------------------------------------------\n-                // Check to see if there was a error while checking out/updating the project\n-                // ----------------------------------------------------------------------\n+        try\n+        {\n+            store.updateProject( project );\n+        }\n+        catch ( ContinuumStoreException e )\n+        {\n+            throw new TaskExecutionException( \"Error persisting project\", e );\n+        }\n \n-                // Merge scm results so we'll have all changes since last execution of current build definition\n-                scmResult = mergeScmResults( oldScmResult, scmResult );\n+        notifierDispatcher.buildStarted( project );\n \n-                if ( scmResult == null || !scmResult.isSuccess() )\n-                {\n-                    // scmResult must be converted before sotring it because jpox modify value of all fields to null\n-                    String error = convertScmResultToError( scmResult );\n+    }\n \n-                    build = makeAndStoreBuildResult( project, scmResult, startTime, trigger );\n+    /**\n+     * Initializes a BuildContext for the build.\n+     *\n+     * @param projectId\n+     * @param buildDefinitionId\n+     * @param trigger\n+     * @return\n+     * @throws TaskExecutionException\n+     */\n+    private BuildContext initializeBuildContext( int projectId, int buildDefinitionId, int trigger )\n+        throws TaskExecutionException\n+    {\n+        BuildContext context = new BuildContext();\n \n-                    build.setError( error );\n+        context.setStartTime( System.currentTimeMillis() );\n \n-                    store.updateBuildResult( build );\n+        context.setTrigger( trigger );\n \n-                    build = store.getBuildResult( build.getId() );\n+        try\n+        {\n+            context.setProject( store.getProject( projectId ) );\n \n-                    project.setState( build.getState() );\n+            BuildDefinition buildDefinition = store.getBuildDefinition( buildDefinitionId );\n \n-                    store.updateProject( project );\n+            context.setBuildDefinition( buildDefinition );\n \n-                    return;\n-                }\n+            try\n+            {\n+                BuildResult oldBuildResult = store.getBuildResult( buildDefinition.getLatestBuildId() );\n \n-                actionContext.put( AbstractContinuumAction.KEY_UPDATE_SCM_RESULT, scmResult );\n+                context.setOldBuildResult( oldBuildResult );\n \n-                List changes = scmResult.getChanges();\n+                context.setOldScmResult( getOldScmResult( projectId, oldBuildResult.getEndTime() ) );\n \n-                Iterator iterChanges = changes.iterator();\n+            }\n+            catch ( ContinuumObjectNotFoundException ex )\n+            {\n+                // Nothing to do\n+            }\n+        }\n+        catch ( ContinuumStoreException e )\n+        {\n+            throw new TaskExecutionException( \"Error initializing the build context\", e );\n+        }\n \n-                ChangeSet changeSet;\n+        Map actionContext = context.getActionContext();\n \n-                List changeFiles;\n+        actionContext.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n \n-                Iterator iterFiles;\n+        actionContext.put( AbstractContinuumAction.KEY_PROJECT, context.getProject() );\n \n-                ChangeFile changeFile;\n+        actionContext.put( AbstractContinuumAction.KEY_BUILD_DEFINITION_ID, new Integer( buildDefinitionId ) );\n \n-                boolean allChangesUnknown = true;\n+        actionContext.put( AbstractContinuumAction.KEY_BUILD_DEFINITION, context.getBuildDefinition() );\n \n-                while ( iterChanges.hasNext() )\n-                {\n-                    changeSet = (ChangeSet) iterChanges.next();\n+        actionContext.put( AbstractContinuumAction.KEY_TRIGGER, new Integer( trigger ) );\n \n-                    changeFiles = changeSet.getFiles();\n+        actionContext\n+            .put( AbstractContinuumAction.KEY_FIRST_RUN, Boolean.valueOf( context.getOldBuildResult() == null ) );\n \n-                    iterFiles = changeFiles.iterator();\n+        return context;\n+    }\n \n-                    while ( iterFiles.hasNext() )\n-                    {\n-                        changeFile = (ChangeFile) iterFiles.next();\n+    private void updateWorkingDirectory( BuildContext buildContext )\n+        throws TaskExecutionException\n+    {\n+        Map actionContext = buildContext.getActionContext();\n \n-                        if ( !\"unknown\".equalsIgnoreCase( changeFile.getStatus() ) )\n-                        {\n-                            allChangesUnknown = false;\n-                            break;\n-                        }\n-                    }\n+        performAction( \"check-working-directory\", buildContext );\n \n-                    if ( !allChangesUnknown )\n-                    {\n-                        break;\n-                    }\n-                }\n+        boolean workingDirectoryExists = AbstractContinuumAction\n+            .getBoolean( actionContext, AbstractContinuumAction.KEY_WORKING_DIRECTORY_EXISTS );\n \n-                if ( oldBuildResult != null && allChangesUnknown &&\n-                    project.getOldState() != ContinuumProjectState.NEW &&\n-                    project.getOldState() != ContinuumProjectState.CHECKEDOUT &&\n-                    trigger != ContinuumProjectState.TRIGGER_FORCED &&\n-                    project.getState() != ContinuumProjectState.NEW &&\n-                    project.getState() != ContinuumProjectState.CHECKEDOUT )\n-                {\n-                    if ( changes.size() > 0 )\n-                    {\n-                        getLogger().info( \"The project was not built because all changes are unknown.\" );\n-                    }\n-                    else\n-                    {\n-                        getLogger().info( \"The project was not built because there are no changes.\" );\n-                    }\n+        ScmResult scmResult;\n \n-                    project.setState( project.getOldState() );\n+        if ( workingDirectoryExists )\n+        {\n+            performAction( \"update-working-directory-from-scm\", buildContext );\n \n-                    project.setOldState( 0 );\n+            scmResult = AbstractContinuumAction.getUpdateScmResult( actionContext, null );\n+        }\n+        else\n+        {\n+            Project project = (Project) actionContext.get( AbstractContinuumAction.KEY_PROJECT );\n \n-                    store.updateProject( project );\n+            actionContext.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, workingDirectoryService\n+                .getWorkingDirectory( project ).getAbsolutePath() );\n \n-                    return;\n-                }\n+            performAction( \"checkout-project\", buildContext );\n \n-                actionManager.lookup( \"update-project-from-working-directory\" ).execute( actionContext );\n+            scmResult = AbstractContinuumAction.getCheckoutResult( actionContext, null );\n+        }\n \n-                actionManager.lookup( \"execute-builder\" ).execute( actionContext );\n+        buildContext.setScmResult( scmResult );\n+    }\n \n-                actionManager.lookup( \"deploy-artifact\" ).execute( actionContext );\n+    private void performAction( String actionName, BuildContext context )\n+        throws TaskExecutionException\n+    {\n+        String error = null;\n+        TaskExecutionException exception = null;\n \n-                String s = (String) actionContext.get( AbstractContinuumAction.KEY_BUILD_ID );\n+        try\n+        {\n+            getLogger().info( \"Performing action \" + actionName );\n+            actionManager.lookup( actionName ).execute( context.getActionContext() );\n+            return;\n+        }\n+        catch ( ActionNotFoundException e )\n+        {\n+            error = ContinuumUtils.throwableToString( e );\n+            exception = new TaskExecutionException( \"Error looking up action '\" + actionName + \"'\", e );\n+        }\n+        catch ( ContinuumScmException e )\n+        {\n+            ScmResult result = e.getResult();\n \n-                if ( s != null )\n-                {\n-                    build = store.getBuildResult( Integer.valueOf( s ).intValue() );\n-                }\n-            }\n-            catch ( Throwable e )\n+            if ( result != null )\n             {\n-                getLogger().error( \"Error while building project.\", e );\n-\n-                String s = (String) actionContext.get( AbstractContinuumAction.KEY_BUILD_ID );\n-\n-                if ( s != null )\n-                {\n-                    build = store.getBuildResult( Integer.valueOf( s ).intValue() );\n-                }\n-                else\n-                {\n-                    build = makeAndStoreBuildResult( project, scmResult, startTime, trigger );\n-                }\n-\n-                // This can happen if the \"update project from scm\" action fails\n-\n-                String error = null;\n+                error = convertScmResultToError( result );\n+            }\n \n-                if ( e instanceof ContinuumScmException )\n-                {\n-                    ContinuumScmException ex = (ContinuumScmException) e;\n+            if ( error == null )\n+            {\n+                error = ContinuumUtils.throwableToString( e );\n+            }\n \n-                    ScmResult result = ex.getResult();\n+            exception = new TaskExecutionException( \"SCM error while executing '\" + actionName + \"'\", e );\n+        }\n+        catch ( Exception e )\n+        {\n+            exception = new TaskExecutionException( \"Error executing action '\" + actionName + \"'\", e );\n+        }\n \n-                    if ( result != null )\n-                    {\n-                        error = convertScmResultToError( result );\n-                    }\n+        // TODO: clean this up. We catch the original exception from the action, and then update the buildresult\n+        // for it - we need to because of the specialized error message for SCM.\n+        // If updating the buildresult fails, log the previous error and throw the new one.\n+        // If updating the buildresult succeeds, throw the original exception. The build result should NOT\n+        // be updated again - a TaskExecutionException is final, no further action should be taken upon it.\n \n-                }\n-                if ( error == null )\n-                {\n-                    error = ContinuumUtils.throwableToString( e );\n-                }\n+        try\n+        {\n+            updateBuildResult( context, error );\n+        }\n+        catch ( TaskExecutionException e )\n+        {\n+            getLogger().error( \"Error updating build result after receiving the following exception: \", exception );\n+            throw e;\n+        }\n \n-                build.setError( error );\n+        throw exception;\n+    }\n \n-                store.updateBuildResult( build );\n+    private boolean shouldBuild( BuildContext context )\n+        throws TaskExecutionException\n+    {\n+        //oldBuildResult != null &&\n+        //        List changes, Project project, int trigger )\n+        //        scmResult.getChanges(), project, trigger ) )\n \n-                build = store.getBuildResult( build.getId() );\n+        boolean allChangesUnknown = checkAllChangesUnknown( context.getScmResult().getChanges() );\n \n-                project.setState( build.getState() );\n+        Project project = context.getProject();\n \n-                store.updateProject( project );\n-            }\n-        }\n-        catch ( Exception ex )\n+        if ( allChangesUnknown && project.getOldState() != ContinuumProjectState.NEW\n+            && project.getOldState() != ContinuumProjectState.CHECKEDOUT\n+            && context.getTrigger() != ContinuumProjectState.TRIGGER_FORCED\n+            && project.getState() != ContinuumProjectState.NEW\n+            && project.getState() != ContinuumProjectState.CHECKEDOUT )\n         {\n-            if ( !Thread.interrupted() )\n+            if ( context.getScmResult().getChanges().size() > 0 )\n             {\n-                getLogger().error( \"Internal error while building the project.\", ex );\n+                getLogger().info( \"The project was not built because all changes are unknown.\" );\n+            }\n+            else\n+            {\n+                getLogger().info( \"The project was not built because there are no changes.\" );\n             }\n \n-            String error = ContinuumUtils.throwableToString( ex );\n+            project.setState( project.getOldState() );\n \n-            build.setError( error );\n+            project.setOldState( 0 );\n \n             try\n             {\n-                store.updateBuildResult( build );\n-\n-                build = store.getBuildResult( build.getId() );\n-\n-                project.setState( build.getState() );\n-\n                 store.updateProject( project );\n             }\n-            catch ( Exception e )\n+            catch ( ContinuumStoreException e )\n             {\n-                getLogger().error( \"Can't store updating project.\", e );\n+                throw new TaskExecutionException( \"Error storing project\", e );\n             }\n+\n+            return false;\n         }\n-        finally\n+\n+        return true;\n+    }\n+\n+    private boolean checkAllChangesUnknown( List changes )\n+    {\n+        for ( Iterator iterChanges = changes.iterator(); iterChanges.hasNext(); )\n         {\n-            if ( project.getState() != ContinuumProjectState.NEW &&\n-                project.getState() != ContinuumProjectState.CHECKEDOUT &&\n-                project.getState() != ContinuumProjectState.OK && project.getState() != ContinuumProjectState.FAILED &&\n-                project.getState() != ContinuumProjectState.ERROR )\n+            ChangeSet changeSet = (ChangeSet) iterChanges.next();\n+\n+            List changeFiles = changeSet.getFiles();\n+\n+            Iterator iterFiles = changeFiles.iterator();\n+\n+            while ( iterFiles.hasNext() )\n             {\n-                try\n-                {\n-                    project.setState( ContinuumProjectState.ERROR );\n+                ChangeFile changeFile = (ChangeFile) iterFiles.next();\n \n-                    store.updateProject( project );\n-                }\n-                catch ( ContinuumStoreException e )\n+                if ( !\"unknown\".equalsIgnoreCase( changeFile.getStatus() ) )\n                 {\n-                    getLogger().error( \"Internal error while storing the project.\", e );\n+                    return false;\n                 }\n             }\n-\n-            notifierDispatcher.buildComplete( project, build );\n         }\n+\n+        return true;\n     }\n \n     private String convertScmResultToError( ScmResult result )\n@@ -391,24 +469,24 @@ private String convertScmResultToError( ScmResult result )\n         {\n             if ( result.getCommandLine() != null )\n             {\n-                error = \"Command line: \" + StringUtils.clean( result.getCommandLine() ) +\n-                    System.getProperty( \"line.separator\" );\n+                error = \"Command line: \" + StringUtils.clean( result.getCommandLine() )\n+                    + System.getProperty( \"line.separator\" );\n             }\n \n             if ( result.getProviderMessage() != null )\n             {\n-                error = \"Provider message: \" + StringUtils.clean( result.getProviderMessage() ) +\n-                    System.getProperty( \"line.separator\" );\n+                error = \"Provider message: \" + StringUtils.clean( result.getProviderMessage() )\n+                    + System.getProperty( \"line.separator\" );\n             }\n \n             if ( result.getCommandOutput() != null )\n             {\n                 error += \"Command output: \" + System.getProperty( \"line.separator\" );\n-                error += \"-------------------------------------------------------------------------------\" +\n-                    System.getProperty( \"line.separator\" );\n+                error += \"-------------------------------------------------------------------------------\"\n+                    + System.getProperty( \"line.separator\" );\n                 error += StringUtils.clean( result.getCommandOutput() ) + System.getProperty( \"line.separator\" );\n-                error += \"-------------------------------------------------------------------------------\" +\n-                    System.getProperty( \"line.separator\" );\n+                error += \"-------------------------------------------------------------------------------\"\n+                    + System.getProperty( \"line.separator\" );\n             }\n \n             if ( result.getException() != null )\n@@ -425,29 +503,48 @@ private String convertScmResultToError( ScmResult result )\n     //\n     // ----------------------------------------------------------------------\n \n-    private BuildResult makeAndStoreBuildResult( Project project, ScmResult scmResult, long startTime, int trigger )\n-        throws ContinuumStoreException\n+    private BuildResult makeAndStoreBuildResult( BuildContext context, String error )\n+        throws TaskExecutionException\n     {\n+        //        Project project, ScmResult scmResult, long startTime, int trigger )\n+        //        project, scmResult, startTime, trigger );\n+\n         BuildResult build = new BuildResult();\n \n         build.setState( ContinuumProjectState.ERROR );\n \n-        build.setTrigger( trigger );\n+        build.setTrigger( context.getTrigger() );\n \n-        build.setStartTime( startTime );\n+        build.setStartTime( context.getStartTime() );\n \n         build.setEndTime( System.currentTimeMillis() );\n \n-        build.setScmResult( scmResult );\n+        build.setScmResult( context.getScmResult() );\n \n-        store.addBuildResult( project, build );\n+        if ( error != null )\n+        {\n+            build.setError( error );\n+        }\n \n-        return store.getBuildResult( build.getId() );\n+        try\n+        {\n+            store.addBuildResult( context.getProject(), build );\n+\n+            build = store.getBuildResult( build.getId() );\n+\n+            context.setBuildResult( build );\n+\n+            return build;\n+        }\n+        catch ( ContinuumStoreException e )\n+        {\n+            throw new TaskExecutionException( \"Error storing build result\", e );\n+        }\n     }\n \n-    private ScmResult getOldScmResult( Project project, long fromDate )\n+    private ScmResult getOldScmResult( int projectId, long fromDate )\n     {\n-        List results = store.getBuildResultsForProject( project.getId(), fromDate );\n+        List results = store.getBuildResultsForProject( projectId, fromDate );\n \n         ScmResult res = new ScmResult();\n \n@@ -487,32 +584,78 @@ private ScmResult getOldScmResult( Project project, long fromDate )\n         return res;\n     }\n \n-    private ScmResult mergeScmResults( ScmResult oldScmResult, ScmResult newScmResult )\n+    /**\n+     *  Merges scm results so we'll have all changes since last execution of current build definition\n+     */\n+    private void mergeScmResults( BuildContext context )\n     {\n+        ScmResult oldScmResult = context.getOldScmResult();\n+        ScmResult newScmResult = context.getScmResult();\n+\n         if ( oldScmResult != null )\n         {\n             if ( newScmResult == null )\n             {\n-                return oldScmResult;\n+                context.setScmResult( oldScmResult );\n             }\n-\n-            List oldChanges = oldScmResult.getChanges();\n-\n-            List newChanges = newScmResult.getChanges();\n-\n-            for ( Iterator i = newChanges.iterator(); i.hasNext(); )\n+            else\n             {\n-                ChangeSet change = (ChangeSet) i.next();\n+                List oldChanges = oldScmResult.getChanges();\n \n-                if ( !oldChanges.contains( change ) )\n+                List newChanges = newScmResult.getChanges();\n+\n+                for ( Iterator i = newChanges.iterator(); i.hasNext(); )\n                 {\n-                    oldChanges.add( change );\n+                    ChangeSet change = (ChangeSet) i.next();\n+\n+                    if ( !oldChanges.contains( change ) )\n+                    {\n+                        oldChanges.add( change );\n+                    }\n                 }\n+\n+                newScmResult.setChanges( oldChanges );\n+\n             }\n+        }\n+    }\n+\n+    /**\n+     * Check to see if there was a error while checking out/updating the project\n+     *\n+     * @throws TaskExecutionException\n+     */\n+    private boolean checkScmResult( BuildContext context )\n+        throws TaskExecutionException\n+    {\n+        ScmResult scmResult = context.getScmResult();\n+\n+        if ( scmResult == null || !scmResult.isSuccess() )\n+        {\n+            // scmResult must be converted before storing it because jpox modifies values of all fields to null\n+            String error = convertScmResultToError( scmResult );\n \n-            newScmResult.setChanges( oldChanges );\n+            BuildResult build = makeAndStoreBuildResult( context, error );\n+\n+            try\n+            {\n+                Project project = context.getProject();\n+\n+                project.setState( build.getState() );\n+\n+                store.updateProject( project );\n+\n+                return false;\n+            }\n+            catch ( ContinuumStoreException e )\n+            {\n+                throw new TaskExecutionException( \"Error storing project\", e );\n+            }\n         }\n \n-        return newScmResult;\n+        context.getActionContext().put( AbstractContinuumAction.KEY_UPDATE_SCM_RESULT, scmResult );\n+\n+        return true;\n     }\n+\n }",
                "deletions": 238
            },
            {
                "sha": "5c055664ab370c191388050e58b860082389b034",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java",
                "status": "modified",
                "changes": 8,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/configuration/DefaultConfigurationService.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -52,12 +52,6 @@\n \n     private boolean loaded = false;\n \n-    // ----------------------------------------------------------------------\n-    // Continuum specifics we'll refactor out later\n-    // ----------------------------------------------------------------------\n-\n-    private Map jdks;\n-\n     // ----------------------------------------------------------------------\n     //\n     // ----------------------------------------------------------------------\n@@ -127,7 +121,7 @@ public void setDeploymentRepositoryDirectory( File deploymentRepositoryDirectory\n \n     public void setJdks( Map jdks )\n     {\n-        this.jdks = jdks;\n+        // no-op\n     }\n \n     public String getCompanyLogo()",
                "deletions": 7
            },
            {
                "sha": "2544b9f0dcec0b33c8ee28f8f9edd83fed1cb3c6",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/initialization/DefaultContinuumInitializer.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/initialization/DefaultContinuumInitializer.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/initialization/DefaultContinuumInitializer.java",
                "status": "modified",
                "changes": 1,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/initialization/DefaultContinuumInitializer.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -115,7 +115,6 @@ public void initialize()\n     // ----------------------------------------------------------------------\n \n     public Schedule createDefaultSchedule()\n-        throws ContinuumInitializationException\n     {\n         Schedule schedule = new Schedule();\n ",
                "deletions": 1
            },
            {
                "sha": "d2cff5e48696dc7e8dfd4e20a25657b232d7ec16",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scheduler/ContinuumBuildJob.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/scheduler/ContinuumBuildJob.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/scheduler/ContinuumBuildJob.java",
                "status": "modified",
                "changes": 4,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scheduler/ContinuumBuildJob.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -21,10 +21,8 @@\n import org.apache.maven.continuum.model.project.Schedule;\n import org.codehaus.plexus.logging.Logger;\n import org.codehaus.plexus.scheduler.AbstractJob;\n-import org.quartz.InterruptableJob;\n import org.quartz.JobDetail;\n import org.quartz.JobExecutionContext;\n-import org.quartz.UnableToInterruptJobException;\n \n /**\n  * @author <a href=\"mailto:jason@maven.org\">Jason van Zyl</a>\n@@ -73,7 +71,7 @@ public void execute( JobExecutionContext context )\n         {\n             if ( schedule.getDelay() > 0 )\n             {\n-                Thread.currentThread().sleep( schedule.getDelay() * 1000 );\n+                Thread.sleep( schedule.getDelay() * 1000 );\n             }\n         }\n         catch( InterruptedException e )",
                "deletions": 3
            },
            {
                "sha": "527fcd0d1d6ed98c039cceac597b9e52c68421b1",
                "filename": "continuum-core/src/main/java/org/apache/maven/continuum/scm/queue/CheckOutTaskExecutor.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/scm/queue/CheckOutTaskExecutor.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/main/java/org/apache/maven/continuum/scm/queue/CheckOutTaskExecutor.java",
                "status": "modified",
                "changes": 7,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/main/java/org/apache/maven/continuum/scm/queue/CheckOutTaskExecutor.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -17,7 +17,6 @@\n  */\n \n import org.apache.maven.continuum.core.action.AbstractContinuumAction;\n-import org.apache.maven.continuum.core.action.CheckoutProjectContinuumAction;\n import org.apache.maven.continuum.model.project.Project;\n import org.apache.maven.continuum.store.ContinuumStore;\n import org.apache.maven.continuum.store.ContinuumStoreException;\n@@ -76,11 +75,11 @@ public void executeTask( Task t )\n \n         Map context = new HashMap();\n \n-        context.put( CheckoutProjectContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n+        context.put( AbstractContinuumAction.KEY_PROJECT_ID, new Integer( projectId ) );\n \n-        context.put( CheckoutProjectContinuumAction.KEY_PROJECT, project );\n+        context.put( AbstractContinuumAction.KEY_PROJECT, project );\n \n-        context.put( CheckoutProjectContinuumAction.KEY_WORKING_DIRECTORY, workingDirectory );\n+        context.put( AbstractContinuumAction.KEY_WORKING_DIRECTORY, workingDirectory );\n \n         try\n         {",
                "deletions": 4
            },
            {
                "sha": "9ae7dc42eae685e00705ee50c6866ba78f73a263",
                "filename": "continuum-core/src/test/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifierTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/test/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifierTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-core/src/test/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifierTest.java",
                "status": "modified",
                "changes": 3,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-core/src/test/java/org/apache/maven/continuum/notification/mail/MailContinuumNotifierTest.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -22,6 +22,7 @@\n import org.apache.maven.continuum.notification.ContinuumNotificationDispatcher;\n import org.apache.maven.continuum.project.ContinuumProjectState;\n import org.codehaus.plexus.mailsender.MailMessage;\n+import org.codehaus.plexus.mailsender.MailSender;\n import org.codehaus.plexus.mailsender.test.MockMailSender;\n import org.codehaus.plexus.notification.notifier.Notifier;\n import org.codehaus.plexus.util.CollectionUtils;\n@@ -119,7 +120,7 @@ private MailMessage sendNotificationAndGetMessage( Project project, BuildResult\n         //\n         // ----------------------------------------------------------------------\n \n-        MockMailSender mailSender = (MockMailSender) lookup( MockMailSender.ROLE );\n+        MockMailSender mailSender = (MockMailSender) lookup( MailSender.ROLE );\n \n         assertEquals( 1, mailSender.getReceivedEmailSize() );\n ",
                "deletions": 1
            },
            {
                "sha": "9e5468aad8485efac06ca04edc91b1a8795a36b8",
                "filename": "continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java",
                "status": "modified",
                "changes": 2,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-notifiers/continuum-notifier-api/src/main/java/org/apache/maven/continuum/notification/AbstractContinuumNotifier.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -25,8 +25,6 @@\n import org.apache.maven.continuum.project.ContinuumProjectState;\n import org.codehaus.plexus.notification.notifier.AbstractNotifier;\n \n-import java.util.Map;\n-\n public abstract class AbstractContinuumNotifier\n     extends AbstractNotifier\n {",
                "deletions": 2
            },
            {
                "sha": "f5e50dadbc5faa6707ee0d375a23ab16eee6cb8c",
                "filename": "continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/main/java/org/apache/maven/continuum/store/JdoContinuumStore.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -189,11 +189,11 @@ public Map getProjectIdsAndBuildDefinitionsIdsBySchedule( int scheduleId )\n                     else\n                     {\n                         buildDefinitions = new ArrayList();\n+\n+                        projects.put( obj[0], buildDefinitions );\n                     }\n \n                     buildDefinitions.add( obj[1] );\n-\n-                    projects.put( obj[0], buildDefinitions );\n                 }\n \n                 return projects;",
                "deletions": 2
            },
            {
                "sha": "7e690337370273fdb8e7c7650abaf0c81d12e48d",
                "filename": "continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java",
                "status": "modified",
                "changes": 6,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-store/src/test/java/org/apache/maven/continuum/store/ContinuumStoreTest.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -538,7 +538,6 @@ public void testUpdateUndetachedProject()\n     }\n \n     public void testGetAllProjects()\n-        throws ContinuumStoreException\n     {\n         List projects = store.getAllProjectsByName();\n         assertEquals( \"check items\", Arrays.asList( new Project[]{testProject1, testProject2} ), projects );\n@@ -550,7 +549,6 @@ public void testGetAllProjects()\n     }\n \n     public void testAddSchedule()\n-        throws ContinuumStoreException\n     {\n         Schedule newSchedule = createTestSchedule( \"testAddSchedule\", \"testAddSchedule desc\", 10, \"cron test\", false );\n         Schedule copy = createTestSchedule( newSchedule );\n@@ -580,7 +578,6 @@ public void testEditSchedule()\n     }\n \n     public void testRemoveSchedule()\n-        throws ContinuumStoreException\n     {\n         Schedule schedule = (Schedule) store.getAllSchedulesByName().get( 2 );\n \n@@ -609,7 +606,6 @@ public void testGetAllSchedules()\n     }\n \n     public void testAddProfile()\n-        throws ContinuumStoreException\n     {\n         Installation installationJava14 = createTestInstallation( testInstallationJava14 );\n         Installation installationMaven20a3 = createTestInstallation( testInstallationMaven20a3 );\n@@ -646,7 +642,6 @@ public void testEditProfile()\n     }\n \n     public void testRemoveProfile()\n-        throws ContinuumStoreException\n     {\n         Profile profile = (Profile) store.getAllProfilesByName().get( 2 );\n \n@@ -829,7 +824,6 @@ public void testGetProjectGroupWithDetails()\n     }\n \n     public void testGetAllProjectsGroupWithDetails()\n-        throws ContinuumObjectNotFoundException\n     {\n         List projectGroups = store.getAllProjectGroupsWithBuildDetails();\n         ProjectGroup group1 = (ProjectGroup) projectGroups.get( 0 );",
                "deletions": 6
            },
            {
                "sha": "ae54a5823eefd60045e2aeed4d90039ee25d7edc",
                "filename": "continuum-test/src/main/java/org/apache/maven/continuum/AbstractContinuumTest.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-test/src/main/java/org/apache/maven/continuum/AbstractContinuumTest.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-test/src/main/java/org/apache/maven/continuum/AbstractContinuumTest.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-test/src/main/java/org/apache/maven/continuum/AbstractContinuumTest.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -33,7 +33,7 @@\n \n import javax.jdo.PersistenceManager;\n import javax.jdo.PersistenceManagerFactory;\n-import java.io.File;\n+\n import java.net.URL;\n import java.util.ArrayList;\n import java.util.Iterator;",
                "deletions": 1
            },
            {
                "sha": "3005a3a8e61f980ec4d39eedd10dc5ccfc4d9541",
                "filename": "continuum-xmlrpc/src/main/java/org/apache/maven/continuum/xmlrpc/DefaultContinuumXmlRpc.java",
                "blob_url": "https://github.com/apache/continuum/blob/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-xmlrpc/src/main/java/org/apache/maven/continuum/xmlrpc/DefaultContinuumXmlRpc.java",
                "raw_url": "https://github.com/apache/continuum/raw/ec0736031a9430cdff926f0e153f1ce0e045bd4b/continuum-xmlrpc/src/main/java/org/apache/maven/continuum/xmlrpc/DefaultContinuumXmlRpc.java",
                "status": "modified",
                "changes": 16,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-xmlrpc/src/main/java/org/apache/maven/continuum/xmlrpc/DefaultContinuumXmlRpc.java?ref=ec0736031a9430cdff926f0e153f1ce0e045bd4b",
                "patch": "@@ -469,22 +469,6 @@ private Hashtable convertContinuumBuild( Object object, boolean summary )\n         return xmlRpcHelper.objectToHashtable( object, excludedProperties );\n     }\n \n-    private Hashtable convertScmFile( Object object )\n-        throws IllegalAccessException, InvocationTargetException\n-    {\n-        Set excludedProperties = new HashSet();\n-\n-        return xmlRpcHelper.objectToHashtable( object, excludedProperties );\n-    }\n-\n-    private Hashtable convertScmResult( Object object )\n-        throws IllegalAccessException, InvocationTargetException\n-    {\n-        Set excludedProperties = new HashSet();\n-\n-        return xmlRpcHelper.objectToHashtable( object, excludedProperties );\n-    }\n-\n     // ----------------------------------------------------------------------\n     //\n     // ----------------------------------------------------------------------",
                "deletions": 16
            }
        ]
    },
    {
        "repo": "continuum",
        "message": "Upgraded web.xml to servlet spec 2.4 (the servlet-api already is 2.4).\nThis fixes various jstl and webwork problems when evaluating expressions\nin tomcat.\n\nUpdated all c:url's to use ww:url (mostly actions), and use ww:param to set\nprojectId parameters e.a.\n\nRemoved unused/unnessesary projectName getters/setters from BuildResultsListAction\nand use continuum to get the project name from a projectId in WorkingCopyAction.\n(Actions should just need the ID, not a projectName parameter in the URL to render stuff).\n\nTODO: test the notifier list - tried to add a notifier but that gave an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/continuum/trunk@431931 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/continuum/commit/b1c651aa153f085a368838438ba8f104e05f5fb5",
        "parent": "https://github.com/apache/continuum/commit/83475c77b12a426d6866d3a5801195a6f4237878",
        "bug_id": "continuum_74",
        "file": [
            {
                "sha": "ae1b5b29a848842a4ea80e0b2b354025cb3fa605",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildResultsListAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildResultsListAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildResultsListAction.java",
                "status": "modified",
                "changes": 12,
                "additions": 0,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/BuildResultsListAction.java?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -35,8 +35,6 @@\n \n     private int projectId;\n \n-    private String projectName;\n-\n     public String execute()\n         throws ContinuumException\n     {\n@@ -55,16 +53,6 @@ public void setProjectId( int projectId )\n         this.projectId = projectId;\n     }\n \n-    public String getProjectName()\n-    {\n-        return projectName;\n-    }\n-\n-    public void setProjectName( String projectName )\n-    {\n-        this.projectName = projectName;\n-    }\n-\n     public Collection getBuildResults()\n     {\n         return buildResults;",
                "deletions": 12
            },
            {
                "sha": "c7375eede25e1f5f1c34205200fadf14bc8da3c7",
                "filename": "continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/WorkingCopyAction.java",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/WorkingCopyAction.java",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/WorkingCopyAction.java",
                "status": "modified",
                "changes": 13,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/java/org/apache/maven/continuum/web/action/WorkingCopyAction.java?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -16,10 +16,8 @@\n  * limitations under the License.\n  */\n \n-import org.apache.maven.continuum.Continuum;\n import org.apache.maven.continuum.ContinuumException;\n import org.apache.maven.continuum.web.util.WorkingCopyContentGenerator;\n-import org.apache.maven.continuum.web.action.ContinuumActionSupport;\n \n import com.opensymphony.webwork.ServletActionContext;\n import com.opensymphony.webwork.views.util.UrlHelper;\n@@ -45,8 +43,6 @@\n \n     private int projectId;\n \n-    private String projectName;\n-\n     private String userDirectory;\n \n     private String currentFile;\n@@ -57,11 +53,15 @@\n \n     private String output;\n \n+    private String projectName;\n+\n     public String execute()\n         throws ContinuumException\n     {\n         files = continuum.getFiles( projectId, userDirectory );\n \n+        projectName = continuum.getProject( projectId ).getName();\n+\n         HashMap params = new HashMap();\n \n         params.put( \"projectId\", new Integer( projectId ) );\n@@ -99,11 +99,6 @@ public String getProjectName()\n         return projectName;\n     }\n \n-    public void setProjectName( String projectName )\n-    {\n-        this.projectName = projectName;\n-    }\n-\n     public String getUserDirectory()\n     {\n         return userDirectory;",
                "deletions": 9
            },
            {
                "sha": "dc285456048e022e1dfdedfd41ed8c5bc4f0d9a6",
                "filename": "continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/WEB-INF/web.xml",
                "status": "modified",
                "changes": 8,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/WEB-INF/web.xml?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -1,10 +1,6 @@\n-<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n+<?xml version=\"1.0\"?>\n \n-<!DOCTYPE web-app PUBLIC\n-    \"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN\"\n-    \"http://java.sun.com/dtd/web-app_2_3.dtd\">\n-\n-<web-app>\n+<web-app xmlns=\"http://java.sun.com/xml/ns/j2ee\" version=\"2.4\">\n \n   <display-name>Continuum Webapp</display-name>\n ",
                "deletions": 6
            },
            {
                "sha": "10661c7a4bd3d6aa5d29da52c06cf3818528b891",
                "filename": "continuum-webapp/src/main/webapp/buildResults.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/buildResults.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/buildResults.jsp",
                "status": "modified",
                "changes": 11,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/buildResults.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -39,12 +39,11 @@\n             <ec:column property=\"endTime\" title=\"buildResults.endTime\" cell=\"date\"/>\n             <ec:column property=\"state\" title=\"buildResults.state\" cell=\"org.apache.maven.continuum.web.view.buildresults.StateCell\"/>\n             <ec:column property=\"actions\" title=\"&nbsp;\">\n-              <c:url var=\"buildResultUrl\" value=\"/buildResult.action\">\n-                <c:param name=\"projectId\" value=\"projectId\"/>\n-                <c:param name=\"projectName\" value=\"projectName\"/>\n-                <c:param name=\"buildId\" value=\"${buildResult.id}\"/>\n-              </c:url>\n-              <a href=\"<c:out value='${buildResultUrl}'/>\">Result</a>\n+              <a href='<ww:url action=\"buildResult\">\n+                <ww:param name=\"projectId\" value=\"${projectId}\"/>\n+                <ww:param name=\"projectName\" value=\"${projectName}\"/>\n+                <ww:param name=\"buildId\" value=\"${buildResult.id}\"/>\n+              </ww:url>'>Result</a>\n             </ec:column>\n           </ec:row>\n         </ec:table>",
                "deletions": 6
            },
            {
                "sha": "8c51c428230ee27f372904a45e22e343da683fba",
                "filename": "continuum-webapp/src/main/webapp/groupSummary.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/groupSummary.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/groupSummary.jsp",
                "status": "modified",
                "changes": 7,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/groupSummary.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -28,10 +28,9 @@\n         <ec:row highlightRow=\"true\">\n           <ec:column property=\"state\" title=\"&nbsp;\" width=\"1%\" cell=\"org.apache.maven.continuum.web.view.StateCell\"/>\n           <ec:column property=\"name\" title=\"summary.projectTable.name\" width=\"48%\">\n-            <c:url var=\"projectViewUrl\" value=\"/projectView.action\">\n-              <c:param name=\"projectId\" value=\"${project.id}\"/>\n-            </c:url>\n-            <a href=\"<c:out value='${projectViewUrl}'/>\">${project.name}</a>\n+            <a href='<ww:url action=\"projectView\">\n+              <ww:param name=\"projectId\" value=\"${project.id}\"/>\n+            </ww:url>'>${project.name}</a>\n           </ec:column>\n           <ec:column property=\"version\" title=\"summary.projectTable.version\" width=\"13%\"/>\n           <ec:column property=\"buildNumber\" title=\"summary.projectTable.build\" width=\"5%\"",
                "deletions": 4
            },
            {
                "sha": "64b096f5d2191553f80d09b6007805f777bb0724",
                "filename": "continuum-webapp/src/main/webapp/projectView.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/projectView.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/projectView.jsp",
                "status": "modified",
                "changes": 44,
                "additions": 19,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/projectView.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -70,17 +70,15 @@\n             </ec:column>\n             <ec:column property=\"actions\" title=\"&nbsp;\">\n                 <!-- TODO: REPLACE THIS WITH A NEW CELL CLASS -->\n-                <c:url var=\"buildDefinitionEditUrl\" value=\"/buildDefinitionEdit!default.action\">\n-                  <c:param name=\"projectId\" value=\"project.id\"/>\n-                  <c:param name=\"buildDefinitionId\" value=\"${buildDefinition.id}\"/>\n-                </c:url>\n-                <a href=\"<c:out value='${buildDefinitionEditUrl}'/>\"><ww:text name=\"edit\"/></a>\n+                <a href='<ww:url value=\"/buildDefinitionEdit!default.action\">\n+                  <ww:param name=\"projectId\" value=\"project.id\"/>\n+                  <ww:param name=\"buildDefinitionId\" value=\"${buildDefinition.id}\"/>\n+                </ww:url>'><ww:text name=\"edit\"/></a>\n                 &nbsp;\n-                <c:url var=\"deleteBuildDefinitionUrl\" value=\"/deleteBuildDefinition!default.action\">\n-                  <c:param name=\"projectId\" value=\"project.id\"/>\n-                  <c:param name=\"buildDefinitionId\" value=\"${buildDefinition.id}\"/>\n-                </c:url>\n-                <a href=\"<c:out value='${deleteBuildDefinitionUrl}'/>\"><ww:text name=\"delete\"/></a>\n+                <a href='<ww:url value=\"/deleteBuildDefinition!default.action\">\n+                  <ww:param name=\"projectId\" value=\"project.id\"/>\n+                  <ww:param name=\"buildDefinitionId\" value=\"${buildDefinition.id}\"/>\n+                </ww:url>'><ww:text name=\"delete\"/></a>\n             </ec:column>\n           </ec:row>\n         </ec:table>\n@@ -107,23 +105,19 @@\n             <ec:column property=\"from\" title=\"projectView.notifier.from\" cell=\"org.apache.maven.continuum.web.view.projectview.NotifierFromCell\"/>\n             <ec:column property=\"actions\" title=\"&nbsp;\">\n                 <c:if test=\"${!pageScope.notifier.fromProject}\">\n-                    <c:url var=\"notifierEditUrl\" value=\"${notifier.type}NotifierEdit!default.action\">\n-                      <c:param name=\"projectId\" value=\"project.id\"/>\n-                      <c:param name=\"notifierId\" value=\"${notifier.id}\"/>\n-                    </c:url>\n-                    <c:url var=\"imgEditUrl\" value=\"/images/edit.gif\" />\n-                    <a href=\"<c:out value='${notifierEditUrl}'/>\">\n-                      <img src=\"<c:out value='${imgEditUrl}'/>\" alt=\"<ww:text name=\"edit\"/>\" title=\"<ww:text name=\"edit\"/>\" border=\"0\">\n+                    <a href='<ww:url value=\"${notifier.type}NotifierEdit!default.action\">\n+                      <ww:param name=\"projectId\" value=\"project.id\"/>\n+                      <ww:param name=\"notifierId\" value=\"${notifier.id}\"/>\n+                    </ww:url>'>\n+                      <img src=\"<ww:url value='/images/edit.gif'/>\" alt=\"<ww:text name='edit'/>\" title=\"<ww:text name='edit'/>\" border=\"0\" />\n                     </a>\n                     &nbsp;\n-                    <c:url var=\"notifierDeleteUrl\" value=\"/deleteNotifier!default.action\">\n-                      <c:param name=\"projectId\" value=\"project.id\"/>\n-                      <c:param name=\"notifierId\" value=\"${notifier.id}\"/>\n-                      <c:param name=\"notifierType\" value=\"${notifier.type}\"/>\n-                    </c:url>\n-                    <c:url var=\"imgDeleteUrl\" value=\"/images/delete.gif\" />\n-                    <a href=\"<c:out value='${notifierDeleteUrl}'/>\">\n-                      <img src=\"<c:out value='${imgDeleteUrl}'/>\" alt=\"<ww:text name=\"delete\"/>\" title=\"<ww:text name=\"delete\"/>\" border=\"0\">\n+                    <a href='<ww:url value=\"/deleteNotifier!default.action\">\n+                      <ww:param name=\"projectId\" value=\"project.id\"/>\n+                      <ww:param name=\"notifierId\" value=\"${notifier.id}\"/>\n+                      <ww:param name=\"notifierType\" value=\"${notifier.type}\"/>\n+                    </ww:url>'>\n+                      <img src=\"<ww:url value='/images/delete.gif'/>\" alt=\"<ww:text name='delete'/>\" title=\"<ww:text name='delete'/>\" border=\"0\">\n                     </a>\n                 </c:if>\n             </ec:column>",
                "deletions": 25
            },
            {
                "sha": "152d68c47d3f6c5d98814a6f3634d51a8db86d3b",
                "filename": "continuum-webapp/src/main/webapp/schedules.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/schedules.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/schedules.jsp",
                "status": "modified",
                "changes": 7,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/schedules.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -22,10 +22,9 @@\n             <ec:column property=\"delay\" title=\"schedules.table.delay\"/>\n             <ec:column property=\"cronExpression\" title=\"schedules.table.cronExpression\"/>\n             <ec:column property=\"actions\" title=\"&nbsp;\">\n-                <c:url var=\"editScheduleUrl\" value=\"/editSchedule!edit.action\">\n-                  <c:param name=\"id\" value=\"${schedule.id}\"/>\n-                </c:url>\n-                <a href=\"<c:out value='${editScheduleUrl}'/>\"><ww:text name=\"edit\"/></a>\n+                <a href='<ww:url value=\"/editSchedule!edit.action\">\n+                  <ww:param name=\"id\" value=\"${schedule.id}\"/>\n+                </ww:url>'><ww:text name=\"edit\"/></a>\n                 &nbsp;\n                 <ww:text name=\"delete\"/>\n             </ec:column>",
                "deletions": 4
            },
            {
                "sha": "96ced6e8f4bc7c9f4b874bc6d5a97a497c6b8baf",
                "filename": "continuum-webapp/src/main/webapp/summary.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/summary.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/summary.jsp",
                "status": "modified",
                "changes": 37,
                "additions": 20,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/summary.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -19,8 +19,9 @@\n           <ec:row highlightRow=\"true\">\n             <ec:column property=\"state\" title=\"&nbsp;\" width=\"1%\" cell=\"org.apache.maven.continuum.web.view.StateCell\"/>\n             <ec:column property=\"name\" title=\"summary.projectTable.name\" width=\"48%\">\n-                <c:url var=\"projectViewUrl\" value=\"/projectView.action\"/>\n-                <a href=\"<c:out value='${projectViewUrl}?projectId=${project.id}'/>\">${project.name}</a>\n+                <a href=\"<ww:url action=\"projectView\">\n+\t\t\t\t\t\t\t\t\t<ww:param name=\"projectId\" value=\"${project.id}\"/>\n+\t\t\t\t\t\t\t\t</ww:url>\">${project.name}</a>\n             </ec:column>\n             <ec:column property=\"version\" title=\"summary.projectTable.version\" width=\"13%\"/>\n             <ec:column property=\"buildNumber\" title=\"summary.projectTable.build\" width=\"5%\" cell=\"org.apache.maven.continuum.web.view.BuildCell\"/>\n@@ -29,37 +30,39 @@\n             <ec:column property=\"buildHistoryAction\" title=\"&nbsp;\" width=\"1%\" sortable=\"false\">\n               <c:choose>\n                 <c:when test=\"${pageScope.project.latestBuildId > 0}\">\n-                  <a href=\"<ww:url value=\"/buildResults.action?projectId=\"/>${pageScope.project.id}&projectName=${pageScope.project.name}\"><img src=\"<ww:url value=\"/images/buildhistory.gif\"/>\" alt=\"Build History\" title=\"Build History\" border=\"0\"></a>\n+                  <a href='<ww:url action=\"buildResults\">\n+\t\t\t\t\t\t\t\t\t\t\t<ww:param name=\"projectId\" value=\"${project.id}\"/>\n+\t\t\t\t\t\t\t\t\t\t</ww:url>'><img src=\"<ww:url value='/images/buildhistory.gif'/>\" alt=\"Build History\" title=\"Build History\" border=\"0\"></a>\n                 </c:when>\n                 <c:otherwise>\n-                  <img src=\"<ww:url value=\"/images/buildhistory_disabled.gif\"/>\" alt=\"Build History\" title=\"Build History\" border=\"0\">\n+                  <img src=\"<ww:url value='/images/buildhistory_disabled.gif'/>\" alt=\"Build History\" title=\"Build History\" border=\"0\">\n                 </c:otherwise>\n               </c:choose>\n             </ec:column>\n             <ec:column property=\"workingCopyAction\" title=\"&nbsp;\" width=\"1%\" sortable=\"false\">\n               <c:choose>\n                 <c:when test=\"${pageScope.project.state == 10 || pageScope.project.state == 2 || pageScope.project.state == 3 || pageScope.project.state == 4 || pageScope.project.state == 6}\">\n-                  <a href=\"<ww:url value=\"/workingCopy.action?projectId=\"/>${pageScope.project.id}&projectName=${pageScope.project.name}\"><img src=\"<ww:url value=\"/images/workingcopy.gif\"/>\" alt=\"Working Copy\" title=\"Working Copy\" border=\"0\"></a>\n+                  <a href='<ww:url action=\"workingCopy\">\n+\t\t\t\t\t\t\t\t\t\t\t<ww:param name=\"projectId\" value=\"${project.id}\"/>\n+\t\t\t\t\t\t\t\t\t\t</ww:url>'><img src=\"<ww:url value='/images/workingcopy.gif'/>\" alt=\"Working Copy\" title=\"Working Copy\" border=\"0\"></a>\n                 </c:when>\n                 <c:otherwise>\n-                  <img src=\"<ww:url value=\"/images/workingcopy_disabled.gif\"/>\" alt=\"Working Copy\" title=\"Working Copy\" border=\"0\">\n+                  <img src=\"<ww:url value='/images/workingcopy_disabled.gif'/>\" alt=\"Working Copy\" title=\"Working Copy\" border=\"0\">\n                 </c:otherwise>\n               </c:choose>\n             </ec:column>\n             <ec:column property=\"deleteAction\" title=\"&nbsp;\" width=\"1%\" sortable=\"false\">\n               <c:choose>\n                 <c:when test=\"${pageScope.project.state == 1 || pageScope.project.state == 10 || pageScope.project.state == 2 || pageScope.project.state == 3 || pageScope.project.state == 4}\">\n-                  <c:url var=\"deleteProjectUrl\" value=\"/deleteProject!default.action\">\n-                    <c:param name=\"projectId\" value=\"${project.id}\"/>\n-                    <c:param name=\"projectName\" value=\"${project.name}\"/>\n-                  </c:url>\n-                  <c:url var=\"imgDeleteUrl\" value=\"/images/delete.gif\" />\n-                  <a href=\"<c:out value='${deleteProjectUrl}'/>\">\n-                    <img src=\"<c:out value='${imgDeleteUrl}'/>\" alt=\"Delete\" title=\"Delete\" border=\"0\">\n+                  <a href='<ww:url value=\"/deleteProject!default.action\">\n+                    <ww:param name=\"projectId\" value=\"${project.id}\"/>\n+                    <ww:param name=\"projectName\" value=\"${project.name}\"/>\n+                  </ww:url>'>\n+                    <img src=\"<ww:url value='/images/delete.gif'/>\" alt=\"Delete\" title=\"Delete\" border=\"0\">\n                   </a>\n                 </c:when>\n                 <c:otherwise>\n-                  <img src=\"<ww:url value=\"/images/delete_disabled.gif\"/>\" alt=\"Delete\" title=\"Delete\" border=\"0\">\n+                  <img src=\"<ww:url value='/images/delete_disabled.gif'/>\" alt=\"Delete\" title=\"Delete\" border=\"0\">\n                 </c:otherwise>\n               </c:choose>\n             </ec:column>\n@@ -69,9 +72,9 @@\n           <ww:form action=\"buildProject.action\" method=\"post\">\n             <ww:submit value=\"%{getText('summary.buildAll')}\">\n               <ww:param name=\"before\">\n-                <img src=\"<ww:url value=\"/images/icon_success_sml.gif\"/>\" alt=\"<ww:text name=\"message.success\"/>\" title=\"<ww:text name=\"message.success\"/>\"/> <ww:property value=\"nbSuccesses\"/>\n-                <img src=\"<ww:url value=\"/images/icon_warning_sml.gif\"/>\" alt=\"<ww:text name=\"message.failed\"/>\" title=\"<ww:text name=\"message.failed\"/>\"/> <ww:property value=\"nbFailures\"/>\n-                <img src=\"<ww:url value=\"/images/icon_error_sml.gif\"/>\" alt=\"<ww:text name=\"message.error\"/>\" title=\"<ww:text name=\"message.error\"/>\"/> <ww:property value=\"nbErrors\"/>\n+                <img src=\"<ww:url value='/images/icon_success_sml.gif'/>\" alt=\"<ww:text name='message.success'/>\" title=\"<ww:text name='message.success'/>\"/> <ww:property value=\"nbSuccesses\"/>\n+                <img src=\"<ww:url value='/images/icon_warning_sml.gif'/>\" alt=\"<ww:text name='message.failed'/>\" title=\"<ww:text name='message.failed'/>\"/> <ww:property value=\"nbFailures\"/>\n+                <img src=\"<ww:url value='/images/icon_error_sml.gif'/>\" alt=\"<ww:text name='message.error'/>\" title=\"<ww:text name='message.error'/>\"/> <ww:property value=\"nbErrors\"/>\n               </ww:param>\n             </ww:submit>\n           </ww:form>",
                "deletions": 17
            },
            {
                "sha": "2ca7cc95f7352f6c3084077d8e627f48d1d36e37",
                "filename": "continuum-webapp/src/main/webapp/workingCopy.jsp",
                "blob_url": "https://github.com/apache/continuum/blob/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/workingCopy.jsp",
                "raw_url": "https://github.com/apache/continuum/raw/b1c651aa153f085a368838438ba8f104e05f5fb5/continuum-webapp/src/main/webapp/workingCopy.jsp",
                "status": "modified",
                "changes": 16,
                "additions": 13,
                "contents_url": "https://api.github.com/repos/apache/continuum/contents/continuum-webapp/src/main/webapp/workingCopy.jsp?ref=b1c651aa153f085a368838438ba8f104e05f5fb5",
                "patch": "@@ -8,8 +8,18 @@\n       <div id=\"h3\">\n         <div>\n           <p style=\"border-top: 1px solid transparent; border-bottom: 1px solid #DFDEDE;\">\n-            <a style=\"border: 1px solid #DFDEDE; padding-left: 1em; padding-right: 1em; text-decoration: none;\" href=\"<ww:url value=\"/projectView.action?projectId=\"/><ww:property value=\"projectId\"/>&projectName=<ww:property value=\"projectName\"/>\"><ww:text name=\"info\"/></a>\n-            <a style=\"border: 1px solid #DFDEDE; padding-left: 1em; padding-right: 1em; text-decoration: none;\" href=\"<ww:url value=\"/buildResults.action?projectId=\"/><ww:property value=\"projectId\"/>&projectName=<ww:property value=\"projectName\"/>\"><ww:text name=\"builds\"/></a>\n+            <a style=\"border: 1px solid #DFDEDE; padding-left: 1em; padding-right: 1em; text-decoration: none;\"\n+\t\t\t\t\t\t\thref='<ww:url action=\"projectView\">\n+\t\t\t\t\t\t\t\t\t<ww:param name=\"projectId\" value=\"projectId\"/>\n+\t\t\t\t\t\t\t\t</ww:url>'>\n+\t\t\t\t\t\t\t<ww:text name=\"info\"/>\n+\t\t\t\t\t\t</a>\n+            <a style=\"border: 1px solid #DFDEDE; padding-left: 1em; padding-right: 1em; text-decoration: none;\"\n+\t\t\t\t\t\t\thref='<ww:url action=\"buildResults\">\n+\t\t\t\t\t\t\t\t\t<ww:param name=\"projectId\" value=\"projectId\"/>\n+\t\t\t\t\t\t\t\t</ww:url>'>\n+\t\t\t\t\t\t\t<ww:text name=\"builds\"/>\n+\t\t\t\t\t\t</a>\n             <b style=\"border: 1px solid #DFDEDE; padding-left: 1em; padding-right: 1em;\"><ww:text name=\"workingCopy\"/></b>\n           </p>\n         </div>\n@@ -20,7 +30,7 @@\n             </ww:text>\n         </h3>\n \n-        <ww:property value=\"output\"/>\n+        <ww:property value=\"output\" escape=\"false\"/>\n \n         <%\n             if ( request.getParameter( \"file\" ) != null )",
                "deletions": 3
            }
        ]
    }
]