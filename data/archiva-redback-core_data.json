[{"commit": "https://github.com/apache/archiva-redback-core/commit/8e61f56f9d519fcf32653b740cee511a242009f2", "parent": "https://github.com/apache/archiva-redback-core/commit/e12772a85643fd3036daabfa9723e76be53cae13", "message": "prevent NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/archiva/redback/redback-core/trunk@1436670 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "archiva-redback-core_1", "file": [{"additions": 15, "raw_url": "https://github.com/apache/archiva-redback-core/raw/8e61f56f9d519fcf32653b740cee511a242009f2/redback-integrations/redback-common-integrations/src/main/java/org/apache/archiva/redback/integration/checks/security/GuestUserEnvironmentCheck.java", "blob_url": "https://github.com/apache/archiva-redback-core/blob/8e61f56f9d519fcf32653b740cee511a242009f2/redback-integrations/redback-common-integrations/src/main/java/org/apache/archiva/redback/integration/checks/security/GuestUserEnvironmentCheck.java", "sha": "c004ebcc6a9420c2388b80adad83a832f78cf9c2", "changes": 21, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/archiva-redback-core/contents/redback-integrations/redback-common-integrations/src/main/java/org/apache/archiva/redback/integration/checks/security/GuestUserEnvironmentCheck.java?ref=8e61f56f9d519fcf32653b740cee511a242009f2", "patch": "@@ -53,7 +53,7 @@\n     private SecuritySystem securitySystem;\n \n     @Inject\n-    @Named( value = \"userConfiguration#default\" )\n+    @Named(value = \"userConfiguration#default\")\n     private UserConfiguration config;\n \n     /**\n@@ -86,20 +86,29 @@ public void validateEnvironment( List<String> violations )\n                 catch ( UserManagerException ume )\n                 {\n                     violations.add( \"unable to initialize guest user properly: \" + ume.getMessage() );\n+                    checked = true;\n                     return;\n                 }\n                 policy.setEnabled( true );\n             }\n \n-            try\n+            if ( guest != null )\n             {\n-                roleManager.assignRole( config.getString( UserConfigurationKeys.DEFAULT_GUEST ), guest.getUsername() );\n+\n+                try\n+                {\n+                    roleManager.assignRole( config.getString( UserConfigurationKeys.DEFAULT_GUEST ),\n+                                            guest.getUsername() );\n+                }\n+                catch ( RoleManagerException rpe )\n+                {\n+                    violations.add( \"unable to initialize guest user properly: \" + rpe.getMessage() );\n+                }\n             }\n-            catch ( RoleManagerException rpe )\n+            else\n             {\n-                violations.add( \"unable to initialize guest user properly: \" + rpe.getMessage() );\n+                violations.add( \"cannot find neither create guest user\" );\n             }\n-\n             checked = true;\n         }\n     }", "filename": "redback-integrations/redback-common-integrations/src/main/java/org/apache/archiva/redback/integration/checks/security/GuestUserEnvironmentCheck.java"}], "repo": "archiva-redback-core"}, {"commit": "https://github.com/apache/archiva-redback-core/commit/a522ed98fbcdecf8fd1d4f7977d9567f3cf42317", "parent": "https://github.com/apache/archiva-redback-core/commit/dc712ce923378f3804bc264a8c1ebd2b4d3f7274", "message": "NPE free\n\ngit-svn-id: https://svn.apache.org/repos/asf/archiva/redback/redback-core/trunk@1424973 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "archiva-redback-core_2", "file": [{"additions": 1, "raw_url": "https://github.com/apache/archiva-redback-core/raw/a522ed98fbcdecf8fd1d4f7977d9567f3cf42317/redback-integrations/redback-rest/redback-rest-services/src/main/java/org/apache/archiva/redback/rest/services/DefaultLoginService.java", "blob_url": "https://github.com/apache/archiva-redback-core/blob/a522ed98fbcdecf8fd1d4f7977d9567f3cf42317/redback-integrations/redback-rest/redback-rest-services/src/main/java/org/apache/archiva/redback/rest/services/DefaultLoginService.java", "sha": "ee3cc47895f257a0b69f616e31c3d2195556ff19", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/archiva-redback-core/contents/redback-integrations/redback-rest/redback-rest-services/src/main/java/org/apache/archiva/redback/rest/services/DefaultLoginService.java?ref=a522ed98fbcdecf8fd1d4f7977d9567f3cf42317", "patch": "@@ -205,7 +205,7 @@ public User isLogged()\n         SecuritySession securitySession = httpAuthenticator.getSecuritySession( httpServletRequest.getSession( true ) );\n         Boolean isLogged = securitySession != null;\n         log.debug( \"isLogged {}\", isLogged );\n-        return isLogged ? buildRestUser( securitySession.getUser() ) : null;\n+        return isLogged && securitySession.getUser() != null ? buildRestUser( securitySession.getUser() ) : null;\n     }\n \n     public Boolean logout()", "filename": "redback-integrations/redback-rest/redback-rest-services/src/main/java/org/apache/archiva/redback/rest/services/DefaultLoginService.java"}], "repo": "archiva-redback-core"}]
