{
    "attic-stratos_2ee26c1": {
        "bug_id": "attic-stratos_2ee26c1",
        "commit": "https://github.com/apache/attic-stratos/commit/2ee26c15c1d64ed67175c1a6dbadc7dba452949e",
        "file": [
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/attic-stratos/blob/2ee26c15c1d64ed67175c1a6dbadc7dba452949e/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/services/impl/AutoscalerServiceImpl.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/attic-stratos/contents/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/services/impl/AutoscalerServiceImpl.java?ref=2ee26c15c1d64ed67175c1a6dbadc7dba452949e",
                "deletions": 9,
                "filename": "components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/services/impl/AutoscalerServiceImpl.java",
                "patch": "@@ -101,12 +101,12 @@ public boolean updateAutoScalingPolicy(AutoscalePolicy autoscalePolicy) throws I\n     @Override\n     public boolean removeAutoScalingPolicy(String autoscalePolicyId) throws UnremovablePolicyException,\n             PolicyDoesNotExistException {\n-        if (removableAutoScalerPolicy(autoscalePolicyId)) {\n+        //if (removableAutoScalerPolicy(autoscalePolicyId)) {\n             return PolicyManager.getInstance().removeAutoscalePolicy(autoscalePolicyId);\n-        } else {\n+       /* } else {\n             throw new UnremovablePolicyException(\"This autoscaler policy cannot be removed, since it is used in \" +\n                     \"applications.\");\n-        }\n+        }*/\n     }\n \n     /**\n@@ -138,12 +138,12 @@ private boolean removableAutoScalerPolicy(String autoscalePolicyId) {\n      */\n     private boolean removableDeploymentPolicy(String deploymentPolicyId) {\n         boolean canRemove = true;\n-        Collection<ApplicationContext> appContexts = AutoscalerContext.getInstance().getApplicationContexts();\n-        for (ApplicationContext app : appContexts) {\n-            CartridgeContext[] cartridgeContexts = app.getComponents().getCartridgeContexts();\n-            for (CartridgeContext cartridgeContext : cartridgeContexts) {\n-                SubscribableInfoContext subscribableInfoContexts = cartridgeContext.getSubscribableInfoContext();\n-                if (subscribableInfoContexts.getDeploymentPolicy().equals(deploymentPolicyId)) {\n+        Map<String, Application> applications = ApplicationHolder.getApplications().getApplications();\n+        for (Application application : applications.values()) {\n+            List<String> deploymentPolicyIdsReferredInApplication = AutoscalerUtil.\n+                    getDeploymentPolicyIdsReferredInApplication(application.getUniqueIdentifier());\n+            for (String deploymentPolicyIdInApp : deploymentPolicyIdsReferredInApplication) {\n+                if (deploymentPolicyId.equals(deploymentPolicyIdInApp)) {\n                     canRemove = false;\n                 }\n             }",
                "raw_url": "https://github.com/apache/attic-stratos/raw/2ee26c15c1d64ed67175c1a6dbadc7dba452949e/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/services/impl/AutoscalerServiceImpl.java",
                "sha": "54ff1b3a015bd8e9fee8aa3c9497692ef39a7eb6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/attic-stratos/blob/2ee26c15c1d64ed67175c1a6dbadc7dba452949e/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/attic-stratos/contents/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java?ref=2ee26c15c1d64ed67175c1a6dbadc7dba452949e",
                "deletions": 1,
                "filename": "components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "patch": "@@ -422,7 +422,7 @@ public static String findTenantRange(int tenantId, String tenantPartitions) {\n      * @param applicationId the application id\n      * @return list of deployment policy ids\n      */\n-    private static List<String> getDeploymentPolicyIdsReferredInApplication(String applicationId) {\n+    public static List<String> getDeploymentPolicyIdsReferredInApplication(String applicationId) {\n \n         if (applicationId == null || StringUtils.isBlank(applicationId)) {\n             return null;",
                "raw_url": "https://github.com/apache/attic-stratos/raw/2ee26c15c1d64ed67175c1a6dbadc7dba452949e/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "sha": "2f78fe7631f259282485efc362a431d62d3430c9",
                "status": "modified"
            }
        ],
        "message": "Fixing NPE which caused by policy validation and fixing the policy validation to validate against whole applicaiton",
        "parent": "https://github.com/apache/attic-stratos/commit/1089dedc6c9da007849ae206de20c5b31cd38cf8",
        "repo": "attic-stratos",
        "unit_tests": [
            "AutoscalerUtilTest.java"
        ]
    },
    "attic-stratos_90b7836": {
        "bug_id": "attic-stratos_90b7836",
        "commit": "https://github.com/apache/attic-stratos/commit/90b78364f8aedf4a6df75693191eb6b79989aedb",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/attic-stratos/blob/90b78364f8aedf4a6df75693191eb6b79989aedb/components/org.apache.stratos.cloud.controller/src/main/java/org/apache/stratos/cloud/controller/pojo/KubernetesClusterContext.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/attic-stratos/contents/components/org.apache.stratos.cloud.controller/src/main/java/org/apache/stratos/cloud/controller/pojo/KubernetesClusterContext.java?ref=90b78364f8aedf4a6df75693191eb6b79989aedb",
                "deletions": 0,
                "filename": "components/org.apache.stratos.cloud.controller/src/main/java/org/apache/stratos/cloud/controller/pojo/KubernetesClusterContext.java",
                "patch": "@@ -132,6 +132,9 @@ public void setMasterIp(String masterIp) {\n \t}\n \n \tpublic KubernetesApiClient getKubApi() {\n+\t\tif (kubApi == null) {\n+\t\t\tkubApi = new KubernetesApiClient(getEndpoint(masterIp));\n+\t\t}\n \t\treturn kubApi;\n \t}\n ",
                "raw_url": "https://github.com/apache/attic-stratos/raw/90b78364f8aedf4a6df75693191eb6b79989aedb/components/org.apache.stratos.cloud.controller/src/main/java/org/apache/stratos/cloud/controller/pojo/KubernetesClusterContext.java",
                "sha": "0976eb0b7357e26e34e37b468d35c859d9cfd698",
                "status": "modified"
            }
        ],
        "message": "handling a NPE.",
        "parent": "https://github.com/apache/attic-stratos/commit/d6022955b22c9309507a114402c717d1b6d0a136",
        "repo": "attic-stratos",
        "unit_tests": [
            "KubernetesClusterContextTest.java"
        ]
    },
    "attic-stratos_b9591a4": {
        "bug_id": "attic-stratos_b9591a4",
        "commit": "https://github.com/apache/attic-stratos/commit/b9591a4003faa36ff6c470b81d6bab185611eeff",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/attic-stratos/blob/b9591a4003faa36ff6c470b81d6bab185611eeff/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/attic-stratos/contents/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java?ref=b9591a4003faa36ff6c470b81d6bab185611eeff",
                "deletions": 2,
                "filename": "components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "patch": "@@ -89,9 +89,8 @@ public static Applications loadApplicationsFromRegistry(Applications application\n             for (String appResourcePath : appResourcePaths) {\n                 applications.addApplication(getApplicationFromPath(appResourcePath));\n             }\n-            return applications;\n         }\n-        return null;\n+        return applications;\n     }\n \n     public static Application getApplication(String appId) {",
                "raw_url": "https://github.com/apache/attic-stratos/raw/b9591a4003faa36ff6c470b81d6bab185611eeff/components/org.apache.stratos.autoscaler/src/main/java/org/apache/stratos/autoscaler/util/AutoscalerUtil.java",
                "sha": "18a6956d71587865535ef8de6696dc95a202e8ab",
                "status": "modified"
            }
        ],
        "message": "Fix NPE when loading persisted applications from registry",
        "parent": "https://github.com/apache/attic-stratos/commit/1c45330227a76946bf16a9f936a5dbd0df84130e",
        "repo": "attic-stratos",
        "unit_tests": [
            "AutoscalerUtilTest.java"
        ]
    }
}