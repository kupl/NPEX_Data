{
    "axis1-java_01eb62a": {
        "bug_id": "axis1-java_01eb62a",
        "commit": "https://github.com/apache/axis1-java/commit/01eb62a967397097e17d2f5f376b5c534bc6106f",
        "file": [
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/axis1-java/blob/01eb62a967397097e17d2f5f376b5c534bc6106f/src/org/apache/axis/utils/Admin.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=01eb62a967397097e17d2f5f376b5c534bc6106f",
                "deletions": 12,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -279,22 +279,25 @@ public Document process(MessageContext msgContext, Element root)\n             /** For now, though - make sure we can only admin from our own\n              * IP, unless the remoteAdmin option is set.\n              */\n-            String remoteAdmin = (String)msgContext.getServiceHandler().\n+            Handler serviceHandler = msgContext.getServiceHandler();\n+            if (serviceHandler != null) {\n+                String remoteAdmin = (String)serviceHandler.\n                                             getOption(\"enableRemoteAdmin\");\n-            if ((remoteAdmin == null) ||\n-                !remoteAdmin.equals(\"true\")) {\n-                String remoteIP =\n+                if ((remoteAdmin == null) ||\n+                    !remoteAdmin.equals(\"true\")) {\n+                    String remoteIP =\n                             msgContext.getStrProp(Constants.MC_REMOTE_ADDR);\n-                if (remoteIP != null) {\n-                    if (!remoteIP.equals(\"127.0.0.1\")) {\n-                        InetAddress myAddr = InetAddress.getLocalHost();\n-                        InetAddress remoteAddr =\n+                    if (remoteIP != null) {\n+                        if (!remoteIP.equals(\"127.0.0.1\")) {\n+                            InetAddress myAddr = InetAddress.getLocalHost();\n+                            InetAddress remoteAddr =\n                                             InetAddress.getByName(remoteIP);\n                         \n-                        if (!myAddr.equals(remoteAddr))\n-                            throw new AxisFault(\"Server.Unauthorized\",\n-                                \"Remote admin access is not allowed! \",\n-                                null, null);\n+                            if (!myAddr.equals(remoteAddr))\n+                                throw new AxisFault(\"Server.Unauthorized\",\n+                                    \"Remote admin access is not allowed! \",\n+                                    null, null);\n+                        }\n                     }\n                 }\n             }",
                "raw_url": "https://github.com/apache/axis1-java/raw/01eb62a967397097e17d2f5f376b5c534bc6106f/src/org/apache/axis/utils/Admin.java",
                "sha": "cff0a3c55425ada1dc9d5fd44940562474030cbf",
                "status": "modified"
            }
        ],
        "message": "Fix potential NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@252193 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/cc2f20ae2c796b6cf0cd78883f4344b548e01d97",
        "repo": "axis1-java",
        "unit_tests": [
            "AdminTest.java"
        ]
    },
    "axis1-java_0721cd2": {
        "bug_id": "axis1-java_0721cd2",
        "commit": "https://github.com/apache/axis1-java/commit/0721cd2e14100cbfd4c7dafab7aa03f554110be4",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/0721cd2e14100cbfd4c7dafab7aa03f554110be4/src/org/apache/axis/message/MessageElement.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/MessageElement.java?ref=0721cd2e14100cbfd4c7dafab7aa03f554110be4",
                "deletions": 2,
                "filename": "src/org/apache/axis/message/MessageElement.java",
                "patch": "@@ -620,8 +620,10 @@ public final void output(SerializationContext context) throws Exception\n          * whatever encoding style is in scope....\n          */ \n         if (encodingStyle != null) {\n-            SOAPConstants soapConstants = context.getMessageContext().\n-                                                        getSOAPConstants();\n+            MessageContext mc = context.getMessageContext();\n+            SOAPConstants soapConstants = (mc != null) ?\n+                                            mc.getSOAPConstants() :\n+                                            SOAPConstants.SOAP11_CONSTANTS;\n             if (parent == null) {\n                 // don't emit an encoding style if its \"\" (literal)\n                 if (!encodingStyle.equals(\"\")) { ",
                "raw_url": "https://github.com/apache/axis1-java/raw/0721cd2e14100cbfd4c7dafab7aa03f554110be4/src/org/apache/axis/message/MessageElement.java",
                "sha": "daa12845f6df9aeee5a64bfb964f33a38be8bd95",
                "status": "modified"
            }
        ],
        "message": "Fix NPE in weird cases where a SerializationContext doesn't have an\nassociated MessageContext (testing, mostly).\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@253857 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/b15a908001570d480f4d77da33e11e5fdb24199f",
        "repo": "axis1-java",
        "unit_tests": [
            "TestMessageElement.java"
        ]
    },
    "axis1-java_0895bf0": {
        "bug_id": "axis1-java_0895bf0",
        "commit": "https://github.com/apache/axis1-java/commit/0895bf0eac090e22dd7f6e0de0d3e4b2c020f098",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/0895bf0eac090e22dd7f6e0de0d3e4b2c020f098/src/org/apache/axis/message/MessageElement.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/MessageElement.java?ref=0895bf0eac090e22dd7f6e0de0d3e4b2c020f098",
                "deletions": 2,
                "filename": "src/org/apache/axis/message/MessageElement.java",
                "patch": "@@ -620,8 +620,10 @@ public final void output(SerializationContext context) throws Exception\n          * whatever encoding style is in scope....\n          */ \n         if (encodingStyle != null) {\n-            SOAPConstants soapConstants = context.getMessageContext().\n-                                                        getSOAPConstants();\n+            MessageContext mc = context.getMessageContext();\n+            SOAPConstants soapConstants = (mc != null) ?\n+                                            mc.getSOAPConstants() :\n+                                            SOAPConstants.SOAP11_CONSTANTS;\n             if (parent == null) {\n                 // don't emit an encoding style if its \"\" (literal)\n                 if (!encodingStyle.equals(\"\")) { ",
                "raw_url": "https://github.com/apache/axis1-java/raw/0895bf0eac090e22dd7f6e0de0d3e4b2c020f098/src/org/apache/axis/message/MessageElement.java",
                "sha": "daa12845f6df9aeee5a64bfb964f33a38be8bd95",
                "status": "modified"
            }
        ],
        "message": "Fix NPE in weird cases where a SerializationContext doesn't have an\nassociated MessageContext (testing, mostly).\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@246784 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/b67d0b30cc0ccded69b6407c6ed46b6ef5573706",
        "repo": "axis1-java",
        "unit_tests": [
            "TestMessageElement.java"
        ]
    },
    "axis1-java_0e1cc28": {
        "bug_id": "axis1-java_0e1cc28",
        "commit": "https://github.com/apache/axis1-java/commit/0e1cc2864952d690b15018f483bdcc0c752abe07",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPBody.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPBody.java?ref=0e1cc2864952d690b15018f483bdcc0c752abe07",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPBody.java",
                "patch": "@@ -91,7 +91,9 @@ public void setParentElement(SOAPElement parent) throws SOAPException {\n     }\n \n     public void detachNode() {\n-        ((SOAPEnvelope)parent).removeBody();\n+        if (parent != null) {\n+            ((SOAPEnvelope)parent).removeBody();\n+        }\n         super.detachNode();\n     }\n    ",
                "raw_url": "https://github.com/apache/axis1-java/raw/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPBody.java",
                "sha": "39ea569e46afcb155d86962209cd670b4a916e97",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPBodyElement.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPBodyElement.java?ref=0e1cc2864952d690b15018f483bdcc0c752abe07",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPBodyElement.java",
                "patch": "@@ -93,7 +93,9 @@ public void setParentElement(SOAPElement parent) throws SOAPException {\n     }\n \n     public void detachNode() {\n-        ((SOAPBody)parent).removeBodyElement(this);\n+        if (parent != null) {\n+            ((SOAPBody)parent).removeBodyElement(this);\n+        }\n         super.detachNode();\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPBodyElement.java",
                "sha": "d8cec150597520ed1510230dc2bde2bc641c5b41",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPHeader.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPHeader.java?ref=0e1cc2864952d690b15018f483bdcc0c752abe07",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPHeader.java",
                "patch": "@@ -87,7 +87,9 @@ public void setParentElement(SOAPElement parent) throws SOAPException {\n     }\n \n     public void detachNode() {\n-        ((SOAPEnvelope)parent).removeHeaders();\n+        if (parent != null) {\n+            ((SOAPEnvelope)parent).removeHeaders();\n+        }\n         super.detachNode();\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPHeader.java",
                "sha": "7dae66707d6b80ed19a9a0cc009f218acf37c16c",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPHeaderElement.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPHeaderElement.java?ref=0e1cc2864952d690b15018f483bdcc0c752abe07",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPHeaderElement.java",
                "patch": "@@ -110,7 +110,9 @@ public void setParentElement(SOAPElement parent) throws SOAPException {\n     }\n \n     public void detachNode() {\n-        ((SOAPHeader)parent).removeHeader(this);\n+        if (parent != null) {\n+            ((SOAPHeader)parent).removeHeader(this);\n+        }\n         super.detachNode();\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/0e1cc2864952d690b15018f483bdcc0c752abe07/src/org/apache/axis/message/SOAPHeaderElement.java",
                "sha": "81074378f78a31d1c204fe9dcec934aac4b76857",
                "status": "modified"
            }
        ],
        "message": "Bug fix of AXIS-1248 at http://issues.apache.org/jira/secure/ViewIssue.jspa?key=AXIS-1248\n- Prevent NPE during detachNode in case of parent's null.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@257482 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/d5896b76df59057fb126925b275bf71268877c9e",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPBody.java",
            "TestSOAPHeader.java"
        ]
    },
    "axis1-java_1aa65d4": {
        "bug_id": "axis1-java_1aa65d4",
        "commit": "https://github.com/apache/axis1-java/commit/1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/description/OperationDesc.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/OperationDesc.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "src/org/apache/axis/description/OperationDesc.java",
                "patch": "@@ -205,6 +205,9 @@ public void addParameter(ParameterDesc param)\n \n     public ParameterDesc getParameter(int i)\n     {\n+        if (parameters.size() <= i)\n+            return null;\n+\n         return (ParameterDesc)parameters.get(i);\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/description/OperationDesc.java",
                "sha": "5e6952d1578c2831b9ec82ec780c701b2909bde9",
                "status": "modified"
            },
            {
                "additions": 37,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 43,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 6,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -318,7 +318,7 @@ public OperationDesc getOperationByElementQName(QName qname)\n      * Search the declared methods on the implementation class to find one\n      * with an argument list which matches our parameter list.\n      */\n-    private void syncOperationToClass(OperationDesc oper)\n+    private void syncOperationToClass(OperationDesc oper, Class implClass)\n     {\n         // If we're already mapped to a Java method, no need to do anything.\n         if (oper.getMethod() != null)\n@@ -372,6 +372,13 @@ private void syncOperationToClass(OperationDesc oper)\n                 return;\n             }\n         }\n+\n+        // Didn't find a match.  Try the superclass, if appropriate\n+        Class superClass = implClass.getSuperclass();\n+        if (!superClass.getName().startsWith(\"java.\") &&\n+                !superClass.getName().startsWith(\"javax.\")) {\n+            syncOperationToClass(oper, superClass);\n+        }\n     }\n \n     /**\n@@ -467,14 +474,14 @@ private void getSyncedOperationsForName(String methodName)\n         // OK, go find any current OperationDescs for this method name and\n         // make sure they're synced with the actual class.\n         if (name2OperationsMap != null) {\n-            ArrayList currentOverloads = \n+            ArrayList currentOverloads =\n                     (ArrayList)name2OperationsMap.get(methodName);\n             if (currentOverloads != null) {\n                 // For each one, sync it to the implementation class' methods\n                 for (Iterator i = currentOverloads.iterator(); i.hasNext();) {\n                     OperationDesc oper = (OperationDesc) i.next();\n                     if (oper.getMethod() == null) {\n-                        syncOperationToClass(oper);\n+                        syncOperationToClass(oper, implClass);\n                     }\n                 }\n             }\n@@ -483,16 +490,40 @@ private void getSyncedOperationsForName(String methodName)\n         // Now all OperationDescs from deployment data have been completely\n         // filled in.  So we now make new OperationDescs for any method\n         // overloads which were not covered above.\n+        // NOTE : This is the \"lenient\" approach, which allows you to\n+        // specify one overload and still get the others by introspection.\n+        // We could equally well return above if we found OperationDescs,\n+        // and have a rule that if you specify any overloads, you must specify\n+        // all the ones you want accessible.\n+\n+        createOperationsForName(implClass, methodName);\n+\n+        // Note that we never have to look at this method name again.\n+        completedNames.add(methodName);\n+    }\n+\n+    /**\n+     * Look for methods matching this name, and for each one, create an\n+     * OperationDesc (if it's not already in our list).\n+     *\n+     * TODO: Make this more efficient\n+     */\n+    private void createOperationsForName(Class implClass, String methodName)\n+    {\n         Method [] methods = implClass.getDeclaredMethods();\n \n         for (int i = 0; i < methods.length; i++) {\n             Method method = methods[i];\n-            if (method.getName().equals(methodName))\n+            if (method.getName().equals(methodName)) {\n                 createOperationForMethod(method);\n+            }\n         }\n \n-        // Note that we never have to look at this method name again.\n-        completedNames.add(methodName);\n+        Class superClass = implClass.getSuperclass();\n+        if (!superClass.getName().startsWith(\"java.\") &&\n+                !superClass.getName().startsWith(\"javax.\")) {\n+            createOperationsForName(superClass, methodName);\n+        }\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "661eda728f0c1d5de67a6bab207592d8b7bbb294",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/message/RPCElement.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCElement.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "src/org/apache/axis/message/RPCElement.java",
                "patch": "@@ -234,6 +234,9 @@ public void deserialize() throws SAXException\n                     }\n                 }\n             }\n+\n+            throw new SAXException(\n+                    JavaUtils.getMessage(\"noSuchOperation\", name));\n         }\n \n         if (elementIsFirstParam) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/message/RPCElement.java",
                "sha": "95ce64cbeb48bb4d4f55cfaeaae25fb439987a9d",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/providers/java/RPCProvider.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/RPCProvider.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "src/org/apache/axis/providers/java/RPCProvider.java",
                "patch": "@@ -153,6 +153,11 @@ public void processMessage (MessageContext msgContext,\n                 operation = serviceDesc.getOperationByElementQName(qname);\n             }\n \n+            if (operation == null) {\n+                throw new AxisFault(JavaUtils.getMessage(\"noSuchOperation\",\n+                                                         methodName));\n+            }\n+\n             // Create the array we'll use to hold the actual parameter\n             // values.  We know how big to make it from the metadata.\n             Object[]     argValues  =  new Object [operation.getNumParams()];",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/providers/java/RPCProvider.java",
                "sha": "2a0c1d29b80f75f056cae4dd6bdc110a7d409dc1",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/utils/resources.properties",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/resources.properties?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/resources.properties",
                "patch": "@@ -795,3 +795,4 @@ optionHelper00=emits separate Helper classes for meta data\n badParameterMode=Invalid parameter mode byte ({0}) passed to getModeAsString().\n \n attach.bounday.mns=Marking streams not supported.\n+noSuchOperation=No such operation ''{0}''\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/src/org/apache/axis/utils/resources.properties",
                "sha": "d15874139e77724a15b8ffd8d6171e1a9b5d595c",
                "status": "modified"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/Child.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/Child.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "test/inheritance/Child.java",
                "patch": "@@ -0,0 +1,16 @@\n+package test.inheritance;\n+\n+public class Child extends Parent {\n+    public static final String HELLO_MSG = \"Hello from the Child class\";\n+    public static final String OVERLOAD_MSG = \"The Child got \";\n+\n+    public String normal()\n+    {\n+        return HELLO_MSG;\n+    }\n+\n+    public String overloaded(int i)\n+    {\n+        return OVERLOAD_MSG + i;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/Child.java",
                "sha": "f53c5c604790cfebf5b35adaae76ccd916b4f2bd",
                "status": "added"
            },
            {
                "additions": 73,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/PackageTests.java",
                "changes": 73,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/PackageTests.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "test/inheritance/PackageTests.java",
                "patch": "@@ -0,0 +1,73 @@\n+/*\n+ * The Apache Software License, Version 1.1\n+ *\n+ *\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution,\n+ *    if any, must include the following acknowledgment:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowledgment may appear in the software itself,\n+ *    if and wherever such third-party acknowledgments normally appear.\n+ *\n+ * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n+ *    not be used to endorse or promote products derived from this\n+ *    software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\",\n+ *    nor may \"Apache\" appear in their name, without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+\n+package test.inheritance;\n+\n+import junit.framework.Test;\n+import junit.framework.TestCase;\n+import junit.framework.TestSuite;\n+\n+public class PackageTests extends TestCase {\n+\n+    public PackageTests(String name) {\n+        super(name);\n+    }\n+\n+    public static Test suite() throws Exception {\n+        TestSuite suite = new TestSuite();\n+        suite.addTestSuite(TestInheritance.class);\n+        return suite;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/PackageTests.java",
                "sha": "641928dff1f15a00bc0768bd98e0f13812cb6484",
                "status": "added"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/Parent.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/Parent.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "test/inheritance/Parent.java",
                "patch": "@@ -0,0 +1,16 @@\n+package test.inheritance;\n+\n+public class Parent {\n+    public static final String HELLO_MSG = \"Hello from the Parent class!\";\n+    public static final String OVERLOAD_MSG = \"The Parent got \";\n+\n+    public String inherited()\n+    {\n+        return HELLO_MSG;\n+    }\n+\n+    public String overloaded(String param)\n+    {\n+        return OVERLOAD_MSG + param;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/Parent.java",
                "sha": "8fcceb2a6eca5c90b8fe7e7e59643ec5a5f5aa3c",
                "status": "added"
            },
            {
                "additions": 54,
                "blob_url": "https://github.com/apache/axis1-java/blob/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/TestInheritance.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/TestInheritance.java?ref=1aa65d4b428062d3d897a499f1c6e5640ecadb0b",
                "deletions": 0,
                "filename": "test/inheritance/TestInheritance.java",
                "patch": "@@ -0,0 +1,54 @@\n+package test.inheritance;\n+\n+import junit.framework.TestCase;\n+import org.apache.axis.handlers.soap.SOAPService;\n+import org.apache.axis.providers.java.RPCProvider;\n+import org.apache.axis.configuration.SimpleProvider;\n+import org.apache.axis.server.AxisServer;\n+import org.apache.axis.transport.local.LocalTransport;\n+import org.apache.axis.client.Call;\n+import org.apache.axis.client.Service;\n+\n+public class TestInheritance extends TestCase {\n+    private AxisServer server;\n+    private LocalTransport transport;\n+\n+    public TestInheritance(String s) {\n+        super(s);\n+    }\n+\n+    protected void setUp() throws Exception {\n+        SimpleProvider config = new SimpleProvider();\n+\n+        SOAPService service = new SOAPService(new RPCProvider());\n+        service.setOption(\"className\", \"test.inheritance.Child\");\n+        service.setOption(\"allowedMethods\", \"*\");\n+        config.deployService(\"inheritanceTest\", service);\n+\n+        server = new AxisServer(config);\n+        transport = new LocalTransport(server);\n+        transport.setRemoteService(\"inheritanceTest\");\n+    }\n+\n+    public void testInheritance() throws Exception {\n+        Call call = new Call(new Service());\n+        call.setTransport(transport);\n+\n+        String ret = (String)call.invoke(\"inherited\", null);\n+        assertEquals(\"Inherited method returned bad result\",\n+                Parent.HELLO_MSG, ret);\n+\n+        ret = (String)call.invoke(\"normal\", null);\n+        assertEquals(\"Child method returned bad result\",\n+                Child.HELLO_MSG, ret);\n+\n+        ret = (String)call.invoke(\"overloaded\", new Object [] { \"test\" });\n+        assertTrue(\"Overloaded (String) method returned bad result\",\n+                ret.startsWith(Parent.OVERLOAD_MSG));\n+        ret = (String)call.invoke(\"overloaded\",\n+                                  new Object [] { new Integer(5) });\n+        assertTrue(\"Overloaded (int) method returned bad result\",\n+                ret.startsWith(Child.OVERLOAD_MSG));\n+\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/1aa65d4b428062d3d897a499f1c6e5640ecadb0b/test/inheritance/TestInheritance.java",
                "sha": "d1edde858e4c2fcef284627c291b38b71ae106aa",
                "status": "added"
            }
        ],
        "message": "* First part of inheritance code in ServiceDesc - walk up the inheritance\n  tree when syncing/creating methods, stopping at \"java.*\" or \"javax.*\"\n  classes.  Will add configurable \"stop classes\" to this soon.\n\n* Add unit test to make sure inheritance code works, and that we\n  correctly resolve methods in a few situations.\n\n* Make code a little tighter in a few places, throw faults instead of\n  potential NPEs\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@253899 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/77c76425e23619e4f7d1249f5718f9acbb171cf5",
        "repo": "axis1-java",
        "unit_tests": [
            "TestServiceDesc.java"
        ]
    },
    "axis1-java_2b129fc": {
        "bug_id": "axis1-java_2b129fc",
        "commit": "https://github.com/apache/axis1-java/commit/2b129fc80d8083d05d1cfb5871a5f012ceb051ec",
        "file": [
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java?ref=2b129fc80d8083d05d1cfb5871a5f012ceb051ec",
                "deletions": 6,
                "filename": "src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "patch": "@@ -202,13 +202,15 @@ public void undeployFromRegistry(WSDDDeployment registry)\n             qname = (QName)services.get(n);\n  \n             try {\n-              String sname = qname.getLocalPart();\n-              SOAPService service = MessageContext.getCurrentContext()\n-                                                  .getAxisEngine()\n-                                                  .getService(sname);\n-              if ( service != null ) service.clearSessions();\n+                String sname = qname.getLocalPart();\n+                MessageContext messageContext = MessageContext.getCurrentContext();\n+                if (messageContext != null) {\n+                    SOAPService service = messageContext.getAxisEngine()\n+                            .getService(sname);\n+                    if ( service != null ) service.clearSessions();\n+                }\n             } catch(Exception exp) {\n-              throw new ConfigurationException(exp);\n+                throw new ConfigurationException(exp);\n             }\n             registry.undeployService(qname);\n         }",
                "raw_url": "https://github.com/apache/axis1-java/raw/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "sha": "ae4e3de4de64d0b11c8ea71b1485f93b13de7002",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/handlers/JWSHandler.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/JWSHandler.java?ref=2b129fc80d8083d05d1cfb5871a5f012ceb051ec",
                "deletions": 0,
                "filename": "src/org/apache/axis/handlers/JWSHandler.java",
                "patch": "@@ -300,6 +300,7 @@ protected void setupService(MessageContext msgContext) throws Exception {\n             SOAPService rpc = (SOAPService)soapServices.get(clsName);\n             if (rpc == null) {\n                 rpc = new SOAPService(new RPCProvider());\n+                rpc.setName(clsName);\n                 rpc.setOption(RPCProvider.OPTION_CLASSNAME, clsName );\n                 rpc.setEngine(msgContext.getAxisEngine());\n                 ",
                "raw_url": "https://github.com/apache/axis1-java/raw/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/handlers/JWSHandler.java",
                "sha": "fe5137e7fe5ce0a15ae57dadb30fe0648b1b8d15",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/handlers/soap/SOAPService.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/soap/SOAPService.java?ref=2b129fc80d8083d05d1cfb5871a5f012ceb051ec",
                "deletions": 5,
                "filename": "src/org/apache/axis/handlers/soap/SOAPService.java",
                "patch": "@@ -199,11 +199,11 @@ public ArrayList getActors() {\n     \n \n     /**\n-     * SOAPResponseHandler is used to inject SOAP semantics just before\n+     * MustUnderstandChecker is used to inject SOAP semantics just before\n      * the pivot handler.\n      */\n-    private class SOAPResponseHandler extends BasicHandler {\n-        public SOAPResponseHandler() {}\n+    private class MustUnderstandChecker extends BasicHandler {\n+        public MustUnderstandChecker() {}\n \n         public void invoke(MessageContext msgContext) throws AxisFault {\n             // Do SOAP semantics here\n@@ -291,7 +291,7 @@ public SOAPService()\n     public SOAPService(Handler reqHandler, Handler pivHandler,\n                        Handler respHandler) {\n         this();\n-        init(reqHandler, null, pivHandler, new SOAPResponseHandler(), respHandler);\n+        init(reqHandler, new MustUnderstandChecker(), pivHandler, null, respHandler);\n     }\n \n     public TypeMappingRegistry getTypeMappingRegistry()\n@@ -304,7 +304,7 @@ public TypeMappingRegistry getTypeMappingRegistry()\n      */\n     public SOAPService(Handler serviceHandler)\n     {\n-        init(null, null, serviceHandler, new SOAPResponseHandler(), null);\n+        init(null, new MustUnderstandChecker(), serviceHandler, null, null);\n     }\n     \n     /** Tell this service which engine it's deployed to.",
                "raw_url": "https://github.com/apache/axis1-java/raw/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/src/org/apache/axis/handlers/soap/SOAPService.java",
                "sha": "26e97eea64deb4aa33b044367a953de37b9d9988",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/test/functional/build.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/functional/build.xml?ref=2b129fc80d8083d05d1cfb5871a5f012ceb051ec",
                "deletions": 0,
                "filename": "test/functional/build.xml",
                "patch": "@@ -68,6 +68,7 @@ Copyright:\n    <path id=\"deploy.xml.files\">\n        <fileset dir=\"${build.dir}\">\n           <include name=\"work/samples/**/deploy.wsdd\"/>\n+          <include name=\"work/test/rpc/deploy.wsdd\"/>\n        </fileset>\n    </path>\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/2b129fc80d8083d05d1cfb5871a5f012ceb051ec/test/functional/build.xml",
                "sha": "6cfc8873f5024c7d6f61d54d37ab1021282410c8",
                "status": "modified"
            }
        ],
        "message": "The main purpose of this checkin is to move the special handler in SOAPService back to the correct place *before* the pivot point when executing a service.  This makes SOAP 1.1/1.2 semantics much clearer, in that Handlers on the request chain should have already marked all MU headers as processed before you perform the \"meat\" of your service work.\n\nAlong the way fix a few bugs which were preventing me from building all-tests.\n\n* SOAPResponseHandler -> MustUnderstandChecker (since that's what it does),\n  and it executes before the pivot\n\n* JWS services are now named for their class name; this prevents an NPE\n  when calling SOAPService.addSession() (since JWS services are now session\n  scoped by default (when did *that* happen?))\n\n* Make sure to deploy test/rpc/deploy.wsdd before running the test which\n  uses it in test/functional - NOTE: why is test/rpc there at all?  There\n  aren't any tests in there!\n\n* Check for null currentContext in WSDDUndeployment - this was crashing\n  the test/wsdl/jaxrpchandler tests with an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249461 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/ce96030c816b3157004ffdae4aa0242cc7361e10",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPService.java"
        ]
    },
    "axis1-java_33ecf56": {
        "bug_id": "axis1-java_33ecf56",
        "commit": "https://github.com/apache/axis1-java/commit/33ecf56d16ac7806599959f2f66a3ad66dbac1af",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/33ecf56d16ac7806599959f2f66a3ad66dbac1af/src/org/apache/axis/message/SOAPHeader.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPHeader.java?ref=33ecf56d16ac7806599959f2f66a3ad66dbac1af",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPHeader.java",
                "patch": "@@ -94,7 +94,7 @@\n     SOAPHeader(SOAPEnvelope env, SOAPConstants soapConsts) {\n         super(Constants.ELEM_HEADER,\n               Constants.NS_PREFIX_SOAP_ENV,\n-              soapConsts.getEnvelopeURI());\n+              soapConsts != null? soapConsts.getEnvelopeURI() : SOAPConstants.SOAP11_CONSTANTS.getEnvelopeURI());\n         soapConstants = soapConsts;\n         try {\n             setParentElement(env);",
                "raw_url": "https://github.com/apache/axis1-java/raw/33ecf56d16ac7806599959f2f66a3ad66dbac1af/src/org/apache/axis/message/SOAPHeader.java",
                "sha": "bfc61828efd0604afd7386ecb73b27cbf8a3c190",
                "status": "modified"
            }
        ],
        "message": "Prevent NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256088 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/3cc028b04da2ce3eb947ed8e7cc759d2be040b7e",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPHeader.java"
        ]
    },
    "axis1-java_3a4360e": {
        "bug_id": "axis1-java_3a4360e",
        "commit": "https://github.com/apache/axis1-java/commit/3a4360e9bba592601aa1cf2d446ade5e278258ee",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/3a4360e9bba592601aa1cf2d446ade5e278258ee/build.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/build.xml?ref=3a4360e9bba592601aa1cf2d446ade5e278258ee",
                "deletions": 1,
                "filename": "build.xml",
                "patch": "@@ -352,7 +352,7 @@ Copyright:\n   <!-- =================================================================== -->\n   <!-- Creates the binary distribution                                     -->\n   <!-- =================================================================== -->\n-  <target name=\"dist\" depends=\"compile, junit, samples, javadocs\" >\n+  <target name=\"dist\" depends=\"compile, javadocs, samples, junit\" >\n     <mkdir dir=\"${dist.dir}\"/>\n     <mkdir dir=\"${dist.dir}/docs\"/>\n     <mkdir dir=\"${dist.dir}/docs/apiDocs\"/>",
                "raw_url": "https://github.com/apache/axis1-java/raw/3a4360e9bba592601aa1cf2d446ade5e278258ee/build.xml",
                "sha": "cfa78eb315a6e87f8637b97a4b7187e467af32ee",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/3a4360e9bba592601aa1cf2d446ade5e278258ee/src/org/apache/axis/utils/Admin.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=3a4360e9bba592601aa1cf2d446ade5e278258ee",
                "deletions": 1,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -383,7 +383,7 @@ public Document process(MessageContext msgContext, Element root)\n         AxisEngine engine = msgContext.getAxisEngine();\n         \n         // If this is WSDD, process it correctly.\n-        if (rootNS.equals(WSDDConstants.WSDD_NS)) {\n+        if (rootNS != null && rootNS.equals(WSDDConstants.WSDD_NS)) {\n             return processWSDD(engine, root);\n         }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/3a4360e9bba592601aa1cf2d446ade5e278258ee/src/org/apache/axis/utils/Admin.java",
                "sha": "2db593def8632b03e3a725dbe36e2009ca31c1d9",
                "status": "modified"
            }
        ],
        "message": "Fix NPE.\nChange order of build - seemed odd that we ran junit before we built\neverything.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@252785 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/a87914989c48837bd646567db9eb63245f75962a",
        "repo": "axis1-java",
        "unit_tests": [
            "AdminTest.java"
        ]
    },
    "axis1-java_49fd755": {
        "bug_id": "axis1-java_49fd755",
        "commit": "https://github.com/apache/axis1-java/commit/49fd755fa00ac64425a7100d10bcd16759d2930b",
        "file": [
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/49fd755fa00ac64425a7100d10bcd16759d2930b/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 22,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=49fd755fa00ac64425a7100d10bcd16759d2930b",
                "deletions": 10,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -657,16 +657,18 @@ private void syncOperationToClass(OperationDesc oper, Class implClass)\n                             paramClass = tm.getClassForQName(param.getTypeQName());\n                         }\n \n-                        // This is a match if the paramClass is somehow\n-                        // convertable to the \"real\" parameter type.  If not,\n-                        // break out of this loop.\n-                        if (!JavaUtils.isConvertable(paramClass, actualType)) {\n-                            break;\n-                        }\n-                        \n-                        if (!actualType.isAssignableFrom(paramClass)) {\n-                            // This doesn't fit without conversion\n-                            conversionNecessary = true;\n+                        if (paramClass != null) {\n+                            // This is a match if the paramClass is somehow\n+                            // convertable to the \"real\" parameter type.  If not,\n+                            // break out of this loop.\n+                            if (!JavaUtils.isConvertable(paramClass, actualType)) {\n+                                break;\n+                            }\n+                            \n+                            if (!actualType.isAssignableFrom(paramClass)) {\n+                                // This doesn't fit without conversion\n+                                conversionNecessary = true;\n+                            }\n                         }\n                     }\n                     // In all scenarios the ParameterDesc javaType is set to",
                "raw_url": "https://github.com/apache/axis1-java/raw/49fd755fa00ac64425a7100d10bcd16759d2930b/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "0f82326b9c1914680d74a6a0033be3be3f81563f",
                "status": "modified"
            }
        ],
        "message": "Prevent NPE in case there are problems finding the paramClass\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256207 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/c55ef243d5139650e8fc5526a7cfcef1ac23ccbe",
        "repo": "axis1-java",
        "unit_tests": [
            "TestServiceDesc.java"
        ]
    },
    "axis1-java_4c7981c": {
        "bug_id": "axis1-java_4c7981c",
        "commit": "https://github.com/apache/axis1-java/commit/4c7981c7aa5eebfb29410dd4b20caf078b44db89",
        "file": [
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java?ref=4c7981c7aa5eebfb29410dd4b20caf078b44db89",
                "deletions": 6,
                "filename": "src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "patch": "@@ -202,13 +202,15 @@ public void undeployFromRegistry(WSDDDeployment registry)\n             qname = (QName)services.get(n);\n  \n             try {\n-              String sname = qname.getLocalPart();\n-              SOAPService service = MessageContext.getCurrentContext()\n-                                                  .getAxisEngine()\n-                                                  .getService(sname);\n-              if ( service != null ) service.clearSessions();\n+                String sname = qname.getLocalPart();\n+                MessageContext messageContext = MessageContext.getCurrentContext();\n+                if (messageContext != null) {\n+                    SOAPService service = messageContext.getAxisEngine()\n+                            .getService(sname);\n+                    if ( service != null ) service.clearSessions();\n+                }\n             } catch(Exception exp) {\n-              throw new ConfigurationException(exp);\n+                throw new ConfigurationException(exp);\n             }\n             registry.undeployService(qname);\n         }",
                "raw_url": "https://github.com/apache/axis1-java/raw/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/deployment/wsdd/WSDDUndeployment.java",
                "sha": "ae4e3de4de64d0b11c8ea71b1485f93b13de7002",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/handlers/JWSHandler.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/JWSHandler.java?ref=4c7981c7aa5eebfb29410dd4b20caf078b44db89",
                "deletions": 0,
                "filename": "src/org/apache/axis/handlers/JWSHandler.java",
                "patch": "@@ -300,6 +300,7 @@ protected void setupService(MessageContext msgContext) throws Exception {\n             SOAPService rpc = (SOAPService)soapServices.get(clsName);\n             if (rpc == null) {\n                 rpc = new SOAPService(new RPCProvider());\n+                rpc.setName(clsName);\n                 rpc.setOption(RPCProvider.OPTION_CLASSNAME, clsName );\n                 rpc.setEngine(msgContext.getAxisEngine());\n                 ",
                "raw_url": "https://github.com/apache/axis1-java/raw/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/handlers/JWSHandler.java",
                "sha": "fe5137e7fe5ce0a15ae57dadb30fe0648b1b8d15",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/handlers/soap/SOAPService.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/soap/SOAPService.java?ref=4c7981c7aa5eebfb29410dd4b20caf078b44db89",
                "deletions": 5,
                "filename": "src/org/apache/axis/handlers/soap/SOAPService.java",
                "patch": "@@ -199,11 +199,11 @@ public ArrayList getActors() {\n     \n \n     /**\n-     * SOAPResponseHandler is used to inject SOAP semantics just before\n+     * MustUnderstandChecker is used to inject SOAP semantics just before\n      * the pivot handler.\n      */\n-    private class SOAPResponseHandler extends BasicHandler {\n-        public SOAPResponseHandler() {}\n+    private class MustUnderstandChecker extends BasicHandler {\n+        public MustUnderstandChecker() {}\n \n         public void invoke(MessageContext msgContext) throws AxisFault {\n             // Do SOAP semantics here\n@@ -291,7 +291,7 @@ public SOAPService()\n     public SOAPService(Handler reqHandler, Handler pivHandler,\n                        Handler respHandler) {\n         this();\n-        init(reqHandler, null, pivHandler, new SOAPResponseHandler(), respHandler);\n+        init(reqHandler, new MustUnderstandChecker(), pivHandler, null, respHandler);\n     }\n \n     public TypeMappingRegistry getTypeMappingRegistry()\n@@ -304,7 +304,7 @@ public TypeMappingRegistry getTypeMappingRegistry()\n      */\n     public SOAPService(Handler serviceHandler)\n     {\n-        init(null, null, serviceHandler, new SOAPResponseHandler(), null);\n+        init(null, new MustUnderstandChecker(), serviceHandler, null, null);\n     }\n     \n     /** Tell this service which engine it's deployed to.",
                "raw_url": "https://github.com/apache/axis1-java/raw/4c7981c7aa5eebfb29410dd4b20caf078b44db89/src/org/apache/axis/handlers/soap/SOAPService.java",
                "sha": "26e97eea64deb4aa33b044367a953de37b9d9988",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/4c7981c7aa5eebfb29410dd4b20caf078b44db89/test/functional/build.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/functional/build.xml?ref=4c7981c7aa5eebfb29410dd4b20caf078b44db89",
                "deletions": 0,
                "filename": "test/functional/build.xml",
                "patch": "@@ -68,6 +68,7 @@ Copyright:\n    <path id=\"deploy.xml.files\">\n        <fileset dir=\"${build.dir}\">\n           <include name=\"work/samples/**/deploy.wsdd\"/>\n+          <include name=\"work/test/rpc/deploy.wsdd\"/>\n        </fileset>\n    </path>\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/4c7981c7aa5eebfb29410dd4b20caf078b44db89/test/functional/build.xml",
                "sha": "6cfc8873f5024c7d6f61d54d37ab1021282410c8",
                "status": "modified"
            }
        ],
        "message": "The main purpose of this checkin is to move the special handler in SOAPService back to the correct place *before* the pivot point when executing a service.  This makes SOAP 1.1/1.2 semantics much clearer, in that Handlers on the request chain should have already marked all MU headers as processed before you perform the \"meat\" of your service work.\n\nAlong the way fix a few bugs which were preventing me from building all-tests.\n\n* SOAPResponseHandler -> MustUnderstandChecker (since that's what it does),\n  and it executes before the pivot\n\n* JWS services are now named for their class name; this prevents an NPE\n  when calling SOAPService.addSession() (since JWS services are now session\n  scoped by default (when did *that* happen?))\n\n* Make sure to deploy test/rpc/deploy.wsdd before running the test which\n  uses it in test/functional - NOTE: why is test/rpc there at all?  There\n  aren't any tests in there!\n\n* Check for null currentContext in WSDDUndeployment - this was crashing\n  the test/wsdl/jaxrpchandler tests with an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256530 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/bf40d70781914756d1be0cfa4c29eced8f579028",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPService.java"
        ]
    },
    "axis1-java_69dec1d": {
        "bug_id": "axis1-java_69dec1d",
        "commit": "https://github.com/apache/axis1-java/commit/69dec1dea1774b5e7740bfbba966b3eba4e6af02",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/description/OperationDesc.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/OperationDesc.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "src/org/apache/axis/description/OperationDesc.java",
                "patch": "@@ -205,6 +205,9 @@ public void addParameter(ParameterDesc param)\n \n     public ParameterDesc getParameter(int i)\n     {\n+        if (parameters.size() <= i)\n+            return null;\n+\n         return (ParameterDesc)parameters.get(i);\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/description/OperationDesc.java",
                "sha": "5e6952d1578c2831b9ec82ec780c701b2909bde9",
                "status": "modified"
            },
            {
                "additions": 37,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 43,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 6,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -318,7 +318,7 @@ public OperationDesc getOperationByElementQName(QName qname)\n      * Search the declared methods on the implementation class to find one\n      * with an argument list which matches our parameter list.\n      */\n-    private void syncOperationToClass(OperationDesc oper)\n+    private void syncOperationToClass(OperationDesc oper, Class implClass)\n     {\n         // If we're already mapped to a Java method, no need to do anything.\n         if (oper.getMethod() != null)\n@@ -372,6 +372,13 @@ private void syncOperationToClass(OperationDesc oper)\n                 return;\n             }\n         }\n+\n+        // Didn't find a match.  Try the superclass, if appropriate\n+        Class superClass = implClass.getSuperclass();\n+        if (!superClass.getName().startsWith(\"java.\") &&\n+                !superClass.getName().startsWith(\"javax.\")) {\n+            syncOperationToClass(oper, superClass);\n+        }\n     }\n \n     /**\n@@ -467,14 +474,14 @@ private void getSyncedOperationsForName(String methodName)\n         // OK, go find any current OperationDescs for this method name and\n         // make sure they're synced with the actual class.\n         if (name2OperationsMap != null) {\n-            ArrayList currentOverloads = \n+            ArrayList currentOverloads =\n                     (ArrayList)name2OperationsMap.get(methodName);\n             if (currentOverloads != null) {\n                 // For each one, sync it to the implementation class' methods\n                 for (Iterator i = currentOverloads.iterator(); i.hasNext();) {\n                     OperationDesc oper = (OperationDesc) i.next();\n                     if (oper.getMethod() == null) {\n-                        syncOperationToClass(oper);\n+                        syncOperationToClass(oper, implClass);\n                     }\n                 }\n             }\n@@ -483,16 +490,40 @@ private void getSyncedOperationsForName(String methodName)\n         // Now all OperationDescs from deployment data have been completely\n         // filled in.  So we now make new OperationDescs for any method\n         // overloads which were not covered above.\n+        // NOTE : This is the \"lenient\" approach, which allows you to\n+        // specify one overload and still get the others by introspection.\n+        // We could equally well return above if we found OperationDescs,\n+        // and have a rule that if you specify any overloads, you must specify\n+        // all the ones you want accessible.\n+\n+        createOperationsForName(implClass, methodName);\n+\n+        // Note that we never have to look at this method name again.\n+        completedNames.add(methodName);\n+    }\n+\n+    /**\n+     * Look for methods matching this name, and for each one, create an\n+     * OperationDesc (if it's not already in our list).\n+     *\n+     * TODO: Make this more efficient\n+     */\n+    private void createOperationsForName(Class implClass, String methodName)\n+    {\n         Method [] methods = implClass.getDeclaredMethods();\n \n         for (int i = 0; i < methods.length; i++) {\n             Method method = methods[i];\n-            if (method.getName().equals(methodName))\n+            if (method.getName().equals(methodName)) {\n                 createOperationForMethod(method);\n+            }\n         }\n \n-        // Note that we never have to look at this method name again.\n-        completedNames.add(methodName);\n+        Class superClass = implClass.getSuperclass();\n+        if (!superClass.getName().startsWith(\"java.\") &&\n+                !superClass.getName().startsWith(\"javax.\")) {\n+            createOperationsForName(superClass, methodName);\n+        }\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "661eda728f0c1d5de67a6bab207592d8b7bbb294",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/message/RPCElement.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCElement.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "src/org/apache/axis/message/RPCElement.java",
                "patch": "@@ -234,6 +234,9 @@ public void deserialize() throws SAXException\n                     }\n                 }\n             }\n+\n+            throw new SAXException(\n+                    JavaUtils.getMessage(\"noSuchOperation\", name));\n         }\n \n         if (elementIsFirstParam) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/message/RPCElement.java",
                "sha": "95ce64cbeb48bb4d4f55cfaeaae25fb439987a9d",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/providers/java/RPCProvider.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/RPCProvider.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "src/org/apache/axis/providers/java/RPCProvider.java",
                "patch": "@@ -153,6 +153,11 @@ public void processMessage (MessageContext msgContext,\n                 operation = serviceDesc.getOperationByElementQName(qname);\n             }\n \n+            if (operation == null) {\n+                throw new AxisFault(JavaUtils.getMessage(\"noSuchOperation\",\n+                                                         methodName));\n+            }\n+\n             // Create the array we'll use to hold the actual parameter\n             // values.  We know how big to make it from the metadata.\n             Object[]     argValues  =  new Object [operation.getNumParams()];",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/providers/java/RPCProvider.java",
                "sha": "2a0c1d29b80f75f056cae4dd6bdc110a7d409dc1",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/utils/resources.properties",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/resources.properties?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/resources.properties",
                "patch": "@@ -795,3 +795,4 @@ optionHelper00=emits separate Helper classes for meta data\n badParameterMode=Invalid parameter mode byte ({0}) passed to getModeAsString().\n \n attach.bounday.mns=Marking streams not supported.\n+noSuchOperation=No such operation ''{0}''\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/src/org/apache/axis/utils/resources.properties",
                "sha": "d15874139e77724a15b8ffd8d6171e1a9b5d595c",
                "status": "modified"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/Child.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/Child.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "test/inheritance/Child.java",
                "patch": "@@ -0,0 +1,16 @@\n+package test.inheritance;\n+\n+public class Child extends Parent {\n+    public static final String HELLO_MSG = \"Hello from the Child class\";\n+    public static final String OVERLOAD_MSG = \"The Child got \";\n+\n+    public String normal()\n+    {\n+        return HELLO_MSG;\n+    }\n+\n+    public String overloaded(int i)\n+    {\n+        return OVERLOAD_MSG + i;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/Child.java",
                "sha": "f53c5c604790cfebf5b35adaae76ccd916b4f2bd",
                "status": "added"
            },
            {
                "additions": 73,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/PackageTests.java",
                "changes": 73,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/PackageTests.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "test/inheritance/PackageTests.java",
                "patch": "@@ -0,0 +1,73 @@\n+/*\n+ * The Apache Software License, Version 1.1\n+ *\n+ *\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution,\n+ *    if any, must include the following acknowledgment:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowledgment may appear in the software itself,\n+ *    if and wherever such third-party acknowledgments normally appear.\n+ *\n+ * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n+ *    not be used to endorse or promote products derived from this\n+ *    software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\",\n+ *    nor may \"Apache\" appear in their name, without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+\n+package test.inheritance;\n+\n+import junit.framework.Test;\n+import junit.framework.TestCase;\n+import junit.framework.TestSuite;\n+\n+public class PackageTests extends TestCase {\n+\n+    public PackageTests(String name) {\n+        super(name);\n+    }\n+\n+    public static Test suite() throws Exception {\n+        TestSuite suite = new TestSuite();\n+        suite.addTestSuite(TestInheritance.class);\n+        return suite;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/PackageTests.java",
                "sha": "641928dff1f15a00bc0768bd98e0f13812cb6484",
                "status": "added"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/Parent.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/Parent.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "test/inheritance/Parent.java",
                "patch": "@@ -0,0 +1,16 @@\n+package test.inheritance;\n+\n+public class Parent {\n+    public static final String HELLO_MSG = \"Hello from the Parent class!\";\n+    public static final String OVERLOAD_MSG = \"The Parent got \";\n+\n+    public String inherited()\n+    {\n+        return HELLO_MSG;\n+    }\n+\n+    public String overloaded(String param)\n+    {\n+        return OVERLOAD_MSG + param;\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/Parent.java",
                "sha": "8fcceb2a6eca5c90b8fe7e7e59643ec5a5f5aa3c",
                "status": "added"
            },
            {
                "additions": 54,
                "blob_url": "https://github.com/apache/axis1-java/blob/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/TestInheritance.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/inheritance/TestInheritance.java?ref=69dec1dea1774b5e7740bfbba966b3eba4e6af02",
                "deletions": 0,
                "filename": "test/inheritance/TestInheritance.java",
                "patch": "@@ -0,0 +1,54 @@\n+package test.inheritance;\n+\n+import junit.framework.TestCase;\n+import org.apache.axis.handlers.soap.SOAPService;\n+import org.apache.axis.providers.java.RPCProvider;\n+import org.apache.axis.configuration.SimpleProvider;\n+import org.apache.axis.server.AxisServer;\n+import org.apache.axis.transport.local.LocalTransport;\n+import org.apache.axis.client.Call;\n+import org.apache.axis.client.Service;\n+\n+public class TestInheritance extends TestCase {\n+    private AxisServer server;\n+    private LocalTransport transport;\n+\n+    public TestInheritance(String s) {\n+        super(s);\n+    }\n+\n+    protected void setUp() throws Exception {\n+        SimpleProvider config = new SimpleProvider();\n+\n+        SOAPService service = new SOAPService(new RPCProvider());\n+        service.setOption(\"className\", \"test.inheritance.Child\");\n+        service.setOption(\"allowedMethods\", \"*\");\n+        config.deployService(\"inheritanceTest\", service);\n+\n+        server = new AxisServer(config);\n+        transport = new LocalTransport(server);\n+        transport.setRemoteService(\"inheritanceTest\");\n+    }\n+\n+    public void testInheritance() throws Exception {\n+        Call call = new Call(new Service());\n+        call.setTransport(transport);\n+\n+        String ret = (String)call.invoke(\"inherited\", null);\n+        assertEquals(\"Inherited method returned bad result\",\n+                Parent.HELLO_MSG, ret);\n+\n+        ret = (String)call.invoke(\"normal\", null);\n+        assertEquals(\"Child method returned bad result\",\n+                Child.HELLO_MSG, ret);\n+\n+        ret = (String)call.invoke(\"overloaded\", new Object [] { \"test\" });\n+        assertTrue(\"Overloaded (String) method returned bad result\",\n+                ret.startsWith(Parent.OVERLOAD_MSG));\n+        ret = (String)call.invoke(\"overloaded\",\n+                                  new Object [] { new Integer(5) });\n+        assertTrue(\"Overloaded (int) method returned bad result\",\n+                ret.startsWith(Child.OVERLOAD_MSG));\n+\n+    }\n+}",
                "raw_url": "https://github.com/apache/axis1-java/raw/69dec1dea1774b5e7740bfbba966b3eba4e6af02/test/inheritance/TestInheritance.java",
                "sha": "d1edde858e4c2fcef284627c291b38b71ae106aa",
                "status": "added"
            }
        ],
        "message": "* First part of inheritance code in ServiceDesc - walk up the inheritance\n  tree when syncing/creating methods, stopping at \"java.*\" or \"javax.*\"\n  classes.  Will add configurable \"stop classes\" to this soon.\n\n* Add unit test to make sure inheritance code works, and that we\n  correctly resolve methods in a few situations.\n\n* Make code a little tighter in a few places, throw faults instead of\n  potential NPEs\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@246826 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/e25bb4cf5003470ceb5886c87456217a324e0d39",
        "repo": "axis1-java",
        "unit_tests": [
            "TestServiceDesc.java"
        ]
    },
    "axis1-java_70bbea3": {
        "bug_id": "axis1-java_70bbea3",
        "commit": "https://github.com/apache/axis1-java/commit/70bbea364ef8b7675759f7ab51dd80fefb12249b",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/FileTest.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/FileTest.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 1,
                "filename": "samples/transport/FileTest.java",
                "patch": "@@ -43,7 +43,7 @@ public static void main(String args[]) throws Exception {\n   \n     call.set(Transport.USER, opts.getUser() );\n     call.set(Transport.PASSWORD, opts.getPassword() );\n-    call.setTransportRequest( \"FileSender\" );\n+    call.setTransport( new FileTransport() );\n   \n     Float res = new Float(0.0F);\n     res = (Float) call.invoke( \"urn:xmltoday-delayed-quotes\",",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/FileTest.java",
                "sha": "ff6d2ff36e56c18ddb058fe861a16bf16315202e",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/client_deploy.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/client_deploy.xml?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "samples/transport/client_deploy.xml",
                "patch": "@@ -6,4 +6,5 @@\n \n <deploy>\n   <handler name=\"FileSender\" class=\"samples.transport.FileSender\" />\n+  <transport name=\"FileTransport\" pivot=\"FileSender\"/>\n </deploy>",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/client_deploy.xml",
                "sha": "660df98fee8e58de0fcfe06285fb96a14fcf93e5",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/AdminClient.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/AdminClient.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 1,
                "filename": "samples/transport/tcp/AdminClient.java",
                "patch": "@@ -61,15 +61,21 @@\n import java.net.URL;\n \n /**\n- * An admin client object, specific to HTTP.\n+ * An admin client object, specific to TCP in that it sets\n+ * the TCP transport up.\n  *\n  * @author Rob Jellinghaus (robj@unrealities.com)\n  * @author Doug Davis (dug@us.ibm.com)\n+ * @author Glen Daniels (gdaniels@macromedia.com)\n  */\n \n public class AdminClient extends org.apache.axis.client.AdminClient {\n \n     public static void main(String args[]) {\n+        /** !!! This shouldn't be hardcoded....\n+         */\n+        ServiceClient.setDefaultTransport(new TCPTransport(\"localhost\", \"8080\"));\n+        \n         try {\n             org.apache.axis.client.AdminClient.main(args);\n         }",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/AdminClient.java",
                "sha": "9fc9ba832f2ae6634e513f7d3ba6f783882b4210",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/TCPListener.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/TCPListener.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 7,
                "filename": "samples/transport/tcp/TCPListener.java",
                "patch": "@@ -75,8 +75,7 @@\n  */\n public class TCPListener implements Runnable {\n     // These have default values.\n-    private String transportReqName = \"TCP.request\";\n-    private String transportRespName = \"TCP.response\";\n+    private String transportName = \"TCPTransport\";\n     \n     private static final String AXIS_ENGINE = \"AxisEngine\" ;\n     \n@@ -151,10 +150,12 @@ public void run () {\n                 HandlerRegistry hr = engine.getHandlerRegistry();\n                 HandlerRegistry sr = engine.getServiceRegistry();\n                 // add the TCPSender\n-                hr.add(\"TCPSender\", new TCPSender());\n+                //hr.add(\"TCPSender\", new TCPSender());\n                 \n-                SimpleChain c = new SimpleChain();\n-                hr.add( transportReqName, c );\n+                SimpleTargetedChain c = new SimpleTargetedChain();\n+                c.setPivotHandler(new TCPSender());\n+                \n+                engine.deployTransport(transportName, c);\n             }\n             \n             /* Place the Request message in the MessagContext object - notice */\n@@ -233,8 +234,7 @@ public void run () {\n             \n             /* Set the Transport Specific Request/Response chains IDs */\n             /******************************************************/\n-            msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName );\n-            msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName );\n+            msgContext.setTransportName(transportName);\n             \n             try {\n                 /* Invoke the Axis engine... */",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/TCPListener.java",
                "sha": "da7b5dffb28f90943cccc260c71aede4d4f811c6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/TCPTransport.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/TCPTransport.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "samples/transport/tcp/TCPTransport.java",
                "patch": "@@ -106,6 +106,7 @@ public void setupMessageContext (MessageContext mc, ServiceClient serv, AxisEngi\n         if (port != null) serv.set(PORT, port);\n         String url = \"http://\"+serv.get(HOST)+\":\"+serv.get(PORT);\n         \n+        Debug.Print(4, \"TCPTransport set URL to '\" + url + \"'\");\n         mc.setProperty(MessageContext.TRANS_URL, url);\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/TCPTransport.java",
                "sha": "6c86fc3de6e9addb308de5f7d3581148ecbc6edc",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/client_deploy.xml",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/client_deploy.xml?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "samples/transport/tcp/client_deploy.xml",
                "patch": "@@ -0,0 +1,7 @@\n+<m:deploy xmlns:m=\"AdminService\">\n+ <handler name=\"TCPSender\" class=\"samples.transport.tcp.TCPSender\"/>\n+ <handler name=\"LogIt\" class=\"org.apache.axis.handlers.LogMessage\">\n+  <option name=\"message\" value=\"Hey, I'm here!\"/>\n+ </handler>\n+ <transport name=\"tcp\" pivot=\"TCPSender\" request=\"LogIt\"/>\n+</m:deploy>",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/samples/transport/tcp/client_deploy.xml",
                "sha": "f232c6d23038a93a37352a8f4033b860f7163317",
                "status": "added"
            },
            {
                "additions": 63,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/AxisEngine.java",
                "changes": 66,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/AxisEngine.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 3,
                "filename": "src/org/apache/axis/AxisEngine.java",
                "patch": "@@ -87,6 +87,8 @@\n     protected HandlerRegistry _serviceRegistry;\n     protected String _serviceRegFilename;\n     \n+    protected String _transportRegFilename;\n+    \n     private boolean readRegistryFiles = true;\n     private boolean dontSaveYet = false;\n     \n@@ -155,14 +157,17 @@ public AxisEngine(HandlerRegistry handlers, HandlerRegistry services)\n      * @param handlerRegFilename the name of the Handler registry file.\n      * @param serviceRegFilename the name of the Service registry file.\n      */\n-    public AxisEngine(String handlerRegFilename, String serviceRegFilename)\n+    public AxisEngine(String handlerRegFilename,\n+                      String serviceRegFilename,\n+                      String transportRegFilename)\n     {\n         this();\n         setHandlerRegistry(new SupplierRegistry());\n         setServiceRegistry(new SupplierRegistry());\n         \n         _handlerRegFilename = handlerRegFilename;\n         _serviceRegFilename = serviceRegFilename;\n+        _transportRegFilename = transportRegFilename;\n         \n         init();\n     }\n@@ -302,6 +307,37 @@ private void initializeServices()\n     \n     public void initializeTransports()\n     {\n+      if (!readRegistryFiles)\n+        return;\n+      \n+      dontSaveYet = true;\n+      try {\n+        FileInputStream    fis = new FileInputStream(_transportRegFilename);\n+        \n+        Document doc = XMLUtils.newDocument(fis);\n+        \n+        Element root = doc.getDocumentElement();\n+        \n+        NodeList list = root.getChildNodes();\n+        for (int i = 0; i < list.getLength(); i++) {\n+          if (!(list.item(i) instanceof Element))\n+            continue;\n+          Element elem = (Element)list.item(i);\n+          Admin.registerTransport(elem, this);\n+        }\n+        \n+        fis.close();\n+        return;\n+      }\n+      catch( Exception e ) {\n+        if ( !(e instanceof FileNotFoundException) ) {\n+          e.printStackTrace( System.err );\n+        }\n+      } finally {\n+        dontSaveYet = false;\n+      }\n+\n+      Debug.Print(2, \"Deploying default transports...\");\n       deployDefaultTransports();\n     }\n \n@@ -348,7 +384,8 @@ public void saveHandlerRegistry()\n       try {\n         FileOutputStream fos = new FileOutputStream(_handlerRegFilename);\n         Document doc = XMLUtils.newDocument();\n-        Element el = Admin.list(doc, this, false);\n+        Element el = doc.createElement(\"handlers\");\n+        Admin.list(el, getHandlerRegistry());\n         doc.appendChild(el);\n         XMLUtils.DocumentToStream(doc, fos);\n         fos.close();\n@@ -365,7 +402,26 @@ public void saveServiceRegistry()\n       try {\n         FileOutputStream fos = new FileOutputStream(_serviceRegFilename);\n         Document doc = XMLUtils.newDocument();\n-        Element el = Admin.list(doc, this, true);\n+        Element el = doc.createElement(\"services\");\n+        Admin.list(el, getServiceRegistry());\n+        doc.appendChild(el);\n+        XMLUtils.DocumentToStream(doc, fos);\n+        fos.close();\n+      } catch (Exception e) {\n+        e.printStackTrace();\n+      }\n+    }\n+    \n+    public void saveTransportRegistry()\n+    {\n+      if (dontSaveYet || (_transportRegFilename == null))\n+        return;\n+      \n+      try {\n+        FileOutputStream fos = new FileOutputStream(_transportRegFilename);\n+        Document doc = XMLUtils.newDocument();\n+        Element el = doc.createElement(\"transports\"); \n+        Admin.list(el, getTransportRegistry());\n         doc.appendChild(el);\n         XMLUtils.DocumentToStream(doc, fos);\n         fos.close();\n@@ -451,7 +507,9 @@ public void undeployService(String key)\n      */\n     public void deployTransport(String key, Handler transport)\n     {\n+        transport.setName(key);\n         transportRegistry.add(key, transport);\n+        saveTransportRegistry();\n     }\n     \n     /**\n@@ -460,6 +518,7 @@ public void deployTransport(String key, Handler transport)\n     public void deployTransport(String key, Supplier supplier)\n     {\n         transportRegistry.add(key, supplier);\n+        saveTransportRegistry();\n     }\n     \n     /**\n@@ -468,6 +527,7 @@ public void deployTransport(String key, Supplier supplier)\n     public void undeployTransport(String key)\n     {\n         transportRegistry.remove(key);\n+        saveTransportRegistry();\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/AxisEngine.java",
                "sha": "80b3f3d9b44e902b8208b37ccb0c6f5afe9a1687",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/Constants.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -148,4 +148,6 @@\n   public static String SERVER_HANDLER_REGISTRY = \"handler-server.reg\" ;\n   public static String CLIENT_SERVICE_REGISTRY = \"service-client.reg\" ;\n   public static String SERVER_SERVICE_REGISTRY = \"service-server.reg\" ;\n+  public static String CLIENT_TRANSPORT_REGISTRY = \"transport-client.reg\" ;\n+  public static String SERVER_TRANSPORT_REGISTRY = \"transport-server.reg\" ;\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/Constants.java",
                "sha": "bf7d671fa37ce0ed9ebfa7ced48a00ae47a7991b",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/MessageContext.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/MessageContext.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 4,
                "filename": "src/org/apache/axis/MessageContext.java",
                "patch": "@@ -333,10 +333,6 @@ public void setServiceHandler(Handler sh)\n      */\n     public static String TRANS_URL           = \"transport.url\";\n \n-    /** The transport specific request/response chains  */\n-    public static String TRANS_REQUEST         = \"transport.request\";\n-    public static String TRANS_RESPONSE        = \"transport.response\";\n-\n     /** Has a quit been requested? Hackish... but useful... -- RobJ */\n     public static String QUIT_REQUESTED = \"quit.requested\";\n   ",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/MessageContext.java",
                "sha": "bfdc09f89f33b838fe63bda1f31b2e0e12fd91d3",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/SimpleChain.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/SimpleChain.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "src/org/apache/axis/SimpleChain.java",
                "patch": "@@ -141,6 +141,9 @@ public boolean contains(Handler handler) {\n   }\n \n   public Handler[] getHandlers() {\n+    if (handlers == null)\n+      return null;\n+    \n     Handler [] ret = new Handler[handlers.size()];\n     return( (Handler[]) handlers.toArray(ret) );\n   }",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/SimpleChain.java",
                "sha": "fe349e964a9e00fd1c5ecedac170f484124d3f33",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/AdminClient.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AdminClient.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/AdminClient.java",
                "patch": "@@ -84,7 +84,9 @@ public static void main (String[] args)\n       try {\n         Options opts = new Options( args );\n         \n-        Debug.setDebugLevel( opts.isFlagSet('d') );\n+        if (opts.isFlagSet('d') > 0) {\n+          Debug.setDebugLevel( opts.isFlagSet('d') );\n+        }\n         \n         args = opts.getRemainingArgs();\n         ",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/AdminClient.java",
                "sha": "d5e76ec1e116056c43ecb9d0b7fbc783bb455041",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/AxisClient.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AxisClient.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/AxisClient.java",
                "patch": "@@ -77,7 +77,8 @@\n     public AxisClient()\n     {\n         super(Constants.CLIENT_HANDLER_REGISTRY,\n-              Constants.CLIENT_SERVICE_REGISTRY);\n+              Constants.CLIENT_SERVICE_REGISTRY,\n+              Constants.CLIENT_TRANSPORT_REGISTRY);\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/AxisClient.java",
                "sha": "ad16729cd1b4c2f7b01f74e017e736c117b136f1",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/ServiceClient.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/ServiceClient.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 8,
                "filename": "src/org/apache/axis/client/ServiceClient.java",
                "patch": "@@ -91,6 +91,9 @@\n // Only supports String\n \n public class ServiceClient {\n+    // Client transports\n+    private static Transport defaultTransport = null;\n+                                                        \n     // keep prop hashtable small\n     private Hashtable properties = new Hashtable(10);\n     protected String encodingStyleURI = null ;\n@@ -150,10 +153,19 @@ public ServiceClient (Transport transport) {\n     \n     public void setTransport(Transport transport) {\n         this.transport = transport;\n+        Debug.Print(1, \"Transport is \" + transport);\n+    }\n+    \n+    public static void setDefaultTransport(Transport transport)\n+    {\n+        defaultTransport = transport;\n     }\n     \n     public Transport getTransportForProtocol(String protocol)\n     {\n+      if (defaultTransport != null)\n+        return defaultTransport;\n+      \n       if (protocol.equals(\"http\"))\n         return new HTTPTransport();\n       \n@@ -188,14 +200,6 @@ public String getEncodingStyleURI() {\n         return( encodingStyleURI );\n     }\n     \n-    public void setTransportRequest(String handlerName) {\n-      msgContext.setProperty( MessageContext.TRANS_REQUEST, handlerName );\n-    }\n-  \n-    public void setTransportResponse(String handlerName) {\n-      msgContext.setProperty( MessageContext.TRANS_RESPONSE, handlerName );\n-    }\n-    \n     public void setRequestMessage(Message msg) {\n         msgContext.setRequestMessage(msg);\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/client/ServiceClient.java",
                "sha": "06f93598d505db7a119aeb1b5c0847c99ed7a8f7",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/registries/SupplierRegistry.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/registries/SupplierRegistry.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 0,
                "filename": "src/org/apache/axis/registries/SupplierRegistry.java",
                "patch": "@@ -118,6 +118,10 @@ public Handler remove(String key) {\n      */\n     public Handler find(String key) {\n         Debug.Print( 4, \"Enter: SupplierRegistry::find(\", key, \")\" );\n+        if (key == null) {\n+          Debug.Print( 4, \"Exit: SupplierRegistry::find - key is null\" );\n+          return( null );\n+        }\n         if ( suppliers == null ) {\n           Debug.Print( 4, \"Exit: SupplierRegistry::find - suppliers is null\" );\n           return( null );",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/registries/SupplierRegistry.java",
                "sha": "c3f2a70c0daa3b1a5da2f95e6684fc760bf238d8",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/server/AxisServer.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/server/AxisServer.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 10,
                "filename": "src/org/apache/axis/server/AxisServer.java",
                "patch": "@@ -113,7 +113,8 @@ public void stop()\n      */\n     public AxisServer() {\n       super(Constants.SERVER_HANDLER_REGISTRY,\n-            Constants.SERVER_SERVICE_REGISTRY);\n+            Constants.SERVER_SERVICE_REGISTRY,\n+            Constants.SERVER_TRANSPORT_REGISTRY);\n     }\n \n     /**\n@@ -149,14 +150,6 @@ protected void deployDefaultHandlers()\n       c.addHandler( _handlerRegistry.find( \"debug\" ) );\n       deployHandler( \"global.request\", c );\n       \n-      c = new SimpleChain();\n-      c.addHandler( _handlerRegistry.find( \"HTTPAuth\" ) );\n-      c.addHandler( _handlerRegistry.find( \"HTTPAction\" ) );\n-      // deployHandler( \"HTTP.request\", c );\n-      \n-      SimpleTargetedChain transport = new SimpleTargetedChain();\n-      transport.setRequestHandler(c);\n-      deployTransport(\"HTTP.request\", transport);\n     }\n \n     protected void deployDefaultServices()\n@@ -179,7 +172,20 @@ protected void deployDefaultServices()\n \n     protected void deployDefaultTransports()\n     {\n-      // Do nothing.\n+      Chain c = new SimpleChain();\n+      Handler actionHandler = _handlerRegistry.find( \"HTTPAction\" );\n+      c.addHandler( _handlerRegistry.find( \"HTTPAuth\" ) );\n+      c.addHandler( actionHandler );\n+      \n+      // HTTP transport w/authorization\n+      SimpleTargetedChain transport = new SimpleTargetedChain();\n+      transport.setRequestHandler(c);\n+      deployTransport(\"http\", transport);\n+      \n+      // HTTP transport (for SimpleAxisServer) without auth.\n+      transport = new SimpleTargetedChain();\n+      transport.setRequestHandler(actionHandler);\n+      deployTransport(\"SimpleHTTP\", transport);\n     }\n     \n     /**\n@@ -266,6 +272,7 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n               HandlerRegistry tr = getTransportRegistry();\n               SimpleTargetedChain transportChain = null;\n               \n+              Debug.Print(3, \"AxisServer.invoke: Transport = '\" + hName +\"'\");\n               if ( hName != null && (h = tr.find( hName )) != null ) {\n                 if (h instanceof SimpleTargetedChain) {\n                   transportChain = (SimpleTargetedChain)h;",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/server/AxisServer.java",
                "sha": "d7257b5dc26088b1d4ea6e270efa2e42905b43ec",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/suppliers/TargetedChainSupplier.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 14,
                "filename": "src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "patch": "@@ -95,6 +95,9 @@ public TargetedChainSupplier(String myName,\n     \n     private void addHandlersToChain(Vector names, Chain chain)\n     {\n+      if (names == null)\n+        return;\n+      \n       Enumeration e = names.elements();\n       while (e.hasMoreElements()) {\n         String hName = (String)e.nextElement();\n@@ -114,25 +117,29 @@ public Handler getHandler()\n         c.setOptions(_options);\n         c.setName(_myName);\n         \n-        if (_requestNames.size() == 1) {\n-          h = _registry.find((String)_requestNames.elementAt(0));\n-          c.setRequestHandler(h);\n-        } else {\n-          Chain chain = new SimpleChain();\n-          addHandlersToChain(_requestNames, chain);\n+        if (!_requestNames.isEmpty()) {\n+          if (_requestNames.size() == 1) {\n+            h = _registry.find((String)_requestNames.elementAt(0));\n+            c.setRequestHandler(h);\n+          } else {\n+            Chain chain = new SimpleChain();\n+            addHandlersToChain(_requestNames, chain);\n+            c.setRequestHandler(chain);\n+          }\n         }\n         \n         h = _registry.find(_pivotName);\n-        if (h == null)\n-          return null;  // Should maybe throw an exception here?\n         c.setPivotHandler(h);\n \n-        if (_responseNames.size() == 1) {\n-          h = _registry.find((String)_responseNames.elementAt(0));\n-          c.setRequestHandler(h);\n-        } else {\n-          Chain chain = new SimpleChain();\n-          addHandlersToChain(_responseNames, chain);\n+        if (!_responseNames.isEmpty()) {\n+          if (_responseNames.size() == 1) {\n+            h = _registry.find((String)_responseNames.elementAt(0));\n+            c.setResponseHandler(h);\n+          } else {\n+            Chain chain = new SimpleChain();\n+            addHandlersToChain(_responseNames, chain);\n+            c.setResponseHandler(chain);\n+          }\n         }\n         \n         _chain = c;",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "sha": "be1bef15b77b6dec3636321cb0cb1a9372f35e0f",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/http/AxisServlet.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/AxisServlet.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 18,
                "filename": "src/org/apache/axis/transport/http/AxisServlet.java",
                "patch": "@@ -68,32 +68,25 @@\n  */\n public class AxisServlet extends HttpServlet {\n   // These have default values.\n-  private String transportReqName = \"HTTP.request\";\n-  private String transportRespName = \"HTTP.response\";\n+  private String transportName = \"http\";\n \n   private static final String AXIS_ENGINE = \"AxisEngine\" ;\n \n   public void init() {\n-      String param = getInitParameter(\"transport.request\");\n+      String param = getInitParameter(\"transport.name\");\n       ServletContext context = getServletConfig().getServletContext();\n       \n       if (param == null)\n-          param = context.getInitParameter(\"transport.request\");\n+          param = context.getInitParameter(\"transport.name\");\n       if (param != null)\n-          transportReqName = param;\n-      \n-      param = getInitParameter(\"transport.response\");\n-      if (param == null)\n-          param = context.getInitParameter(\"transport.response\");\n-      if (param != null)\n-          transportRespName = param;\n+          transportName = param;      \n   }\n \n   public void doGet(HttpServletRequest req, HttpServletResponse res)\n                 throws ServletException, IOException {\n     res.setContentType(\"text/html\");\n-    res.getWriter().println( \"In doGet\" );\n-    res.getWriter().println(\" Request = \" + transportReqName);\n+    res.getWriter().println( \"In doGet<p>\" );\n+    res.getWriter().println(\" TransportName = \" + transportName);\n   }\n \n   public void doPost(HttpServletRequest req, HttpServletResponse res)\n@@ -118,11 +111,9 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     /**********************************************************/\n     msgContext.setRequestMessage( msg );\n \n-    /* Set the Transport Specific Request/Response chains IDs */\n-    /******************************************************/\n-    msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName );\n-    msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName );\n-    msgContext.setTransportName(transportReqName);\n+    /* Set the Transport */\n+    /*********************/\n+    msgContext.setTransportName(transportName);\n \n     /* Save some HTTP specific info in the bag in case a handler needs it */\n     /**********************************************************************/",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/http/AxisServlet.java",
                "sha": "948489ddb6f0cf672c0ec3c2ed75455789846925",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/SimpleAxisServer.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 8,
                "filename": "src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "patch": "@@ -126,9 +126,7 @@ private static synchronized AxisServer getAxisServer() {\n     private static byte cannedResponse[] = \"<empty/>\".getBytes();\n \n     // Axis specific constants\n-    private static String transportReqName = \"HTTPAction\";\n-    private static String transportRespName = \"HTTP.response\";\n-    //private static final String AXIS_ENGINE = \"AxisEngine\" ;\n+    private static String transportName = \"SimpleHTTP\";\n     \n     // are we stopped?\n     // latch to true if stop() is called\n@@ -149,8 +147,6 @@ public void run() {\n         // create and initialize a message context\n         MessageContext msgContext = new MessageContext(engine);\n         Message        requestMsg;\n-        msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName);\n-        msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName);\n \n         // Reusuable, buffered, content length controlled, InputStream\n         NonBlockingBufferedInputStream is =\n@@ -177,9 +173,8 @@ public void run() {\n             msgContext.setTargetService(null);\n             msgContext.setResponseMessage(null);\n             msgContext.clearProperties();\n-            msgContext.setProperty(\"transport\", \"HTTPTransport\");\n-            msgContext.setProperty(MessageContext.TRANS_REQUEST, transportReqName);\n-            msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName);\n+            //msgContext.setProperty(\"transport\", \"HTTPTransport\");\n+            msgContext.setTransportName(transportName);\n             \n             try {\n                 try {",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "sha": "70fba8275326c97c8822e1e7ebcf00964dd99727",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/local/LocalSender.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/local/LocalSender.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 1,
                "filename": "src/org/apache/axis/transport/local/LocalSender.java",
                "patch": "@@ -100,7 +100,7 @@ public void invoke(MessageContext clientContext) throws AxisFault {\n     String action = clientContext.getStrProp(HTTPConstants.MC_HTTP_SOAPACTION);\n     if (action != null) {\n        serverContext.setProperty(HTTPConstants.MC_HTTP_SOAPACTION, action);\n-       serverContext.setProperty(MessageContext.TRANS_REQUEST , \"HTTPAction\");\n+       serverContext.setTransportName(\"http\");\n     }\n \n     // set the realpath if possible",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/transport/local/LocalSender.java",
                "sha": "ddf3bd354a65ba42e176600a90d87e5a74c95d83",
                "status": "modified"
            },
            {
                "additions": 29,
                "blob_url": "https://github.com/apache/axis1-java/blob/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/utils/Admin.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=70bbea364ef8b7675759f7ab51dd80fefb12249b",
                "deletions": 25,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -119,7 +119,7 @@ private static void registerTypeMappings(Element root, SOAPService service)\n     throws Exception\n   {\n     NodeList list = root.getElementsByTagName(\"bean\");\n-    Debug.Print(1, \"Registering \" + list.getLength() + \" service-specific beans.\");\n+    Debug.Print(2, \"Registering \" + list.getLength() + \" service-specific beans.\");\n     for (int i = 0; list != null && i < list.getLength(); i++) {\n       Element el = (Element)list.item(i);\n       registerBeanMapping(el, service.getTypeMappingRegistry());\n@@ -187,12 +187,18 @@ public Document process(MessageContext msgContext, Element root) throws AxisFaul\n         Element tmpEl = doc.createElement(\"engineConfig\");\n         doc.appendChild(tmpEl);\n         \n-        Element el = list(doc, engine, false);\n+        Element el = doc.createElement(\"handlers\");\n+        list(el, engine.getHandlerRegistry());\n         tmpEl.appendChild(el);\n         \n-        el = list(doc, engine, true);\n+        el = doc.createElement(\"services\");\n+        list(el, engine.getServiceRegistry());\n         tmpEl.appendChild(el);\n         \n+        el = doc.createElement(\"transports\");\n+        list(el, engine.getTransportRegistry());\n+        tmpEl.appendChild(el);\n+\n         return( doc );\n       }\n   \n@@ -269,25 +275,17 @@ else if ( type.equals( \"bean\" ) ) {\n    * @return Element our config element, suitable for pumping back through\n    *                 Admin processing later, to redeploy.\n    */\n-  public static Element list(Document doc, AxisEngine engine, boolean doServices)\n+  public static Element list(Element root, HandlerRegistry registry)\n     throws AxisFault\n   {\n-    String elementName = doServices ? \"services\" : \"handlers\";\n-    Element root = doc.createElement( elementName );\n+    Document doc = root.getOwnerDocument();\n \n     Element    elem = null ;\n     Hashtable  opts = null ;\n     String[]   names ;\n     Handler    h ;\n     int        i ;\n     \n-    HandlerRegistry registry;\n-    if (doServices) {\n-      registry = engine.getServiceRegistry();\n-    } else {\n-      registry = engine.getHandlerRegistry();\n-    }\n-\n     names = registry.list();\n \n     for( i = 0 ; names != null && i < names.length ; i++ ) {\n@@ -373,6 +371,8 @@ public static void registerChain(Element elem, AxisEngine engine)\n                                                              hr);\n       hr.add(name,supp);\n     }\n+    \n+    engine.saveHandlerRegistry();\n   }\n   \n   /**\n@@ -512,11 +512,9 @@ public static void registerHandler(Element elem, AxisEngine engine)\n   public static void registerTransport(Element elem, AxisEngine engine)\n     throws AxisFault\n   {\n-    SupplierRegistry tr = engine.getTransportRegistry();\n-    \n     String   name    = elem.getAttribute( \"name\" );\n     String   request   = elem.getAttribute( \"request\" );\n-    String   sender   = elem.getAttribute( \"sender\" );\n+    String   sender   = elem.getAttribute( \"pivot\" );\n     String   response  = elem.getAttribute( \"response\" );\n     Hashtable options = new Hashtable();\n \n@@ -530,24 +528,30 @@ public static void registerTransport(Element elem, AxisEngine engine)\n     Vector reqNames = new Vector();\n     Vector respNames = new Vector();\n \n-    st = new StringTokenizer( request, \" \\t\\n\\r\\f,\" );\n-    while ( st.hasMoreElements() ) {\n-      reqNames.addElement(st.nextToken());\n+    if (request != null) {\n+      st = new StringTokenizer( request, \" \\t\\n\\r\\f,\" );\n+      while ( st.hasMoreElements() ) {\n+        reqNames.addElement(st.nextToken());\n+      }\n+    }\n+\n+    if (response != null) {\n+      st = new StringTokenizer( response, \" \\t\\n\\r\\f,\" );\n+      while ( st.hasMoreElements() ) {\n+        respNames.addElement(st.nextToken());\n+      }\n     }\n     \n-    st = new StringTokenizer( response, \" \\t\\n\\r\\f,\" );\n-    while ( st.hasMoreElements() ) {\n-      respNames.addElement(st.nextToken());\n-    }\n     getOptions( elem, options );\n     \n+    HandlerRegistry hr = engine.getHandlerRegistry();\n     TargetedChainSupplier supp = new TargetedChainSupplier(name,\n                                                            reqNames,\n                                                            respNames,\n                                                            sender,\n                                                            options,\n-                                                           tr);\n-    tr.add(name,supp);\n+                                                           hr);\n+    engine.deployTransport(name, supp);\n   }\n \n   /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/70bbea364ef8b7675759f7ab51dd80fefb12249b/src/org/apache/axis/utils/Admin.java",
                "sha": "38f34231a0bbb3235139b8f48c624058a72b4567",
                "status": "modified"
            }
        ],
        "message": "Various changes to get the new transport architecture working.\n\n* use MessageContext.transportName everywhere, remove TRANS_REQUEST/\n  TRANS_RESPONSE properties.\n\n* deploy tranports to/from their own registry file.  Persistence and\n  deployment of Handlers/TypeMappings/Transports/Services needs to be\n  given some more thought in terms of cleanliness, J2EE integration,\n  and component packaging...\n\n* fix various places which might generate NPEs\n\n* clean up Admin.list() to be able to use any registry.\n\n* deploy two default http transports, a secure one (with HTTPAuth)\n  for the servlet and a non-secure one for SimpleAxisServer.\n\n* ServiceClient now has a static \"defaultTransport\" member which,\n  if set, overrides the lookup-by-URL.  This enables the TCP\n  AdminClient to work again, but should be more cleanly architected\n  (how do we expect to convey which transport to use?)\n\n* fix a couple of bugs in TargetedChainSupplier\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@252076 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/d1c7b53b6d71b5f3422b9926cabb49b54a73ca19",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSimpleChain.java",
            "TestAxisClient.java",
            "AdminTest.java"
        ]
    },
    "axis1-java_7e75f3e": {
        "bug_id": "axis1-java_7e75f3e",
        "commit": "https://github.com/apache/axis1-java/commit/7e75f3e9ce2b22af1072ca13779297acd4127f5e",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/handlers/soap/SOAPService.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/soap/SOAPService.java?ref=7e75f3e9ce2b22af1072ca13779297acd4127f5e",
                "deletions": 0,
                "filename": "src/org/apache/axis/handlers/soap/SOAPService.java",
                "patch": "@@ -313,6 +313,9 @@ public void setServiceDescription(ServiceDesc serviceDescription) {\n \n     public void setPropertyParent(Hashtable parent)\n     {\n+        if (options == null) {\n+            options = new LockableHashtable();\n+        }\n         ((LockableHashtable)options).setParent(parent);\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/handlers/soap/SOAPService.java",
                "sha": "31e9506ea26d064a5c739fafaf0445acea7520a5",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/utils/resources.properties",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/resources.properties?ref=7e75f3e9ce2b22af1072ca13779297acd4127f5e",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/resources.properties",
                "patch": "@@ -838,3 +838,5 @@ implAlreadySet=Attempt to set implementation class on a ServiceDesc which has al\n cantCreateBean00=Unable to create JavaBean of type {0}.  Missing default constructor?  Error was: {1}.\n faultDuringCleanup=AxisEngine faulted during cleanup!\n \n+j2woptsoapAction00=value of the operation's soapAction field. Values are DEFAULT, OPERATION or NONE. OPERATION forces soapAction to the name of the operation.  DEFAULT causes the soapAction to be set according to the operation's meta data (usually \"\").  NONE forces the soapAction to \"\".  The default is DEFAULT.\n+j2wBadSoapAction00=The value of --soapAction must be DEFAULT, NONE or OPERATION.",
                "raw_url": "https://github.com/apache/axis1-java/raw/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/utils/resources.properties",
                "sha": "17f65b1816a306445b5a451d5132c3ba883e62b4",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/axis1-java/blob/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/wsdl/Java2WSDL.java",
                "changes": 22,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/Java2WSDL.java?ref=7e75f3e9ce2b22af1072ca13779297acd4127f5e",
                "deletions": 1,
                "filename": "src/org/apache/axis/wsdl/Java2WSDL.java",
                "patch": "@@ -95,6 +95,7 @@\n     protected static final int METHODS_NOTALLOWED_OPT = 'x';\n     protected static final int STOP_CLASSES_OPT = 'c';\n     protected static final int TYPEMAPPING_OPT = 'T';\n+    protected static final int SOAPACTION_OPT = 'A';\n \n     /**\n      *  Define the understood options. Each CLOptionDescriptor contains:\n@@ -177,7 +178,11 @@\n         new CLOptionDescriptor(\"typeMappingVersion\",\n                 CLOptionDescriptor.ARGUMENT_REQUIRED,\n                 TYPEMAPPING_OPT,\n-                JavaUtils.getMessage(\"j2wopttypeMapping00\"))\n+                JavaUtils.getMessage(\"j2wopttypeMapping00\")),\n+        new CLOptionDescriptor(\"soapAction\",\n+                CLOptionDescriptor.ARGUMENT_REQUIRED,\n+                SOAPACTION_OPT,\n+                JavaUtils.getMessage(\"j2woptsoapAction00\"))\n     };\n \n     protected Emitter emitter;\n@@ -327,6 +332,21 @@ else if (\"Implementation\".equalsIgnoreCase(modeArg))\n             }\n             break;\n             \n+        case SOAPACTION_OPT:\n+            value = option.getArgument();\n+            if (value.equalsIgnoreCase(\"DEFAULT\")) {\n+                emitter.setSoapAction(\"DEFAULT\");\n+            } else if (value.equalsIgnoreCase(\"OPERATION\")) {\n+                emitter.setSoapAction(\"OPERATION\");\n+            } else if (value.equalsIgnoreCase(\"NONE\")) {\n+                emitter.setSoapAction(\"NONE\");\n+            } else {\n+                System.out.println(JavaUtils.getMessage(\"j2wBadSoapAction00\"));\n+            }\n+            break;\n+\n+        default: \n+            break;\n         }\n     }        \n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/wsdl/Java2WSDL.java",
                "sha": "902d91a05835e55262aed2e288f95f660bcdbd22",
                "status": "modified"
            },
            {
                "additions": 32,
                "blob_url": "https://github.com/apache/axis1-java/blob/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/fromJava/Emitter.java?ref=7e75f3e9ce2b22af1072ca13779297acd4127f5e",
                "deletions": 3,
                "filename": "src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "patch": "@@ -1,4 +1,3 @@\n-\n /*\n  * The Apache Software License, Version 1.1\n  *\n@@ -143,6 +142,7 @@\n \n     private ServiceDesc serviceDesc;\n     private ServiceDesc serviceDesc2;\n+    private String soapAction = \"DEFAULT\";\n \n     /**\n      * Construct Emitter.\n@@ -732,9 +732,22 @@ private BindingOperation writeBindingOperation (Definition def,\n         bindingOper.setOperation(oper);\n \n         SOAPOperation soapOper = new SOAPOperationImpl();\n-        String soapAction = desc.getSoapAction();\n-        if (soapAction == null) {\n+\n+        \n+        // If the soapAction option is OPERATION, force\n+        // soapAction to the name of the operation. If NONE,\n+        // force soapAction to \"\".\n+        // Otherwise use the information in the operationDesc.\n+        String soapAction = \"\";\n+        if (getSoapAction().equals(\"OPERATION\")) {\n+            soapAction = oper.getName();\n+        } else if (getSoapAction().equals(\"NONE\")) {\n             soapAction = \"\";\n+        } else {\n+            soapAction = desc.getSoapAction();\n+            if (soapAction == null) {\n+                soapAction = \"\";\n+            }\n         }\n         soapOper.setSoapActionURI(soapAction);\n \n@@ -1365,6 +1378,22 @@ public void setDescription(String description) {\n         this.description = description;\n     }\n \n+    /**\n+     * Returns the soapAction option value\n+     * @return the String DEFAULT, NONE or OPERATION\n+     */\n+    public String getSoapAction() {\n+        return soapAction;\n+    }\n+\n+    /**\n+     * Sets the soapAction option value\n+     * @param must be DEFAULT, NONE, or OPERATION\n+     */\n+    public void setSoapAction(String value) {\n+        soapAction = value;\n+    }\n+\n     /**\n      * Returns the <code>TypeMapping</code> used by the service\n      * @return the <code>TypeMapping</code> used by the service",
                "raw_url": "https://github.com/apache/axis1-java/raw/7e75f3e9ce2b22af1072ca13779297acd4127f5e/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "sha": "34989a31f6dceeb6f289f83b78298a3336fa5247",
                "status": "modified"
            }
        ],
        "message": "Fixed NPE in SOAPService.\n\nAdded --soapAction option to Java2WSDL.  Option values are\n   DEFAULT:  uses the information in the OperationDesc to set soapAction\n             (which is probably \"\").  This is also the default.\n   NONE:     forces soapAction=\"\"\n   OPERATION: sets the soapAction to the name of the operation.\n\nPR:\nObtained from:\nSubmitted by:\nReviewed by:\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@254148 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/85b732bc66a2e1ff2bb769fc2d25fac6e679425e",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPService.java"
        ]
    },
    "axis1-java_8014683": {
        "bug_id": "axis1-java_8014683",
        "commit": "https://github.com/apache/axis1-java/commit/8014683ff9351b5aaceda2a240ce8abc247e10fc",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/Constants.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 6,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -660,12 +660,7 @@ public static boolean isWSDLSOAP(String s) {\n      * the no-service fault value\n      */\n     public static final QName QNAME_NO_SERVICE_FAULT_CODE\n-            = new QName(NS_URI_AXIS, \"Server.NoService\");\n-\n-    /**\n-     * the provider for the service does not support WSDL generation\n-     */\n-    public static final QName QNAME_NO_WSDLGENERATOR_FAULT_CODE = new QName( NS_URI_AXIS, \"Server.NoWSDLSupport\");          \n+            = new QName(NS_URI_AXIS, \"Server.NoService\");         \n     \n     // Misc Strings\n     //////////////////////////////////////////////////////////////////////////",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/Constants.java",
                "sha": "221ca77bfc1a8d39919ac65a5f9fd2377e384391",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/i18n/resource.properties",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/i18n/resource.properties?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 2,
                "filename": "src/org/apache/axis/i18n/resource.properties",
                "patch": "@@ -474,8 +474,6 @@ noWSDL00=Could not generate WSDL!\n noWSDL01=There is no SOAP service at this location\n # NOTE:  in noWSDL02, do not translate \"WSDL\"\n noWSDL02=There is a service at this location, but Axis did not generate the WSDL for it. Perhaps it is is misconfigured. \n-# NOTE:   in noWSDL03, do not translate \"WSDL\"\n-noWSDL03=The provider of this service does not support WSDL generation\n \n null00={0} is null\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/i18n/resource.properties",
                "sha": "54246f6b453e3416c0f29384d101cb167fabfde4",
                "status": "modified"
            },
            {
                "additions": 140,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/providers/BasicProvider.java",
                "changes": 154,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/BasicProvider.java?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 14,
                "filename": "src/org/apache/axis/providers/BasicProvider.java",
                "patch": "@@ -55,17 +55,22 @@\n \n package org.apache.axis.providers;\n \n+import java.util.Hashtable;\n+\n+import javax.xml.namespace.QName;\n+\n import org.apache.axis.AxisFault;\n import org.apache.axis.Constants;\n import org.apache.axis.MessageContext;\n import org.apache.axis.components.logger.LogFactory;\n+import org.apache.axis.description.ServiceDesc;\n+import org.apache.axis.encoding.TypeMapping;\n import org.apache.axis.handlers.BasicHandler;\n import org.apache.axis.handlers.soap.SOAPService;\n import org.apache.axis.utils.Messages;\n+import org.apache.axis.wsdl.fromJava.Emitter;\n import org.apache.commons.logging.Log;\n-\n-import javax.xml.namespace.QName;\n-import java.util.Hashtable;\n+import org.w3c.dom.Document;\n \n /**\n  * This class has one way of keeping track of the\n@@ -133,18 +138,139 @@ public String getOperationName(QName qname) {\n     /**\n      * Generate the WSDL for this service.\n      *\n-     * This method can be overwritten in a subclass with\n-     * code that put in the \"WSDL\" property of the message \n-     * context as a org.w3c.dom.Document\n+     * Put in the \"WSDL\" property of the message context\n+     * as a org.w3c.dom.Document\n      */\n     public void generateWSDL(MessageContext msgContext) throws AxisFault {\n-         \n-      AxisFault fault = new AxisFault( Messages.getMessage(\"noWSDL03\"));\n-      \n-      // set the fault code, so that QSWSDLHandler could deside to report \"nowsdl\"\n-      // instead of throwing an AxisFault\n-      fault.setFaultCode( Constants.QNAME_NO_WSDLGENERATOR_FAULT_CODE);\n-      \n-      throw fault;\n+        if (log.isDebugEnabled())\n+            log.debug(\"Enter: BasicProvider::generateWSDL (\" + this +\")\");\n+\n+        /* Find the service we're invoking so we can grab it's options */\n+        /***************************************************************/\n+        SOAPService service = msgContext.getService();\n+        ServiceDesc serviceDesc = service.getInitializedServiceDesc(msgContext);\n+\n+        // Calculate the appropriate namespaces for the WSDL we're going\n+        // to put out.\n+        //\n+        // If we've been explicitly told which namespaces to use, respect\n+        // that.  If not:\n+        //\n+        // The \"interface namespace\" should be either:\n+        // 1) The namespace of the ServiceDesc\n+        // 2) The transport URL (if there's no ServiceDesc ns)\n+\n+        try {\n+            // Location URL is whatever is explicitly set in the MC\n+            String locationUrl = msgContext.getStrProp(MessageContext.WSDLGEN_SERV_LOC_URL);\n+\n+            if (locationUrl == null) {\n+                // If nothing, try what's explicitly set in the ServiceDesc\n+                locationUrl = serviceDesc.getEndpointURL();\n+            }\n+\n+            if (locationUrl == null) {\n+                // If nothing, use the actual transport URL\n+                locationUrl = msgContext.getStrProp(MessageContext.TRANS_URL);\n+            }\n+\n+            // Interface namespace is whatever is explicitly set\n+            String interfaceNamespace = msgContext.getStrProp(MessageContext.WSDLGEN_INTFNAMESPACE);\n+\n+            if (interfaceNamespace == null) {\n+                // If nothing, use the default namespace of the ServiceDesc\n+                interfaceNamespace = serviceDesc.getDefaultNamespace();\n+            }\n+\n+            if (interfaceNamespace == null) {\n+                // If nothing still, use the location URL determined above\n+                interfaceNamespace = locationUrl;\n+            }\n+\n+            //Do we want to do this?\n+            //\n+            //          if (locationUrl == null) {\n+            //              locationUrl = url;\n+            //          } else {\n+            //              try {\n+            //                  URL urlURL = new URL(url);\n+            //                  URL locationURL = new URL(locationUrl);\n+            //                  URL urlTemp = new URL(urlURL.getProtocol(),\n+            //                          locationURL.getHost(),\n+            //                          locationURL.getPort(),\n+            //                          urlURL.getFile());\n+            //                  interfaceNamespace += urlURL.getFile();\n+            //                  locationUrl = urlTemp.toString();\n+            //              } catch (Exception e) {\n+            //                  locationUrl = url;\n+            //                  interfaceNamespace = url;\n+            //              }\n+            //          }\n+\n+            Emitter emitter = new Emitter();\n+\n+            // This seems like a good idea, but in fact isn't because the\n+            // emitter will figure out a reasonable name (<classname>Service)\n+            // for the WSDL service element name.  We provide the 'alias'\n+            // setting to explicitly set this name. See bug 13262 for more info.\n+            //emitter.setServiceElementName(serviceDesc.getName());\n+\n+            // service alias may be provided if exact naming is required,\n+            // otherwise Axis will name it according to the implementing class name\n+            String alias = (String) service.getOption(\"alias\");\n+            if (alias != null)\n+                emitter.setServiceElementName(alias);\n+\n+            // Set style/use\n+            emitter.setStyle(serviceDesc.getStyle());\n+            emitter.setUse(serviceDesc.getUse());\n+\n+            emitter.setClsSmart(serviceDesc.getImplClass(), locationUrl);\n+\n+            // If a wsdl target namespace was provided, use the targetNamespace.\n+            // Otherwise use the interfaceNamespace constructed above.\n+            String targetNamespace = (String) service.getOption(OPTION_WSDL_TARGETNAMESPACE);\n+            if (targetNamespace == null || targetNamespace.length() == 0) {\n+                targetNamespace = interfaceNamespace;\n+            }\n+            emitter.setIntfNamespace(targetNamespace);\n+\n+            emitter.setLocationUrl(locationUrl);\n+            emitter.setServiceDesc(serviceDesc);\n+            emitter.setTypeMapping((TypeMapping) msgContext.getTypeMappingRegistry().getTypeMapping(serviceDesc.getUse().getEncoding()));\n+            emitter.setDefaultTypeMapping((TypeMapping) msgContext.getTypeMappingRegistry().getDefaultTypeMapping());\n+\n+            String wsdlPortType = (String) service.getOption(OPTION_WSDL_PORTTYPE);\n+            String wsdlServiceElement = (String) service.getOption(OPTION_WSDL_SERVICEELEMENT);\n+            String wsdlServicePort = (String) service.getOption(OPTION_WSDL_SERVICEPORT);\n+\n+            if (wsdlPortType != null && wsdlPortType.length() > 0) {\n+                emitter.setPortTypeName(wsdlPortType);\n+            }\n+            if (wsdlServiceElement != null && wsdlServiceElement.length() > 0) {\n+                emitter.setServiceElementName(wsdlServiceElement);\n+            }\n+            if (wsdlServicePort != null && wsdlServicePort.length() > 0) {\n+                emitter.setServicePortName(wsdlServicePort);\n+            }\n+\n+            String wsdlInputSchema = (String) service.getOption(OPTION_WSDL_INPUTSCHEMA);\n+            if (null != wsdlInputSchema && wsdlInputSchema.length() > 0) {\n+                emitter.setInputSchema(wsdlInputSchema);\n+            }\n+\n+            Document doc = emitter.emit(Emitter.MODE_ALL);\n+\n+            msgContext.setProperty(\"WSDL\", doc);\n+        } catch (NoClassDefFoundError e) {\n+            entLog.info(Messages.getMessage(\"toAxisFault00\"), e);\n+            throw new AxisFault(e.toString(), e);\n+        } catch (Exception e) {\n+            entLog.info(Messages.getMessage(\"toAxisFault00\"), e);\n+            throw AxisFault.makeFault(e);\n+        }\n+\n+        if (log.isDebugEnabled())\n+            log.debug(\"Exit: BasicProvider::generateWSDL (\" + this +\")\");\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/providers/BasicProvider.java",
                "sha": "9d9c61c801e9a144aa9ad2a65d10c4483aebc468",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/providers/java/JavaProvider.java",
                "changes": 144,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/JavaProvider.java?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 144,
                "filename": "src/org/apache/axis/providers/java/JavaProvider.java",
                "patch": "@@ -357,150 +357,6 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n             log.debug(\"Exit: JavaProvider::invoke (\" + this + \")\");\n     }\n \n-    /**\n-     * Generate the WSDL for this service.\n-     *\n-     * Put in the \"WSDL\" property of the message context\n-     * as a org.w3c.dom.Document\n-     */\n-    public void generateWSDL(MessageContext msgContext) throws AxisFault {\n-        if (log.isDebugEnabled())\n-            log.debug(\"Enter: JavaProvider::generateWSDL (\" + this + \")\");\n-\n-        /* Find the service we're invoking so we can grab it's options */\n-        /***************************************************************/\n-        SOAPService service = msgContext.getService();\n-        ServiceDesc serviceDesc = service.getInitializedServiceDesc(msgContext);\n-\n-        // Calculate the appropriate namespaces for the WSDL we're going\n-        // to put out.\n-        //\n-        // If we've been explicitly told which namespaces to use, respect\n-        // that.  If not:\n-        //\n-        // The \"interface namespace\" should be either:\n-        // 1) The namespace of the ServiceDesc\n-        // 2) The transport URL (if there's no ServiceDesc ns)\n-\n-        try {\n-            // Location URL is whatever is explicitly set in the MC\n-            String locationUrl =\n-                    msgContext.getStrProp(MessageContext.WSDLGEN_SERV_LOC_URL);\n-\n-            if (locationUrl == null) {\n-                // If nothing, try what's explicitly set in the ServiceDesc\n-                locationUrl = serviceDesc.getEndpointURL();\n-            }\n-\n-            if (locationUrl == null) {\n-                // If nothing, use the actual transport URL\n-                locationUrl = msgContext.getStrProp(MessageContext.TRANS_URL);\n-            }\n-\n-            // Interface namespace is whatever is explicitly set\n-            String interfaceNamespace =\n-                    msgContext.getStrProp(MessageContext.WSDLGEN_INTFNAMESPACE);\n-\n-            if (interfaceNamespace == null) {\n-                // If nothing, use the default namespace of the ServiceDesc\n-                interfaceNamespace = serviceDesc.getDefaultNamespace();\n-            }\n-\n-            if (interfaceNamespace == null) {\n-                // If nothing still, use the location URL determined above\n-                interfaceNamespace = locationUrl;\n-            }\n-\n-//  Do we want to do this?\n-//\n-//            if (locationUrl == null) {\n-//                locationUrl = url;\n-//            } else {\n-//                try {\n-//                    URL urlURL = new URL(url);\n-//                    URL locationURL = new URL(locationUrl);\n-//                    URL urlTemp = new URL(urlURL.getProtocol(),\n-//                            locationURL.getHost(),\n-//                            locationURL.getPort(),\n-//                            urlURL.getFile());\n-//                    interfaceNamespace += urlURL.getFile();\n-//                    locationUrl = urlTemp.toString();\n-//                } catch (Exception e) {\n-//                    locationUrl = url;\n-//                    interfaceNamespace = url;\n-//                }\n-//            }\n-\n-            Emitter emitter = new Emitter();\n-\n-            // This seems like a good idea, but in fact isn't because the\n-            // emitter will figure out a reasonable name (<classname>Service)\n-            // for the WSDL service element name.  We provide the 'alias'\n-            // setting to explicitly set this name. See bug 13262 for more info.\n-            //emitter.setServiceElementName(serviceDesc.getName());\n-            \n-            // service alias may be provided if exact naming is required,\n-            // otherwise Axis will name it according to the implementing class name\n-            String alias = (String)service.getOption(\"alias\");\n-            if(alias != null) emitter.setServiceElementName(alias);\n-\n-            // Set style/use\n-            emitter.setStyle(serviceDesc.getStyle());\n-            emitter.setUse(serviceDesc.getUse());\n-\n-            emitter.setClsSmart(serviceDesc.getImplClass(), locationUrl);\n-\n-            // If a wsdl target namespace was provided, use the targetNamespace.\n-            // Otherwise use the interfaceNamespace constructed above.\n-            String targetNamespace = (String) service.getOption(OPTION_WSDL_TARGETNAMESPACE);\n-            if (targetNamespace == null ||\n-                targetNamespace.length() == 0) {\n-                targetNamespace = interfaceNamespace;\n-            }\n-            emitter.setIntfNamespace(targetNamespace);\n-\n-            emitter.setLocationUrl(locationUrl);\n-            emitter.setServiceDesc(serviceDesc);\n-            emitter.setTypeMapping((TypeMapping)msgContext.getTypeMappingRegistry()\n-                                       .getTypeMapping(serviceDesc.getUse().getEncoding()));\n-            emitter.setDefaultTypeMapping((TypeMapping)msgContext.getTypeMappingRegistry().\n-                                          getDefaultTypeMapping());\n-\n-            String wsdlPortType = (String) service.getOption(OPTION_WSDL_PORTTYPE);\n-            String wsdlServiceElement = (String) service.getOption(OPTION_WSDL_SERVICEELEMENT);\n-            String wsdlServicePort = (String) service.getOption(OPTION_WSDL_SERVICEPORT);\n-\n-            if (wsdlPortType != null && wsdlPortType.length() > 0) {\n-                emitter.setPortTypeName(wsdlPortType);\n-            }\n-            if (wsdlServiceElement != null && wsdlServiceElement.length() > 0) {\n-                emitter.setServiceElementName(wsdlServiceElement);\n-            }\n-            if (wsdlServicePort != null && wsdlServicePort.length() > 0) {\n-                emitter.setServicePortName(wsdlServicePort);\n-            }\n-\n-            String wsdlInputSchema = (String)\n-                service.getOption(OPTION_WSDL_INPUTSCHEMA);\n-            if (null != wsdlInputSchema && wsdlInputSchema.length() > 0) {\n-                emitter.setInputSchema(wsdlInputSchema);\n-            }\n-\n-            Document  doc = emitter.emit(Emitter.MODE_ALL);\n-\n-            msgContext.setProperty(\"WSDL\", doc);\n-        } catch (NoClassDefFoundError e) {\n-            entLog.info( Messages.getMessage(\"toAxisFault00\"), e );\n-            throw new AxisFault(e.toString(), e);\n-        } catch (Exception e) {\n-            entLog.info( Messages.getMessage(\"toAxisFault00\"), e );\n-            throw AxisFault.makeFault(e);\n-        }\n-\n-        if (log.isDebugEnabled())\n-            log.debug(\"Exit: JavaProvider::generateWSDL (\" + this + \")\");\n-    }\n-\n     private String getAllowedMethods(Handler service)\n     {\n         String val = (String)service.getOption(OPTION_ALLOWEDMETHODS);",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/providers/java/JavaProvider.java",
                "sha": "391b82ee6a4787e2da66629542b33e5fc97a931f",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/QSWSDLHandler.java?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 8,
                "filename": "src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "patch": "@@ -136,14 +136,9 @@ public void invoke (MessageContext msgContext) throws AxisFault {\n                 response.setStatus (HttpURLConnection.HTTP_NOT_FOUND);\n \n                 reportNoWSDL (response, writer, \"noWSDL01\", axisFault);\n-                \n-            } else if (axisFault.getFaultCode().equals(Constants.QNAME_NO_WSDLGENERATOR_FAULT_CODE)) {              \n-              // the provider for the service doesn't support WSDL generation\n-              response.setStatus (HttpURLConnection.HTTP_NOT_FOUND);\n-           \n-              // report WSDL support is missing                 \n-              reportNoWSDL (response, writer, \"noWSDL03\", axisFault);\n-            } else {\n+            }\n+\n+            else {\n                 //all other faults get thrown\n \n                 throw axisFault;",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "sha": "466f6a29d3f917e8fa4be6dc48676f2604243ecd",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/axis1-java/blob/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/fromJava/Emitter.java?ref=8014683ff9351b5aaceda2a240ce8abc247e10fc",
                "deletions": 3,
                "filename": "src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "patch": "@@ -521,9 +521,16 @@ protected void init(int mode) {\n         }\n \n         if (encodingList == null) {\n-            clsName = cls.getName();\n-            clsName = clsName.substring(clsName.lastIndexOf('.') + 1);\n-\n+          \n+            // if cls contains a Class object with the service implementation use the Name of the\n+            // class else use the service name\n+            if ( cls != null ) {            \n+                clsName = cls.getName();                  \n+                clsName = clsName.substring(clsName.lastIndexOf('.') + 1);\n+            } else {              \n+                clsName = getServiceDesc().getName();\n+            }\n+            \n             // Default the portType name\n             if (getPortTypeName() == null) {\n                 setPortTypeName(clsName);",
                "raw_url": "https://github.com/apache/axis1-java/raw/8014683ff9351b5aaceda2a240ce8abc247e10fc/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "sha": "e4ecb1bea212292c848d6f661755d7331eef210e",
                "status": "modified"
            }
        ],
        "message": "Fix for Bug 24092 - Generating WSDL out of non-Java Web Services causes NPE\nfrom bayer@oio.de (Thomas Bayer)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256874 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/59cc99e8e5a8e8bc50a0975a3c6ea173eb1a58be",
        "repo": "axis1-java",
        "unit_tests": [
            "TestBasicProvider.java"
        ]
    },
    "axis1-java_8900212": {
        "bug_id": "axis1-java_8900212",
        "commit": "https://github.com/apache/axis1-java/commit/890021233deb2e34c38248309cd02ecfda381cd1",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/890021233deb2e34c38248309cd02ecfda381cd1/src/org/apache/axis/client/Call.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Call.java?ref=890021233deb2e34c38248309cd02ecfda381cd1",
                "deletions": 0,
                "filename": "src/org/apache/axis/client/Call.java",
                "patch": "@@ -376,6 +376,9 @@ public void setOperation(QName portName, String opName)\n         ////////////////////////////////////////////////////////////////////\n         BindingOperation bop = binding.getBindingOperation(opName,\n                                                            null, null);\n+        if ( bop == null )\n+            throw new JAXRPCException( JavaUtils.getMessage(\"noOperation02\",\n+                                                            opName ));\n         this.removeProperty(HTTPConstants.MC_HTTP_SOAPACTION);\n         list = bop.getExtensibilityElements();\n         for ( int i = 0 ; list != null && i < list.size() ; i++ ) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/890021233deb2e34c38248309cd02ecfda381cd1/src/org/apache/axis/client/Call.java",
                "sha": "5bc33822ffff2f92d8297d1c0b3bf946fa82e25b",
                "status": "modified"
            }
        ],
        "message": "check for NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@245917 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/a46eabe7811d6f1cab301f787ce3b817b084a0bd",
        "repo": "axis1-java",
        "unit_tests": [
            "TestCall.java"
        ]
    },
    "axis1-java_90e6077": {
        "bug_id": "axis1-java_90e6077",
        "commit": "https://github.com/apache/axis1-java/commit/90e6077cfa5cfda8270128056197910a18ad87a0",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/90e6077cfa5cfda8270128056197910a18ad87a0/src/org/apache/axis/message/SOAPFault.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPFault.java?ref=90e6077cfa5cfda8270128056197910a18ad87a0",
                "deletions": 3,
                "filename": "src/org/apache/axis/message/SOAPFault.java",
                "patch": "@@ -212,9 +212,11 @@ private QName getFaultQName(Class cls, SerializationContext context) {\n         QName qname = null;       \n         if (! cls.equals(AxisFault.class)) {\n             FaultDesc faultDesc = null;\n-            OperationDesc op = context.getMessageContext().getOperation();\n-            if(op != null) {\n-                faultDesc = op.getFaultByClass(cls);\n+            if (context.getMessageContext() != null) {\n+                OperationDesc op = context.getMessageContext().getOperation();\n+                if (op != null) {\n+                    faultDesc = op.getFaultByClass(cls);\n+                }\n             }\n                 \n             if (faultDesc != null) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/90e6077cfa5cfda8270128056197910a18ad87a0/src/org/apache/axis/message/SOAPFault.java",
                "sha": "7d8a4227ae10c094b6a566e0ae9ee474d04a1b8d",
                "status": "modified"
            }
        ],
        "message": "Fix for Bug 20653 - AxisFault during config processing gives NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249147 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/69671f43ab6f13a92f0192f95a78a482e74ea1f5",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPFault.java"
        ]
    },
    "axis1-java_a480875": {
        "bug_id": "axis1-java_a480875",
        "commit": "https://github.com/apache/axis1-java/commit/a4808751d9943f6ca121900849e2fc13f4c546c2",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/FileTest.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/FileTest.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 1,
                "filename": "samples/transport/FileTest.java",
                "patch": "@@ -43,7 +43,7 @@ public static void main(String args[]) throws Exception {\n   \n     call.set(Transport.USER, opts.getUser() );\n     call.set(Transport.PASSWORD, opts.getPassword() );\n-    call.setTransportRequest( \"FileSender\" );\n+    call.setTransport( new FileTransport() );\n   \n     Float res = new Float(0.0F);\n     res = (Float) call.invoke( \"urn:xmltoday-delayed-quotes\",",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/FileTest.java",
                "sha": "ff6d2ff36e56c18ddb058fe861a16bf16315202e",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/client_deploy.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/client_deploy.xml?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "samples/transport/client_deploy.xml",
                "patch": "@@ -6,4 +6,5 @@\n \n <deploy>\n   <handler name=\"FileSender\" class=\"samples.transport.FileSender\" />\n+  <transport name=\"FileTransport\" pivot=\"FileSender\"/>\n </deploy>",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/client_deploy.xml",
                "sha": "660df98fee8e58de0fcfe06285fb96a14fcf93e5",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/AdminClient.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/AdminClient.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 1,
                "filename": "samples/transport/tcp/AdminClient.java",
                "patch": "@@ -61,15 +61,21 @@\n import java.net.URL;\n \n /**\n- * An admin client object, specific to HTTP.\n+ * An admin client object, specific to TCP in that it sets\n+ * the TCP transport up.\n  *\n  * @author Rob Jellinghaus (robj@unrealities.com)\n  * @author Doug Davis (dug@us.ibm.com)\n+ * @author Glen Daniels (gdaniels@macromedia.com)\n  */\n \n public class AdminClient extends org.apache.axis.client.AdminClient {\n \n     public static void main(String args[]) {\n+        /** !!! This shouldn't be hardcoded....\n+         */\n+        ServiceClient.setDefaultTransport(new TCPTransport(\"localhost\", \"8080\"));\n+        \n         try {\n             org.apache.axis.client.AdminClient.main(args);\n         }",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/AdminClient.java",
                "sha": "9fc9ba832f2ae6634e513f7d3ba6f783882b4210",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/TCPListener.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/TCPListener.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 7,
                "filename": "samples/transport/tcp/TCPListener.java",
                "patch": "@@ -75,8 +75,7 @@\n  */\n public class TCPListener implements Runnable {\n     // These have default values.\n-    private String transportReqName = \"TCP.request\";\n-    private String transportRespName = \"TCP.response\";\n+    private String transportName = \"TCPTransport\";\n     \n     private static final String AXIS_ENGINE = \"AxisEngine\" ;\n     \n@@ -151,10 +150,12 @@ public void run () {\n                 HandlerRegistry hr = engine.getHandlerRegistry();\n                 HandlerRegistry sr = engine.getServiceRegistry();\n                 // add the TCPSender\n-                hr.add(\"TCPSender\", new TCPSender());\n+                //hr.add(\"TCPSender\", new TCPSender());\n                 \n-                SimpleChain c = new SimpleChain();\n-                hr.add( transportReqName, c );\n+                SimpleTargetedChain c = new SimpleTargetedChain();\n+                c.setPivotHandler(new TCPSender());\n+                \n+                engine.deployTransport(transportName, c);\n             }\n             \n             /* Place the Request message in the MessagContext object - notice */\n@@ -233,8 +234,7 @@ public void run () {\n             \n             /* Set the Transport Specific Request/Response chains IDs */\n             /******************************************************/\n-            msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName );\n-            msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName );\n+            msgContext.setTransportName(transportName);\n             \n             try {\n                 /* Invoke the Axis engine... */",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/TCPListener.java",
                "sha": "da7b5dffb28f90943cccc260c71aede4d4f811c6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/TCPTransport.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/TCPTransport.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "samples/transport/tcp/TCPTransport.java",
                "patch": "@@ -106,6 +106,7 @@ public void setupMessageContext (MessageContext mc, ServiceClient serv, AxisEngi\n         if (port != null) serv.set(PORT, port);\n         String url = \"http://\"+serv.get(HOST)+\":\"+serv.get(PORT);\n         \n+        Debug.Print(4, \"TCPTransport set URL to '\" + url + \"'\");\n         mc.setProperty(MessageContext.TRANS_URL, url);\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/TCPTransport.java",
                "sha": "6c86fc3de6e9addb308de5f7d3581148ecbc6edc",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/client_deploy.xml",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/transport/tcp/client_deploy.xml?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "samples/transport/tcp/client_deploy.xml",
                "patch": "@@ -0,0 +1,7 @@\n+<m:deploy xmlns:m=\"AdminService\">\n+ <handler name=\"TCPSender\" class=\"samples.transport.tcp.TCPSender\"/>\n+ <handler name=\"LogIt\" class=\"org.apache.axis.handlers.LogMessage\">\n+  <option name=\"message\" value=\"Hey, I'm here!\"/>\n+ </handler>\n+ <transport name=\"tcp\" pivot=\"TCPSender\" request=\"LogIt\"/>\n+</m:deploy>",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/samples/transport/tcp/client_deploy.xml",
                "sha": "f232c6d23038a93a37352a8f4033b860f7163317",
                "status": "added"
            },
            {
                "additions": 63,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/AxisEngine.java",
                "changes": 66,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/AxisEngine.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 3,
                "filename": "src/org/apache/axis/AxisEngine.java",
                "patch": "@@ -87,6 +87,8 @@\n     protected HandlerRegistry _serviceRegistry;\n     protected String _serviceRegFilename;\n     \n+    protected String _transportRegFilename;\n+    \n     private boolean readRegistryFiles = true;\n     private boolean dontSaveYet = false;\n     \n@@ -155,14 +157,17 @@ public AxisEngine(HandlerRegistry handlers, HandlerRegistry services)\n      * @param handlerRegFilename the name of the Handler registry file.\n      * @param serviceRegFilename the name of the Service registry file.\n      */\n-    public AxisEngine(String handlerRegFilename, String serviceRegFilename)\n+    public AxisEngine(String handlerRegFilename,\n+                      String serviceRegFilename,\n+                      String transportRegFilename)\n     {\n         this();\n         setHandlerRegistry(new SupplierRegistry());\n         setServiceRegistry(new SupplierRegistry());\n         \n         _handlerRegFilename = handlerRegFilename;\n         _serviceRegFilename = serviceRegFilename;\n+        _transportRegFilename = transportRegFilename;\n         \n         init();\n     }\n@@ -302,6 +307,37 @@ private void initializeServices()\n     \n     public void initializeTransports()\n     {\n+      if (!readRegistryFiles)\n+        return;\n+      \n+      dontSaveYet = true;\n+      try {\n+        FileInputStream    fis = new FileInputStream(_transportRegFilename);\n+        \n+        Document doc = XMLUtils.newDocument(fis);\n+        \n+        Element root = doc.getDocumentElement();\n+        \n+        NodeList list = root.getChildNodes();\n+        for (int i = 0; i < list.getLength(); i++) {\n+          if (!(list.item(i) instanceof Element))\n+            continue;\n+          Element elem = (Element)list.item(i);\n+          Admin.registerTransport(elem, this);\n+        }\n+        \n+        fis.close();\n+        return;\n+      }\n+      catch( Exception e ) {\n+        if ( !(e instanceof FileNotFoundException) ) {\n+          e.printStackTrace( System.err );\n+        }\n+      } finally {\n+        dontSaveYet = false;\n+      }\n+\n+      Debug.Print(2, \"Deploying default transports...\");\n       deployDefaultTransports();\n     }\n \n@@ -348,7 +384,8 @@ public void saveHandlerRegistry()\n       try {\n         FileOutputStream fos = new FileOutputStream(_handlerRegFilename);\n         Document doc = XMLUtils.newDocument();\n-        Element el = Admin.list(doc, this, false);\n+        Element el = doc.createElement(\"handlers\");\n+        Admin.list(el, getHandlerRegistry());\n         doc.appendChild(el);\n         XMLUtils.DocumentToStream(doc, fos);\n         fos.close();\n@@ -365,7 +402,26 @@ public void saveServiceRegistry()\n       try {\n         FileOutputStream fos = new FileOutputStream(_serviceRegFilename);\n         Document doc = XMLUtils.newDocument();\n-        Element el = Admin.list(doc, this, true);\n+        Element el = doc.createElement(\"services\");\n+        Admin.list(el, getServiceRegistry());\n+        doc.appendChild(el);\n+        XMLUtils.DocumentToStream(doc, fos);\n+        fos.close();\n+      } catch (Exception e) {\n+        e.printStackTrace();\n+      }\n+    }\n+    \n+    public void saveTransportRegistry()\n+    {\n+      if (dontSaveYet || (_transportRegFilename == null))\n+        return;\n+      \n+      try {\n+        FileOutputStream fos = new FileOutputStream(_transportRegFilename);\n+        Document doc = XMLUtils.newDocument();\n+        Element el = doc.createElement(\"transports\"); \n+        Admin.list(el, getTransportRegistry());\n         doc.appendChild(el);\n         XMLUtils.DocumentToStream(doc, fos);\n         fos.close();\n@@ -451,7 +507,9 @@ public void undeployService(String key)\n      */\n     public void deployTransport(String key, Handler transport)\n     {\n+        transport.setName(key);\n         transportRegistry.add(key, transport);\n+        saveTransportRegistry();\n     }\n     \n     /**\n@@ -460,6 +518,7 @@ public void deployTransport(String key, Handler transport)\n     public void deployTransport(String key, Supplier supplier)\n     {\n         transportRegistry.add(key, supplier);\n+        saveTransportRegistry();\n     }\n     \n     /**\n@@ -468,6 +527,7 @@ public void deployTransport(String key, Supplier supplier)\n     public void undeployTransport(String key)\n     {\n         transportRegistry.remove(key);\n+        saveTransportRegistry();\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/AxisEngine.java",
                "sha": "80b3f3d9b44e902b8208b37ccb0c6f5afe9a1687",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/Constants.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -148,4 +148,6 @@\n   public static String SERVER_HANDLER_REGISTRY = \"handler-server.reg\" ;\n   public static String CLIENT_SERVICE_REGISTRY = \"service-client.reg\" ;\n   public static String SERVER_SERVICE_REGISTRY = \"service-server.reg\" ;\n+  public static String CLIENT_TRANSPORT_REGISTRY = \"transport-client.reg\" ;\n+  public static String SERVER_TRANSPORT_REGISTRY = \"transport-server.reg\" ;\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/Constants.java",
                "sha": "bf7d671fa37ce0ed9ebfa7ced48a00ae47a7991b",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/MessageContext.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/MessageContext.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 4,
                "filename": "src/org/apache/axis/MessageContext.java",
                "patch": "@@ -333,10 +333,6 @@ public void setServiceHandler(Handler sh)\n      */\n     public static String TRANS_URL           = \"transport.url\";\n \n-    /** The transport specific request/response chains  */\n-    public static String TRANS_REQUEST         = \"transport.request\";\n-    public static String TRANS_RESPONSE        = \"transport.response\";\n-\n     /** Has a quit been requested? Hackish... but useful... -- RobJ */\n     public static String QUIT_REQUESTED = \"quit.requested\";\n   ",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/MessageContext.java",
                "sha": "bfdc09f89f33b838fe63bda1f31b2e0e12fd91d3",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/SimpleChain.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/SimpleChain.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "src/org/apache/axis/SimpleChain.java",
                "patch": "@@ -141,6 +141,9 @@ public boolean contains(Handler handler) {\n   }\n \n   public Handler[] getHandlers() {\n+    if (handlers == null)\n+      return null;\n+    \n     Handler [] ret = new Handler[handlers.size()];\n     return( (Handler[]) handlers.toArray(ret) );\n   }",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/SimpleChain.java",
                "sha": "fe349e964a9e00fd1c5ecedac170f484124d3f33",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/AdminClient.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AdminClient.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/AdminClient.java",
                "patch": "@@ -84,7 +84,9 @@ public static void main (String[] args)\n       try {\n         Options opts = new Options( args );\n         \n-        Debug.setDebugLevel( opts.isFlagSet('d') );\n+        if (opts.isFlagSet('d') > 0) {\n+          Debug.setDebugLevel( opts.isFlagSet('d') );\n+        }\n         \n         args = opts.getRemainingArgs();\n         ",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/AdminClient.java",
                "sha": "d5e76ec1e116056c43ecb9d0b7fbc783bb455041",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/AxisClient.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AxisClient.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/AxisClient.java",
                "patch": "@@ -77,7 +77,8 @@\n     public AxisClient()\n     {\n         super(Constants.CLIENT_HANDLER_REGISTRY,\n-              Constants.CLIENT_SERVICE_REGISTRY);\n+              Constants.CLIENT_SERVICE_REGISTRY,\n+              Constants.CLIENT_TRANSPORT_REGISTRY);\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/AxisClient.java",
                "sha": "ad16729cd1b4c2f7b01f74e017e736c117b136f1",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/ServiceClient.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/ServiceClient.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 8,
                "filename": "src/org/apache/axis/client/ServiceClient.java",
                "patch": "@@ -91,6 +91,9 @@\n // Only supports String\n \n public class ServiceClient {\n+    // Client transports\n+    private static Transport defaultTransport = null;\n+                                                        \n     // keep prop hashtable small\n     private Hashtable properties = new Hashtable(10);\n     protected String encodingStyleURI = null ;\n@@ -150,10 +153,19 @@ public ServiceClient (Transport transport) {\n     \n     public void setTransport(Transport transport) {\n         this.transport = transport;\n+        Debug.Print(1, \"Transport is \" + transport);\n+    }\n+    \n+    public static void setDefaultTransport(Transport transport)\n+    {\n+        defaultTransport = transport;\n     }\n     \n     public Transport getTransportForProtocol(String protocol)\n     {\n+      if (defaultTransport != null)\n+        return defaultTransport;\n+      \n       if (protocol.equals(\"http\"))\n         return new HTTPTransport();\n       \n@@ -188,14 +200,6 @@ public String getEncodingStyleURI() {\n         return( encodingStyleURI );\n     }\n     \n-    public void setTransportRequest(String handlerName) {\n-      msgContext.setProperty( MessageContext.TRANS_REQUEST, handlerName );\n-    }\n-  \n-    public void setTransportResponse(String handlerName) {\n-      msgContext.setProperty( MessageContext.TRANS_RESPONSE, handlerName );\n-    }\n-    \n     public void setRequestMessage(Message msg) {\n         msgContext.setRequestMessage(msg);\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/client/ServiceClient.java",
                "sha": "06f93598d505db7a119aeb1b5c0847c99ed7a8f7",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/registries/SupplierRegistry.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/registries/SupplierRegistry.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 0,
                "filename": "src/org/apache/axis/registries/SupplierRegistry.java",
                "patch": "@@ -118,6 +118,10 @@ public Handler remove(String key) {\n      */\n     public Handler find(String key) {\n         Debug.Print( 4, \"Enter: SupplierRegistry::find(\", key, \")\" );\n+        if (key == null) {\n+          Debug.Print( 4, \"Exit: SupplierRegistry::find - key is null\" );\n+          return( null );\n+        }\n         if ( suppliers == null ) {\n           Debug.Print( 4, \"Exit: SupplierRegistry::find - suppliers is null\" );\n           return( null );",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/registries/SupplierRegistry.java",
                "sha": "c3f2a70c0daa3b1a5da2f95e6684fc760bf238d8",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/server/AxisServer.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/server/AxisServer.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 10,
                "filename": "src/org/apache/axis/server/AxisServer.java",
                "patch": "@@ -113,7 +113,8 @@ public void stop()\n      */\n     public AxisServer() {\n       super(Constants.SERVER_HANDLER_REGISTRY,\n-            Constants.SERVER_SERVICE_REGISTRY);\n+            Constants.SERVER_SERVICE_REGISTRY,\n+            Constants.SERVER_TRANSPORT_REGISTRY);\n     }\n \n     /**\n@@ -149,14 +150,6 @@ protected void deployDefaultHandlers()\n       c.addHandler( _handlerRegistry.find( \"debug\" ) );\n       deployHandler( \"global.request\", c );\n       \n-      c = new SimpleChain();\n-      c.addHandler( _handlerRegistry.find( \"HTTPAuth\" ) );\n-      c.addHandler( _handlerRegistry.find( \"HTTPAction\" ) );\n-      // deployHandler( \"HTTP.request\", c );\n-      \n-      SimpleTargetedChain transport = new SimpleTargetedChain();\n-      transport.setRequestHandler(c);\n-      deployTransport(\"HTTP.request\", transport);\n     }\n \n     protected void deployDefaultServices()\n@@ -179,7 +172,20 @@ protected void deployDefaultServices()\n \n     protected void deployDefaultTransports()\n     {\n-      // Do nothing.\n+      Chain c = new SimpleChain();\n+      Handler actionHandler = _handlerRegistry.find( \"HTTPAction\" );\n+      c.addHandler( _handlerRegistry.find( \"HTTPAuth\" ) );\n+      c.addHandler( actionHandler );\n+      \n+      // HTTP transport w/authorization\n+      SimpleTargetedChain transport = new SimpleTargetedChain();\n+      transport.setRequestHandler(c);\n+      deployTransport(\"http\", transport);\n+      \n+      // HTTP transport (for SimpleAxisServer) without auth.\n+      transport = new SimpleTargetedChain();\n+      transport.setRequestHandler(actionHandler);\n+      deployTransport(\"SimpleHTTP\", transport);\n     }\n     \n     /**\n@@ -266,6 +272,7 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n               HandlerRegistry tr = getTransportRegistry();\n               SimpleTargetedChain transportChain = null;\n               \n+              Debug.Print(3, \"AxisServer.invoke: Transport = '\" + hName +\"'\");\n               if ( hName != null && (h = tr.find( hName )) != null ) {\n                 if (h instanceof SimpleTargetedChain) {\n                   transportChain = (SimpleTargetedChain)h;",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/server/AxisServer.java",
                "sha": "d7257b5dc26088b1d4ea6e270efa2e42905b43ec",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/suppliers/TargetedChainSupplier.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 14,
                "filename": "src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "patch": "@@ -95,6 +95,9 @@ public TargetedChainSupplier(String myName,\n     \n     private void addHandlersToChain(Vector names, Chain chain)\n     {\n+      if (names == null)\n+        return;\n+      \n       Enumeration e = names.elements();\n       while (e.hasMoreElements()) {\n         String hName = (String)e.nextElement();\n@@ -114,25 +117,29 @@ public Handler getHandler()\n         c.setOptions(_options);\n         c.setName(_myName);\n         \n-        if (_requestNames.size() == 1) {\n-          h = _registry.find((String)_requestNames.elementAt(0));\n-          c.setRequestHandler(h);\n-        } else {\n-          Chain chain = new SimpleChain();\n-          addHandlersToChain(_requestNames, chain);\n+        if (!_requestNames.isEmpty()) {\n+          if (_requestNames.size() == 1) {\n+            h = _registry.find((String)_requestNames.elementAt(0));\n+            c.setRequestHandler(h);\n+          } else {\n+            Chain chain = new SimpleChain();\n+            addHandlersToChain(_requestNames, chain);\n+            c.setRequestHandler(chain);\n+          }\n         }\n         \n         h = _registry.find(_pivotName);\n-        if (h == null)\n-          return null;  // Should maybe throw an exception here?\n         c.setPivotHandler(h);\n \n-        if (_responseNames.size() == 1) {\n-          h = _registry.find((String)_responseNames.elementAt(0));\n-          c.setRequestHandler(h);\n-        } else {\n-          Chain chain = new SimpleChain();\n-          addHandlersToChain(_responseNames, chain);\n+        if (!_responseNames.isEmpty()) {\n+          if (_responseNames.size() == 1) {\n+            h = _registry.find((String)_responseNames.elementAt(0));\n+            c.setResponseHandler(h);\n+          } else {\n+            Chain chain = new SimpleChain();\n+            addHandlersToChain(_responseNames, chain);\n+            c.setResponseHandler(chain);\n+          }\n         }\n         \n         _chain = c;",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/suppliers/TargetedChainSupplier.java",
                "sha": "be1bef15b77b6dec3636321cb0cb1a9372f35e0f",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/http/AxisServlet.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/AxisServlet.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 18,
                "filename": "src/org/apache/axis/transport/http/AxisServlet.java",
                "patch": "@@ -68,32 +68,25 @@\n  */\n public class AxisServlet extends HttpServlet {\n   // These have default values.\n-  private String transportReqName = \"HTTP.request\";\n-  private String transportRespName = \"HTTP.response\";\n+  private String transportName = \"http\";\n \n   private static final String AXIS_ENGINE = \"AxisEngine\" ;\n \n   public void init() {\n-      String param = getInitParameter(\"transport.request\");\n+      String param = getInitParameter(\"transport.name\");\n       ServletContext context = getServletConfig().getServletContext();\n       \n       if (param == null)\n-          param = context.getInitParameter(\"transport.request\");\n+          param = context.getInitParameter(\"transport.name\");\n       if (param != null)\n-          transportReqName = param;\n-      \n-      param = getInitParameter(\"transport.response\");\n-      if (param == null)\n-          param = context.getInitParameter(\"transport.response\");\n-      if (param != null)\n-          transportRespName = param;\n+          transportName = param;      \n   }\n \n   public void doGet(HttpServletRequest req, HttpServletResponse res)\n                 throws ServletException, IOException {\n     res.setContentType(\"text/html\");\n-    res.getWriter().println( \"In doGet\" );\n-    res.getWriter().println(\" Request = \" + transportReqName);\n+    res.getWriter().println( \"In doGet<p>\" );\n+    res.getWriter().println(\" TransportName = \" + transportName);\n   }\n \n   public void doPost(HttpServletRequest req, HttpServletResponse res)\n@@ -118,11 +111,9 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     /**********************************************************/\n     msgContext.setRequestMessage( msg );\n \n-    /* Set the Transport Specific Request/Response chains IDs */\n-    /******************************************************/\n-    msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName );\n-    msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName );\n-    msgContext.setTransportName(transportReqName);\n+    /* Set the Transport */\n+    /*********************/\n+    msgContext.setTransportName(transportName);\n \n     /* Save some HTTP specific info in the bag in case a handler needs it */\n     /**********************************************************************/",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/http/AxisServlet.java",
                "sha": "948489ddb6f0cf672c0ec3c2ed75455789846925",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/SimpleAxisServer.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 8,
                "filename": "src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "patch": "@@ -126,9 +126,7 @@ private static synchronized AxisServer getAxisServer() {\n     private static byte cannedResponse[] = \"<empty/>\".getBytes();\n \n     // Axis specific constants\n-    private static String transportReqName = \"HTTPAction\";\n-    private static String transportRespName = \"HTTP.response\";\n-    //private static final String AXIS_ENGINE = \"AxisEngine\" ;\n+    private static String transportName = \"SimpleHTTP\";\n     \n     // are we stopped?\n     // latch to true if stop() is called\n@@ -149,8 +147,6 @@ public void run() {\n         // create and initialize a message context\n         MessageContext msgContext = new MessageContext(engine);\n         Message        requestMsg;\n-        msgContext.setProperty(MessageContext.TRANS_REQUEST , transportReqName);\n-        msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName);\n \n         // Reusuable, buffered, content length controlled, InputStream\n         NonBlockingBufferedInputStream is =\n@@ -177,9 +173,8 @@ public void run() {\n             msgContext.setTargetService(null);\n             msgContext.setResponseMessage(null);\n             msgContext.clearProperties();\n-            msgContext.setProperty(\"transport\", \"HTTPTransport\");\n-            msgContext.setProperty(MessageContext.TRANS_REQUEST, transportReqName);\n-            msgContext.setProperty(MessageContext.TRANS_RESPONSE, transportRespName);\n+            //msgContext.setProperty(\"transport\", \"HTTPTransport\");\n+            msgContext.setTransportName(transportName);\n             \n             try {\n                 try {",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "sha": "70fba8275326c97c8822e1e7ebcf00964dd99727",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/local/LocalSender.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/local/LocalSender.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 1,
                "filename": "src/org/apache/axis/transport/local/LocalSender.java",
                "patch": "@@ -100,7 +100,7 @@ public void invoke(MessageContext clientContext) throws AxisFault {\n     String action = clientContext.getStrProp(HTTPConstants.MC_HTTP_SOAPACTION);\n     if (action != null) {\n        serverContext.setProperty(HTTPConstants.MC_HTTP_SOAPACTION, action);\n-       serverContext.setProperty(MessageContext.TRANS_REQUEST , \"HTTPAction\");\n+       serverContext.setTransportName(\"http\");\n     }\n \n     // set the realpath if possible",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/transport/local/LocalSender.java",
                "sha": "ddf3bd354a65ba42e176600a90d87e5a74c95d83",
                "status": "modified"
            },
            {
                "additions": 29,
                "blob_url": "https://github.com/apache/axis1-java/blob/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/utils/Admin.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=a4808751d9943f6ca121900849e2fc13f4c546c2",
                "deletions": 25,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -119,7 +119,7 @@ private static void registerTypeMappings(Element root, SOAPService service)\n     throws Exception\n   {\n     NodeList list = root.getElementsByTagName(\"bean\");\n-    Debug.Print(1, \"Registering \" + list.getLength() + \" service-specific beans.\");\n+    Debug.Print(2, \"Registering \" + list.getLength() + \" service-specific beans.\");\n     for (int i = 0; list != null && i < list.getLength(); i++) {\n       Element el = (Element)list.item(i);\n       registerBeanMapping(el, service.getTypeMappingRegistry());\n@@ -187,12 +187,18 @@ public Document process(MessageContext msgContext, Element root) throws AxisFaul\n         Element tmpEl = doc.createElement(\"engineConfig\");\n         doc.appendChild(tmpEl);\n         \n-        Element el = list(doc, engine, false);\n+        Element el = doc.createElement(\"handlers\");\n+        list(el, engine.getHandlerRegistry());\n         tmpEl.appendChild(el);\n         \n-        el = list(doc, engine, true);\n+        el = doc.createElement(\"services\");\n+        list(el, engine.getServiceRegistry());\n         tmpEl.appendChild(el);\n         \n+        el = doc.createElement(\"transports\");\n+        list(el, engine.getTransportRegistry());\n+        tmpEl.appendChild(el);\n+\n         return( doc );\n       }\n   \n@@ -269,25 +275,17 @@ else if ( type.equals( \"bean\" ) ) {\n    * @return Element our config element, suitable for pumping back through\n    *                 Admin processing later, to redeploy.\n    */\n-  public static Element list(Document doc, AxisEngine engine, boolean doServices)\n+  public static Element list(Element root, HandlerRegistry registry)\n     throws AxisFault\n   {\n-    String elementName = doServices ? \"services\" : \"handlers\";\n-    Element root = doc.createElement( elementName );\n+    Document doc = root.getOwnerDocument();\n \n     Element    elem = null ;\n     Hashtable  opts = null ;\n     String[]   names ;\n     Handler    h ;\n     int        i ;\n     \n-    HandlerRegistry registry;\n-    if (doServices) {\n-      registry = engine.getServiceRegistry();\n-    } else {\n-      registry = engine.getHandlerRegistry();\n-    }\n-\n     names = registry.list();\n \n     for( i = 0 ; names != null && i < names.length ; i++ ) {\n@@ -373,6 +371,8 @@ public static void registerChain(Element elem, AxisEngine engine)\n                                                              hr);\n       hr.add(name,supp);\n     }\n+    \n+    engine.saveHandlerRegistry();\n   }\n   \n   /**\n@@ -512,11 +512,9 @@ public static void registerHandler(Element elem, AxisEngine engine)\n   public static void registerTransport(Element elem, AxisEngine engine)\n     throws AxisFault\n   {\n-    SupplierRegistry tr = engine.getTransportRegistry();\n-    \n     String   name    = elem.getAttribute( \"name\" );\n     String   request   = elem.getAttribute( \"request\" );\n-    String   sender   = elem.getAttribute( \"sender\" );\n+    String   sender   = elem.getAttribute( \"pivot\" );\n     String   response  = elem.getAttribute( \"response\" );\n     Hashtable options = new Hashtable();\n \n@@ -530,24 +528,30 @@ public static void registerTransport(Element elem, AxisEngine engine)\n     Vector reqNames = new Vector();\n     Vector respNames = new Vector();\n \n-    st = new StringTokenizer( request, \" \\t\\n\\r\\f,\" );\n-    while ( st.hasMoreElements() ) {\n-      reqNames.addElement(st.nextToken());\n+    if (request != null) {\n+      st = new StringTokenizer( request, \" \\t\\n\\r\\f,\" );\n+      while ( st.hasMoreElements() ) {\n+        reqNames.addElement(st.nextToken());\n+      }\n+    }\n+\n+    if (response != null) {\n+      st = new StringTokenizer( response, \" \\t\\n\\r\\f,\" );\n+      while ( st.hasMoreElements() ) {\n+        respNames.addElement(st.nextToken());\n+      }\n     }\n     \n-    st = new StringTokenizer( response, \" \\t\\n\\r\\f,\" );\n-    while ( st.hasMoreElements() ) {\n-      respNames.addElement(st.nextToken());\n-    }\n     getOptions( elem, options );\n     \n+    HandlerRegistry hr = engine.getHandlerRegistry();\n     TargetedChainSupplier supp = new TargetedChainSupplier(name,\n                                                            reqNames,\n                                                            respNames,\n                                                            sender,\n                                                            options,\n-                                                           tr);\n-    tr.add(name,supp);\n+                                                           hr);\n+    engine.deployTransport(name, supp);\n   }\n \n   /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/a4808751d9943f6ca121900849e2fc13f4c546c2/src/org/apache/axis/utils/Admin.java",
                "sha": "38f34231a0bbb3235139b8f48c624058a72b4567",
                "status": "modified"
            }
        ],
        "message": "Various changes to get the new transport architecture working.\n\n* use MessageContext.transportName everywhere, remove TRANS_REQUEST/\n  TRANS_RESPONSE properties.\n\n* deploy tranports to/from their own registry file.  Persistence and\n  deployment of Handlers/TypeMappings/Transports/Services needs to be\n  given some more thought in terms of cleanliness, J2EE integration,\n  and component packaging...\n\n* fix various places which might generate NPEs\n\n* clean up Admin.list() to be able to use any registry.\n\n* deploy two default http transports, a secure one (with HTTPAuth)\n  for the servlet and a non-secure one for SimpleAxisServer.\n\n* ServiceClient now has a static \"defaultTransport\" member which,\n  if set, overrides the lookup-by-URL.  This enables the TCP\n  AdminClient to work again, but should be more cleanly architected\n  (how do we expect to convey which transport to use?)\n\n* fix a couple of bugs in TargetedChainSupplier\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@245004 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/a71e35faeaf76681b84b8acdea61f5daeae73869",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSimpleChain.java",
            "TestAxisClient.java",
            "AdminTest.java"
        ]
    },
    "axis1-java_a552384": {
        "bug_id": "axis1-java_a552384",
        "commit": "https://github.com/apache/axis1-java/commit/a552384659d5b51af6fcbca48eb2b545c30d1701",
        "file": [
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/a552384659d5b51af6fcbca48eb2b545c30d1701/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 22,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=a552384659d5b51af6fcbca48eb2b545c30d1701",
                "deletions": 10,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -657,16 +657,18 @@ private void syncOperationToClass(OperationDesc oper, Class implClass)\n                             paramClass = tm.getClassForQName(param.getTypeQName());\n                         }\n \n-                        // This is a match if the paramClass is somehow\n-                        // convertable to the \"real\" parameter type.  If not,\n-                        // break out of this loop.\n-                        if (!JavaUtils.isConvertable(paramClass, actualType)) {\n-                            break;\n-                        }\n-                        \n-                        if (!actualType.isAssignableFrom(paramClass)) {\n-                            // This doesn't fit without conversion\n-                            conversionNecessary = true;\n+                        if (paramClass != null) {\n+                            // This is a match if the paramClass is somehow\n+                            // convertable to the \"real\" parameter type.  If not,\n+                            // break out of this loop.\n+                            if (!JavaUtils.isConvertable(paramClass, actualType)) {\n+                                break;\n+                            }\n+                            \n+                            if (!actualType.isAssignableFrom(paramClass)) {\n+                                // This doesn't fit without conversion\n+                                conversionNecessary = true;\n+                            }\n                         }\n                     }\n                     // In all scenarios the ParameterDesc javaType is set to",
                "raw_url": "https://github.com/apache/axis1-java/raw/a552384659d5b51af6fcbca48eb2b545c30d1701/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "0f82326b9c1914680d74a6a0033be3be3f81563f",
                "status": "modified"
            }
        ],
        "message": "Prevent NPE in case there are problems finding the paramClass\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249138 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/6a9d74e072f38bb6639efd1c8de79e288ed11800",
        "repo": "axis1-java",
        "unit_tests": [
            "TestServiceDesc.java"
        ]
    },
    "axis1-java_ac3876a": {
        "bug_id": "axis1-java_ac3876a",
        "commit": "https://github.com/apache/axis1-java/commit/ac3876a3d5a87e730475d2959cf44ac73278c61f",
        "file": [
            {
                "additions": 202,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/AxisEngine.java",
                "changes": 202,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/AxisEngine.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 0,
                "filename": "src/org/apache/axis/AxisEngine.java",
                "patch": "@@ -0,0 +1,202 @@\n+/*\n+ * The Apache Software License, Version 1.1\n+ *\n+ *\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution,\n+ *    if any, must include the following acknowledgment:\n+ *       \"This product includes software developed by the\n+ *    Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowledgment may appear in the software itself,\n+ *    if and wherever such third-party acknowledgments normally appear.\n+ *\n+ * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n+ *    not be used to endorse or promote products derived from this\n+ *    software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\",\n+ *    nor may \"Apache\" appear in their name, without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+\n+package org.apache.axis;\n+\n+import java.io.*;\n+import java.util.* ;\n+import org.apache.axis.* ;\n+import org.apache.axis.utils.* ;\n+import org.apache.axis.handlers.* ;\n+import org.apache.axis.handlers.soap.* ;\n+import org.apache.axis.registries.* ;\n+import org.apache.axis.encoding.SOAPTypeMappingRegistry;\n+import org.apache.axis.encoding.TypeMappingRegistry;\n+\n+/**\n+ * An <code>AxisEngine</code> is the base class for AxisClient and\n+ * AxisServer.  Handles common functionality like dealing with the\n+ * handler/service registries and loading properties.\n+ *\n+ * @author Glen Daniels (gdaniels@allaire.com)\n+ */\n+public abstract class AxisEngine extends BasicHandler\n+{\n+    /** The handler registry this Engine uses. */\n+    protected HandlerRegistry _handlerRegistry;\n+    protected String handlerRegFilename;\n+    \n+    /** The service registry this Engine uses. */\n+    protected HandlerRegistry _serviceRegistry;\n+    protected String serviceRegFilename;\n+    \n+    protected Properties props = new Properties();\n+    \n+    /**\n+     * No-arg constructor.  Loads properties from the \"axis.properties\"\n+     * file if it exists.\n+     * \n+     */\n+    public AxisEngine()\n+    {\n+        Debug.Print( 1, \"Enter: AxisEngine no-arg constructor\");\n+        try {\n+            File propFile = new File(\"axis.properties\");\n+            if (propFile.exists()) {\n+                FileInputStream propFileInputStream =\n+                         new FileInputStream(propFile);\n+                props.load(propFileInputStream);\n+            }\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+        }\n+        Debug.Print( 1, \"Exit: AxisEngine no-arg constructor\");\n+    }\n+    \n+    /**\n+     * Allows the Listener to specify which handler/service registry\n+     * implementation they want to use.\n+     * \n+     * @param handlers the Handler registry.\n+     * @param services the Service registry.\n+     */\n+    public AxisEngine(HandlerRegistry handlers, HandlerRegistry services)\n+    {\n+        this();\n+        handlers.init();\n+        services.init();\n+        setHandlerRegistry(handlers);\n+        setServiceRegistry(services);\n+    }\n+\n+    /**\n+     * Constructor specifying registry filenames.\n+     * \n+     * @param handlerRegFilename the name of the Handler registry file.\n+     * @param serviceRegFilename the name of the Service registry file.\n+     */\n+    public AxisEngine(String handlerRegFilename, String serviceRegFilename)\n+    {\n+        this();\n+        this.handlerRegFilename = handlerRegFilename;\n+        this.serviceRegFilename = serviceRegFilename;\n+    }\n+\n+    /**\n+     * Find/load the registries and save them so we don't need to do this\n+     * each time we're called.\n+     */\n+    public void init() {\n+        // Load the simple handler registry and init it\n+        Debug.Print( 1, \"Enter: AxisEngine::init\" );\n+        \n+        String propVal = props.getProperty(\"debugLevel\", \"0\");\n+        Debug.setDebugLevel(Integer.parseInt(propVal));\n+        System.out.println(\"Debug level is \" + Debug.getDebugLevel());\n+        \n+        if (getHandlerRegistry() == null) {\n+            System.out.println(\"Using \" + handlerRegFilename);\n+            DefaultHandlerRegistry  hr =\n+                         new DefaultHandlerRegistry(handlerRegFilename);\n+            hr.setOnServer( true );\n+            hr.init();\n+            setHandlerRegistry( hr );\n+        }\n+        \n+        if (getServiceRegistry() == null) {\n+            System.out.println(\"Using \" + serviceRegFilename);\n+            // Load the simple deployed services registry and init it\n+            DefaultServiceRegistry  sr =\n+                         new DefaultServiceRegistry(serviceRegFilename);\n+            sr.setHandlerRegistry( getHandlerRegistry() ); // needs to know about 'hr'\n+            sr.setOnServer( true );\n+            sr.init();\n+            setServiceRegistry( sr );\n+        }\n+\n+        // Load the registry of deployed types\n+        TypeMappingRegistry tmr = new TypeMappingRegistry(\"typemap-supp.reg\");\n+        tmr.setParent(new SOAPTypeMappingRegistry());\n+        addOption( Constants.TYPEMAP_REGISTRY, tmr );\n+        \n+        /** ??? Why are we doing this??\n+         */\n+        Handler admin = getServiceRegistry().find(\"AdminService\");\n+        if (admin != null && admin instanceof SOAPService)\n+          ((SOAPService)admin).setTypeMappingRegistry(tmr);\n+\n+        Debug.Print( 1, \"Exit: AxisEngine::init\" );\n+    }\n+\n+    public HandlerRegistry getHandlerRegistry()\n+    {\n+        return _handlerRegistry;\n+    }\n+    \n+    public void setHandlerRegistry(HandlerRegistry registry)\n+    {\n+        _handlerRegistry = registry;\n+    }\n+    \n+    public HandlerRegistry getServiceRegistry()\n+    {\n+        return _serviceRegistry;\n+    }\n+    \n+    public void setServiceRegistry(HandlerRegistry registry)\n+    {\n+        _serviceRegistry = registry;\n+    }    \n+};",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/AxisEngine.java",
                "sha": "37414a7c09248cb72991ca4077354c5d2e79bf68",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/Constants.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 1,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -61,7 +61,6 @@\n   //  not all Engines will have notion of registries but defining these\n   //  here should allow people to ask if they exist)\n   //////////////////////////////////////////////////////////////////////////\n-  public static String AXIS_ENGINE      = \"AxisEngine\" ;\n   public static String HANDLER_REGISTRY = \"HandlerRegistry\" ;\n   public static String SERVICE_REGISTRY = \"ServiceRegistry\" ;\n   public static String TYPEMAP_REGISTRY = \"TypeMapRegistry\" ;",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/Constants.java",
                "sha": "be66eced60122d65a194d69e9687a744f79eb23a",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/MessageContext.java",
                "changes": 29,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/MessageContext.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 7,
                "filename": "src/org/apache/axis/MessageContext.java",
                "patch": "@@ -58,6 +58,7 @@\n import java.util.* ;\n import org.apache.axis.* ;\n import org.apache.axis.utils.AxisClassLoader ;\n+import org.apache.axis.utils.Debug ;\n import org.apache.axis.encoding.TypeMappingRegistry;\n import org.apache.axis.encoding.SOAPTypeMappingRegistry;\n import org.apache.axis.encoding.ServiceDescription;\n@@ -111,6 +112,11 @@\n      * The default classloader that this service should use\n      */\n     private AxisClassLoader  classLoader ;\n+    \n+    /**\n+     * The AxisEngine which this context is involved with\n+     */\n+    private AxisEngine       axisEngine;\n \n     /**\n      *\n@@ -126,17 +132,14 @@ public MessageContext() { }\n      */\n     private TypeMappingRegistry mappingRegistry = null;\n \n-    private static final SOAPTypeMappingRegistry soapTMR =\n-        new SOAPTypeMappingRegistry();\n-\n     public void setTypeMappingRegistry(TypeMappingRegistry reg) {\n         mappingRegistry = reg;\n     }\n \n     public TypeMappingRegistry getTypeMappingRegistry() {\n         if (mappingRegistry == null) {\n             mappingRegistry = new TypeMappingRegistry();\n-            mappingRegistry.setParent(soapTMR);\n+            mappingRegistry.setParent(SOAPTypeMappingRegistry.getSingleton());\n         }\n         return mappingRegistry;\n     }\n@@ -200,6 +203,16 @@ public void setClassLoader(AxisClassLoader cl ) {\n     public String getTargetService() {\n       return( targetService );\n     }\n+    \n+    public void setAxisEngine(AxisEngine engine)\n+    {\n+      this.axisEngine = engine;\n+    }\n+    \n+    public AxisEngine getAxisEngine()\n+    {\n+      return axisEngine;\n+    }\n \n     /**\n      * Set the target service for this message.\n@@ -211,6 +224,7 @@ public String getTargetService() {\n      * @param tServ the name of the target service.\n      */\n     public void setTargetService(String tServ) {\n+        Debug.Print(2, \"MessageContext: setTargetService(\" + tServ+\")\");\n         targetService = tServ ;\n \n         HandlerRegistry sr = (HandlerRegistry)\n@@ -236,6 +250,7 @@ public void setParsing(boolean parsing)\n     }\n \n     public Handler getServiceHandler() {\n+        Debug.Print(2, \"MessageContext:getServiceHandler()\");\n         if (serviceHandler == null) {\n             if (targetService != null) {\n                 /** This is a bit kludgey for now - what might have\n@@ -271,17 +286,17 @@ public Handler getServiceHandler() {\n                 }\n             }\n       }\n+      Debug.Print(2, \"MessageContext:getServiceHandler() returns \" + serviceHandler);\n       return( serviceHandler );\n     }\n     \n     public void setServiceHandler(Handler sh)\n     {\n+      Debug.Print(2,\"MessageContext: setServiceHandler(\"+sh+\")\");\n       serviceHandler = sh;\n       if (sh != null && sh instanceof SOAPService) {\n         TypeMappingRegistry tmr = ((SOAPService)sh).getTypeMappingRegistry();\n-        getTypeMappingRegistry().setParent(tmr);\n-      } else {\n-        getTypeMappingRegistry().setParent(soapTMR);\n+        setTypeMappingRegistry(tmr);\n       }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/MessageContext.java",
                "sha": "113d7aa43c03512d9f863d81bccb1b71cdb94311",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/client/AxisClient.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AxisClient.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 45,
                "filename": "src/org/apache/axis/client/AxisClient.java",
                "patch": "@@ -2,7 +2,7 @@\n  * The Apache Software License, Version 1.1\n  *\n  *\n- * Copyright (c) 1999 The Apache Software Foundation.  All rights\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n  * reserved.\n  *\n  * Redistribution and use in source and binary forms, with or without\n@@ -70,51 +70,16 @@\n  * @author Doug Davis (dug@us.ibm.com)\n  * @author Glen Daniels (gdaniels@allaire.com)\n  */\n-public class AxisClient extends BasicHandler\n+public class AxisClient extends AxisEngine\n {\n-    public AxisClient() {}\n-    \n-    /**\n-     * Allows the Listener to specify which handler/service registry\n-     * implementation they want to use.\n-     */\n-    /*\n-    public AxisClient(HandlerRegistry handlers, HandlerRegistry services)\n+    public AxisClient()\n     {\n-        Debug.Print( 1, \"Enter: AxisClient::Constructor\");\n-        handlers.init();\n-        services.init();\n-        addOption(Constants.HANDLER_REGISTRY, handlers);\n-        addOption(Constants.SERVICE_REGISTRY, services);\n-        Debug.Print( 1, \"Exit: AxisClient::Constructor\");\n-     }*/\n-    \n-    /**\n-     * Find/load the registries and save them so we don't need to do this\n-     * each time we're called.\n-     * Package access since this should be wrapped by ServiceClient...??? -- RobJ\n-     */\n-    public void init() {\n-        // Load the simple handler registry and init it\n-        Debug.Print( 1, \"Enter: AxisClient::init\" );\n-        DefaultHandlerRegistry  hr =\n-            new DefaultHandlerRegistry(Constants.CLIENT_HANDLER_REGISTRY);\n-        hr.setOnServer( false );\n-        hr.init();\n-        addOption( Constants.HANDLER_REGISTRY, hr );\n-        \n-        // Load the simple deployed services registry and init it\n-        DefaultServiceRegistry  sr =\n-            new DefaultServiceRegistry(Constants.CLIENT_SERVICE_REGISTRY);\n-        sr.setHandlerRegistry( hr ); // Needs to know about 'hr'\n-        sr.setOnServer( false );\n-        sr.init();\n-        addOption( Constants.SERVICE_REGISTRY, sr );\n-        Debug.Print( 1, \"Exit: AxisClient::init\" );\n+        super(Constants.CLIENT_HANDLER_REGISTRY,\n+              Constants.CLIENT_SERVICE_REGISTRY);\n     }\n     \n     /**\n-     * Main routine of the AXIS server.  In short we locate the appropriate\n+     * Main routine of the AXIS engine.  In short we locate the appropriate\n      * handler for the desired service and invoke() it.\n      */\n     public void invoke(MessageContext msgContext) throws AxisFault {\n@@ -123,10 +88,8 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n         String  hName = null ;\n         Handler h     = null ;\n         \n-        HandlerRegistry hr =\n-            (HandlerRegistry) getOption(Constants.HANDLER_REGISTRY);\n-        HandlerRegistry sr =\n-            (HandlerRegistry) getOption(Constants.SERVICE_REGISTRY);\n+        HandlerRegistry hr = getHandlerRegistry();\n+        HandlerRegistry sr = getServiceRegistry();\n         \n         try {\n             hName = msgContext.getStrProp( MessageContext.ENGINE_HANDLER );",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/client/AxisClient.java",
                "sha": "99b1be535c5ff840036af9d7d85e30d21152c646",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 9,
                "filename": "src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "patch": "@@ -186,15 +186,14 @@ public SOAPTypeMappingRegistry() {\n \n         // !!! Seems a little weird to pass a null class here...?\n         addDeserializerFactory(SOAP_ARRAY, null, ArraySerializer.factory);\n-        /*\n-        addDeserializerFactory(SOAP_STRING, se);\n-        addDeserializerFactory(SOAP_BOOLEAN, se);\n-        addDeserializerFactory(SOAP_DOUBLE, se);\n-        addDeserializerFactory(SOAP_FLOAT, se);\n-        addDeserializerFactory(SOAP_INT, se);\n-        addDeserializerFactory(SOAP_LONG, se);\n-        addDeserializerFactory(SOAP_SHORT, se);\n-        */\n+    }\n+    \n+    private static SOAPTypeMappingRegistry singleton = null;\n+    public synchronized static SOAPTypeMappingRegistry getSingleton()\n+    {\n+        if (singleton == null)\n+            singleton = new SOAPTypeMappingRegistry();\n+        return singleton;\n     }\n     \n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "sha": "aa75edddacf687ddd79857987f5243d9e06bb0aa",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/TypeMappingRegistry.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 0,
                "filename": "src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "patch": "@@ -56,6 +56,7 @@\n package org.apache.axis.encoding;\n \n import java.util.Hashtable;\n+import java.util.Enumeration;\n import org.apache.axis.Constants;\n import org.apache.axis.utils.*;\n import org.apache.axis.utils.events.*;",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "sha": "49fd2bfff08565a5f39a1d87df0a36882d6b4903",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/tcp/TCPActionHandler.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 2,
                "filename": "src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "patch": "@@ -128,8 +128,8 @@ public void invoke(MessageContext msgContext) throws AxisFault\n           // and possibly wrong.\n           // ROBJ 911 What *is* the right way to get to the HandlerRegistry from here?!\n           // Is it in the MessageContext?  ... let's look ...\n-          Handler engine = (Handler)msgContext.getProperty(Constants.AXIS_ENGINE);\n-          HandlerRegistry hr = (HandlerRegistry)engine.getOption(Constants.HANDLER_REGISTRY);\n+          AxisEngine engine = (AxisEngine)msgContext.getAxisEngine();\n+          HandlerRegistry hr = engine.getHandlerRegistry();\n           String[] list = hr.list();\n           Handler handler = null;\n           for (int i = 0; i < list.length; i++) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "sha": "f82e2d21ced95855303bad4584b9a78dacd62052",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/server/AxisServer.java",
                "changes": 56,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/server/AxisServer.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 47,
                "filename": "src/org/apache/axis/server/AxisServer.java",
                "patch": "@@ -2,7 +2,7 @@\n  * The Apache Software License, Version 1.1\n  *\n  *\n- * Copyright (c) 1999 The Apache Software Foundation.  All rights\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n  * reserved.\n  *\n  * Redistribution and use in source and binary forms, with or without\n@@ -69,10 +69,11 @@\n  * @author Doug Davis (dug@us.ibm.com)\n  * @author Glen Daniels (gdaniels@allaire.com)\n  */\n-public class AxisServer extends BasicHandler\n+public class AxisServer extends AxisEngine\n {\n     public AxisServer() {\n-      // Debug.setDebugLevel(3);\n+      super(Constants.SERVER_HANDLER_REGISTRY,\n+            Constants.SERVER_SERVICE_REGISTRY);\n     }\n \n     /**\n@@ -81,44 +82,7 @@ public AxisServer() {\n      */\n     public AxisServer(HandlerRegistry handlers, HandlerRegistry services)\n     {\n-        Debug.Print( 1, \"Enter: AxisServer::Constructor\");\n-        handlers.init();\n-        services.init();\n-        addOption(Constants.HANDLER_REGISTRY, handlers);\n-        addOption(Constants.SERVICE_REGISTRY, services);\n-        Debug.Print( 1, \"Exit: AxisServer::Constructor\");\n-    }\n-\n-    /**\n-     * Find/load the registries and save them so we don't need to do this\n-     * each time we're called.\n-     */\n-    public void init() {\n-        // Load the simple handler registry and init it\n-        Debug.Print( 1, \"Enter: AxisServer::init\" );\n-        DefaultHandlerRegistry  hr =\n-          new DefaultHandlerRegistry(Constants.SERVER_HANDLER_REGISTRY);\n-        hr.setOnServer( true );\n-        hr.init();\n-        addOption( Constants.HANDLER_REGISTRY, hr );\n-\n-        // Load the simple deployed services registry and init it\n-        DefaultServiceRegistry  sr =\n-          new DefaultServiceRegistry(Constants.SERVER_SERVICE_REGISTRY);\n-        sr.setHandlerRegistry( hr ); // needs to know about 'hr'\n-        sr.setOnServer( true );\n-        sr.init();\n-        addOption( Constants.SERVICE_REGISTRY, sr );\n-\n-        // Load the registry of deployed types\n-        TypeMappingRegistry tmr = new TypeMappingRegistry(\"typemap-supp.reg\");\n-        tmr.setParent(new SOAPTypeMappingRegistry());\n-        addOption( Constants.TYPEMAP_REGISTRY, tmr );\n-        Handler admin = sr.find(\"AdminService\");\n-        if (admin != null && admin instanceof SOAPService)\n-          ((SOAPService)admin).setTypeMappingRegistry(tmr);\n-\n-        Debug.Print( 1, \"Exit: AxisServer::init\" );\n+        super(handlers, services);\n     }\n \n     /**\n@@ -134,18 +98,16 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n         /* Do some prep-work.  Get the registries and put them in the */\n         /* msgContext so they can be used by later handlers.          */\n         /**************************************************************/\n-        HandlerRegistry hr =\n-            (HandlerRegistry) getOption(Constants.HANDLER_REGISTRY);\n-        HandlerRegistry sr =\n-            (HandlerRegistry) getOption(Constants.SERVICE_REGISTRY);\n+        HandlerRegistry hr = getHandlerRegistry();\n+        HandlerRegistry sr = getServiceRegistry();\n         TypeMappingRegistry tmr =\n             (TypeMappingRegistry) getOption(Constants.TYPEMAP_REGISTRY);\n \n-        msgContext.setProperty(Constants.AXIS_ENGINE, this );\n+        msgContext.setAxisEngine( this );\n         msgContext.setProperty(Constants.HANDLER_REGISTRY, hr);\n         msgContext.setProperty(Constants.SERVICE_REGISTRY, sr);\n \n-        msgContext.getTypeMappingRegistry().setParent(tmr);\n+        msgContext.setTypeMappingRegistry(tmr);\n \n         try {\n           hName = msgContext.getStrProp( MessageContext.ENGINE_HANDLER );",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/server/AxisServer.java",
                "sha": "f73db6a9080bdb14216a434d22f34dfe918bc247",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/transport/http/AxisServlet.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/AxisServlet.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 7,
                "filename": "src/org/apache/axis/transport/http/AxisServlet.java",
                "patch": "@@ -76,7 +76,7 @@\n   public void init() {\n       String param = getInitParameter(\"transport.input\");\n       ServletContext context = getServletConfig().getServletContext();\n-\n+      \n       if (param == null)\n           param = context.getInitParameter(\"transport.input\");\n       if (param != null)\n@@ -102,14 +102,12 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     ServletContext context = config.getServletContext();\n     HttpSession    session = req.getSession();\n \n-    Handler  engine = null ;\n-\n-    //Debug.setDebugLevel( 6 );\n+    AxisEngine  engine = null ;\n \n     /* Get or 'new' the Axis engine object */\n     /***************************************/\n     synchronized(context) {\n-      engine = (Handler) context.getAttribute( AXIS_ENGINE );\n+      engine = (AxisEngine) context.getAttribute( AXIS_ENGINE );\n       if ( engine == null ) {\n         engine = new AxisServer();\n         engine.init();\n@@ -196,8 +194,12 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     /***********************************/\n     msg = msgContext.getResponseMessage();\n     res.setContentType( \"text/xml\" );\n-    String response = (String) msg.getAs(\"String\");\n-    if (msg == null) response=\"No data\";\n+    String response;\n+    if (msg == null) {\n+        response=\"No data\";\n+    } else {\n+        response = (String)msg.getAs(\"String\");\n+    }\n     res.setContentLength( response.length() );\n     res.getWriter().print( response );\n   }",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/transport/http/AxisServlet.java",
                "sha": "06ff6328b6fcbbc1607ada1f23daed5c53f25ca0",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/SimpleAxisServer.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 1,
                "filename": "src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "patch": "@@ -103,7 +103,7 @@ private static synchronized AxisServer getAxisServer() {\n     // Axis specific constants\n     private static String transportInName = \"HTTPAction\";\n     private static String transportOutName = \"HTTP.output\";\n-    private static final String AXIS_ENGINE = \"AxisEngine\" ;\n+    //private static final String AXIS_ENGINE = \"AxisEngine\" ;\n     \n     // are we stopped?\n     // latch to true if stop() is called",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "sha": "dca6b0b47870d41ad8c8d7813ec835d20c68f7b2",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/axis1-java/blob/ac3876a3d5a87e730475d2959cf44ac73278c61f/test/RPCDispatch/TestRPC.java",
                "changes": 30,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestRPC.java?ref=ac3876a3d5a87e730475d2959cf44ac73278c61f",
                "deletions": 8,
                "filename": "test/RPCDispatch/TestRPC.java",
                "patch": "@@ -36,13 +36,13 @@\n     private Handler RPCDispatcher;\n \n     private String SOAPAction = \"urn:reverse\";\n-    private String methodNS   = null;\n+    private String methodNS   = SOAPAction;\n \n     public TestRPC(String name) {\n         super(name);\n         engine.init();\n-        hr = (HandlerRegistry) engine.getOption(Constants.HANDLER_REGISTRY);\n-        sr = (HandlerRegistry) engine.getOption(Constants.SERVICE_REGISTRY);\n+        hr = (HandlerRegistry) engine.getHandlerRegistry();\n+        sr = (HandlerRegistry) engine.getServiceRegistry();\n         RPCDispatcher = hr.find(\"RPCDispatcher\");\n         // Debug.setDebugLevel(5);\n     }\n@@ -53,7 +53,8 @@ public TestRPC(String name) {\n      * @param request XML body of the request\n      * @return Deserialized result\n      */\n-    private final Object rpc(String method, Object[] parms)\n+    private final Object rpc(String method, Object[] parms,\n+                             boolean setService)\n         throws AxisFault\n     {\n \n@@ -70,7 +71,9 @@ private final Object rpc(String method, Object[] parms)\n         MessageContext msgContext = new MessageContext();\n         msgContext.setProperty(Constants.SERVICE_REGISTRY, sr);\n         msgContext.setRequestMessage(new Message(envelope, \"SOAPEnvelope\"));\n-        msgContext.setTargetService(SOAPAction);\n+        if (setService) {\n+            msgContext.setTargetService(SOAPAction);\n+        }\n \n         // Invoke the Axis engine\n         try {\n@@ -109,7 +112,18 @@ public void testReverseString() throws Exception {\n         sr.add(SOAPAction, reverse);\n \n         // invoke the service and verify the result\n-        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}));\n+        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}, true));\n+    }\n+\n+    public void testReverseBodyDispatch() throws Exception {\n+        // Register the reverseString service\n+        SOAPService reverse = new SOAPService(RPCDispatcher, \"RPCDispatcher\");\n+        reverse.addOption(\"className\", \"test.RPCDispatch.Service\");\n+        reverse.addOption(\"methodName\", \"reverseString\");\n+        sr.add(SOAPAction, reverse);\n+\n+        // invoke the service and verify the result\n+        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}, false));\n     }\n \n     /**\n@@ -125,7 +139,7 @@ public void testReverseData() throws Exception {\n         // invoke the service and verify the result\n         Data input    = new Data(5, \"abc\", 3);\n         Data expected = new Data(3, \"cba\", 5);\n-        assertEquals(expected, rpc(\"reverseData\", new Object[] {input}));\n+        assertEquals(expected, rpc(\"reverseData\", new Object[] {input}, true));\n     }\n \n     /**\n@@ -139,6 +153,6 @@ public void testMessageContext() throws Exception {\n         sr.add(SOAPAction, reverse);\n \n         // invoke the service and verify the result\n-        assertEquals(SOAPAction, rpc(\"targetService\", new Object[] {}));\n+        assertEquals(SOAPAction, rpc(\"targetService\", new Object[] {}, true));\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/ac3876a3d5a87e730475d2959cf44ac73278c61f/test/RPCDispatch/TestRPC.java",
                "sha": "37be994adb1269ea59a6f6839e82d45751d836bc",
                "status": "modified"
            }
        ],
        "message": "* First cut at the AxisEngine hierarchy\n\nIntroduce an abstract AxisEngine base class, from which both AxisClient\nand AxisServer inherit.  The AxisEngine handles the registries and loading\nengine-wide properties from a properties file (this should migrate to\nXML at some point).  init() has been factored out of both AxisClient and\nAxisServer.\n\nEnable setting default debug level via the properties file.\n\nThe AxisEngine class also has the handler and service registries as first-\nclass member vars, with getters and setters, rather than using the\noption bag for this.  This required various tweaks to classes that wanted\nto use the option bag.\n\n* Add a test to TestRPC to verify that dispatching off the RPC body\n  element QName works\n\n* Fix a potential NPE bug in AxisServlet\n\n* Pull AxisEngine out into a member variable in MessageContext\n\n* Remove the static SOAPTypeMappingRegistry from MessageContext, replace\n  with SOAPTypeMappingRegistry.getSingleton()\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@244920 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/3966ba3224325814cb5551cab82574754eafd3d2",
        "repo": "axis1-java",
        "unit_tests": [
            "TestAxisClient.java"
        ]
    },
    "axis1-java_afda30b": {
        "bug_id": "axis1-java_afda30b",
        "commit": "https://github.com/apache/axis1-java/commit/afda30bd0d2c04d7181278e00fc034c82c912b2a",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/afda30bd0d2c04d7181278e00fc034c82c912b2a/build.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/build.xml?ref=afda30bd0d2c04d7181278e00fc034c82c912b2a",
                "deletions": 1,
                "filename": "build.xml",
                "patch": "@@ -352,7 +352,7 @@ Copyright:\n   <!-- =================================================================== -->\n   <!-- Creates the binary distribution                                     -->\n   <!-- =================================================================== -->\n-  <target name=\"dist\" depends=\"compile, junit, samples, javadocs\" >\n+  <target name=\"dist\" depends=\"compile, javadocs, samples, junit\" >\n     <mkdir dir=\"${dist.dir}\"/>\n     <mkdir dir=\"${dist.dir}/docs\"/>\n     <mkdir dir=\"${dist.dir}/docs/apiDocs\"/>",
                "raw_url": "https://github.com/apache/axis1-java/raw/afda30bd0d2c04d7181278e00fc034c82c912b2a/build.xml",
                "sha": "cfa78eb315a6e87f8637b97a4b7187e467af32ee",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/afda30bd0d2c04d7181278e00fc034c82c912b2a/src/org/apache/axis/utils/Admin.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=afda30bd0d2c04d7181278e00fc034c82c912b2a",
                "deletions": 1,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -383,7 +383,7 @@ public Document process(MessageContext msgContext, Element root)\n         AxisEngine engine = msgContext.getAxisEngine();\n         \n         // If this is WSDD, process it correctly.\n-        if (rootNS.equals(WSDDConstants.WSDD_NS)) {\n+        if (rootNS != null && rootNS.equals(WSDDConstants.WSDD_NS)) {\n             return processWSDD(engine, root);\n         }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/afda30bd0d2c04d7181278e00fc034c82c912b2a/src/org/apache/axis/utils/Admin.java",
                "sha": "2db593def8632b03e3a725dbe36e2009ca31c1d9",
                "status": "modified"
            }
        ],
        "message": "Fix NPE.\nChange order of build - seemed odd that we ran junit before we built\neverything.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@245713 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/3150b9829baf5888cb2ed7dbd89b0ad3dfd9e626",
        "repo": "axis1-java",
        "unit_tests": [
            "AdminTest.java"
        ]
    },
    "axis1-java_aff486a": {
        "bug_id": "axis1-java_aff486a",
        "commit": "https://github.com/apache/axis1-java/commit/aff486af8c4babc7bbf2ad91199cc7304a465477",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/EchoServiceBindingStub.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/EchoServiceBindingStub.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 0,
                "filename": "samples/echo/EchoServiceBindingStub.java",
                "patch": "@@ -62,6 +62,13 @@ public EchoServiceBindingStub(javax.xml.rpc.Service service) throws org.apache.a\n             cachedSerFactories.add(arraysf);\n             cachedDeserFactories.add(arraydf);\n \n+            qName = new javax.xml.rpc.namespace.QName(\"http://soapinterop.org/\", \"ArrayOf_tns2_Map\");\n+            cachedSerQNames.add(qName);\n+            cls = java.util.HashMap[].class;\n+            cachedSerClasses.add(cls);\n+            cachedSerFactories.add(arraysf);\n+            cachedDeserFactories.add(arraydf);\n+\n             qName = new javax.xml.rpc.namespace.QName(\"http://soapinterop.org/xsd\", \"ArrayOfstring\");\n             cachedSerQNames.add(qName);\n             cls = java.lang.String[].class;",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/EchoServiceBindingStub.java",
                "sha": "068742506de01ffd12bb7c49f5bb7008a15fae8a",
                "status": "modified"
            },
            {
                "additions": 54,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/TestClient.java",
                "changes": 192,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/TestClient.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 138,
                "filename": "samples/echo/TestClient.java",
                "patch": "@@ -181,170 +181,106 @@ public void execute2A() throws Exception {\n \n         {\n             String input = \"abccdefg\";\n-            try {\n-                output = binding.echoString(input);\n-                verify(\"echoString\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoString\", input, e);\n-            }\n+            output = binding.echoString(input);\n+            verify(\"echoString\", input, output);\n         }\n         \n         {\n             String[] input = new String[] {\"abc\", \"def\"};\n-            try {\n-                output = binding.echoStringArray(input);\n-                verify(\"echoStringArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStringArray\", input, e);\n-            }\n+            output = binding.echoStringArray(input);\n+            verify(\"echoStringArray\", input, output);\n         }\n         \n         {\n             Integer input = new Integer(42);\n-            try {\n-                output = new Integer( binding.echoInteger(input.intValue()));\n-                verify(\"echoInteger\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoInteger\", input, e);\n-            }\n+            output = new Integer( binding.echoInteger(input.intValue()));\n+            verify(\"echoInteger\", input, output);\n         }\n         \n         {\n             int[] input = new int[] {42};\n-            try {\n-                output = binding.echoIntegerArray(input);\n-                verify(\"echoIntegerArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoIntegerArray\", input, e);\n-            }\n+            output = binding.echoIntegerArray(input);\n+            verify(\"echoIntegerArray\", input, output);\n         }\n         \n         {\n             Float input = new Float(3.7F);\n-            try {\n-                output = new Float(binding.echoFloat(input.floatValue()));\n-                verify(\"echoFloat\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoFloat\", input, e);\n-            }\n+            output = new Float(binding.echoFloat(input.floatValue()));\n+            verify(\"echoFloat\", input, output);\n         }\n \n         {\n             float[] input = new float[] {3.7F, 7F};\n-            try {\n-                output = binding.echoFloatArray(input);\n-                verify(\"echoFloatArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoFloatArray\", input, e);\n-            }\n+            output = binding.echoFloatArray(input);\n+            verify(\"echoFloatArray\", input, output);\n         }\n \n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                output = binding.echoStruct(input);\n-                verify(\"echoStruct\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStruct\", input, e);\n-            }\n+            output = binding.echoStruct(input);\n+            verify(\"echoStruct\", input, output);\n         }\n         \n         {\n             SOAPStruct[] input = new SOAPStruct[] {\n                 new SOAPStruct(1, \"one\", 1.1F),\n                 new SOAPStruct(2, \"two\", 2.2F),\n                 new SOAPStruct(3, \"three\", 3.3F)};\n-            try {\n-                output = binding.echoStructArray(input);\n-                verify(\"echoStructArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStructArray\", input, e);\n-            }\n+            output = binding.echoStructArray(input);\n+            verify(\"echoStructArray\", input, output);\n         }\n \n         {\n-            try {\n-                binding.echoVoid();\n-                verify(\"echoVoid\", null, null);\n-            } catch (Exception e) {\n-                verify(\"echoVoid\", null, e);\n-            }\n+            binding.echoVoid();\n+            verify(\"echoVoid\", null, null);\n         }\n \n         {\n             byte[] input = \"Base64\".getBytes();\n-            try {\n-                output = binding.echoBase64(input);\n-                verify(\"echoBase64\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoBase64\", input, e);\n-            }\n+            output = binding.echoBase64(input);\n+            verify(\"echoBase64\", input, output);\n         }\n         \n         {\n             Hex input = new Hex(\"3344\");\n-            try {\n-                output = binding.echoHexBinary(input.getBytes());\n-                verify(\"echoHexBinary\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoHexBinary\", input, e);\n-            }\n+            output = binding.echoHexBinary(input.getBytes());\n+            verify(\"echoHexBinary\", input, output);\n         }\n         \n         {\n             Date input = new Date();\n-            try {\n-                output = binding.echoDate(input);\n-                verify(\"echoDate\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoDate\", input, e);\n-            }\n+            output = binding.echoDate(input);\n+            verify(\"echoDate\", input, output);\n         }\n         \n         {\n             BigDecimal input = new BigDecimal(\"3.14159\");\n-            try {\n-                output = binding.echoDecimal(input);\n-                verify(\"echoDecimal\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoDecimal\", input, e);\n-            }\n+            output = binding.echoDecimal(input);\n+            verify(\"echoDecimal\", input, output);\n         }\n         \n         {\n             Boolean input = Boolean.TRUE;\n-            try {\n-                output = new Boolean( binding.echoBoolean(input.booleanValue()));\n-                verify(\"echoBoolean\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoBoolean\", input, e);\n-            }\n+            output = new Boolean( binding.echoBoolean(input.booleanValue()));\n+            verify(\"echoBoolean\", input, output);\n         }\n         \n         HashMap map = new HashMap();\n         map.put(new Integer(5), \"String Value\");\n         map.put(\"String Key\", new Date());\n         {\n             HashMap input = map;\n-            try {\n-                output = binding.echoMap(input);\n-                verify(\"echoMap\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoMap\", input, e);\n-            }\n+            output = binding.echoMap(input);\n+            verify(\"echoMap\", input, output);\n         }\n \n         HashMap map2 = new HashMap();\n         map2.put(\"this is the second map\", new Boolean(true));\n         map2.put(\"test\", new Float(411));\n         {\n             HashMap[] input = new HashMap [] {map, map2 };\n-            try {\n-                output = binding.echoMapArray(input);\n-                verify(\"echoMapArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoMapArray\", input, e);\n-            }\n+            output = binding.echoMapArray(input);\n+            verify(\"echoMapArray\", input, output);\n         }\n     }\n \n@@ -356,32 +292,24 @@ public void execute2B() throws Exception {\n         Object output = null;\n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                StringHolder outputString = new StringHolder();\n-                IntHolder outputInteger = new IntHolder();\n-                FloatHolder outputFloat = new FloatHolder();\n-                binding.echoStructAsSimpleTypes(input, outputString, outputInteger, outputFloat);\n-                output = new SOAPStruct(outputInteger.value,\n-                                        outputString.value,\n-                                        outputFloat.value);\n-                verify(\"echoStructAsSimpleTypes\", \n-                       input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStructAsSimpleTypes\", input, e);\n-            }\n+            StringHolder outputString = new StringHolder();\n+            IntHolder outputInteger = new IntHolder();\n+            FloatHolder outputFloat = new FloatHolder();\n+            binding.echoStructAsSimpleTypes(input, outputString, outputInteger, outputFloat);\n+            output = new SOAPStruct(outputInteger.value,\n+                                    outputString.value,\n+                                    outputFloat.value);\n+            verify(\"echoStructAsSimpleTypes\", \n+                   input, output);\n         }\n \n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                output = binding.echoSimpleTypesAsStruct(\n-                   input.getVarString(), input.getVarInt(), input.getVarFloat());\n-                verify(\"echoSimpleTypesAsStruct\", \n-                       input, \n-                       output);\n-            } catch (Exception e) {\n-                verify(\"echoSimpleTypesAsStruct\", input, e);\n-            }\n+            output = binding.echoSimpleTypesAsStruct(\n+                    input.getVarString(), input.getVarInt(), input.getVarFloat());\n+            verify(\"echoSimpleTypesAsStruct\", \n+                   input, \n+                   output);\n         }\n \n         {\n@@ -390,39 +318,27 @@ public void execute2B() throws Exception {\n             input[0][1] = \"01\";\n             input[1][0] = \"10\";\n             input[1][1] = \"11\";\n-            try {\n-                output = binding.echo2DStringArray(input);\n-                verify(\"echo2DStringArray\", \n-                       input, \n-                       output);\n-            } catch (Exception e) {\n-                verify(\"echo2DStringArray\", input, e);\n-            }\n+            output = binding.echo2DStringArray(input);\n+            verify(\"echo2DStringArray\", \n+                   input, \n+                   output);\n         }\n \n         {\n             SOAPStructStruct input = new SOAPStructStruct(\"AXIS\",\n                                                           1,\n                                                           3F,\n                                                           new SOAPStruct(5, \"Hello\", 103F));\n-            try {\n-                output = binding.echoNestedStruct(input);\n-                verify(\"echoNestedStruct\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoNestedStruct\", input, e);\n-            }\n+            output = binding.echoNestedStruct(input);\n+            verify(\"echoNestedStruct\", input, output);\n         }\n         {\n             SOAPArrayStruct input = new SOAPArrayStruct(\"AXIS\",\n                                                         1,\n                                                         3F,\n                                                         new String[] {\"one\", \"two\", \"three\"});\n-            try {\n-                output = binding.echoNestedArray(input);\n-                verify(\"echoNestedArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoNestedArray\", input, e);\n-            }\n+            output = binding.echoNestedArray(input);\n+            verify(\"echoNestedArray\", input, output);\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/TestClient.java",
                "sha": "70eb56c80c56cde23f066dcdf7e61fd2d8730554",
                "status": "modified"
            },
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/deploy.wsdd",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/deploy.wsdd?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "samples/echo/deploy.wsdd",
                "patch": "@@ -6,8 +6,9 @@\n <!--   java org.apache.axis.client.http.AdminClient deploy.wsdd  -->\n <!--      after the axis server is running                      -->\n \n- <deployment \tname=\"test\" xmlns=\"http://xml.apache.org/axis/wsdd/\" \n+ <deployment \tname=\"test\" xmlns=\"http://xml.apache.org/axis/wsdd/\"\n \t\t\txmlns:java=\"http://xml.apache.org/axis/wsdd/providers/java\"\n+            xmlns:xsd=\"http://www.w3.org/2000/10/XMLSchema\"\n \t\t\txmlns:xsi=\"http://www.w3.org/2000/10/XMLSchema-instance\">\n   <service name=\"echo\" provider=\"java:RPC\" >\n     <namespace>http://soapinterop.org/</namespace>\n@@ -62,6 +63,14 @@\n         deserializer=\"org.apache.axis.encoding.ser.ArrayDeserializerFactory\"\n         encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\n       />\n+      <typeMapping\n+        xmlns:ns=\"http://soapinterop.org/\"\n+        qname=\"ns:ArrayOf_tns2_Map\"\n+        type=\"java:java.util.HashMap[]\"\n+        serializer=\"org.apache.axis.encoding.ser.ArraySerializerFactory\"\n+        deserializer=\"org.apache.axis.encoding.ser.ArrayDeserializerFactory\"\n+        encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\n+      />\n       <typeMapping\n         xmlns:ns=\"http://soapinterop.org/xsd\"\n         qname=\"ns:SOAPStructStruct\"\n@@ -87,5 +96,13 @@\n         <handler type=\"java:samples.echo.echoHeaderStringHandler\"/>\n         <handler type=\"java:samples.echo.echoHeaderStructHandler\"/>\n     </responseFlow>\n+\n+    <operation name=\"echoStructAsSimpleTypes\">\n+      <parameter name=\"inputStruct\" xmlns:ns=\"http://soapinterop.org/xsd\"\n+                 type=\"ns:SOAPStruct\"/>\n+      <parameter name=\"outputString\" type=\"xsd:string\" mode=\"OUT\"/>\n+      <parameter name=\"outputInteger\" type=\"xsd:int\" mode=\"OUT\"/>\n+      <parameter name=\"outputFloat\" type=\"xsd:float\" mode=\"OUT\"/>\n+    </operation>\n   </service>\n </deployment>",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/samples/echo/deploy.wsdd",
                "sha": "154c22bd0e55e4eabb7a586be9dd215feac00876",
                "status": "modified"
            },
            {
                "additions": 40,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/client/Call.java",
                "changes": 61,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Call.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 21,
                "filename": "src/org/apache/axis/client/Call.java",
                "patch": "@@ -698,7 +698,12 @@ public boolean isParameterAndReturnSpecRequired() {\n      */\n     public void addParameter(QName paramName, QName xmlType,\n             ParameterMode parameterMode) {\n-        addParameter(paramName, xmlType, null, parameterMode);\n+        Class javaType = null;\n+        TypeMapping tm = getTypeMapping();\n+        if (tm != null) {\n+            javaType = tm.getClassForQName(xmlType);\n+        }\n+        addParameter(paramName, xmlType, javaType, parameterMode);\n     }\n \n     /**\n@@ -749,7 +754,12 @@ public void addParameter(QName paramName, QName xmlType,\n      */\n     public void addParameter(String paramName, QName xmlType,\n             ParameterMode parameterMode) {\n-        addParameter(new QName(\"\", paramName), xmlType, null, parameterMode);\n+        Class javaType = null;\n+        TypeMapping tm = getTypeMapping();\n+        if (tm != null) {\n+            javaType = tm.getClassForQName(xmlType);\n+        }\n+        addParameter(new QName(\"\", paramName), xmlType, javaType, parameterMode);\n     }\n \n     /**\n@@ -812,7 +822,11 @@ public QName getParameterTypeByQName(QName paramQName) {\n     public void setReturnType(QName type) {\n         if (parmAndRetReq) {\n             returnType = type ;\n-            if (operation != null) operation.setReturnType(type);\n+            if (operation != null) {\n+                operation.setReturnType(type);\n+                TypeMapping tm = getTypeMapping();\n+                operation.setReturnClass(tm.getClassForQName(type));\n+            }\n         }\n         else {\n             throw new JAXRPCException();\n@@ -1517,6 +1531,22 @@ public void clearHeaders()\n     {\n         myHeaders = null;\n     }\n+    \n+    public TypeMapping getTypeMapping()\n+    {\n+        // Get the TypeMappingRegistry\n+        TypeMappingRegistry tmr = msgContext.getTypeMappingRegistry();\n+\n+        // If a TypeMapping is not available, add one.\n+        TypeMapping tm = (TypeMapping) tmr.getTypeMapping(encodingStyle);\n+        TypeMapping defaultTM = (TypeMapping) tmr.getDefaultTypeMapping();\n+        if (tm == null || tm == defaultTM ) {\n+            tm = (TypeMapping) tmr.createTypeMapping();\n+            tm.setSupportedNamespaces(new String[] {encodingStyle});\n+            tmr.register(encodingStyle, tm);\n+        }\n+        return tm;\n+    }\n \n     /**\n      * Register type mapping information for serialization/deserialization\n@@ -1537,25 +1567,14 @@ public void registerTypeMapping(Class javaType, QName xmlType,\n                                     SerializerFactory sf,\n                                     DeserializerFactory df,\n                                     boolean force) {\n-        // Get the TypeMappingRegistry\n-        TypeMappingRegistry tmr = msgContext.getTypeMappingRegistry();\n-\n-        // If a TypeMapping is not available, add one.\n-        TypeMapping tm = (TypeMapping) tmr.getTypeMapping(encodingStyle);\n-        TypeMapping defaultTM = (TypeMapping) tmr.getDefaultTypeMapping();\n-        try {\n-            if (tm == null || tm == defaultTM ) {\n-                tm = (TypeMapping) tmr.createTypeMapping();\n-                tm.setSupportedNamespaces(new String[] {encodingStyle});\n-                tmr.register(encodingStyle, tm);\n-            }\n-            if (!force && tm.isRegistered(javaType, xmlType))\n-                return;\n-\n-            // Register the information\n-            tm.register(javaType, xmlType, sf, df);\n-        } catch (Exception e) {}\n+        TypeMapping tm = getTypeMapping();\n+        if (!force && tm.isRegistered(javaType, xmlType))\n+            return;\n+        \n+        // Register the information\n+        tm.register(javaType, xmlType, sf, df);\n     }\n+\n     public void registerTypeMapping(Class javaType, QName xmlType,\n                                     Class sfClass, Class dfClass) {\n         registerTypeMapping(javaType, xmlType, sfClass, dfClass, true);",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/client/Call.java",
                "sha": "a2e92732dc9a83cfadb5270dc330fb2fd3be953a",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/client/Service.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Service.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/Service.java",
                "patch": "@@ -548,7 +548,7 @@ public void setTypeMappingRegistry(TypeMappingRegistry registry)\n      * @return TypeMappingRegistry The registry\n      */\n     public TypeMappingRegistry getTypeMappingRegistry() {\n-        return( null );\n+        return( engine.getTypeMappingRegistry() );\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/client/Service.java",
                "sha": "8434eaeaef5a7174f440a5c857487930248b9286",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/deployment/wsdd/WSDDOperation.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 6,
                "filename": "src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "patch": "@@ -110,12 +110,14 @@ public WSDDOperation(Element e, ServiceDesc parent)\n                 throw new WSDDException(JavaUtils.getMessage(\"onlyOneMapping\"));\n             }\n \n-            // Register a mapping from an Element QName to a particular\n-            // method so we can dispatch for doc/lit services.\n-            Element el = mappingElements[0];\n-            String elString = el.getAttribute(\"qname\");\n-            QName elQName = XMLUtils.getQNameFromString(elString, el);\n-            desc.setElementQName(elQName);\n+            if (mappingElements.length > 0) {\n+                // Register a mapping from an Element QName to a particular\n+                // method so we can dispatch for doc/lit services.\n+                Element el = mappingElements[0];\n+                String elString = el.getAttribute(\"qname\");\n+                QName elQName = XMLUtils.getQNameFromString(elString, el);\n+                desc.setElementQName(elQName);\n+            }\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "sha": "ea47809bca9b50170ec03d027d38bdf9e3a0c611",
                "status": "modified"
            },
            {
                "additions": 41,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/description/OperationDesc.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/OperationDesc.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "src/org/apache/axis/description/OperationDesc.java",
                "patch": "@@ -57,6 +57,7 @@\n import javax.xml.rpc.namespace.QName;\n import java.util.ArrayList;\n import java.util.Iterator;\n+import java.lang.reflect.Method;\n \n /**\n  * An OperationDesc is an abstract description of an operation on a service.\n@@ -83,10 +84,18 @@\n \n     /** The return type */\n     private QName returnType;\n+    \n+    /** The return class */\n+    private Class returnClass;\n+    \n+    // FIXME : Just have a return ParamDesc???\n \n     /** The Java method name this maps to (is this just name?) */\n     private String methodName;\n \n+    /** The actual Java method associated with this operation, if known */\n+    private Method method;\n+\n     /** This operation's style.  If null, we default to our parent's */\n     private Integer style;\n \n@@ -129,6 +138,14 @@ public void setReturnType(QName returnType) {\n         this.returnType = returnType;\n     }\n \n+    public Class getReturnClass() {\n+        return returnClass;\n+    }\n+\n+    public void setReturnClass(Class returnClass) {\n+        this.returnClass = returnClass;\n+    }\n+\n     public QName getElementQName() {\n         return elementQName;\n     }\n@@ -194,6 +211,14 @@ public int getNumParams() {\n         return parameters.size();\n     }\n \n+    public Method getMethod() {\n+        return method;\n+    }\n+\n+    public void setMethod(Method method) {\n+        this.method = method;\n+    }\n+\n     public ParameterDesc getParamByQName(QName qname)\n     {\n         for (Iterator i = parameters.iterator(); i.hasNext();) {\n@@ -211,7 +236,7 @@ public ParameterDesc getInputParamByQName(QName qname)\n \n         param = getParamByQName(qname);\n \n-        if ((param == null) || (param.getMode() != ParameterDesc.IN)) {\n+        if ((param == null) || (param.getMode() == ParameterDesc.OUT)) {\n             param = null;\n         }\n \n@@ -233,10 +258,25 @@ public ParameterDesc getOutputParamByQName(QName qname)\n                 param = new ParameterDesc();\n                 param.setQName(qname);\n                 param.setTypeQName(returnType);\n+                param.setJavaType(returnClass);\n             }\n         }\n \n         return param;\n     }\n+\n+    /**\n+     * Returns an ordered list of out params (NOT inouts)\n+     */\n+    public ArrayList getOutParams() {\n+        ArrayList result = new ArrayList();\n+        for (Iterator i = parameters.iterator(); i.hasNext();) {\n+            ParameterDesc desc = (ParameterDesc) i.next();\n+            if (desc.getMode() == ParameterDesc.OUT) {\n+                result.add(desc);\n+            }\n+        }\n+        return result;\n+    }\n }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/description/OperationDesc.java",
                "sha": "97ec1aa8a28007577bea0bdb6db7d0b68295a482",
                "status": "modified"
            },
            {
                "additions": 221,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 272,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 51,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -56,6 +56,7 @@\n \n import org.apache.axis.utils.JavaUtils;\n import org.apache.axis.encoding.TypeMapping;\n+import org.apache.axis.encoding.TypeMappingRegistry;\n \n import javax.xml.rpc.namespace.QName;\n import java.util.ArrayList;\n@@ -114,6 +115,10 @@\n     /** Lookup caches */\n     private HashMap name2OperationsMap = null;\n     private HashMap qname2OperationMap = null;\n+    private HashMap method2OperationMap = new HashMap();\n+    private ArrayList completedNames = new ArrayList();\n+\n+    private TypeMapping tm = null;\n \n     /**\n      * Default constructor\n@@ -159,6 +164,22 @@ public void setAllowedMethods(ArrayList allowedMethods) {\n         this.allowedMethods = allowedMethods;\n     }\n \n+    public Class getImplClass() {\n+        return implClass;\n+    }\n+\n+    public void setImplClass(Class implClass) {\n+        this.implClass = implClass;\n+    }\n+\n+    public TypeMapping getTypeMapping() {\n+        return tm;\n+    }\n+\n+    public void setTypeMapping(TypeMapping tm) {\n+        this.tm = tm;\n+    }\n+\n     public void addOperationDesc(OperationDesc operation)\n     {\n         operations.add(operation);\n@@ -176,38 +197,42 @@ public void addOperationDesc(OperationDesc operation)\n         }\n \n         overloads.add(operation);\n-\n-        // If we're adding these, we won't introspect (either because we\n-        // trust the deployer/user to add everything instead, or because\n-        // we're actually in the middle of introspecting right now)\n-        hasOperationData = true;\n     }\n \n     public OperationDesc [] getOperationsByName(String methodName)\n     {\n+        getSyncedOperationsForName(methodName);\n+\n         if (name2OperationsMap == null)\n             return null;\n \n-        ArrayList result = (ArrayList)name2OperationsMap.get(methodName);\n-        if (result == null)\n+        ArrayList overloads = (ArrayList)name2OperationsMap.get(methodName);\n+        if (overloads == null) {\n             return null;\n+        }\n \n-        OperationDesc [] array = new OperationDesc [result.size()];\n-        return (OperationDesc[])result.toArray(array);\n+        OperationDesc [] array = new OperationDesc [overloads.size()];\n+        return (OperationDesc[])overloads.toArray(array);\n     }\n \n     /**\n      * Return an operation matching the given method name.  Note that if we\n      * have multiple overloads for this method, we will return the first one.\n      */\n-    public OperationDesc getOperationDescByName(String methodName)\n+    public OperationDesc getOperationByName(String methodName)\n     {\n+        // If we need to load up operations from introspection data, do it.\n+        // This returns fast if we don't need to do anything, so it's not very\n+        // expensive.\n+        getSyncedOperationsForName(methodName);\n+\n         if (name2OperationsMap == null)\n             return null;\n \n         ArrayList overloads = (ArrayList)name2OperationsMap.get(methodName);\n-        if (overloads == null)\n+        if (overloads == null) {\n             return null;\n+        }\n \n         return (OperationDesc)overloads.get(0);\n     }\n@@ -219,9 +244,13 @@ public OperationDesc getOperationByElementQName(QName qname)\n     {\n         // If we're a wrapped service (i.e. RPC or WRAPPED style), we expect\n         // this qname to match one of our operation names directly.\n-        // FIXME : Should this really ignore namespaces?\n+\n+        // FIXME : Should this really ignore namespaces?  Perhaps we should\n+        //         just check by QName... (I think that's right, actually,\n+        //         and the only time we should ignore namespaces is when\n+        //         deserializing SOAP-encoded structures?)\n         if (isWrapped()) {\n-            return getOperationDescByName(qname.getLocalPart());\n+            return getOperationByName(qname.getLocalPart());\n         }\n \n         // If we're MESSAGE style, we should only have a single operation,\n@@ -246,55 +275,196 @@ public OperationDesc getOperationByElementQName(QName qname)\n     }\n \n     /**\n-     * Fill in what we can of the service description by introspecting a\n-     * Java class.  Only do this if we haven't already been filled in.\n+     * Synchronize an existing OperationDesc to a java.lang.Method.\n+     *\n+     * This method is used when the deployer has specified operation metadata\n+     * and we want to match that up with a real java Method so that the\n+     * Operation-level dispatch carries us all the way to the implementation.\n+     * Search the declared methods on the implementation class to find one\n+     * with an argument list which matches our parameter list.\n      */\n-    public void loadServiceDescByIntrospection(Class jc, TypeMapping tm)\n+    private void syncOperationToClass(OperationDesc oper)\n     {\n-        if (hasOperationData)\n+        // If we're already mapped to a Java method, no need to do anything.\n+        if (oper.getMethod() != null)\n             return;\n \n-        Method [] methods = jc.getDeclaredMethods();\n+        // Find the method.  We do this once for each Operation.\n+        Method [] methods = implClass.getDeclaredMethods();\n+        for (int i = 0; i < methods.length; i++) {\n+            Method method = methods[i];\n+            if (method.getName().equals(oper.getName())) {\n+                // Check params\n+                Class [] paramTypes = method.getParameterTypes();\n+                if (paramTypes.length != oper.getNumParams())\n+                    continue;\n+\n+                int j;\n+                for (j = 0; j < paramTypes.length; j++) {\n+                    Class type = paramTypes[j];\n+                    ParameterDesc param = oper.getParameter(j);\n+                    // See if they match\n+                    Class paramClass = tm.getClassForQName(\n+                            param.getTypeQName());\n+\n+                    // This is a match if the paramClass is somehow\n+                    // convertable to the \"real\" parameter type.\n+                    if (JavaUtils.isConvertable(paramClass, type)) {\n+                        param.setJavaType(type);\n+                        continue;\n+                    }\n+                    break;\n+                }\n+\n+                if (j != paramTypes.length) {\n+                    // failed.\n+                    continue;\n+                }\n+\n+                // At some point we might want to check here to see if this\n+                // Method is already associated with another Operation, but\n+                // this doesn't seem critital.\n+\n+                oper.setMethod(method);\n+                method2OperationMap.put(method, oper);\n+                return;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Fill in a service description by introspecting the implementation\n+     * class.\n+     */\n+    public void loadServiceDescByIntrospection()\n+    {\n+        Method [] methods = implClass.getDeclaredMethods();\n \n         for (int i = 0; i < methods.length; i++) {\n-            String methodName = methods[i].getName();\n+            getSyncedOperationsForName(methods[i].getName());\n+        }\n \n-            // Skip it if it's not allowed\n-            // FIXME : This should, if allowedMethods is null, search up the\n-            //         inheritance/interface tree until we get to stop\n-            //         classes?\n-            if ((allowedMethods != null) &&\n-                !allowedMethods.contains(methodName))\n-                continue;\n+        // Setting this to null means there is nothing more to do, and it\n+        // avoids future string compares.\n+        completedNames = null;\n+    }\n \n-            // Make an OperationDesc for each method\n-            Method method = methods[i];\n-            OperationDesc operation = new OperationDesc();\n-            operation.setName(methodName);\n-            Class [] paramTypes = method.getParameterTypes();\n-            String [] paramNames =\n-                    JavaUtils.getParameterNamesFromDebugInfo(method);\n-            for (int k = 0; k < paramTypes.length; k++) {\n-                Class type = paramTypes[k];\n-                ParameterDesc paramDesc = new ParameterDesc();\n-                if (paramNames != null) {\n-                    paramDesc.setName(paramNames[k+1]);\n-                } else {\n-                    paramDesc.setName(\"in\" + k);\n-                }\n-                Class heldClass = JavaUtils.getHolderValueType(type);\n-                if (heldClass != null) {\n-                    paramDesc.setMode(ParameterDesc.INOUT);\n-                    paramDesc.setTypeQName(tm.getTypeQName(heldClass));\n-                } else {\n-                    paramDesc.setMode(ParameterDesc.IN);\n-                    paramDesc.setTypeQName(tm.getTypeQName(type));\n+    /**\n+     * Fill in a service description by introspecting the implementation\n+     * class.  This version takes the implementation class and the in-scope\n+     * TypeMapping.\n+     */\n+    public void loadServiceDescByIntrospection(Class cls, TypeMapping tm)\n+    {\n+        // Should we complain if the implClass changes???\n+        implClass = cls;\n+        this.tm = tm;\n+        loadServiceDescByIntrospection();\n+    }\n+\n+    /**\n+     * Makes sure we have completely synchronized OperationDescs with\n+     * the implementation class.\n+     */\n+    private void getSyncedOperationsForName(String methodName)\n+    {\n+        // If we have no implementation class, don't worry about it (we're\n+        // probably on the client)\n+        if (implClass == null)\n+            return;\n+\n+        // If we're done introspecting, or have completed this method, return\n+        if (completedNames == null || completedNames.contains(methodName))\n+            return;\n+\n+        // Skip it if it's not a sanctioned method name\n+        if ((allowedMethods != null) &&\n+            !allowedMethods.contains(methodName))\n+            return;\n+\n+        // OK, go find any current OperationDescs for this method name and\n+        // make sure they're synced with the actual class.\n+        if (name2OperationsMap != null) {\n+            ArrayList currentOverloads = \n+                    (ArrayList)name2OperationsMap.get(methodName);\n+            if (currentOverloads != null) {\n+                // For each one, sync it to the implementation class' methods\n+                for (Iterator i = currentOverloads.iterator(); i.hasNext();) {\n+                    OperationDesc oper = (OperationDesc) i.next();\n+                    if (oper.getMethod() == null) {\n+                        syncOperationToClass(oper);\n+                    }\n                 }\n-                operation.addParameter(paramDesc);\n             }\n-            addOperationDesc(operation);\n         }\n \n-        hasOperationData = true;\n+        // Now all OperationDescs from deployment data have been completely\n+        // filled in.  So we now make new OperationDescs for any method\n+        // overloads which were not covered above.\n+        Method [] methods = implClass.getDeclaredMethods();\n+\n+        for (int i = 0; i < methods.length; i++) {\n+            Method method = methods[i];\n+            if (method.getName().equals(methodName))\n+                createOperationForMethod(method);\n+        }\n+\n+        // Note that we never have to look at this method name again.\n+        completedNames.add(methodName);\n+    }\n+\n+    /**\n+     * Make an OperationDesc from a Java method.\n+     *\n+     * In the absence of deployment metadata, this code will introspect a\n+     * Method and create an appropriate OperationDesc, using parameter names\n+     * from the bytecode debugging info if available, or \"in0\", \"in1\", etc.\n+     * if not.\n+     */\n+    private void createOperationForMethod(Method method) {\n+        // If we've already got it, never mind\n+        if (method2OperationMap.get(method) != null) {\n+            return;\n+        }\n+\n+        // Make an OperationDesc\n+        OperationDesc operation = new OperationDesc();\n+        operation.setName(method.getName());\n+        operation.setMethod(method);\n+        Class [] paramTypes = method.getParameterTypes();\n+        String [] paramNames =\n+                JavaUtils.getParameterNamesFromDebugInfo(method);\n+\n+        for (int k = 0; k < paramTypes.length; k++) {\n+            Class type = paramTypes[k];\n+            ParameterDesc paramDesc = new ParameterDesc();\n+            // If we have a name for this param, use it, otherwise call\n+            // it \"in*\"\n+            if (paramNames != null) {\n+                paramDesc.setName(paramNames[k+1]);\n+            } else {\n+                paramDesc.setName(\"in\" + k);\n+            }\n+            paramDesc.setJavaType(type);\n+\n+            // If it's a Holder, mark it INOUT and set the type to the\n+            // held type.  Otherwise it's IN with its own type.\n+\n+            Class heldClass = JavaUtils.getHolderValueType(type);\n+            if (heldClass != null) {\n+                paramDesc.setMode(ParameterDesc.INOUT);\n+                paramDesc.setTypeQName(tm.getTypeQName(heldClass));\n+            } else {\n+                paramDesc.setMode(ParameterDesc.IN);\n+                paramDesc.setTypeQName(tm.getTypeQName(type));\n+            }\n+            operation.addParameter(paramDesc);\n+        }\n+\n+        operation.setReturnClass(method.getReturnType());\n+        operation.setReturnType(tm.getTypeQName(method.getReturnType()));\n+\n+        addOperationDesc(operation);\n+        method2OperationMap.put(method, operation);\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "4de4da4d983f4b3f24b30304b6e27a61e3800583",
                "status": "modified"
            },
            {
                "additions": 78,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "changes": 157,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 79,
                "filename": "src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "patch": "@@ -10,23 +10,23 @@\n  * are met:\n  *\n  * 1. Redistributions of source code must retain the above copyright\n- *    notice, this list of conditions and the following disclaimer. \n+ *    notice, this list of conditions and the following disclaimer.\n  *\n  * 2. Redistributions in binary form must reproduce the above copyright\n  *    notice, this list of conditions and the following disclaimer in\n  *    the documentation and/or other materials provided with the\n  *    distribution.\n  *\n  * 3. The end-user documentation included with the redistribution,\n- *    if any, must include the following acknowledgment:  \n+ *    if any, must include the following acknowledgment:\n  *       \"This product includes software developed by the\n  *        Apache Software Foundation (http://www.apache.org/).\"\n  *    Alternately, this acknowledgment may appear in the software itself,\n  *    if and wherever such third-party acknowledgments normally appear.\n  *\n  * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n  *    not be used to endorse or promote products derived from this\n- *    software without prior written permission. For written \n+ *    software without prior written permission. For written\n  *    permission, please contact apache@apache.org.\n  *\n  * 5. Products derived from this software may not be called \"Apache\",\n@@ -88,29 +88,29 @@\n \n /**\n  * @author Rich Scheuerle (scheu@us.ibm.com)\n- * \n+ *\n  * This is the implementation of the axis Default TypeMapping (which extends\n  * the JAX-RPC TypeMapping interface) for SOAP 1.1.  If you want the JAX-RPC\n  * SOAP 1.2 Type Mapping the use DefaultJAXRPCTypeMapping.\n- * \n+ *\n  * A TypeMapping is obtained from the singleton TypeMappingRegistry using\n  * the namespace of the webservice.  The TypeMapping contains the tuples\n  * {Java type, SerializerFactory, DeserializerFactory, Type QName)\n  *\n- * So if you have a Web Service with the namespace \"XYZ\", you call \n+ * So if you have a Web Service with the namespace \"XYZ\", you call\n  * the TypeMappingRegistry.getTypeMapping(\"XYZ\").\n  *\n  * The wsdl in your web service will use a number of types.  The tuple\n  * information for each of these will be accessed via the TypeMapping.\n  *\n- * Because every web service uses the soap, schema, wsdl primitives, we could \n+ * Because every web service uses the soap, schema, wsdl primitives, we could\n  * pre-populate the TypeMapping with these standard tuples.  Instead, if requested\n  * namespace/class matches is not found in the TypeMapping but matches one these\n  * known primitives, the request is delegated to this Default TypeMapping.\n- * \n+ *\n  */\n-public class DefaultTypeMappingImpl extends TypeMappingImpl { \n-    \n+public class DefaultTypeMappingImpl extends TypeMappingImpl {\n+\n     private static DefaultTypeMappingImpl tm = null;\n     /**\n      * Construct TypeMapping\n@@ -128,45 +128,45 @@ protected DefaultTypeMappingImpl() {\n \n         // Notes:\n         // 1) The registration statements are order dependent.  The last one\n-        //    wins.  So if two javaTypes of String are registered, the \n+        //    wins.  So if two javaTypes of String are registered, the\n         //    ser factory for the last one registered will be chosen.  Likewise\n-        //    if two javaTypes for XSD_DATE are registered, the deserializer \n+        //    if two javaTypes for XSD_DATE are registered, the deserializer\n         //    factory for the last one registered will be chosen.\n         //    Corollary:  Please be very careful with the order.  The\n         //                runtime, Java2WSDL and WSDL2Java emitters all\n         //                use this code to get type mapping information.\n-        // 2) Even if the SOAP 1.1 format is used over the wire, an \n+        // 2) Even if the SOAP 1.1 format is used over the wire, an\n         //    attempt is made to receive SOAP 1.2 format from the wire.\n-        //    This is the reason why the soap encoded primitives are \n+        //    This is the reason why the soap encoded primitives are\n         //    registered without serializers.\n \n-        // SOAP Encoded strings are treated as primitives. \n+        // SOAP Encoded strings are treated as primitives.\n         // Everything else is not.\n         // Note that only deserializing is supported since we are flowing\n         // SOAP 1.1 over the wire.\n-        myRegister(Constants.SOAP_STRING,     java.lang.String.class,   \n-                   null, null, true,  true); \n-        myRegister(Constants.SOAP_BOOLEAN,    java.lang.Boolean.class, \n+        myRegister(Constants.SOAP_STRING,     java.lang.String.class,\n+                   null, null, true,  true);\n+        myRegister(Constants.SOAP_BOOLEAN,    java.lang.Boolean.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_DOUBLE,     java.lang.Double.class,  \n+        myRegister(Constants.SOAP_DOUBLE,     java.lang.Double.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_FLOAT,      java.lang.Float.class,  \n+        myRegister(Constants.SOAP_FLOAT,      java.lang.Float.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_INT,        java.lang.Integer.class,   \n+        myRegister(Constants.SOAP_INT,        java.lang.Integer.class,\n                    null, null, false, true);\n         myRegister(Constants.SOAP_INTEGER,    java.math.BigInteger.class,\n                    null, null, false, true);\n         myRegister(Constants.SOAP_DECIMAL,    java.math.BigDecimal.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_LONG,       java.lang.Long.class,     \n+        myRegister(Constants.SOAP_LONG,       java.lang.Long.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_SHORT,      java.lang.Short.class,   \n+        myRegister(Constants.SOAP_SHORT,      java.lang.Short.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_BYTE,       java.lang.Byte.class,     \n+        myRegister(Constants.SOAP_BYTE,       java.lang.Byte.class,\n                    null, null, false, true);\n \n         // Hex binary data needs to use the hex binary serializer/deserializer\n-        myRegister(Constants.XSD_HEXBIN,     Hex.class,   \n+        myRegister(Constants.XSD_HEXBIN,     Hex.class,\n                    new HexSerializerFactory(\n                         Hex.class, Constants.XSD_HEXBIN),\n                    new HexDeserializerFactory(\n@@ -182,62 +182,62 @@ protected DefaultTypeMappingImpl() {\n         // Byte[] -ser-> array of Byte\n         // XSD_BASE64 -deser-> byte[]\n         // SOAP_BASE64 -deser->byte[]\n-        myRegister(Constants.SOAP_BASE64,     byte[].class, \n-                   new Base64SerializerFactory(byte[].class,\n+        myRegister(Constants.SOAP_BASE64,     Byte[].class,\n+                   new Base64SerializerFactory(Byte[].class,\n                                                Constants.SOAP_BASE64 ),\n-                   new Base64DeserializerFactory(byte[].class,\n+                   new Base64DeserializerFactory(Byte[].class,\n                                                  Constants.SOAP_BASE64),\n-                   true, true);      \n-        myRegister(Constants.SOAP_ARRAY,     java.lang.Byte[].class,       \n-                   new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(),true);\n-        myRegister(Constants.XSD_BASE64,     byte[].class,                                   \n+                   true);\n+//        myRegister(Constants.SOAP_ARRAY,     java.lang.Byte[].class,\n+//                   new ArraySerializerFactory(),\n+//                   new ArrayDeserializerFactory(),true);\n+        myRegister(Constants.XSD_BASE64,     byte[].class,\n                    new Base64SerializerFactory(byte[].class,\n                                                Constants.XSD_BASE64 ),\n                    new Base64DeserializerFactory(byte[].class,\n                                            Constants.XSD_BASE64),true);\n \n         // If SOAP 1.1 over the wire, map wrapper classes to XSD primitives.\n-        myRegister(Constants.XSD_STRING,     java.lang.String.class, \n-                   null, null, true); \n-        myRegister(Constants.XSD_BOOLEAN,    java.lang.Boolean.class, \n+        myRegister(Constants.XSD_STRING,     java.lang.String.class,\n+                   null, null, true);\n+        myRegister(Constants.XSD_BOOLEAN,    java.lang.Boolean.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_DOUBLE,     java.lang.Double.class,  \n+        myRegister(Constants.XSD_DOUBLE,     java.lang.Double.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_FLOAT,      java.lang.Float.class,  \n+        myRegister(Constants.XSD_FLOAT,      java.lang.Float.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_INT,        java.lang.Integer.class, \n+        myRegister(Constants.XSD_INT,        java.lang.Integer.class,\n                    null, null, true);\n         myRegister(Constants.XSD_INTEGER,    java.math.BigInteger.class,\n                    null, null, true);\n         myRegister(Constants.XSD_DECIMAL,    java.math.BigDecimal.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_LONG,       java.lang.Long.class,     \n+        myRegister(Constants.XSD_LONG,       java.lang.Long.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_SHORT,      java.lang.Short.class, \n+        myRegister(Constants.XSD_SHORT,      java.lang.Short.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_BYTE,       java.lang.Byte.class,  \n+        myRegister(Constants.XSD_BYTE,       java.lang.Byte.class,\n                    null, null, true);\n \n         // The XSD Primitives are mapped to java primitives.\n-        myRegister(Constants.XSD_BOOLEAN,    boolean.class,        \n+        myRegister(Constants.XSD_BOOLEAN,    boolean.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_DOUBLE,     double.class,         \n+        myRegister(Constants.XSD_DOUBLE,     double.class,\n                    null, null,true);\n         myRegister(Constants.XSD_FLOAT,      float.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_INT,        int.class,  \n+        myRegister(Constants.XSD_INT,        int.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_LONG,       long.class, \n+        myRegister(Constants.XSD_LONG,       long.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_SHORT,      short.class, \n+        myRegister(Constants.XSD_SHORT,      short.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_BYTE,       byte.class, \n+        myRegister(Constants.XSD_BYTE,       byte.class,\n                    null, null,true);\n \n \n         // Map QNAME to the jax rpc QName class\n-        myRegister(Constants.XSD_QNAME,      \n+        myRegister(Constants.XSD_QNAME,\n               javax.xml.rpc.namespace.QName.class,\n               new BeanSerializerFactory(javax.xml.rpc.namespace.QName.class,\n                                         Constants.XSD_QNAME),\n@@ -246,21 +246,21 @@ protected DefaultTypeMappingImpl() {\n                    true);\n \n         // The closest match for anytype is Object\n-        myRegister(Constants.XSD_ANYTYPE,    java.lang.Object.class,  \n+        myRegister(Constants.XSD_ANYTYPE,    java.lang.Object.class,\n                    null, null, false);\n \n-        // The xsd primitive for date has changed through the various \n+        // The xsd primitive for date has changed through the various\n         // namespace versions.\n-        // XSD_DATE is the current one, which is why it is \n+        // XSD_DATE is the current one, which is why it is\n         // registered after the other two\n-        myRegister(Constants.XSD_DATE2,      java.util.Date.class,                           \n-                   new DateSerializerFactory(java.util.Date.class, \n+        myRegister(Constants.XSD_DATE2,      java.util.Date.class,\n+                   new DateSerializerFactory(java.util.Date.class,\n                                              Constants.XSD_DATE2),\n                    new DateDeserializerFactory(java.util.Date.class,\n                                                Constants.XSD_DATE2),\n                    true);\n-        myRegister(Constants.XSD_DATE3,      java.util.Date.class,                           \n-                   new DateSerializerFactory(java.util.Date.class, \n+        myRegister(Constants.XSD_DATE3,      java.util.Date.class,\n+                   new DateSerializerFactory(java.util.Date.class,\n                                              Constants.XSD_DATE3),\n                    new DateDeserializerFactory(java.util.Date.class,\n                                                Constants.XSD_DATE3),\n@@ -280,48 +280,47 @@ protected DefaultTypeMappingImpl() {\n \n         // Serialize all extensions of Map to SOAP_MAP\n         // The SOAP_MAP will be deserialized into a HashMap by default.\n-        myRegister(Constants.SOAP_MAP,       java.util.HashMap.class,    \n+        myRegister(Constants.SOAP_MAP,       java.util.HashMap.class,\n                    new MapSerializerFactory(java.util.Map.class,\n                                             Constants.SOAP_MAP),\n                    new MapDeserializerFactory(java.util.HashMap.class,\n                                               Constants.SOAP_MAP),\n                    false);\n-        myRegister(Constants.SOAP_MAP,       java.util.Map.class,    \n+        myRegister(Constants.SOAP_MAP,       java.util.Map.class,\n                    new MapSerializerFactory(java.util.Map.class,\n                                             Constants.SOAP_MAP),\n-                   new MapDeserializerFactory(java.util.HashMap.class,\n-                                              Constants.SOAP_MAP),\n+                   null,  // Make sure not to override the deser mapping\n                    false);\n \n         // Use the Element Serializeration for elements\n-        myRegister(Constants.SOAP_ELEMENT,   org.w3c.dom.Element.class,    \n+        myRegister(Constants.SOAP_ELEMENT,   org.w3c.dom.Element.class,\n                    new ElementSerializerFactory(),\n                    new ElementDeserializerFactory(), false);\n-        myRegister(Constants.SOAP_VECTOR,    java.util.Vector.class,                                \n+        myRegister(Constants.SOAP_VECTOR,    java.util.Vector.class,\n                    new VectorSerializerFactory(java.util.Vector.class,\n-                                               Constants.SOAP_VECTOR), \n+                                               Constants.SOAP_VECTOR),\n                    new VectorDeserializerFactory(java.util.Vector.class,\n-                                                 Constants.SOAP_VECTOR), \n+                                                 Constants.SOAP_VECTOR),\n                    false);\n \n         // All array objects automatically get associated with the SOAP_ARRAY.\n-        // There is no way to do this with a hash table, \n+        // There is no way to do this with a hash table,\n         // so it is done directly in getTypeQName.\n         // Internally the runtime uses ArrayList objects to hold arrays...\n-        // which is the reason that ArrayList is associated with SOAP_ARRAY.  \n+        // which is the reason that ArrayList is associated with SOAP_ARRAY.\n         // In addition, handle all objects that implement the List interface\n         // as a SOAP_ARRAY\n-        myRegister(Constants.SOAP_ARRAY,     java.util.List.class,               \n+        myRegister(Constants.SOAP_ARRAY,     java.util.List.class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n-        myRegister(Constants.SOAP_ARRAY,     java.util.ArrayList.class,               \n+        myRegister(Constants.SOAP_ARRAY,     java.util.ArrayList.class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n-        myRegister(Constants.SOAP_ARRAY,     Object[].class,               \n+        myRegister(Constants.SOAP_ARRAY,     Object[].class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n     }\n \n@@ -334,14 +333,14 @@ protected DefaultTypeMappingImpl() {\n      * @param df is the deser factory (if null, the simple factory is used)\n      * @param primitive indicates whether serializers can be shared\n      * @param onlyDeserFactory indicates if only deserialization is desired.\n-     */   \n+     */\n     protected void myRegister(QName xmlType, Class javaType,\n                               SerializerFactory sf, DeserializerFactory df,\n                               boolean primitive) {\n         myRegister(xmlType, javaType, sf, df, primitive, false);\n     }\n     protected void myRegister(QName xmlType, Class javaType,\n-                              SerializerFactory sf, DeserializerFactory df, \n+                              SerializerFactory sf, DeserializerFactory df,\n                               boolean primitive, boolean onlyDeserFactory) {\n \n         // If factories are not specified, use the Simple ser/deser factories.\n@@ -362,7 +361,7 @@ protected void myRegister(QName xmlType, Class javaType,\n         if (onlyDeserFactory) {\n             sf = null;\n         }\n-        \n+\n         // Register all known flavors of the namespace.\n         try {\n             if (xmlType.getNamespaceURI().equals(\n@@ -381,7 +380,7 @@ else if (xmlType.getNamespaceURI().equals(\n                     super.register(javaType, qName, sf, df);\n                 }\n             }\n-            // Register with the specified xmlType. \n+            // Register with the specified xmlType.\n             // This is the prefered mapping and the last registed one wins\n             super.register(javaType, xmlType, sf, df);\n         } catch (Exception e) {}\n@@ -407,10 +406,10 @@ public QName getTypeQName(Class javaType) {\n \n     // Don't allow anyone to muck with the default type mapping because\n     // it is a singleton used for the whole system.\n-    public void register(Class javaType, QName xmlType, \n+    public void register(Class javaType, QName xmlType,\n                          javax.xml.rpc.encoding.SerializerFactory sf,\n-                         javax.xml.rpc.encoding.DeserializerFactory dsf) \n-        throws JAXRPCException {        \n+                         javax.xml.rpc.encoding.DeserializerFactory dsf)\n+        throws JAXRPCException {\n \n         throw new JAXRPCException();\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "sha": "ec67e078701c248c7ca8400075ab302502f3a5e5",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/TypeMappingImpl.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/TypeMappingImpl.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 2,
                "filename": "src/org/apache/axis/encoding/TypeMappingImpl.java",
                "patch": "@@ -243,8 +243,12 @@ public void register(Class javaType, QName xmlType,\n         }\n         Pair pair = new Pair(javaType, xmlType);\n \n-        qName2Pair.put(xmlType, pair);\n-        class2Pair.put(javaType, pair);   \n+        // Only register the appropriate mappings.\n+        if ((dsf != null) || (qName2Pair.get(xmlType) == null))\n+            qName2Pair.put(xmlType, pair);\n+        if ((sf != null) || (class2Pair.get(javaType) == null))\n+            class2Pair.put(javaType, pair);   \n+        \n         pair2SF.put(pair, sf);\n         pair2DF.put(pair, dsf);\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/TypeMappingImpl.java",
                "sha": "70f7d82e9196dbbc7a99033645f771067c5037e3",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 17,
                "filename": "src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "patch": "@@ -102,23 +102,7 @@ public SimpleDeserializerFactory(Class javaType, QName xmlType) {\n                     javaType.getDeclaredConstructor(new Class [] {String.class});\n             }\n             else {\n-                Class wrapper = null;\n-                if (javaType == int.class)\n-                    wrapper = java.lang.Integer.class;\n-                else if (javaType == short.class)\n-                    wrapper = java.lang.Short.class;\n-                else if (javaType == boolean.class)\n-                    wrapper = java.lang.Boolean.class;\n-                else if (javaType == byte.class)\n-                    wrapper = java.lang.Byte.class;\n-                else if (javaType == long.class)\n-                    wrapper = java.lang.Long.class;\n-                else if (javaType == double.class)\n-                    wrapper = java.lang.Double.class;\n-                else if (javaType == float.class)\n-                    wrapper = java.lang.Float.class;\n-                else if (javaType == char.class)\n-                    wrapper = java.lang.Character.class;\n+                Class wrapper = JavaUtils.getWrapperClass(javaType);\n                 if (wrapper != null)\n                     constructor = \n                         wrapper.getDeclaredConstructor(new Class [] {String.class});",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "sha": "a49aaa47e25afd5fd743ff4e7aa2e944bfd6cf3c",
                "status": "modified"
            },
            {
                "additions": 27,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/message/RPCElement.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCElement.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 27,
                "filename": "src/org/apache/axis/message/RPCElement.java",
                "patch": "@@ -66,6 +66,7 @@\n import org.apache.axis.handlers.soap.SOAPService;\n import org.apache.axis.utils.cache.ClassCache;\n import org.apache.axis.utils.cache.JavaClass;\n+import org.apache.axis.utils.JavaUtils;\n import org.apache.axis.wsdl.toJava.Utils;\n import org.xml.sax.Attributes;\n import org.xml.sax.SAXException;\n@@ -158,36 +159,34 @@ public void deserialize() throws SAXException\n         if (service != null) {\n             ServiceDesc serviceDesc = service.getServiceDescription();\n \n-            // If we don't have a service description, create one\n-            // via introspection and cache it in the SOAPService.\n-            String clsName = (String)service.getOption(\"className\");\n-\n-            if (clsName != null) {\n-                ClassLoader cl       = msgContext.getClassLoader();\n-                ClassCache cache     = msgContext.getAxisEngine().\n-                        getClassCache();\n-                JavaClass       jc   = null;\n-                try {\n-                    jc = cache.lookup(clsName, cl);\n-                } catch (ClassNotFoundException e) {\n-                    throw new SAXException(e);\n+            if (serviceDesc.getImplClass() == null) {\n+                String clsName = (String)service.getOption(\"className\");\n+\n+                if (clsName != null) {\n+                    ClassLoader cl       = msgContext.getClassLoader();\n+                    ClassCache cache     = msgContext.getAxisEngine().\n+                            getClassCache();\n+                    JavaClass       jc   = null;\n+                    try {\n+                        jc = cache.lookup(clsName, cl);\n+                    } catch (ClassNotFoundException e) {\n+                        throw new SAXException(e);\n+                    }\n+                    TypeMapping tm = (TypeMapping)msgContext.\n+                            getTypeMappingRegistry().\n+                            getTypeMapping(msgContext.getEncodingStyle());\n+                    serviceDesc.setTypeMapping(tm);\n+                    serviceDesc.setImplClass(jc.getJavaClass());\n                 }\n-                TypeMapping tm = (TypeMapping)msgContext.\n-                        getTypeMappingRegistry().\n-                        getTypeMapping(msgContext.getEncodingStyle());\n-                serviceDesc.loadServiceDescByIntrospection(jc.getJavaClass(),\n-                                                           tm);\n             }\n \n-            if (serviceDesc != null) {\n-                // If we've got a service description now, we want to use\n-                // the matching operations in there.\n-                operations = serviceDesc.getOperationsByName(name);\n+            // If we've got a service description now, we want to use\n+            // the matching operations in there.\n+            operations = serviceDesc.getOperationsByName(name);\n \n-                if (operations == null) {\n-                    String lc = Utils.xmlNameToJava(name);\n-                    operations = serviceDesc.getOperationsByName(lc);\n-                }\n+            if (operations == null) {\n+                String lc = Utils.xmlNameToJava(name);\n+                operations = serviceDesc.getOperationsByName(lc);\n             }\n         }\n \n@@ -225,7 +224,8 @@ public void deserialize() throws SAXException\n \n                         publishToHandler((org.xml.sax.ContentHandler) context);\n \n-                        // Success!!\n+                        // Success!!  This is the right one...\n+                        msgContext.setOperation(myOperation);\n                         return;\n                     } catch (SAXException e) {\n                         // If there was a problem, try the next one.",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/message/RPCElement.java",
                "sha": "d1e817be5b9dd550b6c68d1775b0b76db9836847",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/message/RPCHandler.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCHandler.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 3,
                "filename": "src/org/apache/axis/message/RPCHandler.java",
                "patch": "@@ -193,11 +193,18 @@ public SOAPHandler onStartChild(String namespace,\n \n                 if (type == null) {\n                     type = paramDesc.getTypeQName();\n+                } else if (paramDesc.getJavaType() != null) {\n+                    // If we have an xsi:type, make sure it makes sense\n+                    // with the current paramDesc type\n+                    Class xsiClass = \n+                            context.getTypeMapping().getClassForQName(type);\n+                    if (!JavaUtils.isConvertable(xsiClass,\n+                                                 paramDesc.getJavaType())) {\n+                        throw new SAXException(\"Bad types (\" +\n+                            xsiClass + \" -> \" + paramDesc.getJavaType() + \")\"); // FIXME!\n+                    }\n                 }\n             }\n-\n-            // FIXME : We should check here to make sure any specified\n-            // xsi:type jibes with the expected type in the ParamDesc!!\n         }\n \n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/message/RPCHandler.java",
                "sha": "1f95e0238482f9076de12620adabac631ad3b73e",
                "status": "modified"
            },
            {
                "additions": 95,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/providers/java/RPCProvider.java",
                "changes": 286,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/RPCProvider.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 191,
                "filename": "src/org/apache/axis/providers/java/RPCProvider.java",
                "patch": "@@ -73,6 +73,7 @@\n import org.apache.commons.logging.LogFactory;\n \n import javax.xml.rpc.namespace.QName;\n+import javax.xml.rpc.holders.Holder;\n import java.lang.reflect.Method;\n import java.lang.reflect.InvocationTargetException;\n import java.util.StringTokenizer;\n@@ -121,6 +122,11 @@ public void processMessage (MessageContext msgContext,\n         for ( int bNum = 0 ; bNum < bodies.size() ; bNum++ ) {\n             RPCElement   body;\n \n+            // If this is a regular old SOAPBodyElement, and it's a root,\n+            // we're probably a non-wrapped doc/lit service.  In this case,\n+            // we deserialize the element, and create an RPCElement \"wrapper\"\n+            // around it which points to the correct method.\n+            // FIXME : There should be a cleaner way to do this...\n             if (!(bodies.get(bNum) instanceof RPCElement)) {\n                 SOAPBodyElement bodyEl = (SOAPBodyElement)bodies.get(bNum);\n                 if (bodyEl.isRoot() && operation != null) {\n@@ -136,20 +142,48 @@ public void processMessage (MessageContext msgContext,\n                 body = (RPCElement) bodies.get( bNum );\n             }\n \n-            String       mName      = body.getMethodName();\n-            Vector       args       = body.getParams();\n-            Object[]     argValues  =  null ;\n+            String methodName = body.getMethodName();\n+            Vector args = body.getParams();\n+            int numArgs = args.size();\n \n+            // This may have changed, so get it again...\n+            // FIXME (there should be a cleaner way to do this)\n+            operation = msgContext.getOperation();\n \n+            if (operation == null) {\n+                QName qname = new QName(body.getNamespaceURI(),\n+                                        body.getName());\n+                operation = serviceDesc.getOperationByElementQName(qname);\n+            }\n+\n+            // Create the array we'll use to hold the actual parameter\n+            // values.  We know how big to make it from the metadata.\n+            Object[]     argValues  =  new Object [operation.getNumParams()];\n+\n+            // A place to keep track of the out params (INOUTs and OUTs)\n+            ArrayList outs = new ArrayList();\n+\n+            // Put the values contained in the RPCParams into an array\n+            // suitable for passing to java.lang.reflect.Method.invoke()\n+            // Make sure we respect parameter ordering if we know about it\n+            // from metadata, and handle whatever conversions are necessary\n+            // (values -> Holders, etc)\n             if ( args != null && args.size() > 0 ) {\n-                argValues = new Object[ args.size()];\n-                for ( int i = 0 ; i < args.size() ; i++ ) {\n+                for ( int i = 0 ; i < numArgs ; i++ ) {\n                     RPCParam rpcParam = (RPCParam)args.get(i);\n+                    Object value = rpcParam.getValue();\n                     ParameterDesc paramDesc = rpcParam.getParamDesc();\n+                    if (paramDesc != null && paramDesc.getJavaType() != null) {\n+                        value = JavaUtils.convert(value,\n+                                                  paramDesc.getJavaType());\n+                        rpcParam.setValue(value);\n+                        if (paramDesc.getMode() == ParameterDesc.INOUT)\n+                            outs.add(rpcParam);\n+                    }\n                     if (paramDesc == null || paramDesc.getOrder() == -1) {\n-                        argValues[i]  = rpcParam.getValue() ;\n+                        argValues[i]  = value;\n                     } else {\n-                        argValues[paramDesc.getOrder()] = rpcParam.getValue();\n+                        argValues[paramDesc.getOrder()] = value;\n                     }\n \n                     if (log.isDebugEnabled()) {\n@@ -160,185 +194,69 @@ public void processMessage (MessageContext msgContext,\n             }\n \n             // Check if we can find a Method by this name\n-            checkMethodName(msgContext, allowedMethods, mName);\n-\n-            // Get the actual method to invoke.\n-            int\tnumberOfBodyArgs = args.size();\n-            Method[] methods = getMethod(msgContext, jc, mName);\n-\n-            // If the method wasn't found, maybe it needs some Java mangling (ie., it's a Java\n-            // keyword or it's capitalized and the java mapping requires lowercase).\n-            if (methods == null) {\n-                mName = JavaUtils.xmlNameToJava(mName);\n-                methods = getMethod(msgContext, jc, mName);\n-            }\n-\n-            if ( methods == null )\n-                throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"noMethod00\", mName, msgContext.getTargetService()),\n-                        null, null );\n-\n-            Object objRes = null;\n-            Class[] params = null;\n-            Exception ex = null;\n-\n-            // There might be more than one method with this name, try them all.\n-            int index = 0;\n-            for (index = 0; index < methods.length; index++) {\n-                Method method = methods[index];\n-                ex = null;\n-                params = method.getParameterTypes();\n-\n-                // Don't bother with this one if it has FEWER params\n-                if (argValues != null) {\n-                    if (params.length < argValues.length)\n-                        continue;\n-                }\n-\n-                // The number of method parameters must match the\n-                // arguments taking into consideration output parameters.\n-                Object[] newArgValues = new Object[params.length];\n-                int old = 0;\n-                boolean problem = false;\n-                for (int n = 0; n < newArgValues.length; n++) {\n-                    Class heldType = JavaUtils.getHolderValueType(params[n]);\n-                    if (argValues != null && old < argValues.length) {\n-                        newArgValues[n] = argValues[old++];\n-                    } else if (heldType == null) {\n-                        // The parameters that don't match the argValues must\n-                        // be Holders.  Indicate problem occurred.\n-                        problem = true;\n+            // FIXME : Shouldn't this type of thing have already occurred?\n+            checkMethodName(msgContext, allowedMethods, methodName);\n+\n+            // Now create any out holders we need to pass in\n+            if (numArgs < argValues.length) {\n+                ArrayList outParams = operation.getOutParams();\n+                for (int i = 0; i < outParams.size(); i++) {\n+                    ParameterDesc param = (ParameterDesc)outParams.get(i);\n+                    Class holderClass = param.getJavaType();\n+                    if (Holder.class.isAssignableFrom(holderClass)) {\n+                        argValues[numArgs + i] = holderClass.newInstance();\n+                        // Store an RPCParam in the outs collection so we\n+                        // have an easy and consistent way to write these\n+                        // back to the client below\n+                        outs.add(new RPCParam(param.getQName(),\n+                                              argValues[numArgs + i]));\n                     } else {\n-                        newArgValues[n] = null;\n-                    }\n-                    // Create holders for each argument that is null that should be a holder\n-                    if (newArgValues[n] == null && heldType != null) {\n-                        newArgValues[n] = JavaUtils.convert(newArgValues[n], params[n]);\n-                    }\n-                }\n-                if (!problem) {\n-                    argValues = newArgValues;  // Use newArgValues array if no problems\n-                }\n-\n-                // Invoke the method and capture the returned object.\n-                // Note that if the method returns a primitive, invoke(...) automatically\n-                // wraps it in a java.lang class representing the primitive.\n-                try {\n-                    objRes = invokeMethod(msgContext, method, obj, argValues);\n-                    break;\n-                } catch (IllegalArgumentException e) {\n-                    // Hm - maybe we can help this with a conversion or two...\n-                    for (int i = 0; argValues != null && i < argValues.length &&\n-                      i < params.length; i++) {\n-                        Object thisArg = argValues[i];\n-                        if (!params[i].isAssignableFrom(thisArg.getClass())) {\n-                            // Attempt conversion for each non-assignable argument\n-                            Object newArg = JavaUtils.convert(thisArg, params[i]);\n-                            if (newArg != thisArg)\n-                                argValues[i] = newArg;\n-                        }\n-                    }\n-\n-                    // OK, now try again...\n-                    try {\n-                        objRes = invokeMethod(msgContext, method, obj, argValues);\n-                        break;\n-                    } catch (IllegalArgumentException exp) {\n-                        StringBuffer argbuf = new StringBuffer();\n-                        String sep= \"\";\n-                        for(int i = 0; argValues != null &&\n-                          i < argValues.length; ++i) {\n-                            argbuf.append(sep);\n-                            sep = \", \";\n-                            argbuf.append(argValues[i] == null ? \"null\" : argValues[i].getClass().getName());\n-                        }\n-                        String objName = obj == null ? \"null\" :\n-                          obj.getClass().getName();\n-                        String msg = JavaUtils.getMessage(\"triedArgs00\",\n-                                new String[] {\n-                                exp.getMessage(),\n-                                objName,\n-                                method.getName(),\n-                                argbuf.toString()});\n-                        ex = new IllegalArgumentException(msg);\n-                        continue;\n+                        // !!! Throw a fault here?\n                     }\n                 }\n             }\n-            // If we've gone through all methods with the given name and there's\n-            // an exception left over, throw that exception.\n-            if (ex != null) {\n-                throw ex;\n-            }\n-\n-            // If we've finished iterating through all the methods, throw an exception.\n-            if ( index == methods.length )\n-                throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"noMethod00\", mName, msgContext.getTargetService()),\n-                        null, null );\n \n-            if (log.isDebugEnabled())\n-                log.debug(JavaUtils.getMessage(\"result00\", \"\" + objRes));\n+            // OK!  Now we can invoke the method\n+            Object objRes = operation.getMethod().invoke(obj, argValues);\n \n             /* Now put the result in the result SOAPEnvelope */\n             /*************************************************/\n-            RPCElement resBody = new RPCElement(mName + \"Response\");\n+            RPCElement resBody = new RPCElement(methodName + \"Response\");\n             resBody.setPrefix( body.getPrefix() );\n             resBody.setNamespaceURI( body.getNamespaceURI() );\n             resBody.setEncodingStyle(msgContext.getEncodingStyle());\n \n-            if ( objRes != null ) {\n-                // In the old skeleton a param list was returned, which\n-                // contained the RPC params.  Preserve this for now.\n-                if (objRes instanceof ParamList) {\n-                    ParamList list = (ParamList)objRes;\n-                    for (int i = 0; i < list.size (); ++i) {\n-                        if (list.get (i) instanceof RPCParam) {\n-                            resBody.addParam ((RPCParam) list.get (i));\n-                        }\n-                        else {\n-                            resBody.addParam (new RPCParam (getParameterName(obj, methods[index],i, mName),\n-                                                            list.get (i)));\n-                        }\n-                    }\n-                }\n-                else {\n-                    QName returnQName = getReturnQName(serviceDesc, mName);\n-                    RPCParam param = new RPCParam(returnQName, objRes);\n-                    resBody.addParam(param);\n+            // Return first\n+            if ( operation.getMethod().getReturnType() != Void.TYPE ) {\n+                QName returnQName = operation.getReturnQName();\n+                if (returnQName == null) {\n+                    returnQName = new QName(\"\", methodName + \"Return\");\n                 }\n-            } else if (methods[index].getReturnType() != Void.TYPE) {\n-                QName returnQName = getReturnQName(serviceDesc, mName);\n                 RPCParam param = new RPCParam(returnQName, objRes);\n                 resBody.addParam(param);\n             }\n \n-            // The new skeleton (or no skeleton code) requires the runtime\n-            // to recognize holders and automatically pass back the outputs.\n-            for (int i=0; i < argValues.length; i++) {\n-                Class heldType = JavaUtils.getHolderValueType(params[i]);\n-                if (heldType != null) {\n-                    // Create an RPCParam by converting the Holder back into\n-                    // the held type.\n-                    resBody.addParam (new RPCParam (getParameterName(obj,\n-                                                                     methods[index],\n-                                                                     i,\n-                                                                     mName,\n-                                                                     args),\n-                                                    JavaUtils.convert(\n-                                                            argValues[i],\n-                                                            heldType)));\n+            // Then any other out params\n+            if (!outs.isEmpty()) {\n+                for (Iterator i = outs.iterator(); i.hasNext();) {\n+                    // We know this has a holder, so just unwrap the value\n+                    RPCParam param = (RPCParam) i.next();\n+                    Holder holder = (Holder)param.getValue();\n+                    param.setValue(JavaUtils.getHolderValue(holder));\n+                    resBody.addParam(param);\n                 }\n             }\n \n-            resEnv.addBodyElement( resBody );\n+            resEnv.addBodyElement(resBody);\n         }\n     }\n \n-    protected Method[] getMethod(MessageContext msgContext, JavaClass jc, String mName)\n+    protected Method[] getMethod(MessageContext msgContext,\n+                                 JavaClass jc,\n+                                 String methodName)\n         throws Exception\n     {\n-        return jc.getMethod(mName);\n+        return jc.getMethod(methodName);\n     }\n \n     protected Object invokeMethod(MessageContext msgContext,\n@@ -349,47 +267,51 @@ protected Object invokeMethod(MessageContext msgContext,\n         return (method.invoke(obj, argValues));\n     }\n \n-    protected void checkMethodName(MessageContext msgContext, String allowedMethods, String mName)\n+    protected void checkMethodName(MessageContext msgContext,\n+                                   String allowedMethods,\n+                                   String methodName)\n         throws Exception\n     {\n         String methodNameMatch = allowedMethods;\n \n         // allowedMethods may be a comma-delimited string of method names.\n-        // If so, look for the one matching mname.\n+        // If so, look for the one matching methodName.\n         if (allowedMethods != null && allowedMethods.indexOf(' ') != -1) {\n             StringTokenizer tok = new StringTokenizer(allowedMethods, \" \");\n             String nextMethodName = null;\n             while (tok.hasMoreElements()) {\n                 String token = tok.nextToken();\n-                if (token.equals(mName)) {\n+                if (token.equals(methodName)) {\n                     nextMethodName = token;\n                     break;\n                 }\n             }\n             // didn't find a matching one...\n             if (nextMethodName == null) {\n                 throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"namesDontMatch00\", mName, allowedMethods),\n+                        JavaUtils.getMessage(\"namesDontMatch00\", methodName,\n+                                             allowedMethods),\n                         null, null );  // should they??\n             }\n             methodNameMatch = nextMethodName;\n         }\n \n-        if ( methodNameMatch != null && !methodNameMatch.equals(mName) )\n+        if ( methodNameMatch != null && !methodNameMatch.equals(methodName) )\n             throw new AxisFault( \"AxisServer.error\",\n                     JavaUtils.getMessage(\"namesDontMatch01\",\n-                        new String[] {mName, methodNameMatch, allowedMethods}),\n+                        new String[] {methodName, methodNameMatch,\n+                                      allowedMethods}),\n                     null, null );  // should they??\n \n         if (log.isDebugEnabled()) {\n-            log.debug( \"mName: \" + mName );\n+            log.debug( \"methodName: \" + methodName );\n             log.debug( \"MethodNameMatch: \" + methodNameMatch );\n             log.debug( \"MethodName List: \" + allowedMethods );\n         }\n \n         ///////////////////////////////////////////////////////////////\n         // If allowedMethods (i.e. methodNameMatch) is null,\n-        //  then treat it as a wildcard automatically matching mName\n+        //  then treat it as a wildcard automatically matching methodName\n         ///////////////////////////////////////////////////////////////\n         return;\n     }\n@@ -402,8 +324,8 @@ protected void checkMethodName(MessageContext msgContext, String allowedMethods,\n     protected QName getParameterName(Object obj,\n                                       Method method,\n                                       int i,\n-                                      String mName) {\n-        return getParameterName(obj, method, i, mName, null);\n+                                      String methodName) {\n+        return getParameterName(obj, method, i, methodName, null);\n     }\n \n     /**\n@@ -416,7 +338,7 @@ protected QName getParameterName(Object obj,\n     protected QName getParameterName(Object obj,\n                                       Method method,\n                                       int i,\n-                                      String mName,\n+                                      String methodName,\n                                       Vector rpcParams) {\n         QName parmName = null;\n         // Emitter skeletons keep track of the parameter names\n@@ -427,28 +349,10 @@ protected QName getParameterName(Object obj,\n                 if (rpcParams != null && rpcParams.size() > i) {\n                     parmName = ((RPCParam)rpcParams.get(i)).getQName();\n                 } else {\n-                    parmName = new QName(\"\", mName + \"Result\" + i);\n+                    parmName = new QName(\"\", methodName + \"Result\" + i);\n                 }\n             }\n         }\n         return parmName;\n     }\n-\n-    protected QName getReturnQName(ServiceDesc service, String methodName)\n-    {\n-        QName ret = null;\n-\n-        if (service != null) {\n-            OperationDesc oper = service.getOperationDescByName(methodName);\n-            if (oper != null) {\n-                ret = oper.getReturnQName();\n-            }\n-        }\n-\n-        if (ret == null) {\n-            ret = new QName(\"\", methodName + \"Result\");\n-        }\n-\n-        return ret;\n-    }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/providers/java/RPCProvider.java",
                "sha": "92110a9b190c717c1c39f7aa93db409078ed28f5",
                "status": "modified"
            },
            {
                "additions": 109,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/utils/JavaUtils.java",
                "changes": 109,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/JavaUtils.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/JavaUtils.java",
                "patch": "@@ -92,6 +92,50 @@\n {\n     protected static Log log =\n         LogFactory.getLog(JavaUtils.class.getName());\n+    \n+    public static Class getWrapperClass(Class primitive)\n+    {\n+        if (primitive == int.class)\n+            return java.lang.Integer.class;\n+        else if (primitive == short.class)\n+            return java.lang.Short.class;\n+        else if (primitive == boolean.class)\n+            return java.lang.Boolean.class;\n+        else if (primitive == byte.class)\n+            return java.lang.Byte.class;\n+        else if (primitive == long.class)\n+            return java.lang.Long.class;\n+        else if (primitive == double.class)\n+            return java.lang.Double.class;\n+        else if (primitive == float.class)\n+            return java.lang.Float.class;\n+        else if (primitive == char.class)\n+            return java.lang.Character.class;\n+        \n+        return null;\n+    }\n+    \n+    public static Class getPrimitiveClass(Class wrapper)\n+    {\n+        if (wrapper == java.lang.Integer.class)\n+            return int.class;\n+        else if (wrapper == java.lang.Short.class)\n+            return short.class;\n+        else if (wrapper == java.lang.Boolean.class)\n+            return boolean.class;\n+        else if (wrapper == java.lang.Byte.class)\n+            return byte.class;\n+        else if (wrapper == java.lang.Long.class)\n+            return long.class;\n+        else if (wrapper == java.lang.Double.class)\n+            return double.class;\n+        else if (wrapper == java.lang.Float.class)\n+            return float.class;\n+        else if (wrapper == java.lang.Character.class)\n+            return char.class;\n+        \n+        return null;\n+    }\n \n     /**\n      * Cache of tt-bytecode BCClass objects which correspond to particular\n@@ -132,6 +176,10 @@ public static Object convert(Object arg, Class destClass)\n         if (destClass == null) {\n             return arg;\n         }\n+        \n+        if (arg != null && destClass.isAssignableFrom(arg.getClass())) {\n+            return arg;\n+        }\n \n         if (log.isDebugEnabled()) {\n             String clsName = \"null\";\n@@ -294,7 +342,68 @@ else if (List.class.isAssignableFrom(destClass)) {\n         return destValue;\n     }\n \n+    public static boolean isConvertable(Object obj, Class dest)\n+    {\n+        Class src = null;\n+        \n+        if (obj != null) {\n+            if (obj instanceof Class) {\n+                src = (Class)obj;\n+            } else {\n+                src = obj.getClass();\n+            }\n+        }\n+        \n+        if (dest == null)\n+            return false;\n+        \n+        if (src != null) {\n+            // If we're directly assignable, we're good.\n+            if (dest.isAssignableFrom(src))\n+                return true;\n+\n+            // If it's a wrapping conversion, we're good.\n+            if (getWrapperClass(src) == dest)\n+                return true;\n+            if (getWrapperClass(dest) == src)\n+                return true;\n+            \n+            // If it's List -> Array or vice versa, we're good.\n+            if ((List.class.isAssignableFrom(src) || src.isArray()) &&\n+                (List.class.isAssignableFrom(dest) || dest.isArray()))\n+                return true;\n+            \n+            if ((src == Hex.class && dest == byte[].class) ||\n+                (src == byte[].class && dest == Hex.class))\n+                return true;\n+            \n+        }\n+        \n+        Class destHeld = JavaUtils.getHolderValueType(dest);\n+        // Can always convert a null to an empty holder\n+        if (src == null)\n+            return (destHeld != null);\n+        \n+        if (destHeld != null) {\n+            if (destHeld.isAssignableFrom(src) || isConvertable(src, destHeld))\n+                return true;\n+        }\n+\n+//        // FIXME : This is a horrible hack put in here to deal with a problem\n+//        // with our default typemappings.\n+//        if (destHeld != null && (getPrimitiveClass(destHeld) == src))\n+//            return true;\n+\n+        // If it's holder -> held or held -> holder, we're good\n+        Class srcHeld = JavaUtils.getHolderValueType(src);\n+        if (srcHeld != null) {\n+            if (dest.isAssignableFrom(srcHeld) || isConvertable(srcHeld, dest))\n+                return true;\n+        }\n \n+        return false;\n+    }\n+    \n     /**\n      * These are java keywords as specified at the following URL (sorted alphabetically).\n      * http://java.sun.com/docs/books/jls/second_edition/html/lexical.doc.html#229308",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/utils/JavaUtils.java",
                "sha": "31c96094ff83329305eb2dd191595c7fe32c67bc",
                "status": "modified"
            },
            {
                "additions": 77,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "changes": 103,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 26,
                "filename": "src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "patch": "@@ -87,7 +87,9 @@\n     /**\n      * Constructor.\n      */\n-    protected JavaDeployWriter(Emitter emitter, Definition definition, SymbolTable symbolTable) {\n+    protected JavaDeployWriter(Emitter emitter, \n+                               Definition definition, \n+                               SymbolTable symbolTable) {\n         super(emitter,\n                 new QName(definition.getTargetNamespace(), \"deploy\"),\n                 \"\",\n@@ -119,7 +121,8 @@ protected void writeFileBody() throws IOException {\n     protected void writeDeployServices() throws IOException {\n         //deploy the ports on each service\n         Map serviceMap = definition.getServices();\n-        for (Iterator mapIterator = serviceMap.values().iterator(); mapIterator.hasNext();) {\n+        for (Iterator mapIterator = serviceMap.values().iterator(); \n+             mapIterator.hasNext();) {\n             Service myService = (Service) mapIterator.next();\n \n             pw.println();\n@@ -128,9 +131,12 @@ protected void writeDeployServices() throws IOException {\n                     + \" -->\");\n             pw.println();\n \n-            for (Iterator portIterator = myService.getPorts().values().iterator(); portIterator.hasNext();) {\n+            for (Iterator portIterator = myService.getPorts().values().iterator();\n+                 portIterator.hasNext();) {\n                 Port myPort = (Port) portIterator.next();\n-                BindingEntry bEntry =  symbolTable.getBindingEntry(myPort.getBinding().getQName());\n+                BindingEntry bEntry = \n+                        symbolTable.getBindingEntry(\n+                                myPort.getBinding().getQName());\n \n                 // If this isn't an SOAP binding, skip it\n                 if (bEntry.getBindingType() != BindingEntry.TYPE_SOAP) {\n@@ -177,7 +183,8 @@ protected void writeDeployTypes(boolean hasLiteral) throws IOException {\n             if (localPart.startsWith(SymbolTable.ANON_TOKEN)) {\n                 localPart = localPart.substring(1);\n             }\n-            QName qName = new QName(type.getQName().getNamespaceURI(), localPart);\n+            QName qName = new QName(type.getQName().getNamespaceURI(), \n+                                    localPart);\n \n             if (process) {\n                 pw.println(\"      <typeMapping\");\n@@ -276,30 +283,64 @@ protected void writeDeployBinding(Binding binding) throws IOException {\n             // interested in the return type for now.\n             Parameters params =\n                     symbolTable.getOperationParameters(operation, \"\", bEntry);\n-            if (params.returnType instanceof DefinedElement) {\n-                QName returnQName = params.returnType.getQName();\n-                pw.println(\"      <operation name=\\\"\" + operation.getName() +\n-                         \"\\\" returnQName=\\\"retNS:\" +\n-                         returnQName.getLocalPart() +\n-                         \"\\\" xmlns:retNS=\\\"\" +\n-                         returnQName.getNamespaceURI() +\n-                         \"\\\">\");\n-\n-                // map doc/lit elements to this operation\n-                Map parts = operation.getInput().getMessage().getParts();\n-                if (!parts.isEmpty()) {\n-                    Iterator i = parts.values().iterator();\n-                    Part p = (Part) i.next();\n-                    QName elementQName = p.getElementName();\n-                    String ns = elementQName.getNamespaceURI();\n-                    pw.println(\"        <elementMapping xmlns:ns=\\\"\" +\n-                            ns + \"\\\" element=\\\"ns:\" +\n-                            elementQName.getLocalPart() + \"\\\"/>\");\n+            String operName = JavaUtils.xmlNameToJava(operation.getName());\n+            if (params != null) {\n+                if (params.returnType instanceof DefinedElement) {\n+                    QName returnQName = params.returnType.getQName();\n+                    pw.println(\"      <operation name=\\\"\" + operName +\n+                             \"\\\" returnQName=\\\"retNS:\" +\n+                             returnQName.getLocalPart() +\n+                             \"\\\" xmlns:retNS=\\\"\" +\n+                             returnQName.getNamespaceURI() +\n+                             \"\\\">\");\n+\n+                    // map doc/lit elements to this operation\n+                    Map parts = operation.getInput().getMessage().getParts();\n+                    if (!parts.isEmpty()) {\n+                        Iterator i = parts.values().iterator();\n+                        Part p = (Part) i.next();\n+                        QName elementQName = p.getElementName();\n+                        String ns = elementQName.getNamespaceURI();\n+                        pw.println(\"        <elementMapping xmlns:ns=\\\"\" +\n+                                   ns + \"\\\" element=\\\"ns:\" +\n+                                   elementQName.getLocalPart() + \"\\\"/>\");\n+                    }\n+                } else {\n+                    pw.println(\"      <operation name=\\\"\" + \n+                               operName + \"\\\">\");\n                 }\n-\n+                \n+                Vector paramList = params.list;\n+                for (int i = 0; i < paramList.size(); i++) {\n+                    Parameter param = (Parameter) paramList.elementAt(i);\n+                    QName paramQName = param.getQName();\n+                    TypeEntry typeEntry = param.getType();\n+                    QName paramType;\n+                    if (typeEntry instanceof DefinedElement) {\n+                        Node node = symbolTable.getTypeEntry(typeEntry.getQName(), true).getNode();\n+                        paramType = Utils.getNodeTypeRefQName(node, \"type\");\n+                        if (paramType == null)\n+                            paramType = typeEntry.getQName(); // FIXME\n+                    } else {\n+                        paramType = typeEntry.getQName();\n+                    }\n+                    String mode = getModeString(param.getMode());\n+                    pw.print(\"        <parameter \");\n+                    if (paramQName == null || \"\".equals(paramQName.getLocalPart())) {\n+                        pw.print(\"name=\\\"\" + param.getName() + \"\\\" \" );\n+                    } else {\n+                        pw.print(\"qname=\\\"pns:\" + paramQName.getLocalPart() +\n+                                 \"\\\" xmlns:pns=\\\"\" + paramQName.getNamespaceURI() +\n+                                 \"\\\" \");\n+                    }\n+                    pw.print(\"type=\\\"tns:\" + paramType.getLocalPart() + \"\\\" \" );\n+                    pw.print(\"xmlns:tns=\\\"\" + paramType.getNamespaceURI() + \"\\\" \" );\n+                    pw.print(\"mode=\\\"\" + mode + \"\\\"\" );\n+                    pw.println(\"/>\");\n+                }\n+                \n                 pw.println(\"      </operation>\");\n             }\n-\n         }\n \n         pw.print(\"      <parameter name=\\\"allowedMethods\\\" value=\\\"\");\n@@ -321,4 +362,14 @@ else if (emitter.getScope() == Emitter.SESSION_SCOPE) {\n         }\n     } //writeDeployBinding\n \n+    public String getModeString(byte mode)\n+    {\n+        if (mode == Parameter.IN) {\n+            return \"IN\";\n+        } else if (mode == Parameter.INOUT) {\n+            return \"INOUT\";\n+        } else {\n+            return \"OUT\";\n+        }\n+    }\n } // class JavaDeployWriter",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "sha": "7276262e57085df87def3ddd6195e995e2dc1031",
                "status": "modified"
            },
            {
                "additions": 29,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/test/RPCDispatch/TestRPC.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestRPC.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 11,
                "filename": "test/RPCDispatch/TestRPC.java",
                "patch": "@@ -6,6 +6,8 @@\n import org.apache.axis.Handler;\n import org.apache.axis.Message;\n import org.apache.axis.MessageContext;\n+import org.apache.axis.encoding.TypeMapping;\n+import org.apache.axis.description.ServiceDesc;\n import org.apache.axis.providers.java.RPCProvider;\n import org.apache.axis.configuration.SimpleProvider;\n import org.apache.axis.handlers.soap.SOAPService;\n@@ -76,11 +78,7 @@ private final Object rpc(String method, Object[] parms)\n         envelope.addBodyElement(body);\n \n         // Invoke the Axis engine\n-        try {\n-            engine.invoke(msgContext);\n-        } catch (AxisFault af) {\n-            return af;\n-        }\n+        engine.invoke(msgContext);\n \n         // Extract the response Envelope\n         Message message = msgContext.getResponseMessage();\n@@ -110,6 +108,9 @@ public void testReverseString() throws Exception {\n         reverse.setOption(\"className\", \"test.RPCDispatch.Service\");\n         reverse.setOption(\"allowedMethods\", \"reverseString\");\n         provider.deployService(new QName(null,SOAPAction), reverse);\n+        ServiceDesc serviceDesc = reverse.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)reverse.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertEquals(\"Did not reverse the string correctly.\", \"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}));\n@@ -124,6 +125,9 @@ public void testReverseData() throws Exception {\n         reverse.setOption(\"className\", \"test.RPCDispatch.Service\");\n         reverse.setOption(\"allowedMethods\", \"reverseData\");\n         provider.deployService(new QName(null, SOAPAction), reverse);\n+        ServiceDesc serviceDesc = reverse.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)reverse.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         Data input    = new Data(5, \"abc\", 3);\n@@ -140,6 +144,9 @@ public void testMessageContextImplicit() throws Exception {\n         tgtSvc.setOption(\"className\", \"test.RPCDispatch.Service\");\n         tgtSvc.setOption(\"allowedMethods\", \"targetServiceImplicit\");\n         provider.deployService(new QName(null, SOAPAction), tgtSvc);\n+        ServiceDesc serviceDesc = tgtSvc.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)tgtSvc.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertEquals(\"SOAP Action did not equal the targetService.\", \n@@ -155,6 +162,9 @@ public void testNull() throws Exception {\n         echoInt.setOption(\"className\", \"test.RPCDispatch.Service\");\n         echoInt.setOption(\"allowedMethods\", \"echoInt\");\n         provider.deployService(new QName(null, SOAPAction), echoInt);\n+        ServiceDesc serviceDesc = echoInt.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)echoInt.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertNull(\"The result was not null as expected.\", rpc(\"echoInt\", new Object[] {null}));\n@@ -169,13 +179,20 @@ public void testSimpleFault() throws Exception {\n         simpleFault.setOption(\"className\", \"test.RPCDispatch.Service\");\n         simpleFault.setOption(\"allowedMethods\", \"simpleFault\");\n         provider.deployService(new QName(null, SOAPAction), simpleFault);\n+        ServiceDesc serviceDesc = simpleFault.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)simpleFault.getTypeMappingRegistry().getDefaultTypeMapping());\n+\n+        try {\n+            rpc(\"simpleFault\", new Object[] {\"foobar\"});\n+        } catch (AxisFault result) {\n+            assertEquals(\"faultString was not set correctly.\",\n+                \"test.RPCDispatch.Service$TestFault: foobar\",\n+                result.getFaultString());\n+            return;\n+        }\n \n-        Object result = rpc(\"simpleFault\", new Object[] {\"foobar\"});\n-        assertTrue(\"Did not get a fault as expected.\", \n-           result instanceof AxisFault);\n-        AxisFault fault = (AxisFault) result;\n-        assertEquals(\"faultString was not set correctly.\", \n-            \"test.RPCDispatch.Service$TestFault: foobar\", fault.getFaultString());\n+        fail(\"Did not get an expected fault!\");\n     }\n \n     public static void main(String args[])\n@@ -184,6 +201,7 @@ public static void main(String args[])\n         TestRPC tester = new TestRPC(\"RPC test\");\n         tester.testReverseString();\n         tester.testReverseData();\n+          tester.testSimpleFault();\n       } catch (Exception e) {\n         e.printStackTrace();\n       }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/test/RPCDispatch/TestRPC.java",
                "sha": "a9fbd8dd6fcae17cdd57b1a6dd41c1a108b78517",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/test/RPCDispatch/TestSerializedRPC.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestSerializedRPC.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "test/RPCDispatch/TestSerializedRPC.java",
                "patch": "@@ -83,7 +83,7 @@ public TestSerializedRPC(String name) throws Exception {\n         // be testing parameter dispatch by name, so if debug info isn't\n         // compiled into the Service class, the names are going to be \"in0\",\n         // etc.  Make sure they match.\n-        OperationDesc oper = desc.getOperationDescByName(\"concatenate\");\n+        OperationDesc oper = desc.getOperationByName(\"concatenate\");\n         assertNotNull(oper);\n         \n         firstParamName = oper.getParameter(0).getName();",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/test/RPCDispatch/TestSerializedRPC.java",
                "sha": "69a86b09822ab7fd4c2f033cc1fa499271bcaeab",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/test/encoding/TestSer.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/encoding/TestSer.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 9,
                "filename": "test/encoding/TestSer.java",
                "patch": "@@ -33,8 +33,7 @@\n     public static void main(String [] args) throws Exception\n     {\n         TestSer tester = new TestSer(\"TestSer\");\n-        tester.testDataNoHrefs();\n-        tester.testDataWithHrefs();\n+        tester.testRPCElement();\n     }\n     \n     public TestSer(String name) {\n@@ -105,14 +104,18 @@ public void doTestData (boolean multiref) throws Exception {\n     /**\n      * Test RPC element serialization when we have no MessageContext\n      */\n-    public void testRPCElement() throws Exception\n+    public void testRPCElement()\n     {\n-        SOAPEnvelope env = new SOAPEnvelope();\n-        RPCElement method = new RPCElement(\"ns\",\n-                                           \"method\",\n-                                           new Object [] { \"argument\" });\n-        env.addBodyElement(method);\n-        String soapStr = env.toString();\n+        try {\n+            SOAPEnvelope env = new SOAPEnvelope();\n+            RPCElement method = new RPCElement(\"ns\",\n+                                               \"method\",\n+                                               new Object [] { \"argument\" });\n+            env.addBodyElement(method);\n+            String soapStr = env.toString();\n+        } catch (Exception e) {\n+            fail(e.getMessage());\n+        }\n \n         // If there was no exception, we succeeded in serializing it.\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/test/encoding/TestSer.java",
                "sha": "abd73945985dabc7778dcabea1cbe1af528a86d6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "patch": "@@ -42,7 +42,7 @@\n         }\n         return in;\n     }\n-    public java.util.Map testMapFooArray(java.util.Map map)\n+    public java.util.HashMap testMapFooArray(java.util.HashMap map)\n         throws java.rmi.RemoteException {\n         return map;\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "sha": "011a8ff27e26fcd052d75cffac34fd804e0d0e13",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/aff486af8c4babc7bbf2ad91199cc7304a465477/test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/wsdl/marrays/MArrayTestsServiceTestCase.java?ref=aff486af8c4babc7bbf2ad91199cc7304a465477",
                "deletions": 1,
                "filename": "test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "patch": "@@ -131,7 +131,7 @@ public void testMArrayTests() {\n \n         try {\n             // Test 3F: Some of the Foo elements are multi-referenced.   \n-            Map map = new HashMap();\n+            HashMap map = new HashMap();\n             Foo[] array = new Foo[1];\n             array[0] = new Foo();\n             array[0].setValue(123);",
                "raw_url": "https://github.com/apache/axis1-java/raw/aff486af8c4babc7bbf2ad91199cc7304a465477/test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "sha": "0abc2cdd81544a19304d056414665a4e8a65812b",
                "status": "modified"
            }
        ],
        "message": "Improvements / cleanup of the RPC infrastructure + service metadata.  Still\nneeds some work, but this is much more like it.  Need to implement some edge-\ncase tests for this code.\n\nDetails:\n\n* Fix NPE in WSDDOperation - there can be 0 elementMappings\n\n* Slight change in TypeMappingImpl to only override the qname or class\n  mapping for a registered type mapping if there is a serializer/deserializer\n  present OR if there is no other mapping registered in that direction.\n\n* Mapping from xmlsoap:Map is now to HashMap, not Map.  We still happily\n  serialize any Map to an xmlsoap:Map, but the deser mapping goes to the\n  concrete class.\n\n* Add \"isConvertable()\" method to JavaUtils.\n\n* ServiceDesc is now much smarter about introspecting.  We introspect once\n  for each method that we're interested in, and methods which never get called\n  typically won't ever get introspected for.\n\n* Implement \"synchronizing\" OperationDescs which have been generated from\n  deployment (WSDD) info with an implementation class on the server.  This\n  means if we have a service with this deployment info:\n      <service...>\n         <operation name=\"method\">\n            <parameter name=\"a\" type=\"xsd:string\" mode=\"IN\"/>\n            <parameter name=\"b\" type=\"xsd:string\" mode=\"INOUT\"/>\n            <parameter name=\"c\" type=\"xsd:string\" mode=\"OUT\"/>\n         </operation>\n      </service>\n\n  ...and a method on the implementation class which looks like this:\n\n      public void method(String a, StringHolder b, StringHolder c)\n\n  we will match the two together, recording the correct Java classes for\n  the parameters in the ParameterDescs, and keeping a pointer to the Method\n  in the OperationDesc.  See next couple of bullets for why this is cool.\n\n* RPCProvider method search + dispatch code is now *much* cleaner.  We rely\n  on \"early binding\" to dispatch to the correct method via a ServiceDesc,\n  so by the time we've deserialized the RPCElement successfully, we know\n  exactly which OperationDesc (and hence which Java Method) we're dealing with.\n  That enables us to simply set up the parameters and call it.\n\n* RPCHandler now checks any actually received xsi:types against what is\n  expected/desired by the appropriate ParameterDesc, and throws a fault\n  if it can't map them.\n\n* RPCElement doesn't try to introspect every time anymore, it just makes sure\n  the ServiceDesc has the right typemapping and implementation class if\n  appropriate.  Then getOperationsByName() will introspect if necessary.\n\n* JavaDeployWriter now writes out <parameter> information into the WSDD\n\n* Put in missing mapping in samples/echo service, and put an <operation>\n  into the deploy.wsdd so we get the OUT parameters right for\n  echoStructAsSimpleTypes()\n\n* Enable accessing a Call's TypeMapping via getTypeMapping() - relies on the\n  encodingStyle being set correctly.\n\n* Remove various try/catch blocks which were obscuring exceptions in tests.\n  Tests in general should throw exceptions (and their associated stack traces)\n  instead of eating them, unless there's a good reason to eat them.\n\n* Move code which understands primitives/wrappers into JavaUtils, since it's\n  generally handy\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@246799 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/5b80febddaaac983482930588a4e43a3c051dd77",
        "repo": "axis1-java",
        "unit_tests": [
            "TestCall.java",
            "TestService.java",
            "TestServiceDesc.java",
            "TestJavaUtils.java"
        ]
    },
    "axis1-java_b52d4f8": {
        "bug_id": "axis1-java_b52d4f8",
        "commit": "https://github.com/apache/axis1-java/commit/b52d4f8cfa8e82e31341a449af758d27530bc81b",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/handlers/soap/SOAPService.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/soap/SOAPService.java?ref=b52d4f8cfa8e82e31341a449af758d27530bc81b",
                "deletions": 0,
                "filename": "src/org/apache/axis/handlers/soap/SOAPService.java",
                "patch": "@@ -313,6 +313,9 @@ public void setServiceDescription(ServiceDesc serviceDescription) {\n \n     public void setPropertyParent(Hashtable parent)\n     {\n+        if (options == null) {\n+            options = new LockableHashtable();\n+        }\n         ((LockableHashtable)options).setParent(parent);\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/handlers/soap/SOAPService.java",
                "sha": "31e9506ea26d064a5c739fafaf0445acea7520a5",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/utils/resources.properties",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/resources.properties?ref=b52d4f8cfa8e82e31341a449af758d27530bc81b",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/resources.properties",
                "patch": "@@ -838,3 +838,5 @@ implAlreadySet=Attempt to set implementation class on a ServiceDesc which has al\n cantCreateBean00=Unable to create JavaBean of type {0}.  Missing default constructor?  Error was: {1}.\n faultDuringCleanup=AxisEngine faulted during cleanup!\n \n+j2woptsoapAction00=value of the operation's soapAction field. Values are DEFAULT, OPERATION or NONE. OPERATION forces soapAction to the name of the operation.  DEFAULT causes the soapAction to be set according to the operation's meta data (usually \"\").  NONE forces the soapAction to \"\".  The default is DEFAULT.\n+j2wBadSoapAction00=The value of --soapAction must be DEFAULT, NONE or OPERATION.",
                "raw_url": "https://github.com/apache/axis1-java/raw/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/utils/resources.properties",
                "sha": "17f65b1816a306445b5a451d5132c3ba883e62b4",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/axis1-java/blob/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/wsdl/Java2WSDL.java",
                "changes": 22,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/Java2WSDL.java?ref=b52d4f8cfa8e82e31341a449af758d27530bc81b",
                "deletions": 1,
                "filename": "src/org/apache/axis/wsdl/Java2WSDL.java",
                "patch": "@@ -95,6 +95,7 @@\n     protected static final int METHODS_NOTALLOWED_OPT = 'x';\n     protected static final int STOP_CLASSES_OPT = 'c';\n     protected static final int TYPEMAPPING_OPT = 'T';\n+    protected static final int SOAPACTION_OPT = 'A';\n \n     /**\n      *  Define the understood options. Each CLOptionDescriptor contains:\n@@ -177,7 +178,11 @@\n         new CLOptionDescriptor(\"typeMappingVersion\",\n                 CLOptionDescriptor.ARGUMENT_REQUIRED,\n                 TYPEMAPPING_OPT,\n-                JavaUtils.getMessage(\"j2wopttypeMapping00\"))\n+                JavaUtils.getMessage(\"j2wopttypeMapping00\")),\n+        new CLOptionDescriptor(\"soapAction\",\n+                CLOptionDescriptor.ARGUMENT_REQUIRED,\n+                SOAPACTION_OPT,\n+                JavaUtils.getMessage(\"j2woptsoapAction00\"))\n     };\n \n     protected Emitter emitter;\n@@ -327,6 +332,21 @@ else if (\"Implementation\".equalsIgnoreCase(modeArg))\n             }\n             break;\n             \n+        case SOAPACTION_OPT:\n+            value = option.getArgument();\n+            if (value.equalsIgnoreCase(\"DEFAULT\")) {\n+                emitter.setSoapAction(\"DEFAULT\");\n+            } else if (value.equalsIgnoreCase(\"OPERATION\")) {\n+                emitter.setSoapAction(\"OPERATION\");\n+            } else if (value.equalsIgnoreCase(\"NONE\")) {\n+                emitter.setSoapAction(\"NONE\");\n+            } else {\n+                System.out.println(JavaUtils.getMessage(\"j2wBadSoapAction00\"));\n+            }\n+            break;\n+\n+        default: \n+            break;\n         }\n     }        \n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/wsdl/Java2WSDL.java",
                "sha": "902d91a05835e55262aed2e288f95f660bcdbd22",
                "status": "modified"
            },
            {
                "additions": 32,
                "blob_url": "https://github.com/apache/axis1-java/blob/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/fromJava/Emitter.java?ref=b52d4f8cfa8e82e31341a449af758d27530bc81b",
                "deletions": 3,
                "filename": "src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "patch": "@@ -1,4 +1,3 @@\n-\n /*\n  * The Apache Software License, Version 1.1\n  *\n@@ -143,6 +142,7 @@\n \n     private ServiceDesc serviceDesc;\n     private ServiceDesc serviceDesc2;\n+    private String soapAction = \"DEFAULT\";\n \n     /**\n      * Construct Emitter.\n@@ -732,9 +732,22 @@ private BindingOperation writeBindingOperation (Definition def,\n         bindingOper.setOperation(oper);\n \n         SOAPOperation soapOper = new SOAPOperationImpl();\n-        String soapAction = desc.getSoapAction();\n-        if (soapAction == null) {\n+\n+        \n+        // If the soapAction option is OPERATION, force\n+        // soapAction to the name of the operation. If NONE,\n+        // force soapAction to \"\".\n+        // Otherwise use the information in the operationDesc.\n+        String soapAction = \"\";\n+        if (getSoapAction().equals(\"OPERATION\")) {\n+            soapAction = oper.getName();\n+        } else if (getSoapAction().equals(\"NONE\")) {\n             soapAction = \"\";\n+        } else {\n+            soapAction = desc.getSoapAction();\n+            if (soapAction == null) {\n+                soapAction = \"\";\n+            }\n         }\n         soapOper.setSoapActionURI(soapAction);\n \n@@ -1365,6 +1378,22 @@ public void setDescription(String description) {\n         this.description = description;\n     }\n \n+    /**\n+     * Returns the soapAction option value\n+     * @return the String DEFAULT, NONE or OPERATION\n+     */\n+    public String getSoapAction() {\n+        return soapAction;\n+    }\n+\n+    /**\n+     * Sets the soapAction option value\n+     * @param must be DEFAULT, NONE, or OPERATION\n+     */\n+    public void setSoapAction(String value) {\n+        soapAction = value;\n+    }\n+\n     /**\n      * Returns the <code>TypeMapping</code> used by the service\n      * @return the <code>TypeMapping</code> used by the service",
                "raw_url": "https://github.com/apache/axis1-java/raw/b52d4f8cfa8e82e31341a449af758d27530bc81b/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "sha": "34989a31f6dceeb6f289f83b78298a3336fa5247",
                "status": "modified"
            }
        ],
        "message": "Fixed NPE in SOAPService.\n\nAdded --soapAction option to Java2WSDL.  Option values are\n   DEFAULT:  uses the information in the OperationDesc to set soapAction\n             (which is probably \"\").  This is also the default.\n   NONE:     forces soapAction=\"\"\n   OPERATION: sets the soapAction to the name of the operation.\n\nPR:\nObtained from:\nSubmitted by:\nReviewed by:\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@247075 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/ab3cb829273b8b6bf8ec116af434f889c674b050",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPService.java"
        ]
    },
    "axis1-java_be8ce0b": {
        "bug_id": "axis1-java_be8ce0b",
        "commit": "https://github.com/apache/axis1-java/commit/be8ce0bfd312d790f2ce9246df23e57e553e7c03",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/axis1-java/blob/be8ce0bfd312d790f2ce9246df23e57e553e7c03/src/org/apache/axis/message/SOAPFault.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPFault.java?ref=be8ce0bfd312d790f2ce9246df23e57e553e7c03",
                "deletions": 3,
                "filename": "src/org/apache/axis/message/SOAPFault.java",
                "patch": "@@ -212,9 +212,11 @@ private QName getFaultQName(Class cls, SerializationContext context) {\n         QName qname = null;       \n         if (! cls.equals(AxisFault.class)) {\n             FaultDesc faultDesc = null;\n-            OperationDesc op = context.getMessageContext().getOperation();\n-            if(op != null) {\n-                faultDesc = op.getFaultByClass(cls);\n+            if (context.getMessageContext() != null) {\n+                OperationDesc op = context.getMessageContext().getOperation();\n+                if (op != null) {\n+                    faultDesc = op.getFaultByClass(cls);\n+                }\n             }\n                 \n             if (faultDesc != null) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/be8ce0bfd312d790f2ce9246df23e57e553e7c03/src/org/apache/axis/message/SOAPFault.java",
                "sha": "7d8a4227ae10c094b6a566e0ae9ee474d04a1b8d",
                "status": "modified"
            }
        ],
        "message": "Fix for Bug 20653 - AxisFault during config processing gives NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256216 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/d55d54c442988e0e6a1a932043147389fd45d058",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPFault.java"
        ]
    },
    "axis1-java_bf4dfd4": {
        "bug_id": "axis1-java_bf4dfd4",
        "commit": "https://github.com/apache/axis1-java/commit/bf4dfd4d6404711ce858a49dbf87e68bd3dd46ea",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/bf4dfd4d6404711ce858a49dbf87e68bd3dd46ea/src/org/apache/axis/message/SOAPHeader.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/SOAPHeader.java?ref=bf4dfd4d6404711ce858a49dbf87e68bd3dd46ea",
                "deletions": 1,
                "filename": "src/org/apache/axis/message/SOAPHeader.java",
                "patch": "@@ -94,7 +94,7 @@\n     SOAPHeader(SOAPEnvelope env, SOAPConstants soapConsts) {\n         super(Constants.ELEM_HEADER,\n               Constants.NS_PREFIX_SOAP_ENV,\n-              soapConsts.getEnvelopeURI());\n+              soapConsts != null? soapConsts.getEnvelopeURI() : SOAPConstants.SOAP11_CONSTANTS.getEnvelopeURI());\n         soapConstants = soapConsts;\n         try {\n             setParentElement(env);",
                "raw_url": "https://github.com/apache/axis1-java/raw/bf4dfd4d6404711ce858a49dbf87e68bd3dd46ea/src/org/apache/axis/message/SOAPHeader.java",
                "sha": "bfc61828efd0604afd7386ecb73b27cbf8a3c190",
                "status": "modified"
            }
        ],
        "message": "Prevent NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249019 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/d48862e9424f6b1dec30dfa92dad2b6211f83640",
        "repo": "axis1-java",
        "unit_tests": [
            "TestSOAPHeader.java"
        ]
    },
    "axis1-java_c2172c1": {
        "bug_id": "axis1-java_c2172c1",
        "commit": "https://github.com/apache/axis1-java/commit/c2172c1b9cdd58eef089447fd4674367c6c929f0",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/c2172c1b9cdd58eef089447fd4674367c6c929f0/src/org/apache/axis/client/Call.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Call.java?ref=c2172c1b9cdd58eef089447fd4674367c6c929f0",
                "deletions": 0,
                "filename": "src/org/apache/axis/client/Call.java",
                "patch": "@@ -376,6 +376,9 @@ public void setOperation(QName portName, String opName)\n         ////////////////////////////////////////////////////////////////////\n         BindingOperation bop = binding.getBindingOperation(opName,\n                                                            null, null);\n+        if ( bop == null )\n+            throw new JAXRPCException( JavaUtils.getMessage(\"noOperation02\",\n+                                                            opName ));\n         this.removeProperty(HTTPConstants.MC_HTTP_SOAPACTION);\n         list = bop.getExtensibilityElements();\n         for ( int i = 0 ; list != null && i < list.size() ; i++ ) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/c2172c1b9cdd58eef089447fd4674367c6c929f0/src/org/apache/axis/client/Call.java",
                "sha": "5bc33822ffff2f92d8297d1c0b3bf946fa82e25b",
                "status": "modified"
            }
        ],
        "message": "check for NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@252989 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/30ecaedc15c97d00c5114a08ec33118c5aad1140",
        "repo": "axis1-java",
        "unit_tests": [
            "TestCall.java"
        ]
    },
    "axis1-java_c71fd21": {
        "bug_id": "axis1-java_c71fd21",
        "commit": "https://github.com/apache/axis1-java/commit/c71fd21ad5deeeacc381023857ec6d3f33b818be",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/c71fd21ad5deeeacc381023857ec6d3f33b818be/src/org/apache/axis/types/Token.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/types/Token.java?ref=c71fd21ad5deeeacc381023857ec6d3f33b818be",
                "deletions": 1,
                "filename": "src/org/apache/axis/types/Token.java",
                "patch": "@@ -101,7 +101,10 @@ public Token(String stValue) throws IllegalArgumentException {\n      */\n     public boolean isValid(String stValue) {\n         int scan;\n-\n+        // check to see if we have a string to review\n+        if (  (stValue == null) || (stValue.length() == 0)  )\n+            return true;\n+            \n         // no leading space\n         if (stValue.charAt(0) == 0x20)\n             return false;",
                "raw_url": "https://github.com/apache/axis1-java/raw/c71fd21ad5deeeacc381023857ec6d3f33b818be/src/org/apache/axis/types/Token.java",
                "sha": "7713ed565d4c87c47baf6880ea79ff3ef5198e33",
                "status": "modified"
            },
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/axis1-java/blob/c71fd21ad5deeeacc381023857ec6d3f33b818be/test/types/TestToken.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/types/TestToken.java?ref=c71fd21ad5deeeacc381023857ec6d3f33b818be",
                "deletions": 0,
                "filename": "test/types/TestToken.java",
                "patch": "@@ -152,4 +152,18 @@ public void testStringWithLeadingAndTrailingSpaces() throws Exception {\n     public void testDoubleSpace() throws Exception {\n         runFailTest(\"a   B\"); // note: \\r fails\n     }\n+    \n+    /**\n+     * Test an empty string\n+     */\n+    public void testEmptyString() throws Exception {\n+        runPassTest(\"\"); \n+    }\n+    \n+    /**\n+     * Test an empty string\n+     */\n+    public void testNull() throws Exception {\n+        runPassTest(null); \n+    }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/c71fd21ad5deeeacc381023857ec6d3f33b818be/test/types/TestToken.java",
                "sha": "1f6cec42077d4da7d7760902d3ac6c1ed2f071cc",
                "status": "modified"
            }
        ],
        "message": "fix NPE if value of token is empty string\nPR:19592\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249111 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/2d1226b5daa8822deae3f13d5a0a807639d7e841",
        "repo": "axis1-java",
        "unit_tests": [
            "TestToken.java"
        ]
    },
    "axis1-java_dc7e303": {
        "bug_id": "axis1-java_dc7e303",
        "commit": "https://github.com/apache/axis1-java/commit/dc7e3039aab68290a889d0e5e9b262d00feac1fe",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/Constants.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 6,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -660,12 +660,7 @@ public static boolean isWSDLSOAP(String s) {\n      * the no-service fault value\n      */\n     public static final QName QNAME_NO_SERVICE_FAULT_CODE\n-            = new QName(NS_URI_AXIS, \"Server.NoService\");\n-\n-    /**\n-     * the provider for the service does not support WSDL generation\n-     */\n-    public static final QName QNAME_NO_WSDLGENERATOR_FAULT_CODE = new QName( NS_URI_AXIS, \"Server.NoWSDLSupport\");          \n+            = new QName(NS_URI_AXIS, \"Server.NoService\");         \n     \n     // Misc Strings\n     //////////////////////////////////////////////////////////////////////////",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/Constants.java",
                "sha": "221ca77bfc1a8d39919ac65a5f9fd2377e384391",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/i18n/resource.properties",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/i18n/resource.properties?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 2,
                "filename": "src/org/apache/axis/i18n/resource.properties",
                "patch": "@@ -474,8 +474,6 @@ noWSDL00=Could not generate WSDL!\n noWSDL01=There is no SOAP service at this location\n # NOTE:  in noWSDL02, do not translate \"WSDL\"\n noWSDL02=There is a service at this location, but Axis did not generate the WSDL for it. Perhaps it is is misconfigured. \n-# NOTE:   in noWSDL03, do not translate \"WSDL\"\n-noWSDL03=The provider of this service does not support WSDL generation\n \n null00={0} is null\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/i18n/resource.properties",
                "sha": "54246f6b453e3416c0f29384d101cb167fabfde4",
                "status": "modified"
            },
            {
                "additions": 140,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/providers/BasicProvider.java",
                "changes": 154,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/BasicProvider.java?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 14,
                "filename": "src/org/apache/axis/providers/BasicProvider.java",
                "patch": "@@ -55,17 +55,22 @@\n \n package org.apache.axis.providers;\n \n+import java.util.Hashtable;\n+\n+import javax.xml.namespace.QName;\n+\n import org.apache.axis.AxisFault;\n import org.apache.axis.Constants;\n import org.apache.axis.MessageContext;\n import org.apache.axis.components.logger.LogFactory;\n+import org.apache.axis.description.ServiceDesc;\n+import org.apache.axis.encoding.TypeMapping;\n import org.apache.axis.handlers.BasicHandler;\n import org.apache.axis.handlers.soap.SOAPService;\n import org.apache.axis.utils.Messages;\n+import org.apache.axis.wsdl.fromJava.Emitter;\n import org.apache.commons.logging.Log;\n-\n-import javax.xml.namespace.QName;\n-import java.util.Hashtable;\n+import org.w3c.dom.Document;\n \n /**\n  * This class has one way of keeping track of the\n@@ -133,18 +138,139 @@ public String getOperationName(QName qname) {\n     /**\n      * Generate the WSDL for this service.\n      *\n-     * This method can be overwritten in a subclass with\n-     * code that put in the \"WSDL\" property of the message \n-     * context as a org.w3c.dom.Document\n+     * Put in the \"WSDL\" property of the message context\n+     * as a org.w3c.dom.Document\n      */\n     public void generateWSDL(MessageContext msgContext) throws AxisFault {\n-         \n-      AxisFault fault = new AxisFault( Messages.getMessage(\"noWSDL03\"));\n-      \n-      // set the fault code, so that QSWSDLHandler could deside to report \"nowsdl\"\n-      // instead of throwing an AxisFault\n-      fault.setFaultCode( Constants.QNAME_NO_WSDLGENERATOR_FAULT_CODE);\n-      \n-      throw fault;\n+        if (log.isDebugEnabled())\n+            log.debug(\"Enter: BasicProvider::generateWSDL (\" + this +\")\");\n+\n+        /* Find the service we're invoking so we can grab it's options */\n+        /***************************************************************/\n+        SOAPService service = msgContext.getService();\n+        ServiceDesc serviceDesc = service.getInitializedServiceDesc(msgContext);\n+\n+        // Calculate the appropriate namespaces for the WSDL we're going\n+        // to put out.\n+        //\n+        // If we've been explicitly told which namespaces to use, respect\n+        // that.  If not:\n+        //\n+        // The \"interface namespace\" should be either:\n+        // 1) The namespace of the ServiceDesc\n+        // 2) The transport URL (if there's no ServiceDesc ns)\n+\n+        try {\n+            // Location URL is whatever is explicitly set in the MC\n+            String locationUrl = msgContext.getStrProp(MessageContext.WSDLGEN_SERV_LOC_URL);\n+\n+            if (locationUrl == null) {\n+                // If nothing, try what's explicitly set in the ServiceDesc\n+                locationUrl = serviceDesc.getEndpointURL();\n+            }\n+\n+            if (locationUrl == null) {\n+                // If nothing, use the actual transport URL\n+                locationUrl = msgContext.getStrProp(MessageContext.TRANS_URL);\n+            }\n+\n+            // Interface namespace is whatever is explicitly set\n+            String interfaceNamespace = msgContext.getStrProp(MessageContext.WSDLGEN_INTFNAMESPACE);\n+\n+            if (interfaceNamespace == null) {\n+                // If nothing, use the default namespace of the ServiceDesc\n+                interfaceNamespace = serviceDesc.getDefaultNamespace();\n+            }\n+\n+            if (interfaceNamespace == null) {\n+                // If nothing still, use the location URL determined above\n+                interfaceNamespace = locationUrl;\n+            }\n+\n+            //Do we want to do this?\n+            //\n+            //          if (locationUrl == null) {\n+            //              locationUrl = url;\n+            //          } else {\n+            //              try {\n+            //                  URL urlURL = new URL(url);\n+            //                  URL locationURL = new URL(locationUrl);\n+            //                  URL urlTemp = new URL(urlURL.getProtocol(),\n+            //                          locationURL.getHost(),\n+            //                          locationURL.getPort(),\n+            //                          urlURL.getFile());\n+            //                  interfaceNamespace += urlURL.getFile();\n+            //                  locationUrl = urlTemp.toString();\n+            //              } catch (Exception e) {\n+            //                  locationUrl = url;\n+            //                  interfaceNamespace = url;\n+            //              }\n+            //          }\n+\n+            Emitter emitter = new Emitter();\n+\n+            // This seems like a good idea, but in fact isn't because the\n+            // emitter will figure out a reasonable name (<classname>Service)\n+            // for the WSDL service element name.  We provide the 'alias'\n+            // setting to explicitly set this name. See bug 13262 for more info.\n+            //emitter.setServiceElementName(serviceDesc.getName());\n+\n+            // service alias may be provided if exact naming is required,\n+            // otherwise Axis will name it according to the implementing class name\n+            String alias = (String) service.getOption(\"alias\");\n+            if (alias != null)\n+                emitter.setServiceElementName(alias);\n+\n+            // Set style/use\n+            emitter.setStyle(serviceDesc.getStyle());\n+            emitter.setUse(serviceDesc.getUse());\n+\n+            emitter.setClsSmart(serviceDesc.getImplClass(), locationUrl);\n+\n+            // If a wsdl target namespace was provided, use the targetNamespace.\n+            // Otherwise use the interfaceNamespace constructed above.\n+            String targetNamespace = (String) service.getOption(OPTION_WSDL_TARGETNAMESPACE);\n+            if (targetNamespace == null || targetNamespace.length() == 0) {\n+                targetNamespace = interfaceNamespace;\n+            }\n+            emitter.setIntfNamespace(targetNamespace);\n+\n+            emitter.setLocationUrl(locationUrl);\n+            emitter.setServiceDesc(serviceDesc);\n+            emitter.setTypeMapping((TypeMapping) msgContext.getTypeMappingRegistry().getTypeMapping(serviceDesc.getUse().getEncoding()));\n+            emitter.setDefaultTypeMapping((TypeMapping) msgContext.getTypeMappingRegistry().getDefaultTypeMapping());\n+\n+            String wsdlPortType = (String) service.getOption(OPTION_WSDL_PORTTYPE);\n+            String wsdlServiceElement = (String) service.getOption(OPTION_WSDL_SERVICEELEMENT);\n+            String wsdlServicePort = (String) service.getOption(OPTION_WSDL_SERVICEPORT);\n+\n+            if (wsdlPortType != null && wsdlPortType.length() > 0) {\n+                emitter.setPortTypeName(wsdlPortType);\n+            }\n+            if (wsdlServiceElement != null && wsdlServiceElement.length() > 0) {\n+                emitter.setServiceElementName(wsdlServiceElement);\n+            }\n+            if (wsdlServicePort != null && wsdlServicePort.length() > 0) {\n+                emitter.setServicePortName(wsdlServicePort);\n+            }\n+\n+            String wsdlInputSchema = (String) service.getOption(OPTION_WSDL_INPUTSCHEMA);\n+            if (null != wsdlInputSchema && wsdlInputSchema.length() > 0) {\n+                emitter.setInputSchema(wsdlInputSchema);\n+            }\n+\n+            Document doc = emitter.emit(Emitter.MODE_ALL);\n+\n+            msgContext.setProperty(\"WSDL\", doc);\n+        } catch (NoClassDefFoundError e) {\n+            entLog.info(Messages.getMessage(\"toAxisFault00\"), e);\n+            throw new AxisFault(e.toString(), e);\n+        } catch (Exception e) {\n+            entLog.info(Messages.getMessage(\"toAxisFault00\"), e);\n+            throw AxisFault.makeFault(e);\n+        }\n+\n+        if (log.isDebugEnabled())\n+            log.debug(\"Exit: BasicProvider::generateWSDL (\" + this +\")\");\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/providers/BasicProvider.java",
                "sha": "9d9c61c801e9a144aa9ad2a65d10c4483aebc468",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/providers/java/JavaProvider.java",
                "changes": 144,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/JavaProvider.java?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 144,
                "filename": "src/org/apache/axis/providers/java/JavaProvider.java",
                "patch": "@@ -357,150 +357,6 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n             log.debug(\"Exit: JavaProvider::invoke (\" + this + \")\");\n     }\n \n-    /**\n-     * Generate the WSDL for this service.\n-     *\n-     * Put in the \"WSDL\" property of the message context\n-     * as a org.w3c.dom.Document\n-     */\n-    public void generateWSDL(MessageContext msgContext) throws AxisFault {\n-        if (log.isDebugEnabled())\n-            log.debug(\"Enter: JavaProvider::generateWSDL (\" + this + \")\");\n-\n-        /* Find the service we're invoking so we can grab it's options */\n-        /***************************************************************/\n-        SOAPService service = msgContext.getService();\n-        ServiceDesc serviceDesc = service.getInitializedServiceDesc(msgContext);\n-\n-        // Calculate the appropriate namespaces for the WSDL we're going\n-        // to put out.\n-        //\n-        // If we've been explicitly told which namespaces to use, respect\n-        // that.  If not:\n-        //\n-        // The \"interface namespace\" should be either:\n-        // 1) The namespace of the ServiceDesc\n-        // 2) The transport URL (if there's no ServiceDesc ns)\n-\n-        try {\n-            // Location URL is whatever is explicitly set in the MC\n-            String locationUrl =\n-                    msgContext.getStrProp(MessageContext.WSDLGEN_SERV_LOC_URL);\n-\n-            if (locationUrl == null) {\n-                // If nothing, try what's explicitly set in the ServiceDesc\n-                locationUrl = serviceDesc.getEndpointURL();\n-            }\n-\n-            if (locationUrl == null) {\n-                // If nothing, use the actual transport URL\n-                locationUrl = msgContext.getStrProp(MessageContext.TRANS_URL);\n-            }\n-\n-            // Interface namespace is whatever is explicitly set\n-            String interfaceNamespace =\n-                    msgContext.getStrProp(MessageContext.WSDLGEN_INTFNAMESPACE);\n-\n-            if (interfaceNamespace == null) {\n-                // If nothing, use the default namespace of the ServiceDesc\n-                interfaceNamespace = serviceDesc.getDefaultNamespace();\n-            }\n-\n-            if (interfaceNamespace == null) {\n-                // If nothing still, use the location URL determined above\n-                interfaceNamespace = locationUrl;\n-            }\n-\n-//  Do we want to do this?\n-//\n-//            if (locationUrl == null) {\n-//                locationUrl = url;\n-//            } else {\n-//                try {\n-//                    URL urlURL = new URL(url);\n-//                    URL locationURL = new URL(locationUrl);\n-//                    URL urlTemp = new URL(urlURL.getProtocol(),\n-//                            locationURL.getHost(),\n-//                            locationURL.getPort(),\n-//                            urlURL.getFile());\n-//                    interfaceNamespace += urlURL.getFile();\n-//                    locationUrl = urlTemp.toString();\n-//                } catch (Exception e) {\n-//                    locationUrl = url;\n-//                    interfaceNamespace = url;\n-//                }\n-//            }\n-\n-            Emitter emitter = new Emitter();\n-\n-            // This seems like a good idea, but in fact isn't because the\n-            // emitter will figure out a reasonable name (<classname>Service)\n-            // for the WSDL service element name.  We provide the 'alias'\n-            // setting to explicitly set this name. See bug 13262 for more info.\n-            //emitter.setServiceElementName(serviceDesc.getName());\n-            \n-            // service alias may be provided if exact naming is required,\n-            // otherwise Axis will name it according to the implementing class name\n-            String alias = (String)service.getOption(\"alias\");\n-            if(alias != null) emitter.setServiceElementName(alias);\n-\n-            // Set style/use\n-            emitter.setStyle(serviceDesc.getStyle());\n-            emitter.setUse(serviceDesc.getUse());\n-\n-            emitter.setClsSmart(serviceDesc.getImplClass(), locationUrl);\n-\n-            // If a wsdl target namespace was provided, use the targetNamespace.\n-            // Otherwise use the interfaceNamespace constructed above.\n-            String targetNamespace = (String) service.getOption(OPTION_WSDL_TARGETNAMESPACE);\n-            if (targetNamespace == null ||\n-                targetNamespace.length() == 0) {\n-                targetNamespace = interfaceNamespace;\n-            }\n-            emitter.setIntfNamespace(targetNamespace);\n-\n-            emitter.setLocationUrl(locationUrl);\n-            emitter.setServiceDesc(serviceDesc);\n-            emitter.setTypeMapping((TypeMapping)msgContext.getTypeMappingRegistry()\n-                                       .getTypeMapping(serviceDesc.getUse().getEncoding()));\n-            emitter.setDefaultTypeMapping((TypeMapping)msgContext.getTypeMappingRegistry().\n-                                          getDefaultTypeMapping());\n-\n-            String wsdlPortType = (String) service.getOption(OPTION_WSDL_PORTTYPE);\n-            String wsdlServiceElement = (String) service.getOption(OPTION_WSDL_SERVICEELEMENT);\n-            String wsdlServicePort = (String) service.getOption(OPTION_WSDL_SERVICEPORT);\n-\n-            if (wsdlPortType != null && wsdlPortType.length() > 0) {\n-                emitter.setPortTypeName(wsdlPortType);\n-            }\n-            if (wsdlServiceElement != null && wsdlServiceElement.length() > 0) {\n-                emitter.setServiceElementName(wsdlServiceElement);\n-            }\n-            if (wsdlServicePort != null && wsdlServicePort.length() > 0) {\n-                emitter.setServicePortName(wsdlServicePort);\n-            }\n-\n-            String wsdlInputSchema = (String)\n-                service.getOption(OPTION_WSDL_INPUTSCHEMA);\n-            if (null != wsdlInputSchema && wsdlInputSchema.length() > 0) {\n-                emitter.setInputSchema(wsdlInputSchema);\n-            }\n-\n-            Document  doc = emitter.emit(Emitter.MODE_ALL);\n-\n-            msgContext.setProperty(\"WSDL\", doc);\n-        } catch (NoClassDefFoundError e) {\n-            entLog.info( Messages.getMessage(\"toAxisFault00\"), e );\n-            throw new AxisFault(e.toString(), e);\n-        } catch (Exception e) {\n-            entLog.info( Messages.getMessage(\"toAxisFault00\"), e );\n-            throw AxisFault.makeFault(e);\n-        }\n-\n-        if (log.isDebugEnabled())\n-            log.debug(\"Exit: JavaProvider::generateWSDL (\" + this + \")\");\n-    }\n-\n     private String getAllowedMethods(Handler service)\n     {\n         String val = (String)service.getOption(OPTION_ALLOWEDMETHODS);",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/providers/java/JavaProvider.java",
                "sha": "391b82ee6a4787e2da66629542b33e5fc97a931f",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/QSWSDLHandler.java?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 8,
                "filename": "src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "patch": "@@ -136,14 +136,9 @@ public void invoke (MessageContext msgContext) throws AxisFault {\n                 response.setStatus (HttpURLConnection.HTTP_NOT_FOUND);\n \n                 reportNoWSDL (response, writer, \"noWSDL01\", axisFault);\n-                \n-            } else if (axisFault.getFaultCode().equals(Constants.QNAME_NO_WSDLGENERATOR_FAULT_CODE)) {              \n-              // the provider for the service doesn't support WSDL generation\n-              response.setStatus (HttpURLConnection.HTTP_NOT_FOUND);\n-           \n-              // report WSDL support is missing                 \n-              reportNoWSDL (response, writer, \"noWSDL03\", axisFault);\n-            } else {\n+            }\n+\n+            else {\n                 //all other faults get thrown\n \n                 throw axisFault;",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/transport/http/QSWSDLHandler.java",
                "sha": "466f6a29d3f917e8fa4be6dc48676f2604243ecd",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/axis1-java/blob/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/fromJava/Emitter.java?ref=dc7e3039aab68290a889d0e5e9b262d00feac1fe",
                "deletions": 3,
                "filename": "src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "patch": "@@ -521,9 +521,16 @@ protected void init(int mode) {\n         }\n \n         if (encodingList == null) {\n-            clsName = cls.getName();\n-            clsName = clsName.substring(clsName.lastIndexOf('.') + 1);\n-\n+          \n+            // if cls contains a Class object with the service implementation use the Name of the\n+            // class else use the service name\n+            if ( cls != null ) {            \n+                clsName = cls.getName();                  \n+                clsName = clsName.substring(clsName.lastIndexOf('.') + 1);\n+            } else {              \n+                clsName = getServiceDesc().getName();\n+            }\n+            \n             // Default the portType name\n             if (getPortTypeName() == null) {\n                 setPortTypeName(clsName);",
                "raw_url": "https://github.com/apache/axis1-java/raw/dc7e3039aab68290a889d0e5e9b262d00feac1fe/src/org/apache/axis/wsdl/fromJava/Emitter.java",
                "sha": "e4ecb1bea212292c848d6f661755d7331eef210e",
                "status": "modified"
            }
        ],
        "message": "Fix for Bug 24092 - Generating WSDL out of non-Java Web Services causes NPE\nfrom bayer@oio.de (Thomas Bayer)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@249805 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/6f00506a76e6bb6119ffc8e9e8ad7bbbe57e724d",
        "repo": "axis1-java",
        "unit_tests": [
            "TestBasicProvider.java"
        ]
    },
    "axis1-java_df55966": {
        "bug_id": "axis1-java_df55966",
        "commit": "https://github.com/apache/axis1-java/commit/df55966fe9172c7af910b2021e77b079846a8926",
        "file": [
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/axis1-java/blob/df55966fe9172c7af910b2021e77b079846a8926/src/org/apache/axis/utils/Admin.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/Admin.java?ref=df55966fe9172c7af910b2021e77b079846a8926",
                "deletions": 12,
                "filename": "src/org/apache/axis/utils/Admin.java",
                "patch": "@@ -279,22 +279,25 @@ public Document process(MessageContext msgContext, Element root)\n             /** For now, though - make sure we can only admin from our own\n              * IP, unless the remoteAdmin option is set.\n              */\n-            String remoteAdmin = (String)msgContext.getServiceHandler().\n+            Handler serviceHandler = msgContext.getServiceHandler();\n+            if (serviceHandler != null) {\n+                String remoteAdmin = (String)serviceHandler.\n                                             getOption(\"enableRemoteAdmin\");\n-            if ((remoteAdmin == null) ||\n-                !remoteAdmin.equals(\"true\")) {\n-                String remoteIP =\n+                if ((remoteAdmin == null) ||\n+                    !remoteAdmin.equals(\"true\")) {\n+                    String remoteIP =\n                             msgContext.getStrProp(Constants.MC_REMOTE_ADDR);\n-                if (remoteIP != null) {\n-                    if (!remoteIP.equals(\"127.0.0.1\")) {\n-                        InetAddress myAddr = InetAddress.getLocalHost();\n-                        InetAddress remoteAddr =\n+                    if (remoteIP != null) {\n+                        if (!remoteIP.equals(\"127.0.0.1\")) {\n+                            InetAddress myAddr = InetAddress.getLocalHost();\n+                            InetAddress remoteAddr =\n                                             InetAddress.getByName(remoteIP);\n                         \n-                        if (!myAddr.equals(remoteAddr))\n-                            throw new AxisFault(\"Server.Unauthorized\",\n-                                \"Remote admin access is not allowed! \",\n-                                null, null);\n+                            if (!myAddr.equals(remoteAddr))\n+                                throw new AxisFault(\"Server.Unauthorized\",\n+                                    \"Remote admin access is not allowed! \",\n+                                    null, null);\n+                        }\n                     }\n                 }\n             }",
                "raw_url": "https://github.com/apache/axis1-java/raw/df55966fe9172c7af910b2021e77b079846a8926/src/org/apache/axis/utils/Admin.java",
                "sha": "cff0a3c55425ada1dc9d5fd44940562474030cbf",
                "status": "modified"
            }
        ],
        "message": "Fix potential NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@245121 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/87e83836737f89644e7373a9df7514b8fec9e97a",
        "repo": "axis1-java",
        "unit_tests": [
            "AdminTest.java"
        ]
    },
    "axis1-java_e41f528": {
        "bug_id": "axis1-java_e41f528",
        "commit": "https://github.com/apache/axis1-java/commit/e41f5285762d6827ef1104a9aee6c324f14084e4",
        "file": [
            {
                "additions": 202,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/AxisEngine.java",
                "changes": 202,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/AxisEngine.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 0,
                "filename": "src/org/apache/axis/AxisEngine.java",
                "patch": "@@ -0,0 +1,202 @@\n+/*\n+ * The Apache Software License, Version 1.1\n+ *\n+ *\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution,\n+ *    if any, must include the following acknowledgment:\n+ *       \"This product includes software developed by the\n+ *    Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowledgment may appear in the software itself,\n+ *    if and wherever such third-party acknowledgments normally appear.\n+ *\n+ * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n+ *    not be used to endorse or promote products derived from this\n+ *    software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\",\n+ *    nor may \"Apache\" appear in their name, without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+\n+package org.apache.axis;\n+\n+import java.io.*;\n+import java.util.* ;\n+import org.apache.axis.* ;\n+import org.apache.axis.utils.* ;\n+import org.apache.axis.handlers.* ;\n+import org.apache.axis.handlers.soap.* ;\n+import org.apache.axis.registries.* ;\n+import org.apache.axis.encoding.SOAPTypeMappingRegistry;\n+import org.apache.axis.encoding.TypeMappingRegistry;\n+\n+/**\n+ * An <code>AxisEngine</code> is the base class for AxisClient and\n+ * AxisServer.  Handles common functionality like dealing with the\n+ * handler/service registries and loading properties.\n+ *\n+ * @author Glen Daniels (gdaniels@allaire.com)\n+ */\n+public abstract class AxisEngine extends BasicHandler\n+{\n+    /** The handler registry this Engine uses. */\n+    protected HandlerRegistry _handlerRegistry;\n+    protected String handlerRegFilename;\n+    \n+    /** The service registry this Engine uses. */\n+    protected HandlerRegistry _serviceRegistry;\n+    protected String serviceRegFilename;\n+    \n+    protected Properties props = new Properties();\n+    \n+    /**\n+     * No-arg constructor.  Loads properties from the \"axis.properties\"\n+     * file if it exists.\n+     * \n+     */\n+    public AxisEngine()\n+    {\n+        Debug.Print( 1, \"Enter: AxisEngine no-arg constructor\");\n+        try {\n+            File propFile = new File(\"axis.properties\");\n+            if (propFile.exists()) {\n+                FileInputStream propFileInputStream =\n+                         new FileInputStream(propFile);\n+                props.load(propFileInputStream);\n+            }\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+        }\n+        Debug.Print( 1, \"Exit: AxisEngine no-arg constructor\");\n+    }\n+    \n+    /**\n+     * Allows the Listener to specify which handler/service registry\n+     * implementation they want to use.\n+     * \n+     * @param handlers the Handler registry.\n+     * @param services the Service registry.\n+     */\n+    public AxisEngine(HandlerRegistry handlers, HandlerRegistry services)\n+    {\n+        this();\n+        handlers.init();\n+        services.init();\n+        setHandlerRegistry(handlers);\n+        setServiceRegistry(services);\n+    }\n+\n+    /**\n+     * Constructor specifying registry filenames.\n+     * \n+     * @param handlerRegFilename the name of the Handler registry file.\n+     * @param serviceRegFilename the name of the Service registry file.\n+     */\n+    public AxisEngine(String handlerRegFilename, String serviceRegFilename)\n+    {\n+        this();\n+        this.handlerRegFilename = handlerRegFilename;\n+        this.serviceRegFilename = serviceRegFilename;\n+    }\n+\n+    /**\n+     * Find/load the registries and save them so we don't need to do this\n+     * each time we're called.\n+     */\n+    public void init() {\n+        // Load the simple handler registry and init it\n+        Debug.Print( 1, \"Enter: AxisEngine::init\" );\n+        \n+        String propVal = props.getProperty(\"debugLevel\", \"0\");\n+        Debug.setDebugLevel(Integer.parseInt(propVal));\n+        System.out.println(\"Debug level is \" + Debug.getDebugLevel());\n+        \n+        if (getHandlerRegistry() == null) {\n+            System.out.println(\"Using \" + handlerRegFilename);\n+            DefaultHandlerRegistry  hr =\n+                         new DefaultHandlerRegistry(handlerRegFilename);\n+            hr.setOnServer( true );\n+            hr.init();\n+            setHandlerRegistry( hr );\n+        }\n+        \n+        if (getServiceRegistry() == null) {\n+            System.out.println(\"Using \" + serviceRegFilename);\n+            // Load the simple deployed services registry and init it\n+            DefaultServiceRegistry  sr =\n+                         new DefaultServiceRegistry(serviceRegFilename);\n+            sr.setHandlerRegistry( getHandlerRegistry() ); // needs to know about 'hr'\n+            sr.setOnServer( true );\n+            sr.init();\n+            setServiceRegistry( sr );\n+        }\n+\n+        // Load the registry of deployed types\n+        TypeMappingRegistry tmr = new TypeMappingRegistry(\"typemap-supp.reg\");\n+        tmr.setParent(new SOAPTypeMappingRegistry());\n+        addOption( Constants.TYPEMAP_REGISTRY, tmr );\n+        \n+        /** ??? Why are we doing this??\n+         */\n+        Handler admin = getServiceRegistry().find(\"AdminService\");\n+        if (admin != null && admin instanceof SOAPService)\n+          ((SOAPService)admin).setTypeMappingRegistry(tmr);\n+\n+        Debug.Print( 1, \"Exit: AxisEngine::init\" );\n+    }\n+\n+    public HandlerRegistry getHandlerRegistry()\n+    {\n+        return _handlerRegistry;\n+    }\n+    \n+    public void setHandlerRegistry(HandlerRegistry registry)\n+    {\n+        _handlerRegistry = registry;\n+    }\n+    \n+    public HandlerRegistry getServiceRegistry()\n+    {\n+        return _serviceRegistry;\n+    }\n+    \n+    public void setServiceRegistry(HandlerRegistry registry)\n+    {\n+        _serviceRegistry = registry;\n+    }    \n+};",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/AxisEngine.java",
                "sha": "37414a7c09248cb72991ca4077354c5d2e79bf68",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/Constants.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/Constants.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 1,
                "filename": "src/org/apache/axis/Constants.java",
                "patch": "@@ -61,7 +61,6 @@\n   //  not all Engines will have notion of registries but defining these\n   //  here should allow people to ask if they exist)\n   //////////////////////////////////////////////////////////////////////////\n-  public static String AXIS_ENGINE      = \"AxisEngine\" ;\n   public static String HANDLER_REGISTRY = \"HandlerRegistry\" ;\n   public static String SERVICE_REGISTRY = \"ServiceRegistry\" ;\n   public static String TYPEMAP_REGISTRY = \"TypeMapRegistry\" ;",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/Constants.java",
                "sha": "be66eced60122d65a194d69e9687a744f79eb23a",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/MessageContext.java",
                "changes": 29,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/MessageContext.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 7,
                "filename": "src/org/apache/axis/MessageContext.java",
                "patch": "@@ -58,6 +58,7 @@\n import java.util.* ;\n import org.apache.axis.* ;\n import org.apache.axis.utils.AxisClassLoader ;\n+import org.apache.axis.utils.Debug ;\n import org.apache.axis.encoding.TypeMappingRegistry;\n import org.apache.axis.encoding.SOAPTypeMappingRegistry;\n import org.apache.axis.encoding.ServiceDescription;\n@@ -111,6 +112,11 @@\n      * The default classloader that this service should use\n      */\n     private AxisClassLoader  classLoader ;\n+    \n+    /**\n+     * The AxisEngine which this context is involved with\n+     */\n+    private AxisEngine       axisEngine;\n \n     /**\n      *\n@@ -126,17 +132,14 @@ public MessageContext() { }\n      */\n     private TypeMappingRegistry mappingRegistry = null;\n \n-    private static final SOAPTypeMappingRegistry soapTMR =\n-        new SOAPTypeMappingRegistry();\n-\n     public void setTypeMappingRegistry(TypeMappingRegistry reg) {\n         mappingRegistry = reg;\n     }\n \n     public TypeMappingRegistry getTypeMappingRegistry() {\n         if (mappingRegistry == null) {\n             mappingRegistry = new TypeMappingRegistry();\n-            mappingRegistry.setParent(soapTMR);\n+            mappingRegistry.setParent(SOAPTypeMappingRegistry.getSingleton());\n         }\n         return mappingRegistry;\n     }\n@@ -200,6 +203,16 @@ public void setClassLoader(AxisClassLoader cl ) {\n     public String getTargetService() {\n       return( targetService );\n     }\n+    \n+    public void setAxisEngine(AxisEngine engine)\n+    {\n+      this.axisEngine = engine;\n+    }\n+    \n+    public AxisEngine getAxisEngine()\n+    {\n+      return axisEngine;\n+    }\n \n     /**\n      * Set the target service for this message.\n@@ -211,6 +224,7 @@ public String getTargetService() {\n      * @param tServ the name of the target service.\n      */\n     public void setTargetService(String tServ) {\n+        Debug.Print(2, \"MessageContext: setTargetService(\" + tServ+\")\");\n         targetService = tServ ;\n \n         HandlerRegistry sr = (HandlerRegistry)\n@@ -236,6 +250,7 @@ public void setParsing(boolean parsing)\n     }\n \n     public Handler getServiceHandler() {\n+        Debug.Print(2, \"MessageContext:getServiceHandler()\");\n         if (serviceHandler == null) {\n             if (targetService != null) {\n                 /** This is a bit kludgey for now - what might have\n@@ -271,17 +286,17 @@ public Handler getServiceHandler() {\n                 }\n             }\n       }\n+      Debug.Print(2, \"MessageContext:getServiceHandler() returns \" + serviceHandler);\n       return( serviceHandler );\n     }\n     \n     public void setServiceHandler(Handler sh)\n     {\n+      Debug.Print(2,\"MessageContext: setServiceHandler(\"+sh+\")\");\n       serviceHandler = sh;\n       if (sh != null && sh instanceof SOAPService) {\n         TypeMappingRegistry tmr = ((SOAPService)sh).getTypeMappingRegistry();\n-        getTypeMappingRegistry().setParent(tmr);\n-      } else {\n-        getTypeMappingRegistry().setParent(soapTMR);\n+        setTypeMappingRegistry(tmr);\n       }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/MessageContext.java",
                "sha": "113d7aa43c03512d9f863d81bccb1b71cdb94311",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/client/AxisClient.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/AxisClient.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 45,
                "filename": "src/org/apache/axis/client/AxisClient.java",
                "patch": "@@ -2,7 +2,7 @@\n  * The Apache Software License, Version 1.1\n  *\n  *\n- * Copyright (c) 1999 The Apache Software Foundation.  All rights\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n  * reserved.\n  *\n  * Redistribution and use in source and binary forms, with or without\n@@ -70,51 +70,16 @@\n  * @author Doug Davis (dug@us.ibm.com)\n  * @author Glen Daniels (gdaniels@allaire.com)\n  */\n-public class AxisClient extends BasicHandler\n+public class AxisClient extends AxisEngine\n {\n-    public AxisClient() {}\n-    \n-    /**\n-     * Allows the Listener to specify which handler/service registry\n-     * implementation they want to use.\n-     */\n-    /*\n-    public AxisClient(HandlerRegistry handlers, HandlerRegistry services)\n+    public AxisClient()\n     {\n-        Debug.Print( 1, \"Enter: AxisClient::Constructor\");\n-        handlers.init();\n-        services.init();\n-        addOption(Constants.HANDLER_REGISTRY, handlers);\n-        addOption(Constants.SERVICE_REGISTRY, services);\n-        Debug.Print( 1, \"Exit: AxisClient::Constructor\");\n-     }*/\n-    \n-    /**\n-     * Find/load the registries and save them so we don't need to do this\n-     * each time we're called.\n-     * Package access since this should be wrapped by ServiceClient...??? -- RobJ\n-     */\n-    public void init() {\n-        // Load the simple handler registry and init it\n-        Debug.Print( 1, \"Enter: AxisClient::init\" );\n-        DefaultHandlerRegistry  hr =\n-            new DefaultHandlerRegistry(Constants.CLIENT_HANDLER_REGISTRY);\n-        hr.setOnServer( false );\n-        hr.init();\n-        addOption( Constants.HANDLER_REGISTRY, hr );\n-        \n-        // Load the simple deployed services registry and init it\n-        DefaultServiceRegistry  sr =\n-            new DefaultServiceRegistry(Constants.CLIENT_SERVICE_REGISTRY);\n-        sr.setHandlerRegistry( hr ); // Needs to know about 'hr'\n-        sr.setOnServer( false );\n-        sr.init();\n-        addOption( Constants.SERVICE_REGISTRY, sr );\n-        Debug.Print( 1, \"Exit: AxisClient::init\" );\n+        super(Constants.CLIENT_HANDLER_REGISTRY,\n+              Constants.CLIENT_SERVICE_REGISTRY);\n     }\n     \n     /**\n-     * Main routine of the AXIS server.  In short we locate the appropriate\n+     * Main routine of the AXIS engine.  In short we locate the appropriate\n      * handler for the desired service and invoke() it.\n      */\n     public void invoke(MessageContext msgContext) throws AxisFault {\n@@ -123,10 +88,8 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n         String  hName = null ;\n         Handler h     = null ;\n         \n-        HandlerRegistry hr =\n-            (HandlerRegistry) getOption(Constants.HANDLER_REGISTRY);\n-        HandlerRegistry sr =\n-            (HandlerRegistry) getOption(Constants.SERVICE_REGISTRY);\n+        HandlerRegistry hr = getHandlerRegistry();\n+        HandlerRegistry sr = getServiceRegistry();\n         \n         try {\n             hName = msgContext.getStrProp( MessageContext.ENGINE_HANDLER );",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/client/AxisClient.java",
                "sha": "99b1be535c5ff840036af9d7d85e30d21152c646",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 9,
                "filename": "src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "patch": "@@ -186,15 +186,14 @@ public SOAPTypeMappingRegistry() {\n \n         // !!! Seems a little weird to pass a null class here...?\n         addDeserializerFactory(SOAP_ARRAY, null, ArraySerializer.factory);\n-        /*\n-        addDeserializerFactory(SOAP_STRING, se);\n-        addDeserializerFactory(SOAP_BOOLEAN, se);\n-        addDeserializerFactory(SOAP_DOUBLE, se);\n-        addDeserializerFactory(SOAP_FLOAT, se);\n-        addDeserializerFactory(SOAP_INT, se);\n-        addDeserializerFactory(SOAP_LONG, se);\n-        addDeserializerFactory(SOAP_SHORT, se);\n-        */\n+    }\n+    \n+    private static SOAPTypeMappingRegistry singleton = null;\n+    public synchronized static SOAPTypeMappingRegistry getSingleton()\n+    {\n+        if (singleton == null)\n+            singleton = new SOAPTypeMappingRegistry();\n+        return singleton;\n     }\n     \n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/encoding/SOAPTypeMappingRegistry.java",
                "sha": "aa75edddacf687ddd79857987f5243d9e06bb0aa",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/TypeMappingRegistry.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 0,
                "filename": "src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "patch": "@@ -56,6 +56,7 @@\n package org.apache.axis.encoding;\n \n import java.util.Hashtable;\n+import java.util.Enumeration;\n import org.apache.axis.Constants;\n import org.apache.axis.utils.*;\n import org.apache.axis.utils.events.*;",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/encoding/TypeMappingRegistry.java",
                "sha": "49fd2bfff08565a5f39a1d87df0a36882d6b4903",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/handlers/tcp/TCPActionHandler.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 2,
                "filename": "src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "patch": "@@ -128,8 +128,8 @@ public void invoke(MessageContext msgContext) throws AxisFault\n           // and possibly wrong.\n           // ROBJ 911 What *is* the right way to get to the HandlerRegistry from here?!\n           // Is it in the MessageContext?  ... let's look ...\n-          Handler engine = (Handler)msgContext.getProperty(Constants.AXIS_ENGINE);\n-          HandlerRegistry hr = (HandlerRegistry)engine.getOption(Constants.HANDLER_REGISTRY);\n+          AxisEngine engine = (AxisEngine)msgContext.getAxisEngine();\n+          HandlerRegistry hr = engine.getHandlerRegistry();\n           String[] list = hr.list();\n           Handler handler = null;\n           for (int i = 0; i < list.length; i++) {",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/handlers/tcp/TCPActionHandler.java",
                "sha": "f82e2d21ced95855303bad4584b9a78dacd62052",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/server/AxisServer.java",
                "changes": 56,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/server/AxisServer.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 47,
                "filename": "src/org/apache/axis/server/AxisServer.java",
                "patch": "@@ -2,7 +2,7 @@\n  * The Apache Software License, Version 1.1\n  *\n  *\n- * Copyright (c) 1999 The Apache Software Foundation.  All rights\n+ * Copyright (c) 2001 The Apache Software Foundation.  All rights\n  * reserved.\n  *\n  * Redistribution and use in source and binary forms, with or without\n@@ -69,10 +69,11 @@\n  * @author Doug Davis (dug@us.ibm.com)\n  * @author Glen Daniels (gdaniels@allaire.com)\n  */\n-public class AxisServer extends BasicHandler\n+public class AxisServer extends AxisEngine\n {\n     public AxisServer() {\n-      // Debug.setDebugLevel(3);\n+      super(Constants.SERVER_HANDLER_REGISTRY,\n+            Constants.SERVER_SERVICE_REGISTRY);\n     }\n \n     /**\n@@ -81,44 +82,7 @@ public AxisServer() {\n      */\n     public AxisServer(HandlerRegistry handlers, HandlerRegistry services)\n     {\n-        Debug.Print( 1, \"Enter: AxisServer::Constructor\");\n-        handlers.init();\n-        services.init();\n-        addOption(Constants.HANDLER_REGISTRY, handlers);\n-        addOption(Constants.SERVICE_REGISTRY, services);\n-        Debug.Print( 1, \"Exit: AxisServer::Constructor\");\n-    }\n-\n-    /**\n-     * Find/load the registries and save them so we don't need to do this\n-     * each time we're called.\n-     */\n-    public void init() {\n-        // Load the simple handler registry and init it\n-        Debug.Print( 1, \"Enter: AxisServer::init\" );\n-        DefaultHandlerRegistry  hr =\n-          new DefaultHandlerRegistry(Constants.SERVER_HANDLER_REGISTRY);\n-        hr.setOnServer( true );\n-        hr.init();\n-        addOption( Constants.HANDLER_REGISTRY, hr );\n-\n-        // Load the simple deployed services registry and init it\n-        DefaultServiceRegistry  sr =\n-          new DefaultServiceRegistry(Constants.SERVER_SERVICE_REGISTRY);\n-        sr.setHandlerRegistry( hr ); // needs to know about 'hr'\n-        sr.setOnServer( true );\n-        sr.init();\n-        addOption( Constants.SERVICE_REGISTRY, sr );\n-\n-        // Load the registry of deployed types\n-        TypeMappingRegistry tmr = new TypeMappingRegistry(\"typemap-supp.reg\");\n-        tmr.setParent(new SOAPTypeMappingRegistry());\n-        addOption( Constants.TYPEMAP_REGISTRY, tmr );\n-        Handler admin = sr.find(\"AdminService\");\n-        if (admin != null && admin instanceof SOAPService)\n-          ((SOAPService)admin).setTypeMappingRegistry(tmr);\n-\n-        Debug.Print( 1, \"Exit: AxisServer::init\" );\n+        super(handlers, services);\n     }\n \n     /**\n@@ -134,18 +98,16 @@ public void invoke(MessageContext msgContext) throws AxisFault {\n         /* Do some prep-work.  Get the registries and put them in the */\n         /* msgContext so they can be used by later handlers.          */\n         /**************************************************************/\n-        HandlerRegistry hr =\n-            (HandlerRegistry) getOption(Constants.HANDLER_REGISTRY);\n-        HandlerRegistry sr =\n-            (HandlerRegistry) getOption(Constants.SERVICE_REGISTRY);\n+        HandlerRegistry hr = getHandlerRegistry();\n+        HandlerRegistry sr = getServiceRegistry();\n         TypeMappingRegistry tmr =\n             (TypeMappingRegistry) getOption(Constants.TYPEMAP_REGISTRY);\n \n-        msgContext.setProperty(Constants.AXIS_ENGINE, this );\n+        msgContext.setAxisEngine( this );\n         msgContext.setProperty(Constants.HANDLER_REGISTRY, hr);\n         msgContext.setProperty(Constants.SERVICE_REGISTRY, sr);\n \n-        msgContext.getTypeMappingRegistry().setParent(tmr);\n+        msgContext.setTypeMappingRegistry(tmr);\n \n         try {\n           hName = msgContext.getStrProp( MessageContext.ENGINE_HANDLER );",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/server/AxisServer.java",
                "sha": "f73db6a9080bdb14216a434d22f34dfe918bc247",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/transport/http/AxisServlet.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/AxisServlet.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 7,
                "filename": "src/org/apache/axis/transport/http/AxisServlet.java",
                "patch": "@@ -76,7 +76,7 @@\n   public void init() {\n       String param = getInitParameter(\"transport.input\");\n       ServletContext context = getServletConfig().getServletContext();\n-\n+      \n       if (param == null)\n           param = context.getInitParameter(\"transport.input\");\n       if (param != null)\n@@ -102,14 +102,12 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     ServletContext context = config.getServletContext();\n     HttpSession    session = req.getSession();\n \n-    Handler  engine = null ;\n-\n-    //Debug.setDebugLevel( 6 );\n+    AxisEngine  engine = null ;\n \n     /* Get or 'new' the Axis engine object */\n     /***************************************/\n     synchronized(context) {\n-      engine = (Handler) context.getAttribute( AXIS_ENGINE );\n+      engine = (AxisEngine) context.getAttribute( AXIS_ENGINE );\n       if ( engine == null ) {\n         engine = new AxisServer();\n         engine.init();\n@@ -196,8 +194,12 @@ public void doPost(HttpServletRequest req, HttpServletResponse res)\n     /***********************************/\n     msg = msgContext.getResponseMessage();\n     res.setContentType( \"text/xml\" );\n-    String response = (String) msg.getAs(\"String\");\n-    if (msg == null) response=\"No data\";\n+    String response;\n+    if (msg == null) {\n+        response=\"No data\";\n+    } else {\n+        response = (String)msg.getAs(\"String\");\n+    }\n     res.setContentLength( response.length() );\n     res.getWriter().print( response );\n   }",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/transport/http/AxisServlet.java",
                "sha": "06ff6328b6fcbbc1607ada1f23daed5c53f25ca0",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/transport/http/SimpleAxisServer.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 1,
                "filename": "src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "patch": "@@ -103,7 +103,7 @@ private static synchronized AxisServer getAxisServer() {\n     // Axis specific constants\n     private static String transportInName = \"HTTPAction\";\n     private static String transportOutName = \"HTTP.output\";\n-    private static final String AXIS_ENGINE = \"AxisEngine\" ;\n+    //private static final String AXIS_ENGINE = \"AxisEngine\" ;\n     \n     // are we stopped?\n     // latch to true if stop() is called",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/src/org/apache/axis/transport/http/SimpleAxisServer.java",
                "sha": "dca6b0b47870d41ad8c8d7813ec835d20c68f7b2",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/axis1-java/blob/e41f5285762d6827ef1104a9aee6c324f14084e4/test/RPCDispatch/TestRPC.java",
                "changes": 30,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestRPC.java?ref=e41f5285762d6827ef1104a9aee6c324f14084e4",
                "deletions": 8,
                "filename": "test/RPCDispatch/TestRPC.java",
                "patch": "@@ -36,13 +36,13 @@\n     private Handler RPCDispatcher;\n \n     private String SOAPAction = \"urn:reverse\";\n-    private String methodNS   = null;\n+    private String methodNS   = SOAPAction;\n \n     public TestRPC(String name) {\n         super(name);\n         engine.init();\n-        hr = (HandlerRegistry) engine.getOption(Constants.HANDLER_REGISTRY);\n-        sr = (HandlerRegistry) engine.getOption(Constants.SERVICE_REGISTRY);\n+        hr = (HandlerRegistry) engine.getHandlerRegistry();\n+        sr = (HandlerRegistry) engine.getServiceRegistry();\n         RPCDispatcher = hr.find(\"RPCDispatcher\");\n         // Debug.setDebugLevel(5);\n     }\n@@ -53,7 +53,8 @@ public TestRPC(String name) {\n      * @param request XML body of the request\n      * @return Deserialized result\n      */\n-    private final Object rpc(String method, Object[] parms)\n+    private final Object rpc(String method, Object[] parms,\n+                             boolean setService)\n         throws AxisFault\n     {\n \n@@ -70,7 +71,9 @@ private final Object rpc(String method, Object[] parms)\n         MessageContext msgContext = new MessageContext();\n         msgContext.setProperty(Constants.SERVICE_REGISTRY, sr);\n         msgContext.setRequestMessage(new Message(envelope, \"SOAPEnvelope\"));\n-        msgContext.setTargetService(SOAPAction);\n+        if (setService) {\n+            msgContext.setTargetService(SOAPAction);\n+        }\n \n         // Invoke the Axis engine\n         try {\n@@ -109,7 +112,18 @@ public void testReverseString() throws Exception {\n         sr.add(SOAPAction, reverse);\n \n         // invoke the service and verify the result\n-        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}));\n+        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}, true));\n+    }\n+\n+    public void testReverseBodyDispatch() throws Exception {\n+        // Register the reverseString service\n+        SOAPService reverse = new SOAPService(RPCDispatcher, \"RPCDispatcher\");\n+        reverse.addOption(\"className\", \"test.RPCDispatch.Service\");\n+        reverse.addOption(\"methodName\", \"reverseString\");\n+        sr.add(SOAPAction, reverse);\n+\n+        // invoke the service and verify the result\n+        assertEquals(\"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}, false));\n     }\n \n     /**\n@@ -125,7 +139,7 @@ public void testReverseData() throws Exception {\n         // invoke the service and verify the result\n         Data input    = new Data(5, \"abc\", 3);\n         Data expected = new Data(3, \"cba\", 5);\n-        assertEquals(expected, rpc(\"reverseData\", new Object[] {input}));\n+        assertEquals(expected, rpc(\"reverseData\", new Object[] {input}, true));\n     }\n \n     /**\n@@ -139,6 +153,6 @@ public void testMessageContext() throws Exception {\n         sr.add(SOAPAction, reverse);\n \n         // invoke the service and verify the result\n-        assertEquals(SOAPAction, rpc(\"targetService\", new Object[] {}));\n+        assertEquals(SOAPAction, rpc(\"targetService\", new Object[] {}, true));\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/e41f5285762d6827ef1104a9aee6c324f14084e4/test/RPCDispatch/TestRPC.java",
                "sha": "37be994adb1269ea59a6f6839e82d45751d836bc",
                "status": "modified"
            }
        ],
        "message": "* First cut at the AxisEngine hierarchy\n\nIntroduce an abstract AxisEngine base class, from which both AxisClient\nand AxisServer inherit.  The AxisEngine handles the registries and loading\nengine-wide properties from a properties file (this should migrate to\nXML at some point).  init() has been factored out of both AxisClient and\nAxisServer.\n\nEnable setting default debug level via the properties file.\n\nThe AxisEngine class also has the handler and service registries as first-\nclass member vars, with getters and setters, rather than using the\noption bag for this.  This required various tweaks to classes that wanted\nto use the option bag.\n\n* Add a test to TestRPC to verify that dispatching off the RPC body\n  element QName works\n\n* Fix a potential NPE bug in AxisServlet\n\n* Pull AxisEngine out into a member variable in MessageContext\n\n* Remove the static SOAPTypeMappingRegistry from MessageContext, replace\n  with SOAPTypeMappingRegistry.getSingleton()\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@251992 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/517e101507acee0c050a45a888da4f199c930bc0",
        "repo": "axis1-java",
        "unit_tests": [
            "TestAxisClient.java"
        ]
    },
    "axis1-java_eb35064": {
        "bug_id": "axis1-java_eb35064",
        "commit": "https://github.com/apache/axis1-java/commit/eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/EchoServiceBindingStub.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/EchoServiceBindingStub.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 0,
                "filename": "samples/echo/EchoServiceBindingStub.java",
                "patch": "@@ -62,6 +62,13 @@ public EchoServiceBindingStub(javax.xml.rpc.Service service) throws org.apache.a\n             cachedSerFactories.add(arraysf);\n             cachedDeserFactories.add(arraydf);\n \n+            qName = new javax.xml.rpc.namespace.QName(\"http://soapinterop.org/\", \"ArrayOf_tns2_Map\");\n+            cachedSerQNames.add(qName);\n+            cls = java.util.HashMap[].class;\n+            cachedSerClasses.add(cls);\n+            cachedSerFactories.add(arraysf);\n+            cachedDeserFactories.add(arraydf);\n+\n             qName = new javax.xml.rpc.namespace.QName(\"http://soapinterop.org/xsd\", \"ArrayOfstring\");\n             cachedSerQNames.add(qName);\n             cls = java.lang.String[].class;",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/EchoServiceBindingStub.java",
                "sha": "068742506de01ffd12bb7c49f5bb7008a15fae8a",
                "status": "modified"
            },
            {
                "additions": 54,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/TestClient.java",
                "changes": 192,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/TestClient.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 138,
                "filename": "samples/echo/TestClient.java",
                "patch": "@@ -181,170 +181,106 @@ public void execute2A() throws Exception {\n \n         {\n             String input = \"abccdefg\";\n-            try {\n-                output = binding.echoString(input);\n-                verify(\"echoString\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoString\", input, e);\n-            }\n+            output = binding.echoString(input);\n+            verify(\"echoString\", input, output);\n         }\n         \n         {\n             String[] input = new String[] {\"abc\", \"def\"};\n-            try {\n-                output = binding.echoStringArray(input);\n-                verify(\"echoStringArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStringArray\", input, e);\n-            }\n+            output = binding.echoStringArray(input);\n+            verify(\"echoStringArray\", input, output);\n         }\n         \n         {\n             Integer input = new Integer(42);\n-            try {\n-                output = new Integer( binding.echoInteger(input.intValue()));\n-                verify(\"echoInteger\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoInteger\", input, e);\n-            }\n+            output = new Integer( binding.echoInteger(input.intValue()));\n+            verify(\"echoInteger\", input, output);\n         }\n         \n         {\n             int[] input = new int[] {42};\n-            try {\n-                output = binding.echoIntegerArray(input);\n-                verify(\"echoIntegerArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoIntegerArray\", input, e);\n-            }\n+            output = binding.echoIntegerArray(input);\n+            verify(\"echoIntegerArray\", input, output);\n         }\n         \n         {\n             Float input = new Float(3.7F);\n-            try {\n-                output = new Float(binding.echoFloat(input.floatValue()));\n-                verify(\"echoFloat\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoFloat\", input, e);\n-            }\n+            output = new Float(binding.echoFloat(input.floatValue()));\n+            verify(\"echoFloat\", input, output);\n         }\n \n         {\n             float[] input = new float[] {3.7F, 7F};\n-            try {\n-                output = binding.echoFloatArray(input);\n-                verify(\"echoFloatArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoFloatArray\", input, e);\n-            }\n+            output = binding.echoFloatArray(input);\n+            verify(\"echoFloatArray\", input, output);\n         }\n \n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                output = binding.echoStruct(input);\n-                verify(\"echoStruct\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStruct\", input, e);\n-            }\n+            output = binding.echoStruct(input);\n+            verify(\"echoStruct\", input, output);\n         }\n         \n         {\n             SOAPStruct[] input = new SOAPStruct[] {\n                 new SOAPStruct(1, \"one\", 1.1F),\n                 new SOAPStruct(2, \"two\", 2.2F),\n                 new SOAPStruct(3, \"three\", 3.3F)};\n-            try {\n-                output = binding.echoStructArray(input);\n-                verify(\"echoStructArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStructArray\", input, e);\n-            }\n+            output = binding.echoStructArray(input);\n+            verify(\"echoStructArray\", input, output);\n         }\n \n         {\n-            try {\n-                binding.echoVoid();\n-                verify(\"echoVoid\", null, null);\n-            } catch (Exception e) {\n-                verify(\"echoVoid\", null, e);\n-            }\n+            binding.echoVoid();\n+            verify(\"echoVoid\", null, null);\n         }\n \n         {\n             byte[] input = \"Base64\".getBytes();\n-            try {\n-                output = binding.echoBase64(input);\n-                verify(\"echoBase64\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoBase64\", input, e);\n-            }\n+            output = binding.echoBase64(input);\n+            verify(\"echoBase64\", input, output);\n         }\n         \n         {\n             Hex input = new Hex(\"3344\");\n-            try {\n-                output = binding.echoHexBinary(input.getBytes());\n-                verify(\"echoHexBinary\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoHexBinary\", input, e);\n-            }\n+            output = binding.echoHexBinary(input.getBytes());\n+            verify(\"echoHexBinary\", input, output);\n         }\n         \n         {\n             Date input = new Date();\n-            try {\n-                output = binding.echoDate(input);\n-                verify(\"echoDate\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoDate\", input, e);\n-            }\n+            output = binding.echoDate(input);\n+            verify(\"echoDate\", input, output);\n         }\n         \n         {\n             BigDecimal input = new BigDecimal(\"3.14159\");\n-            try {\n-                output = binding.echoDecimal(input);\n-                verify(\"echoDecimal\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoDecimal\", input, e);\n-            }\n+            output = binding.echoDecimal(input);\n+            verify(\"echoDecimal\", input, output);\n         }\n         \n         {\n             Boolean input = Boolean.TRUE;\n-            try {\n-                output = new Boolean( binding.echoBoolean(input.booleanValue()));\n-                verify(\"echoBoolean\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoBoolean\", input, e);\n-            }\n+            output = new Boolean( binding.echoBoolean(input.booleanValue()));\n+            verify(\"echoBoolean\", input, output);\n         }\n         \n         HashMap map = new HashMap();\n         map.put(new Integer(5), \"String Value\");\n         map.put(\"String Key\", new Date());\n         {\n             HashMap input = map;\n-            try {\n-                output = binding.echoMap(input);\n-                verify(\"echoMap\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoMap\", input, e);\n-            }\n+            output = binding.echoMap(input);\n+            verify(\"echoMap\", input, output);\n         }\n \n         HashMap map2 = new HashMap();\n         map2.put(\"this is the second map\", new Boolean(true));\n         map2.put(\"test\", new Float(411));\n         {\n             HashMap[] input = new HashMap [] {map, map2 };\n-            try {\n-                output = binding.echoMapArray(input);\n-                verify(\"echoMapArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoMapArray\", input, e);\n-            }\n+            output = binding.echoMapArray(input);\n+            verify(\"echoMapArray\", input, output);\n         }\n     }\n \n@@ -356,32 +292,24 @@ public void execute2B() throws Exception {\n         Object output = null;\n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                StringHolder outputString = new StringHolder();\n-                IntHolder outputInteger = new IntHolder();\n-                FloatHolder outputFloat = new FloatHolder();\n-                binding.echoStructAsSimpleTypes(input, outputString, outputInteger, outputFloat);\n-                output = new SOAPStruct(outputInteger.value,\n-                                        outputString.value,\n-                                        outputFloat.value);\n-                verify(\"echoStructAsSimpleTypes\", \n-                       input, output);\n-            } catch (Exception e) {\n-                verify(\"echoStructAsSimpleTypes\", input, e);\n-            }\n+            StringHolder outputString = new StringHolder();\n+            IntHolder outputInteger = new IntHolder();\n+            FloatHolder outputFloat = new FloatHolder();\n+            binding.echoStructAsSimpleTypes(input, outputString, outputInteger, outputFloat);\n+            output = new SOAPStruct(outputInteger.value,\n+                                    outputString.value,\n+                                    outputFloat.value);\n+            verify(\"echoStructAsSimpleTypes\", \n+                   input, output);\n         }\n \n         {\n             SOAPStruct input = new SOAPStruct(5, \"Hello\", 103F);\n-            try {\n-                output = binding.echoSimpleTypesAsStruct(\n-                   input.getVarString(), input.getVarInt(), input.getVarFloat());\n-                verify(\"echoSimpleTypesAsStruct\", \n-                       input, \n-                       output);\n-            } catch (Exception e) {\n-                verify(\"echoSimpleTypesAsStruct\", input, e);\n-            }\n+            output = binding.echoSimpleTypesAsStruct(\n+                    input.getVarString(), input.getVarInt(), input.getVarFloat());\n+            verify(\"echoSimpleTypesAsStruct\", \n+                   input, \n+                   output);\n         }\n \n         {\n@@ -390,39 +318,27 @@ public void execute2B() throws Exception {\n             input[0][1] = \"01\";\n             input[1][0] = \"10\";\n             input[1][1] = \"11\";\n-            try {\n-                output = binding.echo2DStringArray(input);\n-                verify(\"echo2DStringArray\", \n-                       input, \n-                       output);\n-            } catch (Exception e) {\n-                verify(\"echo2DStringArray\", input, e);\n-            }\n+            output = binding.echo2DStringArray(input);\n+            verify(\"echo2DStringArray\", \n+                   input, \n+                   output);\n         }\n \n         {\n             SOAPStructStruct input = new SOAPStructStruct(\"AXIS\",\n                                                           1,\n                                                           3F,\n                                                           new SOAPStruct(5, \"Hello\", 103F));\n-            try {\n-                output = binding.echoNestedStruct(input);\n-                verify(\"echoNestedStruct\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoNestedStruct\", input, e);\n-            }\n+            output = binding.echoNestedStruct(input);\n+            verify(\"echoNestedStruct\", input, output);\n         }\n         {\n             SOAPArrayStruct input = new SOAPArrayStruct(\"AXIS\",\n                                                         1,\n                                                         3F,\n                                                         new String[] {\"one\", \"two\", \"three\"});\n-            try {\n-                output = binding.echoNestedArray(input);\n-                verify(\"echoNestedArray\", input, output);\n-            } catch (Exception e) {\n-                verify(\"echoNestedArray\", input, e);\n-            }\n+            output = binding.echoNestedArray(input);\n+            verify(\"echoNestedArray\", input, output);\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/TestClient.java",
                "sha": "70eb56c80c56cde23f066dcdf7e61fd2d8730554",
                "status": "modified"
            },
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/deploy.wsdd",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/samples/echo/deploy.wsdd?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "samples/echo/deploy.wsdd",
                "patch": "@@ -6,8 +6,9 @@\n <!--   java org.apache.axis.client.http.AdminClient deploy.wsdd  -->\n <!--      after the axis server is running                      -->\n \n- <deployment \tname=\"test\" xmlns=\"http://xml.apache.org/axis/wsdd/\" \n+ <deployment \tname=\"test\" xmlns=\"http://xml.apache.org/axis/wsdd/\"\n \t\t\txmlns:java=\"http://xml.apache.org/axis/wsdd/providers/java\"\n+            xmlns:xsd=\"http://www.w3.org/2000/10/XMLSchema\"\n \t\t\txmlns:xsi=\"http://www.w3.org/2000/10/XMLSchema-instance\">\n   <service name=\"echo\" provider=\"java:RPC\" >\n     <namespace>http://soapinterop.org/</namespace>\n@@ -62,6 +63,14 @@\n         deserializer=\"org.apache.axis.encoding.ser.ArrayDeserializerFactory\"\n         encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\n       />\n+      <typeMapping\n+        xmlns:ns=\"http://soapinterop.org/\"\n+        qname=\"ns:ArrayOf_tns2_Map\"\n+        type=\"java:java.util.HashMap[]\"\n+        serializer=\"org.apache.axis.encoding.ser.ArraySerializerFactory\"\n+        deserializer=\"org.apache.axis.encoding.ser.ArrayDeserializerFactory\"\n+        encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\n+      />\n       <typeMapping\n         xmlns:ns=\"http://soapinterop.org/xsd\"\n         qname=\"ns:SOAPStructStruct\"\n@@ -87,5 +96,13 @@\n         <handler type=\"java:samples.echo.echoHeaderStringHandler\"/>\n         <handler type=\"java:samples.echo.echoHeaderStructHandler\"/>\n     </responseFlow>\n+\n+    <operation name=\"echoStructAsSimpleTypes\">\n+      <parameter name=\"inputStruct\" xmlns:ns=\"http://soapinterop.org/xsd\"\n+                 type=\"ns:SOAPStruct\"/>\n+      <parameter name=\"outputString\" type=\"xsd:string\" mode=\"OUT\"/>\n+      <parameter name=\"outputInteger\" type=\"xsd:int\" mode=\"OUT\"/>\n+      <parameter name=\"outputFloat\" type=\"xsd:float\" mode=\"OUT\"/>\n+    </operation>\n   </service>\n </deployment>",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/samples/echo/deploy.wsdd",
                "sha": "154c22bd0e55e4eabb7a586be9dd215feac00876",
                "status": "modified"
            },
            {
                "additions": 40,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/client/Call.java",
                "changes": 61,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Call.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 21,
                "filename": "src/org/apache/axis/client/Call.java",
                "patch": "@@ -698,7 +698,12 @@ public boolean isParameterAndReturnSpecRequired() {\n      */\n     public void addParameter(QName paramName, QName xmlType,\n             ParameterMode parameterMode) {\n-        addParameter(paramName, xmlType, null, parameterMode);\n+        Class javaType = null;\n+        TypeMapping tm = getTypeMapping();\n+        if (tm != null) {\n+            javaType = tm.getClassForQName(xmlType);\n+        }\n+        addParameter(paramName, xmlType, javaType, parameterMode);\n     }\n \n     /**\n@@ -749,7 +754,12 @@ public void addParameter(QName paramName, QName xmlType,\n      */\n     public void addParameter(String paramName, QName xmlType,\n             ParameterMode parameterMode) {\n-        addParameter(new QName(\"\", paramName), xmlType, null, parameterMode);\n+        Class javaType = null;\n+        TypeMapping tm = getTypeMapping();\n+        if (tm != null) {\n+            javaType = tm.getClassForQName(xmlType);\n+        }\n+        addParameter(new QName(\"\", paramName), xmlType, javaType, parameterMode);\n     }\n \n     /**\n@@ -812,7 +822,11 @@ public QName getParameterTypeByQName(QName paramQName) {\n     public void setReturnType(QName type) {\n         if (parmAndRetReq) {\n             returnType = type ;\n-            if (operation != null) operation.setReturnType(type);\n+            if (operation != null) {\n+                operation.setReturnType(type);\n+                TypeMapping tm = getTypeMapping();\n+                operation.setReturnClass(tm.getClassForQName(type));\n+            }\n         }\n         else {\n             throw new JAXRPCException();\n@@ -1517,6 +1531,22 @@ public void clearHeaders()\n     {\n         myHeaders = null;\n     }\n+    \n+    public TypeMapping getTypeMapping()\n+    {\n+        // Get the TypeMappingRegistry\n+        TypeMappingRegistry tmr = msgContext.getTypeMappingRegistry();\n+\n+        // If a TypeMapping is not available, add one.\n+        TypeMapping tm = (TypeMapping) tmr.getTypeMapping(encodingStyle);\n+        TypeMapping defaultTM = (TypeMapping) tmr.getDefaultTypeMapping();\n+        if (tm == null || tm == defaultTM ) {\n+            tm = (TypeMapping) tmr.createTypeMapping();\n+            tm.setSupportedNamespaces(new String[] {encodingStyle});\n+            tmr.register(encodingStyle, tm);\n+        }\n+        return tm;\n+    }\n \n     /**\n      * Register type mapping information for serialization/deserialization\n@@ -1537,25 +1567,14 @@ public void registerTypeMapping(Class javaType, QName xmlType,\n                                     SerializerFactory sf,\n                                     DeserializerFactory df,\n                                     boolean force) {\n-        // Get the TypeMappingRegistry\n-        TypeMappingRegistry tmr = msgContext.getTypeMappingRegistry();\n-\n-        // If a TypeMapping is not available, add one.\n-        TypeMapping tm = (TypeMapping) tmr.getTypeMapping(encodingStyle);\n-        TypeMapping defaultTM = (TypeMapping) tmr.getDefaultTypeMapping();\n-        try {\n-            if (tm == null || tm == defaultTM ) {\n-                tm = (TypeMapping) tmr.createTypeMapping();\n-                tm.setSupportedNamespaces(new String[] {encodingStyle});\n-                tmr.register(encodingStyle, tm);\n-            }\n-            if (!force && tm.isRegistered(javaType, xmlType))\n-                return;\n-\n-            // Register the information\n-            tm.register(javaType, xmlType, sf, df);\n-        } catch (Exception e) {}\n+        TypeMapping tm = getTypeMapping();\n+        if (!force && tm.isRegistered(javaType, xmlType))\n+            return;\n+        \n+        // Register the information\n+        tm.register(javaType, xmlType, sf, df);\n     }\n+\n     public void registerTypeMapping(Class javaType, QName xmlType,\n                                     Class sfClass, Class dfClass) {\n         registerTypeMapping(javaType, xmlType, sfClass, dfClass, true);",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/client/Call.java",
                "sha": "a2e92732dc9a83cfadb5270dc330fb2fd3be953a",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/client/Service.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/client/Service.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "src/org/apache/axis/client/Service.java",
                "patch": "@@ -548,7 +548,7 @@ public void setTypeMappingRegistry(TypeMappingRegistry registry)\n      * @return TypeMappingRegistry The registry\n      */\n     public TypeMappingRegistry getTypeMappingRegistry() {\n-        return( null );\n+        return( engine.getTypeMappingRegistry() );\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/client/Service.java",
                "sha": "8434eaeaef5a7174f440a5c857487930248b9286",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/deployment/wsdd/WSDDOperation.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 6,
                "filename": "src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "patch": "@@ -110,12 +110,14 @@ public WSDDOperation(Element e, ServiceDesc parent)\n                 throw new WSDDException(JavaUtils.getMessage(\"onlyOneMapping\"));\n             }\n \n-            // Register a mapping from an Element QName to a particular\n-            // method so we can dispatch for doc/lit services.\n-            Element el = mappingElements[0];\n-            String elString = el.getAttribute(\"qname\");\n-            QName elQName = XMLUtils.getQNameFromString(elString, el);\n-            desc.setElementQName(elQName);\n+            if (mappingElements.length > 0) {\n+                // Register a mapping from an Element QName to a particular\n+                // method so we can dispatch for doc/lit services.\n+                Element el = mappingElements[0];\n+                String elString = el.getAttribute(\"qname\");\n+                QName elQName = XMLUtils.getQNameFromString(elString, el);\n+                desc.setElementQName(elQName);\n+            }\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/deployment/wsdd/WSDDOperation.java",
                "sha": "ea47809bca9b50170ec03d027d38bdf9e3a0c611",
                "status": "modified"
            },
            {
                "additions": 41,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/description/OperationDesc.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/OperationDesc.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "src/org/apache/axis/description/OperationDesc.java",
                "patch": "@@ -57,6 +57,7 @@\n import javax.xml.rpc.namespace.QName;\n import java.util.ArrayList;\n import java.util.Iterator;\n+import java.lang.reflect.Method;\n \n /**\n  * An OperationDesc is an abstract description of an operation on a service.\n@@ -83,10 +84,18 @@\n \n     /** The return type */\n     private QName returnType;\n+    \n+    /** The return class */\n+    private Class returnClass;\n+    \n+    // FIXME : Just have a return ParamDesc???\n \n     /** The Java method name this maps to (is this just name?) */\n     private String methodName;\n \n+    /** The actual Java method associated with this operation, if known */\n+    private Method method;\n+\n     /** This operation's style.  If null, we default to our parent's */\n     private Integer style;\n \n@@ -129,6 +138,14 @@ public void setReturnType(QName returnType) {\n         this.returnType = returnType;\n     }\n \n+    public Class getReturnClass() {\n+        return returnClass;\n+    }\n+\n+    public void setReturnClass(Class returnClass) {\n+        this.returnClass = returnClass;\n+    }\n+\n     public QName getElementQName() {\n         return elementQName;\n     }\n@@ -194,6 +211,14 @@ public int getNumParams() {\n         return parameters.size();\n     }\n \n+    public Method getMethod() {\n+        return method;\n+    }\n+\n+    public void setMethod(Method method) {\n+        this.method = method;\n+    }\n+\n     public ParameterDesc getParamByQName(QName qname)\n     {\n         for (Iterator i = parameters.iterator(); i.hasNext();) {\n@@ -211,7 +236,7 @@ public ParameterDesc getInputParamByQName(QName qname)\n \n         param = getParamByQName(qname);\n \n-        if ((param == null) || (param.getMode() != ParameterDesc.IN)) {\n+        if ((param == null) || (param.getMode() == ParameterDesc.OUT)) {\n             param = null;\n         }\n \n@@ -233,10 +258,25 @@ public ParameterDesc getOutputParamByQName(QName qname)\n                 param = new ParameterDesc();\n                 param.setQName(qname);\n                 param.setTypeQName(returnType);\n+                param.setJavaType(returnClass);\n             }\n         }\n \n         return param;\n     }\n+\n+    /**\n+     * Returns an ordered list of out params (NOT inouts)\n+     */\n+    public ArrayList getOutParams() {\n+        ArrayList result = new ArrayList();\n+        for (Iterator i = parameters.iterator(); i.hasNext();) {\n+            ParameterDesc desc = (ParameterDesc) i.next();\n+            if (desc.getMode() == ParameterDesc.OUT) {\n+                result.add(desc);\n+            }\n+        }\n+        return result;\n+    }\n }\n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/description/OperationDesc.java",
                "sha": "97ec1aa8a28007577bea0bdb6db7d0b68295a482",
                "status": "modified"
            },
            {
                "additions": 221,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/description/ServiceDesc.java",
                "changes": 272,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/description/ServiceDesc.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 51,
                "filename": "src/org/apache/axis/description/ServiceDesc.java",
                "patch": "@@ -56,6 +56,7 @@\n \n import org.apache.axis.utils.JavaUtils;\n import org.apache.axis.encoding.TypeMapping;\n+import org.apache.axis.encoding.TypeMappingRegistry;\n \n import javax.xml.rpc.namespace.QName;\n import java.util.ArrayList;\n@@ -114,6 +115,10 @@\n     /** Lookup caches */\n     private HashMap name2OperationsMap = null;\n     private HashMap qname2OperationMap = null;\n+    private HashMap method2OperationMap = new HashMap();\n+    private ArrayList completedNames = new ArrayList();\n+\n+    private TypeMapping tm = null;\n \n     /**\n      * Default constructor\n@@ -159,6 +164,22 @@ public void setAllowedMethods(ArrayList allowedMethods) {\n         this.allowedMethods = allowedMethods;\n     }\n \n+    public Class getImplClass() {\n+        return implClass;\n+    }\n+\n+    public void setImplClass(Class implClass) {\n+        this.implClass = implClass;\n+    }\n+\n+    public TypeMapping getTypeMapping() {\n+        return tm;\n+    }\n+\n+    public void setTypeMapping(TypeMapping tm) {\n+        this.tm = tm;\n+    }\n+\n     public void addOperationDesc(OperationDesc operation)\n     {\n         operations.add(operation);\n@@ -176,38 +197,42 @@ public void addOperationDesc(OperationDesc operation)\n         }\n \n         overloads.add(operation);\n-\n-        // If we're adding these, we won't introspect (either because we\n-        // trust the deployer/user to add everything instead, or because\n-        // we're actually in the middle of introspecting right now)\n-        hasOperationData = true;\n     }\n \n     public OperationDesc [] getOperationsByName(String methodName)\n     {\n+        getSyncedOperationsForName(methodName);\n+\n         if (name2OperationsMap == null)\n             return null;\n \n-        ArrayList result = (ArrayList)name2OperationsMap.get(methodName);\n-        if (result == null)\n+        ArrayList overloads = (ArrayList)name2OperationsMap.get(methodName);\n+        if (overloads == null) {\n             return null;\n+        }\n \n-        OperationDesc [] array = new OperationDesc [result.size()];\n-        return (OperationDesc[])result.toArray(array);\n+        OperationDesc [] array = new OperationDesc [overloads.size()];\n+        return (OperationDesc[])overloads.toArray(array);\n     }\n \n     /**\n      * Return an operation matching the given method name.  Note that if we\n      * have multiple overloads for this method, we will return the first one.\n      */\n-    public OperationDesc getOperationDescByName(String methodName)\n+    public OperationDesc getOperationByName(String methodName)\n     {\n+        // If we need to load up operations from introspection data, do it.\n+        // This returns fast if we don't need to do anything, so it's not very\n+        // expensive.\n+        getSyncedOperationsForName(methodName);\n+\n         if (name2OperationsMap == null)\n             return null;\n \n         ArrayList overloads = (ArrayList)name2OperationsMap.get(methodName);\n-        if (overloads == null)\n+        if (overloads == null) {\n             return null;\n+        }\n \n         return (OperationDesc)overloads.get(0);\n     }\n@@ -219,9 +244,13 @@ public OperationDesc getOperationByElementQName(QName qname)\n     {\n         // If we're a wrapped service (i.e. RPC or WRAPPED style), we expect\n         // this qname to match one of our operation names directly.\n-        // FIXME : Should this really ignore namespaces?\n+\n+        // FIXME : Should this really ignore namespaces?  Perhaps we should\n+        //         just check by QName... (I think that's right, actually,\n+        //         and the only time we should ignore namespaces is when\n+        //         deserializing SOAP-encoded structures?)\n         if (isWrapped()) {\n-            return getOperationDescByName(qname.getLocalPart());\n+            return getOperationByName(qname.getLocalPart());\n         }\n \n         // If we're MESSAGE style, we should only have a single operation,\n@@ -246,55 +275,196 @@ public OperationDesc getOperationByElementQName(QName qname)\n     }\n \n     /**\n-     * Fill in what we can of the service description by introspecting a\n-     * Java class.  Only do this if we haven't already been filled in.\n+     * Synchronize an existing OperationDesc to a java.lang.Method.\n+     *\n+     * This method is used when the deployer has specified operation metadata\n+     * and we want to match that up with a real java Method so that the\n+     * Operation-level dispatch carries us all the way to the implementation.\n+     * Search the declared methods on the implementation class to find one\n+     * with an argument list which matches our parameter list.\n      */\n-    public void loadServiceDescByIntrospection(Class jc, TypeMapping tm)\n+    private void syncOperationToClass(OperationDesc oper)\n     {\n-        if (hasOperationData)\n+        // If we're already mapped to a Java method, no need to do anything.\n+        if (oper.getMethod() != null)\n             return;\n \n-        Method [] methods = jc.getDeclaredMethods();\n+        // Find the method.  We do this once for each Operation.\n+        Method [] methods = implClass.getDeclaredMethods();\n+        for (int i = 0; i < methods.length; i++) {\n+            Method method = methods[i];\n+            if (method.getName().equals(oper.getName())) {\n+                // Check params\n+                Class [] paramTypes = method.getParameterTypes();\n+                if (paramTypes.length != oper.getNumParams())\n+                    continue;\n+\n+                int j;\n+                for (j = 0; j < paramTypes.length; j++) {\n+                    Class type = paramTypes[j];\n+                    ParameterDesc param = oper.getParameter(j);\n+                    // See if they match\n+                    Class paramClass = tm.getClassForQName(\n+                            param.getTypeQName());\n+\n+                    // This is a match if the paramClass is somehow\n+                    // convertable to the \"real\" parameter type.\n+                    if (JavaUtils.isConvertable(paramClass, type)) {\n+                        param.setJavaType(type);\n+                        continue;\n+                    }\n+                    break;\n+                }\n+\n+                if (j != paramTypes.length) {\n+                    // failed.\n+                    continue;\n+                }\n+\n+                // At some point we might want to check here to see if this\n+                // Method is already associated with another Operation, but\n+                // this doesn't seem critital.\n+\n+                oper.setMethod(method);\n+                method2OperationMap.put(method, oper);\n+                return;\n+            }\n+        }\n+    }\n+\n+    /**\n+     * Fill in a service description by introspecting the implementation\n+     * class.\n+     */\n+    public void loadServiceDescByIntrospection()\n+    {\n+        Method [] methods = implClass.getDeclaredMethods();\n \n         for (int i = 0; i < methods.length; i++) {\n-            String methodName = methods[i].getName();\n+            getSyncedOperationsForName(methods[i].getName());\n+        }\n \n-            // Skip it if it's not allowed\n-            // FIXME : This should, if allowedMethods is null, search up the\n-            //         inheritance/interface tree until we get to stop\n-            //         classes?\n-            if ((allowedMethods != null) &&\n-                !allowedMethods.contains(methodName))\n-                continue;\n+        // Setting this to null means there is nothing more to do, and it\n+        // avoids future string compares.\n+        completedNames = null;\n+    }\n \n-            // Make an OperationDesc for each method\n-            Method method = methods[i];\n-            OperationDesc operation = new OperationDesc();\n-            operation.setName(methodName);\n-            Class [] paramTypes = method.getParameterTypes();\n-            String [] paramNames =\n-                    JavaUtils.getParameterNamesFromDebugInfo(method);\n-            for (int k = 0; k < paramTypes.length; k++) {\n-                Class type = paramTypes[k];\n-                ParameterDesc paramDesc = new ParameterDesc();\n-                if (paramNames != null) {\n-                    paramDesc.setName(paramNames[k+1]);\n-                } else {\n-                    paramDesc.setName(\"in\" + k);\n-                }\n-                Class heldClass = JavaUtils.getHolderValueType(type);\n-                if (heldClass != null) {\n-                    paramDesc.setMode(ParameterDesc.INOUT);\n-                    paramDesc.setTypeQName(tm.getTypeQName(heldClass));\n-                } else {\n-                    paramDesc.setMode(ParameterDesc.IN);\n-                    paramDesc.setTypeQName(tm.getTypeQName(type));\n+    /**\n+     * Fill in a service description by introspecting the implementation\n+     * class.  This version takes the implementation class and the in-scope\n+     * TypeMapping.\n+     */\n+    public void loadServiceDescByIntrospection(Class cls, TypeMapping tm)\n+    {\n+        // Should we complain if the implClass changes???\n+        implClass = cls;\n+        this.tm = tm;\n+        loadServiceDescByIntrospection();\n+    }\n+\n+    /**\n+     * Makes sure we have completely synchronized OperationDescs with\n+     * the implementation class.\n+     */\n+    private void getSyncedOperationsForName(String methodName)\n+    {\n+        // If we have no implementation class, don't worry about it (we're\n+        // probably on the client)\n+        if (implClass == null)\n+            return;\n+\n+        // If we're done introspecting, or have completed this method, return\n+        if (completedNames == null || completedNames.contains(methodName))\n+            return;\n+\n+        // Skip it if it's not a sanctioned method name\n+        if ((allowedMethods != null) &&\n+            !allowedMethods.contains(methodName))\n+            return;\n+\n+        // OK, go find any current OperationDescs for this method name and\n+        // make sure they're synced with the actual class.\n+        if (name2OperationsMap != null) {\n+            ArrayList currentOverloads = \n+                    (ArrayList)name2OperationsMap.get(methodName);\n+            if (currentOverloads != null) {\n+                // For each one, sync it to the implementation class' methods\n+                for (Iterator i = currentOverloads.iterator(); i.hasNext();) {\n+                    OperationDesc oper = (OperationDesc) i.next();\n+                    if (oper.getMethod() == null) {\n+                        syncOperationToClass(oper);\n+                    }\n                 }\n-                operation.addParameter(paramDesc);\n             }\n-            addOperationDesc(operation);\n         }\n \n-        hasOperationData = true;\n+        // Now all OperationDescs from deployment data have been completely\n+        // filled in.  So we now make new OperationDescs for any method\n+        // overloads which were not covered above.\n+        Method [] methods = implClass.getDeclaredMethods();\n+\n+        for (int i = 0; i < methods.length; i++) {\n+            Method method = methods[i];\n+            if (method.getName().equals(methodName))\n+                createOperationForMethod(method);\n+        }\n+\n+        // Note that we never have to look at this method name again.\n+        completedNames.add(methodName);\n+    }\n+\n+    /**\n+     * Make an OperationDesc from a Java method.\n+     *\n+     * In the absence of deployment metadata, this code will introspect a\n+     * Method and create an appropriate OperationDesc, using parameter names\n+     * from the bytecode debugging info if available, or \"in0\", \"in1\", etc.\n+     * if not.\n+     */\n+    private void createOperationForMethod(Method method) {\n+        // If we've already got it, never mind\n+        if (method2OperationMap.get(method) != null) {\n+            return;\n+        }\n+\n+        // Make an OperationDesc\n+        OperationDesc operation = new OperationDesc();\n+        operation.setName(method.getName());\n+        operation.setMethod(method);\n+        Class [] paramTypes = method.getParameterTypes();\n+        String [] paramNames =\n+                JavaUtils.getParameterNamesFromDebugInfo(method);\n+\n+        for (int k = 0; k < paramTypes.length; k++) {\n+            Class type = paramTypes[k];\n+            ParameterDesc paramDesc = new ParameterDesc();\n+            // If we have a name for this param, use it, otherwise call\n+            // it \"in*\"\n+            if (paramNames != null) {\n+                paramDesc.setName(paramNames[k+1]);\n+            } else {\n+                paramDesc.setName(\"in\" + k);\n+            }\n+            paramDesc.setJavaType(type);\n+\n+            // If it's a Holder, mark it INOUT and set the type to the\n+            // held type.  Otherwise it's IN with its own type.\n+\n+            Class heldClass = JavaUtils.getHolderValueType(type);\n+            if (heldClass != null) {\n+                paramDesc.setMode(ParameterDesc.INOUT);\n+                paramDesc.setTypeQName(tm.getTypeQName(heldClass));\n+            } else {\n+                paramDesc.setMode(ParameterDesc.IN);\n+                paramDesc.setTypeQName(tm.getTypeQName(type));\n+            }\n+            operation.addParameter(paramDesc);\n+        }\n+\n+        operation.setReturnClass(method.getReturnType());\n+        operation.setReturnType(tm.getTypeQName(method.getReturnType()));\n+\n+        addOperationDesc(operation);\n+        method2OperationMap.put(method, operation);\n     }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/description/ServiceDesc.java",
                "sha": "4de4da4d983f4b3f24b30304b6e27a61e3800583",
                "status": "modified"
            },
            {
                "additions": 78,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "changes": 157,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 79,
                "filename": "src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "patch": "@@ -10,23 +10,23 @@\n  * are met:\n  *\n  * 1. Redistributions of source code must retain the above copyright\n- *    notice, this list of conditions and the following disclaimer. \n+ *    notice, this list of conditions and the following disclaimer.\n  *\n  * 2. Redistributions in binary form must reproduce the above copyright\n  *    notice, this list of conditions and the following disclaimer in\n  *    the documentation and/or other materials provided with the\n  *    distribution.\n  *\n  * 3. The end-user documentation included with the redistribution,\n- *    if any, must include the following acknowledgment:  \n+ *    if any, must include the following acknowledgment:\n  *       \"This product includes software developed by the\n  *        Apache Software Foundation (http://www.apache.org/).\"\n  *    Alternately, this acknowledgment may appear in the software itself,\n  *    if and wherever such third-party acknowledgments normally appear.\n  *\n  * 4. The names \"Axis\" and \"Apache Software Foundation\" must\n  *    not be used to endorse or promote products derived from this\n- *    software without prior written permission. For written \n+ *    software without prior written permission. For written\n  *    permission, please contact apache@apache.org.\n  *\n  * 5. Products derived from this software may not be called \"Apache\",\n@@ -88,29 +88,29 @@\n \n /**\n  * @author Rich Scheuerle (scheu@us.ibm.com)\n- * \n+ *\n  * This is the implementation of the axis Default TypeMapping (which extends\n  * the JAX-RPC TypeMapping interface) for SOAP 1.1.  If you want the JAX-RPC\n  * SOAP 1.2 Type Mapping the use DefaultJAXRPCTypeMapping.\n- * \n+ *\n  * A TypeMapping is obtained from the singleton TypeMappingRegistry using\n  * the namespace of the webservice.  The TypeMapping contains the tuples\n  * {Java type, SerializerFactory, DeserializerFactory, Type QName)\n  *\n- * So if you have a Web Service with the namespace \"XYZ\", you call \n+ * So if you have a Web Service with the namespace \"XYZ\", you call\n  * the TypeMappingRegistry.getTypeMapping(\"XYZ\").\n  *\n  * The wsdl in your web service will use a number of types.  The tuple\n  * information for each of these will be accessed via the TypeMapping.\n  *\n- * Because every web service uses the soap, schema, wsdl primitives, we could \n+ * Because every web service uses the soap, schema, wsdl primitives, we could\n  * pre-populate the TypeMapping with these standard tuples.  Instead, if requested\n  * namespace/class matches is not found in the TypeMapping but matches one these\n  * known primitives, the request is delegated to this Default TypeMapping.\n- * \n+ *\n  */\n-public class DefaultTypeMappingImpl extends TypeMappingImpl { \n-    \n+public class DefaultTypeMappingImpl extends TypeMappingImpl {\n+\n     private static DefaultTypeMappingImpl tm = null;\n     /**\n      * Construct TypeMapping\n@@ -128,45 +128,45 @@ protected DefaultTypeMappingImpl() {\n \n         // Notes:\n         // 1) The registration statements are order dependent.  The last one\n-        //    wins.  So if two javaTypes of String are registered, the \n+        //    wins.  So if two javaTypes of String are registered, the\n         //    ser factory for the last one registered will be chosen.  Likewise\n-        //    if two javaTypes for XSD_DATE are registered, the deserializer \n+        //    if two javaTypes for XSD_DATE are registered, the deserializer\n         //    factory for the last one registered will be chosen.\n         //    Corollary:  Please be very careful with the order.  The\n         //                runtime, Java2WSDL and WSDL2Java emitters all\n         //                use this code to get type mapping information.\n-        // 2) Even if the SOAP 1.1 format is used over the wire, an \n+        // 2) Even if the SOAP 1.1 format is used over the wire, an\n         //    attempt is made to receive SOAP 1.2 format from the wire.\n-        //    This is the reason why the soap encoded primitives are \n+        //    This is the reason why the soap encoded primitives are\n         //    registered without serializers.\n \n-        // SOAP Encoded strings are treated as primitives. \n+        // SOAP Encoded strings are treated as primitives.\n         // Everything else is not.\n         // Note that only deserializing is supported since we are flowing\n         // SOAP 1.1 over the wire.\n-        myRegister(Constants.SOAP_STRING,     java.lang.String.class,   \n-                   null, null, true,  true); \n-        myRegister(Constants.SOAP_BOOLEAN,    java.lang.Boolean.class, \n+        myRegister(Constants.SOAP_STRING,     java.lang.String.class,\n+                   null, null, true,  true);\n+        myRegister(Constants.SOAP_BOOLEAN,    java.lang.Boolean.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_DOUBLE,     java.lang.Double.class,  \n+        myRegister(Constants.SOAP_DOUBLE,     java.lang.Double.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_FLOAT,      java.lang.Float.class,  \n+        myRegister(Constants.SOAP_FLOAT,      java.lang.Float.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_INT,        java.lang.Integer.class,   \n+        myRegister(Constants.SOAP_INT,        java.lang.Integer.class,\n                    null, null, false, true);\n         myRegister(Constants.SOAP_INTEGER,    java.math.BigInteger.class,\n                    null, null, false, true);\n         myRegister(Constants.SOAP_DECIMAL,    java.math.BigDecimal.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_LONG,       java.lang.Long.class,     \n+        myRegister(Constants.SOAP_LONG,       java.lang.Long.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_SHORT,      java.lang.Short.class,   \n+        myRegister(Constants.SOAP_SHORT,      java.lang.Short.class,\n                    null, null, false, true);\n-        myRegister(Constants.SOAP_BYTE,       java.lang.Byte.class,     \n+        myRegister(Constants.SOAP_BYTE,       java.lang.Byte.class,\n                    null, null, false, true);\n \n         // Hex binary data needs to use the hex binary serializer/deserializer\n-        myRegister(Constants.XSD_HEXBIN,     Hex.class,   \n+        myRegister(Constants.XSD_HEXBIN,     Hex.class,\n                    new HexSerializerFactory(\n                         Hex.class, Constants.XSD_HEXBIN),\n                    new HexDeserializerFactory(\n@@ -182,62 +182,62 @@ protected DefaultTypeMappingImpl() {\n         // Byte[] -ser-> array of Byte\n         // XSD_BASE64 -deser-> byte[]\n         // SOAP_BASE64 -deser->byte[]\n-        myRegister(Constants.SOAP_BASE64,     byte[].class, \n-                   new Base64SerializerFactory(byte[].class,\n+        myRegister(Constants.SOAP_BASE64,     Byte[].class,\n+                   new Base64SerializerFactory(Byte[].class,\n                                                Constants.SOAP_BASE64 ),\n-                   new Base64DeserializerFactory(byte[].class,\n+                   new Base64DeserializerFactory(Byte[].class,\n                                                  Constants.SOAP_BASE64),\n-                   true, true);      \n-        myRegister(Constants.SOAP_ARRAY,     java.lang.Byte[].class,       \n-                   new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(),true);\n-        myRegister(Constants.XSD_BASE64,     byte[].class,                                   \n+                   true);\n+//        myRegister(Constants.SOAP_ARRAY,     java.lang.Byte[].class,\n+//                   new ArraySerializerFactory(),\n+//                   new ArrayDeserializerFactory(),true);\n+        myRegister(Constants.XSD_BASE64,     byte[].class,\n                    new Base64SerializerFactory(byte[].class,\n                                                Constants.XSD_BASE64 ),\n                    new Base64DeserializerFactory(byte[].class,\n                                            Constants.XSD_BASE64),true);\n \n         // If SOAP 1.1 over the wire, map wrapper classes to XSD primitives.\n-        myRegister(Constants.XSD_STRING,     java.lang.String.class, \n-                   null, null, true); \n-        myRegister(Constants.XSD_BOOLEAN,    java.lang.Boolean.class, \n+        myRegister(Constants.XSD_STRING,     java.lang.String.class,\n+                   null, null, true);\n+        myRegister(Constants.XSD_BOOLEAN,    java.lang.Boolean.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_DOUBLE,     java.lang.Double.class,  \n+        myRegister(Constants.XSD_DOUBLE,     java.lang.Double.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_FLOAT,      java.lang.Float.class,  \n+        myRegister(Constants.XSD_FLOAT,      java.lang.Float.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_INT,        java.lang.Integer.class, \n+        myRegister(Constants.XSD_INT,        java.lang.Integer.class,\n                    null, null, true);\n         myRegister(Constants.XSD_INTEGER,    java.math.BigInteger.class,\n                    null, null, true);\n         myRegister(Constants.XSD_DECIMAL,    java.math.BigDecimal.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_LONG,       java.lang.Long.class,     \n+        myRegister(Constants.XSD_LONG,       java.lang.Long.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_SHORT,      java.lang.Short.class, \n+        myRegister(Constants.XSD_SHORT,      java.lang.Short.class,\n                    null, null, true);\n-        myRegister(Constants.XSD_BYTE,       java.lang.Byte.class,  \n+        myRegister(Constants.XSD_BYTE,       java.lang.Byte.class,\n                    null, null, true);\n \n         // The XSD Primitives are mapped to java primitives.\n-        myRegister(Constants.XSD_BOOLEAN,    boolean.class,        \n+        myRegister(Constants.XSD_BOOLEAN,    boolean.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_DOUBLE,     double.class,         \n+        myRegister(Constants.XSD_DOUBLE,     double.class,\n                    null, null,true);\n         myRegister(Constants.XSD_FLOAT,      float.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_INT,        int.class,  \n+        myRegister(Constants.XSD_INT,        int.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_LONG,       long.class, \n+        myRegister(Constants.XSD_LONG,       long.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_SHORT,      short.class, \n+        myRegister(Constants.XSD_SHORT,      short.class,\n                    null, null,true);\n-        myRegister(Constants.XSD_BYTE,       byte.class, \n+        myRegister(Constants.XSD_BYTE,       byte.class,\n                    null, null,true);\n \n \n         // Map QNAME to the jax rpc QName class\n-        myRegister(Constants.XSD_QNAME,      \n+        myRegister(Constants.XSD_QNAME,\n               javax.xml.rpc.namespace.QName.class,\n               new BeanSerializerFactory(javax.xml.rpc.namespace.QName.class,\n                                         Constants.XSD_QNAME),\n@@ -246,21 +246,21 @@ protected DefaultTypeMappingImpl() {\n                    true);\n \n         // The closest match for anytype is Object\n-        myRegister(Constants.XSD_ANYTYPE,    java.lang.Object.class,  \n+        myRegister(Constants.XSD_ANYTYPE,    java.lang.Object.class,\n                    null, null, false);\n \n-        // The xsd primitive for date has changed through the various \n+        // The xsd primitive for date has changed through the various\n         // namespace versions.\n-        // XSD_DATE is the current one, which is why it is \n+        // XSD_DATE is the current one, which is why it is\n         // registered after the other two\n-        myRegister(Constants.XSD_DATE2,      java.util.Date.class,                           \n-                   new DateSerializerFactory(java.util.Date.class, \n+        myRegister(Constants.XSD_DATE2,      java.util.Date.class,\n+                   new DateSerializerFactory(java.util.Date.class,\n                                              Constants.XSD_DATE2),\n                    new DateDeserializerFactory(java.util.Date.class,\n                                                Constants.XSD_DATE2),\n                    true);\n-        myRegister(Constants.XSD_DATE3,      java.util.Date.class,                           \n-                   new DateSerializerFactory(java.util.Date.class, \n+        myRegister(Constants.XSD_DATE3,      java.util.Date.class,\n+                   new DateSerializerFactory(java.util.Date.class,\n                                              Constants.XSD_DATE3),\n                    new DateDeserializerFactory(java.util.Date.class,\n                                                Constants.XSD_DATE3),\n@@ -280,48 +280,47 @@ protected DefaultTypeMappingImpl() {\n \n         // Serialize all extensions of Map to SOAP_MAP\n         // The SOAP_MAP will be deserialized into a HashMap by default.\n-        myRegister(Constants.SOAP_MAP,       java.util.HashMap.class,    \n+        myRegister(Constants.SOAP_MAP,       java.util.HashMap.class,\n                    new MapSerializerFactory(java.util.Map.class,\n                                             Constants.SOAP_MAP),\n                    new MapDeserializerFactory(java.util.HashMap.class,\n                                               Constants.SOAP_MAP),\n                    false);\n-        myRegister(Constants.SOAP_MAP,       java.util.Map.class,    \n+        myRegister(Constants.SOAP_MAP,       java.util.Map.class,\n                    new MapSerializerFactory(java.util.Map.class,\n                                             Constants.SOAP_MAP),\n-                   new MapDeserializerFactory(java.util.HashMap.class,\n-                                              Constants.SOAP_MAP),\n+                   null,  // Make sure not to override the deser mapping\n                    false);\n \n         // Use the Element Serializeration for elements\n-        myRegister(Constants.SOAP_ELEMENT,   org.w3c.dom.Element.class,    \n+        myRegister(Constants.SOAP_ELEMENT,   org.w3c.dom.Element.class,\n                    new ElementSerializerFactory(),\n                    new ElementDeserializerFactory(), false);\n-        myRegister(Constants.SOAP_VECTOR,    java.util.Vector.class,                                \n+        myRegister(Constants.SOAP_VECTOR,    java.util.Vector.class,\n                    new VectorSerializerFactory(java.util.Vector.class,\n-                                               Constants.SOAP_VECTOR), \n+                                               Constants.SOAP_VECTOR),\n                    new VectorDeserializerFactory(java.util.Vector.class,\n-                                                 Constants.SOAP_VECTOR), \n+                                                 Constants.SOAP_VECTOR),\n                    false);\n \n         // All array objects automatically get associated with the SOAP_ARRAY.\n-        // There is no way to do this with a hash table, \n+        // There is no way to do this with a hash table,\n         // so it is done directly in getTypeQName.\n         // Internally the runtime uses ArrayList objects to hold arrays...\n-        // which is the reason that ArrayList is associated with SOAP_ARRAY.  \n+        // which is the reason that ArrayList is associated with SOAP_ARRAY.\n         // In addition, handle all objects that implement the List interface\n         // as a SOAP_ARRAY\n-        myRegister(Constants.SOAP_ARRAY,     java.util.List.class,               \n+        myRegister(Constants.SOAP_ARRAY,     java.util.List.class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n-        myRegister(Constants.SOAP_ARRAY,     java.util.ArrayList.class,               \n+        myRegister(Constants.SOAP_ARRAY,     java.util.ArrayList.class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n-        myRegister(Constants.SOAP_ARRAY,     Object[].class,               \n+        myRegister(Constants.SOAP_ARRAY,     Object[].class,\n                    new ArraySerializerFactory(),\n-                   new ArrayDeserializerFactory(), \n+                   new ArrayDeserializerFactory(),\n                    false);\n     }\n \n@@ -334,14 +333,14 @@ protected DefaultTypeMappingImpl() {\n      * @param df is the deser factory (if null, the simple factory is used)\n      * @param primitive indicates whether serializers can be shared\n      * @param onlyDeserFactory indicates if only deserialization is desired.\n-     */   \n+     */\n     protected void myRegister(QName xmlType, Class javaType,\n                               SerializerFactory sf, DeserializerFactory df,\n                               boolean primitive) {\n         myRegister(xmlType, javaType, sf, df, primitive, false);\n     }\n     protected void myRegister(QName xmlType, Class javaType,\n-                              SerializerFactory sf, DeserializerFactory df, \n+                              SerializerFactory sf, DeserializerFactory df,\n                               boolean primitive, boolean onlyDeserFactory) {\n \n         // If factories are not specified, use the Simple ser/deser factories.\n@@ -362,7 +361,7 @@ protected void myRegister(QName xmlType, Class javaType,\n         if (onlyDeserFactory) {\n             sf = null;\n         }\n-        \n+\n         // Register all known flavors of the namespace.\n         try {\n             if (xmlType.getNamespaceURI().equals(\n@@ -381,7 +380,7 @@ else if (xmlType.getNamespaceURI().equals(\n                     super.register(javaType, qName, sf, df);\n                 }\n             }\n-            // Register with the specified xmlType. \n+            // Register with the specified xmlType.\n             // This is the prefered mapping and the last registed one wins\n             super.register(javaType, xmlType, sf, df);\n         } catch (Exception e) {}\n@@ -407,10 +406,10 @@ public QName getTypeQName(Class javaType) {\n \n     // Don't allow anyone to muck with the default type mapping because\n     // it is a singleton used for the whole system.\n-    public void register(Class javaType, QName xmlType, \n+    public void register(Class javaType, QName xmlType,\n                          javax.xml.rpc.encoding.SerializerFactory sf,\n-                         javax.xml.rpc.encoding.DeserializerFactory dsf) \n-        throws JAXRPCException {        \n+                         javax.xml.rpc.encoding.DeserializerFactory dsf)\n+        throws JAXRPCException {\n \n         throw new JAXRPCException();\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/DefaultTypeMappingImpl.java",
                "sha": "ec67e078701c248c7ca8400075ab302502f3a5e5",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/TypeMappingImpl.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/TypeMappingImpl.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 2,
                "filename": "src/org/apache/axis/encoding/TypeMappingImpl.java",
                "patch": "@@ -243,8 +243,12 @@ public void register(Class javaType, QName xmlType,\n         }\n         Pair pair = new Pair(javaType, xmlType);\n \n-        qName2Pair.put(xmlType, pair);\n-        class2Pair.put(javaType, pair);   \n+        // Only register the appropriate mappings.\n+        if ((dsf != null) || (qName2Pair.get(xmlType) == null))\n+            qName2Pair.put(xmlType, pair);\n+        if ((sf != null) || (class2Pair.get(javaType) == null))\n+            class2Pair.put(javaType, pair);   \n+        \n         pair2SF.put(pair, sf);\n         pair2DF.put(pair, dsf);\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/TypeMappingImpl.java",
                "sha": "70f7d82e9196dbbc7a99033645f771067c5037e3",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 17,
                "filename": "src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "patch": "@@ -102,23 +102,7 @@ public SimpleDeserializerFactory(Class javaType, QName xmlType) {\n                     javaType.getDeclaredConstructor(new Class [] {String.class});\n             }\n             else {\n-                Class wrapper = null;\n-                if (javaType == int.class)\n-                    wrapper = java.lang.Integer.class;\n-                else if (javaType == short.class)\n-                    wrapper = java.lang.Short.class;\n-                else if (javaType == boolean.class)\n-                    wrapper = java.lang.Boolean.class;\n-                else if (javaType == byte.class)\n-                    wrapper = java.lang.Byte.class;\n-                else if (javaType == long.class)\n-                    wrapper = java.lang.Long.class;\n-                else if (javaType == double.class)\n-                    wrapper = java.lang.Double.class;\n-                else if (javaType == float.class)\n-                    wrapper = java.lang.Float.class;\n-                else if (javaType == char.class)\n-                    wrapper = java.lang.Character.class;\n+                Class wrapper = JavaUtils.getWrapperClass(javaType);\n                 if (wrapper != null)\n                     constructor = \n                         wrapper.getDeclaredConstructor(new Class [] {String.class});",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/encoding/ser/SimpleDeserializerFactory.java",
                "sha": "a49aaa47e25afd5fd743ff4e7aa2e944bfd6cf3c",
                "status": "modified"
            },
            {
                "additions": 27,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/message/RPCElement.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCElement.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 27,
                "filename": "src/org/apache/axis/message/RPCElement.java",
                "patch": "@@ -66,6 +66,7 @@\n import org.apache.axis.handlers.soap.SOAPService;\n import org.apache.axis.utils.cache.ClassCache;\n import org.apache.axis.utils.cache.JavaClass;\n+import org.apache.axis.utils.JavaUtils;\n import org.apache.axis.wsdl.toJava.Utils;\n import org.xml.sax.Attributes;\n import org.xml.sax.SAXException;\n@@ -158,36 +159,34 @@ public void deserialize() throws SAXException\n         if (service != null) {\n             ServiceDesc serviceDesc = service.getServiceDescription();\n \n-            // If we don't have a service description, create one\n-            // via introspection and cache it in the SOAPService.\n-            String clsName = (String)service.getOption(\"className\");\n-\n-            if (clsName != null) {\n-                ClassLoader cl       = msgContext.getClassLoader();\n-                ClassCache cache     = msgContext.getAxisEngine().\n-                        getClassCache();\n-                JavaClass       jc   = null;\n-                try {\n-                    jc = cache.lookup(clsName, cl);\n-                } catch (ClassNotFoundException e) {\n-                    throw new SAXException(e);\n+            if (serviceDesc.getImplClass() == null) {\n+                String clsName = (String)service.getOption(\"className\");\n+\n+                if (clsName != null) {\n+                    ClassLoader cl       = msgContext.getClassLoader();\n+                    ClassCache cache     = msgContext.getAxisEngine().\n+                            getClassCache();\n+                    JavaClass       jc   = null;\n+                    try {\n+                        jc = cache.lookup(clsName, cl);\n+                    } catch (ClassNotFoundException e) {\n+                        throw new SAXException(e);\n+                    }\n+                    TypeMapping tm = (TypeMapping)msgContext.\n+                            getTypeMappingRegistry().\n+                            getTypeMapping(msgContext.getEncodingStyle());\n+                    serviceDesc.setTypeMapping(tm);\n+                    serviceDesc.setImplClass(jc.getJavaClass());\n                 }\n-                TypeMapping tm = (TypeMapping)msgContext.\n-                        getTypeMappingRegistry().\n-                        getTypeMapping(msgContext.getEncodingStyle());\n-                serviceDesc.loadServiceDescByIntrospection(jc.getJavaClass(),\n-                                                           tm);\n             }\n \n-            if (serviceDesc != null) {\n-                // If we've got a service description now, we want to use\n-                // the matching operations in there.\n-                operations = serviceDesc.getOperationsByName(name);\n+            // If we've got a service description now, we want to use\n+            // the matching operations in there.\n+            operations = serviceDesc.getOperationsByName(name);\n \n-                if (operations == null) {\n-                    String lc = Utils.xmlNameToJava(name);\n-                    operations = serviceDesc.getOperationsByName(lc);\n-                }\n+            if (operations == null) {\n+                String lc = Utils.xmlNameToJava(name);\n+                operations = serviceDesc.getOperationsByName(lc);\n             }\n         }\n \n@@ -225,7 +224,8 @@ public void deserialize() throws SAXException\n \n                         publishToHandler((org.xml.sax.ContentHandler) context);\n \n-                        // Success!!\n+                        // Success!!  This is the right one...\n+                        msgContext.setOperation(myOperation);\n                         return;\n                     } catch (SAXException e) {\n                         // If there was a problem, try the next one.",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/message/RPCElement.java",
                "sha": "d1e817be5b9dd550b6c68d1775b0b76db9836847",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/message/RPCHandler.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/message/RPCHandler.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 3,
                "filename": "src/org/apache/axis/message/RPCHandler.java",
                "patch": "@@ -193,11 +193,18 @@ public SOAPHandler onStartChild(String namespace,\n \n                 if (type == null) {\n                     type = paramDesc.getTypeQName();\n+                } else if (paramDesc.getJavaType() != null) {\n+                    // If we have an xsi:type, make sure it makes sense\n+                    // with the current paramDesc type\n+                    Class xsiClass = \n+                            context.getTypeMapping().getClassForQName(type);\n+                    if (!JavaUtils.isConvertable(xsiClass,\n+                                                 paramDesc.getJavaType())) {\n+                        throw new SAXException(\"Bad types (\" +\n+                            xsiClass + \" -> \" + paramDesc.getJavaType() + \")\"); // FIXME!\n+                    }\n                 }\n             }\n-\n-            // FIXME : We should check here to make sure any specified\n-            // xsi:type jibes with the expected type in the ParamDesc!!\n         }\n \n ",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/message/RPCHandler.java",
                "sha": "1f95e0238482f9076de12620adabac631ad3b73e",
                "status": "modified"
            },
            {
                "additions": 95,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/providers/java/RPCProvider.java",
                "changes": 286,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/providers/java/RPCProvider.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 191,
                "filename": "src/org/apache/axis/providers/java/RPCProvider.java",
                "patch": "@@ -73,6 +73,7 @@\n import org.apache.commons.logging.LogFactory;\n \n import javax.xml.rpc.namespace.QName;\n+import javax.xml.rpc.holders.Holder;\n import java.lang.reflect.Method;\n import java.lang.reflect.InvocationTargetException;\n import java.util.StringTokenizer;\n@@ -121,6 +122,11 @@ public void processMessage (MessageContext msgContext,\n         for ( int bNum = 0 ; bNum < bodies.size() ; bNum++ ) {\n             RPCElement   body;\n \n+            // If this is a regular old SOAPBodyElement, and it's a root,\n+            // we're probably a non-wrapped doc/lit service.  In this case,\n+            // we deserialize the element, and create an RPCElement \"wrapper\"\n+            // around it which points to the correct method.\n+            // FIXME : There should be a cleaner way to do this...\n             if (!(bodies.get(bNum) instanceof RPCElement)) {\n                 SOAPBodyElement bodyEl = (SOAPBodyElement)bodies.get(bNum);\n                 if (bodyEl.isRoot() && operation != null) {\n@@ -136,20 +142,48 @@ public void processMessage (MessageContext msgContext,\n                 body = (RPCElement) bodies.get( bNum );\n             }\n \n-            String       mName      = body.getMethodName();\n-            Vector       args       = body.getParams();\n-            Object[]     argValues  =  null ;\n+            String methodName = body.getMethodName();\n+            Vector args = body.getParams();\n+            int numArgs = args.size();\n \n+            // This may have changed, so get it again...\n+            // FIXME (there should be a cleaner way to do this)\n+            operation = msgContext.getOperation();\n \n+            if (operation == null) {\n+                QName qname = new QName(body.getNamespaceURI(),\n+                                        body.getName());\n+                operation = serviceDesc.getOperationByElementQName(qname);\n+            }\n+\n+            // Create the array we'll use to hold the actual parameter\n+            // values.  We know how big to make it from the metadata.\n+            Object[]     argValues  =  new Object [operation.getNumParams()];\n+\n+            // A place to keep track of the out params (INOUTs and OUTs)\n+            ArrayList outs = new ArrayList();\n+\n+            // Put the values contained in the RPCParams into an array\n+            // suitable for passing to java.lang.reflect.Method.invoke()\n+            // Make sure we respect parameter ordering if we know about it\n+            // from metadata, and handle whatever conversions are necessary\n+            // (values -> Holders, etc)\n             if ( args != null && args.size() > 0 ) {\n-                argValues = new Object[ args.size()];\n-                for ( int i = 0 ; i < args.size() ; i++ ) {\n+                for ( int i = 0 ; i < numArgs ; i++ ) {\n                     RPCParam rpcParam = (RPCParam)args.get(i);\n+                    Object value = rpcParam.getValue();\n                     ParameterDesc paramDesc = rpcParam.getParamDesc();\n+                    if (paramDesc != null && paramDesc.getJavaType() != null) {\n+                        value = JavaUtils.convert(value,\n+                                                  paramDesc.getJavaType());\n+                        rpcParam.setValue(value);\n+                        if (paramDesc.getMode() == ParameterDesc.INOUT)\n+                            outs.add(rpcParam);\n+                    }\n                     if (paramDesc == null || paramDesc.getOrder() == -1) {\n-                        argValues[i]  = rpcParam.getValue() ;\n+                        argValues[i]  = value;\n                     } else {\n-                        argValues[paramDesc.getOrder()] = rpcParam.getValue();\n+                        argValues[paramDesc.getOrder()] = value;\n                     }\n \n                     if (log.isDebugEnabled()) {\n@@ -160,185 +194,69 @@ public void processMessage (MessageContext msgContext,\n             }\n \n             // Check if we can find a Method by this name\n-            checkMethodName(msgContext, allowedMethods, mName);\n-\n-            // Get the actual method to invoke.\n-            int\tnumberOfBodyArgs = args.size();\n-            Method[] methods = getMethod(msgContext, jc, mName);\n-\n-            // If the method wasn't found, maybe it needs some Java mangling (ie., it's a Java\n-            // keyword or it's capitalized and the java mapping requires lowercase).\n-            if (methods == null) {\n-                mName = JavaUtils.xmlNameToJava(mName);\n-                methods = getMethod(msgContext, jc, mName);\n-            }\n-\n-            if ( methods == null )\n-                throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"noMethod00\", mName, msgContext.getTargetService()),\n-                        null, null );\n-\n-            Object objRes = null;\n-            Class[] params = null;\n-            Exception ex = null;\n-\n-            // There might be more than one method with this name, try them all.\n-            int index = 0;\n-            for (index = 0; index < methods.length; index++) {\n-                Method method = methods[index];\n-                ex = null;\n-                params = method.getParameterTypes();\n-\n-                // Don't bother with this one if it has FEWER params\n-                if (argValues != null) {\n-                    if (params.length < argValues.length)\n-                        continue;\n-                }\n-\n-                // The number of method parameters must match the\n-                // arguments taking into consideration output parameters.\n-                Object[] newArgValues = new Object[params.length];\n-                int old = 0;\n-                boolean problem = false;\n-                for (int n = 0; n < newArgValues.length; n++) {\n-                    Class heldType = JavaUtils.getHolderValueType(params[n]);\n-                    if (argValues != null && old < argValues.length) {\n-                        newArgValues[n] = argValues[old++];\n-                    } else if (heldType == null) {\n-                        // The parameters that don't match the argValues must\n-                        // be Holders.  Indicate problem occurred.\n-                        problem = true;\n+            // FIXME : Shouldn't this type of thing have already occurred?\n+            checkMethodName(msgContext, allowedMethods, methodName);\n+\n+            // Now create any out holders we need to pass in\n+            if (numArgs < argValues.length) {\n+                ArrayList outParams = operation.getOutParams();\n+                for (int i = 0; i < outParams.size(); i++) {\n+                    ParameterDesc param = (ParameterDesc)outParams.get(i);\n+                    Class holderClass = param.getJavaType();\n+                    if (Holder.class.isAssignableFrom(holderClass)) {\n+                        argValues[numArgs + i] = holderClass.newInstance();\n+                        // Store an RPCParam in the outs collection so we\n+                        // have an easy and consistent way to write these\n+                        // back to the client below\n+                        outs.add(new RPCParam(param.getQName(),\n+                                              argValues[numArgs + i]));\n                     } else {\n-                        newArgValues[n] = null;\n-                    }\n-                    // Create holders for each argument that is null that should be a holder\n-                    if (newArgValues[n] == null && heldType != null) {\n-                        newArgValues[n] = JavaUtils.convert(newArgValues[n], params[n]);\n-                    }\n-                }\n-                if (!problem) {\n-                    argValues = newArgValues;  // Use newArgValues array if no problems\n-                }\n-\n-                // Invoke the method and capture the returned object.\n-                // Note that if the method returns a primitive, invoke(...) automatically\n-                // wraps it in a java.lang class representing the primitive.\n-                try {\n-                    objRes = invokeMethod(msgContext, method, obj, argValues);\n-                    break;\n-                } catch (IllegalArgumentException e) {\n-                    // Hm - maybe we can help this with a conversion or two...\n-                    for (int i = 0; argValues != null && i < argValues.length &&\n-                      i < params.length; i++) {\n-                        Object thisArg = argValues[i];\n-                        if (!params[i].isAssignableFrom(thisArg.getClass())) {\n-                            // Attempt conversion for each non-assignable argument\n-                            Object newArg = JavaUtils.convert(thisArg, params[i]);\n-                            if (newArg != thisArg)\n-                                argValues[i] = newArg;\n-                        }\n-                    }\n-\n-                    // OK, now try again...\n-                    try {\n-                        objRes = invokeMethod(msgContext, method, obj, argValues);\n-                        break;\n-                    } catch (IllegalArgumentException exp) {\n-                        StringBuffer argbuf = new StringBuffer();\n-                        String sep= \"\";\n-                        for(int i = 0; argValues != null &&\n-                          i < argValues.length; ++i) {\n-                            argbuf.append(sep);\n-                            sep = \", \";\n-                            argbuf.append(argValues[i] == null ? \"null\" : argValues[i].getClass().getName());\n-                        }\n-                        String objName = obj == null ? \"null\" :\n-                          obj.getClass().getName();\n-                        String msg = JavaUtils.getMessage(\"triedArgs00\",\n-                                new String[] {\n-                                exp.getMessage(),\n-                                objName,\n-                                method.getName(),\n-                                argbuf.toString()});\n-                        ex = new IllegalArgumentException(msg);\n-                        continue;\n+                        // !!! Throw a fault here?\n                     }\n                 }\n             }\n-            // If we've gone through all methods with the given name and there's\n-            // an exception left over, throw that exception.\n-            if (ex != null) {\n-                throw ex;\n-            }\n-\n-            // If we've finished iterating through all the methods, throw an exception.\n-            if ( index == methods.length )\n-                throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"noMethod00\", mName, msgContext.getTargetService()),\n-                        null, null );\n \n-            if (log.isDebugEnabled())\n-                log.debug(JavaUtils.getMessage(\"result00\", \"\" + objRes));\n+            // OK!  Now we can invoke the method\n+            Object objRes = operation.getMethod().invoke(obj, argValues);\n \n             /* Now put the result in the result SOAPEnvelope */\n             /*************************************************/\n-            RPCElement resBody = new RPCElement(mName + \"Response\");\n+            RPCElement resBody = new RPCElement(methodName + \"Response\");\n             resBody.setPrefix( body.getPrefix() );\n             resBody.setNamespaceURI( body.getNamespaceURI() );\n             resBody.setEncodingStyle(msgContext.getEncodingStyle());\n \n-            if ( objRes != null ) {\n-                // In the old skeleton a param list was returned, which\n-                // contained the RPC params.  Preserve this for now.\n-                if (objRes instanceof ParamList) {\n-                    ParamList list = (ParamList)objRes;\n-                    for (int i = 0; i < list.size (); ++i) {\n-                        if (list.get (i) instanceof RPCParam) {\n-                            resBody.addParam ((RPCParam) list.get (i));\n-                        }\n-                        else {\n-                            resBody.addParam (new RPCParam (getParameterName(obj, methods[index],i, mName),\n-                                                            list.get (i)));\n-                        }\n-                    }\n-                }\n-                else {\n-                    QName returnQName = getReturnQName(serviceDesc, mName);\n-                    RPCParam param = new RPCParam(returnQName, objRes);\n-                    resBody.addParam(param);\n+            // Return first\n+            if ( operation.getMethod().getReturnType() != Void.TYPE ) {\n+                QName returnQName = operation.getReturnQName();\n+                if (returnQName == null) {\n+                    returnQName = new QName(\"\", methodName + \"Return\");\n                 }\n-            } else if (methods[index].getReturnType() != Void.TYPE) {\n-                QName returnQName = getReturnQName(serviceDesc, mName);\n                 RPCParam param = new RPCParam(returnQName, objRes);\n                 resBody.addParam(param);\n             }\n \n-            // The new skeleton (or no skeleton code) requires the runtime\n-            // to recognize holders and automatically pass back the outputs.\n-            for (int i=0; i < argValues.length; i++) {\n-                Class heldType = JavaUtils.getHolderValueType(params[i]);\n-                if (heldType != null) {\n-                    // Create an RPCParam by converting the Holder back into\n-                    // the held type.\n-                    resBody.addParam (new RPCParam (getParameterName(obj,\n-                                                                     methods[index],\n-                                                                     i,\n-                                                                     mName,\n-                                                                     args),\n-                                                    JavaUtils.convert(\n-                                                            argValues[i],\n-                                                            heldType)));\n+            // Then any other out params\n+            if (!outs.isEmpty()) {\n+                for (Iterator i = outs.iterator(); i.hasNext();) {\n+                    // We know this has a holder, so just unwrap the value\n+                    RPCParam param = (RPCParam) i.next();\n+                    Holder holder = (Holder)param.getValue();\n+                    param.setValue(JavaUtils.getHolderValue(holder));\n+                    resBody.addParam(param);\n                 }\n             }\n \n-            resEnv.addBodyElement( resBody );\n+            resEnv.addBodyElement(resBody);\n         }\n     }\n \n-    protected Method[] getMethod(MessageContext msgContext, JavaClass jc, String mName)\n+    protected Method[] getMethod(MessageContext msgContext,\n+                                 JavaClass jc,\n+                                 String methodName)\n         throws Exception\n     {\n-        return jc.getMethod(mName);\n+        return jc.getMethod(methodName);\n     }\n \n     protected Object invokeMethod(MessageContext msgContext,\n@@ -349,47 +267,51 @@ protected Object invokeMethod(MessageContext msgContext,\n         return (method.invoke(obj, argValues));\n     }\n \n-    protected void checkMethodName(MessageContext msgContext, String allowedMethods, String mName)\n+    protected void checkMethodName(MessageContext msgContext,\n+                                   String allowedMethods,\n+                                   String methodName)\n         throws Exception\n     {\n         String methodNameMatch = allowedMethods;\n \n         // allowedMethods may be a comma-delimited string of method names.\n-        // If so, look for the one matching mname.\n+        // If so, look for the one matching methodName.\n         if (allowedMethods != null && allowedMethods.indexOf(' ') != -1) {\n             StringTokenizer tok = new StringTokenizer(allowedMethods, \" \");\n             String nextMethodName = null;\n             while (tok.hasMoreElements()) {\n                 String token = tok.nextToken();\n-                if (token.equals(mName)) {\n+                if (token.equals(methodName)) {\n                     nextMethodName = token;\n                     break;\n                 }\n             }\n             // didn't find a matching one...\n             if (nextMethodName == null) {\n                 throw new AxisFault( \"AxisServer.error\",\n-                        JavaUtils.getMessage(\"namesDontMatch00\", mName, allowedMethods),\n+                        JavaUtils.getMessage(\"namesDontMatch00\", methodName,\n+                                             allowedMethods),\n                         null, null );  // should they??\n             }\n             methodNameMatch = nextMethodName;\n         }\n \n-        if ( methodNameMatch != null && !methodNameMatch.equals(mName) )\n+        if ( methodNameMatch != null && !methodNameMatch.equals(methodName) )\n             throw new AxisFault( \"AxisServer.error\",\n                     JavaUtils.getMessage(\"namesDontMatch01\",\n-                        new String[] {mName, methodNameMatch, allowedMethods}),\n+                        new String[] {methodName, methodNameMatch,\n+                                      allowedMethods}),\n                     null, null );  // should they??\n \n         if (log.isDebugEnabled()) {\n-            log.debug( \"mName: \" + mName );\n+            log.debug( \"methodName: \" + methodName );\n             log.debug( \"MethodNameMatch: \" + methodNameMatch );\n             log.debug( \"MethodName List: \" + allowedMethods );\n         }\n \n         ///////////////////////////////////////////////////////////////\n         // If allowedMethods (i.e. methodNameMatch) is null,\n-        //  then treat it as a wildcard automatically matching mName\n+        //  then treat it as a wildcard automatically matching methodName\n         ///////////////////////////////////////////////////////////////\n         return;\n     }\n@@ -402,8 +324,8 @@ protected void checkMethodName(MessageContext msgContext, String allowedMethods,\n     protected QName getParameterName(Object obj,\n                                       Method method,\n                                       int i,\n-                                      String mName) {\n-        return getParameterName(obj, method, i, mName, null);\n+                                      String methodName) {\n+        return getParameterName(obj, method, i, methodName, null);\n     }\n \n     /**\n@@ -416,7 +338,7 @@ protected QName getParameterName(Object obj,\n     protected QName getParameterName(Object obj,\n                                       Method method,\n                                       int i,\n-                                      String mName,\n+                                      String methodName,\n                                       Vector rpcParams) {\n         QName parmName = null;\n         // Emitter skeletons keep track of the parameter names\n@@ -427,28 +349,10 @@ protected QName getParameterName(Object obj,\n                 if (rpcParams != null && rpcParams.size() > i) {\n                     parmName = ((RPCParam)rpcParams.get(i)).getQName();\n                 } else {\n-                    parmName = new QName(\"\", mName + \"Result\" + i);\n+                    parmName = new QName(\"\", methodName + \"Result\" + i);\n                 }\n             }\n         }\n         return parmName;\n     }\n-\n-    protected QName getReturnQName(ServiceDesc service, String methodName)\n-    {\n-        QName ret = null;\n-\n-        if (service != null) {\n-            OperationDesc oper = service.getOperationDescByName(methodName);\n-            if (oper != null) {\n-                ret = oper.getReturnQName();\n-            }\n-        }\n-\n-        if (ret == null) {\n-            ret = new QName(\"\", methodName + \"Result\");\n-        }\n-\n-        return ret;\n-    }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/providers/java/RPCProvider.java",
                "sha": "92110a9b190c717c1c39f7aa93db409078ed28f5",
                "status": "modified"
            },
            {
                "additions": 109,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/utils/JavaUtils.java",
                "changes": 109,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/utils/JavaUtils.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 0,
                "filename": "src/org/apache/axis/utils/JavaUtils.java",
                "patch": "@@ -92,6 +92,50 @@\n {\n     protected static Log log =\n         LogFactory.getLog(JavaUtils.class.getName());\n+    \n+    public static Class getWrapperClass(Class primitive)\n+    {\n+        if (primitive == int.class)\n+            return java.lang.Integer.class;\n+        else if (primitive == short.class)\n+            return java.lang.Short.class;\n+        else if (primitive == boolean.class)\n+            return java.lang.Boolean.class;\n+        else if (primitive == byte.class)\n+            return java.lang.Byte.class;\n+        else if (primitive == long.class)\n+            return java.lang.Long.class;\n+        else if (primitive == double.class)\n+            return java.lang.Double.class;\n+        else if (primitive == float.class)\n+            return java.lang.Float.class;\n+        else if (primitive == char.class)\n+            return java.lang.Character.class;\n+        \n+        return null;\n+    }\n+    \n+    public static Class getPrimitiveClass(Class wrapper)\n+    {\n+        if (wrapper == java.lang.Integer.class)\n+            return int.class;\n+        else if (wrapper == java.lang.Short.class)\n+            return short.class;\n+        else if (wrapper == java.lang.Boolean.class)\n+            return boolean.class;\n+        else if (wrapper == java.lang.Byte.class)\n+            return byte.class;\n+        else if (wrapper == java.lang.Long.class)\n+            return long.class;\n+        else if (wrapper == java.lang.Double.class)\n+            return double.class;\n+        else if (wrapper == java.lang.Float.class)\n+            return float.class;\n+        else if (wrapper == java.lang.Character.class)\n+            return char.class;\n+        \n+        return null;\n+    }\n \n     /**\n      * Cache of tt-bytecode BCClass objects which correspond to particular\n@@ -132,6 +176,10 @@ public static Object convert(Object arg, Class destClass)\n         if (destClass == null) {\n             return arg;\n         }\n+        \n+        if (arg != null && destClass.isAssignableFrom(arg.getClass())) {\n+            return arg;\n+        }\n \n         if (log.isDebugEnabled()) {\n             String clsName = \"null\";\n@@ -294,7 +342,68 @@ else if (List.class.isAssignableFrom(destClass)) {\n         return destValue;\n     }\n \n+    public static boolean isConvertable(Object obj, Class dest)\n+    {\n+        Class src = null;\n+        \n+        if (obj != null) {\n+            if (obj instanceof Class) {\n+                src = (Class)obj;\n+            } else {\n+                src = obj.getClass();\n+            }\n+        }\n+        \n+        if (dest == null)\n+            return false;\n+        \n+        if (src != null) {\n+            // If we're directly assignable, we're good.\n+            if (dest.isAssignableFrom(src))\n+                return true;\n+\n+            // If it's a wrapping conversion, we're good.\n+            if (getWrapperClass(src) == dest)\n+                return true;\n+            if (getWrapperClass(dest) == src)\n+                return true;\n+            \n+            // If it's List -> Array or vice versa, we're good.\n+            if ((List.class.isAssignableFrom(src) || src.isArray()) &&\n+                (List.class.isAssignableFrom(dest) || dest.isArray()))\n+                return true;\n+            \n+            if ((src == Hex.class && dest == byte[].class) ||\n+                (src == byte[].class && dest == Hex.class))\n+                return true;\n+            \n+        }\n+        \n+        Class destHeld = JavaUtils.getHolderValueType(dest);\n+        // Can always convert a null to an empty holder\n+        if (src == null)\n+            return (destHeld != null);\n+        \n+        if (destHeld != null) {\n+            if (destHeld.isAssignableFrom(src) || isConvertable(src, destHeld))\n+                return true;\n+        }\n+\n+//        // FIXME : This is a horrible hack put in here to deal with a problem\n+//        // with our default typemappings.\n+//        if (destHeld != null && (getPrimitiveClass(destHeld) == src))\n+//            return true;\n+\n+        // If it's holder -> held or held -> holder, we're good\n+        Class srcHeld = JavaUtils.getHolderValueType(src);\n+        if (srcHeld != null) {\n+            if (dest.isAssignableFrom(srcHeld) || isConvertable(srcHeld, dest))\n+                return true;\n+        }\n \n+        return false;\n+    }\n+    \n     /**\n      * These are java keywords as specified at the following URL (sorted alphabetically).\n      * http://java.sun.com/docs/books/jls/second_edition/html/lexical.doc.html#229308",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/utils/JavaUtils.java",
                "sha": "31c96094ff83329305eb2dd191595c7fe32c67bc",
                "status": "modified"
            },
            {
                "additions": 77,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "changes": 103,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 26,
                "filename": "src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "patch": "@@ -87,7 +87,9 @@\n     /**\n      * Constructor.\n      */\n-    protected JavaDeployWriter(Emitter emitter, Definition definition, SymbolTable symbolTable) {\n+    protected JavaDeployWriter(Emitter emitter, \n+                               Definition definition, \n+                               SymbolTable symbolTable) {\n         super(emitter,\n                 new QName(definition.getTargetNamespace(), \"deploy\"),\n                 \"\",\n@@ -119,7 +121,8 @@ protected void writeFileBody() throws IOException {\n     protected void writeDeployServices() throws IOException {\n         //deploy the ports on each service\n         Map serviceMap = definition.getServices();\n-        for (Iterator mapIterator = serviceMap.values().iterator(); mapIterator.hasNext();) {\n+        for (Iterator mapIterator = serviceMap.values().iterator(); \n+             mapIterator.hasNext();) {\n             Service myService = (Service) mapIterator.next();\n \n             pw.println();\n@@ -128,9 +131,12 @@ protected void writeDeployServices() throws IOException {\n                     + \" -->\");\n             pw.println();\n \n-            for (Iterator portIterator = myService.getPorts().values().iterator(); portIterator.hasNext();) {\n+            for (Iterator portIterator = myService.getPorts().values().iterator();\n+                 portIterator.hasNext();) {\n                 Port myPort = (Port) portIterator.next();\n-                BindingEntry bEntry =  symbolTable.getBindingEntry(myPort.getBinding().getQName());\n+                BindingEntry bEntry = \n+                        symbolTable.getBindingEntry(\n+                                myPort.getBinding().getQName());\n \n                 // If this isn't an SOAP binding, skip it\n                 if (bEntry.getBindingType() != BindingEntry.TYPE_SOAP) {\n@@ -177,7 +183,8 @@ protected void writeDeployTypes(boolean hasLiteral) throws IOException {\n             if (localPart.startsWith(SymbolTable.ANON_TOKEN)) {\n                 localPart = localPart.substring(1);\n             }\n-            QName qName = new QName(type.getQName().getNamespaceURI(), localPart);\n+            QName qName = new QName(type.getQName().getNamespaceURI(), \n+                                    localPart);\n \n             if (process) {\n                 pw.println(\"      <typeMapping\");\n@@ -276,30 +283,64 @@ protected void writeDeployBinding(Binding binding) throws IOException {\n             // interested in the return type for now.\n             Parameters params =\n                     symbolTable.getOperationParameters(operation, \"\", bEntry);\n-            if (params.returnType instanceof DefinedElement) {\n-                QName returnQName = params.returnType.getQName();\n-                pw.println(\"      <operation name=\\\"\" + operation.getName() +\n-                         \"\\\" returnQName=\\\"retNS:\" +\n-                         returnQName.getLocalPart() +\n-                         \"\\\" xmlns:retNS=\\\"\" +\n-                         returnQName.getNamespaceURI() +\n-                         \"\\\">\");\n-\n-                // map doc/lit elements to this operation\n-                Map parts = operation.getInput().getMessage().getParts();\n-                if (!parts.isEmpty()) {\n-                    Iterator i = parts.values().iterator();\n-                    Part p = (Part) i.next();\n-                    QName elementQName = p.getElementName();\n-                    String ns = elementQName.getNamespaceURI();\n-                    pw.println(\"        <elementMapping xmlns:ns=\\\"\" +\n-                            ns + \"\\\" element=\\\"ns:\" +\n-                            elementQName.getLocalPart() + \"\\\"/>\");\n+            String operName = JavaUtils.xmlNameToJava(operation.getName());\n+            if (params != null) {\n+                if (params.returnType instanceof DefinedElement) {\n+                    QName returnQName = params.returnType.getQName();\n+                    pw.println(\"      <operation name=\\\"\" + operName +\n+                             \"\\\" returnQName=\\\"retNS:\" +\n+                             returnQName.getLocalPart() +\n+                             \"\\\" xmlns:retNS=\\\"\" +\n+                             returnQName.getNamespaceURI() +\n+                             \"\\\">\");\n+\n+                    // map doc/lit elements to this operation\n+                    Map parts = operation.getInput().getMessage().getParts();\n+                    if (!parts.isEmpty()) {\n+                        Iterator i = parts.values().iterator();\n+                        Part p = (Part) i.next();\n+                        QName elementQName = p.getElementName();\n+                        String ns = elementQName.getNamespaceURI();\n+                        pw.println(\"        <elementMapping xmlns:ns=\\\"\" +\n+                                   ns + \"\\\" element=\\\"ns:\" +\n+                                   elementQName.getLocalPart() + \"\\\"/>\");\n+                    }\n+                } else {\n+                    pw.println(\"      <operation name=\\\"\" + \n+                               operName + \"\\\">\");\n                 }\n-\n+                \n+                Vector paramList = params.list;\n+                for (int i = 0; i < paramList.size(); i++) {\n+                    Parameter param = (Parameter) paramList.elementAt(i);\n+                    QName paramQName = param.getQName();\n+                    TypeEntry typeEntry = param.getType();\n+                    QName paramType;\n+                    if (typeEntry instanceof DefinedElement) {\n+                        Node node = symbolTable.getTypeEntry(typeEntry.getQName(), true).getNode();\n+                        paramType = Utils.getNodeTypeRefQName(node, \"type\");\n+                        if (paramType == null)\n+                            paramType = typeEntry.getQName(); // FIXME\n+                    } else {\n+                        paramType = typeEntry.getQName();\n+                    }\n+                    String mode = getModeString(param.getMode());\n+                    pw.print(\"        <parameter \");\n+                    if (paramQName == null || \"\".equals(paramQName.getLocalPart())) {\n+                        pw.print(\"name=\\\"\" + param.getName() + \"\\\" \" );\n+                    } else {\n+                        pw.print(\"qname=\\\"pns:\" + paramQName.getLocalPart() +\n+                                 \"\\\" xmlns:pns=\\\"\" + paramQName.getNamespaceURI() +\n+                                 \"\\\" \");\n+                    }\n+                    pw.print(\"type=\\\"tns:\" + paramType.getLocalPart() + \"\\\" \" );\n+                    pw.print(\"xmlns:tns=\\\"\" + paramType.getNamespaceURI() + \"\\\" \" );\n+                    pw.print(\"mode=\\\"\" + mode + \"\\\"\" );\n+                    pw.println(\"/>\");\n+                }\n+                \n                 pw.println(\"      </operation>\");\n             }\n-\n         }\n \n         pw.print(\"      <parameter name=\\\"allowedMethods\\\" value=\\\"\");\n@@ -321,4 +362,14 @@ else if (emitter.getScope() == Emitter.SESSION_SCOPE) {\n         }\n     } //writeDeployBinding\n \n+    public String getModeString(byte mode)\n+    {\n+        if (mode == Parameter.IN) {\n+            return \"IN\";\n+        } else if (mode == Parameter.INOUT) {\n+            return \"INOUT\";\n+        } else {\n+            return \"OUT\";\n+        }\n+    }\n } // class JavaDeployWriter",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/src/org/apache/axis/wsdl/toJava/JavaDeployWriter.java",
                "sha": "7276262e57085df87def3ddd6195e995e2dc1031",
                "status": "modified"
            },
            {
                "additions": 29,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/RPCDispatch/TestRPC.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestRPC.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 11,
                "filename": "test/RPCDispatch/TestRPC.java",
                "patch": "@@ -6,6 +6,8 @@\n import org.apache.axis.Handler;\n import org.apache.axis.Message;\n import org.apache.axis.MessageContext;\n+import org.apache.axis.encoding.TypeMapping;\n+import org.apache.axis.description.ServiceDesc;\n import org.apache.axis.providers.java.RPCProvider;\n import org.apache.axis.configuration.SimpleProvider;\n import org.apache.axis.handlers.soap.SOAPService;\n@@ -76,11 +78,7 @@ private final Object rpc(String method, Object[] parms)\n         envelope.addBodyElement(body);\n \n         // Invoke the Axis engine\n-        try {\n-            engine.invoke(msgContext);\n-        } catch (AxisFault af) {\n-            return af;\n-        }\n+        engine.invoke(msgContext);\n \n         // Extract the response Envelope\n         Message message = msgContext.getResponseMessage();\n@@ -110,6 +108,9 @@ public void testReverseString() throws Exception {\n         reverse.setOption(\"className\", \"test.RPCDispatch.Service\");\n         reverse.setOption(\"allowedMethods\", \"reverseString\");\n         provider.deployService(new QName(null,SOAPAction), reverse);\n+        ServiceDesc serviceDesc = reverse.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)reverse.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertEquals(\"Did not reverse the string correctly.\", \"cba\", rpc(\"reverseString\", new Object[] {\"abc\"}));\n@@ -124,6 +125,9 @@ public void testReverseData() throws Exception {\n         reverse.setOption(\"className\", \"test.RPCDispatch.Service\");\n         reverse.setOption(\"allowedMethods\", \"reverseData\");\n         provider.deployService(new QName(null, SOAPAction), reverse);\n+        ServiceDesc serviceDesc = reverse.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)reverse.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         Data input    = new Data(5, \"abc\", 3);\n@@ -140,6 +144,9 @@ public void testMessageContextImplicit() throws Exception {\n         tgtSvc.setOption(\"className\", \"test.RPCDispatch.Service\");\n         tgtSvc.setOption(\"allowedMethods\", \"targetServiceImplicit\");\n         provider.deployService(new QName(null, SOAPAction), tgtSvc);\n+        ServiceDesc serviceDesc = tgtSvc.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)tgtSvc.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertEquals(\"SOAP Action did not equal the targetService.\", \n@@ -155,6 +162,9 @@ public void testNull() throws Exception {\n         echoInt.setOption(\"className\", \"test.RPCDispatch.Service\");\n         echoInt.setOption(\"allowedMethods\", \"echoInt\");\n         provider.deployService(new QName(null, SOAPAction), echoInt);\n+        ServiceDesc serviceDesc = echoInt.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)echoInt.getTypeMappingRegistry().getDefaultTypeMapping());\n \n         // invoke the service and verify the result\n         assertNull(\"The result was not null as expected.\", rpc(\"echoInt\", new Object[] {null}));\n@@ -169,13 +179,20 @@ public void testSimpleFault() throws Exception {\n         simpleFault.setOption(\"className\", \"test.RPCDispatch.Service\");\n         simpleFault.setOption(\"allowedMethods\", \"simpleFault\");\n         provider.deployService(new QName(null, SOAPAction), simpleFault);\n+        ServiceDesc serviceDesc = simpleFault.getServiceDescription();\n+        serviceDesc.loadServiceDescByIntrospection(test.RPCDispatch.Service.class,\n+                                                   (TypeMapping)simpleFault.getTypeMappingRegistry().getDefaultTypeMapping());\n+\n+        try {\n+            rpc(\"simpleFault\", new Object[] {\"foobar\"});\n+        } catch (AxisFault result) {\n+            assertEquals(\"faultString was not set correctly.\",\n+                \"test.RPCDispatch.Service$TestFault: foobar\",\n+                result.getFaultString());\n+            return;\n+        }\n \n-        Object result = rpc(\"simpleFault\", new Object[] {\"foobar\"});\n-        assertTrue(\"Did not get a fault as expected.\", \n-           result instanceof AxisFault);\n-        AxisFault fault = (AxisFault) result;\n-        assertEquals(\"faultString was not set correctly.\", \n-            \"test.RPCDispatch.Service$TestFault: foobar\", fault.getFaultString());\n+        fail(\"Did not get an expected fault!\");\n     }\n \n     public static void main(String args[])\n@@ -184,6 +201,7 @@ public static void main(String args[])\n         TestRPC tester = new TestRPC(\"RPC test\");\n         tester.testReverseString();\n         tester.testReverseData();\n+          tester.testSimpleFault();\n       } catch (Exception e) {\n         e.printStackTrace();\n       }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/RPCDispatch/TestRPC.java",
                "sha": "a9fbd8dd6fcae17cdd57b1a6dd41c1a108b78517",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/RPCDispatch/TestSerializedRPC.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/RPCDispatch/TestSerializedRPC.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "test/RPCDispatch/TestSerializedRPC.java",
                "patch": "@@ -83,7 +83,7 @@ public TestSerializedRPC(String name) throws Exception {\n         // be testing parameter dispatch by name, so if debug info isn't\n         // compiled into the Service class, the names are going to be \"in0\",\n         // etc.  Make sure they match.\n-        OperationDesc oper = desc.getOperationDescByName(\"concatenate\");\n+        OperationDesc oper = desc.getOperationByName(\"concatenate\");\n         assertNotNull(oper);\n         \n         firstParamName = oper.getParameter(0).getName();",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/RPCDispatch/TestSerializedRPC.java",
                "sha": "69a86b09822ab7fd4c2f033cc1fa499271bcaeab",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/encoding/TestSer.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/encoding/TestSer.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 9,
                "filename": "test/encoding/TestSer.java",
                "patch": "@@ -33,8 +33,7 @@\n     public static void main(String [] args) throws Exception\n     {\n         TestSer tester = new TestSer(\"TestSer\");\n-        tester.testDataNoHrefs();\n-        tester.testDataWithHrefs();\n+        tester.testRPCElement();\n     }\n     \n     public TestSer(String name) {\n@@ -105,14 +104,18 @@ public void doTestData (boolean multiref) throws Exception {\n     /**\n      * Test RPC element serialization when we have no MessageContext\n      */\n-    public void testRPCElement() throws Exception\n+    public void testRPCElement()\n     {\n-        SOAPEnvelope env = new SOAPEnvelope();\n-        RPCElement method = new RPCElement(\"ns\",\n-                                           \"method\",\n-                                           new Object [] { \"argument\" });\n-        env.addBodyElement(method);\n-        String soapStr = env.toString();\n+        try {\n+            SOAPEnvelope env = new SOAPEnvelope();\n+            RPCElement method = new RPCElement(\"ns\",\n+                                               \"method\",\n+                                               new Object [] { \"argument\" });\n+            env.addBodyElement(method);\n+            String soapStr = env.toString();\n+        } catch (Exception e) {\n+            fail(e.getMessage());\n+        }\n \n         // If there was no exception, we succeeded in serializing it.\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/encoding/TestSer.java",
                "sha": "abd73945985dabc7778dcabea1cbe1af528a86d6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "patch": "@@ -42,7 +42,7 @@\n         }\n         return in;\n     }\n-    public java.util.Map testMapFooArray(java.util.Map map)\n+    public java.util.HashMap testMapFooArray(java.util.HashMap map)\n         throws java.rmi.RemoteException {\n         return map;\n     }",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/wsdl/marrays/MArrayTestsSOAPBindingImpl.java",
                "sha": "011a8ff27e26fcd052d75cffac34fd804e0d0e13",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/axis1-java/blob/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/wsdl/marrays/MArrayTestsServiceTestCase.java?ref=eb35064a8e4b4cbb1985779c10d8a833e1eabf94",
                "deletions": 1,
                "filename": "test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "patch": "@@ -131,7 +131,7 @@ public void testMArrayTests() {\n \n         try {\n             // Test 3F: Some of the Foo elements are multi-referenced.   \n-            Map map = new HashMap();\n+            HashMap map = new HashMap();\n             Foo[] array = new Foo[1];\n             array[0] = new Foo();\n             array[0].setValue(123);",
                "raw_url": "https://github.com/apache/axis1-java/raw/eb35064a8e4b4cbb1985779c10d8a833e1eabf94/test/wsdl/marrays/MArrayTestsServiceTestCase.java",
                "sha": "0abc2cdd81544a19304d056414665a4e8a65812b",
                "status": "modified"
            }
        ],
        "message": "Improvements / cleanup of the RPC infrastructure + service metadata.  Still\nneeds some work, but this is much more like it.  Need to implement some edge-\ncase tests for this code.\n\nDetails:\n\n* Fix NPE in WSDDOperation - there can be 0 elementMappings\n\n* Slight change in TypeMappingImpl to only override the qname or class\n  mapping for a registered type mapping if there is a serializer/deserializer\n  present OR if there is no other mapping registered in that direction.\n\n* Mapping from xmlsoap:Map is now to HashMap, not Map.  We still happily\n  serialize any Map to an xmlsoap:Map, but the deser mapping goes to the\n  concrete class.\n\n* Add \"isConvertable()\" method to JavaUtils.\n\n* ServiceDesc is now much smarter about introspecting.  We introspect once\n  for each method that we're interested in, and methods which never get called\n  typically won't ever get introspected for.\n\n* Implement \"synchronizing\" OperationDescs which have been generated from\n  deployment (WSDD) info with an implementation class on the server.  This\n  means if we have a service with this deployment info:\n      <service...>\n         <operation name=\"method\">\n            <parameter name=\"a\" type=\"xsd:string\" mode=\"IN\"/>\n            <parameter name=\"b\" type=\"xsd:string\" mode=\"INOUT\"/>\n            <parameter name=\"c\" type=\"xsd:string\" mode=\"OUT\"/>\n         </operation>\n      </service>\n\n  ...and a method on the implementation class which looks like this:\n\n      public void method(String a, StringHolder b, StringHolder c)\n\n  we will match the two together, recording the correct Java classes for\n  the parameters in the ParameterDescs, and keeping a pointer to the Method\n  in the OperationDesc.  See next couple of bullets for why this is cool.\n\n* RPCProvider method search + dispatch code is now *much* cleaner.  We rely\n  on \"early binding\" to dispatch to the correct method via a ServiceDesc,\n  so by the time we've deserialized the RPCElement successfully, we know\n  exactly which OperationDesc (and hence which Java Method) we're dealing with.\n  That enables us to simply set up the parameters and call it.\n\n* RPCHandler now checks any actually received xsi:types against what is\n  expected/desired by the appropriate ParameterDesc, and throws a fault\n  if it can't map them.\n\n* RPCElement doesn't try to introspect every time anymore, it just makes sure\n  the ServiceDesc has the right typemapping and implementation class if\n  appropriate.  Then getOperationsByName() will introspect if necessary.\n\n* JavaDeployWriter now writes out <parameter> information into the WSDD\n\n* Put in missing mapping in samples/echo service, and put an <operation>\n  into the deploy.wsdd so we get the OUT parameters right for\n  echoStructAsSimpleTypes()\n\n* Enable accessing a Call's TypeMapping via getTypeMapping() - relies on the\n  encodingStyle being set correctly.\n\n* Remove various try/catch blocks which were obscuring exceptions in tests.\n  Tests in general should throw exceptions (and their associated stack traces)\n  instead of eating them, unless there's a good reason to eat them.\n\n* Move code which understands primitives/wrappers into JavaUtils, since it's\n  generally handy\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@253872 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/3a06d02575fb0a681377e717a148d8f4cac44ab0",
        "repo": "axis1-java",
        "unit_tests": [
            "TestCall.java",
            "TestService.java",
            "TestServiceDesc.java",
            "TestJavaUtils.java"
        ]
    },
    "axis1-java_f5930ea": {
        "bug_id": "axis1-java_f5930ea",
        "commit": "https://github.com/apache/axis1-java/commit/f5930ea20e2677317246bff6a70ec697d7c5f1a8",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/axis1-java/blob/f5930ea20e2677317246bff6a70ec697d7c5f1a8/src/org/apache/axis/types/Token.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/src/org/apache/axis/types/Token.java?ref=f5930ea20e2677317246bff6a70ec697d7c5f1a8",
                "deletions": 1,
                "filename": "src/org/apache/axis/types/Token.java",
                "patch": "@@ -101,7 +101,10 @@ public Token(String stValue) throws IllegalArgumentException {\n      */\n     public boolean isValid(String stValue) {\n         int scan;\n-\n+        // check to see if we have a string to review\n+        if (  (stValue == null) || (stValue.length() == 0)  )\n+            return true;\n+            \n         // no leading space\n         if (stValue.charAt(0) == 0x20)\n             return false;",
                "raw_url": "https://github.com/apache/axis1-java/raw/f5930ea20e2677317246bff6a70ec697d7c5f1a8/src/org/apache/axis/types/Token.java",
                "sha": "7713ed565d4c87c47baf6880ea79ff3ef5198e33",
                "status": "modified"
            },
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/axis1-java/blob/f5930ea20e2677317246bff6a70ec697d7c5f1a8/test/types/TestToken.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/axis1-java/contents/test/types/TestToken.java?ref=f5930ea20e2677317246bff6a70ec697d7c5f1a8",
                "deletions": 0,
                "filename": "test/types/TestToken.java",
                "patch": "@@ -152,4 +152,18 @@ public void testStringWithLeadingAndTrailingSpaces() throws Exception {\n     public void testDoubleSpace() throws Exception {\n         runFailTest(\"a   B\"); // note: \\r fails\n     }\n+    \n+    /**\n+     * Test an empty string\n+     */\n+    public void testEmptyString() throws Exception {\n+        runPassTest(\"\"); \n+    }\n+    \n+    /**\n+     * Test an empty string\n+     */\n+    public void testNull() throws Exception {\n+        runPassTest(null); \n+    }\n }",
                "raw_url": "https://github.com/apache/axis1-java/raw/f5930ea20e2677317246bff6a70ec697d7c5f1a8/test/types/TestToken.java",
                "sha": "1f6cec42077d4da7d7760902d3ac6c1ed2f071cc",
                "status": "modified"
            }
        ],
        "message": "fix NPE if value of token is empty string\nPR:19592\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/axis1/trunk/java@256180 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/axis1-java/commit/0e1be749680b42da64d3dda310ab38a749049ddb",
        "repo": "axis1-java",
        "unit_tests": [
            "TestToken.java"
        ]
    }
}