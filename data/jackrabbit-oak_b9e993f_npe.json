[
    {
        "repo": "jackrabbit-oak",
        "commit": "https://github.com/apache/jackrabbit-oak/commit/b9e993fdabdbdc4ad2b941d4294904f2cdb072c1",
        "bug_id": "jackrabbit-oak_b9e993f",
        "message": "OAK-4830: StringUtils.estimateMemoryUsage() can throw NullPointerException\n\nApplied patch by Matt Ryan\n\ngit-svn-id: https://svn.apache.org/repos/asf/jackrabbit/oak/trunk@1761696 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/jackrabbit-oak/commit/9e413148245ca23bb71f959362a0936af0e25624",
        "patched_files": [
            "StringUtils.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/b9e993fdabdbdc4ad2b941d4294904f2cdb072c1/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/StringUtils.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/StringUtils.java?ref=b9e993fdabdbdc4ad2b941d4294904f2cdb072c1",
                "filename": "oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/StringUtils.java",
                "deletions": 1,
                "sha": "f7a8cfb85ef884523f7bdfa87157164b114f2062",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/b9e993fdabdbdc4ad2b941d4294904f2cdb072c1/oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/StringUtils.java",
                "patch": "@@ -87,6 +87,6 @@ private static int getHexDigit(String s, int i) {\n      * @return the estimated memory usage.\n      */\n     public static int estimateMemoryUsage(String s) {\n-        return 48 + s.length() * 2;\n+        return s == null ? 0 : 48 + s.length() * 2;\n     }\n }",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 15,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/b9e993fdabdbdc4ad2b941d4294904f2cdb072c1/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/StringUtilsTest.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/StringUtilsTest.java?ref=b9e993fdabdbdc4ad2b941d4294904f2cdb072c1",
                "filename": "oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/StringUtilsTest.java",
                "deletions": 0,
                "sha": "5075045fadd51d31ce6fe26a3084895b1bd893da",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/b9e993fdabdbdc4ad2b941d4294904f2cdb072c1/oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/StringUtilsTest.java",
                "patch": "@@ -16,8 +16,11 @@\n  */\n package org.apache.jackrabbit.oak.commons;\n \n+import com.google.common.collect.Maps;\n import junit.framework.TestCase;\n \n+import java.util.Map;\n+\n /**\n  * Test the string utilities.\n  */\n@@ -41,4 +44,16 @@ public void testHex() {\n         }\n     }\n \n+    public void testEstimateMemoryUsage() {\n+        final Map<String, Integer> testStrings = Maps.newHashMap();\n+        testStrings.put(null, 0);\n+        testStrings.put(\"\", 48);\n+        testStrings.put(\"a\", 50);\n+        testStrings.put(\"short string\", 72);\n+        testStrings.put(\"a much longer string than the one named 'short string'\", 156);\n+        for (final Map.Entry<String, Integer> e : testStrings.entrySet()) {\n+            assertEquals(e.getValue().intValue(), StringUtils.estimateMemoryUsage(e.getKey()));\n+        }\n+    }\n+\n }",
                "changes": 15
            }
        ],
        "unit_tests": [
            "StringUtilsTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "oak-commons/src/test/java/org/apache/jackrabbit/oak/commons/StringUtilsTest.java",
        "buggy_files": [
            "oak-commons/src/main/java/org/apache/jackrabbit/oak/commons/StringUtils.java"
        ],
        "fixed": true
    }
]