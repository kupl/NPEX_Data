{
    "santuario-java_6c87fb9": {
        "repo": "santuario-java",
        "message": "NPE fix\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1683510 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/santuario-java/commit/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7",
        "parent": "https://github.com/apache/santuario-java/commit/e06f6b15a588a27d84b852407d0541bf4c8a1938",
        "bug_id": "santuario-java_6c87fb9",
        "file": [
            {
                "sha": "890d62635addcf3db8aa2a71eb3a550987bc2f38",
                "filename": "src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "blob_url": "https://github.com/apache/santuario-java/blob/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "raw_url": "https://github.com/apache/santuario-java/raw/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "status": "modified",
                "changes": 7,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/encryption/XMLCipher.java?ref=6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7",
                "patch": "@@ -1142,6 +1142,9 @@ private EncryptedData encryptData(\n         if (serializer instanceof AbstractSerializer) {\n             ((AbstractSerializer)serializer).setSecureValidation(secureValidation);\n         }\n+        if (element != null && element.getParentNode() == null) {\n+            throw new XMLEncryptionException(\"empty\", \"The element can't be serialized as it has no parent\");\n+        }\n \n         byte[] serializedOctets = null;\n         if (serializedData == null) {\n@@ -1697,6 +1700,10 @@ private Document decryptElement(Element element) throws XMLEncryptionException {\n         if (serializer instanceof AbstractSerializer) {\n             ((AbstractSerializer)serializer).setSecureValidation(secureValidation);\n         }\n+        \n+        if (element != null && element.getParentNode() == null) {\n+            throw new XMLEncryptionException(\"empty\", \"The element can't be serialized as it has no parent\");\n+        }\n \n         if (cipherMode != DECRYPT_MODE) {\n             throw new XMLEncryptionException(\"empty\", \"XMLCipher unexpectedly not in DECRYPT_MODE...\");",
                "deletions": 0
            }
        ],
        "patched_files": [
            "XMLCipher.java"
        ],
        "unit_tests": [
            "XMLCipherTest.java"
        ]
    },
    "santuario-java_a87886d": {
        "repo": "santuario-java",
        "message": "Avoid potential NPE in XMLCipher\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1683359 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/santuario-java/commit/a87886d806115ca3ba3350fd5d6c7d08c0decddf",
        "parent": "https://github.com/apache/santuario-java/commit/8812e5fd78b714902e5b58956cdc27dbed5e565b",
        "bug_id": "santuario-java_a87886d",
        "file": [
            {
                "sha": "f8dcaf2b4e036f0dcd04efbd0b26080d362282f9",
                "filename": "src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "blob_url": "https://github.com/apache/santuario-java/blob/a87886d806115ca3ba3350fd5d6c7d08c0decddf/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "raw_url": "https://github.com/apache/santuario-java/raw/a87886d806115ca3ba3350fd5d6c7d08c0decddf/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "status": "modified",
                "changes": 6,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/encryption/XMLCipher.java?ref=a87886d806115ca3ba3350fd5d6c7d08c0decddf",
                "patch": "@@ -3645,8 +3645,12 @@ private static boolean haveFunctionalIdentityTransformer() {\n                     new javax.xml.transform.stream.StreamSource(\n                             new java.io.ByteArrayInputStream(xml.getBytes(\"UTF-8\"))), domResult);\n \n-            final boolean result = \"http://www.w3.org/2000/xmlns/\".equals(\n+            boolean result = false;\n+            if (domResult.getNode().getFirstChild().getFirstChild().hasAttributes()\n+                && domResult.getNode().getFirstChild().getFirstChild().getAttributes().getLength() >= 1) {\n+                result = \"http://www.w3.org/2000/xmlns/\".equals(\n                     domResult.getNode().getFirstChild().getFirstChild().getAttributes().item(1).getNamespaceURI());\n+            }\n             log.debug(\"Have functional IdentityTransformer: \" + result);\n             return result;\n ",
                "deletions": 1
            }
        ],
        "patched_files": [
            "XMLCipher.java"
        ],
        "unit_tests": [
            "XMLCipherTest.java"
        ]
    },
    "santuario-java_059d726": {
        "repo": "santuario-java",
        "message": "[SANTUARIO-368] - NPE in XMLSignature\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1527497 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/santuario-java/commit/059d726166539e7421466339823ba6d2b0fc3fd6",
        "parent": "https://github.com/apache/santuario-java/commit/7bbe05553af241cd1fa8b5c5884f832e7ee2c485",
        "bug_id": "santuario-java_059d726",
        "file": [
            {
                "sha": "9b676df9251f03b55379e2e2180db0b89e4a66b8",
                "filename": "src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "blob_url": "https://github.com/apache/santuario-java/blob/059d726166539e7421466339823ba6d2b0fc3fd6/src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "raw_url": "https://github.com/apache/santuario-java/raw/059d726166539e7421466339823ba6d2b0fc3fd6/src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/signature/XMLSignature.java?ref=059d726166539e7421466339823ba6d2b0fc3fd6",
                "patch": "@@ -373,8 +373,8 @@ public XMLSignature(Element element, String baseURI, boolean secureValidation)\n \n         // If it exists use it, but it's not mandatory\n         if (keyInfoElem != null \n-            && keyInfoElem.getNamespaceURI().equals(Constants.SignatureSpecNS) \n-            && keyInfoElem.getLocalName().equals(Constants._TAG_KEYINFO)) {\n+            && Constants.SignatureSpecNS.equals(keyInfoElem.getNamespaceURI()) \n+            && Constants._TAG_KEYINFO.equals(keyInfoElem.getLocalName())) {\n             this.keyInfo = new KeyInfo(keyInfoElem, baseURI);\n             this.keyInfo.setSecureValidation(secureValidation);\n         }",
                "deletions": 2
            }
        ],
        "patched_files": [
            "XMLSignature.java"
        ],
        "unit_tests": [
            "XMLSignatureTest.java"
        ]
    },
    "santuario-java_11e5627": {
        "repo": "santuario-java",
        "message": "DOMKeyInfo.marshal should throw NPE when parent is null per KeyInfo.marshal API spec.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1485370 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/santuario-java/commit/11e5627cd603b679846838dda4b109baa7244b3c",
        "parent": "https://github.com/apache/santuario-java/commit/7b15b6156011f16d25d02d7aca2cb928811048a6",
        "bug_id": "santuario-java_11e5627",
        "file": [
            {
                "sha": "e1e312cdfb7be8006860f46210909454b9060ce0",
                "filename": "src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "blob_url": "https://github.com/apache/santuario-java/blob/11e5627cd603b679846838dda4b109baa7244b3c/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "raw_url": "https://github.com/apache/santuario-java/raw/11e5627cd603b679846838dda4b109baa7244b3c/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java?ref=11e5627cd603b679846838dda4b109baa7244b3c",
                "patch": "@@ -144,7 +144,10 @@ public String getId() {\n     public void marshal(XMLStructure parent, XMLCryptoContext context)\n         throws MarshalException\n     {\n-        if (parent == null || !(parent instanceof javax.xml.crypto.dom.DOMStructure)) {\n+        if (parent == null) {\n+            throw new NullPointerException(\"parent is null\");\n+        }\n+        if (!(parent instanceof javax.xml.crypto.dom.DOMStructure)) {\n             throw new ClassCastException(\"parent must be of type DOMStructure\");\n         }\n ",
                "deletions": 1
            },
            {
                "sha": "ee023934ee7656955011bb44db6c6de463e94c3f",
                "filename": "src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "blob_url": "https://github.com/apache/santuario-java/blob/11e5627cd603b679846838dda4b109baa7244b3c/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "raw_url": "https://github.com/apache/santuario-java/raw/11e5627cd603b679846838dda4b109baa7244b3c/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java?ref=11e5627cd603b679846838dda4b109baa7244b3c",
                "patch": "@@ -115,8 +115,8 @@ public void testMarshal() throws Exception {\n             (Collections.singletonList(fac.newKeyName(\"foo\")), \"keyid\");\n         try {\n             ki.marshal(null, null);\n-            fail(\"Should raise a ClassCastException\");\n-        } catch (ClassCastException npe) {}\n+            fail(\"Should raise a NullPointerException\");\n+        } catch (NullPointerException npe) {}\n \n         DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n         dbf.setNamespaceAware(true);",
                "deletions": 2
            }
        ],
        "patched_files": [
            "KeyInfo.java",
            "DOMKeyInfo.java"
        ],
        "unit_tests": [
            "KeyInfoTest.java"
        ]
    }
}