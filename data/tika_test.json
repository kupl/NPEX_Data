{
    "tika_06486c8": {
        "bug_id": "tika_06486c8",
        "commit": "https://github.com/apache/tika/commit/06486c8548daf5f9ba588da4e88e3da82a429e70",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/06486c8548daf5f9ba588da4e88e3da82a429e70/tika-parsers/src/main/java/org/apache/tika/parser/pkg/PackageParser.java",
                "changes": 44,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pkg/PackageParser.java?ref=06486c8548daf5f9ba588da4e88e3da82a429e70",
                "deletions": 34,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pkg/PackageParser.java",
                "patch": "@@ -41,7 +41,6 @@\n import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;\n import org.apache.commons.compress.archivers.zip.ZipArchiveInputStream;\n import org.apache.commons.io.input.CloseShieldInputStream;\n-import org.apache.tika.config.TikaConfig;\n import org.apache.tika.exception.EncryptedDocumentException;\n import org.apache.tika.exception.TikaException;\n import org.apache.tika.extractor.EmbeddedDocumentExtractor;\n@@ -51,7 +50,6 @@\n import org.apache.tika.metadata.Metadata;\n import org.apache.tika.metadata.TikaCoreProperties;\n import org.apache.tika.mime.MediaType;\n-import org.apache.tika.mime.MediaTypeRegistry;\n import org.apache.tika.parser.AbstractParser;\n import org.apache.tika.parser.ParseContext;\n import org.apache.tika.parser.PasswordProvider;\n@@ -85,14 +83,15 @@\n     private static final MediaType TAR = MediaType.application(\"x-tar\");\n     private static final MediaType SEVENZ = MediaType.application(\"x-7z-compressed\");\n \n+    private static final MediaType TIKA_OOXML = MediaType.application(\"tika-ooxml\");\n+    private static final MediaType GTAR = MediaType.application(\"x-gtar\");\n+\n+\n     private static final Set<MediaType> SUPPORTED_TYPES =\n             MediaType.set(ZIP, JAR, AR, ARJ, CPIO, DUMP, TAR, SEVENZ);\n \n-    //this can't be static because of the ForkParser\n-    //lazily load this when parse is called if it is null.\n-    private MediaTypeRegistry bufferedMediaTypeRegistry;\n-\n-    private final Object lock = new Object[0];\n+    private static final Set<MediaType> DONT_OVERWRITE_CONTENT_TYPE =\n+            MediaType.set(TIKA_OOXML, GTAR);\n \n     @Deprecated\n     static MediaType getMediaType(ArchiveInputStream stream) {\n@@ -149,26 +148,6 @@ public void parse(\n             Metadata metadata, ParseContext context)\n             throws IOException, SAXException, TikaException {\n \n-        //lazily load the MediaTypeRegistry at parse time\n-        //only want to call getDefaultConfig() once, and can't\n-        //load statically because of the ForkParser\n-        TikaConfig config = context.get(TikaConfig.class);\n-        MediaTypeRegistry mediaTypeRegistry = null;\n-        if (config != null) {\n-            mediaTypeRegistry = config.getMediaTypeRegistry();\n-        } else {\n-            if (bufferedMediaTypeRegistry == null) {\n-                //buffer this for next time.\n-                synchronized (lock) {\n-                    //now that we're locked, check again\n-                    if (bufferedMediaTypeRegistry == null) {\n-                        bufferedMediaTypeRegistry = TikaConfig.getDefaultConfig().getMediaTypeRegistry();\n-                    }\n-                }\n-            }\n-            mediaTypeRegistry = bufferedMediaTypeRegistry;\n-        }\n-\n         // Ensure that the stream supports the mark feature\n         if (! stream.markSupported()) {\n             stream = new BufferedInputStream(stream);\n@@ -216,7 +195,7 @@ public void parse(\n             throw new TikaException(\"Unable to unpack document stream\", e);\n         }\n \n-        updateMediaType(ais, mediaTypeRegistry, metadata);\n+        updateMediaType(ais, metadata);\n         // Use the delegate parser to parse the contained document\n         EmbeddedDocumentExtractor extractor = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n \n@@ -248,7 +227,7 @@ public void parse(\n         xhtml.endDocument();\n     }\n \n-    private void updateMediaType(ArchiveInputStream ais, MediaTypeRegistry mediaTypeRegistry, Metadata metadata) {\n+    private void updateMediaType(ArchiveInputStream ais, Metadata metadata) {\n         MediaType type = getMediaType(ais);\n         if (type.equals(MediaType.OCTET_STREAM)) {\n             return;\n@@ -267,13 +246,10 @@ private void updateMediaType(ArchiveInputStream ais, MediaTypeRegistry mediaType\n             metadata.set(CONTENT_TYPE, type.toString());\n             return;\n         }\n-        //if the existing type is a specialization of the detected type,\n-        //leave in the specialization; otherwise set the detected\n-        if (! mediaTypeRegistry.isSpecializationOf(incomingMediaType, type)) {\n+\n+        if (! DONT_OVERWRITE_CONTENT_TYPE.contains(incomingMediaType)) {\n             metadata.set(CONTENT_TYPE, type.toString());\n-            return;\n         }\n-\n     }\n \n     private void parseEntry(",
                "raw_url": "https://github.com/apache/tika/raw/06486c8548daf5f9ba588da4e88e3da82a429e70/tika-parsers/src/main/java/org/apache/tika/parser/pkg/PackageParser.java",
                "sha": "32e06c0a7a93e940d15a0178732e5daa1b2b0007",
                "status": "modified"
            },
            {
                "additions": 19,
                "blob_url": "https://github.com/apache/tika/blob/06486c8548daf5f9ba588da4e88e3da82a429e70/tika-parsers/src/test/java/org/apache/tika/parser/fork/ForkParserIntegrationTest.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/fork/ForkParserIntegrationTest.java?ref=06486c8548daf5f9ba588da4e88e3da82a429e70",
                "deletions": 1,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/fork/ForkParserIntegrationTest.java",
                "patch": "@@ -17,6 +17,7 @@\n package org.apache.tika.parser.fork;\n \n import static org.apache.tika.TikaTest.assertContains;\n+import static org.apache.tika.TikaTest.debug;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.fail;\n@@ -29,6 +30,7 @@\n import java.util.Set;\n \n import org.apache.tika.Tika;\n+import org.apache.tika.TikaTest;\n import org.apache.tika.detect.Detector;\n import org.apache.tika.exception.TikaException;\n import org.apache.tika.fork.ForkParser;\n@@ -46,7 +48,7 @@\n  * Test that the ForkParser correctly behaves when\n  *  wired in to the regular Parsers and their test data\n  */\n-public class ForkParserIntegrationTest {\n+public class ForkParserIntegrationTest extends TikaTest {\n \n     private Tika tika = new Tika(); // TODO Use TikaConfig instead, when it works\n \n@@ -269,4 +271,20 @@ public void testForkedPDFParsing() throws Exception {\n             parser.close();\n         }\n     }\n+\n+    @Test\n+    public void testForkedPackageParsing() throws Exception {\n+        ForkParser parser = new ForkParser(ForkParserIntegrationTest.class.getClassLoader(),\n+            tika.getParser());\n+        try {\n+            ContentHandler output = new BodyContentHandler();\n+            InputStream stream = ForkParserIntegrationTest.class.getResourceAsStream(\n+                \"/test-documents/moby.zip\");\n+            ParseContext context = new ParseContext();\n+            parser.parse(stream, output, new Metadata(), context);\n+            assertContains(\"Moby Dick\", output.toString());\n+        } finally {\n+            parser.close();\n+        }\n+    }\n }",
                "raw_url": "https://github.com/apache/tika/raw/06486c8548daf5f9ba588da4e88e3da82a429e70/tika-parsers/src/test/java/org/apache/tika/parser/fork/ForkParserIntegrationTest.java",
                "sha": "4baf634cb27ff687a6c8f6dcbf11a18fb6643bbc",
                "status": "modified"
            }
        ],
        "message": "TIKA-2483 -- revert loading of mime repository in PackageParser from TIKA-2311 to avoid NPE in ForkParser",
        "parent": "https://github.com/apache/tika/commit/b19c2d7d769fda84378108d26023852ee6abdb6c",
        "patched_files": [
            "PackageParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "PackageParserTest.java",
            "ForkParserIntegrationTest.java"
        ]
    },
    "tika_070b30c": {
        "bug_id": "tika_070b30c",
        "commit": "https://github.com/apache/tika/commit/070b30c2094b637506a8fcb8597c830b1fe6c3c4",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tika/blob/070b30c2094b637506a8fcb8597c830b1fe6c3c4/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java?ref=070b30c2094b637506a8fcb8597c830b1fe6c3c4",
                "deletions": 1,
                "filename": "tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "patch": "@@ -249,7 +249,7 @@ public void parse(\n                 throw new TikaException(\n                         \"TIKA-198: Illegal IOException from \" + parser, e);\n             } catch (SAXException e) {\n-                taggedHandler.throwIfCauseOf(e);\n+                if (taggedHandler != null) taggedHandler.throwIfCauseOf(e);\n                 throw new TikaException(\n                         \"TIKA-237: Illegal SAXException from \" + parser, e);\n             }",
                "raw_url": "https://github.com/apache/tika/raw/070b30c2094b637506a8fcb8597c830b1fe6c3c4/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "sha": "1f6e239aae2fc8d94709a6f9f47a60f99a0c3c4a",
                "status": "modified"
            }
        ],
        "message": "Add check for possible NPE in CompositeParser.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1611406 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/9860b74af1e19ec7a88cccc298f9dcd86d31d3bf",
        "patched_files": [
            "CompositeParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "CompositeParserTest.java"
        ]
    },
    "tika_1c7f1bc": {
        "bug_id": "tika_1c7f1bc",
        "commit": "https://github.com/apache/tika/commit/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tika/blob/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDF2XHTML.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDF2XHTML.java?ref=1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDF2XHTML.java",
                "patch": "@@ -293,7 +293,12 @@ private void extractImages(PDResources resources) throws SAXException {\n             return;\n         }\n \n-        for (Map.Entry<String, PDXObject> entry : resources.getXObjects().entrySet()) {\n+        Map<String, PDXObject> xObjects = resources.getXObjects();\n+        if (xObjects == null) {\n+            return;\n+        }\n+\n+        for (Map.Entry<String, PDXObject> entry : xObjects.entrySet()) {\n                         \n             PDXObject object = entry.getValue();\n             if (object instanceof PDXObjectForm) {",
                "raw_url": "https://github.com/apache/tika/raw/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDF2XHTML.java",
                "sha": "f713d5aa3146d4302902c8261e007effed5b2771",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java?ref=1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e",
                "deletions": 3,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "patch": "@@ -472,7 +472,7 @@ public void setEnableAutoSpace(boolean v) {\n     }\n \n     /** \n-     * @see #setEnableAutoSpace. \n+     * @see #setEnableAutoSpace(boolean) \n      * @deprecated use {@link #getPDFParserConfig()}\n      */\n     public boolean getEnableAutoSpace() {\n@@ -513,7 +513,7 @@ public void setSuppressDuplicateOverlappingText(boolean v) {\n     }\n \n     /** \n-     * @see #setSuppressDuplicateOverlappingText. \n+     * @see #setSuppressDuplicateOverlappingText(boolean) \n      * \n      * @deprecated use {@link #getPDFParserConfig()}\n      */\n@@ -536,7 +536,7 @@ public void setSortByPosition(boolean v) {\n     }\n \n     /** \n-     * @see #setSortByPosition. \n+     * @see #setSortByPosition(boolean) \n      * \n      * @deprecated use {@link #getPDFParserConfig()}\n      */",
                "raw_url": "https://github.com/apache/tika/raw/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "sha": "fe804f45cc437fadeb286b48ac27b68e999802ca",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParserConfig.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParserConfig.java?ref=1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e",
                "deletions": 2,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParserConfig.java",
                "patch": "@@ -165,7 +165,7 @@ public void configure(PDF2XHTML pdf2XHTML) {\n      * If true (the default), extract content from AcroForms\n      * at the end of the document.\n      * \n-     * @param b\n+     * @param extractAcroFormContent\n      */\n     public void setExtractAcroFormContent(boolean extractAcroFormContent) {\n         this.extractAcroFormContent = extractAcroFormContent;\n@@ -227,7 +227,7 @@ public boolean getExtractUniqueInlineImagesOnly() {\n     }\n \n \n-    /** @see #setEnableAutoSpace. */\n+    /** @see #setEnableAutoSpace(boolean) */\n     public boolean getEnableAutoSpace() {\n         return enableAutoSpace;\n     }",
                "raw_url": "https://github.com/apache/tika/raw/1c7f1bcd1c7e3dcdba6495f6f9ac217522a6485e/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParserConfig.java",
                "sha": "30d3f7e6c1ac2fdf59647fb476d68c5daaa47f16",
                "status": "modified"
            }
        ],
        "message": "Fix potential NPE and fix javadoc refs for PDFParser\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1613122 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/f1d00dbf40f16ce8669628951b813d7972c07c45",
        "patched_files": [
            "PDFParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "PDFParserTest.java"
        ]
    },
    "tika_1e0159b": {
        "bug_id": "tika_1e0159b",
        "commit": "https://github.com/apache/tika/commit/1e0159b733dc7a8f48ce8943e1f15046c791349a",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tika/blob/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFEmbObjHandler.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFEmbObjHandler.java?ref=1e0159b733dc7a8f48ce8943e1f15046c791349a",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFEmbObjHandler.java",
                "patch": "@@ -246,7 +246,7 @@ private String getExtension(TikaInputStream is, Metadata metadata) {\n                 MediaType mediaType = detector.detect(is, metadata);\n                 MimeTypes types = config.getMimeRepository();\n                 MimeType mime = types.forName(mediaType.toString());\n-                metadata.set(Metadata.CONTENT_TYPE, mediaType.getSubtype());\n+                metadata.set(Metadata.CONTENT_TYPE, mime.toString());\n                 return mime.getExtension();\n             } catch (IOException e) {\n                 //swallow",
                "raw_url": "https://github.com/apache/tika/raw/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFEmbObjHandler.java",
                "sha": "183df62025315675b7ef5dab828561c505adc7f1",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/tika/blob/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/main/java/org/apache/tika/server/resource/TikaResource.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-server/src/main/java/org/apache/tika/server/resource/TikaResource.java?ref=1e0159b733dc7a8f48ce8943e1f15046c791349a",
                "deletions": 5,
                "filename": "tika-server/src/main/java/org/apache/tika/server/resource/TikaResource.java",
                "patch": "@@ -17,6 +17,8 @@\n \n package org.apache.tika.server.resource;\n \n+import static java.nio.charset.StandardCharsets.UTF_8;\n+\n import javax.mail.internet.ContentDisposition;\n import javax.mail.internet.ParseException;\n import javax.ws.rs.Consumes;\n@@ -37,7 +39,6 @@\n import javax.xml.transform.sax.SAXTransformerFactory;\n import javax.xml.transform.sax.TransformerHandler;\n import javax.xml.transform.stream.StreamResult;\n-\n import java.io.IOException;\n import java.io.InputStream;\n import java.io.OutputStream;\n@@ -76,8 +77,6 @@\n import org.xml.sax.ContentHandler;\n import org.xml.sax.SAXException;\n \n-import static java.nio.charset.StandardCharsets.UTF_8;\n-\n @Path(\"/tika\")\n public class TikaResource {\n     public static final String GREETING = \"This is Tika Server. Please PUT\\n\";\n@@ -228,9 +227,14 @@ public static void fillMetadata(Parser parser, Metadata metadata, ParseContext c\n             setDetector(parser, new Detector() {\n                 public MediaType detect(InputStream inputStream, Metadata metadata) throws IOException {\n                     String ct = metadata.get(org.apache.tika.metadata.HttpHeaders.CONTENT_TYPE);\n-\n+                    //make sure never to return null -- TIKA-1845\n+                    MediaType type = null;\n                     if (ct != null) {\n-                        return MediaType.parse(ct);\n+                        //this can return null if ct is not a valid mime type\n+                        type = MediaType.parse(ct);\n+                    }\n+                    if (type != null) {\n+                        return type;\n                     } else {\n                         return detector.detect(inputStream, metadata);\n                     }",
                "raw_url": "https://github.com/apache/tika/raw/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/main/java/org/apache/tika/server/resource/TikaResource.java",
                "sha": "d74ef74e2c1c67a3372ca6f7a57b6c2ea12f38fd",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/tika/blob/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/test/java/org/apache/tika/server/TikaResourceTest.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-server/src/test/java/org/apache/tika/server/TikaResourceTest.java?ref=1e0159b733dc7a8f48ce8943e1f15046c791349a",
                "deletions": 0,
                "filename": "tika-server/src/test/java/org/apache/tika/server/TikaResourceTest.java",
                "patch": "@@ -178,4 +178,16 @@ public void testEmbedded() throws Exception {\n \n     }\n \n+    //TIKA-1845\n+    @Test\n+    public void testWMFInRTF() throws Exception {\n+        Response response = WebClient.create(endPoint + TIKA_PATH)\n+                .type(\"application/rtf\")\n+                .accept(\"text/plain\")\n+                .put(ClassLoader.getSystemResourceAsStream(\"testRTF_npeFromWMFInTikaServer.rtf\"));\n+        String responseMsg = getStringFromInputStream((InputStream) response\n+                .getEntity());\n+        assertTrue(responseMsg.contains(\"Example text\"));\n+    }\n+\n }",
                "raw_url": "https://github.com/apache/tika/raw/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/test/java/org/apache/tika/server/TikaResourceTest.java",
                "sha": "4cb6d7c7dede416f730aa84cdd833ac11b829b77",
                "status": "modified"
            },
            {
                "additions": 235,
                "blob_url": "https://github.com/apache/tika/blob/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/test/resources/testRTF_npeFromWMFInTikaServer.rtf",
                "changes": 235,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-server/src/test/resources/testRTF_npeFromWMFInTikaServer.rtf?ref=1e0159b733dc7a8f48ce8943e1f15046c791349a",
                "deletions": 0,
                "filename": "tika-server/src/test/resources/testRTF_npeFromWMFInTikaServer.rtf",
                "patch": "@@ -0,0 +1,235 @@\n+{\\rtf1\\adeflang1025\\ansi\\ansicpg1252\\uc1\\adeff0\\deff0\\stshfdbch0\\stshfloch0\\stshfhich0\\stshfbi0\\deflang2057\\deflangfe2057\\themelang2057\\themelangfe0\\themelangcs0{\\fonttbl{\\f0\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}{\\f1\\fbidi \\fswiss\\fcharset0\\fprq2{\\*\\panose 020b0604020202020204}Arial;}\n+{\\f34\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02040503050406030204}Cambria Math;}{\\f171\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02040602050305030304}Book Antiqua;}\n+{\\f318\\fbidi \\fswiss\\fcharset0\\fprq2{\\*\\panose 020b0603030504020204}Humnst777 BT{\\*\\falt Lucida Sans Unicode};}{\\flomajor\\f31500\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}\n+{\\fdbmajor\\f31501\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}{\\fhimajor\\f31502\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02040503050406030204}Cambria;}\n+{\\fbimajor\\f31503\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}{\\flominor\\f31504\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}\n+{\\fdbminor\\f31505\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}{\\fhiminor\\f31506\\fbidi \\fswiss\\fcharset0\\fprq2{\\*\\panose 020f0502020204030204}Calibri;}\n+{\\fbiminor\\f31507\\fbidi \\froman\\fcharset0\\fprq2{\\*\\panose 02020603050405020304}Times New Roman;}{\\f319\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}{\\f320\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}\n+{\\f322\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}{\\f323\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}{\\f324\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}{\\f325\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}\n+{\\f326\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}{\\f327\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}{\\f329\\fbidi \\fswiss\\fcharset238\\fprq2 Arial CE;}{\\f330\\fbidi \\fswiss\\fcharset204\\fprq2 Arial Cyr;}\n+{\\f332\\fbidi \\fswiss\\fcharset161\\fprq2 Arial Greek;}{\\f333\\fbidi \\fswiss\\fcharset162\\fprq2 Arial Tur;}{\\f334\\fbidi \\fswiss\\fcharset177\\fprq2 Arial (Hebrew);}{\\f335\\fbidi \\fswiss\\fcharset178\\fprq2 Arial (Arabic);}\n+{\\f336\\fbidi \\fswiss\\fcharset186\\fprq2 Arial Baltic;}{\\f337\\fbidi \\fswiss\\fcharset163\\fprq2 Arial (Vietnamese);}{\\f659\\fbidi \\froman\\fcharset238\\fprq2 Cambria Math CE;}{\\f660\\fbidi \\froman\\fcharset204\\fprq2 Cambria Math Cyr;}\n+{\\f662\\fbidi \\froman\\fcharset161\\fprq2 Cambria Math Greek;}{\\f663\\fbidi \\froman\\fcharset162\\fprq2 Cambria Math Tur;}{\\f666\\fbidi \\froman\\fcharset186\\fprq2 Cambria Math Baltic;}{\\f667\\fbidi \\froman\\fcharset163\\fprq2 Cambria Math (Vietnamese);}\n+{\\f2029\\fbidi \\froman\\fcharset238\\fprq2 Book Antiqua CE;}{\\f2030\\fbidi \\froman\\fcharset204\\fprq2 Book Antiqua Cyr;}{\\f2032\\fbidi \\froman\\fcharset161\\fprq2 Book Antiqua Greek;}{\\f2033\\fbidi \\froman\\fcharset162\\fprq2 Book Antiqua Tur;}\n+{\\f2036\\fbidi \\froman\\fcharset186\\fprq2 Book Antiqua Baltic;}{\\flomajor\\f31508\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}{\\flomajor\\f31509\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}\n+{\\flomajor\\f31511\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}{\\flomajor\\f31512\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}{\\flomajor\\f31513\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}\n+{\\flomajor\\f31514\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}{\\flomajor\\f31515\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}{\\flomajor\\f31516\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}\n+{\\fdbmajor\\f31518\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}{\\fdbmajor\\f31519\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}{\\fdbmajor\\f31521\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}\n+{\\fdbmajor\\f31522\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}{\\fdbmajor\\f31523\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}{\\fdbmajor\\f31524\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}\n+{\\fdbmajor\\f31525\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}{\\fdbmajor\\f31526\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}{\\fhimajor\\f31528\\fbidi \\froman\\fcharset238\\fprq2 Cambria CE;}\n+{\\fhimajor\\f31529\\fbidi \\froman\\fcharset204\\fprq2 Cambria Cyr;}{\\fhimajor\\f31531\\fbidi \\froman\\fcharset161\\fprq2 Cambria Greek;}{\\fhimajor\\f31532\\fbidi \\froman\\fcharset162\\fprq2 Cambria Tur;}\n+{\\fhimajor\\f31535\\fbidi \\froman\\fcharset186\\fprq2 Cambria Baltic;}{\\fhimajor\\f31536\\fbidi \\froman\\fcharset163\\fprq2 Cambria (Vietnamese);}{\\fbimajor\\f31538\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}\n+{\\fbimajor\\f31539\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}{\\fbimajor\\f31541\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}{\\fbimajor\\f31542\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}\n+{\\fbimajor\\f31543\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}{\\fbimajor\\f31544\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}{\\fbimajor\\f31545\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}\n+{\\fbimajor\\f31546\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}{\\flominor\\f31548\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}{\\flominor\\f31549\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}\n+{\\flominor\\f31551\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}{\\flominor\\f31552\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}{\\flominor\\f31553\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}\n+{\\flominor\\f31554\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}{\\flominor\\f31555\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}{\\flominor\\f31556\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}\n+{\\fdbminor\\f31558\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}{\\fdbminor\\f31559\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}{\\fdbminor\\f31561\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}\n+{\\fdbminor\\f31562\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}{\\fdbminor\\f31563\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}{\\fdbminor\\f31564\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}\n+{\\fdbminor\\f31565\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}{\\fdbminor\\f31566\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}{\\fhiminor\\f31568\\fbidi \\fswiss\\fcharset238\\fprq2 Calibri CE;}\n+{\\fhiminor\\f31569\\fbidi \\fswiss\\fcharset204\\fprq2 Calibri Cyr;}{\\fhiminor\\f31571\\fbidi \\fswiss\\fcharset161\\fprq2 Calibri Greek;}{\\fhiminor\\f31572\\fbidi \\fswiss\\fcharset162\\fprq2 Calibri Tur;}\n+{\\fhiminor\\f31575\\fbidi \\fswiss\\fcharset186\\fprq2 Calibri Baltic;}{\\fhiminor\\f31576\\fbidi \\fswiss\\fcharset163\\fprq2 Calibri (Vietnamese);}{\\fbiminor\\f31578\\fbidi \\froman\\fcharset238\\fprq2 Times New Roman CE;}\n+{\\fbiminor\\f31579\\fbidi \\froman\\fcharset204\\fprq2 Times New Roman Cyr;}{\\fbiminor\\f31581\\fbidi \\froman\\fcharset161\\fprq2 Times New Roman Greek;}{\\fbiminor\\f31582\\fbidi \\froman\\fcharset162\\fprq2 Times New Roman Tur;}\n+{\\fbiminor\\f31583\\fbidi \\froman\\fcharset177\\fprq2 Times New Roman (Hebrew);}{\\fbiminor\\f31584\\fbidi \\froman\\fcharset178\\fprq2 Times New Roman (Arabic);}{\\fbiminor\\f31585\\fbidi \\froman\\fcharset186\\fprq2 Times New Roman Baltic;}\n+{\\fbiminor\\f31586\\fbidi \\froman\\fcharset163\\fprq2 Times New Roman (Vietnamese);}}{\\colortbl;\\red0\\green0\\blue0;\\red0\\green0\\blue255;\\red0\\green255\\blue255;\\red0\\green255\\blue0;\\red255\\green0\\blue255;\\red255\\green0\\blue0;\\red255\\green255\\blue0;\n+\\red255\\green255\\blue255;\\red0\\green0\\blue128;\\red0\\green128\\blue128;\\red0\\green128\\blue0;\\red128\\green0\\blue128;\\red128\\green0\\blue0;\\red128\\green128\\blue0;\\red128\\green128\\blue128;\\red192\\green192\\blue192;}{\\*\\defchp \\fs22 }{\\*\\defpap \n+\\ql \\li0\\ri0\\sa200\\sl276\\slmult1\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 }\\noqfpromote {\\stylesheet{\\ql \\li0\\ri0\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \n+\\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \\snext0 \\sqformat \\spriority0 Normal;}{\\s1\\ql \\li0\\ri0\\keepn\\widctlpar\\tx5670\\tx8222\\wrapdefault\\faauto\\outlinelevel0\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\ab\\af1\\afs24\\alang1025 \\ltrch\\fcs0 \n+\\b\\f1\\fs20\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \\sbasedon0 \\snext0 \\slink15 \\sqformat heading 1;}{\\s2\\ql \\li0\\ri0\\keepn\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\outlinelevel1\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \n+\\ab\\af1\\afs28\\alang1025 \\ltrch\\fcs0 \\b\\f1\\fs28\\lang2057\\langfe2057\\cgrid\\langnp2057\\langfenp2057 \\sbasedon0 \\snext0 \\slink16 \\sqformat heading 2;}{\\s4\\ql \\li5670\\ri0\\keepn\\widctlpar\\tx5670\\tx7371\\wrapdefault\\faauto\\outlinelevel3\\rin0\\lin5670\\itap0 \n+\\rtlch\\fcs1 \\ab\\af1\\afs16\\alang1025 \\ltrch\\fcs0 \\b\\f1\\fs16\\lang2057\\langfe2057\\cgrid\\langnp2057\\langfenp2057 \\sbasedon0 \\snext0 \\slink17 \\sqformat heading 4;}{\\*\\cs10 \\additive \\ssemihidden Default Paragraph Font;}{\\*\n+\\ts11\\tsrowd\\trftsWidthB3\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddft3\\trpaddfb3\\trpaddfr3\\tblind0\\tblindtype3\\tscellwidthfts0\\tsvertalt\\tsbrdrt\\tsbrdrl\\tsbrdrb\\tsbrdrr\\tsbrdrdgl\\tsbrdrdgr\\tsbrdrh\\tsbrdrv \\ql \\li0\\ri0\\sa200\\sl276\\slmult1\n+\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs22\\alang1025 \\ltrch\\fcs0 \\fs22\\lang2057\\langfe2057\\cgrid\\langnp2057\\langfenp2057 \\snext11 \\ssemihidden \\sunhideused \\sqformat Normal Table;}{\\*\\cs15 \\additive \n+\\rtlch\\fcs1 \\ab\\af31503\\afs32 \\ltrch\\fcs0 \\b\\fs32\\lang0\\langfe1033\\kerning32\\loch\\f31502\\hich\\af31502\\dbch\\af31501\\langnp0\\langfenp1033 \\sbasedon10 \\slink1 \\slocked \\spriority9 Heading 1 Char;}{\\*\\cs16 \\additive \\rtlch\\fcs1 \\ab\\ai\\af31503\\afs28 \n+\\ltrch\\fcs0 \\b\\i\\fs28\\lang0\\langfe1033\\loch\\f31502\\hich\\af31502\\dbch\\af31501\\langnp0\\langfenp1033 \\sbasedon10 \\slink2 \\slocked \\ssemihidden \\spriority9 Heading 2 Char;}{\\*\\cs17 \\additive \\rtlch\\fcs1 \\ab\\af31507\\afs28 \\ltrch\\fcs0 \n+\\b\\fs28\\lang0\\langfe1033\\loch\\f31506\\hich\\af31506\\dbch\\af31505\\langnp0\\langfenp1033 \\sbasedon10 \\slink4 \\slocked \\ssemihidden \\spriority9 Heading 4 Char;}{\\s18\\ql \\li0\\ri0\\widctlpar\n+\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs20\\alang1025 \\ltrch\\fcs0 \\fs22\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \\sbasedon0 \\snext18 \\slink19 header;}{\\*\\cs19 \\additive \\rtlch\\fcs1 \n+\\af0\\afs24 \\ltrch\\fcs0 \\fs24\\lang0\\langfe1033\\langnp0\\langfenp1033 \\sbasedon10 \\slink18 \\slocked \\ssemihidden Header Char;}{\\s20\\ql \\li0\\ri0\\widctlpar\\tx3402\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \n+\\ab\\af1\\afs24\\alang1025 \\ltrch\\fcs0 \\b\\f1\\fs20\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \\sbasedon0 \\snext20 \\slink21 Body Text;}{\\*\\cs21 \\additive \\rtlch\\fcs1 \\af0\\afs24 \\ltrch\\fcs0 \\fs24\\lang0\\langfe1033\\langnp0\\langfenp1033 \n+\\sbasedon10 \\slink20 \\slocked \\ssemihidden Body Text Char;}{\\s22\\ql \\li0\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \n+\\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \\sbasedon0 \\snext22 \\slink23 \\styrsid14506524 footer;}{\\*\\cs23 \\additive \\rtlch\\fcs1 \\af0\\afs24 \\ltrch\\fcs0 \\fs24\\lang0\\langfe1033\\langnp0\\langfenp1033 \\sbasedon10 \\slink22 \\slocked \\ssemihidden \n+Footer Char;}}{\\*\\rsidtbl \\rsid69694\\rsid615335\\rsid817088\\rsid1394934\\rsid1968554\\rsid2362503\\rsid2504751\\rsid2508965\\rsid3497332\\rsid3954968\\rsid4262707\\rsid4459777\\rsid4947815\\rsid5249973\\rsid5375126\\rsid5768946\\rsid6625584\\rsid6695929\\rsid7547824\n+\\rsid7568219\\rsid7681002\\rsid7756842\\rsid8788056\\rsid9179382\\rsid9185548\\rsid9589441\\rsid9716173\\rsid10108489\\rsid10158374\\rsid10170376\\rsid10447577\\rsid10506307\\rsid10508481\\rsid11937854\\rsid12735407\\rsid14506524\\rsid15223573\\rsid15351889\\rsid15429861\n+\\rsid15800823\\rsid16209942\\rsid16329808\\rsid16338741\\rsid16531520}{\\mmathPr\\mmathFont34\\mbrkBin0\\mbrkBinSub0\\msmallFrac0\\mdispDef1\\mlMargin0\\mrMargin0\\mdefJc1\\mwrapIndent1440\\mintLim0\\mnaryLim1}{\\info{\\title Cardiff}{\\author A Other}\n+{\\operator Ian Williams}{\\creatim\\yr2016\\mo2\\dy1\\hr16\\min12}{\\revtim\\yr2016\\mo2\\dy1\\hr16\\min12}{\\version2}{\\edmins2}{\\nofpages1}{\\nofwords6}{\\nofchars37}{\\*\\company Cardiff}{\\nofcharsws42}{\\vern32773}}{\\*\\xmlnstbl {\\xmlns1 http://schemas.microsoft.com/off\n+ice/word/2003/wordml}}\\paperw11906\\paperh16838\\margl851\\margr851\\margt567\\margb794\\gutter0\\ltrsect \n+\\widowctrl\\ftnbj\\aenddoc\\trackmoves1\\trackformatting1\\donotembedsysfont1\\relyonvml0\\donotembedlingdata0\\grfdocevents0\\validatexml1\\showplaceholdtext0\\ignoremixedcontent0\\saveinvalidxml0\\showxmlerrors1\\noxlattoyen\n+\\expshrtn\\noultrlspc\\dntblnsbdb\\nospaceforul\\formshade\\horzdoc\\dgmargin\\dghspace120\\dgvspace180\\dghorigin851\\dgvorigin567\\dghshow2\\dgvshow1\n+\\jexpand\\viewkind1\\viewscale100\\pgbrdrhead\\pgbrdrfoot\\splytwnine\\ftnlytwnine\\htmautsp\\nolnhtadjtbl\\useltbaln\\alntblind\\lytcalctblwd\\lyttblrtgr\\lnbrkrule\\nojkernpunct\\rsidroot15429861 \\fet0{\\*\\wgrffmtfilter 013f}\\ilfomacatclnup0{\\*\\template \n+C:\\\\PMS\\\\DOCUMENT\\\\gplnew.dot}{\\*\\ftnsep \\ltrpar \\pard\\plain \\ltrpar\\ql \\li0\\ri0\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 \n+{\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid5249973 \\chftnsep \n+\\par }}{\\*\\ftnsepc \\ltrpar \\pard\\plain \\ltrpar\\ql \\li0\\ri0\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af0 \n+\\ltrch\\fcs0 \\insrsid5249973 \\chftnsepc \n+\\par }}{\\*\\aftnsep \\ltrpar \\pard\\plain \\ltrpar\\ql \\li0\\ri0\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af0 \n+\\ltrch\\fcs0 \\insrsid5249973 \\chftnsep \n+\\par }}{\\*\\aftnsepc \\ltrpar \\pard\\plain \\ltrpar\\ql \\li0\\ri0\\widctlpar\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af0 \n+\\ltrch\\fcs0 \\insrsid5249973 \\chftnsepc \n+\\par }}\\ltrpar \\sectd \\ltrsect\\linex0\\headery709\\footery709\\colsx708\\endnhere\\sectlinegrid360\\sectdefaultcl\\sectrsid3497332\\sftnbj {\\headerl \\ltrpar \\pard\\plain \\ltrpar\\s18\\ql \\li0\\ri0\\widctlpar\n+\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs20\\alang1025 \\ltrch\\fcs0 \\fs22\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid2504751 \n+\\par }}{\\headerr \\ltrpar \\pard\\plain \\ltrpar\\s18\\ql \\li0\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs20\\alang1025 \\ltrch\\fcs0 \\fs22\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\n+\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid2504751 \n+\\par }}{\\footerl \\ltrpar \\pard\\plain \\ltrpar\\s22\\ql \\li0\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\n+\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid2504751 \n+\\par }}{\\footerr \\ltrpar \\pard\\plain \\ltrpar\\s22\\qr \\li-284\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin-284\\itap0\\pararsid14506524 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \n+\\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af0\\afs16 \\ltrch\\fcs0 \\f318\\fs16\\insrsid1968554 {\\pict{\\*\\picprop\\shplid1026{\\sp{\\sn shapeType}{\\sv 1}}{\\sp{\\sn fFlipH}{\\sv 0}}\n+{\\sp{\\sn fFlipV}{\\sv 0}}{\\sp{\\sn fillColor}{\\sv 3355443}}{\\sp{\\sn fRecolorFillAsPicture}{\\sv 0}}{\\sp{\\sn fUseShapeAnchor}{\\sv 0}}{\\sp{\\sn fFilled}{\\sv 1}}{\\sp{\\sn fLine}{\\sv 0}}{\\sp{\\sn pctHR}{\\sv 0}}{\\sp{\\sn alignHR}{\\sv 1}}{\\sp{\\sn dxHeightHR}{\\sv 20}}\n+{\\sp{\\sn dxWidthHR}{\\sv 10943}}{\\sp{\\sn fLayoutInCell}{\\sv 1}}{\\sp{\\sn fStandardHR}{\\sv 1}}{\\sp{\\sn fNoshadeHR}{\\sv 1}}{\\sp{\\sn fHorizRule}{\\sv 1}}{\\sp{\\sn fLayoutInCell}{\\sv 1}}}\\picscalex1094\\picscaley4\\piccropl0\\piccropr0\\piccropt0\\piccropb0\n+\\picw1764\\pich882\\picwgoal1000\\pichgoal500\\wmetafile8\\bliptag667904020\\blipupi71{\\*\\blipuid 27cf68149ca99ab95f958a7b62da888e}010009000003dd02000006001202000000001202000026060f001a04574d464301000000000001003e050000000001000000f803000000000000f80300000100\n+00006c000000ffffffffffffffff111100002c00000000000000000000003e480000b900000020454d4600000100f80300001d00000003000000000000000000\n+000000000000981200009f1a0000ca0000002101000000000000000000000000000023130300f6660400160000000c000000180000000a000000100000000000\n+0000000000000900000010000000111100002c000000250000000c0000000e000080250000000c0000000e000080120000000c00000001000000520000007001\n+000001000000a4ffffff000000000000000000000000900100000000000004400022430061006c00690062007200690000000000000000000000000000000000\n+0000000000000000000000000000000000000000000000000000000000000000000000001900304e19001000000094511900144f1900fa4e5966945119008c4e\n+190010000000fc4f190078511900cc4e5966945119008c4e1900200000008a790c5f8c4e19009451190020000000ffffffffdc008900057a0c5fffffffffffff\n+0180ffff01809f020180ffffffff00420000000800000008000018f18d1001000000000000005802000025000000372e90010000020f0502020204030204ff02\n+00e0ffac004001000000000000009f01000000000000430061006c006900620072000000000020ebf70486d759667a68466dbc008900306c8000c04e19009832\n+055f1f00000001000000fc4e1900fc4e1900907b035f1f000000244f1900dc0089006476000800000000250000000c00000001000000250000000c0000000100\n+0000250000000c00000001000000180000000c0000000000000254000000540000000000000000000000350000002b000000010000005fcc87405eb387400000\n+000057000000010000004c000000040000000000000000000000111100002c00000050000000200000003600000046000000280000001c000000474449430200\n+0000ffffffffffffffff111100002c000000000000002100000008000000620000000c0000000100000024000000240000000000803e00000000000000000000\n+803e000000000000000002000000270000001800000002000000000000003333330000000000250000000c00000002000000250000000c000000080000805600\n+000030000000ffffffffffffffff111100002c00000005000000fefffefffeffad004144ad004144fefffefffeff250000000c00000007000080250000000c00\n+000000000080240000002400000000008040000000000000000000008040000000000000000002000000220000000c000000ffffffff46000000140000000800\n+00004744494303000000250000000c0000000e000080250000000c0000000e0000800e0000001400000000000000100000001400000004000000030108000500\n+00000b0200000000050000000c0205000c02040000002e0118001c000000fb020200010000000000bc02000000000102022253797374656d003f00003f3f0000\n+0000000000000000000001003f3f3f3f3f00040000002d010000040000002d01000004000000020101001c000000fb02f5ff0000000000009001000000000440\n+002243616c6962726900000000000000000000000000000000000000000000000000040000002d010100040000002d010100040000002d010100050000000902\n+000000020d000000320a0a00000001000400000000000e02050020000600030000001e0007000000fc020000333333000000040000002d01020008000000fa02\n+050000000000ffffff00040000002d0103000e0000002403050000000000000005000e0205000e0200000000000008000000fa0200000000000000000000040000002d01040007000000fc020000ffffff000000040000002d010500040000002701ffff040000002d010000040000002d010000030000000000}}{\n+\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\f318\\ul\\insrsid5249973 \n+\\par }\\pard \\ltrpar\\s22\\ql \\li-284\\ri0\\widctlpar\\tx3075\\tx3119\\tx7655\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin-284\\itap0\\pararsid16338741 {\\rtlch\\fcs1 \\af0\\afs14 \\ltrch\\fcs0 \\b\\f318\\fs14\\insrsid2504751 Example footer}{\\rtlch\\fcs1 \\af0\\afs14 \n+\\ltrch\\fcs0 \\f318\\fs14\\insrsid5249973 \n+\\par }}{\\headerf \\ltrpar \\pard\\plain \\ltrpar\\s18\\ql \\li0\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs20\\alang1025 \\ltrch\\fcs0 \\fs22\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\n+\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid2504751 \n+\\par }}{\\footerf \\ltrpar \\pard\\plain \\ltrpar\\s22\\ql \\li0\\ri0\\widctlpar\\tqc\\tx4153\\tqr\\tx8306\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\itap0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\n+\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\insrsid2504751 \n+\\par }}{\\*\\pnseclvl1\\pnucrm\\pnstart1\\pnindent720\\pnhang {\\pntxta .}}{\\*\\pnseclvl2\\pnucltr\\pnstart1\\pnindent720\\pnhang {\\pntxta .}}{\\*\\pnseclvl3\\pndec\\pnstart1\\pnindent720\\pnhang {\\pntxta .}}{\\*\\pnseclvl4\\pnlcltr\\pnstart1\\pnindent720\\pnhang {\\pntxta )}}\n+{\\*\\pnseclvl5\\pndec\\pnstart1\\pnindent720\\pnhang {\\pntxtb (}{\\pntxta )}}{\\*\\pnseclvl6\\pnlcltr\\pnstart1\\pnindent720\\pnhang {\\pntxtb (}{\\pntxta )}}{\\*\\pnseclvl7\\pnlcrm\\pnstart1\\pnindent720\\pnhang {\\pntxtb (}{\\pntxta )}}{\\*\\pnseclvl8\n+\\pnlcltr\\pnstart1\\pnindent720\\pnhang {\\pntxtb (}{\\pntxta )}}{\\*\\pnseclvl9\\pnlcrm\\pnstart1\\pnindent720\\pnhang {\\pntxtb (}{\\pntxta )}}\\ltrrow\\trowd \\irow0\\irowband0\\ltrrow\n+\\ts11\\trgaph108\\trleft-108\\trkeep\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddfr3\\tblind0\\tblindtype3 \\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \n+\\cltxlrtb\\clftsWidth3\\clwWidth5508\\clshdrawnil \\cellx5400\\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \\cltxlrtb\\clftsWidth3\\clwWidth4912\\clshdrawnil \\cellx10312\\pard\\plain \\ltrpar\\ql \\li0\\ri0\\widctlpar\\intbl\n+\\tx5670\\tx8222\\wrapdefault\\faauto\\rin0\\lin0 \\rtlch\\fcs1 \\af0\\afs24\\alang1025 \\ltrch\\fcs0 \\fs24\\lang2057\\langfe1033\\cgrid\\langnp2057\\langfenp1033 {\\rtlch\\fcs1 \\af1\\afs18 \\ltrch\\fcs0 \\f1\\fs18\\cf1\\lang2057\\langfe2057\\langfenp2057\\insrsid6695929 \\cell \n+}\\pard \\ltrpar\\qc \\li0\\ri0\\widctlpar\\intbl\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0\\pararsid16338741 {\\rtlch\\fcs1 \\af1\\afs18 \\ltrch\\fcs0 \\f1\\fs18\\lang2057\\langfe2057\\langfenp2057\\insrsid6695929 \\cell }\\pard \\ltrpar\n+\\ql \\li0\\ri0\\sa200\\sl276\\slmult1\\widctlpar\\intbl\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\rtlch\\fcs1 \\af1 \\ltrch\\fcs0 \\f1\\fs20\\insrsid6695929 \\trowd \\irow0\\irowband0\\ltrrow\n+\\ts11\\trgaph108\\trleft-108\\trkeep\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddfr3\\tblind0\\tblindtype3 \\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \n+\\cltxlrtb\\clftsWidth3\\clwWidth5508\\clshdrawnil \\cellx5400\\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \\cltxlrtb\\clftsWidth3\\clwWidth4912\\clshdrawnil \\cellx10312\\row \\ltrrow}\\trowd \\irow1\\irowband1\\lastrow \\ltrrow\n+\\ts11\\trgaph108\\trleft-108\\trkeep\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddfr3\\tblind0\\tblindtype3 \\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \n+\\cltxlrtb\\clftsWidth3\\clwWidth10420\\clshdrawnil \\cellx10312\\pard \\ltrpar\\ql \\li0\\ri0\\widctlpar\\intbl\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\rtlch\\fcs1 \\af1\\afs18 \\ltrch\\fcs0 \\f1\\fs8\\lang2057\\langfe2057\\langfenp2057\\insrsid6695929 \n+\\cell }\\pard \\ltrpar\\ql \\li0\\ri0\\sa200\\sl276\\slmult1\\widctlpar\\intbl\\wrapdefault\\aspalpha\\aspnum\\faauto\\adjustright\\rin0\\lin0 {\\rtlch\\fcs1 \\af1 \\ltrch\\fcs0 \\f1\\fs20\\insrsid6695929 \\trowd \\irow1\\irowband1\\lastrow \\ltrrow\n+\\ts11\\trgaph108\\trleft-108\\trkeep\\trftsWidth1\\trftsWidthB3\\trftsWidthA3\\trpaddl108\\trpaddr108\\trpaddfl3\\trpaddfr3\\tblind0\\tblindtype3 \\clvertalc\\clbrdrt\\brdrtbl \\clbrdrl\\brdrtbl \\clbrdrb\\brdrtbl \\clbrdrr\\brdrtbl \n+\\cltxlrtb\\clftsWidth3\\clwWidth10420\\clshdrawnil \\cellx10312\\row }\\pard \\ltrpar\\qj \\li0\\ri0\\widctlpar\\tx0\\wrapdefault\\aspalpha\\aspnum\\faauto\\outlinelevel0\\adjustright\\rin0\\lin0\\itap0\\pararsid15429861 {\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\f171\\fs20\\insrsid2504751 \n+Example text to extract from RTF.}{\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\f171\\fs20\\insrsid15429861 \n+\\par \n+\\par \n+\\par }{\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\b\\f171\\fs20\\ul\\insrsid15429861 \n+\\par }{\\rtlch\\fcs1 \\af0 \\ltrch\\fcs0 \\b\\f171\\fs20\\ul\\insrsid15429861\\charrsid4947815 \n+\\par }{\\*\\themedata 504b030414000600080000002100828abc13fa0000001c020000130000005b436f6e74656e745f54797065735d2e786d6cac91cb6ac3301045f785fe83d0b6d8\n+72ba28a5d8cea249777d2cd20f18e4b12d6a8f843409c9df77ecb850ba082d74231062ce997b55ae8fe3a00e1893f354e9555e6885647de3a8abf4fbee29bbd7\n+2a3150038327acf409935ed7d757e5ee14302999a654e99e393c18936c8f23a4dc072479697d1c81e51a3b13c07e4087e6b628ee8cf5c4489cf1c4d075f92a0b\n+44d7a07a83c82f308ac7b0a0f0fbf90c2480980b58abc733615aa2d210c2e02cb04430076a7ee833dfb6ce62e3ed7e14693e8317d8cd0433bf5c60f53fea2fe7\n+065bd80facb647e9e25c7fc421fd2ddb526b2e9373fed4bb902e182e97b7b461e6bfad3f010000ffff0300504b030414000600080000002100a5d6a7e7c00000\n+00360100000b0000005f72656c732f2e72656c73848fcf6ac3300c87ef85bd83d17d51d2c31825762fa590432fa37d00e1287f68221bdb1bebdb4fc7060abb08\n+84a4eff7a93dfeae8bf9e194e720169aaa06c3e2433fcb68e1763dbf7f82c985a4a725085b787086a37bdbb55fbc50d1a33ccd311ba548b63095120f88d94fbc\n+52ae4264d1c910d24a45db3462247fa791715fd71f989e19e0364cd3f51652d73760ae8fa8c9ffb3c330cc9e4fc17faf2ce545046e37944c69e462a1a82fe353\n+bd90a865aad41ed0b5b8f9d6fd010000ffff0300504b0304140006000800000021006b799616830000008a0000001c0000007468656d652f7468656d652f7468\n+656d654d616e616765722e786d6c0ccc4d0ac3201040e17da17790d93763bb284562b2cbaebbf600439c1a41c7a0d29fdbd7e5e38337cedf14d59b4b0d592c9c\n+070d8a65cd2e88b7f07c2ca71ba8da481cc52c6ce1c715e6e97818c9b48d13df49c873517d23d59085adb5dd20d6b52bd521ef2cdd5eb9246a3d8b4757e8d3f7\n+29e245eb2b260a0238fd010000ffff0300504b03041400060008000000210096b5ade296060000501b0000160000007468656d652f7468656d652f7468656d65\n+312e786d6cec594f6fdb3614bf0fd87720746f6327761a07758ad8b19b2d4d1bc46e871e698996d850a240d2497d1bdae38001c3ba618715d86d87615b8116d8\n+a5fb34d93a6c1dd0afb0475292c5585e9236d88aad3e2412f9e3fbff1e1fa9abd7eec70c1d1221294fda5efd72cd4324f1794093b0eddd1ef62fad79482a9c04\n+98f184b4bd2991deb58df7dfbb8ad755446282607d22d771db8b944ad79796a40fc3585ee62949606ecc458c15bc8a702910f808e8c66c69b9565b5d8a314d3c\n+94e018c8de1a8fa94fd05093f43672e23d06af89927ac06762a049136785c10607758d9053d965021d62d6f6804fc08f86e4bef210c352c144dbab999fb7b471\n+7509af678b985ab0b6b4ae6f7ed9ba6c4170b06c788a705430adf71bad2b5b057d03606a1ed7ebf5babd7a41cf00b0ef83a6569632cd467faddec9699640f671\n+9e76b7d6ac355c7c89feca9cccad4ea7d36c65b258a206641f1b73f8b5da6a6373d9c11b90c537e7f08dce66b7bbeae00dc8e257e7f0fd2badd5868b37a088d1\n+e4600ead1ddaef67d40bc898b3ed4af81ac0d76a197c86826828a24bb318f3442d8ab518dfe3a20f000d6458d104a9694ac6d88728eee2782428d60cf03ac1a5\n+193be4cbb921cd0b495fd054b5bd0f530c1931a3f7eaf9f7af9e3f45c70f9e1d3ff8e9f8e1c3e3073f5a42ceaa6d9c84e5552fbffdeccfc71fa33f9e7ef3f2d1\n+17d57859c6fffac327bffcfc793510d26726ce8b2f9ffcf6ecc98baf3efdfdbb4715f04d814765f890c644a29be408edf3181433567125272371be15c308d3f2\n+8acd249438c19a4b05fd9e8a1cf4cd296699771c393ac4b5e01d01e5a30a787d72cf1178108989a2159c77a2d801ee72ce3a5c545a6147f32a99793849c26ae6\n+6252c6ed637c58c5bb8b13c7bfbd490a75330f4b47f16e441c31f7184e140e494214d273fc80900aedee52ead87597fa824b3e56e82e451d4c2b4d32a423279a\n+668bb6690c7e9956e90cfe766cb37b077538abd27a8b1cba48c80acc2a841f12e698f13a9e281c57911ce298950d7e03aba84ac8c154f8655c4f2af074481847\n+bd804859b5e696007d4b4edfc150b12addbecba6b18b148a1e54d1bc81392f23b7f84137c2715a851dd0242a633f900710a218ed715505dfe56e86e877f0034e\n+16bafb0e258ebb4faf06b769e888340b103d3311da9750aa9d0a1cd3e4efca31a3508f6d0c5c5c398602f8e2ebc71591f5b616e24dd893aa3261fb44f95d843b\n+5974bb5c04f4edafb95b7892ec1108f3f98de75dc97d5772bdff7cc95d94cf672db4b3da0a6557f70db629362d72bcb0431e53c6066acac80d699a6409fb44d0\n+8741bdce9c0e4971624a2378cceaba830b05366b90e0ea23aaa241845368b0eb9e2612ca8c742851ca251ceccc70256d8d87265dd96361531f186c3d9058edf2\n+c00eafe8e1fc5c509031bb4d680e9f39a3154de0accc56ae644441edd76156d7429d995bdd88664a9dc3ad50197c38af1a0c16d684060441db02565e85f3b966\n+0d0713cc48a0ed6ef7dedc2dc60b17e92219e180643ed27acffba86e9c94c78ab90980d8a9f0913ee49d62b512b79626fb06dccee2a432bbc60276b9f7dec44b\n+7904cfbca4f3f6443ab2a49c9c2c41476dafd55c6e7ac8c769db1bc399161ee314bc2e75cf8759081743be1236ec4f4d6693e5336fb672c5dc24a8c33585b5fb\n+9cc24e1d4885545b58463634cc5416022cd19cacfccb4d30eb45296023fd35a458598360f8d7a4003bbaae25e331f155d9d9a5116d3bfb9a95523e51440ca2e0\n+088dd844ec6370bf0e55d027a012ae264c45d02f708fa6ad6da6dce29c255df9f6cae0ec38666984b372ab5334cf640b37795cc860de4ae2816e95b21be5ceaf\n+8a49f90b52a51cc6ff3355f47e0237052b81f6800fd7b802239daf6d8f0b1571a8426944fdbe80c6c1d40e8816b88b8569082ab84c36ff0539d4ff6dce591a26\n+ade1c0a7f669880485fd484582903d284b26fa4e2156cff62e4b9265844c4495c495a9157b440e091bea1ab8aaf7760f4510eaa69a6465c0e04ec69ffb9e65d0\n+28d44d4e39df9c1a52ecbd3607fee9cec7263328e5d661d3d0e4f62f44acd855ed7ab33cdf7bcb8ae889599bd5c8b3029895b6825696f6af29c239b75a5bb1e6\n+345e6ee6c28117e73586c1a2214ae1be07e93fb0ff51e133fb65426fa843be0fb515c187064d0cc206a2fa926d3c902e907670048d931db4c1a44959d366ad93\n+b65abe595f70a75bf03d616c2dd959fc7d4e6317cd99cbcec9c58b34766661c7d6766ca1a9c1b327531486c6f941c638c67cd22a7f75e2a37be0e82db8df9f30\n+254d30c1372581a1f51c983c80e4b71ccdd28dbf000000ffff0300504b0304140006000800000021000dd1909fb60000001b010000270000007468656d652f74\n+68656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73848f4d0ac2301484f78277086f6fd3ba109126dd88d0add40384e4350d363f24\n+51eced0dae2c082e8761be9969bb979dc9136332de3168aa1a083ae995719ac16db8ec8e4052164e89d93b64b060828e6f37ed1567914b284d262452282e3198\n+720e274a939cd08a54f980ae38a38f56e422a3a641c8bbd048f7757da0f19b017cc524bd62107bd5001996509affb3fd381a89672f1f165dfe514173d9850528\n+a2c6cce0239baa4c04ca5bbabac4df000000ffff0300504b01022d0014000600080000002100828abc13fa0000001c0200001300000000000000000000000000\n+000000005b436f6e74656e745f54797065735d2e786d6c504b01022d0014000600080000002100a5d6a7e7c0000000360100000b000000000000000000000000\n+002b0100005f72656c732f2e72656c73504b01022d00140006000800000021006b799616830000008a0000001c00000000000000000000000000140200007468\n+656d652f7468656d652f7468656d654d616e616765722e786d6c504b01022d001400060008000000210096b5ade296060000501b000016000000000000000000\n+00000000d10200007468656d652f7468656d652f7468656d65312e786d6c504b01022d00140006000800000021000dd1909fb60000001b010000270000000000\n+00000000000000009b0900007468656d652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c73504b050600000000050005005d010000960a00000000}\n+{\\*\\colorschememapping 3c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d3822207374616e64616c6f6e653d22796573223f3e0d0a3c613a636c724d\n+617020786d6c6e733a613d22687474703a2f2f736368656d61732e6f70656e786d6c666f726d6174732e6f72672f64726177696e676d6c2f323030362f6d6169\n+6e22206267313d226c743122207478313d22646b3122206267323d226c743222207478323d22646b322220616363656e74313d22616363656e74312220616363\n+656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d22616363656e74342220616363656e74353d22616363656e74352220616363656e74363d22616363656e74362220686c696e6b3d22686c696e6b2220666f6c486c696e6b3d22666f6c486c696e6b222f3e}\n+{\\*\\latentstyles\\lsdstimax267\\lsdlockeddef0\\lsdsemihiddendef1\\lsdunhideuseddef1\\lsdqformatdef0\\lsdprioritydef99{\\lsdlockedexcept \\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority0 \\lsdlocked0 Normal;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 2;\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 4;\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 5;\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 6;\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 7;\n+\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 8;\\lsdqformat1 \\lsdpriority9 \\lsdlocked0 heading 9;\\lsdpriority39 \\lsdlocked0 toc 1;\\lsdpriority39 \\lsdlocked0 toc 2;\\lsdpriority39 \\lsdlocked0 toc 3;\\lsdpriority39 \\lsdlocked0 toc 4;\n+\\lsdpriority39 \\lsdlocked0 toc 5;\\lsdpriority39 \\lsdlocked0 toc 6;\\lsdpriority39 \\lsdlocked0 toc 7;\\lsdpriority39 \\lsdlocked0 toc 8;\\lsdpriority39 \\lsdlocked0 toc 9;\\lsdqformat1 \\lsdpriority35 \\lsdlocked0 caption;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority10 \\lsdlocked0 Title;\\lsdpriority1 \\lsdlocked0 Default Paragraph Font;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority11 \\lsdlocked0 Subtitle;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority22 \\lsdlocked0 Strong;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority20 \\lsdlocked0 Emphasis;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority59 \\lsdlocked0 Table Grid;\n+\\lsdunhideused0 \\lsdlocked0 Placeholder Text;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority1 \\lsdlocked0 No Spacing;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 1;\\lsdunhideused0 \\lsdlocked0 Revision;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority34 \\lsdlocked0 List Paragraph;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority29 \\lsdlocked0 Quote;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority30 \\lsdlocked0 Intense Quote;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 1;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 1;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 2;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 2;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 3;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 3;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 4;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 4;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 4;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 4;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 4;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 4;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 5;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 5;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 5;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 5;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 5;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 5;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority60 \\lsdlocked0 Light Shading Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority61 \\lsdlocked0 Light List Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority62 \\lsdlocked0 Light Grid Accent 6;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority63 \\lsdlocked0 Medium Shading 1 Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority64 \\lsdlocked0 Medium Shading 2 Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority65 \\lsdlocked0 Medium List 1 Accent 6;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority66 \\lsdlocked0 Medium List 2 Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority67 \\lsdlocked0 Medium Grid 1 Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority68 \\lsdlocked0 Medium Grid 2 Accent 6;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority69 \\lsdlocked0 Medium Grid 3 Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority70 \\lsdlocked0 Dark List Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority71 \\lsdlocked0 Colorful Shading Accent 6;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority72 \\lsdlocked0 Colorful List Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdpriority73 \\lsdlocked0 Colorful Grid Accent 6;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority19 \\lsdlocked0 Subtle Emphasis;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority21 \\lsdlocked0 Intense Emphasis;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority31 \\lsdlocked0 Subtle Reference;\n+\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority32 \\lsdlocked0 Intense Reference;\\lsdsemihidden0 \\lsdunhideused0 \\lsdqformat1 \\lsdpriority33 \\lsdlocked0 Book Title;\\lsdpriority37 \\lsdlocked0 Bibliography;\n+\\lsdqformat1 \\lsdpriority39 \\lsdlocked0 TOC Heading;}}{\\*\\datastore 0105000002000000180000004d73786d6c322e534158584d4c5265616465722e352e3000000000000000000000060000\n+d0cf11e0a1b11ae1000000000000000000000000000000003e000300feff090006000000000000000000000001000000010000000000000000100000feffffff00000000feffffff0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+fffffffffffffffffdfffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\n+ffffffffffffffffffffffffffffffff52006f006f007400200045006e00740072007900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000500ffffffffffffffffffffffffec69d9888b8b3d4c859eaf6cd158be0f0000000000000000000000004077\n+60480b5dd101feffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000\n+000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffff000000000000000000000000000000000000000000000000\n+0000000000000000000000000000000000000000000000000105000000000000}}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/tika/raw/1e0159b733dc7a8f48ce8943e1f15046c791349a/tika-server/src/test/resources/testRTF_npeFromWMFInTikaServer.rtf",
                "sha": "a5870e52772fdcd9967e2b1256b627ce5a5681b9",
                "status": "added"
            }
        ],
        "message": "TIKA-1845: fix npe created by combination of error in RTFEmbObjHandler and failure to handle null in TikaResource",
        "parent": "https://github.com/apache/tika/commit/fabeac95b56b0f430593881b705d9c57842f04a5",
        "patched_files": [
            "RTFEmbObjHandler.java",
            "TikaResource.java",
            "testRTF_npeFromWMFInTikaServer.rtf"
        ],
        "repo": "tika",
        "unit_tests": [
            "TikaResourceTest.java"
        ]
    },
    "tika_1e8e3c8": {
        "bug_id": "tika_1e8e3c8",
        "commit": "https://github.com/apache/tika/commit/1e8e3c86d433337100aabfd9e22ce4cb2998ea9f",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/1e8e3c86d433337100aabfd9e22ce4cb2998ea9f/tika-parsers/src/main/java/org/apache/tika/parser/video/FLVParser.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/video/FLVParser.java?ref=1e8e3c86d433337100aabfd9e22ce4cb2998ea9f",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/video/FLVParser.java",
                "patch": "@@ -239,6 +239,9 @@ public void parse(\n                     // separate AMF blocks, we currently loose previous values)\n                     Map<String, Object> extractedMetadata = (Map<String, Object>) data;\n                     for (Entry<String, Object> entry : extractedMetadata.entrySet()) {\n+                        if (entry.getValue() == null) {\n+                            continue;\n+                        }\n                         metadata.set(entry.getKey(), entry.getValue().toString());\n                     }\n                 }",
                "raw_url": "https://github.com/apache/tika/raw/1e8e3c86d433337100aabfd9e22ce4cb2998ea9f/tika-parsers/src/main/java/org/apache/tika/parser/video/FLVParser.java",
                "sha": "445f8127d5f0c6727ac98da0f5e37f876e4a8508",
                "status": "modified"
            }
        ],
        "message": "TIKA-1166: FLVParser NullPointerException\n   - Added check for null entry value\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1518318 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/a7e03539f9944f4847164b4bfa14b1f2db077331",
        "patched_files": [
            "FLVParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "FLVParserTest.java"
        ]
    },
    "tika_2e6b1bc": {
        "bug_id": "tika_2e6b1bc",
        "commit": "https://github.com/apache/tika/commit/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1",
        "file": [
            {
                "additions": 23,
                "blob_url": "https://github.com/apache/tika/blob/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java?ref=2e6b1bccfd5425f424da9ae8ceca7225a247b3f1",
                "deletions": 19,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "patch": "@@ -177,25 +177,29 @@ private void extractEmbeddedDocuments(ParseContext context, PDDocument document,\n                     embeddedExtractor = new ParsingEmbeddedDocumentExtractor(context);\n                 }\n \n-                for (Map.Entry<String,Object> ent : embeddedFiles.getNames().entrySet()) {\n-                    PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();\n-                    PDEmbeddedFile file = spec.getEmbeddedFile();\n-\n-                    Metadata metadata = new Metadata();\n-                    // TODO: other metadata?\n-                    metadata.set(Metadata.RESOURCE_NAME_KEY, ent.getKey());\n-                    metadata.set(Metadata.CONTENT_TYPE, file.getSubtype());\n-                    metadata.set(Metadata.CONTENT_LENGTH, Long.toString(file.getSize()));\n-\n-                    if (embeddedExtractor.shouldParseEmbedded(metadata)) {\n-                        TikaInputStream stream = TikaInputStream.get(file.createInputStream());\n-                        try {\n-                            embeddedExtractor.parseEmbedded(\n-                                    stream,\n-                                    new EmbeddedContentHandler(handler),\n-                                    metadata, false);\n-                        } finally {\n-                            stream.close();\n+                Map<String,Object> embeddedFileNames = embeddedFiles.getNames();\n+\n+                if (embeddedFileNames != null) {\n+                    for (Map.Entry<String,Object> ent : embeddedFileNames.entrySet()) {\n+                        PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();\n+                        PDEmbeddedFile file = spec.getEmbeddedFile();\n+\n+                        Metadata metadata = new Metadata();\n+                        // TODO: other metadata?\n+                        metadata.set(Metadata.RESOURCE_NAME_KEY, ent.getKey());\n+                        metadata.set(Metadata.CONTENT_TYPE, file.getSubtype());\n+                        metadata.set(Metadata.CONTENT_LENGTH, Long.toString(file.getSize()));\n+\n+                        if (embeddedExtractor.shouldParseEmbedded(metadata)) {\n+                            TikaInputStream stream = TikaInputStream.get(file.createInputStream());\n+                            try {\n+                                embeddedExtractor.parseEmbedded(\n+                                                                stream,\n+                                                                new EmbeddedContentHandler(handler),\n+                                                                metadata, false);\n+                            } finally {\n+                                stream.close();\n+                            }\n                         }\n                     }\n                 }",
                "raw_url": "https://github.com/apache/tika/raw/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "sha": "6940cc73d92b48eb7744e917156838481f046b65",
                "status": "modified"
            }
        ],
        "message": "PDFBOX-1320: fix NPE when visiting embedded files\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1341819 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/ddf2c2a1be1f3b0b8bd792fd5025f1eb7e6b8d71",
        "patched_files": [
            "PDFParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "PDFParserTest.java"
        ]
    },
    "tika_308d26f": {
        "bug_id": "tika_308d26f",
        "commit": "https://github.com/apache/tika/commit/308d26fb297c6248f98d777b7a94192fc0ecfce2",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/308d26fb297c6248f98d777b7a94192fc0ecfce2/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java?ref=308d26fb297c6248f98d777b7a94192fc0ecfce2",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "patch": "@@ -103,7 +103,9 @@ public void parse(InputStream stream, ContentHandler handler, Metadata metadata,\n                     mailMetadata.add(EMAIL_FROMLINE_METADATA, curLine.substring(MBOX_RECORD_DIVIDER.length()));\n                     mailMetadata.set(Metadata.CONTENT_TYPE, \"message/rfc822\");\n                     curLine = reader.readLine();\n-\n+                    if (curLine == null) {\n+                        break;\n+                    }\n                     ByteArrayOutputStream message = new ByteArrayOutputStream(100000);\n                     do {\n                         if (curLine.startsWith(\" \") || curLine.startsWith(\"\\t\")) {",
                "raw_url": "https://github.com/apache/tika/raw/308d26fb297c6248f98d777b7a94192fc0ecfce2/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "sha": "83e26da89dc2fdb64a9a7660c60d0e76148bf6a0",
                "status": "modified"
            }
        ],
        "message": "TIKA-2097 fix npe in MboxParser",
        "parent": "https://github.com/apache/tika/commit/546646844cd68f420969555ebd526400f8550ce2",
        "patched_files": [
            "MboxParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "MboxParserTest.java"
        ]
    },
    "tika_35090b3": {
        "bug_id": "tika_35090b3",
        "commit": "https://github.com/apache/tika/commit/35090b30645cb20fbbc8c125850e303dcad5c24f",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/35090b30645cb20fbbc8c125850e303dcad5c24f/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java?ref=35090b30645cb20fbbc8c125850e303dcad5c24f",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "patch": "@@ -285,7 +285,9 @@ private void extractMetadata(PDDocument document, Metadata metadata)\n                 xmp.addXMLNSMapping(XMPSchemaPDFAId.NAMESPACE, XMPSchemaPDFAId.class);\n                 XMPSchemaPDFAId pdfaxmp = (XMPSchemaPDFAId) xmp.getSchemaByClass(XMPSchemaPDFAId.class);\n                 if( pdfaxmp != null ) {\n-                    metadata.set(\"pdfaid:part\", Integer.toString(pdfaxmp.getPart()));\n+                    if (pdfaxmp.getPart() != null) {\n+                        metadata.set(\"pdfaid:part\", Integer.toString(pdfaxmp.getPart()));\n+                    }\n                     if (pdfaxmp.getConformance() != null) {\n                         metadata.set(\"pdfaid:conformance\", pdfaxmp.getConformance());\n                         String version = \"A-\"+pdfaxmp.getPart()+pdfaxmp.getConformance().toLowerCase(Locale.ROOT);",
                "raw_url": "https://github.com/apache/tika/raw/35090b30645cb20fbbc8c125850e303dcad5c24f/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "sha": "c78259af9a577c40cd892d4ae7859bde0d366742",
                "status": "modified"
            }
        ],
        "message": "another npe in PDFParser\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1673417 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/3e9db56e11340c06c39e71df4d320033eda5810c",
        "patched_files": [
            "PDFParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "PDFParserTest.java"
        ]
    },
    "tika_3e79510": {
        "bug_id": "tika_3e79510",
        "commit": "https://github.com/apache/tika/commit/3e795106be703e44c0400c2617d340705748ef9e",
        "file": [
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/tika/blob/3e795106be703e44c0400c2617d340705748ef9e/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java?ref=3e795106be703e44c0400c2617d340705748ef9e",
                "deletions": 6,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "patch": "@@ -22,6 +22,7 @@\n import java.util.Arrays;\n import java.util.Collections;\n import java.util.HashSet;\n+import java.util.Map;\n import java.util.Set;\n import java.util.Map.Entry;\n \n@@ -108,12 +109,8 @@ public void parse(\n             // \"date\" Date date of the recording or release\n             // \"comment\" String an arbitrary text\n \n-            for (Entry<String, Object> entry : fileFormat.properties().entrySet()) {\n-                metadata.set(entry.getKey(), entry.getValue().toString());\n-            }\n-            for (Entry<String, Object> entry : audioFormat.properties().entrySet()) {\n-                metadata.set(entry.getKey(), entry.getValue().toString());\n-            }\n+            addMetadata(metadata, fileFormat.properties());\n+            addMetadata(metadata, audioFormat.properties());\n         } catch (UnsupportedAudioFileException e) {\n             // There is no way to know whether this exception was\n             // caused by the document being corrupted or by the format\n@@ -125,6 +122,17 @@ public void parse(\n         xhtml.endDocument();\n     }\n \n+    private void addMetadata(Metadata metadata, Map<String, Object> properties) {\n+        if (properties != null) {\n+            for (Entry<String, Object> entry : properties.entrySet()) {\n+                Object value = entry.getValue();\n+                if (value != null) {\n+                    metadata.set(entry.getKey(), value.toString());\n+                }\n+            }\n+        }\n+    }\n+\n     /**\n      * @deprecated This method will be removed in Apache Tika 1.0.\n      */",
                "raw_url": "https://github.com/apache/tika/raw/3e795106be703e44c0400c2617d340705748ef9e/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "sha": "328cb56f6c6c01ee5624f3f1efdfb83de4b69911",
                "status": "modified"
            }
        ],
        "message": "TIKA-585: AudioParser Fails with NPE on fileFormat.properties\n\nFix based on suggestion by Cyriel Vringer\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1060797 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/b65fad1d762bdc691258a4b5d473671e1162801f",
        "patched_files": [
            "AudioParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "AudioParserTest.java"
        ]
    },
    "tika_433f21c": {
        "bug_id": "tika_433f21c",
        "commit": "https://github.com/apache/tika/commit/433f21c4805e7bb930964f87d15c30f62e0eb5d5",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/433f21c4805e7bb930964f87d15c30f62e0eb5d5/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=433f21c4805e7bb930964f87d15c30f62e0eb5d5",
                "deletions": 1,
                "filename": "CHANGES.txt",
                "patch": "@@ -23,7 +23,8 @@ Release 1.3 - Current Development\n     occurred.  The id (rId) is included in the Metadata of each\n     embedded document as the new Metadata.EMBEDDED_RELATIONSHIP_ID\n     key, and TikaCLI prepends the rId (if present) onto the filename\n-    it extracts (TIKA-989).\n+    it extracts (TIKA-989).  Fixed NullPointerException when style is\n+    null (TIKA-1006).\n \n   * RTF: Page, word, character count and creation date metadata are\n     now extracted for RTF documents (TIKA-999).",
                "raw_url": "https://github.com/apache/tika/raw/433f21c4805e7bb930964f87d15c30f62e0eb5d5/CHANGES.txt",
                "sha": "b20d09e6b2f1af26369e0d08756d57f383567252",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/tika/blob/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java?ref=433f21c4805e7bb930964f87d15c30f62e0eb5d5",
                "deletions": 6,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "patch": "@@ -123,12 +123,14 @@ private void extractParagraph(XWPFParagraph paragraph, XHTMLContentHandler xhtml\n           XWPFStyle style = styles.getStyle(\n                 paragraph.getStyleID()\n           );\n-          \n-          TagAndStyle tas = WordExtractor.buildParagraphTagAndStyle(\n-                style.getName(), paragraph.getPartType() == BodyType.TABLECELL\n-          );\n-          tag = tas.getTag();\n-          styleClass = tas.getStyleClass();\n+\n+          if (style != null) {\n+             TagAndStyle tas = WordExtractor.buildParagraphTagAndStyle(\n+                   style.getName(), paragraph.getPartType() == BodyType.TABLECELL\n+             );\n+             tag = tas.getTag();\n+             styleClass = tas.getStyleClass();\n+          }\n        }\n        \n        if(styleClass == null) {",
                "raw_url": "https://github.com/apache/tika/raw/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "sha": "790f4a86f1c2f3f15c2bf5be9507a226f5ed5637",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tika/blob/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java?ref=433f21c4805e7bb930964f87d15c30f62e0eb5d5",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "patch": "@@ -897,4 +897,10 @@ public void testEmbeddedZipInPPTX() throws Exception {\n         assertTrue(i < j);\n         assertTrue(j < k);\n     }\n+  \n+    // TIKA-1006\n+    public void testWordNullStyle() throws Exception {\n+      String xml = getXML(\"testWORD_null_style.docx\").xml;        \n+      assertContains(\"Test av styrt dokument\", xml);\n+    }\n }",
                "raw_url": "https://github.com/apache/tika/raw/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "sha": "f0c681040b202b5b5514763aaafdfdb7106dad6b",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/test/resources/test-documents/testWORD_null_style.docx",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testWORD_null_style.docx?ref=433f21c4805e7bb930964f87d15c30f62e0eb5d5",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testWORD_null_style.docx",
                "raw_url": "https://github.com/apache/tika/raw/433f21c4805e7bb930964f87d15c30f62e0eb5d5/tika-parsers/src/test/resources/test-documents/testWORD_null_style.docx",
                "sha": "854e41718195e5eeeb82f42d3229d5748cb769d0",
                "status": "added"
            }
        ],
        "message": "TIKA-1006: don't NPE if style is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1397653 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/a846f7d215ab46a0ab027ad84e809484da81da80",
        "patched_files": [
            "XWPFWordExtractorDecorator.java",
            "testWORD_null_style.docx",
            "CHANGES.txt",
            "OOXMLParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OOXMLParserTest.java"
        ]
    },
    "tika_48580b0": {
        "bug_id": "tika_48580b0",
        "commit": "https://github.com/apache/tika/commit/48580b0dd9bae39d8a32192bc2b8c3e4177a84be",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/48580b0dd9bae39d8a32192bc2b8c3e4177a84be/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java?ref=48580b0dd9bae39d8a32192bc2b8c3e4177a84be",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "patch": "@@ -71,7 +71,9 @@ public void parse(InputStream stream, ContentHandler handler, Metadata metadata,\n                 //This fix should be done within POI\n                 if (record.getRecordType().equals(HwmfRecordType.createFontIndirect)) {\n                     HwmfFont font = ((HwmfText.WmfCreateFontIndirect) record).getFont();\n-                    charset = (font.getCharSet().getCharset() == null) ? LocaleUtil.CHARSET_1252 : font.getCharSet().getCharset();\n+                    charset = (font.getCharSet() == null || font.getCharSet().getCharset() == null)\n+                            ? LocaleUtil.CHARSET_1252 :\n+                            font.getCharSet().getCharset();\n                 }\n                 if (record.getRecordType().equals(HwmfRecordType.extTextOut)) {\n                     HwmfText.WmfExtTextOut textOut = (HwmfText.WmfExtTextOut) record;",
                "raw_url": "https://github.com/apache/tika/raw/48580b0dd9bae39d8a32192bc2b8c3e4177a84be/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "sha": "aef09f9d1e927823ec45d1ad49cf8a7a64b544bb",
                "status": "modified"
            }
        ],
        "message": "TIKA-2367 -- avoid npe in WMF",
        "parent": "https://github.com/apache/tika/commit/d87314734b7afe0687ffe756694e6f461a7e253e",
        "patched_files": [
            "WMFParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "WMFParserTest.java"
        ]
    },
    "tika_4c58d09": {
        "bug_id": "tika_4c58d09",
        "commit": "https://github.com/apache/tika/commit/4c58d09499bf164ed123410464d43c20b764b5d5",
        "file": [
            {
                "additions": 44,
                "blob_url": "https://github.com/apache/tika/blob/4c58d09499bf164ed123410464d43c20b764b5d5/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "changes": 82,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java?ref=4c58d09499bf164ed123410464d43c20b764b5d5",
                "deletions": 38,
                "filename": "tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "patch": "@@ -117,14 +117,15 @@ public static void main(String[] args) throws Exception {\n \n     private class OutputType {\n \n-        public void process(InputStream input, OutputStream output)\n+        public void process(\n+                InputStream input, OutputStream output, Metadata metadata)\n                 throws Exception {\n             Parser p = parser;\n             if (fork) {\n                 p = new ForkParser(TikaCLI.class.getClassLoader(), p);\n             }\n-            ContentHandler handler = getContentHandler(output);\n-            p.parse(input, handler, metadata, context);   \n+            ContentHandler handler = getContentHandler(output, metadata);\n+            p.parse(input, handler, metadata, context);\n             // fix for TIKA-596: if a parser doesn't generate\n             // XHTML output, the lack of an output document prevents\n             // metadata from being output: this fixes that\n@@ -136,76 +137,77 @@ public void process(InputStream input, OutputStream output)\n             }\n         }\n \n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             throw new UnsupportedOperationException();\n         }\n         \n     }\n \n     private final OutputType XML = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return getTransformerHandler(output, \"xml\", encoding, prettyPrint);\n         }\n     };\n \n     private final OutputType HTML = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return getTransformerHandler(output, \"html\", encoding, prettyPrint);\n         }\n     };\n \n     private final OutputType TEXT = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return new BodyContentHandler(getOutputWriter(output, encoding));\n         }\n     };\n \n     private final OutputType NO_OUTPUT = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output) {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) {\n             return new DefaultHandler();\n         }\n     };\n \n     private final OutputType TEXT_MAIN = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return new BoilerpipeContentHandler(getOutputWriter(output, encoding));\n         }\n     };\n     \n     private final OutputType METADATA = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n-            return new NoDocumentMetHandler(writer);\n+            return new NoDocumentMetHandler(metadata, writer);\n         }\n     };\n \n     private final OutputType JSON = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                     new PrintWriter(getOutputWriter(output, encoding));\n-            return new NoDocumentJSONMetHandler(writer);\n+            return new NoDocumentJSONMetHandler(metadata, writer);\n         }\n     };\n \n     private final OutputType XMP = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, final Metadata metadata) throws Exception {\n             final ContentHandler handler =\n                     getTransformerHandler(output, \"xml\", encoding, prettyPrint);\n             return new DefaultHandler() {\n@@ -222,8 +224,8 @@ public void endDocument() throws SAXException {\n \n     private final OutputType LANGUAGE = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n             return new ProfilingHandler() {\n@@ -237,7 +239,8 @@ public void endDocument() {\n \n     private final OutputType DETECT = new OutputType() {\n         @Override\n-        public void process(InputStream stream, OutputStream output)\n+        public void process(\n+                InputStream stream, OutputStream output, Metadata metadata)\n                 throws Exception {\n             PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n@@ -250,7 +253,8 @@ public void process(InputStream stream, OutputStream output)\n     /* Creates ngram profile */\n     private final OutputType CREATE_PROFILE = new OutputType() {\n         @Override\n-        public void process(InputStream stream, OutputStream output)\n+        public void process(\n+                InputStream stream, OutputStream output, Metadata metadata)\n                 throws Exception {\n             ngp = LanguageProfilerBuilder.create(profileName, stream, encoding);\n             FileOutputStream fos = new FileOutputStream(new File(profileName + \".ngp\"));\n@@ -268,8 +272,6 @@ public void process(InputStream stream, OutputStream output)\n \n     private Parser parser;\n \n-    private Metadata metadata;\n-\n     private OutputType type = XML;\n     \n     private LanguageProfilerBuilder ngp = null;\n@@ -386,14 +388,13 @@ public void process(String arg) throws Exception {\n             type = CREATE_PROFILE;\n         } else {\n             pipeMode = false;\n-            metadata = new Metadata();\n             if (serverMode) {\n                 new TikaServer(Integer.parseInt(arg)).start();\n             } else if (arg.equals(\"-\")) {\n                 InputStream stream =\n                     TikaInputStream.get(new CloseShieldInputStream(System.in));\n                 try {\n-                    type.process(stream, System.out);\n+                    type.process(stream, System.out, new Metadata());\n                 } finally {\n                     stream.close();\n                 }\n@@ -405,9 +406,10 @@ public void process(String arg) throws Exception {\n                 } else {\n                     url = new URL(arg);\n                 }\n+                Metadata metadata = new Metadata();\n                 InputStream input = TikaInputStream.get(url, metadata);\n                 try {\n-                    type.process(input, System.out);\n+                    type.process(input, System.out, metadata);\n                 } finally {\n                     input.close();\n                     System.out.flush();\n@@ -777,8 +779,9 @@ private void processSocketInBackground(final Socket socket) {\n                 public void run() {\n                     try {\n                         try {\n+                            InputStream input = socket.getInputStream();\n                             OutputStream output = socket.getOutputStream();\n-                            type.process(socket.getInputStream(), output);\n+                            type.process(input, output, new Metadata());\n                             output.flush();\n                         } finally {\n                             socket.close();\n@@ -794,13 +797,16 @@ public void run() {\n \n     }\n     \n-    private class NoDocumentMetHandler extends DefaultHandler{\n-        \n+    private class NoDocumentMetHandler extends DefaultHandler {\n+\n+        protected final Metadata metadata;\n+\n         protected PrintWriter writer;\n         \n         private boolean metOutput;\n-        \n-        public NoDocumentMetHandler(PrintWriter writer){\n+\n+        public NoDocumentMetHandler(Metadata metadata, PrintWriter writer){\n+            this.metadata = metadata;\n             this.writer = writer;\n             this.metOutput = false;\n         }\n@@ -834,8 +840,8 @@ public boolean metOutput(){\n         private NumberFormat formatter;\n         private Gson gson;\n        \n-        public NoDocumentJSONMetHandler(PrintWriter writer){\n-            super(writer);\n+        public NoDocumentJSONMetHandler(Metadata metadata, PrintWriter writer){\n+            super(metadata, writer);\n             \n             formatter = NumberFormat.getInstance();\n             gson = new Gson();",
                "raw_url": "https://github.com/apache/tika/raw/4c58d09499bf164ed123410464d43c20b764b5d5/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "sha": "fd5c2ee8ef8f36f6ebd3acab6398090bf41173e2",
                "status": "modified"
            }
        ],
        "message": "TIKA-934: Tika in server mode stops responding and reports NPE over and over in logs\n\nUse per-document Metadata instances instead of a single global one\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1355719 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/14113de27f6f8c0bb56d5b2d025acdf4ef2b1685",
        "patched_files": [
            "TikaCLI.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "TikaCLITest.java"
        ]
    },
    "tika_4f920c7": {
        "bug_id": "tika_4f920c7",
        "commit": "https://github.com/apache/tika/commit/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -8,6 +8,9 @@ Release 1.3 - Current Development\n \n   * PDF: Text from pop-up annotations is now extracted (TIKA-981)\n \n+  * PKCS7: Detached signatures no longer through NullPointerException\n+    (TIKA-986).\n+\n Release 1.2 - 07/10/2012\n ---------------------------------\n ",
                "raw_url": "https://github.com/apache/tika/raw/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/CHANGES.txt",
                "sha": "d758da275af8dca4dabb56854650ea4fd56a6fa0",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/tika/blob/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/main/java/org/apache/tika/parser/crypto/Pkcs7Parser.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/crypto/Pkcs7Parser.java?ref=4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/crypto/Pkcs7Parser.java",
                "patch": "@@ -60,7 +60,10 @@ public void parse(\n             CMSSignedDataParser parser =\n                     new CMSSignedDataParser(new CloseShieldInputStream(stream));\n             try {\n-                CMSTypedStream content = parser.getSignedContent();\n+                CMSTypedStream content = parser.getSignedContent();     \n+                if (content == null) {\n+                  throw new TikaException(\"cannot parse detached pkcs7 signature (no signed data to parse)\");\n+                }\n                 InputStream input = content.getContentStream();\n                 try {\n                     Parser delegate =",
                "raw_url": "https://github.com/apache/tika/raw/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/main/java/org/apache/tika/parser/crypto/Pkcs7Parser.java",
                "sha": "d66b95eb0c7a076abbe25f0f933c4d24a9e37d4a",
                "status": "modified"
            },
            {
                "additions": 45,
                "blob_url": "https://github.com/apache/tika/blob/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/test/java/org/apache/tika/parser/crypto/Pkcs7ParserTest.java",
                "changes": 45,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/crypto/Pkcs7ParserTest.java?ref=4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/crypto/Pkcs7ParserTest.java",
                "patch": "@@ -0,0 +1,45 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.tika.parser.crypto;\n+\n+import java.io.InputStream;\n+\n+import org.apache.tika.TikaTest;\n+import org.apache.tika.exception.TikaException;\n+import org.apache.tika.metadata.Metadata;\n+import org.apache.tika.parser.ParseContext;\n+import org.apache.tika.sax.BodyContentHandler;\n+import org.xml.sax.ContentHandler;\n+\n+public class Pkcs7ParserTest extends TikaTest {\n+    public void testDetachedSignature() throws Exception {\n+        InputStream input = Pkcs7ParserTest.class.getResourceAsStream(\n+                \"/test-documents/testDetached.p7s\");\n+        try {\n+            ContentHandler handler = new BodyContentHandler();\n+            Metadata metadata = new Metadata();\n+            new Pkcs7Parser().parse(input, handler, metadata, new ParseContext());\n+        } catch (NullPointerException npe) {\n+            fail(\"should not get NPE\");\n+        } catch (TikaException te) {\n+            assertTrue(te.toString().indexOf(\"cannot parse detached pkcs7 signature\") != -1);\n+        } finally {\n+            input.close();\n+        }\n+    }\n+}",
                "raw_url": "https://github.com/apache/tika/raw/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/test/java/org/apache/tika/parser/crypto/Pkcs7ParserTest.java",
                "sha": "9f40fb417bf36b9456a642e78aaf1b979ecef7d9",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/test/resources/test-documents/testDetached.p7s",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testDetached.p7s?ref=4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testDetached.p7s",
                "raw_url": "https://github.com/apache/tika/raw/4f920c7bc5fd262c2a83fe44a7fb7b7bcb2798b7/tika-parsers/src/test/resources/test-documents/testDetached.p7s",
                "sha": "f4f8be9d7f06d91fc426969a016fa358a4302350",
                "status": "added"
            }
        ],
        "message": "TIKA-986: don't throw NullPointerException on detached PKCS7 signature\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1379971 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/0ce025c5cf0ab44a87bc56835e34803827f74b97",
        "patched_files": [
            "Pkcs7Parser.java",
            "testDetached.p7s",
            "CHANGES.txt"
        ],
        "repo": "tika",
        "unit_tests": [
            "Pkcs7ParserTest.java"
        ]
    },
    "tika_53ef1b9": {
        "bug_id": "tika_53ef1b9",
        "commit": "https://github.com/apache/tika/commit/53ef1b992d779676987d737e634b66f45d58310b",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/53ef1b992d779676987d737e634b66f45d58310b/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java?ref=53ef1b992d779676987d737e634b66f45d58310b",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "patch": "@@ -307,6 +307,8 @@ private static Date MP4TimeToDate(long mp4Time) {\n     private static final long EPOC_AS_MP4_TIME = 2082844800l;\n     \n     private static <T extends Box> T getOrNull(ContainerBox box, Class<T> clazz) {\n+       if (box == null) return null;\n+\n        List<T> boxes = box.getBoxes(clazz);\n        if (boxes.size() == 0) {\n           return null;",
                "raw_url": "https://github.com/apache/tika/raw/53ef1b992d779676987d737e634b66f45d58310b/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "sha": "1507e762eb81f81a748b31c8bff3eadcd7a854e0",
                "status": "modified"
            }
        ],
        "message": "TIKA-852 Avoid NPE on missing metadata boxes\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1241975 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/5498c0eeea7d2a5d6d314bcddc7d307830e97c27",
        "patched_files": [
            "MP4Parser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "MP4ParserTest.java"
        ]
    },
    "tika_547bc73": {
        "bug_id": "tika_547bc73",
        "commit": "https://github.com/apache/tika/commit/547bc73ca009fade75a5fd6062160cd517fb035e",
        "file": [
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/tika/blob/547bc73ca009fade75a5fd6062160cd517fb035e/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java?ref=547bc73ca009fade75a5fd6062160cd517fb035e",
                "deletions": 2,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java",
                "patch": "@@ -240,7 +240,7 @@ public static void parse(\n         }\n     }\n \n-    private static POIXMLTextExtractor trySXWPF(OPCPackage pkg) throws XmlException, OpenXML4JException, IOException {\n+    private static POIXMLTextExtractor trySXWPF(OPCPackage pkg) throws TikaException, XmlException, OpenXML4JException, IOException {\n         PackageRelationshipCollection packageRelationshipCollection = pkg.getRelationshipsByType(\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\");\n         if (packageRelationshipCollection.size() == 0) {\n             packageRelationshipCollection = pkg.getRelationshipsByType(\"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument\");\n@@ -250,6 +250,9 @@ private static POIXMLTextExtractor trySXWPF(OPCPackage pkg) throws XmlException,\n             return null;\n         }\n         PackagePart corePart = pkg.getPart(packageRelationshipCollection.getRelationship(0));\n+        if (corePart == null) {\n+            throw new TikaException(\"Couldn't find core part.\");\n+        }\n         String targetContentType = corePart.getContentType();\n         for (XWPFRelation relation : XWPFWordExtractor.SUPPORTED_TYPES) {\n             if (targetContentType.equals(relation.getContentType())) {\n@@ -259,7 +262,8 @@ private static POIXMLTextExtractor trySXWPF(OPCPackage pkg) throws XmlException,\n         return null;\n     }\n \n-    private static POIXMLTextExtractor tryXSLF(OPCPackage pkg, boolean eventBased) throws XmlException, OpenXML4JException, IOException {\n+    private static POIXMLTextExtractor tryXSLF(OPCPackage pkg, boolean eventBased) throws TikaException, XmlException,\n+            OpenXML4JException, IOException {\n \n         PackageRelationshipCollection packageRelationshipCollection = pkg.getRelationshipsByType(\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\");\n         if (packageRelationshipCollection.size() == 0) {\n@@ -270,6 +274,9 @@ private static POIXMLTextExtractor tryXSLF(OPCPackage pkg, boolean eventBased) t\n             return null;\n         }\n         PackagePart corePart = pkg.getPart(packageRelationshipCollection.getRelationship(0));\n+        if (corePart == null) {\n+            throw new TikaException(\"Couldn't find core part\");\n+        }\n         String targetContentType = corePart.getContentType();\n \n         XSLFRelation[] xslfRelations = org.apache.poi.xslf.extractor.XSLFPowerPointExtractor.SUPPORTED_TYPES;",
                "raw_url": "https://github.com/apache/tika/raw/547bc73ca009fade75a5fd6062160cd517fb035e/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/OOXMLExtractorFactory.java",
                "sha": "15f2c339ce95ffeecd9e9e29866c84550817c1d0",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/547bc73ca009fade75a5fd6062160cd517fb035e/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java?ref=547bc73ca009fade75a5fd6062160cd517fb035e",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "patch": "@@ -42,6 +42,7 @@\n import java.util.regex.Matcher;\n import java.util.regex.Pattern;\n \n+import org.apache.ctakes.typesystem.type.syntax.O;\n import org.apache.poi.util.LocaleUtil;\n import org.apache.tika.TikaTest;\n import org.apache.tika.config.TikaConfig;\n@@ -1758,6 +1759,15 @@ public void testSigned() throws Exception {\n         assertEquals(\"true\", m.get(TikaCoreProperties.HAS_SIGNATURE));\n \n     }\n+\n+    @Test(expected = org.apache.tika.exception.TikaException.class)\n+    public void testTruncatedSAXDocx() throws Exception {\n+        ParseContext pc = new ParseContext();\n+        OfficeParserConfig c = new OfficeParserConfig();\n+        c.setUseSAXDocxExtractor(true);\n+        pc.set(OfficeParserConfig.class, c);\n+        getRecursiveMetadata(\"testWORD_truncated.docx\", pc);\n+    }\n }\n \n ",
                "raw_url": "https://github.com/apache/tika/raw/547bc73ca009fade75a5fd6062160cd517fb035e/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "sha": "0cdb4dc4693c7be63e9df97132e29298216fe945",
                "status": "modified"
            }
        ],
        "message": "prevent NPE in SAX parsing options on truncated files.",
        "parent": "https://github.com/apache/tika/commit/9d2764319a42ac2169a9d0f0bc88f99fa226aea9",
        "patched_files": [
            "OOXMLExtractorFactory.java",
            "OOXMLParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OOXMLParserTest.java"
        ]
    },
    "tika_57ee179": {
        "bug_id": "tika_57ee179",
        "commit": "https://github.com/apache/tika/commit/57ee179862d6f1a15cea6745ca3d1c8e8e7ff800",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/57ee179862d6f1a15cea6745ca3d1c8e8e7ff800/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java?ref=57ee179862d6f1a15cea6745ca3d1c8e8e7ff800",
                "deletions": 1,
                "filename": "tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "patch": "@@ -157,9 +157,18 @@ public void addText(char[] cbuf, int off, int len) {\n \t\twriter.write(' ');\n \t}\n \n+        /**\n+         * {@inheritDoc}\n+         *\n+         * @throws IllegalStateException if no models have been loaded with\n+         * {@link #loadModels() } or {@link #loadModels(java.util.Set) }\n+         * @return the detected list of languages\n+         */\n \t@Override\n \tpublic List<LanguageResult> detectAll() {\n-\t\t// TODO throw exception if models haven't been loaded, or auto-load all?\n+\t\tif(detector == null) {\n+                    throw new IllegalStateException(\"models haven't been loaded yet (forgot to call loadModels?)\");\n+                }\n \t\t\n \t\tList<LanguageResult> result = new ArrayList<>();\n \t\t",
                "raw_url": "https://github.com/apache/tika/raw/57ee179862d6f1a15cea6745ca3d1c8e8e7ff800/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "sha": "d31559238f519e958ade1b672c477089abaee14a",
                "status": "modified"
            }
        ],
        "message": "TIKA-2439 throwing IllegalStateException in OptimaizeLangDetector.detectAll if no module have been loaded and thus detector is null which avoid an unhelpful NullPointerException",
        "parent": "https://github.com/apache/tika/commit/4455a6f087bbd52767e55478e9d51fdb39adbce6",
        "patched_files": [
            "OptimaizeLangDetector.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OptimaizeLangDetectorTest.java"
        ]
    },
    "tika_5ffe387": {
        "bug_id": "tika_5ffe387",
        "commit": "https://github.com/apache/tika/commit/5ffe387253086d52017d32f7d5b20cbd912d56a5",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/tika/blob/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java?ref=5ffe387253086d52017d32f7d5b20cbd912d56a5",
                "deletions": 5,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java",
                "patch": "@@ -388,11 +388,13 @@ public void handleDateTags(Directory directory, Metadata metadata)\n             }\n             if (directory.containsTag(ExifIFD0Directory.TAG_DATETIME)) {\n                 Date datetime = directory.getDate(ExifIFD0Directory.TAG_DATETIME);\n-                String datetimeNoTimeZone = DATE_UNSPECIFIED_TZ.format(datetime);\n-                metadata.set(TikaCoreProperties.MODIFIED, datetimeNoTimeZone);\n-                // If Date/Time Original does not exist this might be creation date\n-                if (metadata.get(TikaCoreProperties.CREATED) == null) {\n-                    metadata.set(TikaCoreProperties.CREATED, datetimeNoTimeZone);\n+                if (datetime != null) {\n+                    String datetimeNoTimeZone = DATE_UNSPECIFIED_TZ.format(datetime);\n+                    metadata.set(TikaCoreProperties.MODIFIED, datetimeNoTimeZone);\n+                    // If Date/Time Original does not exist this might be creation date\n+                    if (metadata.get(TikaCoreProperties.CREATED) == null) {\n+                        metadata.set(TikaCoreProperties.CREATED, datetimeNoTimeZone);\n+                    }\n                 }\n             }\n         }",
                "raw_url": "https://github.com/apache/tika/raw/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/main/java/org/apache/tika/parser/image/ImageMetadataExtractor.java",
                "sha": "2a0aa7ae9a47ac536c1d71eea4430332aa5cd6c7",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/test/java/org/apache/tika/parser/jpeg/JpegParserTest.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/jpeg/JpegParserTest.java?ref=5ffe387253086d52017d32f7d5b20cbd912d56a5",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/jpeg/JpegParserTest.java",
                "patch": "@@ -225,4 +225,14 @@ public void testJPEGoddTagComponent() throws Exception {\n        assertEquals(\"251\", metadata.get(Metadata.IMAGE_WIDTH));\n        assertEquals(\"384\", metadata.get(Metadata.IMAGE_LENGTH));\n     }\n+    \n+    public void testJPEGEmptyEXIFDateTime() throws Exception {\n+        Metadata metadata = new Metadata();\n+        metadata.set(Metadata.CONTENT_TYPE, \"image/jpeg\");\n+        InputStream stream =\n+            getClass().getResourceAsStream(\"/test-documents/testJPEG_EXIF_emptyDateTime.jpg\");\n+        parser.parse(stream, new DefaultHandler(), metadata, new ParseContext());\n+        assertEquals(\"300.0\", metadata.get(TIFF.RESOLUTION_HORIZONTAL));\n+        assertEquals(\"300.0\", metadata.get(TIFF.RESOLUTION_VERTICAL));\n+     }\n }",
                "raw_url": "https://github.com/apache/tika/raw/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/test/java/org/apache/tika/parser/jpeg/JpegParserTest.java",
                "sha": "8739e016410abf111af9c266bb7ef68ef34fa2a7",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/test/resources/test-documents/testJPEG_EXIF_emptyDateTime.jpg",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testJPEG_EXIF_emptyDateTime.jpg?ref=5ffe387253086d52017d32f7d5b20cbd912d56a5",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testJPEG_EXIF_emptyDateTime.jpg",
                "raw_url": "https://github.com/apache/tika/raw/5ffe387253086d52017d32f7d5b20cbd912d56a5/tika-parsers/src/test/resources/test-documents/testJPEG_EXIF_emptyDateTime.jpg",
                "sha": "e732130517370df092628e635af76092499ac2d4",
                "status": "added"
            }
        ],
        "message": "TIKA-1115: ExifHandler throws NullPointerException\n   - Added check for null datetime\n   - Added file exhibiting problem datetime field\n   - Added unit test\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1478111 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/5f62566df57e7cd1f8733b1af02dfb90bb19fb31",
        "patched_files": [
            "JpegParser.java",
            "testJPEG_EXIF_emptyDateTime.jpg",
            "ImageMetadataExtractor.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "JpegParserTest.java",
            "ImageMetadataExtractorTest.java"
        ]
    },
    "tika_61671f5": {
        "bug_id": "tika_61671f5",
        "commit": "https://github.com/apache/tika/commit/61671f5d97d97e6f379dd94391ed8449f8c15073",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -1,5 +1,8 @@\n Release 1.12 - Current Development\n \n+  * Upgrade rome to 1.5.1 && Downgrade Rome dependency to 0.9 to avoid \n+    nasty NPE (TIKA-1820, TIKA-1516)\n+\n   * The NamedEntityParser was enhanced to generate text content\n     in addition to metadata (TIKA-1815, TIKA-1816).\n ",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/CHANGES.txt",
                "sha": "a5b86fe1247f029ac269a36209d73c32c64c54ec",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-bundle/pom.xml",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-bundle/pom.xml?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 8,
                "filename": "tika-bundle/pom.xml",
                "patch": "@@ -131,14 +131,14 @@\n               poi,poi-scratchpad,poi-ooxml,poi-ooxml-schemas,\n               xmlbeans,\n               jackcess,\n-              commons-lang,              \n+              commons-lang,\n               tagsoup,\n               asm,\n               juniversalchardet,\n               vorbis-java-core, vorbis-java-tika,\n               isoparser, aspectjrt,\n               metadata-extractor, xmpcore, json-simple,\n-              boilerpipe, rome, opennlp-tools, opennlp-maxent,\n+              boilerpipe, rome, rome-utils, opennlp-tools, opennlp-maxent,\n               geoapi, sis-metadata, sis-netcdf, sis-utility,\n               sis-storage, apache-mime4j-core, apache-mime4j-dom,\n               jsr-275, jhighlight, java-libpst, jwnl,\n@@ -185,7 +185,7 @@\n               javax.xml.stream;version=\"[1.0,2)\";resolution:=optional,\n               javax.xml.stream.events;version=\"[1.0,2)\";resolution:=optional,\n               javax.xml.stream.util;version=\"[1.0,2)\";resolution:=optional,\n-\t      javax.ws.rs.core;resolution:=optional,\n+              javax.ws.rs.core;resolution:=optional,\n               net.sf.ehcache;resolution:=optional,\n               nu.xom;resolution:=optional,\n               opendap.dap.http;resolution:=optional,\n@@ -194,8 +194,8 @@\n               opennlp.maxent;resolution:=optional,\n               opennlp.tools.namefind;resolution:=optional,\n               net.didion.jwnl;resolution:=optional,\n-\t      org.apache.cxf.jaxrs.client;resolution:=optional,\n-\t      org.apache.cxf.jaxrs.ext.multipart;resolution:=optional,\n+              org.apache.cxf.jaxrs.client;resolution:=optional,\n+              org.apache.cxf.jaxrs.ext.multipart;resolution:=optional,\n               org.apache.commons.exec;resolution:=optional,\n               org.apache.commons.io;resolution:=optional,\n               org.apache.commons.httpclient;resolution:=optional,\n@@ -246,9 +246,11 @@\n               org.jdom.output;resolution:=optional,\n               org.jdom2;resolution:=optional,\n               org.jdom2.input;resolution:=optional,\n+              org.jdom2.input.sax;resolution:=optional,\n               org.jdom2.output;resolution:=optional,\n+              org.jdom2.filter;resolution:=optional,\n               org.json.simple;resolution:=optional,\n-\t      org.json;resolution:=optional,\n+              org.json;resolution:=optional,\n               org.openxmlformats.schemas.officeDocument.x2006.math;resolution:=optional,\n               org.openxmlformats.schemas.schemaLibrary.x2006.main;resolution:=optional,\n               org.osgi.framework;resolution:=optional,\n@@ -295,7 +297,7 @@\n               ucar.unidata.io;resolution:=optional,\n               ucar.unidata.util;resolution:=optional,\n               com.jmatio.io;resolution:=optional,\n-\t      com.google.gson;resolution:=optional,\n+              com.google.gson;resolution:=optional,\n               visad;resolution:=optional,\n               visad.data;resolution:=optional,\n               visad.data.vis5d;resolution:=optional,\n@@ -331,7 +333,7 @@\n               com.google.common.base;resolution:=optional,\n               com.google.common.math;resolution:=optional,\n               org.apache.http;resolution:=optional,\n-\t      org.apache.http.client.utils;resolution:=optional,\n+              org.apache.http.client.utils;resolution:=optional,\n               org.joda.time;resolution:=optional,\n               org.joda.time.chrono;resolution:=optional,\n               org.joda.time.field;resolution:=optional,",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-bundle/pom.xml",
                "sha": "8e7c4e97b5617667041dffb121e873231f5295a0",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/pom.xml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/pom.xml?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 2,
                "filename": "tika-parsers/pom.xml",
                "patch": "@@ -196,9 +196,9 @@\n       <version>1.1.0</version>\n     </dependency>\n     <dependency>\n-      <groupId>rome</groupId>\n+      <groupId>com.rometools</groupId>\n       <artifactId>rome</artifactId>\n-      <version>1.0</version>\n+      <version>1.5.1</version>\n     </dependency>\n     <dependency>\n       <groupId>org.gagravarr</groupId>",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/pom.xml",
                "sha": "bb1bd71dcf8610bf161b76bf3535a8e389b26a72",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 5,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "patch": "@@ -35,11 +35,11 @@\n import org.xml.sax.InputSource;\n import org.xml.sax.SAXException;\n \n-import com.sun.syndication.feed.synd.SyndContent;\n-import com.sun.syndication.feed.synd.SyndEntry;\n-import com.sun.syndication.feed.synd.SyndFeed;\n-import com.sun.syndication.io.FeedException;\n-import com.sun.syndication.io.SyndFeedInput;\n+import com.rometools.rome.feed.synd.SyndContent;\n+import com.rometools.rome.feed.synd.SyndEntry;\n+import com.rometools.rome.feed.synd.SyndFeed;\n+import com.rometools.rome.io.FeedException;\n+import com.rometools.rome.io.SyndFeedInput;\n \n /**\n  * Feed parser.",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "sha": "428ff83d4dda78fbd548db4905ab543c9d344d04",
                "status": "modified"
            }
        ],
        "message": "TIKA-1820 Upgrade rome to 1.5.1 && TIKA-1516 Downgrade Rome dependency to 0.9 to avoid nasty NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1722935 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/e9718f90513f1a4cde62e79794089bc45b35e4af",
        "patched_files": [
            "pom.xml",
            "CHANGES.txt",
            "FeedParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "FeedParserTest.java"
        ]
    },
    "tika_65aea2b": {
        "bug_id": "tika_65aea2b",
        "commit": "https://github.com/apache/tika/commit/65aea2b06b33c6b53999b6c52e017c38bf2af0b4",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/65aea2b06b33c6b53999b6c52e017c38bf2af0b4/tika-translate/src/main/java/org/apache/tika/language/translate/MicrosoftTranslator.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-translate/src/main/java/org/apache/tika/language/translate/MicrosoftTranslator.java?ref=65aea2b06b33c6b53999b6c52e017c38bf2af0b4",
                "deletions": 3,
                "filename": "tika-translate/src/main/java/org/apache/tika/language/translate/MicrosoftTranslator.java",
                "patch": "@@ -56,7 +56,7 @@ public MicrosoftTranslator() {\n                 props.load(stream);\n                 clientId = props.getProperty(ID_PROPERTY);\n                 clientSecret = props.getProperty(SECRET_PROPERTY);\n-                if (!clientId.equals(DEFAULT_ID) && !clientSecret.equals(DEFAULT_SECRET)) available = true;\n+                this.available = checkAvailable();   \n             }\n         } catch (IOException e) {\n         \te.printStackTrace();\n@@ -119,7 +119,7 @@ public boolean isAvailable(){\n      */\n     public void setId(String id){\n     \tthis.clientId = id;\n-        if (!clientId.equals(DEFAULT_ID) && !clientSecret.equals(DEFAULT_SECRET)) available = true;\n+        this.available = checkAvailable();   \n     }\n     \n     /**\n@@ -128,6 +128,13 @@ public void setId(String id){\n      */\n     public void setSecret(String secret){\n     \tthis.clientSecret = secret;\n-        if (!clientId.equals(DEFAULT_ID) && !clientSecret.equals(DEFAULT_SECRET)) available = true;    \t\n+        this.available = checkAvailable();   \t\n+    }\n+    \n+    private boolean checkAvailable(){\n+       return clientId != null && \n+    \t\t   !clientId.equals(DEFAULT_ID) && \n+    \t\t   clientSecret != null && \n+    \t\t   !clientSecret.equals(DEFAULT_SECRET);\n     }\n }",
                "raw_url": "https://github.com/apache/tika/raw/65aea2b06b33c6b53999b6c52e017c38bf2af0b4/tika-translate/src/main/java/org/apache/tika/language/translate/MicrosoftTranslator.java",
                "sha": "85575debaeef2e5e65fcf8260229a0e016140ec9",
                "status": "modified"
            },
            {
                "additions": 29,
                "blob_url": "https://github.com/apache/tika/blob/65aea2b06b33c6b53999b6c52e017c38bf2af0b4/tika-translate/src/test/java/org/apache/tika/language/translate/MicrosoftTranslatorTest.java",
                "changes": 37,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-translate/src/test/java/org/apache/tika/language/translate/MicrosoftTranslatorTest.java?ref=65aea2b06b33c6b53999b6c52e017c38bf2af0b4",
                "deletions": 8,
                "filename": "tika-translate/src/test/java/org/apache/tika/language/translate/MicrosoftTranslatorTest.java",
                "patch": "@@ -21,35 +21,56 @@\n import org.junit.Test;\n \n import static org.junit.Assert.assertTrue;\n+import static org.junit.Assert.fail;\n \n /**\n  * Test cases for the {@link MicrosoftTranslator} class.\n  */\n public class MicrosoftTranslatorTest {\n-    Tika tika;\n+    MicrosoftTranslator translator;\n     @Before\n     public void setUp() {\n-        tika = new Tika();\n+        translator = new MicrosoftTranslator();\n     }\n \n     @Test\n     public void testSimpleTranslate() throws Exception {\n         String source = \"hello\";\n         String expected = \"salut\";\n-        String translated = tika.translate(source, \"en\", \"fr\");\n-        System.err.println(tika.getTranslator().isAvailable());\n-        if (tika.getTranslator().isAvailable()) assertTrue(\"Translate \" + source + \" to \" + expected + \" (was \" + translated + \")\",\n+        String translated = translator.translate(source, \"en\", \"fr\");\n+        if (translator.isAvailable()) assertTrue(\"Translate \" + source + \" to \" + expected + \" (was \" + translated + \")\",\n                 expected.equalsIgnoreCase(translated));\n     }\n \n     @Test\n     public void testSimpleDetectTranslate() throws Exception {\n         String source = \"hello\";\n         String expected = \"salut\";\n-        String translated = tika.translate(source, \"fr\");\n-        System.err.println(tika.getTranslator().isAvailable());\n-        if (tika.getTranslator().isAvailable()) assertTrue(\"Translate \" + source + \" to \" + expected + \" (was \" + translated + \")\",\n+        String translated = translator.translate(source, \"fr\");\n+        if (translator.isAvailable()) assertTrue(\"Translate \" + source + \" to \" + expected + \" (was \" + translated + \")\",\n                 expected.equalsIgnoreCase(translated));\n     }\n+    \n+    @Test\n+    public void testSettersAndIsAvailable(){\n+    \ttry{\n+    \t\ttranslator.setId(\"foo\");\n+    \t\ttranslator.setSecret(\"bar\");\n+    \t}\n+    \tcatch(Exception e){\n+    \t\te.printStackTrace();\n+    \t\tfail(e.getMessage());\n+    \t}\n+    \t//reset\n+    \ttranslator = new MicrosoftTranslator();\n+    \ttry{\n+    \t\ttranslator.setSecret(\"bar\");\n+    \t\ttranslator.setId(\"foo\");\n+    \t}\n+    \tcatch(Exception e){\n+    \t\te.printStackTrace();\n+    \t\tfail(e.getMessage());\n+    \t}\n+    }\n \n }",
                "raw_url": "https://github.com/apache/tika/raw/65aea2b06b33c6b53999b6c52e017c38bf2af0b4/tika-translate/src/test/java/org/apache/tika/language/translate/MicrosoftTranslatorTest.java",
                "sha": "a35281d5131e1b6dba3dfc6c74a8660d1ea89b33",
                "status": "modified"
            }
        ],
        "message": "- TIKA-1378: MicrosoftTranslator setClient and setId NPE (thanks to tpalsulich for the review!)\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1614488 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/ed355dd561963ab4eb6cc9423e4b86e4e817f26e",
        "patched_files": [
            "MicrosoftTranslator.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "MicrosoftTranslatorTest.java"
        ]
    },
    "tika_69852e4": {
        "bug_id": "tika_69852e4",
        "commit": "https://github.com/apache/tika/commit/69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
        "file": [
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java",
                "patch": "@@ -20,6 +20,7 @@\n import java.util.HashSet;\n import java.util.List;\n \n+import org.apache.poi.common.usermodel.Hyperlink;\n import org.apache.poi.hslf.model.Comment;\n import org.apache.poi.hslf.model.HeadersFooters;\n import org.apache.poi.hslf.model.OLEShape;\n@@ -267,7 +268,18 @@ private void textRunsToText(XHTMLContentHandler xhtml, List<List<HSLFTextParagra\n                 String paraTag = showBullet ? \"li\" : \"p\";\n \n                 xhtml.startElement(paraTag);\n+                boolean runIsHyperLink = false;\n                 for (HSLFTextRun htr : textRuns) {\n+                    Hyperlink link = htr.getHyperlink();\n+                    if (link != null) {\n+                        String address = link.getAddress();\n+                        //consider ignoring footnote refs:\n+                        // e.g. && ! address.startsWith(\"_ftnref\")\n+                        if (address != null) {\n+                            xhtml.startElement(\"a\", \"href\", link.getAddress());\n+                            runIsHyperLink = true;\n+                        }\n+                    }\n                     String line = htr.getRawText();\n                     if (line != null) {\n                         boolean isfirst = true;\n@@ -284,6 +296,10 @@ private void textRunsToText(XHTMLContentHandler xhtml, List<List<HSLFTextParagra\n                             xhtml.endElement(\"br\");\n                         }\n                     }\n+                    if (runIsHyperLink) {\n+                        xhtml.endElement(\"a\");\n+                    }\n+                    runIsHyperLink = false;\n                 }\n                 xhtml.endElement(paraTag);\n             }",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/HSLFExtractor.java",
                "sha": "cff07cc4fe7e5b360e708f609c7bec7a83c7ed30",
                "status": "modified"
            },
            {
                "additions": 38,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java",
                "changes": 59,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 21,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java",
                "patch": "@@ -21,6 +21,7 @@\n import java.util.ArrayList;\n import java.util.List;\n \n+import org.apache.poi.common.usermodel.Hyperlink;\n import org.apache.poi.openxml4j.exceptions.InvalidFormatException;\n import org.apache.poi.openxml4j.opc.PackagePart;\n import org.apache.poi.openxml4j.opc.PackagePartName;\n@@ -29,25 +30,7 @@\n import org.apache.poi.openxml4j.opc.TargetMode;\n import org.apache.poi.sl.usermodel.Placeholder;\n import org.apache.poi.xslf.extractor.XSLFPowerPointExtractor;\n-import org.apache.poi.xslf.usermodel.XMLSlideShow;\n-import org.apache.poi.xslf.usermodel.XSLFCommentAuthors;\n-import org.apache.poi.xslf.usermodel.XSLFComments;\n-import org.apache.poi.xslf.usermodel.XSLFGraphicFrame;\n-import org.apache.poi.xslf.usermodel.XSLFGroupShape;\n-import org.apache.poi.xslf.usermodel.XSLFNotes;\n-import org.apache.poi.xslf.usermodel.XSLFNotesMaster;\n-import org.apache.poi.xslf.usermodel.XSLFPictureShape;\n-import org.apache.poi.xslf.usermodel.XSLFRelation;\n-import org.apache.poi.xslf.usermodel.XSLFShape;\n-import org.apache.poi.xslf.usermodel.XSLFSheet;\n-import org.apache.poi.xslf.usermodel.XSLFSlide;\n-import org.apache.poi.xslf.usermodel.XSLFSlideLayout;\n-import org.apache.poi.xslf.usermodel.XSLFSlideShow;\n-import org.apache.poi.xslf.usermodel.XSLFTable;\n-import org.apache.poi.xslf.usermodel.XSLFTableCell;\n-import org.apache.poi.xslf.usermodel.XSLFTableRow;\n-import org.apache.poi.xslf.usermodel.XSLFTextParagraph;\n-import org.apache.poi.xslf.usermodel.XSLFTextShape;\n+import org.apache.poi.xslf.usermodel.*;\n import org.apache.tika.exception.TikaException;\n import org.apache.tika.parser.ParseContext;\n import org.apache.tika.sax.XHTMLContentHandler;\n@@ -155,8 +138,29 @@ private void extractContent(List<? extends XSLFShape> shapes, boolean skipPlaceh\n                 if (skipPlaceholders && ph != null) {\n                     continue;\n                 }\n+                boolean inHyperlink = false;\n                 for (XSLFTextParagraph p : txt.getTextParagraphs()) {\n-                    xhtml.element(\"p\", p.getText());\n+                    xhtml.startElement(\"p\");\n+                    p.getText();\n+\n+                    for (XSLFTextRun run : p.getTextRuns()) {\n+                        //TODO: add check for targetmode=external into POI\n+                        //then check to confirm that the urls are actually\n+                        //external and not footnote refs via the current hack\n+                        Hyperlink hyperlink = run.getHyperlink();\n+\n+                        if (hyperlink != null && hyperlink.getAddress() != null\n+                                && !hyperlink.getAddress().contains(\"#_ftn\")) {\n+                            xhtml.startElement(\"a\", \"href\", hyperlink.getAddress());\n+                            inHyperlink = true;\n+                        }\n+                        xhtml.characters(run.getRawText());\n+                        if (inHyperlink == true) {\n+                            xhtml.endElement(\"a\");\n+                        }\n+                        inHyperlink = false;\n+                    }\n+                    xhtml.endElement(\"p\");\n                 }\n             } else if (sh instanceof XSLFGroupShape) {\n                 // recurse into groups of shapes\n@@ -210,10 +214,23 @@ private void extractTable(XSLFTable tbl, XHTMLContentHandler xhtml) throws SAXEx\n         xhtml.startElement(\"table\");\n         for (XSLFTableRow row : tbl) {\n             xhtml.startElement(\"tr\");\n-            List<XSLFTableCell> cells = row.getCells();\n             for (XSLFTableCell c : row.getCells()) {\n                 xhtml.startElement(\"td\");\n+                //TODO: Need to wait for fix in POI to test for hyperlink first\n+                //shouldn't need to catch NPE...\n+                XSLFHyperlink hyperlink = null;\n+                try {\n+                    hyperlink = c.getHyperlink();\n+                } catch (NullPointerException e) {\n+                    //swallow\n+                }\n+                if (hyperlink != null && hyperlink.getAddress() != null) {\n+                    xhtml.startElement(\"a\", \"href\", hyperlink.getAddress());\n+                }\n                 xhtml.characters(c.getText());\n+                if (hyperlink != null && hyperlink.getAddress() != null) {\n+                    xhtml.endElement(\"a\");\n+                }\n                 xhtml.endElement(\"td\");\n             }\n             xhtml.endElement(\"tr\");",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSLFPowerPointExtractorDecorator.java",
                "sha": "dd14cea9f2252ff6bca9bf613cf179f63ef1d141",
                "status": "modified"
            },
            {
                "additions": 89,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java",
                "changes": 99,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 10,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java",
                "patch": "@@ -18,19 +18,13 @@\n \n import java.io.IOException;\n import java.io.InputStream;\n-import java.util.ArrayList;\n-import java.util.List;\n-import java.util.Locale;\n+import java.util.*;\n \n+import com.microsoft.schemas.vml.CTH;\n import org.apache.poi.hssf.extractor.ExcelExtractor;\n import org.apache.poi.openxml4j.exceptions.InvalidFormatException;\n import org.apache.poi.openxml4j.exceptions.OpenXML4JException;\n-import org.apache.poi.openxml4j.opc.OPCPackage;\n-import org.apache.poi.openxml4j.opc.PackagePart;\n-import org.apache.poi.openxml4j.opc.PackagePartName;\n-import org.apache.poi.openxml4j.opc.PackageRelationship;\n-import org.apache.poi.openxml4j.opc.PackagingURIHelper;\n-import org.apache.poi.openxml4j.opc.TargetMode;\n+import org.apache.poi.openxml4j.opc.*;\n import org.apache.poi.ss.usermodel.DataFormatter;\n import org.apache.poi.ss.usermodel.HeaderFooter;\n import org.apache.poi.xssf.eventusermodel.ReadOnlySharedStringsTable;\n@@ -51,6 +45,11 @@\n import org.apache.tika.parser.ParseContext;\n import org.apache.tika.sax.XHTMLContentHandler;\n import org.apache.xmlbeans.XmlException;\n+import org.bouncycastle.util.Pack;\n+import org.openxmlformats.schemas.drawingml.x2006.main.CTHyperlink;\n+import org.openxmlformats.schemas.drawingml.x2006.main.CTNonVisualDrawingProps;\n+import org.openxmlformats.schemas.drawingml.x2006.spreadsheetDrawing.CTShape;\n+import org.openxmlformats.schemas.drawingml.x2006.spreadsheetDrawing.CTShapeNonVisual;\n import org.xml.sax.Attributes;\n import org.xml.sax.ContentHandler;\n import org.xml.sax.InputSource;\n@@ -66,6 +65,7 @@\n     private final XSSFEventBasedExcelExtractor extractor;\n     private final DataFormatter formatter;\n     private final List<PackagePart> sheetParts = new ArrayList<PackagePart>();\n+    private final Map<String, String> drawingHyperlinks = new HashMap<>();\n     private Metadata metadata;\n     private ParseContext parseContext;\n \n@@ -122,7 +122,9 @@ protected void buildXHTML(XHTMLContentHandler xhtml) throws SAXException,\n \n         while (iter.hasNext()) {\n             InputStream stream = iter.next();\n-            sheetParts.add(iter.getSheetPart());\n+            PackagePart sheetPart = iter.getSheetPart();\n+            addDrawingHyperLinks(sheetPart);\n+            sheetParts.add(sheetPart);\n \n             SheetTextAsHTML sheetExtractor = new SheetTextAsHTML(xhtml);\n             CommentsTable comments = iter.getSheetComments();\n@@ -150,11 +152,50 @@ protected void buildXHTML(XHTMLContentHandler xhtml) throws SAXException,\n                 extractHeaderFooter(footer, xhtml);\n             }\n             processShapes(iter.getShapes(), xhtml);\n+\n+            //for now dump sheet hyperlinks at bottom of page\n+            //consider a double-pass of the inputstream to reunite hyperlinks with cells/textboxes\n+            //step 1: extract hyperlink info from bottom of page\n+            //step 2: process as we do now, but with cached hyperlink relationship info\n+            extractHyperLinks(sheetPart, xhtml);\n             // All done with this sheet\n             xhtml.endElement(\"div\");\n         }\n     }\n \n+    private void addDrawingHyperLinks(PackagePart sheetPart) {\n+        try {\n+            for (PackageRelationship rel : sheetPart.getRelationshipsByType(XSSFRelation.DRAWINGS.getRelation())) {\n+                if (rel.getTargetMode() == TargetMode.INTERNAL) {\n+                    PackagePartName relName = PackagingURIHelper.createPartName(rel.getTargetURI());\n+                    for (PackageRelationship drawRel : rel.getPackage()\n+                            .getPart(relName)\n+                            .getRelationshipsByType(XSSFRelation.SHEET_HYPERLINKS.getRelation())) {\n+                        drawingHyperlinks.put(drawRel.getId(), drawRel.getTargetURI().toString());\n+                    }\n+                }\n+            }\n+        } catch (InvalidFormatException e) {\n+            //swallow\n+            //an exception trying to extract\n+            //hyperlinks on drawings should not cause a parse failure\n+        }\n+\n+    }\n+\n+\n+    private void extractHyperLinks(PackagePart sheetPart, XHTMLContentHandler xhtml) throws SAXException {\n+        try {\n+            for (PackageRelationship rel : sheetPart.getRelationshipsByType(XSSFRelation.SHEET_HYPERLINKS.getRelation())) {\n+                xhtml.startElement(\"a\", \"href\", rel.getTargetURI().toString());\n+                xhtml.characters(rel.getTargetURI().toString());\n+                xhtml.endElement(\"a\");\n+            }\n+        } catch (InvalidFormatException e) {\n+            //swallow\n+        }\n+    }\n+\n     private void extractHeaderFooter(String hf, XHTMLContentHandler xhtml)\n             throws SAXException {\n         String content = ExcelExtractor._extractHeaderFooter(\n@@ -174,10 +215,48 @@ private void processShapes(List<XSSFShape> shapes, XHTMLContentHandler xhtml) th\n                 if (sText != null && sText.length() > 0) {\n                     xhtml.element(\"p\", sText);\n                 }\n+                extractHyperLinksFromShape(((XSSFSimpleShape)shape).getCTShape(), xhtml);\n             }\n         }\n     }\n \n+    private void extractHyperLinksFromShape(CTShape ctShape, XHTMLContentHandler xhtml) throws SAXException {\n+\n+        if (ctShape == null)\n+            return;\n+\n+        CTShapeNonVisual nvSpPR = ctShape.getNvSpPr();\n+        if (nvSpPR == null)\n+            return;\n+\n+        CTNonVisualDrawingProps cNvPr = nvSpPR.getCNvPr();\n+        if (cNvPr == null)\n+            return;\n+\n+        CTHyperlink ctHyperlink = cNvPr.getHlinkClick();\n+        if (ctHyperlink == null)\n+            return;\n+\n+        String url = drawingHyperlinks.get(ctHyperlink.getId());\n+        if (url != null) {\n+            xhtml.startElement(\"a\", \"href\", url);\n+            xhtml.characters(url);\n+            xhtml.endElement(\"a\");\n+        }\n+\n+        CTHyperlink ctHoverHyperlink = cNvPr.getHlinkHover();\n+        if (ctHoverHyperlink == null)\n+            return;\n+\n+        url = drawingHyperlinks.get(ctHoverHyperlink.getId());\n+        if (url != null) {\n+            xhtml.startElement(\"a\", \"href\", url);\n+            xhtml.characters(url);\n+            xhtml.endElement(\"a\");\n+        }\n+\n+    }\n+\n     public void processSheet(\n             SheetContentsHandler sheetContentsExtractor,\n             CommentsTable comments,",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java",
                "sha": "a25279302652c446ea592f42eef1876998948d0e",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 1,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java",
                "patch": "@@ -25,6 +25,7 @@\n import java.io.InputStream;\n import java.util.Locale;\n \n+import org.apache.tika.TikaTest;\n import org.apache.tika.detect.DefaultDetector;\n import org.apache.tika.detect.Detector;\n import org.apache.tika.exception.EncryptedDocumentException;\n@@ -41,7 +42,7 @@\n import org.junit.Test;\n import org.xml.sax.ContentHandler;\n \n-public class ExcelParserTest {\n+public class ExcelParserTest extends TikaTest {\n     @Test\n     @SuppressWarnings(\"deprecation\") // Checks legacy Tika-1.0 style metadata keys\n     public void testExcelParser() throws Exception {\n@@ -440,4 +441,19 @@ public void testHeaderAndFooterExtraction() throws Exception {\n             assertContains(\"Footer - Author: John Smith\", content);\n         }\n     }\n+\n+    @Test\n+    public void testHyperlinksInXLS() throws Exception {\n+        String xml = getXML(\"testEXCEL_hyperlinks.xls\").xml;\n+        //external url\n+        assertContains(\"<a href=\\\"http://tika.apache.org/\\\">\", xml);\n+        //mail url\n+        assertContains(\"<a href=\\\"mailto:user@tika.apache.org?subject=help\\\">\", xml);\n+        //external linked file\n+        assertContains(\"<a href=\\\"linked_file.txt.htm\\\">\", xml);\n+\n+        //TODO: not extracting these yet\n+        //link on textbox\n+//        assertContains(\"<a href=\\\"http://tika.apache.org/1.12/gettingstarted.html\\\">\", xml);\n+    }\n }",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java",
                "sha": "555ed3ed331b2fe067cc1ad77370b66cdb7d5f83",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 2,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java",
                "patch": "@@ -58,7 +58,7 @@ public void testVarious() throws Exception {\n         Metadata metadata = new Metadata();\n         String xml = getXML(\"testPPT_various.ppt\", metadata).xml;\n         assertContains(\"<p>Footnote appears here\", xml);\n-        assertContains(\"<p>[1] This is a footnote.\", xml);\n+        assertContains(\"<p><a href=\\\"_ftnref1\\\">[1]</a> This is a footnote.\", xml);\n         assertContains(\"<p>This is the header text.</p>\", xml);\n         assertContains(\"<p>This is the footer text.</p>\", xml);\n         assertContains(\"<p>Here is a text box</p>\", xml);\n@@ -74,7 +74,7 @@ public void testVarious() throws Exception {\n         assertContains(\"<td>Row 2 Col 2</td>\\t<td>Row 2 Col 3</td></tr>\", xml);\n         assertContains(\"<p>Row 1 column 1</p>\", xml);\n         assertContains(\"<p>Row 2 column 2</p>\", xml);\n-        assertContains(\"<p>This is a hyperlink\", xml);\n+        assertContains(\"<p><a href=\\\"http://tika.apache.org/\\\">This is a hyperlink</a>\", xml);\n         assertContains(\"<p>Here is a list:\", xml);\n         for(int row=1;row<=3;row++) {\n             //assertContains(\"\u00b7\\tBullet \" + row, content);",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java",
                "sha": "6046d8119b32e2974db5603906080e1403964f4f",
                "status": "modified"
            },
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "changes": 15,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 1,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "patch": "@@ -637,7 +637,7 @@ public void testVariousPPTX() throws Exception {\n         assertContains(\"<td>Row 2 Col 2</td>\\t<td>Row 2 Col 3</td></tr>\", xml);\n         assertContains(\"<p>Row 1 column 1</p>\", xml);\n         assertContains(\"<p>Row 2 column 2</p>\", xml);\n-        assertContains(\"<p>This is a hyperlink\", xml);\n+        assertContains(\"<p><a href=\\\"http://tika.apache.org/\\\">This is a hyperlink</a>\", xml);\n         assertContains(\"<p>Here is a list:\", xml);\n         for(int row=1;row<=3;row++) {\n             //assertContains(\"\u00b7\\tBullet \" + row, content);\n@@ -1196,6 +1196,19 @@ public void testMultiAuthorsManagers() throws Exception {\n         assertEquals(\"manager1\", managers[0]);\n         assertEquals(\"manager2\", managers[1]);\n     }\n+\n+    @Test\n+    public void testHyperlinksInXLSX() throws Exception {\n+        String xml = getXML(\"testEXCEL_hyperlinks.xlsx\").xml;\n+        //external url\n+        assertContains(\"<a href=\\\"http://tika.apache.org/\\\">\", xml);\n+        //mail url\n+        assertContains(\"<a href=\\\"mailto:user@tika.apache.org?subject=help\\\">\", xml);\n+        //external linked file\n+        assertContains(\"<a href=\\\"linked_file.txt.htm\\\">\", xml);\n+        //link on textbox\n+        assertContains(\"<a href=\\\"http://tika.apache.org/1.12/gettingstarted.html\\\">\", xml);\n+    }\n }\n \n ",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "sha": "b35a0f9ae4e2f83f8e73e183f6f2bb6c7382b841",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xls",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xls?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xls",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xls",
                "sha": "ba4f16d02e80b6a9fe4ba411769e2b28585cef0b",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx?ref=69852e4cb55d34e6513e0b66af7d75cb1b1408ba",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx",
                "raw_url": "https://github.com/apache/tika/raw/69852e4cb55d34e6513e0b66af7d75cb1b1408ba/tika-parsers/src/test/resources/test-documents/testEXCEL_hyperlinks.xlsx",
                "sha": "8024f4980547d077d06b44d1a14d7bed400dceae",
                "status": "added"
            }
        ],
        "message": "TIKA-1454 -- added initial hyperlink extraction for ppt, pptx, xlsx.  Areas for improvement: limit links to external links for ppt and pptx. Fix NPE in cell.getHyperlink within ppt in POI",
        "parent": "https://github.com/apache/tika/commit/9f09a558648bf2d8b17c611498e097db0513fb7d",
        "patched_files": [
            "XSLFPowerPointExtractorDecorator.java",
            "HSLFExtractor.java",
            "testEXCEL_hyperlinks.xlsx",
            "testEXCEL_hyperlinks.xls",
            "XSSFExcelExtractorDecorator.java",
            "OOXMLParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "PowerPointParserTest.java",
            "ExcelParserTest.java",
            "OOXMLParserTest.java"
        ]
    },
    "tika_7dc399b": {
        "bug_id": "tika_7dc399b",
        "commit": "https://github.com/apache/tika/commit/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tika/blob/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java?ref=7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c",
                "deletions": 2,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "patch": "@@ -54,13 +54,17 @@ protected void buildXHTML(XHTMLContentHandler xhtml)\n         XWPFHeaderFooterPolicy hfPolicy = document.getHeaderFooterPolicy();\n \n         // headers\n-        extractHeaders(xhtml, hfPolicy);\n+        if (hfPolicy!=null) {\n+            extractHeaders(xhtml, hfPolicy);\n+        }\n \n         // process text in the order that it occurs in\n         extractIBodyText(document, xhtml);\n \n         // then all document tables\n-        extractFooters(xhtml, hfPolicy);\n+        if (hfPolicy!=null) {\n+            extractFooters(xhtml, hfPolicy);\n+        }\n     }\n \n     private void extractIBodyText(IBody bodyElement, XHTMLContentHandler xhtml)",
                "raw_url": "https://github.com/apache/tika/raw/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java",
                "sha": "d3f8fc8c7b6a2c86813fe14326184984df25137e",
                "status": "modified"
            },
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/tika/blob/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java?ref=7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "patch": "@@ -430,4 +430,22 @@ public void testProtectedExcelFile() throws Exception {\n         }\n     }\n \n+    /**\n+     * Test docx without headers\n+     * TIKA-633\n+     */\n+    public void testNullHeaders() throws Exception {\n+        Parser parser = new AutoDetectParser();\n+        Metadata metadata = new Metadata();\n+        ContentHandler handler = new BodyContentHandler();\n+        ParseContext context = new ParseContext();\n+\n+        InputStream input = OOXMLParserTest.class.getResourceAsStream(\"/test-documents/NullHeader.docx\");\n+        try {\n+            parser.parse(TikaInputStream.get(input), handler, metadata, context);\n+            assertFalse(handler.toString().isEmpty());\n+        } finally {\n+            input.close();\n+        }\n+    }\n }",
                "raw_url": "https://github.com/apache/tika/raw/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java",
                "sha": "b1bee15c0c9c9ec9ab41aaf43371d7d932d6cc28",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/test/resources/test-documents/NullHeader.docx",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/NullHeader.docx?ref=7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/NullHeader.docx",
                "raw_url": "https://github.com/apache/tika/raw/7dc399b99823bbbd77ab6e6ab0b9cc1870210c0c/tika-parsers/src/test/resources/test-documents/NullHeader.docx",
                "sha": "cc62b8d6bebaf06dc46dbce5d56089778d6f528f",
                "status": "added"
            }
        ],
        "message": "TIKA-633: NPE in XWPFWordExtractorDecorator.extractHeaders\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1088924 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/0ea4a153465745881c2ef6e3ae39700a38e39e53",
        "patched_files": [
            "XWPFWordExtractorDecorator.java",
            "NullHeader.docx",
            "OOXMLParser.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OOXMLParserTest.java"
        ]
    },
    "tika_92a4835": {
        "bug_id": "tika_92a4835",
        "commit": "https://github.com/apache/tika/commit/92a4835d02d94fddbc7d70c0507b8a32345662d9",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/92a4835d02d94fddbc7d70c0507b8a32345662d9/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java?ref=92a4835d02d94fddbc7d70c0507b8a32345662d9",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "patch": "@@ -131,6 +131,9 @@ protected static String joinCreators(List<String> creators) {\n      * @param metadata\n      */\n     public static void extractXMPMM(XMPMetadata xmp, Metadata metadata) {\n+        if (xmp == null) {\n+            return;\n+        }\n         XMPSchemaMediaManagement mmSchema = null;\n         try {\n             mmSchema = xmp.getMediaManagementSchema();",
                "raw_url": "https://github.com/apache/tika/raw/92a4835d02d94fddbc7d70c0507b8a32345662d9/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "sha": "0f326a834955f4839119deb64e12212c06d473e5",
                "status": "modified"
            }
        ],
        "message": "TIKA-1894 -- fix potential NPE in XMPMM extraction",
        "parent": "https://github.com/apache/tika/commit/7a543c8076a3ceb2dfa92fce06fc558cfe84cde7",
        "patched_files": [
            "JempboxExtractor.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "JempboxExtractorTest.java"
        ]
    },
    "tika_9c2e1b9": {
        "bug_id": "tika_9c2e1b9",
        "commit": "https://github.com/apache/tika/commit/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -1,5 +1,8 @@\n Release 1.17 - ???\n \n+  * Catch potential NPE in getting InputStream for attachments\n+    in PST file (TIKA-2488).\n+\n   * Upgrade to PDFBox 2.0.8 (TIKA-2489).\n \n   * Allow configuration of markLimit in EncodingDetectors",
                "raw_url": "https://github.com/apache/tika/raw/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/CHANGES.txt",
                "sha": "8cb683c99171ef821ba43d2bcd25b9f0d559cac8",
                "status": "modified"
            },
            {
                "additions": 23,
                "blob_url": "https://github.com/apache/tika/blob/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java?ref=9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
                "deletions": 12,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "patch": "@@ -125,8 +125,14 @@ private void parseFolder(XHTMLContentHandler handler, PSTFolder pstFolder, Embed\n                 handler.startElement(\"div\", attributes);\n                 handler.element(\"h1\", pstMail.getSubject());\n \n-                parserMailItem(handler, pstMail, embeddedExtractor);\n-                parseMailAttachments(handler, pstMail, embeddedExtractor);\n+                final Metadata mailMetadata = new Metadata();\n+                //parse attachments first so that stream exceptions\n+                //in attachments can make it into mailMetadata.\n+                //RecursiveParserWrapper copies the metadata and thereby prevents\n+                //modifications to mailMetadata from making it into the\n+                //metadata objects cached by the RecursiveParserWrapper\n+                parseMailAttachments(handler, pstMail, mailMetadata, embeddedExtractor);\n+                parserMailItem(handler, pstMail, mailMetadata, embeddedExtractor);\n \n                 handler.endElement(\"div\");\n \n@@ -144,8 +150,8 @@ private void parseFolder(XHTMLContentHandler handler, PSTFolder pstFolder, Embed\n         }\n     }\n \n-    private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, EmbeddedDocumentExtractor embeddedExtractor) throws SAXException, IOException {\n-        Metadata mailMetadata = new Metadata();\n+    private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, Metadata mailMetadata,\n+                                EmbeddedDocumentExtractor embeddedExtractor) throws SAXException, IOException {\n         mailMetadata.set(Metadata.RESOURCE_NAME_KEY, pstMail.getInternetMessageId());\n         mailMetadata.set(Metadata.EMBEDDED_RELATIONSHIP_ID, pstMail.getInternetMessageId());\n         mailMetadata.set(TikaCoreProperties.IDENTIFIER, pstMail.getInternetMessageId());\n@@ -217,11 +223,12 @@ private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, Emb\n         embeddedExtractor.parseEmbedded(new ByteArrayInputStream(mailContent), handler, mailMetadata, true);\n     }\n \n-    private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email, EmbeddedDocumentExtractor embeddedExtractor)\n+    private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email,\n+                                     final Metadata mailMetadata,\n+                                      EmbeddedDocumentExtractor embeddedExtractor)\n             throws TikaException {\n         int numberOfAttachments = email.getNumberOfAttachments();\n         for (int i = 0; i < numberOfAttachments; i++) {\n-            File tempFile = null;\n             try {\n                 PSTAttachment attach = email.getAttachment(i);\n \n@@ -241,21 +248,25 @@ private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email, E\n                 attributes.addAttribute(\"\", \"id\", \"id\", \"CDATA\", filename);\n                 xhtml.startElement(\"div\", attributes);\n                 if (embeddedExtractor.shouldParseEmbedded(attachMeta)) {\n-                    TemporaryResources tmp = new TemporaryResources();\n+                    TikaInputStream tis = null;\n+                    try {\n+                        tis = TikaInputStream.get(attach.getFileInputStream());\n+                    } catch (NullPointerException e) {//TIKA-2488\n+                        EmbeddedDocumentUtil.recordEmbeddedStreamException(e, mailMetadata);\n+                        continue;\n+                    }\n+\n                     try {\n-                        TikaInputStream tis = TikaInputStream.get(attach.getFileInputStream(), tmp);\n                         embeddedExtractor.parseEmbedded(tis, xhtml, attachMeta, true);\n                     } finally {\n-                        tmp.dispose();\n+\n+                        tis.close();\n                     }\n                 }\n                 xhtml.endElement(\"div\");\n \n             } catch (Exception e) {\n                 throw new TikaException(\"Unable to unpack document stream\", e);\n-            } finally {\n-                if (tempFile != null)\n-                    tempFile.delete();\n             }\n         }\n     }",
                "raw_url": "https://github.com/apache/tika/raw/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "sha": "61d7bac657af136292f72045d1602a7fd9162bfb",
                "status": "modified"
            }
        ],
        "message": "TIKA-2488 -- catch potential npe in getting attachment's inputstream",
        "parent": "https://github.com/apache/tika/commit/04b0837700e7d0ecc337a50ca99d2a063978a58b",
        "patched_files": [
            "OutlookPSTParser.java",
            "CHANGES.txt"
        ],
        "repo": "tika",
        "unit_tests": [
            "OutlookPSTParserTest.java"
        ]
    },
    "tika_a64d33c": {
        "bug_id": "tika_a64d33c",
        "commit": "https://github.com/apache/tika/commit/a64d33c78c143f401d2d7ef795872fcc35fb2200",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/a64d33c78c143f401d2d7ef795872fcc35fb2200/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=a64d33c78c143f401d2d7ef795872fcc35fb2200",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -38,6 +38,9 @@ Release 1.3 - Current Development\n     key, and TikaCLI prepends the rId (if present) onto the filename\n     it extracts (TIKA-997).\n \n+  * MHTML: fixed Null charset name exception when a mime part has an\n+    unrecognized charset (TIKA-1011).\n+\n Release 1.2 - 07/10/2012\n ---------------------------------\n ",
                "raw_url": "https://github.com/apache/tika/raw/a64d33c78c143f401d2d7ef795872fcc35fb2200/CHANGES.txt",
                "sha": "b77afcc77004675c8d651c113ae674e6ebbb84d7",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/tika/blob/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/main/java/org/apache/tika/parser/txt/Icu4jEncodingDetector.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/txt/Icu4jEncodingDetector.java?ref=a64d33c78c143f401d2d7ef795872fcc35fb2200",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/txt/Icu4jEncodingDetector.java",
                "patch": "@@ -46,7 +46,12 @@ public Charset detect(InputStream input, Metadata metadata)\n         }\n \n         if (incomingCharset != null) {\n-            detector.setDeclaredEncoding(CharsetUtils.clean(incomingCharset));\n+            String cleaned = CharsetUtils.clean(incomingCharset);\n+            if (cleaned != null) {\n+                detector.setDeclaredEncoding(cleaned);\n+            } else {\n+                // TODO: log a warning?\n+            }\n         }\n \n         // TIKA-341 without enabling input filtering (stripping of tags)",
                "raw_url": "https://github.com/apache/tika/raw/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/main/java/org/apache/tika/parser/txt/Icu4jEncodingDetector.java",
                "sha": "c5fb16f51b1d30dde70f9fb7a9079321b3952917",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/tika/blob/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java?ref=a64d33c78c143f401d2d7ef795872fcc35fb2200",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java",
                "patch": "@@ -801,4 +801,11 @@ public void testOpenGraphMetadata() throws Exception {\n         assertEquals(\"some description\", metadata.get(\"og:description\"));\n \n     }\n+\n+    // TIKA-1011\n+    public void testUserDefinedCharset() throws Exception {\n+        String content = new Tika().parseToString(\n+                HtmlParserTest.class.getResourceAsStream(\"/test-documents/testUserDefinedCharset.mhtml\"), new Metadata());\n+        assertNotNull(content);\n+    }\n }",
                "raw_url": "https://github.com/apache/tika/raw/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/test/java/org/apache/tika/parser/html/HtmlParserTest.java",
                "sha": "f045a7ee3f30feedb5d66343d2f0116437ee94ad",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/tika/blob/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/test/resources/test-documents/testUserDefinedCharset.mhtml",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testUserDefinedCharset.mhtml?ref=a64d33c78c143f401d2d7ef795872fcc35fb2200",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testUserDefinedCharset.mhtml",
                "patch": "@@ -0,0 +1,21 @@\n+From: <Saved by Windows Internet Explorer 8>\n+Subject: Index Pages\n+Date: Tue, 28 Aug 2012 09:53:28 +0300\n+MIME-Version: 1.0\n+Content-Type: multipart/related;\n+\ttype=\"multipart/alternative\";\n+\tboundary=\"----=_NextPart_000_0000_01CD8502.F991E790\"\n+X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.6157\n+\n+This is a multi-part message in MIME format.\n+\n+------=_NextPart_000_0000_01CD8502.F991E790\n+Content-Type: multipart/alternative;\n+\tboundary=\"----=_NextPart_001_0023_01CD8502.F99DCE70\"\n+\n+\n+------=_NextPart_001_0023_01CD8502.F99DCE70\n+Content-Type: text/html;\n+\tcharset=\"x-user-defined\"\n+Content-Transfer-Encoding: quoted-printable\n+",
                "raw_url": "https://github.com/apache/tika/raw/a64d33c78c143f401d2d7ef795872fcc35fb2200/tika-parsers/src/test/resources/test-documents/testUserDefinedCharset.mhtml",
                "sha": "e64027f716b149dc4becc283a8a224f55cca4695",
                "status": "added"
            }
        ],
        "message": "TIKA-1011: fix NPE when charset isn't recognized in .mhtml files\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1402665 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/3a76e71d0204a14914bcb584c459eda734b5c13d",
        "patched_files": [
            "Icu4jEncodingDetector.java",
            "testUserDefinedCharset.mhtml",
            "HtmlParser.java",
            "CHANGES.txt"
        ],
        "repo": "tika",
        "unit_tests": [
            "HtmlParserTest.java"
        ]
    },
    "tika_b73dccb": {
        "bug_id": "tika_b73dccb",
        "commit": "https://github.com/apache/tika/commit/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/CHANGES.txt",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3",
                "deletions": 1,
                "filename": "CHANGES.txt",
                "patch": "@@ -17,7 +17,6 @@ Release 1.1 - Current Development\n    XHTML output, causing NPE when opening some PDFs with the GUI\n    (TIKA-778).\n \n-\n  * RTF: Fixed case where a font change would result in processing\n    bytes in the wrong font's charset, producing bogus text output\n    (TIKA-777).  Don't output whitespace in ignored group states,\n@@ -40,6 +39,9 @@ Release 1.1 - Current Development\n  * Microsoft Project (MPP): Filetype detection has been fixed,\n    and basic metadata (but no text) is now extracted. (TIKA-789)\n \n+ * Outlook: fixed NullPointerException in TikaGUI when messages with\n+   embedded RTF or HTML content were filtered (TIKA-801).\n+\n Release 1.0 - 11/4/2011\n ---------------------------------\n ",
                "raw_url": "https://github.com/apache/tika/raw/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/CHANGES.txt",
                "sha": "0cd53fcad10b5cdbf066a87876c03bf3bfd8eb7c",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/tika/blob/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java?ref=b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3",
                "deletions": 3,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java",
                "patch": "@@ -42,6 +42,7 @@\n import org.apache.tika.parser.txt.CharsetDetector;\n import org.apache.tika.parser.txt.CharsetMatch;\n import org.apache.tika.sax.BodyContentHandler;\n+import org.apache.tika.sax.EmbeddedContentHandler;\n import org.apache.tika.sax.XHTMLContentHandler;\n import org.xml.sax.SAXException;\n \n@@ -189,10 +190,11 @@ public void parse(XHTMLContentHandler xhtml, Metadata metadata)\n                  data = ((StringChunk)htmlChunk).getRawValue();\n               }\n               if(data != null) {\n+                  // nocommit same problem here?\n                  HtmlParser htmlParser = new HtmlParser();\n                  htmlParser.parse(\n                        new ByteArrayInputStream(data),\n-                       new BodyContentHandler(xhtml), \n+                       new EmbeddedContentHandler(new BodyContentHandler(xhtml)), \n                        new Metadata(), new ParseContext()\n                  );\n                  doneBody = true;\n@@ -206,8 +208,8 @@ public void parse(XHTMLContentHandler xhtml, Metadata metadata)\n               RTFParser rtfParser = new RTFParser();\n               rtfParser.parse(\n                               new ByteArrayInputStream(rtf.getData()),\n-                              xhtml, new Metadata(), new ParseContext()\n-                              );\n+                              new EmbeddedContentHandler(new BodyContentHandler(xhtml)),\n+                              new Metadata(), new ParseContext());\n               doneBody = true;\n            }\n            if(textChunk != null && !doneBody) {",
                "raw_url": "https://github.com/apache/tika/raw/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OutlookExtractor.java",
                "sha": "63d0653df9a9162961ad27defd8db77e197bf20a",
                "status": "modified"
            },
            {
                "additions": 28,
                "blob_url": "https://github.com/apache/tika/blob/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java",
                "changes": 29,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java?ref=b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3",
                "deletions": 1,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java",
                "patch": "@@ -170,7 +170,34 @@ public void testOutlookHTMLVersion() throws Exception {\n         \n         // Make sure we don't have nested html docs\n         assertEquals(2, content.split(\"<body>\").length);\n-        //assertEquals(2, content.split(\"<\\\\/body>\").length); // TODO Fix\n+        assertEquals(2, content.split(\"<\\\\/body>\").length);\n+    }\n+\n+    public void testOutlookForwarded() throws Exception {\n+        Parser parser = new AutoDetectParser();\n+        Metadata metadata = new Metadata();\n+       \n+        // Check the HTML version\n+        StringWriter sw = new StringWriter();\n+        SAXTransformerFactory factory = (SAXTransformerFactory)\n+                 SAXTransformerFactory.newInstance();\n+        TransformerHandler handler = factory.newTransformerHandler();\n+        handler.getTransformer().setOutputProperty(OutputKeys.METHOD, \"xml\");\n+        handler.getTransformer().setOutputProperty(OutputKeys.INDENT, \"yes\");\n+        handler.setResult(new StreamResult(sw));\n+\n+        InputStream stream = OutlookParserTest.class.getResourceAsStream(\n+               \"/test-documents/testMSG_forwarded.msg\");\n+        try {\n+           parser.parse(stream, handler, metadata, new ParseContext());\n+        } finally {\n+           stream.close();\n+        }\n+         \n+        // Make sure we don't have nested docs\n+        String content = sw.toString();\n+        assertEquals(2, content.split(\"<body>\").length);\n+        assertEquals(2, content.split(\"<\\\\/body>\").length);\n     }\n     \n     public void testOutlookHTMLfromRTF() throws Exception {",
                "raw_url": "https://github.com/apache/tika/raw/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java",
                "sha": "6d18859bfb8cfe8b74e85584e6a2e62cd1e72206",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/test/resources/test-documents/testMSG_forwarded.msg",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testMSG_forwarded.msg?ref=b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testMSG_forwarded.msg",
                "raw_url": "https://github.com/apache/tika/raw/b73dccb6bc47d33bdb6f1e51b723c7ef6bf3e1a3/tika-parsers/src/test/resources/test-documents/testMSG_forwarded.msg",
                "sha": "d74d31a5ee34f030076dd72ed2f427c4b7b7b85f",
                "status": "added"
            }
        ],
        "message": "TIKA-801: fixed NPE when filtering Outlook docs with RTF or HTML content\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1212573 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/707b8f2157ffcdb6a8e8871baa53258b3b5b9ea7",
        "patched_files": [
            "OutlookExtractor.java",
            "testMSG_forwarded.msg",
            "CHANGES.txt"
        ],
        "repo": "tika",
        "unit_tests": [
            "OutlookParserTest.java"
        ]
    },
    "tika_dada2b7": {
        "bug_id": "tika_dada2b7",
        "commit": "https://github.com/apache/tika/commit/dada2b757ec3292ab49a0e75b60b5b1211fd801d",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/dada2b757ec3292ab49a0e75b60b5b1211fd801d/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java?ref=dada2b757ec3292ab49a0e75b60b5b1211fd801d",
                "deletions": 1,
                "filename": "tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "patch": "@@ -157,9 +157,18 @@ public void addText(char[] cbuf, int off, int len) {\n \t\twriter.write(' ');\n \t}\n \n+        /**\n+         * {@inheritDoc}\n+         *\n+         * @throws IllegalStateException if no models have been loaded with\n+         * {@link #loadModels() } or {@link #loadModels(java.util.Set) }\n+         * @return the detected list of languages\n+         */\n \t@Override\n \tpublic List<LanguageResult> detectAll() {\n-\t\t// TODO throw exception if models haven't been loaded, or auto-load all?\n+\t\tif(detector == null) {\n+                    throw new IllegalStateException(\"models haven't been loaded yet (forgot to call loadModels?)\");\n+                }\n \t\t\n \t\tList<LanguageResult> result = new ArrayList<>();\n \t\t",
                "raw_url": "https://github.com/apache/tika/raw/dada2b757ec3292ab49a0e75b60b5b1211fd801d/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "sha": "d31559238f519e958ade1b672c477089abaee14a",
                "status": "modified"
            }
        ],
        "message": "Merge branch 'npe' of https://github.com/krichter722/tika into krichter722-npe",
        "parent": "https://github.com/apache/tika/commit/4e03f90cf0a20375819f33371ec094386a744f36",
        "patched_files": [
            "OptimaizeLangDetector.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OptimaizeLangDetectorTest.java"
        ]
    },
    "tika_e5526b5": {
        "bug_id": "tika_e5526b5",
        "commit": "https://github.com/apache/tika/commit/e5526b559e549a7b6039844dc237b03579490a41",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/e5526b559e549a7b6039844dc237b03579490a41/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java?ref=e5526b559e549a7b6039844dc237b03579490a41",
                "deletions": 1,
                "filename": "tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "patch": "@@ -157,9 +157,18 @@ public void addText(char[] cbuf, int off, int len) {\n \t\twriter.write(' ');\n \t}\n \n+        /**\n+         * {@inheritDoc}\n+         *\n+         * @throws IllegalStateException if no models have been loaded with\n+         * {@link #loadModels() } or {@link #loadModels(java.util.Set) }\n+         * @return the detected list of languages\n+         */\n \t@Override\n \tpublic List<LanguageResult> detectAll() {\n-\t\t// TODO throw exception if models haven't been loaded, or auto-load all?\n+\t\tif(detector == null) {\n+                    throw new IllegalStateException(\"models haven't been loaded yet (forgot to call loadModels?)\");\n+                }\n \t\t\n \t\tList<LanguageResult> result = new ArrayList<>();\n \t\t",
                "raw_url": "https://github.com/apache/tika/raw/e5526b559e549a7b6039844dc237b03579490a41/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "sha": "d31559238f519e958ade1b672c477089abaee14a",
                "status": "modified"
            }
        ],
        "message": "Merge branch 'krichter722-npe'",
        "parent": "https://github.com/apache/tika/commit/4e03f90cf0a20375819f33371ec094386a744f36",
        "patched_files": [
            "OptimaizeLangDetector.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "OptimaizeLangDetectorTest.java"
        ]
    },
    "tika_e607d65": {
        "bug_id": "tika_e607d65",
        "commit": "https://github.com/apache/tika/commit/e607d65bc58087116408988342331dcb20ff9bba",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/e607d65bc58087116408988342331dcb20ff9bba/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java?ref=e607d65bc58087116408988342331dcb20ff9bba",
                "deletions": 4,
                "filename": "tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "patch": "@@ -19,7 +19,6 @@\n \n import com.fasterxml.jackson.databind.util.LRUMap;\n \n-import org.apache.tika.config.ServiceLoader;\n import org.apache.tika.exception.TikaException;\n import org.apache.tika.language.LanguageIdentifier;\n import org.apache.tika.language.LanguageProfile;\n@@ -54,7 +53,7 @@ public CachedTranslator(){\n      */\n     public CachedTranslator(Translator translator) {\n         this.translator = translator;\n-        cache = new HashMap<String, LRUMap<String, String>>();\n+        this.cache = new HashMap<>();\n     }\n \n     /**\n@@ -93,7 +92,7 @@ public String translate(String text, String targetLanguage) throws TikaException\n \n     @Override\n     public boolean isAvailable() {\n-        return translator.isAvailable();\n+        return translator != null && translator.isAvailable();\n     }\n \n     /**\n@@ -172,7 +171,7 @@ private String buildCacheKeyString(String sourceLanguage, String targetLanguage)\n     private LRUMap<String, String> getTranslationCache(String sourceLanguage, String targetLanguage) {\n         LRUMap<String, String> translationCache = cache.get(buildCacheKeyString(sourceLanguage, targetLanguage));\n         if (translationCache == null) {\n-            translationCache = new LRUMap<String, String>(INITIAL_ENTRIES, MAX_ENTRIES);\n+            translationCache = new LRUMap<>(INITIAL_ENTRIES, MAX_ENTRIES);\n             cache.put(buildCacheKeyString(sourceLanguage, targetLanguage), translationCache);\n         }\n         return translationCache;",
                "raw_url": "https://github.com/apache/tika/raw/e607d65bc58087116408988342331dcb20ff9bba/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "sha": "5a771a1fea47e9afcc637026a9e249461ff21267",
                "status": "modified"
            }
        ],
        "message": "Patch from Yaniv Kunda from TIKA-1750 - avoid NPE in CachedTranslator if no underlying translator is available\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1705107 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/d6d180c5d94d80722e239341e4eb8398a32817cd",
        "patched_files": [
            "CachedTranslator.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "CachedTranslatorTest.java"
        ]
    },
    "tika_ece254a": {
        "bug_id": "tika_ece254a",
        "commit": "https://github.com/apache/tika/commit/ece254a45588281d6d00b383cd9f7809dca04580",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/tika/blob/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentContentParser.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentContentParser.java?ref=ece254a45588281d6d00b383cd9f7809dca04580",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentContentParser.java",
                "patch": "@@ -169,6 +169,9 @@ private void startSpan(String name) throws SAXException {\n \t\t    }\n \n             TextStyle style = textStyleMap.get(name);\n+            if (style == null) {\n+              return;\n+            }\n \n             // End tags that refer to no longer valid styles\n             if (!style.underlined && lastTextStyle != null && lastTextStyle.underlined) {\n@@ -224,7 +227,7 @@ public void startElement(\n \t\t        String namespaceURI, String localName, String qName,\n \t\t        Attributes attrs) throws SAXException {\n \t\t    // keep track of current node type. If it is a text node,\n-\t\t    // a bit at the current depth ist set in textNodeStack.\n+\t\t    // a bit at the current depth its set in textNodeStack.\n \t\t    // characters() checks the top bit to determine, if the\n \t\t    // actual node is a text node to print out nodeDepth contains\n \t\t    // the depth of the current node and also marks top of stack.",
                "raw_url": "https://github.com/apache/tika/raw/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/main/java/org/apache/tika/parser/odf/OpenDocumentContentParser.java",
                "sha": "d53944624777efec47bf35ef4f40ea21ceeb3bb5",
                "status": "modified"
            },
            {
                "additions": 56,
                "blob_url": "https://github.com/apache/tika/blob/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/test/java/org/apache/tika/parser/odf/OpenDocumentParserTest.java",
                "changes": 56,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/java/org/apache/tika/parser/odf/OpenDocumentParserTest.java?ref=ece254a45588281d6d00b383cd9f7809dca04580",
                "deletions": 0,
                "filename": "tika-parsers/src/test/java/org/apache/tika/parser/odf/OpenDocumentParserTest.java",
                "patch": "@@ -0,0 +1,56 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.tika.parser.odf;\n+\n+import static org.junit.Assert.assertEquals;\n+\n+import java.io.InputStream;\n+\n+import org.apache.tika.TikaTest;\n+import org.apache.tika.metadata.Metadata;\n+import org.apache.tika.parser.ParseContext;\n+import org.apache.tika.parser.Parser;\n+import org.apache.tika.sax.BodyContentHandler;\n+import org.junit.Test;\n+import org.xml.sax.ContentHandler;\n+\n+\n+public class OpenDocumentParserTest extends TikaTest {\n+  \n+  @Test\n+  public void can_parse_odt_file_with_styles_tika_6000() throws Exception {\n+      Parser parser = new OpenDocumentParser();\n+      InputStream input = ODFParserTest.class.getResourceAsStream(\"/test-documents/testODT-TIKA-6000.odt\");\n+      try {\n+         Metadata metadata = new Metadata();\n+         ContentHandler handler = new BodyContentHandler();\n+         parser.parse(input, handler, metadata, new ParseContext());\n+\n+         assertEquals(\"application/vnd.oasis.opendocument.text\", metadata.get(Metadata.CONTENT_TYPE));\n+\n+         String content = handler.toString();\n+         \n+         assertContains(\"Utilisation de ce document\", content);\n+         assertContains(\"Copyright and License\", content);\n+         assertContains(\"Changer la langue\", content);\n+         assertContains(\"La page d\u2019accueil permet de faire une recherche simple\", content);                \n+      } finally {\n+         input.close();\n+      }\n+  }\n+\n+}",
                "raw_url": "https://github.com/apache/tika/raw/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/test/java/org/apache/tika/parser/odf/OpenDocumentParserTest.java",
                "sha": "ee6c32662e0751c5bc6a212b7dcd1209fc208838",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/tika/blob/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/test/resources/test-documents/testODT-TIKA-6000.odt",
                "changes": 0,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/test/resources/test-documents/testODT-TIKA-6000.odt?ref=ece254a45588281d6d00b383cd9f7809dca04580",
                "deletions": 0,
                "filename": "tika-parsers/src/test/resources/test-documents/testODT-TIKA-6000.odt",
                "raw_url": "https://github.com/apache/tika/raw/ece254a45588281d6d00b383cd9f7809dca04580/tika-parsers/src/test/resources/test-documents/testODT-TIKA-6000.odt",
                "sha": "a6e3e636feb94d3aaa98c85034fba7cc36cbc119",
                "status": "added"
            }
        ],
        "message": "TIKA-6000 - Fixing NPE when having style in footnote\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1673138 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/7d231d03247b9171dcce6e1758deb5c49560a6a1",
        "patched_files": [
            "OpenDocumentParser.java",
            "OpenDocumentContentParser.java",
            "testODT-TIKA-6000.odt"
        ],
        "repo": "tika",
        "unit_tests": [
            "OpenDocumentParserTest.java"
        ]
    },
    "tika_f52da71": {
        "bug_id": "tika_f52da71",
        "commit": "https://github.com/apache/tika/commit/f52da719f16ad7379d5b7019ac766a80ab48d6db",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/f52da719f16ad7379d5b7019ac766a80ab48d6db/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java?ref=f52da719f16ad7379d5b7019ac766a80ab48d6db",
                "deletions": 1,
                "filename": "tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "patch": "@@ -291,7 +291,9 @@ public void endElement(String name) throws SAXException {\n     }\n \n     public void characters(String characters) throws SAXException {\n-        characters(characters.toCharArray(), 0, characters.length());\n+        if (characters != null && characters.length() > 0) {\n+            characters(characters.toCharArray(), 0, characters.length());\n+        }\n     }\n \n     public void newline() throws SAXException {",
                "raw_url": "https://github.com/apache/tika/raw/f52da719f16ad7379d5b7019ac766a80ab48d6db/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "sha": "fd2b3015513bb7c252666a71f4d2f46c31b67123",
                "status": "modified"
            }
        ],
        "message": "TIKA-760 Avoid NPE in XHTMLContentHandler if a null string is passed to the characters method\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1235284 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/8f05b4e99721921279f2656663c58b403eff2329",
        "patched_files": [
            "XHTMLContentHandler.java"
        ],
        "repo": "tika",
        "unit_tests": [
            "XHTMLContentHandlerTest.java"
        ]
    }
}