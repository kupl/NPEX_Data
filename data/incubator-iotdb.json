{
    "incubator-iotdb_4baa36e": {
        "bug_id": "incubator-iotdb_4baa36e",
        "commit": "https://github.com/apache/incubator-iotdb/commit/4baa36eb3f143f79e12e7754e38b6acb918bb7ae",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/incubator-iotdb/blob/4baa36eb3f143f79e12e7754e38b6acb918bb7ae/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/MergeTask.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/incubator-iotdb/contents/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/MergeTask.java?ref=4baa36eb3f143f79e12e7754e38b6acb918bb7ae",
                "deletions": 1,
                "filename": "iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/MergeTask.java",
                "patch": "@@ -127,7 +127,9 @@ void cleanUp(boolean executeCallback) throws IOException {\n     unmergedChunkCnt.clear();\n     unmergedChunkStartTimes.clear();\n \n-    mergeLogger.close();\n+    if (mergeLogger != null) {\n+      mergeLogger.close();\n+    }\n \n     for (TsFileResource seqFile : resource.getSeqFiles()) {\n       File mergeFile = new File(seqFile.getFile().getPath() + MERGE_SUFFIX);",
                "raw_url": "https://github.com/apache/incubator-iotdb/raw/4baa36eb3f143f79e12e7754e38b6acb918bb7ae/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/MergeTask.java",
                "sha": "efaf53497f1672191c830dec6ca3e87cdcd368a4",
                "status": "modified"
            }
        ],
        "message": "fix an NPE when closing mergeLogger",
        "parent": "https://github.com/apache/incubator-iotdb/commit/8cd144f3121398ddda6e70bd31e69e24de6345d7",
        "repo": "incubator-iotdb",
        "unit_tests": [
            "MergeTaskTest.java"
        ]
    },
    "incubator-iotdb_bec56b7": {
        "bug_id": "incubator-iotdb_bec56b7",
        "commit": "https://github.com/apache/incubator-iotdb/commit/bec56b7bbe6da764275a6ba287618fa06e8f50c2",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/incubator-iotdb/blob/bec56b7bbe6da764275a6ba287618fa06e8f50c2/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/RecoverMergeTask.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/incubator-iotdb/contents/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/RecoverMergeTask.java?ref=bec56b7bbe6da764275a6ba287618fa06e8f50c2",
                "deletions": 2,
                "filename": "iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/RecoverMergeTask.java",
                "patch": "@@ -47,9 +47,11 @@\n \n   private LogAnalyzer analyzer;\n \n-  public RecoverMergeTask(String storageGroupDir, MergeCallback callback, String taskName,\n+  public RecoverMergeTask(List<TsFileResource> seqFiles,\n+      List<TsFileResource> unseqFiles, String storageGroupDir,\n+      MergeCallback callback, String taskName,\n       boolean fullMerge) throws IOException {\n-    super(null, null, storageGroupDir, callback, taskName, fullMerge);\n+    super(seqFiles, unseqFiles, storageGroupDir, callback, taskName, fullMerge);\n   }\n \n   public void recoverMerge(boolean continueMerge) throws IOException {",
                "raw_url": "https://github.com/apache/incubator-iotdb/raw/bec56b7bbe6da764275a6ba287618fa06e8f50c2/iotdb/src/main/java/org/apache/iotdb/db/engine/merge/task/RecoverMergeTask.java",
                "sha": "6c92d3c1c2390554481ff1ea314de54f2360882f",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/incubator-iotdb/blob/bec56b7bbe6da764275a6ba287618fa06e8f50c2/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/incubator-iotdb/contents/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java?ref=bec56b7bbe6da764275a6ba287618fa06e8f50c2",
                "deletions": 2,
                "filename": "iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "patch": "@@ -201,8 +201,9 @@ private void recover() throws ProcessorException {\n       if (mergingMods.exists()) {\n         mergingModification = new ModificationFile(storageGroupSysDir + File.separator + MERGING_MODIFICAITON_FILE_NAME);\n       }\n-      RecoverMergeTask recoverMergeTask = new RecoverMergeTask(storageGroupSysDir.getPath(),\n-          this::mergeEndAction, taskName, IoTDBDescriptor.getInstance().getConfig().isForceFullMerge());\n+      RecoverMergeTask recoverMergeTask = new RecoverMergeTask(seqTsFiles, unseqTsFiles,\n+          storageGroupSysDir.getPath(), this::mergeEndAction, taskName,\n+          IoTDBDescriptor.getInstance().getConfig().isForceFullMerge());\n       logger.info(\"{} a RecoverMergeTask {} starts...\", storageGroupName, taskName);\n       recoverMergeTask.recoverMerge(IoTDBDescriptor.getInstance().getConfig().isContinueMergeAfterReboot());\n       if (!IoTDBDescriptor.getInstance().getConfig().isContinueMergeAfterReboot()) {",
                "raw_url": "https://github.com/apache/incubator-iotdb/raw/bec56b7bbe6da764275a6ba287618fa06e8f50c2/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "sha": "29c1146787e300358ab0e3acf66cd50585794aa3",
                "status": "modified"
            }
        ],
        "message": "fix a NPE in merge recovery",
        "parent": "https://github.com/apache/incubator-iotdb/commit/33c605614e61667185bc43fb0cf5bc62fe2f232e",
        "repo": "incubator-iotdb",
        "unit_tests": [
            "StorageGroupProcessorTest.java"
        ]
    },
    "incubator-iotdb_e24236d": {
        "bug_id": "incubator-iotdb_e24236d",
        "commit": "https://github.com/apache/incubator-iotdb/commit/e24236d2a1f3585d6c92e24c3e11c0245514682b",
        "file": [
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/incubator-iotdb/blob/e24236d2a1f3585d6c92e24c3e11c0245514682b/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/incubator-iotdb/contents/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java?ref=e24236d2a1f3585d6c92e24c3e11c0245514682b",
                "deletions": 4,
                "filename": "iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "patch": "@@ -780,20 +780,24 @@ private void mergeEndAction(List<TsFileResource> seqFiles, List<TsFileResource>\n         try {\n           // remove old modifications and write modifications generated during merge\n           seqFile.removeModFile();\n-          for (Modification modification : mergingModification.getModifications()) {\n-            seqFile.getModFile().write(modification);\n+          if (mergingModification != null) {\n+            for (Modification modification : mergingModification.getModifications()) {\n+              seqFile.getModFile().write(modification);\n+            }\n           }\n         } catch (IOException e) {\n           logger.error(\"{} cannot clean the ModificationFile of {} after merge\", storageGroupName,\n               seqFile.getFile(), e);\n         }\n         if (i == seqFiles.size() - 1) {\n           try {\n-            mergingModification.remove();\n+            if (mergingModification != null) {\n+              mergingModification.remove();\n+              mergingModification = null;\n+            }\n           } catch (IOException e) {\n             logger.error(\"{} cannot remove merging modification \", storageGroupName, e);\n           }\n-          mergingModification = null;\n           isMerging = false;\n         }\n       } finally {",
                "raw_url": "https://github.com/apache/incubator-iotdb/raw/e24236d2a1f3585d6c92e24c3e11c0245514682b/iotdb/src/main/java/org/apache/iotdb/db/engine/storagegroup/StorageGroupProcessor.java",
                "sha": "f9841e4662f31d498a35c8e78e9ef3262a2087ce",
                "status": "modified"
            }
        ],
        "message": "fix an NPE in SGP during recovery",
        "parent": "https://github.com/apache/incubator-iotdb/commit/c6362f15d77823ceccf5c6849785b678ee38a90d",
        "repo": "incubator-iotdb",
        "unit_tests": [
            "StorageGroupProcessorTest.java"
        ]
    }
}