[{"commit": "https://github.com/apache/sling-org-apache-sling-installer-factory-deploymentpackage/commit/138b79de5fac1992858518c480e58293e37f9ac3", "parent": "https://github.com/apache/sling-org-apache-sling-installer-factory-deploymentpackage/commit/ccb0e7cbd52ceaf6e4564b3cfbcbc04e12c9ed4f", "message": "Fix NPEs and make service execution more robust.\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@1060274 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "sling-org-apache-sling-installer-factory-deploymentpackage_1", "file": [{"additions": 21, "raw_url": "https://github.com/apache/sling-org-apache-sling-installer-factory-deploymentpackage/raw/138b79de5fac1992858518c480e58293e37f9ac3/src/main/java/org/apache/sling/installer/factories/deploypck/impl/DeploymentPackageInstaller.java", "blob_url": "https://github.com/apache/sling-org-apache-sling-installer-factory-deploymentpackage/blob/138b79de5fac1992858518c480e58293e37f9ac3/src/main/java/org/apache/sling/installer/factories/deploypck/impl/DeploymentPackageInstaller.java", "sha": "934b18f2d5f02ab2a111a02f285bd40eddb962fd", "changes": 41, "status": "modified", "deletions": 20, "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-installer-factory-deploymentpackage/contents/src/main/java/org/apache/sling/installer/factories/deploypck/impl/DeploymentPackageInstaller.java?ref=138b79de5fac1992858518c480e58293e37f9ac3", "patch": "@@ -91,29 +91,30 @@ public DeploymentPackageInstaller(final DeploymentAdmin dpA) {\n     private Manifest getManifest(final InputStream ins) throws IOException {\n         Manifest result = null;\n \n-        JarInputStream jis = null;\n-        try {\n-            jis = new JarInputStream(ins);\n-            result= jis.getManifest();\n-\n-        } finally {\n-\n-            // close the jar stream or the inputstream, if the jar\n-            // stream is set, we don't need to close the input stream\n-            // since closing the jar stream closes the input stream\n-            if (jis != null) {\n-                try {\n-                    jis.close();\n-                } catch (IOException ignore) {\n-                }\n-            } else {\n-                try {\n-                    ins.close();\n-                } catch (IOException ignore) {\n+        if ( ins != null ) {\n+            JarInputStream jis = null;\n+            try {\n+                jis = new JarInputStream(ins);\n+                result= jis.getManifest();\n+\n+            } finally {\n+\n+                // close the jar stream or the inputstream, if the jar\n+                // stream is set, we don't need to close the input stream\n+                // since closing the jar stream closes the input stream\n+                if (jis != null) {\n+                    try {\n+                        jis.close();\n+                    } catch (IOException ignore) {\n+                    }\n+                } else {\n+                    try {\n+                        ins.close();\n+                    } catch (IOException ignore) {\n+                    }\n                 }\n             }\n         }\n-\n         return result;\n     }\n ", "filename": "src/main/java/org/apache/sling/installer/factories/deploypck/impl/DeploymentPackageInstaller.java"}], "repo": "sling-org-apache-sling-installer-factory-deploymentpackage"}]
