[
    {
        "repo": "jackrabbit-oak",
        "commit": "https://github.com/apache/jackrabbit-oak/commit/2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7",
        "bug_id": "jackrabbit-oak_2a7cd0f",
        "message": "minor improvement (prevent NPE in AbstractNameMapper)\n\ngit-svn-id: https://svn.apache.org/repos/asf/jackrabbit/oak/trunk@1346879 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/jackrabbit-oak/commit/b32db799cca7d8499622fcb52c45b0594cd06790",
        "patched_files": [
            "AbstractNameMapper.java",
            "NamePathMapperImpl.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/AbstractNameMapper.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/AbstractNameMapper.java?ref=2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7",
                "filename": "oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/AbstractNameMapper.java",
                "deletions": 3,
                "sha": "e92fb3dbc1ea88e39266ad076f418b599ca392e5",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7/oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/AbstractNameMapper.java",
                "patch": "@@ -26,9 +26,10 @@\n \n     @Override\n     public String getOakName(String jcrName) {\n-\n+        if (jcrName == null || jcrName.isEmpty()) {\n+            return jcrName;\n+        }\n         int pos = jcrName.indexOf(':');\n-        \n         if (pos < 0) {\n             // no colon\n             return jcrName.startsWith(\"{}\") ? jcrName.substring(2) : jcrName;\n@@ -66,6 +67,10 @@ public String getOakName(String jcrName) {\n \n     @Override\n     public String getJcrName(String oakName) {\n+        if (oakName == null || oakName.isEmpty()) {\n+            return oakName;\n+        }\n+\n         int pos = oakName.indexOf(':');\n         if (pos < 0) {\n             // non-prefixed\n@@ -88,5 +93,4 @@ public String getJcrName(String oakName) {\n             }\n         }\n     }\n-\n }",
                "changes": 10
            },
            {
                "status": "modified",
                "additions": 14,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java?ref=2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7",
                "filename": "oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java",
                "deletions": 12,
                "sha": "a3b3454e6f9b354a503f2bb4f4e47564d2bca239",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/2a7cd0fd0b1d2fb3b76c90792b2e5ffa802bbab7/oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java",
                "patch": "@@ -29,12 +29,11 @@\n import static org.junit.Assert.fail;\n \n public class NamePathMapperImplTest {\n+    private TestNameMapper mapper = new TestNameMapper(true);\n+    private NamePathMapper npMapper = new NamePathMapperImpl(mapper);\n \n     @Test\n     public void testInvalidIdentifierPath() {\n-        TestNameMapper mapper = new TestNameMapper(true);\n-        NamePathMapper npMapper = new NamePathMapperImpl(mapper);\n-\n         List<String> invalid = new ArrayList<String>();\n         invalid.add('[' + UUID.randomUUID().toString() + \"]abc\");\n         invalid.add('[' + UUID.randomUUID().toString() + \"]/a/b/c\");\n@@ -45,10 +44,19 @@ public void testInvalidIdentifierPath() {\n     }\n \n     @Test\n-    public void testJcrToOak() {\n-        TestNameMapper mapper = new TestNameMapper(true);\n-        NamePathMapper npMapper = new NamePathMapperImpl(mapper);\n+    public void testNullName() {\n+        assertNull(npMapper.getJcrName(null));\n+        assertNull(npMapper.getOakName(null));\n+    }\n+\n+    @Test\n+    public void testEmptyName() {\n+        assertEquals(\"\", npMapper.getJcrName(\"\"));\n+        assertEquals(\"\", npMapper.getOakName(\"\"));\n+    }\n \n+    @Test\n+    public void testJcrToOak() {\n         assertEquals(\"/\", npMapper.getOakPath(\"/\"));\n         assertEquals(\"foo\", npMapper.getOakPath(\"{}foo\"));\n         assertEquals(\"/oak-foo:bar\", npMapper.getOakPath(\"/foo:bar\"));\n@@ -73,9 +81,6 @@ public void testJcrToOak() {\n \n     @Test\n     public void testJcrToOakKeepIndex() {\n-        TestNameMapper mapper = new TestNameMapper(true);\n-        NamePathMapper npMapper = new NamePathMapperImpl(mapper);\n-\n         assertEquals(\"/\", npMapper.getOakPathKeepIndex(\"/\"));\n         assertEquals(\"foo\", npMapper.getOakPathKeepIndex(\"{}foo\"));\n         assertEquals(\"/oak-foo:bar\", npMapper.getOakPathKeepIndex(\"/foo:bar\"));\n@@ -111,9 +116,6 @@ public void testJcrToOakKeepIndexNoRemap() {\n \n     @Test\n     public void testOakToJcr() {\n-        TestNameMapper mapper = new TestNameMapper(true);\n-        NamePathMapper npMapper = new NamePathMapperImpl(mapper);\n-\n         assertEquals(\"/jcr-foo:bar\", npMapper.getJcrPath(\"/foo:bar\"));\n         assertEquals(\"/jcr-foo:bar/jcr-quu:qux\", npMapper.getJcrPath(\"/foo:bar/quu:qux\"));\n         assertEquals(\"jcr-foo:bar\", npMapper.getJcrPath(\"foo:bar\"));",
                "changes": 26
            }
        ],
        "unit_tests": [
            "NamePathMapperImplTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "oak-core/src/test/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImplTest.java",
        "buggy_files": [
            "oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/AbstractNameMapper.java",
            "oak-core/src/main/java/org/apache/jackrabbit/oak/namepath/NamePathMapperImpl.java"
        ],
        "fixed": true
    }
]