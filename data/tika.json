{
    "tika_070b30c": {
        "bug_id": "tika_070b30c",
        "commit": "https://github.com/apache/tika/commit/070b30c2094b637506a8fcb8597c830b1fe6c3c4",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/tika/blob/070b30c2094b637506a8fcb8597c830b1fe6c3c4/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java?ref=070b30c2094b637506a8fcb8597c830b1fe6c3c4",
                "deletions": 1,
                "filename": "tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "patch": "@@ -249,7 +249,7 @@ public void parse(\n                 throw new TikaException(\n                         \"TIKA-198: Illegal IOException from \" + parser, e);\n             } catch (SAXException e) {\n-                taggedHandler.throwIfCauseOf(e);\n+                if (taggedHandler != null) taggedHandler.throwIfCauseOf(e);\n                 throw new TikaException(\n                         \"TIKA-237: Illegal SAXException from \" + parser, e);\n             }",
                "raw_url": "https://github.com/apache/tika/raw/070b30c2094b637506a8fcb8597c830b1fe6c3c4/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java",
                "sha": "1f6e239aae2fc8d94709a6f9f47a60f99a0c3c4a",
                "status": "modified"
            }
        ],
        "message": "Add check for possible NPE in CompositeParser.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1611406 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/9860b74af1e19ec7a88cccc298f9dcd86d31d3bf",
        "repo": "tika",
        "unit_tests": [
            "CompositeParserTest.java"
        ]
    },
    "tika_2e6b1bc": {
        "bug_id": "tika_2e6b1bc",
        "commit": "https://github.com/apache/tika/commit/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1",
        "file": [
            {
                "additions": 23,
                "blob_url": "https://github.com/apache/tika/blob/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java?ref=2e6b1bccfd5425f424da9ae8ceca7225a247b3f1",
                "deletions": 19,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "patch": "@@ -177,25 +177,29 @@ private void extractEmbeddedDocuments(ParseContext context, PDDocument document,\n                     embeddedExtractor = new ParsingEmbeddedDocumentExtractor(context);\n                 }\n \n-                for (Map.Entry<String,Object> ent : embeddedFiles.getNames().entrySet()) {\n-                    PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();\n-                    PDEmbeddedFile file = spec.getEmbeddedFile();\n-\n-                    Metadata metadata = new Metadata();\n-                    // TODO: other metadata?\n-                    metadata.set(Metadata.RESOURCE_NAME_KEY, ent.getKey());\n-                    metadata.set(Metadata.CONTENT_TYPE, file.getSubtype());\n-                    metadata.set(Metadata.CONTENT_LENGTH, Long.toString(file.getSize()));\n-\n-                    if (embeddedExtractor.shouldParseEmbedded(metadata)) {\n-                        TikaInputStream stream = TikaInputStream.get(file.createInputStream());\n-                        try {\n-                            embeddedExtractor.parseEmbedded(\n-                                    stream,\n-                                    new EmbeddedContentHandler(handler),\n-                                    metadata, false);\n-                        } finally {\n-                            stream.close();\n+                Map<String,Object> embeddedFileNames = embeddedFiles.getNames();\n+\n+                if (embeddedFileNames != null) {\n+                    for (Map.Entry<String,Object> ent : embeddedFileNames.entrySet()) {\n+                        PDComplexFileSpecification spec = (PDComplexFileSpecification) ent.getValue();\n+                        PDEmbeddedFile file = spec.getEmbeddedFile();\n+\n+                        Metadata metadata = new Metadata();\n+                        // TODO: other metadata?\n+                        metadata.set(Metadata.RESOURCE_NAME_KEY, ent.getKey());\n+                        metadata.set(Metadata.CONTENT_TYPE, file.getSubtype());\n+                        metadata.set(Metadata.CONTENT_LENGTH, Long.toString(file.getSize()));\n+\n+                        if (embeddedExtractor.shouldParseEmbedded(metadata)) {\n+                            TikaInputStream stream = TikaInputStream.get(file.createInputStream());\n+                            try {\n+                                embeddedExtractor.parseEmbedded(\n+                                                                stream,\n+                                                                new EmbeddedContentHandler(handler),\n+                                                                metadata, false);\n+                            } finally {\n+                                stream.close();\n+                            }\n                         }\n                     }\n                 }",
                "raw_url": "https://github.com/apache/tika/raw/2e6b1bccfd5425f424da9ae8ceca7225a247b3f1/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "sha": "6940cc73d92b48eb7744e917156838481f046b65",
                "status": "modified"
            }
        ],
        "message": "PDFBOX-1320: fix NPE when visiting embedded files\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1341819 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/ddf2c2a1be1f3b0b8bd792fd5025f1eb7e6b8d71",
        "repo": "tika",
        "unit_tests": [
            "PDFParserTest.java"
        ]
    },
    "tika_308d26f": {
        "bug_id": "tika_308d26f",
        "commit": "https://github.com/apache/tika/commit/308d26fb297c6248f98d777b7a94192fc0ecfce2",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/308d26fb297c6248f98d777b7a94192fc0ecfce2/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java?ref=308d26fb297c6248f98d777b7a94192fc0ecfce2",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "patch": "@@ -103,7 +103,9 @@ public void parse(InputStream stream, ContentHandler handler, Metadata metadata,\n                     mailMetadata.add(EMAIL_FROMLINE_METADATA, curLine.substring(MBOX_RECORD_DIVIDER.length()));\n                     mailMetadata.set(Metadata.CONTENT_TYPE, \"message/rfc822\");\n                     curLine = reader.readLine();\n-\n+                    if (curLine == null) {\n+                        break;\n+                    }\n                     ByteArrayOutputStream message = new ByteArrayOutputStream(100000);\n                     do {\n                         if (curLine.startsWith(\" \") || curLine.startsWith(\"\\t\")) {",
                "raw_url": "https://github.com/apache/tika/raw/308d26fb297c6248f98d777b7a94192fc0ecfce2/tika-parsers/src/main/java/org/apache/tika/parser/mbox/MboxParser.java",
                "sha": "83e26da89dc2fdb64a9a7660c60d0e76148bf6a0",
                "status": "modified"
            }
        ],
        "message": "TIKA-2097 fix npe in MboxParser",
        "parent": "https://github.com/apache/tika/commit/546646844cd68f420969555ebd526400f8550ce2",
        "repo": "tika",
        "unit_tests": [
            "MboxParserTest.java"
        ]
    },
    "tika_35090b3": {
        "bug_id": "tika_35090b3",
        "commit": "https://github.com/apache/tika/commit/35090b30645cb20fbbc8c125850e303dcad5c24f",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/35090b30645cb20fbbc8c125850e303dcad5c24f/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java?ref=35090b30645cb20fbbc8c125850e303dcad5c24f",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "patch": "@@ -285,7 +285,9 @@ private void extractMetadata(PDDocument document, Metadata metadata)\n                 xmp.addXMLNSMapping(XMPSchemaPDFAId.NAMESPACE, XMPSchemaPDFAId.class);\n                 XMPSchemaPDFAId pdfaxmp = (XMPSchemaPDFAId) xmp.getSchemaByClass(XMPSchemaPDFAId.class);\n                 if( pdfaxmp != null ) {\n-                    metadata.set(\"pdfaid:part\", Integer.toString(pdfaxmp.getPart()));\n+                    if (pdfaxmp.getPart() != null) {\n+                        metadata.set(\"pdfaid:part\", Integer.toString(pdfaxmp.getPart()));\n+                    }\n                     if (pdfaxmp.getConformance() != null) {\n                         metadata.set(\"pdfaid:conformance\", pdfaxmp.getConformance());\n                         String version = \"A-\"+pdfaxmp.getPart()+pdfaxmp.getConformance().toLowerCase(Locale.ROOT);",
                "raw_url": "https://github.com/apache/tika/raw/35090b30645cb20fbbc8c125850e303dcad5c24f/tika-parsers/src/main/java/org/apache/tika/parser/pdf/PDFParser.java",
                "sha": "c78259af9a577c40cd892d4ae7859bde0d366742",
                "status": "modified"
            }
        ],
        "message": "another npe in PDFParser\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1673417 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/3e9db56e11340c06c39e71df4d320033eda5810c",
        "repo": "tika",
        "unit_tests": [
            "PDFParserTest.java"
        ]
    },
    "tika_3e79510": {
        "bug_id": "tika_3e79510",
        "commit": "https://github.com/apache/tika/commit/3e795106be703e44c0400c2617d340705748ef9e",
        "file": [
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/tika/blob/3e795106be703e44c0400c2617d340705748ef9e/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java?ref=3e795106be703e44c0400c2617d340705748ef9e",
                "deletions": 6,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "patch": "@@ -22,6 +22,7 @@\n import java.util.Arrays;\n import java.util.Collections;\n import java.util.HashSet;\n+import java.util.Map;\n import java.util.Set;\n import java.util.Map.Entry;\n \n@@ -108,12 +109,8 @@ public void parse(\n             // \"date\" Date date of the recording or release\n             // \"comment\" String an arbitrary text\n \n-            for (Entry<String, Object> entry : fileFormat.properties().entrySet()) {\n-                metadata.set(entry.getKey(), entry.getValue().toString());\n-            }\n-            for (Entry<String, Object> entry : audioFormat.properties().entrySet()) {\n-                metadata.set(entry.getKey(), entry.getValue().toString());\n-            }\n+            addMetadata(metadata, fileFormat.properties());\n+            addMetadata(metadata, audioFormat.properties());\n         } catch (UnsupportedAudioFileException e) {\n             // There is no way to know whether this exception was\n             // caused by the document being corrupted or by the format\n@@ -125,6 +122,17 @@ public void parse(\n         xhtml.endDocument();\n     }\n \n+    private void addMetadata(Metadata metadata, Map<String, Object> properties) {\n+        if (properties != null) {\n+            for (Entry<String, Object> entry : properties.entrySet()) {\n+                Object value = entry.getValue();\n+                if (value != null) {\n+                    metadata.set(entry.getKey(), value.toString());\n+                }\n+            }\n+        }\n+    }\n+\n     /**\n      * @deprecated This method will be removed in Apache Tika 1.0.\n      */",
                "raw_url": "https://github.com/apache/tika/raw/3e795106be703e44c0400c2617d340705748ef9e/tika-parsers/src/main/java/org/apache/tika/parser/audio/AudioParser.java",
                "sha": "328cb56f6c6c01ee5624f3f1efdfb83de4b69911",
                "status": "modified"
            }
        ],
        "message": "TIKA-585: AudioParser Fails with NPE on fileFormat.properties\n\nFix based on suggestion by Cyriel Vringer\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1060797 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/b65fad1d762bdc691258a4b5d473671e1162801f",
        "repo": "tika",
        "unit_tests": [
            "AudioParserTest.java"
        ]
    },
    "tika_48580b0": {
        "bug_id": "tika_48580b0",
        "commit": "https://github.com/apache/tika/commit/48580b0dd9bae39d8a32192bc2b8c3e4177a84be",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/48580b0dd9bae39d8a32192bc2b8c3e4177a84be/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java?ref=48580b0dd9bae39d8a32192bc2b8c3e4177a84be",
                "deletions": 1,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "patch": "@@ -71,7 +71,9 @@ public void parse(InputStream stream, ContentHandler handler, Metadata metadata,\n                 //This fix should be done within POI\n                 if (record.getRecordType().equals(HwmfRecordType.createFontIndirect)) {\n                     HwmfFont font = ((HwmfText.WmfCreateFontIndirect) record).getFont();\n-                    charset = (font.getCharSet().getCharset() == null) ? LocaleUtil.CHARSET_1252 : font.getCharSet().getCharset();\n+                    charset = (font.getCharSet() == null || font.getCharSet().getCharset() == null)\n+                            ? LocaleUtil.CHARSET_1252 :\n+                            font.getCharSet().getCharset();\n                 }\n                 if (record.getRecordType().equals(HwmfRecordType.extTextOut)) {\n                     HwmfText.WmfExtTextOut textOut = (HwmfText.WmfExtTextOut) record;",
                "raw_url": "https://github.com/apache/tika/raw/48580b0dd9bae39d8a32192bc2b8c3e4177a84be/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/WMFParser.java",
                "sha": "aef09f9d1e927823ec45d1ad49cf8a7a64b544bb",
                "status": "modified"
            }
        ],
        "message": "TIKA-2367 -- avoid npe in WMF",
        "parent": "https://github.com/apache/tika/commit/d87314734b7afe0687ffe756694e6f461a7e253e",
        "repo": "tika",
        "unit_tests": [
            "WMFParserTest.java"
        ]
    },
    "tika_4c58d09": {
        "bug_id": "tika_4c58d09",
        "commit": "https://github.com/apache/tika/commit/4c58d09499bf164ed123410464d43c20b764b5d5",
        "file": [
            {
                "additions": 44,
                "blob_url": "https://github.com/apache/tika/blob/4c58d09499bf164ed123410464d43c20b764b5d5/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "changes": 82,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java?ref=4c58d09499bf164ed123410464d43c20b764b5d5",
                "deletions": 38,
                "filename": "tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "patch": "@@ -117,14 +117,15 @@ public static void main(String[] args) throws Exception {\n \n     private class OutputType {\n \n-        public void process(InputStream input, OutputStream output)\n+        public void process(\n+                InputStream input, OutputStream output, Metadata metadata)\n                 throws Exception {\n             Parser p = parser;\n             if (fork) {\n                 p = new ForkParser(TikaCLI.class.getClassLoader(), p);\n             }\n-            ContentHandler handler = getContentHandler(output);\n-            p.parse(input, handler, metadata, context);   \n+            ContentHandler handler = getContentHandler(output, metadata);\n+            p.parse(input, handler, metadata, context);\n             // fix for TIKA-596: if a parser doesn't generate\n             // XHTML output, the lack of an output document prevents\n             // metadata from being output: this fixes that\n@@ -136,76 +137,77 @@ public void process(InputStream input, OutputStream output)\n             }\n         }\n \n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             throw new UnsupportedOperationException();\n         }\n         \n     }\n \n     private final OutputType XML = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return getTransformerHandler(output, \"xml\", encoding, prettyPrint);\n         }\n     };\n \n     private final OutputType HTML = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return getTransformerHandler(output, \"html\", encoding, prettyPrint);\n         }\n     };\n \n     private final OutputType TEXT = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return new BodyContentHandler(getOutputWriter(output, encoding));\n         }\n     };\n \n     private final OutputType NO_OUTPUT = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output) {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) {\n             return new DefaultHandler();\n         }\n     };\n \n     private final OutputType TEXT_MAIN = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             return new BoilerpipeContentHandler(getOutputWriter(output, encoding));\n         }\n     };\n     \n     private final OutputType METADATA = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n-            return new NoDocumentMetHandler(writer);\n+            return new NoDocumentMetHandler(metadata, writer);\n         }\n     };\n \n     private final OutputType JSON = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                     new PrintWriter(getOutputWriter(output, encoding));\n-            return new NoDocumentJSONMetHandler(writer);\n+            return new NoDocumentJSONMetHandler(metadata, writer);\n         }\n     };\n \n     private final OutputType XMP = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, final Metadata metadata) throws Exception {\n             final ContentHandler handler =\n                     getTransformerHandler(output, \"xml\", encoding, prettyPrint);\n             return new DefaultHandler() {\n@@ -222,8 +224,8 @@ public void endDocument() throws SAXException {\n \n     private final OutputType LANGUAGE = new OutputType() {\n         @Override\n-        protected ContentHandler getContentHandler(OutputStream output)\n-                throws Exception {\n+        protected ContentHandler getContentHandler(\n+                OutputStream output, Metadata metadata) throws Exception {\n             final PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n             return new ProfilingHandler() {\n@@ -237,7 +239,8 @@ public void endDocument() {\n \n     private final OutputType DETECT = new OutputType() {\n         @Override\n-        public void process(InputStream stream, OutputStream output)\n+        public void process(\n+                InputStream stream, OutputStream output, Metadata metadata)\n                 throws Exception {\n             PrintWriter writer =\n                 new PrintWriter(getOutputWriter(output, encoding));\n@@ -250,7 +253,8 @@ public void process(InputStream stream, OutputStream output)\n     /* Creates ngram profile */\n     private final OutputType CREATE_PROFILE = new OutputType() {\n         @Override\n-        public void process(InputStream stream, OutputStream output)\n+        public void process(\n+                InputStream stream, OutputStream output, Metadata metadata)\n                 throws Exception {\n             ngp = LanguageProfilerBuilder.create(profileName, stream, encoding);\n             FileOutputStream fos = new FileOutputStream(new File(profileName + \".ngp\"));\n@@ -268,8 +272,6 @@ public void process(InputStream stream, OutputStream output)\n \n     private Parser parser;\n \n-    private Metadata metadata;\n-\n     private OutputType type = XML;\n     \n     private LanguageProfilerBuilder ngp = null;\n@@ -386,14 +388,13 @@ public void process(String arg) throws Exception {\n             type = CREATE_PROFILE;\n         } else {\n             pipeMode = false;\n-            metadata = new Metadata();\n             if (serverMode) {\n                 new TikaServer(Integer.parseInt(arg)).start();\n             } else if (arg.equals(\"-\")) {\n                 InputStream stream =\n                     TikaInputStream.get(new CloseShieldInputStream(System.in));\n                 try {\n-                    type.process(stream, System.out);\n+                    type.process(stream, System.out, new Metadata());\n                 } finally {\n                     stream.close();\n                 }\n@@ -405,9 +406,10 @@ public void process(String arg) throws Exception {\n                 } else {\n                     url = new URL(arg);\n                 }\n+                Metadata metadata = new Metadata();\n                 InputStream input = TikaInputStream.get(url, metadata);\n                 try {\n-                    type.process(input, System.out);\n+                    type.process(input, System.out, metadata);\n                 } finally {\n                     input.close();\n                     System.out.flush();\n@@ -777,8 +779,9 @@ private void processSocketInBackground(final Socket socket) {\n                 public void run() {\n                     try {\n                         try {\n+                            InputStream input = socket.getInputStream();\n                             OutputStream output = socket.getOutputStream();\n-                            type.process(socket.getInputStream(), output);\n+                            type.process(input, output, new Metadata());\n                             output.flush();\n                         } finally {\n                             socket.close();\n@@ -794,13 +797,16 @@ public void run() {\n \n     }\n     \n-    private class NoDocumentMetHandler extends DefaultHandler{\n-        \n+    private class NoDocumentMetHandler extends DefaultHandler {\n+\n+        protected final Metadata metadata;\n+\n         protected PrintWriter writer;\n         \n         private boolean metOutput;\n-        \n-        public NoDocumentMetHandler(PrintWriter writer){\n+\n+        public NoDocumentMetHandler(Metadata metadata, PrintWriter writer){\n+            this.metadata = metadata;\n             this.writer = writer;\n             this.metOutput = false;\n         }\n@@ -834,8 +840,8 @@ public boolean metOutput(){\n         private NumberFormat formatter;\n         private Gson gson;\n        \n-        public NoDocumentJSONMetHandler(PrintWriter writer){\n-            super(writer);\n+        public NoDocumentJSONMetHandler(Metadata metadata, PrintWriter writer){\n+            super(metadata, writer);\n             \n             formatter = NumberFormat.getInstance();\n             gson = new Gson();",
                "raw_url": "https://github.com/apache/tika/raw/4c58d09499bf164ed123410464d43c20b764b5d5/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java",
                "sha": "fd5c2ee8ef8f36f6ebd3acab6398090bf41173e2",
                "status": "modified"
            }
        ],
        "message": "TIKA-934: Tika in server mode stops responding and reports NPE over and over in logs\n\nUse per-document Metadata instances instead of a single global one\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1355719 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/14113de27f6f8c0bb56d5b2d025acdf4ef2b1685",
        "repo": "tika",
        "unit_tests": [
            "TikaCLITest.java"
        ]
    },
    "tika_53ef1b9": {
        "bug_id": "tika_53ef1b9",
        "commit": "https://github.com/apache/tika/commit/53ef1b992d779676987d737e634b66f45d58310b",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/53ef1b992d779676987d737e634b66f45d58310b/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java?ref=53ef1b992d779676987d737e634b66f45d58310b",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "patch": "@@ -307,6 +307,8 @@ private static Date MP4TimeToDate(long mp4Time) {\n     private static final long EPOC_AS_MP4_TIME = 2082844800l;\n     \n     private static <T extends Box> T getOrNull(ContainerBox box, Class<T> clazz) {\n+       if (box == null) return null;\n+\n        List<T> boxes = box.getBoxes(clazz);\n        if (boxes.size() == 0) {\n           return null;",
                "raw_url": "https://github.com/apache/tika/raw/53ef1b992d779676987d737e634b66f45d58310b/tika-parsers/src/main/java/org/apache/tika/parser/mp4/MP4Parser.java",
                "sha": "1507e762eb81f81a748b31c8bff3eadcd7a854e0",
                "status": "modified"
            }
        ],
        "message": "TIKA-852 Avoid NPE on missing metadata boxes\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1241975 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/5498c0eeea7d2a5d6d314bcddc7d307830e97c27",
        "repo": "tika",
        "unit_tests": [
            "MP4ParserTest.java"
        ]
    },
    "tika_61671f5": {
        "bug_id": "tika_61671f5",
        "commit": "https://github.com/apache/tika/commit/61671f5d97d97e6f379dd94391ed8449f8c15073",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -1,5 +1,8 @@\n Release 1.12 - Current Development\n \n+  * Upgrade rome to 1.5.1 && Downgrade Rome dependency to 0.9 to avoid \n+    nasty NPE (TIKA-1820, TIKA-1516)\n+\n   * The NamedEntityParser was enhanced to generate text content\n     in addition to metadata (TIKA-1815, TIKA-1816).\n ",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/CHANGES.txt",
                "sha": "a5b86fe1247f029ac269a36209d73c32c64c54ec",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-bundle/pom.xml",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-bundle/pom.xml?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 8,
                "filename": "tika-bundle/pom.xml",
                "patch": "@@ -131,14 +131,14 @@\n               poi,poi-scratchpad,poi-ooxml,poi-ooxml-schemas,\n               xmlbeans,\n               jackcess,\n-              commons-lang,              \n+              commons-lang,\n               tagsoup,\n               asm,\n               juniversalchardet,\n               vorbis-java-core, vorbis-java-tika,\n               isoparser, aspectjrt,\n               metadata-extractor, xmpcore, json-simple,\n-              boilerpipe, rome, opennlp-tools, opennlp-maxent,\n+              boilerpipe, rome, rome-utils, opennlp-tools, opennlp-maxent,\n               geoapi, sis-metadata, sis-netcdf, sis-utility,\n               sis-storage, apache-mime4j-core, apache-mime4j-dom,\n               jsr-275, jhighlight, java-libpst, jwnl,\n@@ -185,7 +185,7 @@\n               javax.xml.stream;version=\"[1.0,2)\";resolution:=optional,\n               javax.xml.stream.events;version=\"[1.0,2)\";resolution:=optional,\n               javax.xml.stream.util;version=\"[1.0,2)\";resolution:=optional,\n-\t      javax.ws.rs.core;resolution:=optional,\n+              javax.ws.rs.core;resolution:=optional,\n               net.sf.ehcache;resolution:=optional,\n               nu.xom;resolution:=optional,\n               opendap.dap.http;resolution:=optional,\n@@ -194,8 +194,8 @@\n               opennlp.maxent;resolution:=optional,\n               opennlp.tools.namefind;resolution:=optional,\n               net.didion.jwnl;resolution:=optional,\n-\t      org.apache.cxf.jaxrs.client;resolution:=optional,\n-\t      org.apache.cxf.jaxrs.ext.multipart;resolution:=optional,\n+              org.apache.cxf.jaxrs.client;resolution:=optional,\n+              org.apache.cxf.jaxrs.ext.multipart;resolution:=optional,\n               org.apache.commons.exec;resolution:=optional,\n               org.apache.commons.io;resolution:=optional,\n               org.apache.commons.httpclient;resolution:=optional,\n@@ -246,9 +246,11 @@\n               org.jdom.output;resolution:=optional,\n               org.jdom2;resolution:=optional,\n               org.jdom2.input;resolution:=optional,\n+              org.jdom2.input.sax;resolution:=optional,\n               org.jdom2.output;resolution:=optional,\n+              org.jdom2.filter;resolution:=optional,\n               org.json.simple;resolution:=optional,\n-\t      org.json;resolution:=optional,\n+              org.json;resolution:=optional,\n               org.openxmlformats.schemas.officeDocument.x2006.math;resolution:=optional,\n               org.openxmlformats.schemas.schemaLibrary.x2006.main;resolution:=optional,\n               org.osgi.framework;resolution:=optional,\n@@ -295,7 +297,7 @@\n               ucar.unidata.io;resolution:=optional,\n               ucar.unidata.util;resolution:=optional,\n               com.jmatio.io;resolution:=optional,\n-\t      com.google.gson;resolution:=optional,\n+              com.google.gson;resolution:=optional,\n               visad;resolution:=optional,\n               visad.data;resolution:=optional,\n               visad.data.vis5d;resolution:=optional,\n@@ -331,7 +333,7 @@\n               com.google.common.base;resolution:=optional,\n               com.google.common.math;resolution:=optional,\n               org.apache.http;resolution:=optional,\n-\t      org.apache.http.client.utils;resolution:=optional,\n+              org.apache.http.client.utils;resolution:=optional,\n               org.joda.time;resolution:=optional,\n               org.joda.time.chrono;resolution:=optional,\n               org.joda.time.field;resolution:=optional,",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-bundle/pom.xml",
                "sha": "8e7c4e97b5617667041dffb121e873231f5295a0",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/pom.xml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/pom.xml?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 2,
                "filename": "tika-parsers/pom.xml",
                "patch": "@@ -196,9 +196,9 @@\n       <version>1.1.0</version>\n     </dependency>\n     <dependency>\n-      <groupId>rome</groupId>\n+      <groupId>com.rometools</groupId>\n       <artifactId>rome</artifactId>\n-      <version>1.0</version>\n+      <version>1.5.1</version>\n     </dependency>\n     <dependency>\n       <groupId>org.gagravarr</groupId>",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/pom.xml",
                "sha": "bb1bd71dcf8610bf161b76bf3535a8e389b26a72",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/tika/blob/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java?ref=61671f5d97d97e6f379dd94391ed8449f8c15073",
                "deletions": 5,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "patch": "@@ -35,11 +35,11 @@\n import org.xml.sax.InputSource;\n import org.xml.sax.SAXException;\n \n-import com.sun.syndication.feed.synd.SyndContent;\n-import com.sun.syndication.feed.synd.SyndEntry;\n-import com.sun.syndication.feed.synd.SyndFeed;\n-import com.sun.syndication.io.FeedException;\n-import com.sun.syndication.io.SyndFeedInput;\n+import com.rometools.rome.feed.synd.SyndContent;\n+import com.rometools.rome.feed.synd.SyndEntry;\n+import com.rometools.rome.feed.synd.SyndFeed;\n+import com.rometools.rome.io.FeedException;\n+import com.rometools.rome.io.SyndFeedInput;\n \n /**\n  * Feed parser.",
                "raw_url": "https://github.com/apache/tika/raw/61671f5d97d97e6f379dd94391ed8449f8c15073/tika-parsers/src/main/java/org/apache/tika/parser/feed/FeedParser.java",
                "sha": "428ff83d4dda78fbd548db4905ab543c9d344d04",
                "status": "modified"
            }
        ],
        "message": "TIKA-1820 Upgrade rome to 1.5.1 && TIKA-1516 Downgrade Rome dependency to 0.9 to avoid nasty NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1722935 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/e9718f90513f1a4cde62e79794089bc45b35e4af",
        "repo": "tika",
        "unit_tests": [
            "FeedParserTest.java"
        ]
    },
    "tika_92a4835": {
        "bug_id": "tika_92a4835",
        "commit": "https://github.com/apache/tika/commit/92a4835d02d94fddbc7d70c0507b8a32345662d9",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/92a4835d02d94fddbc7d70c0507b8a32345662d9/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java?ref=92a4835d02d94fddbc7d70c0507b8a32345662d9",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "patch": "@@ -131,6 +131,9 @@ protected static String joinCreators(List<String> creators) {\n      * @param metadata\n      */\n     public static void extractXMPMM(XMPMetadata xmp, Metadata metadata) {\n+        if (xmp == null) {\n+            return;\n+        }\n         XMPSchemaMediaManagement mmSchema = null;\n         try {\n             mmSchema = xmp.getMediaManagementSchema();",
                "raw_url": "https://github.com/apache/tika/raw/92a4835d02d94fddbc7d70c0507b8a32345662d9/tika-parsers/src/main/java/org/apache/tika/parser/image/xmp/JempboxExtractor.java",
                "sha": "0f326a834955f4839119deb64e12212c06d473e5",
                "status": "modified"
            }
        ],
        "message": "TIKA-1894 -- fix potential NPE in XMPMM extraction",
        "parent": "https://github.com/apache/tika/commit/7a543c8076a3ceb2dfa92fce06fc558cfe84cde7",
        "repo": "tika",
        "unit_tests": [
            "JempboxExtractorTest.java"
        ]
    },
    "tika_9c2e1b9": {
        "bug_id": "tika_9c2e1b9",
        "commit": "https://github.com/apache/tika/commit/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/CHANGES.txt?ref=9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -1,5 +1,8 @@\n Release 1.17 - ???\n \n+  * Catch potential NPE in getting InputStream for attachments\n+    in PST file (TIKA-2488).\n+\n   * Upgrade to PDFBox 2.0.8 (TIKA-2489).\n \n   * Allow configuration of markLimit in EncodingDetectors",
                "raw_url": "https://github.com/apache/tika/raw/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/CHANGES.txt",
                "sha": "8cb683c99171ef821ba43d2bcd25b9f0d559cac8",
                "status": "modified"
            },
            {
                "additions": 23,
                "blob_url": "https://github.com/apache/tika/blob/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java?ref=9c2e1b9d839cffbc0820b789ffdd17a9a0b10759",
                "deletions": 12,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "patch": "@@ -125,8 +125,14 @@ private void parseFolder(XHTMLContentHandler handler, PSTFolder pstFolder, Embed\n                 handler.startElement(\"div\", attributes);\n                 handler.element(\"h1\", pstMail.getSubject());\n \n-                parserMailItem(handler, pstMail, embeddedExtractor);\n-                parseMailAttachments(handler, pstMail, embeddedExtractor);\n+                final Metadata mailMetadata = new Metadata();\n+                //parse attachments first so that stream exceptions\n+                //in attachments can make it into mailMetadata.\n+                //RecursiveParserWrapper copies the metadata and thereby prevents\n+                //modifications to mailMetadata from making it into the\n+                //metadata objects cached by the RecursiveParserWrapper\n+                parseMailAttachments(handler, pstMail, mailMetadata, embeddedExtractor);\n+                parserMailItem(handler, pstMail, mailMetadata, embeddedExtractor);\n \n                 handler.endElement(\"div\");\n \n@@ -144,8 +150,8 @@ private void parseFolder(XHTMLContentHandler handler, PSTFolder pstFolder, Embed\n         }\n     }\n \n-    private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, EmbeddedDocumentExtractor embeddedExtractor) throws SAXException, IOException {\n-        Metadata mailMetadata = new Metadata();\n+    private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, Metadata mailMetadata,\n+                                EmbeddedDocumentExtractor embeddedExtractor) throws SAXException, IOException {\n         mailMetadata.set(Metadata.RESOURCE_NAME_KEY, pstMail.getInternetMessageId());\n         mailMetadata.set(Metadata.EMBEDDED_RELATIONSHIP_ID, pstMail.getInternetMessageId());\n         mailMetadata.set(TikaCoreProperties.IDENTIFIER, pstMail.getInternetMessageId());\n@@ -217,11 +223,12 @@ private void parserMailItem(XHTMLContentHandler handler, PSTMessage pstMail, Emb\n         embeddedExtractor.parseEmbedded(new ByteArrayInputStream(mailContent), handler, mailMetadata, true);\n     }\n \n-    private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email, EmbeddedDocumentExtractor embeddedExtractor)\n+    private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email,\n+                                     final Metadata mailMetadata,\n+                                      EmbeddedDocumentExtractor embeddedExtractor)\n             throws TikaException {\n         int numberOfAttachments = email.getNumberOfAttachments();\n         for (int i = 0; i < numberOfAttachments; i++) {\n-            File tempFile = null;\n             try {\n                 PSTAttachment attach = email.getAttachment(i);\n \n@@ -241,21 +248,25 @@ private void parseMailAttachments(XHTMLContentHandler xhtml, PSTMessage email, E\n                 attributes.addAttribute(\"\", \"id\", \"id\", \"CDATA\", filename);\n                 xhtml.startElement(\"div\", attributes);\n                 if (embeddedExtractor.shouldParseEmbedded(attachMeta)) {\n-                    TemporaryResources tmp = new TemporaryResources();\n+                    TikaInputStream tis = null;\n+                    try {\n+                        tis = TikaInputStream.get(attach.getFileInputStream());\n+                    } catch (NullPointerException e) {//TIKA-2488\n+                        EmbeddedDocumentUtil.recordEmbeddedStreamException(e, mailMetadata);\n+                        continue;\n+                    }\n+\n                     try {\n-                        TikaInputStream tis = TikaInputStream.get(attach.getFileInputStream(), tmp);\n                         embeddedExtractor.parseEmbedded(tis, xhtml, attachMeta, true);\n                     } finally {\n-                        tmp.dispose();\n+\n+                        tis.close();\n                     }\n                 }\n                 xhtml.endElement(\"div\");\n \n             } catch (Exception e) {\n                 throw new TikaException(\"Unable to unpack document stream\", e);\n-            } finally {\n-                if (tempFile != null)\n-                    tempFile.delete();\n             }\n         }\n     }",
                "raw_url": "https://github.com/apache/tika/raw/9c2e1b9d839cffbc0820b789ffdd17a9a0b10759/tika-parsers/src/main/java/org/apache/tika/parser/mbox/OutlookPSTParser.java",
                "sha": "61d7bac657af136292f72045d1602a7fd9162bfb",
                "status": "modified"
            }
        ],
        "message": "TIKA-2488 -- catch potential npe in getting attachment's inputstream",
        "parent": "https://github.com/apache/tika/commit/04b0837700e7d0ecc337a50ca99d2a063978a58b",
        "repo": "tika",
        "unit_tests": [
            "OutlookPSTParserTest.java"
        ]
    },
    "tika_b6d67d3": {
        "bug_id": "tika_b6d67d3",
        "commit": "https://github.com/apache/tika/commit/b6d67d32c1e43de488673d1925e0b6319588e4f9",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/tika/blob/b6d67d32c1e43de488673d1925e0b6319588e4f9/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFParser.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFParser.java?ref=b6d67d32c1e43de488673d1925e0b6319588e4f9",
                "deletions": 0,
                "filename": "tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFParser.java",
                "patch": "@@ -118,6 +118,10 @@ public void parse(InputStream stream, ContentHandler handler,\n             xhtml.endDocument();\n         } catch (BadLocationException e) {\n             throw new TikaException(\"Error parsing an RTF document\", e);\n+        } catch (NullPointerException e) {\n+            // TIKA-621: RTF parsing fails with Java 7 early access\n+            // on 64bit platforms\n+            throw new TikaException(\"Error parsing an RTF document\", e);\n         } finally {\n             IOUtils.closeQuietly(in);\n             if (tempFile != null) {",
                "raw_url": "https://github.com/apache/tika/raw/b6d67d32c1e43de488673d1925e0b6319588e4f9/tika-parsers/src/main/java/org/apache/tika/parser/rtf/RTFParser.java",
                "sha": "145aaa772321053b668abbee8fe88d332d8c54fa",
                "status": "modified"
            }
        ],
        "message": "TIKA-621: RTF parsing fails with Java 7 early access on 64bit platforms\n\nCapture the possible NPE and wrap it into a more appropriate TikaException\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1091849 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/75c5bcf38ae0bb06047ec364db63b12f3bbae486",
        "repo": "tika",
        "unit_tests": [
            "RTFParserTest.java"
        ]
    },
    "tika_dada2b7": {
        "bug_id": "tika_dada2b7",
        "commit": "https://github.com/apache/tika/commit/dada2b757ec3292ab49a0e75b60b5b1211fd801d",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/dada2b757ec3292ab49a0e75b60b5b1211fd801d/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java?ref=dada2b757ec3292ab49a0e75b60b5b1211fd801d",
                "deletions": 1,
                "filename": "tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "patch": "@@ -157,9 +157,18 @@ public void addText(char[] cbuf, int off, int len) {\n \t\twriter.write(' ');\n \t}\n \n+        /**\n+         * {@inheritDoc}\n+         *\n+         * @throws IllegalStateException if no models have been loaded with\n+         * {@link #loadModels() } or {@link #loadModels(java.util.Set) }\n+         * @return the detected list of languages\n+         */\n \t@Override\n \tpublic List<LanguageResult> detectAll() {\n-\t\t// TODO throw exception if models haven't been loaded, or auto-load all?\n+\t\tif(detector == null) {\n+                    throw new IllegalStateException(\"models haven't been loaded yet (forgot to call loadModels?)\");\n+                }\n \t\t\n \t\tList<LanguageResult> result = new ArrayList<>();\n \t\t",
                "raw_url": "https://github.com/apache/tika/raw/dada2b757ec3292ab49a0e75b60b5b1211fd801d/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "sha": "d31559238f519e958ade1b672c477089abaee14a",
                "status": "modified"
            }
        ],
        "message": "Merge branch 'npe' of https://github.com/krichter722/tika into krichter722-npe",
        "parent": "https://github.com/apache/tika/commit/4e03f90cf0a20375819f33371ec094386a744f36",
        "repo": "tika",
        "unit_tests": [
            "OptimaizeLangDetectorTest.java"
        ]
    },
    "tika_e5526b5": {
        "bug_id": "tika_e5526b5",
        "commit": "https://github.com/apache/tika/commit/e5526b559e549a7b6039844dc237b03579490a41",
        "file": [
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/tika/blob/e5526b559e549a7b6039844dc237b03579490a41/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java?ref=e5526b559e549a7b6039844dc237b03579490a41",
                "deletions": 1,
                "filename": "tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "patch": "@@ -157,9 +157,18 @@ public void addText(char[] cbuf, int off, int len) {\n \t\twriter.write(' ');\n \t}\n \n+        /**\n+         * {@inheritDoc}\n+         *\n+         * @throws IllegalStateException if no models have been loaded with\n+         * {@link #loadModels() } or {@link #loadModels(java.util.Set) }\n+         * @return the detected list of languages\n+         */\n \t@Override\n \tpublic List<LanguageResult> detectAll() {\n-\t\t// TODO throw exception if models haven't been loaded, or auto-load all?\n+\t\tif(detector == null) {\n+                    throw new IllegalStateException(\"models haven't been loaded yet (forgot to call loadModels?)\");\n+                }\n \t\t\n \t\tList<LanguageResult> result = new ArrayList<>();\n \t\t",
                "raw_url": "https://github.com/apache/tika/raw/e5526b559e549a7b6039844dc237b03579490a41/tika-langdetect/src/main/java/org/apache/tika/langdetect/OptimaizeLangDetector.java",
                "sha": "d31559238f519e958ade1b672c477089abaee14a",
                "status": "modified"
            }
        ],
        "message": "Merge branch 'krichter722-npe'",
        "parent": "https://github.com/apache/tika/commit/4e03f90cf0a20375819f33371ec094386a744f36",
        "repo": "tika",
        "unit_tests": [
            "OptimaizeLangDetectorTest.java"
        ]
    },
    "tika_e607d65": {
        "bug_id": "tika_e607d65",
        "commit": "https://github.com/apache/tika/commit/e607d65bc58087116408988342331dcb20ff9bba",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/e607d65bc58087116408988342331dcb20ff9bba/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java?ref=e607d65bc58087116408988342331dcb20ff9bba",
                "deletions": 4,
                "filename": "tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "patch": "@@ -19,7 +19,6 @@\n \n import com.fasterxml.jackson.databind.util.LRUMap;\n \n-import org.apache.tika.config.ServiceLoader;\n import org.apache.tika.exception.TikaException;\n import org.apache.tika.language.LanguageIdentifier;\n import org.apache.tika.language.LanguageProfile;\n@@ -54,7 +53,7 @@ public CachedTranslator(){\n      */\n     public CachedTranslator(Translator translator) {\n         this.translator = translator;\n-        cache = new HashMap<String, LRUMap<String, String>>();\n+        this.cache = new HashMap<>();\n     }\n \n     /**\n@@ -93,7 +92,7 @@ public String translate(String text, String targetLanguage) throws TikaException\n \n     @Override\n     public boolean isAvailable() {\n-        return translator.isAvailable();\n+        return translator != null && translator.isAvailable();\n     }\n \n     /**\n@@ -172,7 +171,7 @@ private String buildCacheKeyString(String sourceLanguage, String targetLanguage)\n     private LRUMap<String, String> getTranslationCache(String sourceLanguage, String targetLanguage) {\n         LRUMap<String, String> translationCache = cache.get(buildCacheKeyString(sourceLanguage, targetLanguage));\n         if (translationCache == null) {\n-            translationCache = new LRUMap<String, String>(INITIAL_ENTRIES, MAX_ENTRIES);\n+            translationCache = new LRUMap<>(INITIAL_ENTRIES, MAX_ENTRIES);\n             cache.put(buildCacheKeyString(sourceLanguage, targetLanguage), translationCache);\n         }\n         return translationCache;",
                "raw_url": "https://github.com/apache/tika/raw/e607d65bc58087116408988342331dcb20ff9bba/tika-translate/src/main/java/org/apache/tika/language/translate/CachedTranslator.java",
                "sha": "5a771a1fea47e9afcc637026a9e249461ff21267",
                "status": "modified"
            }
        ],
        "message": "Patch from Yaniv Kunda from TIKA-1750 - avoid NPE in CachedTranslator if no underlying translator is available\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1705107 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/d6d180c5d94d80722e239341e4eb8398a32817cd",
        "repo": "tika",
        "unit_tests": [
            "CachedTranslatorTest.java"
        ]
    },
    "tika_f52da71": {
        "bug_id": "tika_f52da71",
        "commit": "https://github.com/apache/tika/commit/f52da719f16ad7379d5b7019ac766a80ab48d6db",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/tika/blob/f52da719f16ad7379d5b7019ac766a80ab48d6db/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/tika/contents/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java?ref=f52da719f16ad7379d5b7019ac766a80ab48d6db",
                "deletions": 1,
                "filename": "tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "patch": "@@ -291,7 +291,9 @@ public void endElement(String name) throws SAXException {\n     }\n \n     public void characters(String characters) throws SAXException {\n-        characters(characters.toCharArray(), 0, characters.length());\n+        if (characters != null && characters.length() > 0) {\n+            characters(characters.toCharArray(), 0, characters.length());\n+        }\n     }\n \n     public void newline() throws SAXException {",
                "raw_url": "https://github.com/apache/tika/raw/f52da719f16ad7379d5b7019ac766a80ab48d6db/tika-core/src/main/java/org/apache/tika/sax/XHTMLContentHandler.java",
                "sha": "fd2b3015513bb7c252666a71f4d2f46c31b67123",
                "status": "modified"
            }
        ],
        "message": "TIKA-760 Avoid NPE in XHTMLContentHandler if a null string is passed to the characters method\n\ngit-svn-id: https://svn.apache.org/repos/asf/tika/trunk@1235284 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/tika/commit/8f05b4e99721921279f2656663c58b403eff2329",
        "repo": "tika",
        "unit_tests": [
            "XHTMLContentHandlerTest.java"
        ]
    }
}