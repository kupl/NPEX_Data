[
    {
        "repo": "qpid-broker-j",
        "commit": "https://github.com/apache/qpid-broker-j/commit/1f563a876f0cf84148b9126341094cef2538282f",
        "bug_id": "qpid-broker-j_1f563a8",
        "message": "QPID-6001: [Java Client] Prevent NPE when publishing using ADDR destination to Broker using AMQP 0-9-1 or lower",
        "parent": "https://github.com/apache/qpid-broker-j/commit/2c87f10720b757b19281e831c809339ac349296a",
        "patched_files": [
            "AMQSession_0_8.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/qpid-broker-j/raw/1f563a876f0cf84148b9126341094cef2538282f/client/src/main/java/org/apache/qpid/client/AMQSession_0_8.java",
                "contents_url": "https://api.github.com/repos/apache/qpid-broker-j/contents/client/src/main/java/org/apache/qpid/client/AMQSession_0_8.java?ref=1f563a876f0cf84148b9126341094cef2538282f",
                "filename": "client/src/main/java/org/apache/qpid/client/AMQSession_0_8.java",
                "deletions": 1,
                "sha": "ef0d023fb2b45b79ada19dda8d2cd3aeafbaf911",
                "blob_url": "https://github.com/apache/qpid-broker-j/blob/1f563a876f0cf84148b9126341094cef2538282f/client/src/main/java/org/apache/qpid/client/AMQSession_0_8.java",
                "patch": "@@ -735,9 +735,14 @@ public void sync() throws AMQException\n     public void resolveAddress(AMQDestination dest,\n                                               boolean isConsumer,\n                                               boolean noLocal) throws AMQException\n+    {\n+        throwUnsupportedAddressingSyntax();\n+    }\n+\n+    void throwUnsupportedAddressingSyntax()\n     {\n         throw new UnsupportedOperationException(\"The new addressing based syntax is \"\n-                + \"not supported for AMQP 0-8/0-9 versions\");\n+                + \"not supported for AMQP 0-8/0-9/0-9-1 versions\");\n     }\n \n     protected void flushAcknowledgments()",
                "changes": 7
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/qpid-broker-j/raw/1f563a876f0cf84148b9126341094cef2538282f/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_8.java",
                "contents_url": "https://api.github.com/repos/apache/qpid-broker-j/contents/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_8.java?ref=1f563a876f0cf84148b9126341094cef2538282f",
                "filename": "client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_8.java",
                "deletions": 0,
                "sha": "ed517d38a7e721840e14c4d7fcd8eabf10e47cb4",
                "blob_url": "https://github.com/apache/qpid-broker-j/blob/1f563a876f0cf84148b9126341094cef2538282f/client/src/main/java/org/apache/qpid/client/BasicMessageProducer_0_8.java",
                "patch": "@@ -57,6 +57,12 @@\n \n     void declareDestination(AMQDestination destination)\n     {\n+\n+        if (destination.getDestSyntax() == AMQDestination.DestSyntax.ADDR)\n+        {\n+            getSession().throwUnsupportedAddressingSyntax();\n+        }\n+\n         if(getSession().isDeclareExchanges())\n         {\n             final MethodRegistry methodRegistry = getSession().getMethodRegistry();",
                "changes": 6
            }
        ],
        "unit_tests": [
            "AMQSession_0_8Test.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "client/src/test/java/org/apache/qpid/client/AMQSession_0_8Test.java",
        "buggy_files": [
            "client/src/main/java/org/apache/qpid/client/AMQSession_0_8.java"
        ],
        "fixed": true
    }
]