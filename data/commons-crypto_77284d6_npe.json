[
    {
        "repo": "commons-crypto",
        "commit": "https://github.com/apache/commons-crypto/commit/77284d6ac3345867fe0449183ae0e11760f4f29c",
        "bug_id": "commons-crypto_77284d6",
        "message": "Rename security random with crypto prefix and do NPE check for factory method",
        "parent": "https://github.com/apache/commons-crypto/commit/a6fab706187bce528ca561e9cb411c01d69d07ef",
        "patched_files": [
            "ConfigurationKeys.java",
            "JavaSecureRandom.java",
            "OpensslSecureRandom.java",
            "SecureRandomFactory.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c",
                "filename": "src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "deletions": 2,
                "sha": "20c06d1d2248ff0a4149250f455a98b9df4b3d24",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "patch": "@@ -41,8 +41,8 @@\n   public static final String CHIMERA_JAVA_SECURE_RANDOM_ALGORITHM_DEFAULT =\n       \"SHA1PRNG\";\n \n-  public static final String CHIMERA_SECURE_RANDOM_CLASSES_KEY =\n-      CONF_PREFIX + \".secure.random.classes\";\n+  public static final String CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY =\n+      CONF_PREFIX + \".crypto.secure.random.classes\";\n \n   public static final int CHIMERA_CRYPTO_BUFFER_SIZE_DEFAULT = 8192;\n   public static final String CHIMERA_CRYPTO_BUFFER_SIZE_KEY =",
                "changes": 4
            },
            {
                "status": "modified",
                "additions": 16,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/main/java/com/intel/chimera/random/SecureRandomFactory.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c",
                "filename": "src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "deletions": 14,
                "sha": "e418fe0f458b4e533a3230050d97b28ebdca7572",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "patch": "@@ -25,7 +25,7 @@\n \n import com.intel.chimera.utils.ReflectionUtils;\n import static com.intel.chimera.conf.ConfigurationKeys\n-    .CHIMERA_SECURE_RANDOM_CLASSES_KEY;\n+    .CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY;\n \n /**\n  * The Factory for SecureRandom.\n@@ -36,25 +36,27 @@\n \n   public static SecureRandom getSecureRandom(Properties props) {\n     String secureRandomClasses = props.getProperty(\n-        CHIMERA_SECURE_RANDOM_CLASSES_KEY);\n+        CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY);\n     if (secureRandomClasses == null) {\n       secureRandomClasses = System.getProperty(\n-          CHIMERA_SECURE_RANDOM_CLASSES_KEY);\n+          CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY);\n     }\n \n     SecureRandom random = null;\n-    for (String klassName : Splitter.on(',').trimResults().omitEmptyStrings()\n-        .split(secureRandomClasses)) {\n-      try {\n-        final Class klass = ReflectionUtils.getClassByName(klassName);\n-        random = (SecureRandom) ReflectionUtils.newInstance(klass, props);\n-        if (random != null) {\n-          break;\n+    if (secureRandomClasses != null) {\n+      for (String klassName : Splitter.on(',').trimResults().omitEmptyStrings()\n+          .split(secureRandomClasses)) {\n+        try {\n+          final Class klass = ReflectionUtils.getClassByName(klassName);\n+          random = (SecureRandom) ReflectionUtils.newInstance(klass, props);\n+          if (random != null) {\n+            break;\n+          }\n+        } catch (ClassCastException e) {\n+          LOG.error(\"Class {} is not a Cipher.\", klassName);\n+        } catch (ClassNotFoundException e) {\n+          LOG.error(\"Cipher {} not found.\", klassName);\n         }\n-      } catch (ClassCastException e) {\n-        LOG.error(\"Class {} is not a Cipher.\", klassName);\n-      } catch (ClassNotFoundException e) {\n-        LOG.error(\"Cipher {} not found.\", klassName);\n       }\n     }\n ",
                "changes": 30
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c",
                "filename": "src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "deletions": 1,
                "sha": "154e884f79278a6188193fdcb10e540cfa531131",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "patch": "@@ -28,7 +28,7 @@\n   @Override\n   public SecureRandom getSecureRandom() throws IOException {\n     Properties props = new Properties();\n-    props.setProperty(ConfigurationKeys.CHIMERA_SECURE_RANDOM_CLASSES_KEY,\n+    props.setProperty(ConfigurationKeys.CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY,\n         JavaSecureRandom.class.getName());\n     SecureRandom random = SecureRandomFactory.getSecureRandom(props);\n     if ( !(random instanceof JavaSecureRandom)) {",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c",
                "filename": "src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "deletions": 1,
                "sha": "07edca5a979ce22702fef5920a8c319373a8def4",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "patch": "@@ -28,7 +28,7 @@\n   @Override\n   public SecureRandom getSecureRandom() throws IOException {\n     Properties props = new Properties();\n-    props.setProperty(ConfigurationKeys.CHIMERA_SECURE_RANDOM_CLASSES_KEY,\n+    props.setProperty(ConfigurationKeys.CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY,\n         OpensslSecureRandom.class.getName());\n     SecureRandom random = SecureRandomFactory.getSecureRandom(props);\n     if ( !(random instanceof OpensslSecureRandom)) {",
                "changes": 2
            }
        ],
        "unit_tests": [
            "TestJavaSecureRandom.java",
            "TestOpensslSecureRandom.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
        "buggy_files": [
            "src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
            "src/main/java/com/intel/chimera/random/JavaSecureRandom.java",
            "src/main/java/com/intel/chimera/random/OpensslSecureRandom.java",
            "src/main/java/com/intel/chimera/random/SecureRandomFactory.java"
        ],
        "fixed": true
    }
]