[
    {
        "repo": "commons-collections",
        "commit": "https://github.com/apache/commons-collections/commit/b337febe27fe070081d570d3413a24187e86d4ef",
        "bug_id": "commons-collections_b337feb",
        "message": "[COLLECTIONS-739] Fix inconsistent @throws comments in DefaultedMap (#123)\n\n* COLLECTIONS-739: Fix inconsistent @throws in DefaultedMap.\r\n\r\n* COLLECTIONS-739: Change IllegalArgumentException to NullPointerException in DefaultedMap.defaultedMap, and update Javadoc correspondingly.\r\n\r\n* COLLECTIONS-739: Add tests for factory methods in DefaultedMap.\r\n\r\n* COLLECTIONS-739: Change null checking to use Objects.requireNonNull.",
        "parent": "https://github.com/apache/commons-collections/commit/dc1aca9ed9bb17cffd546f5bd3f93077ce2f8457",
        "patched_files": [
            "DefaultedMap.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 4,
                "raw_url": "https://github.com/apache/commons-collections/raw/b337febe27fe070081d570d3413a24187e86d4ef/src/main/java/org/apache/commons/collections4/map/DefaultedMap.java",
                "contents_url": "https://api.github.com/repos/apache/commons-collections/contents/src/main/java/org/apache/commons/collections4/map/DefaultedMap.java?ref=b337febe27fe070081d570d3413a24187e86d4ef",
                "filename": "src/main/java/org/apache/commons/collections4/map/DefaultedMap.java",
                "deletions": 9,
                "sha": "6fda447e8dc3bce8228c13592fe261c2dcecce08",
                "blob_url": "https://github.com/apache/commons-collections/blob/b337febe27fe070081d570d3413a24187e86d4ef/src/main/java/org/apache/commons/collections4/map/DefaultedMap.java",
                "patch": "@@ -110,10 +110,8 @@\n      * @since 4.0\n      */\n     public static <K, V> DefaultedMap<K, V> defaultedMap(final Map<K, V> map, final Factory<? extends V> factory) {\n-        if (factory == null) {\n-            throw new IllegalArgumentException(\"Factory must not be null\");\n-        }\n-        return new DefaultedMap<>(map, FactoryTransformer.factoryTransformer(factory));\n+        return new DefaultedMap<>(map, FactoryTransformer.factoryTransformer(\n+                Objects.requireNonNull(factory, \"Factory must not be null\")));\n     }\n \n     /**\n@@ -128,15 +126,12 @@\n      * @param map  the map to decorate, must not be null\n      * @param transformer  the transformer to use as a factory to create entries, must not be null\n      * @return a new defaulting map\n-     * @throws NullPointerException if map or factory is null\n+     * @throws NullPointerException if map or transformer is null\n      * @since 4.0\n      */\n     public static <K, V> Map<K, V> defaultedMap(final Map<K, V> map,\n                                                 final Transformer<? super K, ? extends V> transformer) {\n-        if (transformer == null) {\n-           throw new IllegalArgumentException(\"Transformer must not be null\");\n-       }\n-       return new DefaultedMap<>(map, transformer);\n+        return new DefaultedMap<>(map, Objects.requireNonNull(transformer, \"Transformer must not be null\"));\n     }\n \n     //-----------------------------------------------------------------------",
                "changes": 13
            },
            {
                "status": "modified",
                "additions": 41,
                "raw_url": "https://github.com/apache/commons-collections/raw/b337febe27fe070081d570d3413a24187e86d4ef/src/test/java/org/apache/commons/collections4/map/DefaultedMapTest.java",
                "contents_url": "https://api.github.com/repos/apache/commons-collections/contents/src/test/java/org/apache/commons/collections4/map/DefaultedMapTest.java?ref=b337febe27fe070081d570d3413a24187e86d4ef",
                "filename": "src/test/java/org/apache/commons/collections4/map/DefaultedMapTest.java",
                "deletions": 0,
                "sha": "5c0da38d9486dc970f587027bca11e12616f3a4a",
                "blob_url": "https://github.com/apache/commons-collections/blob/b337febe27fe070081d570d3413a24187e86d4ef/src/test/java/org/apache/commons/collections4/map/DefaultedMapTest.java",
                "patch": "@@ -23,6 +23,7 @@\n import org.apache.commons.collections4.FactoryUtils;\n import org.apache.commons.collections4.IterableMap;\n import org.apache.commons.collections4.Transformer;\n+import org.apache.commons.collections4.TransformerUtils;\n import org.apache.commons.collections4.functors.ConstantFactory;\n \n /**\n@@ -34,6 +35,7 @@\n public class DefaultedMapTest<K, V> extends AbstractIterableMapTest<K, V> {\n \n     protected final Factory<V> nullFactory = FactoryUtils.<V>nullFactory();\n+    protected final Transformer<K, V> nullTransformer = TransformerUtils.<K, V>nullTransformer();\n \n     public DefaultedMapTest(final String testName) {\n         super(testName);\n@@ -127,6 +129,45 @@ public void testMapGet4() {\n         assertEquals(\"NULL_OBJECT\", map.get(Integer.valueOf(0)));\n     }\n \n+     public void testFactoryMethods() {\n+         final HashMap<K, V> base = new HashMap<>();\n+\n+         try {\n+             DefaultedMap.defaultedMap(null, (V) \"DEFAULT_VALUE\");\n+             fail(\"Expecting NullPointerException\");\n+         } catch (NullPointerException e) {\n+             // Expected\n+         }\n+    \n+         try {\n+             DefaultedMap.defaultedMap((Map<K, V>) null, nullFactory);\n+             fail(\"Expecting NullPointerException\");\n+         } catch (NullPointerException e) {\n+             // Expected\n+         }\n+\n+         try {\n+             DefaultedMap.defaultedMap(base, (Factory<V>) null);\n+             fail(\"Expecting NullPointerException\");\n+         } catch (NullPointerException e) {\n+             // Expected\n+         }\n+    \n+         try {\n+             DefaultedMap.defaultedMap((Map<K, V>) null, nullTransformer);\n+             fail(\"Expecting NullPointerException\");\n+         } catch (NullPointerException e) {\n+             // Expected\n+         }\n+\n+         try {\n+             DefaultedMap.defaultedMap(base, (Transformer<K, V>) null);\n+             fail(\"Expecting NullPointerException\");\n+         } catch (NullPointerException e) {\n+             // Expected\n+         }\n+     }\n+\n     @Override\n     public String getCompatibilityVersion() {\n         return \"4\";",
                "changes": 41
            }
        ],
        "unit_tests": [
            "DefaultedMapTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/org/apache/commons/collections4/map/DefaultedMapTest.java",
        "buggy_files": [
            "src/main/java/org/apache/commons/collections4/map/DefaultedMap.java"
        ],
        "fixed": true
    }
]