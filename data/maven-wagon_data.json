[
    {
        "repo": "maven-wagon",
        "message": "\"[WAGON-426] Prevent fingerprints loss in known_hosts. Recommit fc34bf340 with proper handling of NPE\"",
        "commit": "https://github.com/apache/maven-wagon/commit/0eed00cf95e2f42167b3680b59347e14d8a842b7",
        "parent": "https://github.com/apache/maven-wagon/commit/8863ded43b40a030bef525f5a42b5adc3a0cb8de",
        "bug_id": "maven-wagon_1",
        "file": [
            {
                "sha": "6b9117a598c5a23bb6c55859e945516ecd3abf48",
                "filename": "wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/AbstractKnownHostsProvider.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/AbstractKnownHostsProvider.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/AbstractKnownHostsProvider.java",
                "status": "modified",
                "changes": 15,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/AbstractKnownHostsProvider.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -34,7 +34,7 @@\n {\n     /**\n      * Valid values are ask, yes, no.\n-     * \n+     *\n      * @plexus.configuration default-value=\"ask\"\n      */\n     private String hostKeyChecking = \"ask\";\n@@ -43,7 +43,7 @@\n      * the known hosts, in the openssh format\n      */\n     protected String contents;\n-    \n+\n     protected Set<KnownHostEntry> knownHosts = new HashSet<KnownHostEntry>();\n \n     public void setHostKeyChecking( String hostKeyChecking )\n@@ -60,11 +60,16 @@ public String getContents()\n     {\n         return contents;\n     }\n-    \n+\n     public void storeKnownHosts( String contents )\n         throws IOException\n     {\n     }\n-    \n-    \n+\n+    public void addKnownHost( KnownHostEntry knownHost )\n+        throws IOException\n+    {\n+    }\n+\n+\n }",
                "deletions": 5
            },
            {
                "sha": "48ab250621f66108f70a6b8fffb06956bb68d999",
                "filename": "wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/FileKnownHostsProvider.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/FileKnownHostsProvider.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/FileKnownHostsProvider.java",
                "status": "modified",
                "changes": 17,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/FileKnownHostsProvider.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -33,7 +33,7 @@\n  *\n  * @author Juan F. Codagnone\n  * @since Sep 12, 2005\n- * \n+ *\n  * @plexus.component role=\"org.apache.maven.wagon.providers.ssh.knownhost.KnownHostsProvider\"\n  *    role-hint=\"file\"\n  *    instantiation-strategy=\"per-lookup\"\n@@ -72,15 +72,26 @@ public void storeKnownHosts( String contents )\n         throws IOException\n     {\n         Set<KnownHostEntry> hosts = this.loadKnownHosts( contents );\n-        \n+\n         if ( ! this.knownHosts.equals( hosts ) )\n         {\n             file.getParentFile().mkdirs();\n             FileUtils.fileWrite( file.getAbsolutePath(), contents );\n             this.knownHosts = hosts;\n         }\n     }\n-    \n+\n+    public void addKnownHost( KnownHostEntry knownHostEntry )\n+        throws IOException\n+    {\n+        if ( !this.knownHosts.contains( knownHostEntry ) )\n+        {\n+            String knownHost = knownHostEntry.getHostName() + \" \" + knownHostEntry.getKeyType() + \" \"\n+                + knownHostEntry.getKeyValue() + \"\\n\";\n+            FileUtils.fileAppend( file.getAbsolutePath(), knownHost );\n+        }\n+    }\n+\n     public File getFile()\n     {\n         return file;",
                "deletions": 3
            },
            {
                "sha": "abaebefdb09c2457f3c6b26d16b9c1fc0507c4ce",
                "filename": "wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/KnownHostsProvider.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/KnownHostsProvider.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/KnownHostsProvider.java",
                "status": "modified",
                "changes": 3,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh-common/src/main/java/org/apache/maven/wagon/providers/ssh/knownhost/KnownHostsProvider.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -34,6 +34,9 @@\n     void storeKnownHosts( String contents )\n         throws IOException;\n \n+    void addKnownHost( KnownHostEntry knownHost )\n+        throws IOException;\n+\n     void setHostKeyChecking( String hostKeyChecking );\n \n     String getHostKeyChecking();",
                "deletions": 0
            },
            {
                "sha": "84288e92ffe8e25f2e7f65dd2763e1efe67aeca6",
                "filename": "wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "status": "modified",
                "changes": 56,
                "additions": 27,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -25,8 +25,6 @@\n import java.io.IOException;\n import java.io.InputStream;\n import java.io.InputStreamReader;\n-import java.io.PrintWriter;\n-import java.io.StringWriter;\n import java.util.List;\n import java.util.Properties;\n \n@@ -48,17 +46,14 @@\n import org.apache.maven.wagon.providers.ssh.interactive.NullInteractiveUserInfo;\n import org.apache.maven.wagon.providers.ssh.jsch.interactive.UserInfoUIKeyboardInteractiveProxy;\n import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostChangedException;\n+import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostEntry;\n import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostsProvider;\n import org.apache.maven.wagon.providers.ssh.knownhost.UnknownHostException;\n import org.apache.maven.wagon.proxy.ProxyInfo;\n import org.apache.maven.wagon.resource.Resource;\n import org.codehaus.plexus.util.IOUtil;\n import org.codehaus.plexus.util.StringInputStream;\n \n-import com.jcraft.jsch.agentproxy.AgentProxyException;\n-import com.jcraft.jsch.agentproxy.Connector;\n-import com.jcraft.jsch.agentproxy.ConnectorFactory;\n-import com.jcraft.jsch.agentproxy.RemoteIdentityRepository;\n import com.jcraft.jsch.ChannelExec;\n import com.jcraft.jsch.HostKey;\n import com.jcraft.jsch.HostKeyRepository;\n@@ -71,6 +66,10 @@\n import com.jcraft.jsch.Session;\n import com.jcraft.jsch.UIKeyboardInteractive;\n import com.jcraft.jsch.UserInfo;\n+import com.jcraft.jsch.agentproxy.AgentProxyException;\n+import com.jcraft.jsch.agentproxy.Connector;\n+import com.jcraft.jsch.agentproxy.ConnectorFactory;\n+import com.jcraft.jsch.agentproxy.RemoteIdentityRepository;\n \n /**\n  * AbstractJschWagon\n@@ -251,24 +250,9 @@ public void openConnectionInternal()\n \n         session.setUserInfo( ui );\n \n-        StringWriter stringWriter = new StringWriter();\n         try\n         {\n             session.connect();\n-\n-            if ( getKnownHostsProvider() != null )\n-            {\n-                PrintWriter w = new PrintWriter( stringWriter );\n-\n-                HostKeyRepository hkr = sch.getHostKeyRepository();\n-                HostKey[] keys = hkr.getHostKey();\n-\n-                for ( int i = 0; keys != null && i < keys.length; i++ )\n-                {\n-                    HostKey key = keys[i];\n-                    w.println( key.getHost() + \" \" + key.getType() + \" \" + key.getKey() );\n-                }\n-            }\n         }\n         catch ( JSchException e )\n         {\n@@ -286,16 +270,30 @@ else if ( e.getMessage().contains( \"HostKey has been changed\" ) )\n             }\n         }\n \n-        try\n-        {\n-            getKnownHostsProvider().storeKnownHosts( stringWriter.toString() );\n-        }\n-        catch ( IOException e )\n+        if ( getKnownHostsProvider() != null )\n         {\n-            closeConnection();\n+            HostKeyRepository hkr = sch.getHostKeyRepository();\n \n-            throw new AuthenticationException(\n-                \"Connection aborted - failed to write to known_hosts. Reason: \" + e.getMessage(), e );\n+            HostKey[] hk = hkr.getHostKey( host, null );\n+            try\n+            {\n+                if ( hk != null )\n+                {\n+                    for ( HostKey hostKey : hk )\n+                    {\n+                        KnownHostEntry knownHostEntry = new KnownHostEntry( hostKey.getHost(), hostKey.getType(),\n+                            hostKey.getKey() );\n+                        getKnownHostsProvider().addKnownHost( knownHostEntry );\n+                    }\n+                }\n+            }\n+            catch ( IOException e )\n+            {\n+                closeConnection();\n+\n+                throw new AuthenticationException(\n+                    \"Connection aborted - failed to write to known_hosts. Reason: \" + e.getMessage(), e );\n+            }\n         }\n     }\n ",
                "deletions": 29
            },
            {
                "sha": "72dc1c0918d80b3bf2fb470196fc84c4894caec0",
                "filename": "wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonTest.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonTest.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonTest.java",
                "status": "modified",
                "changes": 6,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonTest.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -21,6 +21,7 @@\n \n import org.apache.maven.wagon.Wagon;\n import org.apache.maven.wagon.providers.ssh.AbstractEmbeddedScpWagonTest;\n+import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostEntry;\n import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostsProvider;\n \n import java.io.IOException;\n@@ -47,6 +48,11 @@ public void storeKnownHosts( String contents )\n \n             }\n \n+            public void addKnownHost( KnownHostEntry knownHost )\n+                throws IOException\n+            {\n+            }\n+\n             public void setHostKeyChecking( String hostKeyChecking )\n             {\n             }",
                "deletions": 0
            },
            {
                "sha": "47d642db666697defcbea0ce1327f20a0a18e777",
                "filename": "wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonWithKeyTest.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonWithKeyTest.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0eed00cf95e2f42167b3680b59347e14d8a842b7/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonWithKeyTest.java",
                "status": "modified",
                "changes": 6,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/test/java/org/apache/maven/wagon/providers/ssh/jsch/EmbeddedScpWagonWithKeyTest.java?ref=0eed00cf95e2f42167b3680b59347e14d8a842b7",
                "patch": "@@ -22,6 +22,7 @@\n import org.apache.maven.wagon.Wagon;\n import org.apache.maven.wagon.authentication.AuthenticationInfo;\n import org.apache.maven.wagon.providers.ssh.AbstractEmbeddedScpWagonWithKeyTest;\n+import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostEntry;\n import org.apache.maven.wagon.providers.ssh.knownhost.KnownHostsProvider;\n \n import java.io.File;\n@@ -50,6 +51,11 @@ public void storeKnownHosts( String contents )\n \n             }\n \n+            public void addKnownHost( KnownHostEntry knownHost )\n+                    throws IOException\n+            {\n+            }\n+\n             public void setHostKeyChecking( String hostKeyChecking )\n             {\n             }",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-221] removeCheckoutDirectory throws NPE.\nApplied Null check to prevent invalid NPE.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@739606 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/e39c5bf0cb5312f0d589976709f3dfbe76e0d8af",
        "parent": "https://github.com/apache/maven-wagon/commit/a80d74b7a968e9508c18f3b830ee05f9145a1053",
        "bug_id": "maven-wagon_2",
        "file": [
            {
                "sha": "11b08dcd74a5c7fc0357ac162966ec32f6bc9785",
                "filename": "wagon-providers/wagon-scm/src/main/java/org/apache/maven/wagon/providers/scm/ScmWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/e39c5bf0cb5312f0d589976709f3dfbe76e0d8af/wagon-providers/wagon-scm/src/main/java/org/apache/maven/wagon/providers/scm/ScmWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/e39c5bf0cb5312f0d589976709f3dfbe76e0d8af/wagon-providers/wagon-scm/src/main/java/org/apache/maven/wagon/providers/scm/ScmWagon.java",
                "status": "modified",
                "changes": 5,
                "additions": 5,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-scm/src/main/java/org/apache/maven/wagon/providers/scm/ScmWagon.java?ref=e39c5bf0cb5312f0d589976709f3dfbe76e0d8af",
                "patch": "@@ -175,6 +175,11 @@ private File createCheckoutDirectory()\n     private void removeCheckoutDirectory()\n         throws ConnectionException\n     {\n+        if( checkoutDirectory == null )\n+        {\n+            return; // Silently return.\n+        }\n+\n         try\n         {\n             FileUtils.deleteDirectory( checkoutDirectory );",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-285] Repository constructor NPE should be more verbose.\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@1174193 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/b4bf4a0709d8114995a7a11949a8527d3e608a0e",
        "parent": "https://github.com/apache/maven-wagon/commit/beb74c62ca39ae29fc9e03e91285015e9fed4249",
        "bug_id": "maven-wagon_3",
        "file": [
            {
                "sha": "c857297386de4a26c26c667e68c32beca92dbfc6",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/b4bf4a0709d8114995a7a11949a8527d3e608a0e/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/b4bf4a0709d8114995a7a11949a8527d3e608a0e/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "status": "modified",
                "changes": 19,
                "additions": 10,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java?ref=b4bf4a0709d8114995a7a11949a8527d3e608a0e",
                "patch": "@@ -19,13 +19,13 @@\n  * under the License.\n  */\n \n-import java.io.Serializable;\n-import java.util.Properties;\n-\n import org.apache.maven.wagon.PathUtils;\n import org.apache.maven.wagon.WagonConstants;\n import org.codehaus.plexus.util.StringUtils;\n \n+import java.io.Serializable;\n+import java.util.Properties;\n+\n /**\n  * This class is an abstraction of the location from/to resources\n  * can be transfered.\n@@ -34,7 +34,8 @@\n  * @version $Id$\n  * @todo [BP] some things are specific to certain wagons (eg key stuff in authInfo, permissions)\n  */\n-public class Repository implements Serializable\n+public class Repository\n+    implements Serializable\n {\n     private static final long serialVersionUID = 1312227676322136247L;\n \n@@ -77,16 +78,16 @@ public Repository( String id, String url )\n     {\n         if ( id == null )\n         {\n-            throw new NullPointerException( \"id can not be null\" );\n+            throw new NullPointerException( \"id can not be null for Repository with url=\" + url );\n         }\n-        \n+\n         setId( id );\n \n         if ( url == null )\n         {\n-            throw new NullPointerException( \"url can not be null\" );\n+            throw new NullPointerException( \"url can not be null for Repository with id=\" + id );\n         }\n-        \n+\n         setUrl( url );\n     }\n \n@@ -103,7 +104,7 @@ public void setId( String id )\n     /**\n      * Retrieve the base directory of the repository. This is derived from the full repository URL, and\n      * contains the entire path component.\n-     * \n+     *\n      * @return the base directory\n      */\n     public String getBasedir()",
                "deletions": 9
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "return empty array rather than null to avoid NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@1173675 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/0a0a21c58e3bf416af8ab1282cc87a826e890114",
        "parent": "https://github.com/apache/maven-wagon/commit/a0718fef658dc24e904e3c6cac8e60b064029df8",
        "bug_id": "maven-wagon_4",
        "file": [
            {
                "sha": "9bbc433216c0d65676cb1abcb4bbce1e275ecccb",
                "filename": "wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0a0a21c58e3bf416af8ab1282cc87a826e890114/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0a0a21c58e3bf416af8ab1282cc87a826e890114/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "status": "modified",
                "changes": 83,
                "additions": 42,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-http-shared/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java?ref=0a0a21c58e3bf416af8ab1282cc87a826e890114",
                "patch": "@@ -33,17 +33,17 @@\n \n public class HttpMethodConfiguration\n {\n-    \n+\n     public static final int DEFAULT_CONNECTION_TIMEOUT = 60000;\n \n     private static final String COERCE_PATTERN = \"%(\\\\w+),(.+)\";\n-    \n+\n     private Boolean useDefaultHeaders;\n-    \n+\n     private Properties headers = new Properties();\n-    \n+\n     private Properties params = new Properties();\n-    \n+\n     private int connectionTimeout = DEFAULT_CONNECTION_TIMEOUT;\n \n     public boolean isUseDefaultHeaders()\n@@ -56,12 +56,12 @@ public HttpMethodConfiguration setUseDefaultHeaders( boolean useDefaultHeaders )\n         this.useDefaultHeaders = Boolean.valueOf( useDefaultHeaders );\n         return this;\n     }\n-    \n+\n     public Boolean getUseDefaultHeaders()\n     {\n         return useDefaultHeaders;\n     }\n-    \n+\n     public HttpMethodConfiguration addHeader( String header, String value )\n     {\n         headers.setProperty( header, value );\n@@ -78,7 +78,7 @@ public HttpMethodConfiguration setHeaders( Properties headers )\n         this.headers = headers;\n         return this;\n     }\n-    \n+\n     public HttpMethodConfiguration addParam( String param, String value )\n     {\n         params.setProperty( param, value );\n@@ -113,12 +113,12 @@ public HttpMethodParams asMethodParams( HttpMethodParams defaults )\n         {\n             return null;\n         }\n-        \n+\n         HttpMethodParams p = new HttpMethodParams();\n         p.setDefaults( defaults );\n-        \n+\n         fillParams( p );\n-        \n+\n         return p;\n     }\n \n@@ -128,7 +128,7 @@ private boolean hasParams()\n         {\n             return false;\n         }\n-        \n+\n         return true;\n     }\n \n@@ -138,30 +138,30 @@ private void fillParams( HttpMethodParams p )\n         {\n             return;\n         }\n-        \n+\n         if ( connectionTimeout > 0 )\n         {\n             p.setSoTimeout( connectionTimeout );\n         }\n-        \n+\n         if ( params != null )\n         {\n             Pattern coercePattern = Pattern.compile( COERCE_PATTERN );\n-            \n+\n             for ( Iterator it = params.entrySet().iterator(); it.hasNext(); )\n             {\n                 Map.Entry entry = (Map.Entry) it.next();\n-                \n+\n                 String key = (String) entry.getKey();\n                 String value = (String) entry.getValue();\n-                \n+\n                 Matcher matcher = coercePattern.matcher( value );\n                 if ( matcher.matches() )\n                 {\n                     char type = matcher.group( 1 ).charAt( 0 );\n                     value = matcher.group( 2 );\n-                    \n-                    switch( type )\n+\n+                    switch ( type )\n                     {\n                         case 'i':\n                         {\n@@ -191,14 +191,14 @@ private void fillParams( HttpMethodParams p )\n                             {\n                                 collection.add( entries[i].trim() );\n                             }\n-                            \n+\n                             p.setParameter( key, collection );\n                             break;\n                         }\n                         case 'm':\n                         {\n                             String[] entries = value.split( \",\" );\n-                            \n+\n                             Map map = new LinkedHashMap();\n                             for ( int i = 0; i < entries.length; i++ )\n                             {\n@@ -207,12 +207,12 @@ private void fillParams( HttpMethodParams p )\n                                 {\n                                     break;\n                                 }\n-                                \n+\n                                 String mapKey = entries[i].substring( 0, idx );\n                                 String mapVal = entries[i].substring( idx + 1, entries[i].length() );\n                                 map.put( mapKey.trim(), mapVal.trim() );\n                             }\n-                            \n+\n                             p.setParameter( key, map );\n                             break;\n                         }\n@@ -230,52 +230,53 @@ private void fillParams( HttpMethodParams p )\n     {\n         if ( headers == null )\n         {\n-            return null;\n+            return new Header[0];\n         }\n-        \n+\n         Header[] result = new Header[headers.size()];\n-        \n+\n         int index = 0;\n         for ( Iterator it = headers.entrySet().iterator(); it.hasNext(); )\n         {\n             Map.Entry entry = (Map.Entry) it.next();\n-            \n+\n             String key = (String) entry.getKey();\n             String value = (String) entry.getValue();\n-            \n+\n             Header header = new Header( key, value );\n             result[index++] = header;\n         }\n-        \n+\n         return result;\n     }\n-    \n+\n     private HttpMethodConfiguration copy()\n     {\n         HttpMethodConfiguration copy = new HttpMethodConfiguration();\n-        \n+\n         copy.setConnectionTimeout( getConnectionTimeout() );\n         if ( getHeaders() != null )\n         {\n             copy.setHeaders( getHeaders() );\n         }\n-        \n+\n         if ( getParams() != null )\n         {\n             copy.setParams( getParams() );\n         }\n \n         copy.setUseDefaultHeaders( isUseDefaultHeaders() );\n-        \n+\n         return copy;\n     }\n \n-    public static HttpMethodConfiguration merge( HttpMethodConfiguration defaults, HttpMethodConfiguration base, HttpMethodConfiguration local )\n+    public static HttpMethodConfiguration merge( HttpMethodConfiguration defaults, HttpMethodConfiguration base,\n+                                                 HttpMethodConfiguration local )\n     {\n         HttpMethodConfiguration result = merge( defaults, base );\n         return merge( result, local );\n     }\n-    \n+\n     public static HttpMethodConfiguration merge( HttpMethodConfiguration base, HttpMethodConfiguration local )\n     {\n         if ( base == null && local == null )\n@@ -293,29 +294,29 @@ else if ( local == null )\n         else\n         {\n             HttpMethodConfiguration result = base.copy();\n-            \n+\n             if ( local.getConnectionTimeout() != DEFAULT_CONNECTION_TIMEOUT )\n             {\n                 result.setConnectionTimeout( local.getConnectionTimeout() );\n             }\n-            \n+\n             if ( local.getHeaders() != null )\n             {\n                 result.getHeaders().putAll( local.getHeaders() );\n             }\n-            \n+\n             if ( local.getParams() != null )\n             {\n                 result.getParams().putAll( local.getParams() );\n             }\n-            \n+\n             if ( local.getUseDefaultHeaders() != null )\n             {\n                 result.setUseDefaultHeaders( local.isUseDefaultHeaders() );\n             }\n-            \n+\n             return result;\n         }\n     }\n-    \n+\n }",
                "deletions": 41
            },
            {
                "sha": "b51f5d8b1e07164cc69d8c12b4cebfe395388156",
                "filename": "wagon-providers/wagon-http-shared4/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/0a0a21c58e3bf416af8ab1282cc87a826e890114/wagon-providers/wagon-http-shared4/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/0a0a21c58e3bf416af8ab1282cc87a826e890114/wagon-providers/wagon-http-shared4/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java",
                "status": "modified",
                "changes": 81,
                "additions": 41,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-http-shared4/src/main/java/org/apache/maven/wagon/shared/http/HttpMethodConfiguration.java?ref=0a0a21c58e3bf416af8ab1282cc87a826e890114",
                "patch": "@@ -37,17 +37,17 @@\n \n public class HttpMethodConfiguration\n {\n-    \n+\n     public static final int DEFAULT_CONNECTION_TIMEOUT = 60000;\n \n     private static final String COERCE_PATTERN = \"%(\\\\w+),(.+)\";\n-    \n+\n     private Boolean useDefaultHeaders;\n-    \n+\n     private Properties headers = new Properties();\n-    \n+\n     private Properties params = new Properties();\n-    \n+\n     private int connectionTimeout = DEFAULT_CONNECTION_TIMEOUT;\n \n     public boolean isUseDefaultHeaders()\n@@ -60,12 +60,12 @@ public HttpMethodConfiguration setUseDefaultHeaders( boolean useDefaultHeaders )\n         this.useDefaultHeaders = Boolean.valueOf( useDefaultHeaders );\n         return this;\n     }\n-    \n+\n     public Boolean getUseDefaultHeaders()\n     {\n         return useDefaultHeaders;\n     }\n-    \n+\n     public HttpMethodConfiguration addHeader( String header, String value )\n     {\n         headers.setProperty( header, value );\n@@ -82,7 +82,7 @@ public HttpMethodConfiguration setHeaders( Properties headers )\n         this.headers = headers;\n         return this;\n     }\n-    \n+\n     public HttpMethodConfiguration addParam( String param, String value )\n     {\n         params.setProperty( param, value );\n@@ -117,11 +117,11 @@ public HttpParams asMethodParams( HttpParams defaults )\n         {\n             return null;\n         }\n-        \n+\n         DefaultedHttpParams p = new DefaultedHttpParams( new BasicHttpParams(), defaults );\n \n         fillParams( p );\n-        \n+\n         return p;\n     }\n \n@@ -131,7 +131,7 @@ private boolean hasParams()\n         {\n             return false;\n         }\n-        \n+\n         return true;\n     }\n \n@@ -141,30 +141,30 @@ private void fillParams( HttpParams p )\n         {\n             return;\n         }\n-        \n+\n         if ( connectionTimeout > 0 )\n         {\n             p.setParameter( CoreConnectionPNames.SO_TIMEOUT, connectionTimeout );\n         }\n-        \n+\n         if ( params != null )\n         {\n             Pattern coercePattern = Pattern.compile( COERCE_PATTERN );\n-            \n+\n             for ( Iterator<?> it = params.entrySet().iterator(); it.hasNext(); )\n             {\n                 Map.Entry<String, String> entry = (Map.Entry) it.next();\n-                \n+\n                 String key = entry.getKey();\n                 String value = entry.getValue();\n-                \n+\n                 Matcher matcher = coercePattern.matcher( value );\n                 if ( matcher.matches() )\n                 {\n                     char type = matcher.group( 1 ).charAt( 0 );\n                     value = matcher.group( 2 );\n-                    \n-                    switch( type )\n+\n+                    switch ( type )\n                     {\n                         case 'i':\n                         {\n@@ -194,14 +194,14 @@ private void fillParams( HttpParams p )\n                             {\n                                 collection.add( entries[i].trim() );\n                             }\n-                            \n+\n                             p.setParameter( key, collection );\n                             break;\n                         }\n                         case 'm':\n                         {\n                             String[] entries = value.split( \",\" );\n-                            \n+\n                             Map<String, String> map = new LinkedHashMap<String, String>();\n                             for ( int i = 0; i < entries.length; i++ )\n                             {\n@@ -210,12 +210,12 @@ private void fillParams( HttpParams p )\n                                 {\n                                     break;\n                                 }\n-                                \n+\n                                 String mapKey = entries[i].substring( 0, idx );\n                                 String mapVal = entries[i].substring( idx + 1, entries[i].length() );\n                                 map.put( mapKey.trim(), mapVal.trim() );\n                             }\n-                            \n+\n                             p.setParameter( key, map );\n                             break;\n                         }\n@@ -233,52 +233,53 @@ private void fillParams( HttpParams p )\n     {\n         if ( headers == null )\n         {\n-            return null;\n+            return new Header[0];\n         }\n-        \n+\n         Header[] result = new Header[headers.size()];\n-        \n+\n         int index = 0;\n         for ( Iterator<?> it = headers.entrySet().iterator(); it.hasNext(); )\n         {\n             Map.Entry<String, String> entry = (Map.Entry) it.next();\n-            \n+\n             String key = (String) entry.getKey();\n             String value = (String) entry.getValue();\n-            \n+\n             Header header = new BasicHeader( key, value );\n             result[index++] = header;\n         }\n-        \n+\n         return result;\n     }\n-    \n+\n     private HttpMethodConfiguration copy()\n     {\n         HttpMethodConfiguration copy = new HttpMethodConfiguration();\n-        \n+\n         copy.setConnectionTimeout( getConnectionTimeout() );\n         if ( getHeaders() != null )\n         {\n             copy.setHeaders( getHeaders() );\n         }\n-        \n+\n         if ( getParams() != null )\n         {\n             copy.setParams( getParams() );\n         }\n \n         copy.setUseDefaultHeaders( isUseDefaultHeaders() );\n-        \n+\n         return copy;\n     }\n \n-    public static HttpMethodConfiguration merge( HttpMethodConfiguration defaults, HttpMethodConfiguration base, HttpMethodConfiguration local )\n+    public static HttpMethodConfiguration merge( HttpMethodConfiguration defaults, HttpMethodConfiguration base,\n+                                                 HttpMethodConfiguration local )\n     {\n         HttpMethodConfiguration result = merge( defaults, base );\n         return merge( result, local );\n     }\n-    \n+\n     public static HttpMethodConfiguration merge( HttpMethodConfiguration base, HttpMethodConfiguration local )\n     {\n         if ( base == null && local == null )\n@@ -296,29 +297,29 @@ else if ( local == null )\n         else\n         {\n             HttpMethodConfiguration result = base.copy();\n-            \n+\n             if ( local.getConnectionTimeout() != DEFAULT_CONNECTION_TIMEOUT )\n             {\n                 result.setConnectionTimeout( local.getConnectionTimeout() );\n             }\n-            \n+\n             if ( local.getHeaders() != null )\n             {\n                 result.getHeaders().putAll( local.getHeaders() );\n             }\n-            \n+\n             if ( local.getParams() != null )\n             {\n                 result.getParams().putAll( local.getParams() );\n             }\n-            \n+\n             if ( local.getUseDefaultHeaders() != null )\n             {\n                 result.setUseDefaultHeaders( local.isUseDefaultHeaders() );\n             }\n-            \n+\n             return result;\n         }\n     }\n-    \n+\n }",
                "deletions": 40
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-242] guard against NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@745732 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/9abfc571577545d6f08594f0e5d4debc3d3b438c",
        "parent": "https://github.com/apache/maven-wagon/commit/d588a17a4d48e90380ae69238225ac072f9a4fcc",
        "bug_id": "maven-wagon_5",
        "file": [
            {
                "sha": "a1d05df0e5a547e93186bfe47189957a87eaaec6",
                "filename": "wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/9abfc571577545d6f08594f0e5d4debc3d3b438c/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/9abfc571577545d6f08594f0e5d4debc3d3b438c/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "status": "modified",
                "changes": 4,
                "additions": 3,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java?ref=9abfc571577545d6f08594f0e5d4debc3d3b438c",
                "patch": "@@ -25,6 +25,7 @@\n import java.io.InputStream;\n import java.io.OutputStream;\n import java.util.ArrayList;\n+import java.util.Calendar;\n import java.util.List;\n \n import org.apache.commons.net.ProtocolCommandEvent;\n@@ -353,7 +354,8 @@ public void fillInputData( InputData inputData )\n             //@todo check how it works! javadoc of common login says:\n             // Returns the file timestamp. This usually the last modification time.\n             //\n-            long lastModified = ftpFiles[0].getTimestamp().getTimeInMillis();\n+            Calendar timestamp = ftpFiles[0].getTimestamp();\n+            long lastModified = timestamp != null ? timestamp.getTimeInMillis() : 0;\n \n             resource.setContentLength( contentLength );\n ",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-225] guard against NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@680112 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/2b8ada1f225a31fc70647369e784965ca53b91be",
        "parent": "https://github.com/apache/maven-wagon/commit/891847b43a13fbf44a1cc3206e77cd4f080ee97c",
        "bug_id": "maven-wagon_6",
        "file": [
            {
                "sha": "a32dfb413f68845bc8f6738a5229b926e580a64f",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/2b8ada1f225a31fc70647369e784965ca53b91be/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/2b8ada1f225a31fc70647369e784965ca53b91be/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java?ref=2b8ada1f225a31fc70647369e784965ca53b91be",
                "patch": "@@ -150,7 +150,7 @@ public void connect( Repository repository, AuthenticationInfo authenticationInf\n         {\n             public ProxyInfo getProxyInfo( String protocol )\n             {\n-                if ( protocol == null || protocol.equalsIgnoreCase( proxy.getType() ) )\n+                if ( protocol == null || proxy == null || protocol.equalsIgnoreCase( proxy.getType() ) )\n                 {\n                     return proxy;\n                 }",
                "deletions": 1
            },
            {
                "sha": "fe576fb56f496e1f64f95f1278e10ffdb35c5a37",
                "filename": "wagon-provider-api/src/test/java/org/apache/maven/wagon/AbstractWagonTest.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/2b8ada1f225a31fc70647369e784965ca53b91be/wagon-provider-api/src/test/java/org/apache/maven/wagon/AbstractWagonTest.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/2b8ada1f225a31fc70647369e784965ca53b91be/wagon-provider-api/src/test/java/org/apache/maven/wagon/AbstractWagonTest.java",
                "status": "modified",
                "changes": 12,
                "additions": 12,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/test/java/org/apache/maven/wagon/AbstractWagonTest.java?ref=2b8ada1f225a31fc70647369e784965ca53b91be",
                "patch": "@@ -115,6 +115,18 @@ public void testNoProxyConfiguration() throws ConnectionException, Authenticatio\n         assertNull( wagon.getProxyInfo( \"http\", \"localhost\" ) );\n     }\n \n+    public void testNullProxyConfiguration() throws ConnectionException, AuthenticationException\n+    {\n+        Repository repository = new Repository();\n+        wagon.connect( repository, (ProxyInfo) null );\n+        assertNull( wagon.getProxyInfo() );\n+        assertNull( wagon.getProxyInfo( \"http\", \"www.example.com\" ) );\n+        assertNull( wagon.getProxyInfo( \"dav\", \"www.example.com\" ) );\n+        assertNull( wagon.getProxyInfo( \"scp\", \"www.example.com\" ) );\n+        assertNull( wagon.getProxyInfo( \"ftp\", \"www.example.com\" ) );\n+        assertNull( wagon.getProxyInfo( \"http\", \"localhost\" ) );\n+    }\n+\n     public void testLegacyProxyConfiguration() throws ConnectionException, AuthenticationException\n     {\n         ProxyInfo proxyInfo = new ProxyInfo();",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-222] Empty file transfer causes NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@668181 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/215bc4dadb74a5cc50431ab706c661a495c756a9",
        "parent": "https://github.com/apache/maven-wagon/commit/a86c3d3bb63b1b7057a19ddf646f1713951a3897",
        "bug_id": "maven-wagon_7",
        "file": [
            {
                "sha": "637ec25b7d134cdebf08460073c6dd66a42f660e",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/LazyFileOutputStream.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/215bc4dadb74a5cc50431ab706c661a495c756a9/wagon-provider-api/src/main/java/org/apache/maven/wagon/LazyFileOutputStream.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/215bc4dadb74a5cc50431ab706c661a495c756a9/wagon-provider-api/src/main/java/org/apache/maven/wagon/LazyFileOutputStream.java",
                "status": "modified",
                "changes": 5,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/LazyFileOutputStream.java?ref=215bc4dadb74a5cc50431ab706c661a495c756a9",
                "patch": "@@ -74,7 +74,10 @@ public boolean equals( Object obj )\n     public void flush()\n         throws IOException\n     {\n-        delegee.flush();\n+        if ( delegee != null )\n+        {\n+            delegee.flush();\n+        }\n     }\n \n ",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-105] guard against NPE in hashCode\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@656236 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/16ae4b593c1a250a88f1b745b9e2dc11e7c8a259",
        "parent": "https://github.com/apache/maven-wagon/commit/3c0de3800cfa30edaa343389ed05835425bcd4ff",
        "bug_id": "maven-wagon_8",
        "file": [
            {
                "sha": "5f35c3e7144f46ca911719258b32fe1fab049048",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/16ae4b593c1a250a88f1b745b9e2dc11e7c8a259/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/16ae4b593c1a250a88f1b745b9e2dc11e7c8a259/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java",
                "status": "modified",
                "changes": 43,
                "additions": 34,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/repository/Repository.java?ref=16ae4b593c1a250a88f1b745b9e2dc11e7c8a259",
                "patch": "@@ -66,15 +66,28 @@\n \n     private String password = null;\n \n+    /**\n+     * @deprecated use {@link #Repository(String, String)}\n+     */\n     public Repository()\n     {\n \n     }\n \n     public Repository( String id, String url )\n     {\n+        if ( id == null )\n+        {\n+            throw new NullPointerException( \"id can not be null\" );\n+        }\n+        \n         setId( id );\n \n+        if ( url == null )\n+        {\n+            throw new NullPointerException( \"url can not be null\" );\n+        }\n+        \n         setUrl( url );\n     }\n \n@@ -88,7 +101,6 @@ public void setId( String id )\n         this.id = id;\n     }\n \n-\n     public String getBasedir()\n     {\n         return basedir;\n@@ -238,18 +250,31 @@ public void setParameters( Properties parameters )\n         this.parameters = parameters;\n     }\n \n-    // ========================================================================\n-    // id is the unique identifier for Repositories, so let's enforce that.\n-    // ========================================================================\n-    public boolean equals( Object other )\n+    public int hashCode()\n     {\n-        return ( other == this ||\n-            ( ( other instanceof Repository ) && ( (Repository) other ).getId().equals( getId() ) ) );\n+        final int prime = 31;\n+        int result = 1;\n+        result = prime * result + ( ( id == null ) ? 0 : id.hashCode() );\n+        return result;\n     }\n \n-    public int hashCode()\n+    public boolean equals( Object obj )\n     {\n-        return getId().hashCode();\n+        if ( this == obj )\n+            return true;\n+        if ( obj == null )\n+            return false;\n+        if ( getClass() != obj.getClass() )\n+            return false;\n+        final Repository other = (Repository) obj;\n+        if ( id == null )\n+        {\n+            if ( other.id != null )\n+                return false;\n+        }\n+        else if ( !id.equals( other.id ) )\n+            return false;\n+        return true;\n     }\n \n     public String getUsername()",
                "deletions": 9
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "Addressing NPE on OSX\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@485713 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/aae08e124964492ff178a3fa8f0e2c21312644be",
        "parent": "https://github.com/apache/maven-wagon/commit/711cb1f47a539ace24ba70ea88828de3e422beb0",
        "bug_id": "maven-wagon_9",
        "file": [
            {
                "sha": "dad885e027758edae617f647ae818c488a15301e",
                "filename": "wagon-providers/wagon-file/src/main/java/org/apache/maven/wagon/providers/file/FileWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/aae08e124964492ff178a3fa8f0e2c21312644be/wagon-providers/wagon-file/src/main/java/org/apache/maven/wagon/providers/file/FileWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/aae08e124964492ff178a3fa8f0e2c21312644be/wagon-providers/wagon-file/src/main/java/org/apache/maven/wagon/providers/file/FileWagon.java",
                "status": "modified",
                "changes": 3,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-file/src/main/java/org/apache/maven/wagon/providers/file/FileWagon.java?ref=aae08e124964492ff178a3fa8f0e2c21312644be",
                "patch": "@@ -135,7 +135,8 @@ public void closeConnection()\n \n     public boolean supportsDirectoryCopy()\n     {\n-        return ( getRepository().getBasedir() != null );\n+        // TODO: should we test for null basedir here?\n+        return true;\n     }\n \n     public void putDirectory( File sourceDirectory, String destinationDirectory )",
                "deletions": 1
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-465] add options ignore stderr and/or none 0 exit code\n\n* Introduce a new wagon-ssh execute interface the handle the options\n\n* No new behavior changes for current interface\n\n* dump stdout/sterr exec outputs  to session listen\n\n* Fix a couple of NPE when session listener is enable",
        "commit": "https://github.com/apache/maven-wagon/commit/246c6daf1ca3fba385f71c89fdf798d2b519ced6",
        "parent": "https://github.com/apache/maven-wagon/commit/87338f924f1e4c1194ee8c6afa6a97c85b344463",
        "bug_id": "maven-wagon_10",
        "file": [
            {
                "sha": "949726049ef1816e478f4a88472c57ce4fa25207",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/246c6daf1ca3fba385f71c89fdf798d2b519ced6/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/246c6daf1ca3fba385f71c89fdf798d2b519ced6/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java",
                "status": "modified",
                "changes": 7,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/AbstractWagon.java?ref=246c6daf1ca3fba385f71c89fdf798d2b519ced6",
                "patch": "@@ -371,13 +371,14 @@ protected void getTransfer( Resource resource, OutputStream output, InputStream\n         {\n             transfer( resource, input, output, TransferEvent.REQUEST_GET, maxSize );\n \n+            finishGetTransfer( resource, input, output );\n+\n             if ( closeInput )\n             {\n                 input.close();\n                 input = null;\n             }\n \n-            finishGetTransfer( resource, input, output );\n         }\n         catch ( IOException e )\n         {\n@@ -471,13 +472,13 @@ protected void putTransfer( Resource resource, InputStream input, OutputStream o\n                           ? Long.MAX_VALUE\n                           : resource.getContentLength() );\n \n+            finishPutTransfer( resource, input, output );\n+\n             if ( closeOutput )\n             {\n                 output.close();\n                 output = null;\n             }\n-\n-            finishPutTransfer( resource, input, output );\n         }\n         catch ( IOException e )\n         {",
                "deletions": 3
            },
            {
                "sha": "8695235941d62163da65ee45d3ec4fb230723e2f",
                "filename": "wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/246c6daf1ca3fba385f71c89fdf798d2b519ced6/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/246c6daf1ca3fba385f71c89fdf798d2b519ced6/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "status": "modified",
                "changes": 31,
                "additions": 27,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java?ref=246c6daf1ca3fba385f71c89fdf798d2b519ced6",
                "patch": "@@ -305,34 +305,42 @@ public void closeConnection()\n         }\n     }\n \n-    public Streams executeCommand( String command, boolean ignoreFailures )\n+    public Streams executeCommand( String command, boolean ignoreStdErr, boolean ignoreNoneZeroExitCode )\n         throws CommandExecutionException\n     {\n         ChannelExec channel = null;\n         BufferedReader stdoutReader = null;\n         BufferedReader stderrReader = null;\n+        Streams streams = null;\n         try\n         {\n             channel = (ChannelExec) session.openChannel( EXEC_CHANNEL );\n \n+            fireSessionDebug( \"Executing: \" + command );\n             channel.setCommand( command + \"\\n\" );\n \n             stdoutReader = new BufferedReader( new InputStreamReader( channel.getInputStream() ) );\n             stderrReader = new BufferedReader( new InputStreamReader( channel.getErrStream() ) );\n \n             channel.connect();\n \n-            Streams streams = CommandExecutorStreamProcessor.processStreams( stderrReader, stdoutReader );\n+            streams = CommandExecutorStreamProcessor.processStreams( stderrReader, stdoutReader );\n \n             stdoutReader.close();\n             stdoutReader = null;\n \n             stderrReader.close();\n             stderrReader = null;\n \n-            if ( streams.getErr().length() > 0 && !ignoreFailures )\n+            int exitCode = channel.getExitStatus();\n+\n+            if ( streams.getErr().length() > 0 && !ignoreStdErr )\n+            {\n+                throw new CommandExecutionException( \"Exit code: \" + exitCode + \" - \" + streams.getErr() );\n+            }\n+\n+            if ( exitCode != 0 && !ignoreNoneZeroExitCode )\n             {\n-                int exitCode = channel.getExitStatus();\n                 throw new CommandExecutionException( \"Exit code: \" + exitCode + \" - \" + streams.getErr() );\n             }\n \n@@ -348,6 +356,12 @@ public Streams executeCommand( String command, boolean ignoreFailures )\n         }\n         finally\n         {\n+            if ( streams != null )\n+            {\n+                fireSessionDebug( \"Stdout results:\" + streams.getOut() );\n+                fireSessionDebug( \"Stderr results:\" + streams.getErr() );\n+            }\n+\n             IOUtil.close( stdoutReader );\n             IOUtil.close( stderrReader );\n             if ( channel != null )\n@@ -400,6 +414,15 @@ public void executeCommand( String command )\n         executeCommand( command, false );\n     }\n \n+    public Streams executeCommand( String command, boolean ignoreFailures )\n+            throws CommandExecutionException\n+    {\n+        fireTransferDebug( \"Executing command: \" + command );\n+\n+        //backward compatible with wagon 2.10\n+        return executeCommand( command, ignoreFailures, ignoreFailures );\n+    }\n+\n     public InteractiveUserInfo getInteractiveUserInfo()\n     {\n         return this.interactiveUserInfo;",
                "deletions": 4
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "[WAGON-224] do not throw a NPE on subsequent transfers if a previous transfer failed in error\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@680225 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
        "parent": "https://github.com/apache/maven-wagon/commit/2b8ada1f225a31fc70647369e784965ca53b91be",
        "bug_id": "maven-wagon_11",
        "file": [
            {
                "sha": "40231868b6f18d9747442034e2ea35b823710db6",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "status": "modified",
                "changes": 3,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java?ref=216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
                "patch": "@@ -83,7 +83,8 @@ public void transferCompleted( TransferEvent transferEvent )\n \n     public void transferError( TransferEvent transferEvent )\n     {\n-        digester = null;\n+        digester.reset();\n+        \n         actualChecksum = null;\n     }\n ",
                "deletions": 1
            },
            {
                "sha": "5ba5f2f6f1270a43c4e82db35b872b00af73fea8",
                "filename": "wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "status": "added",
                "changes": 92,
                "additions": 92,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java?ref=216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
                "patch": "@@ -0,0 +1,92 @@\n+package org.apache.maven.wagon.observers;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.security.NoSuchAlgorithmException;\n+\n+import junit.framework.TestCase;\n+\n+import org.apache.maven.wagon.ConnectionException;\n+import org.apache.maven.wagon.ResourceDoesNotExistException;\n+import org.apache.maven.wagon.TransferFailedException;\n+import org.apache.maven.wagon.Wagon;\n+import org.apache.maven.wagon.WagonMock;\n+import org.apache.maven.wagon.authorization.AuthorizationException;\n+import org.apache.maven.wagon.events.TransferListener;\n+import org.apache.maven.wagon.repository.Repository;\n+\n+public class ChecksumObserverTest\n+    extends TestCase\n+{\n+    private Wagon wagon;\n+\n+    public void setUp()\n+        throws Exception\n+    {\n+        super.setUp();\n+\n+        wagon = new WagonMock( true );\n+\n+        Repository repository = new Repository();\n+        wagon.connect( repository );        \n+    }\n+    \n+    public void tearDown()\n+        throws ConnectionException\n+    {\n+        wagon.disconnect();\n+    }\n+\n+    public void testSubsequentTransfersAfterTransferError()\n+        throws NoSuchAlgorithmException, ResourceDoesNotExistException,\n+        AuthorizationException, IOException\n+    {\n+        TransferListener listener = new ChecksumObserver();\n+\n+        wagon.addTransferListener( listener );\n+\n+        File testFile = File.createTempFile( \"wagon\", \"tmp\" );\n+        testFile.deleteOnExit();\n+        \n+        try\n+        {\n+            wagon.get( \"resource\", testFile );\n+            fail();\n+        }\n+        catch ( TransferFailedException e )\n+        {\n+            assertTrue( true );\n+        }\n+\n+        try\n+        {\n+            wagon.get( \"resource\", testFile );\n+            fail();\n+        }\n+        catch ( TransferFailedException e )\n+        {\n+            assertTrue( true );\n+        }\n+        \n+        testFile.delete();\n+    }\n+}",
                "deletions": 0
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "Fix NPE found in AbstractJschWagon (WAGON-91) and handle ignoreFailures flag for both Jsch and Ganymed wagon providers (WAGON-94).\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@607799 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0",
        "parent": "https://github.com/apache/maven-wagon/commit/9278a4b0d2307b6012011cd8bdedf0cf2d3f2de3",
        "bug_id": "maven-wagon_12",
        "file": [
            {
                "sha": "9336c170129687c03b9c7556607fffb806e60954",
                "filename": "wagon-provider-test/src/main/java/org/apache/maven/wagon/CommandExecutorTestCase.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-provider-test/src/main/java/org/apache/maven/wagon/CommandExecutorTestCase.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-provider-test/src/main/java/org/apache/maven/wagon/CommandExecutorTestCase.java",
                "status": "modified",
                "changes": 52,
                "additions": 36,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-test/src/main/java/org/apache/maven/wagon/CommandExecutorTestCase.java?ref=1137af0a0bb1c7d508433b58c0e8c623bb07ceb0",
                "patch": "@@ -1,22 +1,18 @@\n package org.apache.maven.wagon;\n \n /*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n+ * Licensed to the Apache Software Foundation (ASF) under one or more contributor license\n+ * agreements. See the NOTICE file distributed with this work for additional information regarding\n+ * copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance with the License. You may obtain a\n+ * copy of the License at\n+ * \n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ * \n+ * Unless required by applicable law or agreed to in writing, software distributed under the License\n+ * is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express\n+ * or implied. See the License for the specific language governing permissions and limitations under\n+ * the License.\n  */\n \n import org.codehaus.plexus.PlexusTestCase;\n@@ -59,6 +55,30 @@ public void testErrorInCommandExecuted()\n         }\n     }\n \n+    public void testIgnoreFailuresInCommandExecuted()\n+        throws Exception\n+    {\n+        CommandExecutor exec = (CommandExecutor) lookup( CommandExecutor.ROLE );\n+\n+        Repository repository = getTestRepository();\n+\n+        AuthenticationInfo authenticationInfo = new AuthenticationInfo();\n+        authenticationInfo.setUserName( System.getProperty( \"user.name\" ) );\n+\n+        exec.connect( repository, authenticationInfo );\n+\n+        try\n+        {\n+            Streams streams = exec.executeCommand( \"fail\", true );\n+            //expect no exception, and stderr has something.\n+            assertTrue( streams.getErr().length() > 0 );\n+        }\n+        finally\n+        {\n+            exec.disconnect();\n+        }\n+    }\n+\n     public void testExecuteSuccessfulCommand()\n         throws Exception\n     {",
                "deletions": 16
            },
            {
                "sha": "a1c91100ab8e16c4517c315a7275f9b0904c6e8e",
                "filename": "wagon-providers/wagon-ssh-ganymed/src/main/java/org/apache/maven/wagon/providers/ssh/ganymed/AbstractGanymedWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-providers/wagon-ssh-ganymed/src/main/java/org/apache/maven/wagon/providers/ssh/ganymed/AbstractGanymedWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-providers/wagon-ssh-ganymed/src/main/java/org/apache/maven/wagon/providers/ssh/ganymed/AbstractGanymedWagon.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh-ganymed/src/main/java/org/apache/maven/wagon/providers/ssh/ganymed/AbstractGanymedWagon.java?ref=1137af0a0bb1c7d508433b58c0e8c623bb07ceb0",
                "patch": "@@ -186,7 +186,7 @@ public Streams executeCommand( String command, boolean ignoreFailures )\n         {\n             Streams streams = CommandExecutorStreamProcessor.processStreams( stderrReader, stdoutReader );\n \n-            if ( streams.getErr().length() > 0 )\n+            if ( streams.getErr().length() > 0 && !ignoreFailures )\n             {\n                 int exitCode = session.getExitStatus().intValue();\n                 throw new CommandExecutionException( \"Exit code: \" + exitCode + \" - \" + streams.getErr() );",
                "deletions": 1
            },
            {
                "sha": "bfc8ef5c504e69ab808ee1867728562d6f93ad7e",
                "filename": "wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/1137af0a0bb1c7d508433b58c0e8c623bb07ceb0/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java",
                "status": "modified",
                "changes": 4,
                "additions": 2,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/jsch/AbstractJschWagon.java?ref=1137af0a0bb1c7d508433b58c0e8c623bb07ceb0",
                "patch": "@@ -192,7 +192,7 @@ public void openConnection()\n                 HostKeyRepository hkr = sch.getHostKeyRepository();\n                 HostKey[] keys = hkr.getHostKey();\n \n-                for ( int i = 0; i < keys.length; i++ )\n+                for ( int i = 0; keys != null && i < keys.length; i++ )\n                 {\n                     HostKey key = keys[i];\n                     w.println( key.getHost() + \" \" + key.getType() + \" \" + key.getKey() );\n@@ -259,7 +259,7 @@ public Streams executeCommand( String command, boolean ignoreFailures )\n \n             Streams streams = CommandExecutorStreamProcessor.processStreams( stderrReader, stdoutReader );\n \n-            if ( streams.getErr().length() > 0 )\n+            if ( streams.getErr().length() > 0 && !ignoreFailures )\n             {\n                 int exitCode = channel.getExitStatus();\n                 throw new CommandExecutionException( \"Exit code: \" + exitCode + \" - \" + streams.getErr() );",
                "deletions": 2
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "Fixing WAGONSSH-14: \"another NPE introduced by me :(\"\no Problem and patch created by Juan F. Codagnone.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@290699 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/51aa4013d6d6074335e914d290e6677c6b2a3d01",
        "parent": "https://github.com/apache/maven-wagon/commit/fe3063ba212910f3dcd4341d38e19bbe2a9a01b8",
        "bug_id": "maven-wagon_13",
        "file": [
            {
                "sha": "c47165df6bc38e4df86a222d836139ce412b3c5b",
                "filename": "wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/ScpWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/51aa4013d6d6074335e914d290e6677c6b2a3d01/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/ScpWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/51aa4013d6d6074335e914d290e6677c6b2a3d01/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/ScpWagon.java",
                "status": "modified",
                "changes": 9,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/ScpWagon.java?ref=51aa4013d6d6074335e914d290e6677c6b2a3d01",
                "patch": "@@ -242,19 +242,18 @@ public void put( File source, String resourceName )\n         firePutInitiated( resource, source );\n \n         String umaskCmd = \"\";\n+\n         if ( getRepository().getPermissions() != null )\n         {\n-            final String dirPerms = getRepository().getPermissions().getDirectoryMode();\n+            String dirPerms = getRepository().getPermissions().getDirectoryMode();\n+\n             if ( dirPerms != null )\n             {\n                 umaskCmd = \"umask \" + PermissionModeUtils.getUserMaskFor( dirPerms ) + \"\\n\";\n-                executeCommand( umaskCmd );\n             }\n         }\n \n-        String mkdirCmd = umaskCmd + \"mkdir -p -m \"\n-                          + getRepository().getPermissions().getDirectoryMode()\n-                          + \" \" + basedir + \"/\" + dir + \"\\n\";\n+        String mkdirCmd = umaskCmd + \"mkdir -p -m \" + basedir + \"/\" + dir + \"\\n\";\n \n         executeCommand( mkdirCmd );\n ",
                "deletions": 5
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "Fixing WAGON-SSH-10: \"fix NPE introduced in WAGONSSH-9\"\nPatch by Juan F. Codagnone.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@280300 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/af6e4e9003173ec968f0742743056e9bbf16c07f",
        "parent": "https://github.com/apache/maven-wagon/commit/333e66954d91e562be019ddbbc50323283eafb9c",
        "bug_id": "maven-wagon_14",
        "file": [
            {
                "sha": "764068087b9767173a2413c21b207ded41891f26",
                "filename": "wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/SftpWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/af6e4e9003173ec968f0742743056e9bbf16c07f/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/SftpWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/af6e4e9003173ec968f0742743056e9bbf16c07f/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/SftpWagon.java",
                "status": "modified",
                "changes": 24,
                "additions": 15,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ssh/src/main/java/org/apache/maven/wagon/providers/ssh/SftpWagon.java?ref=af6e4e9003173ec968f0742743056e9bbf16c07f",
                "patch": "@@ -160,17 +160,23 @@ public void put( File source, String resourceName )\n      */\n     private int getDirectoryMode( RepositoryPermissions permissions )\n     {\n-        try\n-        {\n-            return Integer.valueOf( permissions.getDirectoryMode(), 8 ).intValue();\n-        }\n-        catch ( NumberFormatException e )\n+        int ret = -1;\n+        \n+        if ( permissions != null ) \n         {\n-            // TODO: warning level\n-            fireTransferDebug( \"the file mode must be a numerical mode for SFTP\" );\n-\n-            return -1;\n+            try\n+            {\n+                ret = Integer.valueOf( permissions.getDirectoryMode(), 8 ).intValue();\n+            }\n+            catch ( NumberFormatException e )\n+            {\n+                // TODO: warning level\n+                fireTransferDebug( \"the file mode must be a numerical mode for SFTP\" );\n+                ret = -1;\n+            }\n         }\n+        \n+        return ret;\n     }\n \n     private void mkdirs( ChannelSftp channel, String resourceName, int mode )",
                "deletions": 9
            }
        ]
    },
    {
        "repo": "maven-wagon",
        "message": "PR: WAGONFTP-5\nftp may be null in closeConnection(), avoid NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@220351 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-wagon/commit/02a071d6736d74d8cbf770ad678559cd7e19c73c",
        "parent": "https://github.com/apache/maven-wagon/commit/75e1613706c02173847a2eb5fb123a56a92292e0",
        "bug_id": "maven-wagon_15",
        "file": [
            {
                "sha": "777752bfed36ea9ca8efe769c266ef89e0b3bd8f",
                "filename": "wagon-providers/wagon-ftp/pom.xml",
                "blob_url": "https://github.com/apache/maven-wagon/blob/02a071d6736d74d8cbf770ad678559cd7e19c73c/wagon-providers/wagon-ftp/pom.xml",
                "raw_url": "https://github.com/apache/maven-wagon/raw/02a071d6736d74d8cbf770ad678559cd7e19c73c/wagon-providers/wagon-ftp/pom.xml",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ftp/pom.xml?ref=02a071d6736d74d8cbf770ad678559cd7e19c73c",
                "patch": "@@ -8,7 +8,7 @@\n     <version>1.0-alpha-4</version>\n   </parent>\n   <artifactId>wagon-ftp</artifactId>\n-  <version>1.0-alpha-4</version>\n+  <version>1.0-alpha-5-SNAPSHOT</version>\n   <name>Maven Wagon FTP Provider</name>\n   <dependencies>\n     <dependency>",
                "deletions": 1
            },
            {
                "sha": "d7b706a0605db5454a0d99a07391bfaca345d634",
                "filename": "wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "blob_url": "https://github.com/apache/maven-wagon/blob/02a071d6736d74d8cbf770ad678559cd7e19c73c/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "raw_url": "https://github.com/apache/maven-wagon/raw/02a071d6736d74d8cbf770ad678559cd7e19c73c/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java",
                "status": "modified",
                "changes": 12,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-providers/wagon-ftp/src/main/java/org/apache/maven/wagon/providers/ftp/FtpWagon.java?ref=02a071d6736d74d8cbf770ad678559cd7e19c73c",
                "patch": "@@ -31,6 +31,7 @@\n import org.apache.maven.wagon.TransferFailedException;\n import org.apache.maven.wagon.WagonConstants;\n import org.apache.maven.wagon.authentication.AuthenticationException;\n+import org.apache.maven.wagon.authentication.AuthenticationInfo;\n import org.apache.maven.wagon.repository.RepositoryPermissions;\n import org.apache.maven.wagon.resource.Resource;\n \n@@ -47,14 +48,16 @@\n     public void openConnection()\n         throws ConnectionException, AuthenticationException\n     {\n-        if ( authenticationInfo == null )\n+        AuthenticationInfo authInfo = getRepository().getAuthenticationInfo();\n+\n+        if ( authInfo == null )\n         {\n             throw new IllegalArgumentException( \"Authentication Credentials cannot be null for FTP protocol\" );\n         }\n \n-        String username = authenticationInfo.getUserName();\n+        String username = authInfo.getUserName();\n \n-        String password = authenticationInfo.getPassword();\n+        String password = authInfo.getPassword();\n \n         String host = getRepository().getHost();\n \n@@ -128,7 +131,6 @@ public void openConnection()\n             // Set to binary mode.\n             ftp.setFileType( FTP.BINARY_FILE_TYPE );\n \n-\n             // Use passive mode as default because most of us are\n             // behind firewalls these days.\n             // TODO [BP]: make optional based on a flag\n@@ -199,7 +201,7 @@ protected void fireGetCompleted( Resource resource, File localFile )\n     public void closeConnection()\n         throws ConnectionException\n     {\n-        if ( ftp.isConnected() )\n+        if ( ftp != null && ftp.isConnected() )\n         {\n             try\n             {",
                "deletions": 5
            }
        ]
    }
]