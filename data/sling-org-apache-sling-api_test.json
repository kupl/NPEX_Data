{
    "sling-org-apache-sling-api_d354f2a": {
        "repo": "sling-org-apache-sling-api",
        "message": "SLING-988 Ensure ResourceUtil.getValueMap does not throw a\nNullPointerException (thanks Julian Sedding for providing\nthe patch)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/sling/trunk@780748 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/sling-org-apache-sling-api/commit/d354f2a59b5af26d9f0573139be149875385f8da",
        "parent": "https://github.com/apache/sling-org-apache-sling-api/commit/74c7bab6a720af1a01f9d72ab38385c1cec531d5",
        "bug_id": "sling-org-apache-sling-api_d354f2a",
        "file": [
            {
                "sha": "53f48af1fa6946b9882f17775731d6e6f14e77f5",
                "filename": "src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/d354f2a59b5af26d9f0573139be149875385f8da/src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/d354f2a59b5af26d9f0573139be149875385f8da/src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "status": "modified",
                "changes": 9,
                "additions": 6,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/main/java/org/apache/sling/api/resource/ResourceUtil.java?ref=d354f2a59b5af26d9f0573139be149875385f8da",
                "patch": "@@ -285,11 +285,14 @@ public static boolean isNonExistingResource(Resource res) {\n      * @param res The <code>Resource</code> to adapt to the value map.\n      * @return A value map.\n      */\n+    @SuppressWarnings(\"unchecked\")\n     public static ValueMap getValueMap(final Resource res) {\n-        ValueMap map = (res == null ? null : res.adaptTo(ValueMap.class));\n-        if ( map == null ) {\n+        ValueMap map = (res == null)\n+                ? ValueMap.EMPTY\n+                : res.adaptTo(ValueMap.class);\n+        if (map == null) {\n             Map m = res.adaptTo(Map.class);\n-            if ( m != null ) {\n+            if (m != null) {\n                 map = new ValueMapDecorator(m);\n             } else {\n                 map = ValueMap.EMPTY;",
                "deletions": 3
            },
            {
                "sha": "8284fbb512a528deb5de0d4af8c4efba1fe8c3e0",
                "filename": "src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/d354f2a59b5af26d9f0573139be149875385f8da/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/d354f2a59b5af26d9f0573139be149875385f8da/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "status": "modified",
                "changes": 7,
                "additions": 7,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java?ref=d354f2a59b5af26d9f0573139be149875385f8da",
                "patch": "@@ -147,4 +147,11 @@ public void testGetName() {\n         assertEquals(\"b\", ResourceUtil.getName(\"/b/c/..\"));\n         assertEquals(\"\", ResourceUtil.getName(\"/b/c/../..\"));\n     }\n+\n+    public void testGetValueMap() {\n+        // expect an empty ValueMap \n+        ValueMap valueMap = ResourceUtil.getValueMap(null);\n+        assertNotNull(valueMap);\n+        assertEquals(0, valueMap.size());\n+    }\n }",
                "deletions": 0
            }
        ],
        "patched_files": [
            "ResourceUtil.java"
        ],
        "unit_tests": [
            "ResourceUtilTest.java"
        ]
    }
}