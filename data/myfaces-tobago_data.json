[{"commit": "https://github.com/apache/myfaces-tobago/commit/4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389", "parent": "https://github.com/apache/myfaces-tobago/commit/53dbbe53a8bed294d2caf05000683629925a91cc", "message": "Resolves same issue as MYFACES-4199\n* NPE inside empty <f:selectItem>", "bug_id": "myfaces-tobago_1", "file": [{"additions": 3, "raw_url": "https://github.com/apache/myfaces-tobago/raw/4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SelectManyRendererBase.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SelectManyRendererBase.java", "sha": "7f99f4948d729cdf1de5000ff7afb2f140d81d7a", "changes": 4, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SelectManyRendererBase.java?ref=4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389", "patch": "@@ -675,7 +675,9 @@ public SelectItem next() {\n           // must be called on the string rendered attribute values\n           Object itemLabel = attributeMap.get(ITEM_LABEL_ATTR);\n           if (itemLabel == null) {\n-            itemLabel = itemValue.toString();\n+            if (itemValue != null) {\n+              itemLabel = itemValue.toString();\n+            }\n           } else {\n             itemLabel = itemLabel.toString();\n           }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SelectManyRendererBase.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/SelectItemUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/SelectItemUtils.java", "sha": "74a1b5e629920702ec4ea3262436459406459936", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/SelectItemUtils.java?ref=4f7ea483cbbb4c1df8a56e9e40cd2d9da852c389", "patch": "@@ -139,7 +139,7 @@ public boolean hasNext() {\n           final boolean disabled = uiSelectItem.isItemDisabled();\n //          boolean escape = uiSelectItem.isItemEscaped();\n //          boolean noSelectionOption = uiSelectItem.isNoSelectionOption();\n-          if (label == null) {\n+          if (label == null && itemValue != null) {\n             label = itemValue.toString();\n           }\n           String image = null;", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/SelectItemUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/67d762452a4ac83b66b9b7cb8d0301c6cddba21c", "parent": "https://github.com/apache/myfaces-tobago/commit/4a5633625c4638a7193ca159d485d8d652b7beb2", "message": "TOBAGO-1782: Clean up\n* aware NPE", "bug_id": "myfaces-tobago_2", "file": [{"additions": 8, "raw_url": "https://github.com/apache/myfaces-tobago/raw/67d762452a4ac83b66b9b7cb8d0301c6cddba21c/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUITabGroup.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/67d762452a4ac83b66b9b7cb8d0301c6cddba21c/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUITabGroup.java", "sha": "ef5b0b4ee0f2bbdd6f04921bc21bff9ed2ea0c5e", "changes": 17, "status": "modified", "deletions": 9, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUITabGroup.java?ref=67d762452a4ac83b66b9b7cb8d0301c6cddba21c", "patch": "@@ -144,8 +144,10 @@ public void processValidators(final FacesContext context) {\n       if (!isRendered()) {\n         return;\n       }\n-      final AbstractUITab renderedTab = getRenderedTab();\n-      renderedTab.processValidators(context);\n+      final AbstractUITab renderedTab = getTab(getRenderedIndex());\n+      if (renderedTab != null) {\n+        renderedTab.processValidators(context);\n+      }\n       for (final UIComponent facet : getFacets().values()) {\n         facet.processValidators(context);\n       }\n@@ -160,8 +162,10 @@ public void processUpdates(final FacesContext context) {\n       if (!isRendered()) {\n         return;\n       }\n-      final AbstractUITab renderedTab = getRenderedTab();\n-      renderedTab.processUpdates(context);\n+      final AbstractUITab renderedTab = getTab(getRenderedIndex());\n+      if (renderedTab != null) {\n+        renderedTab.processUpdates(context);\n+      }\n       for (final UIComponent facet : getFacets().values()) {\n         facet.processUpdates(context);\n       }\n@@ -249,11 +253,6 @@ private AbstractUITab getTab(final int index) {\n     return null;\n   }\n \n-  private AbstractUITab getRenderedTab() {\n-    return getTab(getRenderedIndex());\n-  }\n-\n-\n   /**\n    * @since 1.5.0\n    */", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUITabGroup.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/4a5633625c4638a7193ca159d485d8d652b7beb2", "parent": "https://github.com/apache/myfaces-tobago/commit/d0398107d5a16aad4454584d3e31678b21c682cd", "message": "TOBAGO-1782: Clean up\n* aware NPE", "bug_id": "myfaces-tobago_3", "file": [{"additions": 13, "raw_url": "https://github.com/apache/myfaces-tobago/raw/4a5633625c4638a7193ca159d485d8d652b7beb2/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TreeEditorController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/4a5633625c4638a7193ca159d485d8d652b7beb2/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TreeEditorController.java", "sha": "db1bb630c29570f76668eff8c327844ef45e86a4", "changes": 24, "status": "modified", "deletions": 11, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TreeEditorController.java?ref=4a5633625c4638a7193ca159d485d8d652b7beb2", "patch": "@@ -125,18 +125,20 @@ private DefaultMutableTreeNode cloneNode(final DefaultMutableTreeNode node) {\n \n   public String paste() {\n     final DefaultMutableTreeNode node = findFirstSelected();\n-    if (cutNode != null) {\n-      if (isBaseNodeContainSelectedNode(cutNode, node)) {\n-        FacesContext.getCurrentInstance().addMessage(null,\n-                new FacesMessage(FacesMessage.SEVERITY_INFO, \"Cannot past a cut node into itself.\", null));\n-      } else {\n-        node.insert(cutNode, 0);\n-        cutNode = null;\n+    if (node != null) {\n+      if (cutNode != null) {\n+        if (isBaseNodeContainSelectedNode(cutNode, node)) {\n+          FacesContext.getCurrentInstance().addMessage(null,\n+                  new FacesMessage(FacesMessage.SEVERITY_INFO, \"Cannot past a cut node into itself.\", null));\n+        } else {\n+          node.insert(cutNode, 0);\n+          cutNode = null;\n+        }\n+      } else if (copyNode != null) {\n+        node.insert(copyNode, 0);\n+        copyNode = null;\n+        deselectAllNodes(categoryTree);\n       }\n-    } else if (copyNode != null) {\n-      node.insert(copyNode, 0);\n-      copyNode = null;\n-      deselectAllNodes(categoryTree);\n     }\n     return null;\n   }", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TreeEditorController.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/d0398107d5a16aad4454584d3e31678b21c682cd", "parent": "https://github.com/apache/myfaces-tobago/commit/3c7484d90b6ad5d125ea82f6a4d56c63ab9a1542", "message": "TOBAGO-1782: Clean up\n* aware NPE", "bug_id": "myfaces-tobago_4", "file": [{"additions": 11, "raw_url": "https://github.com/apache/myfaces-tobago/raw/d0398107d5a16aad4454584d3e31678b21c682cd/tobago-core/src/main/java/org/apache/myfaces/tobago/context/Markup.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/d0398107d5a16aad4454584d3e31678b21c682cd/tobago-core/src/main/java/org/apache/myfaces/tobago/context/Markup.java", "sha": "6302a9c71c97632c3eb3d08005cd2deaf101bf35", "changes": 14, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/context/Markup.java?ref=d0398107d5a16aad4454584d3e31678b21c682cd", "patch": "@@ -333,7 +333,10 @@ public Markup add(final Markup markup) {\n       Markup result = this;\n       if (markup.values != null) {\n         for (final String summand : markup.values) {\n-          result = result.add(summand);\n+          final Markup combined = result.add(summand);\n+          if (combined != null) {\n+            result = combined;\n+          }\n         }\n       }\n       return result;\n@@ -373,7 +376,12 @@ public Markup remove(final Markup markup) {\n       // this part is not optimized, but it will be used rarely, in the moment...\n       Markup result = this;\n       for (final String summand : markup.values) {\n-        result = result.remove(summand);\n+        final Markup removed = result.remove(summand);\n+        if (removed == null) {\n+          result = NULL;\n+        } else {\n+          result = removed;\n+        }\n       }\n       return result;\n     }\n@@ -398,7 +406,7 @@ private Markup remove(final String summand) {\n         final String[] strings = new String[values.length - 1];\n         int found = 0;\n         for (int i = 0; i < strings.length; i++) {\n-          if (values[i].equals(summand)) {\n+          if (summand.equals(values[i])) {\n             found++;\n           }\n           strings[i] = values[i + found];", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/context/Markup.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/bcdb1c176206c7d3f60fa339441aacd8edb22bd7", "parent": "https://github.com/apache/myfaces-tobago/commit/767fb3399ed58316e6a8927a7a1b39e5cd668fde", "message": "TOBAGO-1782: Clean up\n* using \"try with resources\" (new with Java 7)\n** avoid NPE", "bug_id": "myfaces-tobago_5", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/bcdb1c176206c7d3f60fa339441aacd8edb22bd7/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/SourceFileReader.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/bcdb1c176206c7d3f60fa339441aacd8edb22bd7/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/SourceFileReader.java", "sha": "5666652e85802103a3b37c6a78be7ce2266399f2", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/SourceFileReader.java?ref=bcdb1c176206c7d3f60fa339441aacd8edb22bd7", "patch": "@@ -38,10 +38,12 @@ public String getSource(final String filename) {\n     final String viewId = facesContext.getViewRoot().getViewId();\n     final String file = viewId.substring(0, viewId.lastIndexOf(\"/\")) + \"/\" + filename;\n     try (final InputStream resourceAsStream = externalContext.getResourceAsStream(file)) {\n-      return IOUtils.toString(resourceAsStream, \"UTF-8\");\n+      if (resourceAsStream != null) {\n+        return IOUtils.toString(resourceAsStream, \"UTF-8\");\n+      }\n     } catch (final IOException e) {\n       LOG.error(\"\", e);\n-      return null;\n     }\n+    return null;\n   }\n }", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/SourceFileReader.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/b7f43f8bad90b28c91f6b99a92cc83ae5b0f938d", "parent": "https://github.com/apache/myfaces-tobago/commit/4c8f97bf71ffb1fb8bd2476075856a0d90696b0e", "message": "avoid NPE", "bug_id": "myfaces-tobago_6", "file": [{"additions": 3, "raw_url": "https://github.com/apache/myfaces-tobago/raw/b7f43f8bad90b28c91f6b99a92cc83ae5b0f938d/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/AttributeHandler.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/b7f43f8bad90b28c91f6b99a92cc83ae5b0f938d/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/AttributeHandler.java", "sha": "36c408ce9ea8eddea0efb0e198cbce44cbadd62c", "changes": 4, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/AttributeHandler.java?ref=b7f43f8bad90b28c91f6b99a92cc83ae5b0f938d", "patch": "@@ -259,12 +259,14 @@ public void apply(final FaceletContext faceletContext, final UIComponent parent)\n           if (action != null) {\n             ((ActionSource) parent).addActionListener(new MethodExpressionActionListener(action));\n           }\n-        } else if (!parent.getAttributes().containsKey(nameValue.getName())) {\n+        } else if (nameValue != null && !parent.getAttributes().containsKey(nameValue.getName())) {\n           if (value.isLiteral()) {\n             parent.getAttributes().put(nameValue.getName(), value.getValue());\n           } else {\n             parent.setValueExpression(nameValue.getName(), value.getValueExpression(faceletContext, Object.class));\n           }\n+        } else if (nameValue == null) {\n+          LOG.warn(\"Null value for {}\", name);\n         }\n       }\n     }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/AttributeHandler.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/7c283a022dcd8a700531ba1c90774cb38b955bdb", "parent": "https://github.com/apache/myfaces-tobago/commit/80bdda31bbe6a18387683862a8a95a982de720de", "message": "TOBAGO-1674: avoid NPE", "bug_id": "myfaces-tobago_7", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/7c283a022dcd8a700531ba1c90774cb38b955bdb/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/config/TobagoConfigImpl.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/7c283a022dcd8a700531ba1c90774cb38b955bdb/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/config/TobagoConfigImpl.java", "sha": "d72ac297d3a1f85bacf368b7eaf3ecd3b4a4c1d9", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/config/TobagoConfigImpl.java?ref=7c283a022dcd8a700531ba1c90774cb38b955bdb", "patch": "@@ -178,7 +178,7 @@ public Theme getTheme(final String name) {\n       LOG.debug(\"searching theme: null\");\n       return defaultTheme;\n     }\n-    if (defaultTheme.getName().equals(name)) {\n+    if (defaultTheme != null && defaultTheme.getName().equals(name)) {\n       return defaultTheme;\n     }\n     for (final Theme theme : supportedThemes) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/config/TobagoConfigImpl.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/952f604bd782903890f63113dd886454afa60d0e", "parent": "https://github.com/apache/myfaces-tobago/commit/1bb00bda8b15299ce5892c3abf91ccd6eba4c9dd", "message": "TOBAGO-1671: avoid NPE - fixes Blocker violation reported by Sonar", "bug_id": "myfaces-tobago_8", "file": [{"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/952f604bd782903890f63113dd886454afa60d0e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/952f604bd782903890f63113dd886454afa60d0e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java", "sha": "c49cfeb6241bd4f9f36175c74acd8c53481eb1d0", "changes": 15, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java?ref=952f604bd782903890f63113dd886454afa60d0e", "patch": "@@ -97,13 +97,16 @@ public String getScript(ClientBehaviorContext behaviorContext, ClientBehavior be\n       actionId = clientId;\n     } else if (behavior instanceof EventBehavior) { // <tc:event>\n       AbstractUIEvent event = findEvent(uiComponent, eventName);\n-      if (event != null && !event.isRendered()){\n-        return null;\n+      if (event != null) {\n+        if (!event.isRendered()) {\n+          return null;\n+        } else {\n+          transition = event.isTransition();\n+          target = event.getTarget();\n+          actionId = event.getClientId(facesContext);\n+          omit = event.isOmit() || StringUtils.isNotBlank(RenderUtils.generateUrl(facesContext, event));\n+        }\n       }\n-      transition = event.isTransition();\n-      target = event.getTarget();\n-      actionId = event.getClientId(facesContext);\n-      omit = event.isOmit() || StringUtils.isNotBlank(RenderUtils.generateUrl(facesContext, event));\n     } else {\n       LOG.warn(\"Unknown behavior '{}'!\", behavior.getClass().getName());\n     }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/cdc58fabee2345365d64c9ea99427d5dd579eb93", "parent": "https://github.com/apache/myfaces-tobago/commit/839e2dd0a30af8870fcc655c04c4ef7481d34474", "message": "TOBAGO-1738: No UIComponents for <tc:script> and <tc:style>.\n* fixing possible NPE", "bug_id": "myfaces-tobago_9", "file": [{"additions": 10, "raw_url": "https://github.com/apache/myfaces-tobago/raw/cdc58fabee2345365d64c9ea99427d5dd579eb93/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/CustomClass.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/cdc58fabee2345365d64c9ea99427d5dd579eb93/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/CustomClass.java", "sha": "1616934dca354e326537bcf51b17f4b82ef0b1b7", "changes": 13, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/CustomClass.java?ref=cdc58fabee2345365d64c9ea99427d5dd579eb93", "patch": "@@ -51,13 +51,20 @@ public CustomClass(final ValueExpression valueExpression) {\n \n   @Override\n   public String getName() {\n-    String string;\n+    final String string;\n     if (name != null) {\n       string = name;\n-    } else {\n+    } else if (valueExpression != null) {\n       final FacesContext facesContext = FacesContext.getCurrentInstance();\n       final ELContext elContext = facesContext.getELContext();\n-      string = valueExpression.getValue(elContext).toString();\n+      final Object valueExpressionValue = valueExpression.getValue(elContext);\n+      if (valueExpressionValue != null) {\n+        string = valueExpressionValue.toString();\n+      } else {\n+        return \"\";\n+      }\n+    } else {\n+      return \"\";\n     }\n \n     final StringTokenizer tokenizer = new StringTokenizer(string, \" \");", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/CustomClass.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/c76c0be9d0c384ac8b66e687a5e8ac4db5eb65ab", "parent": "https://github.com/apache/myfaces-tobago/commit/ffea2255d83ff8d2b847989a899cafdd86c1b128", "message": "TOBAGO-1625: <tc:style> support for <tc:row> and <tc:column>\n* NPE fix", "bug_id": "myfaces-tobago_10", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c76c0be9d0c384ac8b66e687a5e8ac4db5eb65ab/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c76c0be9d0c384ac8b66e687a5e8ac4db5eb65ab/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SheetRenderer.java", "sha": "d7712bc7b86b00d8f0d62a3d26347514cf5f13e7", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SheetRenderer.java?ref=c76c0be9d0c384ac8b66e687a5e8ac4db5eb65ab", "patch": "@@ -763,8 +763,10 @@ private void encodeHeaderRows(\n     for (int i = 0; i < grid.getRowCount(); i++) {\n       writer.startElement(HtmlElements.TR);\n       final AbstractUIRow row = ComponentUtils.findChild(sheet, AbstractUIRow.class);\n-      writer.writeClassAttribute(row.getCustomClass());\n-      writer.writeStyleAttribute(row.getStyle());\n+      if (row != null) {\n+        writer.writeClassAttribute(row.getCustomClass());\n+        writer.writeStyleAttribute(row.getStyle());\n+      }\n       for (int j = 0; j < columns.size(); j++) {\n         final AbstractUIColumnBase column = columns.get(j);\n         if (!column.isRendered() || column instanceof AbstractUIRow) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/1d14be2460522d395088c967b4ed6cc22f16eed1", "parent": "https://github.com/apache/myfaces-tobago/commit/8744598eefb71bcdc5a75560b1e5a422aa3780d2", "message": "TOBAGO-1505: NPE while rendering Session Secret", "bug_id": "myfaces-tobago_11", "file": [{"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/1d14be2460522d395088c967b4ed6cc22f16eed1/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/1d14be2460522d395088c967b4ed6cc22f16eed1/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java", "sha": "3bb397a49b0220d8977a73d687f7cb6accc9cd01", "changes": 18, "status": "modified", "deletions": 9, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java?ref=1d14be2460522d395088c967b4ed6cc22f16eed1", "patch": "@@ -82,6 +82,11 @@ public static boolean check(final FacesContext facesContext) {\n     final Map requestParameterMap = facesContext.getExternalContext().getRequestParameterMap();\n     final String fromRequest = (String) requestParameterMap.get(Secret.KEY);\n     final Object session = facesContext.getExternalContext().getSession(false);\n+    Secret secret = getSecret(session);\n+    return secret != null && secret.secret.equals(fromRequest);\n+  }\n+\n+  private static Secret getSecret(Object session) {\n     Secret secret = null;\n     if (session!=null) {\n       if (session instanceof HttpSession) {\n@@ -92,7 +97,7 @@ public static boolean check(final FacesContext facesContext) {\n         throw new IllegalArgumentException(\"Unknown session type: \" + session);\n       }\n     }\n-    return secret != null && secret.secret.equals(fromRequest);\n+    return secret;\n   }\n \n   /**\n@@ -104,15 +109,10 @@ public static void encode(final FacesContext facesContext, final TobagoResponseW\n     writer.writeAttribute(HtmlAttributes.NAME, Secret.KEY, false);\n     writer.writeAttribute(HtmlAttributes.ID, Secret.KEY, false);\n     final Object session = facesContext.getExternalContext().getSession(true);\n-    final Secret secret;\n-    if (session instanceof HttpSession) {\n-      secret = (Secret) ((HttpSession) session).getAttribute(Secret.KEY);\n-    } else if (PortletUtils.isPortletApiAvailable() && session instanceof PortletSession) {\n-      secret = (Secret) ((PortletSession) session).getAttribute(Secret.KEY, PortletSession.APPLICATION_SCOPE);\n-    } else {\n-      throw new IllegalArgumentException(\"Unknown session type: \" + session);\n+    final Secret secret = getSecret(session);\n+    if (secret != null) {\n+      writer.writeAttribute(HtmlAttributes.VALUE, secret.secret, false);\n     }\n-    writer.writeAttribute(HtmlAttributes.VALUE, secret.secret, false);\n     writer.endElement(HtmlElements.INPUT);\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/ab2042085651408fa9bb19dc1211c3391f71b561", "parent": "https://github.com/apache/myfaces-tobago/commit/6f8c8dc557b8e63d583c0caa38708e650fee6d79", "message": "prevent NPE", "bug_id": "myfaces-tobago_12", "file": [{"additions": 15, "raw_url": "https://github.com/apache/myfaces-tobago/raw/ab2042085651408fa9bb19dc1211c3391f71b561/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/ajax/AjaxNavigationState.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/ab2042085651408fa9bb19dc1211c3391f71b561/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/ajax/AjaxNavigationState.java", "sha": "ad07658097660e04e41bda2551ffb6ec5406f783", "changes": 18, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/ajax/AjaxNavigationState.java?ref=ab2042085651408fa9bb19dc1211c3391f71b561", "patch": "@@ -116,15 +116,27 @@ private void restoreView(FacesContext facesContext) {\n   }\n \n   public static void storeIncomingView(FacesContext facesContext) {\n-    UIViewRoot viewRoot = facesContext.getViewRoot();\n-    LOG.trace(\"incoming viewId = \\\"{}\\\"\", viewRoot.getViewId());\n+    final UIViewRoot viewRoot = facesContext.getViewRoot();\n+    if (LOG.isTraceEnabled()) {\n+      if (viewRoot != null) {\n+        LOG.trace(\"incoming viewId = '{}'\", viewRoot.getViewId());\n+      } else {\n+        LOG.trace(\"incoming viewRoot is null\");\n+      }\n+    }\n     facesContext.getExternalContext().getRequestMap().put(AjaxNavigationState.VIEW_ROOT_KEY, viewRoot);\n   }\n \n   public static boolean isNavigation(FacesContext facesContext) {\n \n     final UIViewRoot viewRoot = facesContext.getViewRoot();\n-    LOG.trace(\"current viewId = \\\"{}\\\"\", viewRoot.getViewId());\n+    if (LOG.isTraceEnabled()) {\n+      if (viewRoot != null) {\n+        LOG.trace(\"current viewId = '{}'\", viewRoot.getViewId());\n+      } else {\n+        LOG.trace(\"current viewRoot is null\");\n+      }\n+    }\n \n     ExternalContext externalContext = facesContext.getExternalContext();\n     Map<String, Object> requestMap = externalContext.getRequestMap();", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/ajax/AjaxNavigationState.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/419fd8a500b8fe6155c7c0938ea86b41e0382c68", "parent": "https://github.com/apache/myfaces-tobago/commit/b274b5ee57b29770c1ec70b09c66401d7b6016c7", "message": "TOBAGO-1459 - Possilble NPE in SplitLayoutRenderer", "bug_id": "myfaces-tobago_13", "file": [{"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/419fd8a500b8fe6155c7c0938ea86b41e0382c68/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/419fd8a500b8fe6155c7c0938ea86b41e0382c68/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java", "sha": "b04fd1b338a7ff8a357504293b7f0d40e03d6b02", "changes": 13, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java?ref=419fd8a500b8fe6155c7c0938ea86b41e0382c68", "patch": "@@ -115,15 +115,20 @@ private String createDraggableContainment(final AbstractUISplitLayout layout) {\n     final LayoutComponent firstComponent = container.getComponents().get(0);\n     final LayoutComponent secondComponent = container.getComponents().get(1);\n \n+    Measure minimum;\n     if (AbstractUISplitLayout.HORIZONTAL.equals(layout.getOrientation())) {\n-      final int minimumSize1 = firstComponent.getMinimumWidth().getPixel();\n-      final int minimumSize2 = secondComponent.getMinimumWidth().getPixel();\n+      minimum = firstComponent.getMinimumWidth();\n+      final int minimumSize1 = minimum != null ? minimum.getPixel() : 0;\n+      minimum = secondComponent.getMinimumWidth();\n+      final int minimumSize2 = minimum != null ? minimum.getPixel() : 0;\n       final int totalSize = container.getCurrentWidth().getPixel();\n       return new StringBuilder(\"[\").append(minimumSize1).append(\", 0, \").append(totalSize-minimumSize2).append(\", 0]\")\n           .toString();\n     } else {\n-      final int minimumSize1 = firstComponent.getMinimumHeight().getPixel();\n-      final int minimumSize2 = secondComponent.getMinimumHeight().getPixel();\n+      minimum = firstComponent.getMinimumHeight();\n+      final int minimumSize1 = minimum != null ? minimum.getPixel() : 0;\n+      minimum = secondComponent.getMinimumHeight();\n+      final int minimumSize2 = minimum != null ? minimum.getPixel() : 0;\n       final int totalSize = container.getCurrentHeight().getPixel();\n       return new StringBuilder(\"[0, \").append(minimumSize1).append(\", 0, \").append(totalSize-minimumSize2).append(\"]\")\n           .toString();", "filename": "tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/4b070ddf30e08b03f8cc32ce54f9e5af51e2216c", "parent": "https://github.com/apache/myfaces-tobago/commit/4159d5af364c99027ff7470b698927dfb1b81e30", "message": "TOBAGO-1488: Toolbar for tc:box in Bootstrap\n- fix NPE", "bug_id": "myfaces-tobago_14", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/4b070ddf30e08b03f8cc32ce54f9e5af51e2216c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/BoxRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/4b070ddf30e08b03f8cc32ce54f9e5af51e2216c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/BoxRenderer.java", "sha": "69301d7a79c6b25d8d1e2dd4fd6fb2c326d7896d", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/BoxRenderer.java?ref=4b070ddf30e08b03f8cc32ce54f9e5af51e2216c", "patch": "@@ -75,7 +75,7 @@ public void encodeBegin(final FacesContext facesContext, final UIComponent compo\n             writer.writeClassAttribute(BootstrapClass.PANEL_TITLE);\n             if (label != null) {\n                 RenderUtils.encode(facesContext, label);\n-            } else {\n+            } else if (labelString != null) {\n                 writer.writeText(labelString);\n             }\n             writer.endElement(HtmlElements.H3);", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/BoxRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/adb5f77bd1e8efcb9bd9f6bde99a0719e3a2de26", "parent": "https://github.com/apache/myfaces-tobago/commit/7ea6110a7dfb6ab057a06637a4099563eb07232e", "message": "check for NPE", "bug_id": "myfaces-tobago_15", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/adb5f77bd1e8efcb9bd9f6bde99a0719e3a2de26/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/adb5f77bd1e8efcb9bd9f6bde99a0719e3a2de26/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "sha": "154ef0f5b499b5d1c08b001d0d3f4d9497c519d5", "changes": 8, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java?ref=adb5f77bd1e8efcb9bd9f6bde99a0719e3a2de26", "patch": "@@ -51,9 +51,11 @@ private StringUtils() {\n \n   public static <T> String joinWithSurroundingSeparator(final List<T> list) {\n     final StringBuilder buffer = new StringBuilder(\",\");\n-    for (final T t : list) {\n-      buffer.append(t);\n-      buffer.append(\",\");\n+    if (list != null) {\n+      for (final T t : list) {\n+        buffer.append(t);\n+        buffer.append(\",\");\n+      }\n     }\n     return buffer.toString();\n   }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/7ea6110a7dfb6ab057a06637a4099563eb07232e", "parent": "https://github.com/apache/myfaces-tobago/commit/ea35b74019957f25b26bb5111cb1389d36e54b22", "message": "quick fix, prevent NPE", "bug_id": "myfaces-tobago_16", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/7ea6110a7dfb6ab057a06637a4099563eb07232e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/7ea6110a7dfb6ab057a06637a4099563eb07232e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "sha": "8ddf5480749c1507ceec34f445c23e46b53192d5", "changes": 4, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java?ref=7ea6110a7dfb6ab057a06637a4099563eb07232e", "patch": "@@ -382,6 +382,10 @@ private Measure getFooterHeight(final FacesContext facesContext, final AbstractU\n   private void layoutHeader() {\n     final AbstractUISheet sheet = (AbstractUISheet) getLayoutContainer();\n     final UIComponent header = sheet.getHeader();\n+    if (header == null) {\n+      LOG.warn(\"This should not happen. Please file a bug in the issue tracker to reproduce this case.\");\n+      return;\n+    }\n     final LayoutTokens columns = new LayoutTokens();\n     final List<AbstractUIColumn> renderedColumns = sheet.getRenderedColumns();\n     for (final AbstractUIColumn ignored : renderedColumns) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/69b96995acb445a74013b03ef8980d5658e081cc", "parent": "https://github.com/apache/myfaces-tobago/commit/c134bc0fc50ea66766005a3e8d05b4a557d128ce", "message": "prevent NPE", "bug_id": "myfaces-tobago_17", "file": [{"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/69b96995acb445a74013b03ef8980d5658e081cc/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/util/HtmlRendererUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/69b96995acb445a74013b03ef8980d5658e081cc/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/util/HtmlRendererUtils.java", "sha": "3e03f5f194d364ebe785a103bb9658c5da7ee6ef", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/util/HtmlRendererUtils.java?ref=69b96995acb445a74013b03ef8980d5658e081cc", "patch": "@@ -390,11 +390,11 @@ public static void renderSelectItems(UIInput component, List<SelectItem> items,\n         Markup markup = item instanceof SupportsMarkup ? ((SupportsMarkup) item).getMarkup() : Markup.NULL;\n         if (RenderUtils.contains(values, itemValue)) {\n           writer.writeAttribute(HtmlAttributes.SELECTED, true);\n-          markup = markup.add(Markup.SELECTED);\n+          markup = Markup.SELECTED.add(markup);\n         }\n         if (item.isDisabled()) {\n           writer.writeAttribute(HtmlAttributes.DISABLED, true);\n-          markup = markup.add(Markup.DISABLED);\n+          markup = Markup.DISABLED.add(markup);\n         }\n         writer.writeClassAttribute(Classes.create(component, \"option\", markup));\n ", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/util/HtmlRendererUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/7291aa08f7bd72c5b13a4c4894e45404e1b7e472", "parent": "https://github.com/apache/myfaces-tobago/commit/8be7a9beb2d5fcd0e66630e4bd3887b938be366b", "message": "TOBAGO-1431 - NPE decoding tree state", "bug_id": "myfaces-tobago_18", "file": [{"additions": 20, "raw_url": "https://github.com/apache/myfaces-tobago/raw/7291aa08f7bd72c5b13a4c4894e45404e1b7e472/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/7291aa08f7bd72c5b13a4c4894e45404e1b7e472/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java", "sha": "42df2d4e74f53acda272c9f8f96f1182a6b60822", "changes": 36, "status": "modified", "deletions": 16, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java?ref=7291aa08f7bd72c5b13a4c4894e45404e1b7e472", "patch": "@@ -410,27 +410,31 @@ public static void decodedStateOfTreeData(final FacesContext facesContext, final\n       final TreePath path = data.getPath();\n \n       // selected\n-      final SelectedState selectedState = data.getSelectedState();\n-      final boolean oldSelected = selectedState.isSelected(path);\n-      final boolean newSelected = selectedIndices.contains(rowIndex);\n-      if (newSelected != oldSelected) {\n-        if (newSelected) {\n-          selectedState.select(path);\n-        } else {\n-          selectedState.unselect(path);\n+      if (selectedIndices != null) {\n+        final SelectedState selectedState = data.getSelectedState();\n+        final boolean oldSelected = selectedState.isSelected(path);\n+        final boolean newSelected = selectedIndices.contains(rowIndex);\n+        if (newSelected != oldSelected) {\n+          if (newSelected) {\n+            selectedState.select(path);\n+          } else {\n+            selectedState.unselect(path);\n+          }\n         }\n       }\n \n       // expanded\n       if (expandedIndices != null) {\n-        final ExpandedState expandedState = data.getExpandedState();\n-        final boolean oldExpanded = expandedState.isExpanded(path);\n-        final boolean newExpanded = expandedIndices.contains(rowIndex);\n-        if (newExpanded != oldExpanded) {\n-          if (newExpanded) {\n-            expandedState.expand(path);\n-          } else {\n-            expandedState.collapse(path);\n+        if (expandedIndices != null) {\n+          final ExpandedState expandedState = data.getExpandedState();\n+          final boolean oldExpanded = expandedState.isExpanded(path);\n+          final boolean newExpanded = expandedIndices.contains(rowIndex);\n+          if (newExpanded != oldExpanded) {\n+            if (newExpanded) {\n+              expandedState.expand(path);\n+            } else {\n+              expandedState.collapse(path);\n+            }\n           }\n         }\n       }", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/72224c77c108107f4092528603d9bd4e048d9093", "parent": "https://github.com/apache/myfaces-tobago/commit/9d1c6b562fa351db6ea0ebaa26749eaa626cad16", "message": "prevent NPE", "bug_id": "myfaces-tobago_19", "file": [{"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/72224c77c108107f4092528603d9bd4e048d9093/example/demo/src/main/java/org/apache/myfaces/tobago/example/demo/Navigation.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/72224c77c108107f4092528603d9bd4e048d9093/example/demo/src/main/java/org/apache/myfaces/tobago/example/demo/Navigation.java", "sha": "d0dc3c891d7a9a9018b9fb1515af75cf4175508b", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/example/demo/src/main/java/org/apache/myfaces/tobago/example/demo/Navigation.java?ref=72224c77c108107f4092528603d9bd4e048d9093", "patch": "@@ -159,11 +159,11 @@ public String gotoNext() {\n   }\n \n   public boolean isFirst() {\n-    return state.getMarker().getPreviousNode().isRoot();\n+    return state.getMarker() != null && state.getMarker().getPreviousNode().isRoot();\n   }\n \n   public boolean isLast() {\n-    return state.getMarker().getNextNode() == null;\n+    return state.getMarker() != null && state.getMarker().getNextNode() == null;\n   }\n \n   public String viewSource() {", "filename": "example/demo/src/main/java/org/apache/myfaces/tobago/example/demo/Navigation.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/bbba9b7520b633485a1a7c63e748d1ccad800efa", "parent": "https://github.com/apache/myfaces-tobago/commit/70bdf835e624863e1417fd8ca743453ff25ef91c", "message": "avoid NPE", "bug_id": "myfaces-tobago_20", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/bbba9b7520b633485a1a7c63e748d1ccad800efa/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/FormRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/bbba9b7520b633485a1a7c63e748d1ccad800efa/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/FormRenderer.java", "sha": "a337ee222877abec9372d5d43946107f0009b52a", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/FormRenderer.java?ref=bbba9b7520b633485a1a7c63e748d1ccad800efa", "patch": "@@ -37,7 +37,7 @@ public void decode(FacesContext facesContext, UIComponent component) {\n     UIPage page = ComponentUtil.findPage(form);\n     String actionId = page.getActionId();\n     String clientId = form.getClientId(facesContext);\n-    if (actionId.startsWith(clientId)) {\n+    if (actionId != null && actionId.startsWith(clientId)) {\n       form.setSubmitted(true);\n     }\n     super.decode(facesContext, form);", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/FormRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/3934c3ad30814b7b5c7c48b47444417951a76ec5", "parent": "https://github.com/apache/myfaces-tobago/commit/a6c690955153d7038b269139efe49029be640be9", "message": "avoid NPE", "bug_id": "myfaces-tobago_21", "file": [{"additions": 7, "raw_url": "https://github.com/apache/myfaces-tobago/raw/3934c3ad30814b7b5c7c48b47444417951a76ec5/theme/speyside/src/main/java/org/apache/myfaces/tobago/renderkit/html/speyside/standard/tag/BoxRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/3934c3ad30814b7b5c7c48b47444417951a76ec5/theme/speyside/src/main/java/org/apache/myfaces/tobago/renderkit/html/speyside/standard/tag/BoxRenderer.java", "sha": "efca20cbc33da57a073b84a4e7b73748a63ee877", "changes": 11, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/speyside/src/main/java/org/apache/myfaces/tobago/renderkit/html/speyside/standard/tag/BoxRenderer.java?ref=3934c3ad30814b7b5c7c48b47444417951a76ec5", "patch": "@@ -66,11 +66,14 @@ public void encodeBeginTobago(FacesContext facesContext, UIComponent component)\n     String style = (String) component.getAttributes().get(ATTR_STYLE);\n \n     if (style != null) {\n-      // XXX ???\n-      String heightString = HtmlRendererUtil.getStyleAttributeValue(style, \"height\").replaceAll(\"\\\\D\", \"\");\n \n-      int height = Integer.parseInt(heightString) - 1;\n-      style = HtmlRendererUtil.replaceStyleAttribute(style, \"height\", height + \"px\");\n+      // XXX ???\n+      String str = HtmlRendererUtil.getStyleAttributeValue(style, \"height\");\n+      if (str != null) {\n+        String heightString = str.replaceAll(\"\\\\D\", \"\");\n+        int height = Integer.parseInt(heightString) - 1;\n+        style = HtmlRendererUtil.replaceStyleAttribute(style, \"height\", height + \"px\");\n+      }\n     }\n \n     String clientId = component.getClientId(facesContext);", "filename": "theme/speyside/src/main/java/org/apache/myfaces/tobago/renderkit/html/speyside/standard/tag/BoxRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/042d0daf978ac5818e778dcccedf634c14569ef3", "parent": "https://github.com/apache/myfaces-tobago/commit/3e7a604bd4a102617aefcf597e3d4ce523f80aad", "message": "avoid NPE", "bug_id": "myfaces-tobago_22", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/042d0daf978ac5818e778dcccedf634c14569ef3/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/DatePickerRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/042d0daf978ac5818e778dcccedf634c14569ef3/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/DatePickerRenderer.java", "sha": "312978929f8e795fc9dce6c0de4cf7c9f8187d13", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/DatePickerRenderer.java?ref=042d0daf978ac5818e778dcccedf634c14569ef3", "patch": "@@ -102,7 +102,7 @@ public void encodeBeginTobago(FacesContext facesContext,\n   private void applyConverterPattern(UIPopup popup, String converterPattern) {\n     UIComponent box = (UIComponent) popup.getChildren().get(0);\n     UIComponent timePanel = box.findComponent(\"timePanel\");\n-    if (converterPattern.indexOf('h') > -1 || converterPattern.indexOf('H') > -1) {\n+    if (converterPattern != null && (converterPattern.indexOf('h') > -1 || converterPattern.indexOf('H') > -1)) {\n       if (converterPattern.indexOf('s') > -1) {\n         UIComponent time = timePanel.findComponent(\"time\");\n         time.getAttributes().put(ATTR_POPUP_CALENDAR_FORCE_TIME, true);", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/DatePickerRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/17343374caad12c29bbf5fc2b800f93de0397b24", "parent": "https://github.com/apache/myfaces-tobago/commit/b4bd58bf4a434ae80b582acc2a0a36c2937118c7", "message": "fix NPE", "bug_id": "myfaces-tobago_23", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/17343374caad12c29bbf5fc2b800f93de0397b24/core/src/main/java/org/apache/myfaces/tobago/taglib/component/TabChangeListenerTag.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/17343374caad12c29bbf5fc2b800f93de0397b24/core/src/main/java/org/apache/myfaces/tobago/taglib/component/TabChangeListenerTag.java", "sha": "4ac9b4d54e47094ed97d1c86b1199d2c3e1da047", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/taglib/component/TabChangeListenerTag.java?ref=17343374caad12c29bbf5fc2b800f93de0397b24", "patch": "@@ -99,7 +99,7 @@ public int doStartTag() throws JspException {\n \n     TabChangeListener handler = null;\n \n-    if (UIComponentTag.isValueReference(binding)) {\n+    if (binding != null && UIComponentTag.isValueReference(binding)) {\n       ValueBinding valueBinding = ComponentUtil.createValueBinding(binding);\n       if (valueBinding != null) {\n         Object obj = valueBinding.getValue(FacesContext.getCurrentInstance());", "filename": "core/src/main/java/org/apache/myfaces/tobago/taglib/component/TabChangeListenerTag.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/f80ba288bbd49f5524d2f55c26ae635ae462c135", "parent": "https://github.com/apache/myfaces-tobago/commit/339486c62044113dbaee1299de3ca43f917f8d96", "message": "fixing NPE when there is no UITreeSelect", "bug_id": "myfaces-tobago_24", "file": [{"additions": 14, "raw_url": "https://github.com/apache/myfaces-tobago/raw/f80ba288bbd49f5524d2f55c26ae635ae462c135/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/f80ba288bbd49f5524d2f55c26ae635ae462c135/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java", "sha": "4ddb839f67c9f00572a02804ad36d26ef7d8a024", "changes": 17, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java?ref=f80ba288bbd49f5524d2f55c26ae635ae462c135", "patch": "@@ -20,6 +20,7 @@\n package org.apache.myfaces.tobago.renderkit.html.standard.standard.tag;\n \n import org.apache.myfaces.tobago.component.RendererTypes;\n+import org.apache.myfaces.tobago.component.UITreeLabel;\n import org.apache.myfaces.tobago.component.UITreeNode;\n import org.apache.myfaces.tobago.component.UITreeSelect;\n import org.apache.myfaces.tobago.internal.component.AbstractUITree;\n@@ -174,11 +175,21 @@ private void encodeSelectBox(\n     writer.writeAttribute(HtmlAttributes.SIZE, 9); // must be > 1, but the real size comes from the layout\n //    writer.writeAttribute(HtmlAttributes.MULTIPLE, siblingMode);\n \n-    final UITreeSelect label = ComponentUtils.findDescendant(tree, UITreeSelect.class);\n-    final Object labelValue = label.getLabel();\n+    final UITreeSelect select = ComponentUtils.findDescendant(tree, UITreeSelect.class);\n+    final String labelValue;\n+    if (select != null) {\n+      labelValue = select.getLabel();\n+    } else {\n+      final UITreeLabel label = ComponentUtils.findDescendant(tree, UITreeLabel.class);\n+      if (label != null) {\n+        labelValue = label.getLabel();\n+      } else {\n+        labelValue = null;\n+      }\n+    }\n     if (labelValue != null) {\n       writer.startElement(HtmlElements.OPTGROUP, tree);\n-      writer.writeAttribute(HtmlAttributes.LABEL, labelValue.toString(), true);\n+      writer.writeAttribute(HtmlAttributes.LABEL, labelValue, true);\n       writer.endElement(HtmlElements.OPTGROUP);\n     }\n ", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/ffede0ac44bd0ee26493d87d218a4d99ed02c340", "parent": "https://github.com/apache/myfaces-tobago/commit/06cacc465e26d977b2f61ac44258f6b757268eb0", "message": "+ cleanup\n+ toString NPE aware", "bug_id": "myfaces-tobago_25", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/ffede0ac44bd0ee26493d87d218a4d99ed02c340/core/src/main/java/org/apache/myfaces/tobago/component/AbstractUIGridLayout.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/ffede0ac44bd0ee26493d87d218a4d99ed02c340/core/src/main/java/org/apache/myfaces/tobago/component/AbstractUIGridLayout.java", "sha": "546578a4e8cfc3a437abb50c7293faa076438b56", "changes": 20, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/component/AbstractUIGridLayout.java?ref=ffede0ac44bd0ee26493d87d218a4d99ed02c340", "patch": "@@ -19,7 +19,6 @@\n \n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n-import org.apache.myfaces.tobago.OnComponentCreated;\n import org.apache.myfaces.tobago.layout.AutoLayoutToken;\n import org.apache.myfaces.tobago.layout.Display;\n import org.apache.myfaces.tobago.layout.FactorList;\n@@ -41,24 +40,17 @@\n import org.apache.myfaces.tobago.layout.grid.OriginCell;\n import org.apache.myfaces.tobago.layout.math.EquationManager;\n \n-import javax.faces.component.UIComponent;\n-import javax.faces.context.FacesContext;\n import java.util.Arrays;\n import java.util.List;\n \n-public abstract class AbstractUIGridLayout extends UILayout implements OnComponentCreated, LayoutManager {\n+public abstract class AbstractUIGridLayout extends UILayout implements LayoutManager {\n \n   private static final Log LOG = LogFactory.getLog(AbstractUIGridLayout.class);\n \n   private Grid grid;\n \n-  public void onComponentCreated(FacesContext context, UIComponent component) {\n-  }\n-\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n   // /////////////////////////////////////////////////////////////////////////////////////////\n+  // new layout mechanism\n   // /////////////////////////////////////////////////////////////////////////////////////////\n \n   public void init() {\n@@ -272,9 +264,7 @@ public void postProcessing(boolean orientation) {\n   }\n \n   // /////////////////////////////////////////////////////////////////////////////////////////\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n-  // /////////////////////////////////////////////////////////////////////////////////////////\n+  // layout mechanism with equations\n   // /////////////////////////////////////////////////////////////////////////////////////////\n \n   /**\n@@ -511,6 +501,8 @@ public boolean getRendersChildren() {\n   @Override\n   public String toString() {\n     return getClass().getSimpleName()\n-        + \"(\" + Arrays.toString(grid.getWidths()) + \", \" + Arrays.toString(grid.getHeights()) + \")\";\n+        + (grid != null\n+        ? \"(\" + Arrays.toString(grid.getWidths()) + \", \" + Arrays.toString(grid.getHeights()) + \")\" \n+        : \"\");\n   }\n }", "filename": "core/src/main/java/org/apache/myfaces/tobago/component/AbstractUIGridLayout.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/6d3126df3c263b235e6ebcb20946213ec1ad765c", "parent": "https://github.com/apache/myfaces-tobago/commit/eb9619fb4c18eb55e7d09c090b0ee19eb98aac70", "message": "TOBAGO-1359: NPE when rendering sheet", "bug_id": "myfaces-tobago_26", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/6d3126df3c263b235e6ebcb20946213ec1ad765c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/6d3126df3c263b235e6ebcb20946213ec1ad765c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "sha": "82d4f2591f0c23ab05016009a1cf1dc6bdf132d1", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java?ref=6d3126df3c263b235e6ebcb20946213ec1ad765c", "patch": "@@ -435,7 +435,7 @@ private void renderSheet(\n         columnIndex++;\n         writer.startElement(HtmlElements.TD, null);\n         writer.startElement(HtmlElements.DIV, null);\n-        final Integer divWidth = sheet.getWidthList().get(columnIndex);\n+        final Integer divWidth = sheet.getWidthList() != null ? sheet.getWidthList().get(columnIndex) : 100;\n         final Style divStyle = new Style();\n         divStyle.setWidth(Measure.valueOf(divWidth));\n         writer.writeStyleAttribute(divStyle);", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/f98d25b2a3804ef693a1331461cd17e8ff851e37", "parent": "https://github.com/apache/myfaces-tobago/commit/86545423c14a1a62e9f24e32f2c36dc4e68fc212", "message": "TOBAGO-1321 - NPE in UserAgent.hasCapability", "bug_id": "myfaces-tobago_27", "file": [{"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/f98d25b2a3804ef693a1331461cd17e8ff851e37/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/f98d25b2a3804ef693a1331461cd17e8ff851e37/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "sha": "8644bf1ff01ccaeba6a0ec5e07a89c8cb9ee2340", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java?ref=f98d25b2a3804ef693a1331461cd17e8ff851e37", "patch": "@@ -55,10 +55,10 @@\n   public static final UserAgent MSIE_5_5 = new UserAgent(\"msie\", \"5_5\");\n \n   public static final UserAgent MSIE_6_0\n-      = new UserAgent(\"msie\", \"6_0\", null, CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n+      = new UserAgent(\"msie\", \"6_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n \n   public static final UserAgent MSIE_7_0\n-      = new UserAgent(\"msie\", \"7_0\", null, CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n+      = new UserAgent(\"msie\", \"7_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n \n   public static final UserAgent MSIE_7_0_COMPAT = new UserAgent(\n       \"msie\", \"7_0\", EnumSet.of(Capability.IE_COMPATIBILITY_MODE), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/f8b990404fdcbf63aca71c07513a6fcf050bf2c8", "parent": "https://github.com/apache/myfaces-tobago/commit/87c94bf0aae74ca02d2d24be28ccfeef40f26d06", "message": "(TOBAGO-606) fix possible NPE", "bug_id": "myfaces-tobago_28", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/f8b990404fdcbf63aca71c07513a6fcf050bf2c8/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/LayoutTokens.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/f8b990404fdcbf63aca71c07513a6fcf050bf2c8/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/LayoutTokens.java", "sha": "ed369b480ae23c52489a43d16ec7b49631329a23", "changes": 7, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/LayoutTokens.java?ref=f8b990404fdcbf63aca71c07513a6fcf050bf2c8", "patch": "@@ -113,9 +113,12 @@ public static LayoutToken parseToken(String token) {\n     try {\n       if (\"*\".equals(token)) {\n         return RelativeLayoutToken.DEFAULT_INSTANCE;\n-      } else if (token.equals(\"fixed\") || token.equals(\"auto\")) {\n+      } else if (token == null) {\n+        LOG.error(\"Empty layout token! Using 'auto' instead.\");\n         return AutoLayoutToken.INSTANCE;\n-      } else if (token.equals(\"minimum\")) {\n+      } else if (\"fixed\".equals(token) || \"auto\".equals(token)) {\n+        return AutoLayoutToken.INSTANCE;\n+      } else if (\"minimum\".equals(token)) {\n         return new MinimumLayoutToken();\n       } else if (isPixelToken(token)) {\n         return new PixelLayoutToken(Integer.parseInt(removeSuffix(token, PixelLayoutToken.SUFFIX)));", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/layout/LayoutTokens.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/f8b990404fdcbf63aca71c07513a6fcf050bf2c8/tobago-core/src/test/java/org/apache/myfaces/tobago/layout/LayoutTokensUnitTest.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/f8b990404fdcbf63aca71c07513a6fcf050bf2c8/tobago-core/src/test/java/org/apache/myfaces/tobago/layout/LayoutTokensUnitTest.java", "sha": "ec97d3d6e6b9762b3b4cf293477530acb9284a3c", "changes": 1, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/test/java/org/apache/myfaces/tobago/layout/LayoutTokensUnitTest.java?ref=f8b990404fdcbf63aca71c07513a6fcf050bf2c8", "patch": "@@ -46,6 +46,7 @@ public void testIsNumberAndSuffix() {\n \n   @Test\n   public void testParseToken() {\n+    Assert.assertEquals(AutoLayoutToken.INSTANCE, LayoutTokens.parseToken(null));\n     Assert.assertEquals(RelativeLayoutToken.DEFAULT_INSTANCE, LayoutTokens.parseToken(\"*\"));\n     Assert.assertEquals(new RelativeLayoutToken(3), LayoutTokens.parseToken(\"3*\"));\n     Assert.assertEquals(new PercentLayoutToken(33), LayoutTokens.parseToken(\"33%\"));", "filename": "tobago-core/src/test/java/org/apache/myfaces/tobago/layout/LayoutTokensUnitTest.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba", "parent": "https://github.com/apache/myfaces-tobago/commit/4940d7e59666f675e11a679ff59d12cfa059db1e", "message": "avoid NPE if render Messages", "bug_id": "myfaces-tobago_29", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessageRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessageRenderer.java", "sha": "b004c40c5bf58c88024897cd179481adbe89c458", "changes": 7, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessageRenderer.java?ref=3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba", "patch": "@@ -84,7 +84,12 @@ public void encodeEnd(FacesContext facesContext,\n       writer.startElement(HtmlConstants.LABEL, null);\n       writer.writeAttribute(HtmlAttributes.FOR, clientId, null);\n       writer.writeAttribute(HtmlAttributes.TITLE, message.getDetail(), null);\n-      writer.writeText(message.getSummary(), null);\n+      String summary = message.getSummary();\n+      if (summary != null) {\n+        writer.writeText(summary, null);\n+      } else {\n+        writer.writeText(\"\", null);\n+      }\n       writer.endElement(HtmlConstants.LABEL);\n \n       writer.startElement(HtmlConstants.BR, null);", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessageRenderer.java"}, {"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessagesRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessagesRenderer.java", "sha": "4b2df9d763dc475817f6940f4f5eca61d7bd8d84", "changes": 7, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessagesRenderer.java?ref=3d46040cb1495b4fc92fc9d3fc91d5d0b36950ba", "patch": "@@ -117,7 +117,12 @@ private void encodeMessage(ResponseWriter writer, FacesMessage message,\n       writer.writeAttribute(HtmlAttributes.FOR, clientId, null);\n     }\n     writer.writeAttribute(HtmlAttributes.TITLE, message.getDetail(), null);\n-    writer.writeText(message.getSummary(), null);\n+    String summary = message.getSummary();\n+    if (summary != null) {\n+      writer.writeText(summary, null);\n+    } else {\n+      writer.writeText(\"\", null);\n+    }\n     writer.endElement(HtmlConstants.LABEL);\n     writer.startElement(HtmlConstants.BR, null);\n     writer.endElement(HtmlConstants.BR);", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/MessagesRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/4159d5af364c99027ff7470b698927dfb1b81e30", "parent": "https://github.com/apache/myfaces-tobago/commit/4a88dcf69fd7f9edc37f1333874d956e9dd49fc3", "message": "Merged from trunk\nTOBAGO-1505: NPE while rendering Session Secret [from revision 1709006]", "bug_id": "myfaces-tobago_30", "file": [{"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/4159d5af364c99027ff7470b698927dfb1b81e30/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/4159d5af364c99027ff7470b698927dfb1b81e30/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java", "sha": "00dce7952d0754305ad3b7929f1f4ee55df039fe", "changes": 18, "status": "modified", "deletions": 9, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java?ref=4159d5af364c99027ff7470b698927dfb1b81e30", "patch": "@@ -82,6 +82,11 @@ public static boolean check(final FacesContext facesContext) {\n     final Map requestParameterMap = facesContext.getExternalContext().getRequestParameterMap();\n     final String fromRequest = (String) requestParameterMap.get(Secret.KEY);\n     final Object session = facesContext.getExternalContext().getSession(false);\n+    Secret secret = getSecret(session);\n+    return secret != null && secret.secret.equals(fromRequest);\n+  }\n+\n+  private static Secret getSecret(Object session) {\n     Secret secret = null;\n     if (session!=null) {\n       if (session instanceof HttpSession) {\n@@ -92,7 +97,7 @@ public static boolean check(final FacesContext facesContext) {\n         throw new IllegalArgumentException(\"Unknown session type: \" + session);\n       }\n     }\n-    return secret != null && secret.secret.equals(fromRequest);\n+    return secret;\n   }\n \n   /**\n@@ -104,15 +109,10 @@ public static void encode(final FacesContext facesContext, final TobagoResponseW\n     writer.writeAttribute(HtmlAttributes.NAME, Secret.KEY, false);\n     writer.writeAttribute(HtmlAttributes.ID, Secret.KEY, false);\n     final Object session = facesContext.getExternalContext().getSession(true);\n-    final Secret secret;\n-    if (session instanceof HttpSession) {\n-      secret = (Secret) ((HttpSession) session).getAttribute(Secret.KEY);\n-    } else if (PortletUtils.isPortletApiAvailable() && session instanceof PortletSession) {\n-      secret = (Secret) ((PortletSession) session).getAttribute(Secret.KEY, PortletSession.APPLICATION_SCOPE);\n-    } else {\n-      throw new IllegalArgumentException(\"Unknown session type: \" + session);\n+    final Secret secret = getSecret(session);\n+    if (secret != null) {\n+      writer.writeAttribute(HtmlAttributes.VALUE, secret.secret, false);\n     }\n-    writer.writeAttribute(HtmlAttributes.VALUE, secret.secret, false);\n     writer.endElement(HtmlElements.INPUT);\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/webapp/Secret.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "parent": "https://github.com/apache/myfaces-tobago/commit/b5dba1e5018e724ca50c138117fa083f26fbc151", "message": "TOBAGO-296: NPE when client supports wml", "bug_id": "myfaces-tobago_31", "file": [{"additions": 19, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/config/ThemeConfig.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/config/ThemeConfig.java", "sha": "c55dcd1f767f5fabb18700a1268d9181f0a3c3aa", "changes": 27, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/config/ThemeConfig.java?ref=27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "patch": "@@ -46,18 +46,26 @@ public static int getValue(FacesContext facesContext, UIComponent component,\n       String name) {\n \n     CacheKey key = new CacheKey(facesContext.getViewRoot(), component, name);\n-    Map cache = (Map) facesContext.getExternalContext()\n-        .getApplicationMap().get(THEME_CONFIG_CACHE);\n+    Map<CacheKey, Integer> cache\n+        = (Map<CacheKey, Integer>) facesContext.getExternalContext().getApplicationMap().get(THEME_CONFIG_CACHE);\n \n-    Integer value = (Integer) cache.get(key);\n+    Integer value = cache.get(key);\n     if (value == null) {\n       value = createValue(facesContext, component, name);\n       cache.put(key, value);\n     }\n-    return value.intValue();\n+    if (value != null) {\n+      return value;\n+    } else {\n+      // todo: remove condition, is only temporary to ignore wml errors.\n+      if (! ClientProperties.getInstance(facesContext.getViewRoot()).getContentType().equals(\"wml\")) {\n+        throw new NullPointerException(\"No value configured\");\n+      }\n+      // todo: remove, is only temporary to ignore wml errors.\n+      return 0;\n+    }\n   }\n \n-\n   private static Integer createValue(FacesContext facesContext,\n       UIComponent component, String name) {\n     String family;\n@@ -95,9 +103,12 @@ private static Integer createValue(FacesContext facesContext,\n       }\n       clazz = clazz.getSuperclass();\n     }\n-    LOG.error(\"Theme property not found for renderer: \" + renderer.getClass()\n-        + \" with clientProperties='\" + ClientProperties.getInstance(viewRoot).getId() + \"'\"\n-        + \" and locale='\" + viewRoot.getLocale() + \"'\");\n+    // todo: remove condition, is only temporary to ignore wml errors.\n+    if (! ClientProperties.getInstance(viewRoot).getContentType().equals(\"wml\")) {\n+      LOG.error(\"Theme property not found for renderer: \" + renderer.getClass()\n+          + \" with clientProperties='\" + ClientProperties.getInstance(viewRoot).getId() + \"'\"\n+          + \" and locale='\" + viewRoot.getLocale() + \"'\");\n+    }\n     return null;\n   }\n ", "filename": "core/src/main/java/org/apache/myfaces/tobago/config/ThemeConfig.java"}, {"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/context/ResourceManagerImpl.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/context/ResourceManagerImpl.java", "sha": "2872d7941ef6b01fee7b2478e137d3cdf2b777a8", "changes": 20, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/context/ResourceManagerImpl.java?ref=27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "patch": "@@ -357,13 +357,9 @@ public Renderer getRenderer(UIViewRoot viewRoot, String name) {\n     final String clientPropertyId;\n     final Locale locale;\n     final String type = \"tag\";\n-//    final Object key;\n     CacheKey key;\n     if (name != null) {\n       if (viewRoot instanceof org.apache.myfaces.tobago.component.UIViewRoot) {\n-//        key = new StringBuilder(((org.apache.myfaces.tobago.component.UIViewRoot)viewRoot)\n-//            .getRendererCachePrefix()).append(name).toString();\n-//      key = new RendererCacheKey(clientPropertyId, locale, name);\n         key = ((org.apache.myfaces.tobago.component.UIViewRoot) viewRoot).getRendererCacheKey();\n         key.setName(name);\n         renderer = (Renderer) cache.get(key);\n@@ -377,7 +373,6 @@ public Renderer getRenderer(UIViewRoot viewRoot, String name) {\n       } else {\n         clientPropertyId = ClientProperties.getInstance(viewRoot).getId();\n         locale = viewRoot.getLocale();\n-//      key = key(clientPropertyId, locale, type, name);\n \n         key = new CacheKey(clientPropertyId, locale, name, CacheType.RENDERER);\n         renderer = (Renderer) cache.get(key);\n@@ -390,22 +385,19 @@ public Renderer getRenderer(UIViewRoot viewRoot, String name) {\n \n       try {\n         name = getRendererClassName(name);\n-        Class clazz = null;\n-        List classes =  getPaths(clientPropertyId, locale, \"\", type, name,\n-            \"\", false, true, true, null, false, false);\n+        List<Class> classes\n+            = getPaths(clientPropertyId, locale, \"\", type, name, \"\", false, true, true, null, false, false);\n         if (classes != null && classes.size() > 0) {\n-          clazz = (Class) classes.get(0);\n+          Class clazz = classes.get(0);\n+          renderer = (Renderer) clazz.newInstance();\n+          cache.put(key, renderer);\n         } else {\n-          throw new RuntimeException(\"Don't find any RendererClass for \" + name + \". Please check you configuration.\");\n+          LOG.error(\"Don't find any RendererClass for \" + name + \". Please check you configuration.\");\n         }\n-        renderer = (Renderer) clazz.newInstance();\n-        cache.put(key, renderer);\n       } catch (InstantiationException e) {\n         LOG.error(\"name = '\" + name + \"' clientProperties = '\" + clientPropertyId + \"'\", e);\n-        throw new RuntimeException(name, e);\n       } catch (IllegalAccessException e) {\n         LOG.error(\"name = '\" + name + \"' clientProperties = '\" + clientPropertyId + \"'\", e);\n-        throw new RuntimeException(name, e);\n       }\n     }\n     return renderer;", "filename": "core/src/main/java/org/apache/myfaces/tobago/context/ResourceManagerImpl.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/renderkit/TobagoRenderKit.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/core/src/main/java/org/apache/myfaces/tobago/renderkit/TobagoRenderKit.java", "sha": "a3403cb51fdcf048b3bd734806b5377f7603a6b0", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/renderkit/TobagoRenderKit.java?ref=27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "patch": "@@ -71,7 +71,7 @@ public Renderer getRenderer(String family, String rendererType) {\n     }\n     if (renderer == null) {\n       LOG.error(\"The class witch was found by the ResourceManager can't be \"\n-          + \"found, or instanciated: classname='\" + rendererType + \"'\");\n+          + \"found, or instanciated: rendererType='\" + rendererType + \"'\");\n     }\n     return renderer;\n   }", "filename": "core/src/main/java/org/apache/myfaces/tobago/renderkit/TobagoRenderKit.java"}, {"additions": 80, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/theme/standard/pom.xml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/theme/standard/pom.xml", "sha": "65a3b2b555f230eadb6f82edce98ecdaaf246c59", "changes": 80, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/standard/pom.xml?ref=27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "patch": "@@ -33,4 +33,84 @@\n     <url>http://svn.apache.org/viewcvs.cgi/myfaces/tobago/trunk/theme/standard</url>\n   </scm>\n \n+  <dependencies>\n+    <dependency>\n+      <groupId>org.apache.myfaces.core</groupId>\n+      <artifactId>myfaces-api</artifactId>\n+      <scope>provided</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.myfaces.tobago</groupId>\n+      <artifactId>tobago-core</artifactId>\n+      <version>${project.version}</version>\n+      <exclusions>\n+        <exclusion>\n+          <groupId>sun.jdk</groupId>\n+          <artifactId>tools</artifactId>\n+        </exclusion>\n+      </exclusions>\n+    </dependency>\n+    <dependency>\n+      <groupId>javax.servlet</groupId>\n+      <artifactId>servlet-api</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>junit</groupId>\n+      <artifactId>junit</artifactId>\n+    </dependency>\n+  </dependencies>\n+  <profiles>\n+    <profile>\n+      <id>jdk14retro</id>\n+      <build>\n+        <plugins>\n+          <plugin>\n+            <groupId>org.codehaus.mojo</groupId>\n+            <artifactId>retrotranslator-maven-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>retrotranslate</id>\n+              </execution>\n+            </executions>\n+          </plugin>\n+          <plugin>\n+            <artifactId>maven-jar-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <id>create-jdk14retro-jar</id>\n+                <goals><goal>jar</goal></goals>\n+                <configuration>\n+                  <classesDirectory>${project.build.directory}/classes-retro</classesDirectory>\n+                  <classifier>jdk14retro</classifier>\n+                  <archive>\n+                    <manifestEntries>\n+                      <Extension-Name>${project.artifactId}-jdk14retro</Extension-Name>\n+                      <Specification-Vendor>${project.organization.name}</Specification-Vendor>\n+                      <Implementation-Vendor>${project.organization.name}</Implementation-Vendor>\n+                      <Implementation-Title>${project.description}</Implementation-Title>\n+                      <Implementation-Version>${project.version}</Implementation-Version>\n+                      <Revision>${scm.revision}</Revision>\n+                    </manifestEntries>\n+                   </archive>\n+                </configuration>\n+              </execution>\n+            </executions>\n+          </plugin>\n+        </plugins>\n+      </build>\n+       <dependencies>\n+        <dependency>\n+          <groupId>sun.jdk</groupId>\n+          <artifactId>rt</artifactId>\n+          <version>1.4.0</version>\n+          <scope>system</scope>\n+          <systemPath>${java14.home}/lib/rt.jar</systemPath>\n+        </dependency>\n+        <dependency>\n+          <groupId>net.sf.retrotranslator</groupId>\n+          <artifactId>retrotranslator-runtime</artifactId>\n+        </dependency>\n+      </dependencies>\n+    </profile>\n+  </profiles>\n </project>\n\\ No newline at end of file", "filename": "theme/standard/pom.xml"}, {"additions": 76, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/theme/standard/src/main/java/org/apache/myfaces/tobago/renderkit/wml/standard/standard/tag/PageRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27cfdbd6de1694a83bc1ce4cef3da0a9404273cd/theme/standard/src/main/java/org/apache/myfaces/tobago/renderkit/wml/standard/standard/tag/PageRenderer.java", "sha": "c25cccb896258c98385daba45902cf72ee93e2a4", "changes": 76, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/standard/src/main/java/org/apache/myfaces/tobago/renderkit/wml/standard/standard/tag/PageRenderer.java?ref=27cfdbd6de1694a83bc1ce4cef3da0a9404273cd", "patch": "@@ -0,0 +1,76 @@\n+package org.apache.myfaces.tobago.renderkit.wml.standard.standard.tag;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+import org.apache.myfaces.tobago.component.UIPage;\n+import org.apache.myfaces.tobago.renderkit.PageRendererBase;\n+import org.apache.myfaces.tobago.webapp.TobagoResponseWriter;\n+\n+import javax.faces.component.UIComponent;\n+import javax.faces.context.FacesContext;\n+import java.io.IOException;\n+\n+public class PageRenderer extends PageRendererBase {\n+\n+  private static final String DOCTYPE =\n+      \"<?xml version='1.0'?>\\n\"\n+          + \"<!DOCTYPE wml PUBLIC '-//WAPFORUM//DTD WML 1.1//EN'\\n\"\n+          + \" 'http://www.wapforum.org/DTD/wml_1.1.xml'>\";\n+\n+  @Override\n+  public void encodeBegin(FacesContext facesContext, UIComponent component) throws IOException {\n+  }\n+\n+  @Override\n+  public void encodeChildren(FacesContext facesContext, UIComponent component) throws IOException {\n+  }\n+\n+  @Override\n+  public void encodeEnd(FacesContext facesContext, UIComponent component)\n+      throws IOException {\n+\n+    UIPage page = (UIPage) component;\n+\n+    TobagoResponseWriter writer\n+        = (TobagoResponseWriter) facesContext.getResponseWriter();\n+\n+    // reset responseWriter and render page\n+    facesContext.setResponseWriter(writer);\n+\n+    writer.write(DOCTYPE);\n+    writer.write('\\n');\n+\n+    writer.startElement(\"wml\", page);\n+    writer.startElement(\"card\", page);\n+\n+    writer.writeText(\"WML currently not supported!\", null);\n+//    writer.write(content.toString());\n+\n+    writer.endElement(\"card\");\n+    writer.endElement(\"wml\");\n+\n+    // fixme, this is only a workaround for bug TOBAGO-296\n+    facesContext.responseComplete();\n+  }\n+\n+  @Override\n+  public boolean getRendersChildren() {\n+    // fixme, this is only a workaround for bug TOBAGO-296\n+    return true;\n+  }\n+}", "filename": "theme/standard/src/main/java/org/apache/myfaces/tobago/renderkit/wml/standard/standard/tag/PageRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/67651073d66a2d58ce2f7a46100af518fd8f19c0", "parent": "https://github.com/apache/myfaces-tobago/commit/49299af9c0caf0766bc74fb0239729f6028f75b5", "message": "fixed possible npe\nadded missing admin method", "bug_id": "myfaces-tobago_32", "file": [{"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/67651073d66a2d58ce2f7a46100af518fd8f19c0/example/security/src/main/java/org/apache/myfaces/tobago/example/security/CheckAuthorisationMethodBinding.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/67651073d66a2d58ce2f7a46100af518fd8f19c0/example/security/src/main/java/org/apache/myfaces/tobago/example/security/CheckAuthorisationMethodBinding.java", "sha": "c4df7635409107907f184ae8e1aa9a8009f0a685", "changes": 7, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/example/security/src/main/java/org/apache/myfaces/tobago/example/security/CheckAuthorisationMethodBinding.java?ref=67651073d66a2d58ce2f7a46100af518fd8f19c0", "patch": "@@ -70,7 +70,7 @@ public Object invoke(FacesContext facesContext, Object[] objects)\n       LOG.debug(\"MethodBinding invoke \" + getExpressionString());\n     }\n     // Methodbindings with a argument list would not be checked for authorisation\n-    if (isAuthorized(facesContext) || objects.length > 0) {\n+    if (isAuthorized(facesContext) || (objects!=null && objects.length > 0)) {\n       return methodBinding.invoke(facesContext, objects);\n     } else {\n       // TODO better message\n@@ -172,10 +172,7 @@ public void restoreState(FacesContext facesContext, Object savedState) {\n   }\n \n   public boolean isTransient() {\n-    if (methodBinding instanceof StateHolder) {\n-      return ((StateHolder)methodBinding).isTransient();\n-    }\n-    return false;\n+    return methodBinding instanceof StateHolder && ((StateHolder) methodBinding).isTransient();\n   }\n \n   public void setTransient(boolean bool) {", "filename": "example/security/src/main/java/org/apache/myfaces/tobago/example/security/CheckAuthorisationMethodBinding.java"}, {"additions": 7, "raw_url": "https://github.com/apache/myfaces-tobago/raw/67651073d66a2d58ce2f7a46100af518fd8f19c0/example/security/src/main/java/org/apache/myfaces/tobago/example/security/Controller.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/67651073d66a2d58ce2f7a46100af518fd8f19c0/example/security/src/main/java/org/apache/myfaces/tobago/example/security/Controller.java", "sha": "e04023a9a74be708d7aef166ee81d9b2534f1abd", "changes": 8, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/example/security/src/main/java/org/apache/myfaces/tobago/example/security/Controller.java?ref=67651073d66a2d58ce2f7a46100af518fd8f19c0", "patch": "@@ -31,7 +31,8 @@ public String logout() {\n     }\n     return \"logout\";\n   }\n-  @RolesAllowed({ \"tobago-example-security\" } )\n+\n+  @RolesAllowed({ \"tobago-example-security\" })\n   public String doSomething() {\n     return null;\n   }\n@@ -40,4 +41,9 @@ public String doSomethingElse() {\n     return null;\n   }\n \n+  @RolesAllowed({ \"tobago-example-security\" })  \n+  public String admin() {\n+    return null;\n+  }\n+\n }", "filename": "example/security/src/main/java/org/apache/myfaces/tobago/example/security/Controller.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/68207bedaa285818b1eff515a39707c073c31747", "parent": "https://github.com/apache/myfaces-tobago/commit/bd0b24e4137bedb1da3f593c55ac9b168e100e21", "message": "TOBAGO-1365: NPE in PageRenderer, when applicationIcon wasn't found", "bug_id": "myfaces-tobago_33", "file": [{"additions": 17, "raw_url": "https://github.com/apache/myfaces-tobago/raw/68207bedaa285818b1eff515a39707c073c31747/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/68207bedaa285818b1eff515a39707c073c31747/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java", "sha": "51f52af5a8ac9388d6751fb4ca329b22a1e5f2ef", "changes": 30, "status": "modified", "deletions": 13, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java?ref=68207bedaa285818b1eff515a39707c073c31747", "patch": "@@ -232,26 +232,30 @@ public void encodeBegin(final FacesContext facesContext, final UIComponent compo\n         checkDuplicates(theme.getStyleResources(productionMode), FacesContextUtils.getStyleFiles(facesContext));\n       }\n \n-      String icon = page.getApplicationIcon();\n+      final String icon = page.getApplicationIcon();\n       if (icon != null) {\n-        // XXX unify with image renderer\n+        final String href;\n         if (ResourceManagerUtils.isAbsoluteResource(icon)) {\n-          // absolute Path to image : nothing to do\n+          href = icon;\n         } else {\n-          icon = ResourceManagerUtils.getImageWithPath(facesContext, icon);\n+          href = ResourceManagerUtils.getImageWithPath(facesContext, icon);\n         }\n \n-        writer.startElement(HtmlElements.LINK, null);\n-        if (icon.endsWith(\".ico\")) {\n-          writer.writeAttribute(HtmlAttributes.REL, \"shortcut icon\", false);\n-          writer.writeAttribute(HtmlAttributes.HREF, icon, false);\n+        if (href != null) {\n+          writer.startElement(HtmlElements.LINK, null);\n+          if (href.endsWith(\".ico\")) {\n+            writer.writeAttribute(HtmlAttributes.REL, \"shortcut icon\", false);\n+            writer.writeAttribute(HtmlAttributes.HREF, href, false);\n+          } else {\n+            // XXX IE only supports ICO files for favicons\n+            writer.writeAttribute(HtmlAttributes.REL, \"icon\", false);\n+            writer.writeAttribute(HtmlAttributes.TYPE, MimeTypeUtils.getMimeTypeForFile(href), false);\n+            writer.writeAttribute(HtmlAttributes.HREF, href, false);\n+          }\n+          writer.endElement(HtmlElements.LINK);\n         } else {\n-          // XXX IE only supports ICO files for favicons\n-          writer.writeAttribute(HtmlAttributes.REL, \"icon\", false);\n-          writer.writeAttribute(HtmlAttributes.TYPE, MimeTypeUtils.getMimeTypeForFile(icon), false);\n-          writer.writeAttribute(HtmlAttributes.HREF, icon, false);\n+          LOG.warn(\"Application icon '\" + icon + \"' not found!\");\n         }\n-        writer.endElement(HtmlElements.LINK);\n       }\n \n       // style sniplets", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/8305acbc6ddf708691b582bbedb96cee68221549", "parent": "https://github.com/apache/myfaces-tobago/commit/ad1aec2f9ddd60b1699400bc4cd51a9fe07f289c", "message": "TOBAGO-1365: NPE in PageRenderer, when applicationIcon wasn't found", "bug_id": "myfaces-tobago_34", "file": [{"additions": 17, "raw_url": "https://github.com/apache/myfaces-tobago/raw/8305acbc6ddf708691b582bbedb96cee68221549/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/8305acbc6ddf708691b582bbedb96cee68221549/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java", "sha": "51f52af5a8ac9388d6751fb4ca329b22a1e5f2ef", "changes": 30, "status": "modified", "deletions": 13, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java?ref=8305acbc6ddf708691b582bbedb96cee68221549", "patch": "@@ -232,26 +232,30 @@ public void encodeBegin(final FacesContext facesContext, final UIComponent compo\n         checkDuplicates(theme.getStyleResources(productionMode), FacesContextUtils.getStyleFiles(facesContext));\n       }\n \n-      String icon = page.getApplicationIcon();\n+      final String icon = page.getApplicationIcon();\n       if (icon != null) {\n-        // XXX unify with image renderer\n+        final String href;\n         if (ResourceManagerUtils.isAbsoluteResource(icon)) {\n-          // absolute Path to image : nothing to do\n+          href = icon;\n         } else {\n-          icon = ResourceManagerUtils.getImageWithPath(facesContext, icon);\n+          href = ResourceManagerUtils.getImageWithPath(facesContext, icon);\n         }\n \n-        writer.startElement(HtmlElements.LINK, null);\n-        if (icon.endsWith(\".ico\")) {\n-          writer.writeAttribute(HtmlAttributes.REL, \"shortcut icon\", false);\n-          writer.writeAttribute(HtmlAttributes.HREF, icon, false);\n+        if (href != null) {\n+          writer.startElement(HtmlElements.LINK, null);\n+          if (href.endsWith(\".ico\")) {\n+            writer.writeAttribute(HtmlAttributes.REL, \"shortcut icon\", false);\n+            writer.writeAttribute(HtmlAttributes.HREF, href, false);\n+          } else {\n+            // XXX IE only supports ICO files for favicons\n+            writer.writeAttribute(HtmlAttributes.REL, \"icon\", false);\n+            writer.writeAttribute(HtmlAttributes.TYPE, MimeTypeUtils.getMimeTypeForFile(href), false);\n+            writer.writeAttribute(HtmlAttributes.HREF, href, false);\n+          }\n+          writer.endElement(HtmlElements.LINK);\n         } else {\n-          // XXX IE only supports ICO files for favicons\n-          writer.writeAttribute(HtmlAttributes.REL, \"icon\", false);\n-          writer.writeAttribute(HtmlAttributes.TYPE, MimeTypeUtils.getMimeTypeForFile(icon), false);\n-          writer.writeAttribute(HtmlAttributes.HREF, icon, false);\n+          LOG.warn(\"Application icon '\" + icon + \"' not found!\");\n         }\n-        writer.endElement(HtmlElements.LINK);\n       }\n \n       // style sniplets", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/PageRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/7663d0d8684b25286578b209bee42b3b5df1b3f4", "parent": "https://github.com/apache/myfaces-tobago/commit/b2dc6b0ef843ce75aa882484a880159a1dd9354f", "message": "TOBAGO-1345: Remove dependencies to rarely used libraries\nfix NPE", "bug_id": "myfaces-tobago_35", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/7663d0d8684b25286578b209bee42b3b5df1b3f4/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/7663d0d8684b25286578b209bee42b3b5df1b3f4/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "sha": "1fe494d74d5659e722d6c102fde91c9c47727ded", "changes": 5, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java?ref=7663d0d8684b25286578b209bee42b3b5df1b3f4", "patch": "@@ -327,8 +327,11 @@ public static boolean isNotEmpty(final String value) {\n    * Basically taken from commons-lang\n    */\n   public static boolean isBlank(final String string) {\n+    if (string == null) {\n+      return true;\n+    }\n     final int strLen = string.length();\n-    if (string == null || strLen == 0) {\n+    if (strLen == 0) {\n       return true;\n     }\n     for (int i = 0; i < strLen; i++) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/6f8c8dc557b8e63d583c0caa38708e650fee6d79", "parent": "https://github.com/apache/myfaces-tobago/commit/464f06c0a1e32d0c5183c16b38f92a8f87c2f754", "message": "TOBAGO-1321 - NPE in UserAgent.hasCapability: fix checkstyle errors", "bug_id": "myfaces-tobago_36", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/6f8c8dc557b8e63d583c0caa38708e650fee6d79/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/6f8c8dc557b8e63d583c0caa38708e650fee6d79/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "sha": "7aab36814bd64ae9d2bc7fed5cdd1c7e67fb2d63", "changes": 8, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java?ref=6f8c8dc557b8e63d583c0caa38708e650fee6d79", "patch": "@@ -54,11 +54,11 @@\n   @Deprecated\n   public static final UserAgent MSIE_5_5 = new UserAgent(\"msie\", \"5_5\");\n \n-  public static final UserAgent MSIE_6_0\n-      = new UserAgent(\"msie\", \"6_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n+  public static final UserAgent MSIE_6_0 = new UserAgent(\n+      \"msie\", \"6_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n \n-  public static final UserAgent MSIE_7_0\n-      = new UserAgent(\"msie\", \"7_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n+  public static final UserAgent MSIE_7_0 = new UserAgent(\n+      \"msie\", \"7_0\", EnumSet.noneOf(Capability.class), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);\n \n   public static final UserAgent MSIE_7_0_COMPAT = new UserAgent(\n       \"msie\", \"7_0\", EnumSet.of(Capability.IE_COMPATIBILITY_MODE), CspHeader.NOT_SUPPORTED, CsproHeader.NOT_SUPPORTED);", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/c05ad77541a2bc8ba3c13999e946c29c2755bc66", "parent": "https://github.com/apache/myfaces-tobago/commit/0bf08163a9aae90597bdbe9a791c22979b3121f9", "message": "TOBAGO-1238 - NPE on UIComponent getter when rendererType == null", "bug_id": "myfaces-tobago_37", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c05ad77541a2bc8ba3c13999e946c29c2755bc66/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c05ad77541a2bc8ba3c13999e946c29c2755bc66/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java", "sha": "072b23f156fc154e528dcfcc0e489c5b2776181c", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java?ref=c05ad77541a2bc8ba3c13999e946c29c2755bc66", "patch": "@@ -620,7 +620,7 @@ public void decode(FacesContext facesContext, UIComponent component) {\n   }\n \n   private Measure getHeaderHeight(FacesContext facesContext, UISheet sheet) {\n-    int rows = sheet.getHeaderGrid().getRowCount();\n+    int rows = sheet.getHeaderGrid() != null ? sheet.getHeaderGrid().getRowCount() : 0;\n     return sheet.isShowHeader()\n         ? getResourceManager().getThemeMeasure(facesContext, sheet, \"headerHeight\").multiply(rows)\n         : Measure.ZERO;", "filename": "tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/0bf08163a9aae90597bdbe9a791c22979b3121f9", "parent": "https://github.com/apache/myfaces-tobago/commit/bb132259231b418e90c51d2b280a8ebeb5d838fe", "message": "TOBAGO-1238 - NPE on UIComponent getter when rendererType == null", "bug_id": "myfaces-tobago_38", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/AbstractCommandTagDeclaration.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/AbstractCommandTagDeclaration.java", "sha": "cd7f143191264894cdae1af21d2bc725d3fd5fb7", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/AbstractCommandTagDeclaration.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -20,5 +20,5 @@\n package org.apache.myfaces.tobago.internal.taglib.declaration;\n \n public interface AbstractCommandTagDeclaration extends HasAction, HasActionListener, IsImmediateCommand,\n-    HasOnclick, HasLink, HasResource, IsTransition, HasTarget, HasRenderedPartially {\n+    HasOnclick, HasLink, HasResource, IsTransition, HasTarget, HasRenderedPartially, IsDisabled {\n }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/AbstractCommandTagDeclaration.java"}, {"additions": 8, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasMargins.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasMargins.java", "sha": "2096b7c6159ab139f8a749174b67268eaed93c21", "changes": 16, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasMargins.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -31,8 +31,8 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getMargin() != null\\n\"\n-          + \" ? getMargin()\\n\"\n-          + \" : ((MarginValues)getRenderer(getFacesContext())).getMarginLeft(getFacesContext(), this)\")\n+          + \" ? getMargin()\\n : getRendererType() != null\"\n+          + \" ? ((MarginValues)getRenderer(getFacesContext())).getMarginLeft(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginLeft(String margin);\n \n   /**\n@@ -42,8 +42,8 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getMargin() != null\\n\"\n-          + \" ? getMargin()\\n\"\n-          + \" : ((MarginValues)getRenderer(getFacesContext())).getMarginRight(getFacesContext(), this)\")\n+          + \" ? getMargin()\\n : getRendererType() != null\"\n+          + \" ? ((MarginValues)getRenderer(getFacesContext())).getMarginRight(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginRight(String margin);\n \n   /**\n@@ -53,8 +53,8 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getMargin() != null\\n\"\n-          + \" ? getMargin()\\n\"\n-          + \" : ((MarginValues)getRenderer(getFacesContext())).getMarginTop(getFacesContext(), this)\")\n+          + \" ? getMargin()\\n : getRendererType() != null\"\n+          + \" ? ((MarginValues)getRenderer(getFacesContext())).getMarginTop(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginTop(String margin);\n \n   /**\n@@ -64,8 +64,8 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getMargin() != null\\n\"\n-          + \" ? getMargin()\\n\"\n-          + \" : ((MarginValues)getRenderer(getFacesContext())).getMarginBottom(getFacesContext(), this)\")\n+          + \" ? getMargin()\\n : getRendererType() != null\"\n+          + \" ? ((MarginValues)getRenderer(getFacesContext())).getMarginBottom(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginBottom(String margin);\n \n }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasMargins.java"}, {"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasSpacing.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasSpacing.java", "sha": "8d2df8d2d3d12b8b3ccff11dc6d416dcb9553a54", "changes": 9, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasSpacing.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -43,8 +43,9 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getCellspacing() != null\\n\" \n-          + \" ? getCellspacing()\\n\"\n-          + \" : ((SpacingValues)getRenderer(getFacesContext())).getColumnSpacing(getFacesContext(), this)\")\n+          + \" ? getCellspacing()\\n : getRendererType() != null\"\n+          + \" ? ((SpacingValues)getRenderer(getFacesContext())).getColumnSpacing(getFacesContext(), this)\"\n+          + \" : Measure.ZERO\")\n   void setColumnSpacing(String columnSpacing);\n \n   /**\n@@ -54,7 +55,7 @@\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n       defaultCode = \"getCellspacing() != null\\n\" \n-          + \" ? getCellspacing()\\n\" \n-          + \" : ((SpacingValues)getRenderer(getFacesContext())).getRowSpacing(getFacesContext(), this)\")\n+          + \" ? getCellspacing()\\n : getRendererType() != null\"\n+          + \" ? ((SpacingValues)getRenderer(getFacesContext())).getRowSpacing(getFacesContext(), this) : Measure.ZERO\")\n   void setRowSpacing(String rowSpacing);\n }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/HasSpacing.java"}, {"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponent.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponent.java", "sha": "c6424664e896c8df243f6e90bdc9bfe9b2ab5778", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponent.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -29,7 +29,8 @@\n    * @param width The width for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) getRenderer(getFacesContext())).getWidth(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getWidth(getFacesContext(), this) : Measure.ZERO\")\n   void setWidth(String width);\n \n   /**\n@@ -38,7 +39,8 @@\n    * @param height The height for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) getRenderer(getFacesContext())).getHeight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getHeight(getFacesContext(), this) : Measure.ZERO\")\n   void setHeight(String height);\n \n }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponent.java"}, {"additions": 20, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentBase.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentBase.java", "sha": "ba46aa5a823558d7043988f51ef5d48aaaf89ca5", "changes": 40, "status": "modified", "deletions": 20, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentBase.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -61,80 +61,80 @@\n    * @param minimumWidth The minimum width for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer)\"\n-          + \"getRenderer(getFacesContext())).getMinimumWidth(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMinimumWidth(getFacesContext(), this) : Measure.ZERO\")\n   void setMinimumWidth(String minimumWidth);\n \n   /**\n    * @param minimumHeight The minimum height for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMinimumHeight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMinimumHeight(getFacesContext(), this) : Measure.ZERO\")\n   void setMinimumHeight(String minimumHeight);\n \n   /**\n    * @param preferredWidth The preferred width for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getPreferredWidth(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getPreferredWidth(getFacesContext(), this) : Measure.ZERO\")\n   void setPreferredWidth(String preferredWidth);\n \n   /**\n    * @param preferredHeight The preferred height for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getPreferredHeight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getPreferredHeight(getFacesContext(), this) : Measure.ZERO\")\n   void setPreferredHeight(String preferredHeight);\n \n   /**\n    * @param maximumWidth The maximum width for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMaximumWidth(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMaximumWidth(getFacesContext(), this) : Measure.ZERO\")\n   void setMaximumWidth(String maximumWidth);\n \n   /**\n    * @param maximumHeight The maximum height for this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMaximumHeight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMaximumHeight(getFacesContext(), this) : Measure.ZERO\")\n   void setMaximumHeight(String maximumHeight);\n \n   /**\n    * @param marginLeft The margin at the left of this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMarginLeft(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMarginLeft(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginLeft(String marginLeft);\n \n   /**\n    * @param marginRight The margin at the right of this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMarginRight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMarginRight(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginRight(String marginRight);\n \n   /**\n    * @param marginTop The margin at the top of this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMarginTop(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMarginTop(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginTop(String marginTop);\n \n   /**\n    * @param marginBottom The margin at the bottom of this component.\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer) \"\n-          + \"getRenderer(getFacesContext())).getMarginBottom(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer) \"\n+          + \"getRenderer(getFacesContext())).getMarginBottom(getFacesContext(), this) : Measure.ZERO\")\n   void setMarginBottom(String marginBottom);\n \n   /**", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentBase.java"}, {"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentWithDimension.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentWithDimension.java", "sha": "1f6f89bfc0e310120fd372d5c19b4325843f47cd", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentWithDimension.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -36,7 +36,8 @@\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer)getRenderer(getFacesContext())).getWidth(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer)\"\n+          + \" getRenderer(getFacesContext())).getWidth(getFacesContext(), this) : Measure.ZERO\")\n   void setWidth(String width);\n \n   /**\n@@ -47,7 +48,8 @@\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((LayoutComponentRenderer)getRenderer(getFacesContext())).getHeight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((LayoutComponentRenderer)\"\n+          + \" getRenderer(getFacesContext())).getHeight(getFacesContext(), this) : Measure.ZERO\")\n   void setHeight(String height);\n \n }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutComponentWithDimension.java"}, {"additions": 16, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutContainer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0bf08163a9aae90597bdbe9a791c22979b3121f9/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutContainer.java", "sha": "a383d92cbe89bbf75b73b9abadec9fa433374078", "changes": 32, "status": "modified", "deletions": 16, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutContainer.java?ref=0bf08163a9aae90597bdbe9a791c22979b3121f9", "patch": "@@ -30,8 +30,8 @@\n    */\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getBorderLeft(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \" getRenderer(getFacesContext())).getBorderLeft(getFacesContext(), this) : Measure.ZERO\")\n   void setBorderLeft(String borderLeft);\n \n   /**\n@@ -40,8 +40,8 @@\n    * @param borderRight The right border which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getBorderRight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getBorderRight(getFacesContext(), this) : Measure.ZERO\")\n   void setBorderRight(String borderRight);\n \n   /**\n@@ -50,8 +50,8 @@\n    * @param borderTop The top border which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getBorderTop(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getBorderTop(getFacesContext(), this) : Measure.ZERO\")\n   void setBorderTop(String borderTop);\n \n   /**\n@@ -60,8 +60,8 @@\n    * @param borderBottom The bottom border which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getBorderBottom(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getBorderBottom(getFacesContext(), this) : Measure.ZERO\")\n   void setBorderBottom(String borderBottom);\n \n   /**\n@@ -71,8 +71,8 @@\n    */\n   @UIComponentTagAttribute(\n       type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getPaddingLeft(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getPaddingLeft(getFacesContext(), this) : Measure.ZERO\")\n   void setPaddingLeft(String paddingLeft);\n \n   /**\n@@ -81,8 +81,8 @@\n    * @param paddingRight The right padding which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getPaddingRight(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getPaddingRight(getFacesContext(), this) : Measure.ZERO\")\n   void setPaddingRight(String paddingRight);\n \n   /**\n@@ -91,8 +91,8 @@\n    * @param paddingTop The top padding which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getPaddingTop(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getPaddingTop(getFacesContext(), this) : Measure.ZERO\")\n   void setPaddingTop(String paddingTop);\n \n   /**\n@@ -101,8 +101,8 @@\n    * @param paddingBottom The bottom padding which is needed by some containers (e. g. a box).\n    */\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.Measure\",\n-      defaultCode = \"((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n-          + \"getRenderer(getFacesContext())).getPaddingBottom(getFacesContext(), this)\")\n+      defaultCode = \"getRendererType() != null ? ((org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer)\\n\"\n+          + \"getRenderer(getFacesContext())).getPaddingBottom(getFacesContext(), this) : Measure.ZERO\")\n   void setPaddingBottom(String paddingBottom);\n \n   /**", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/declaration/IsGridLayoutContainer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/d4abbfa61d416f24abea1a42cb7625526d012ebd", "parent": "https://github.com/apache/myfaces-tobago/commit/5b302d484de6bdf1db996984ce0b8fd21269c95a", "message": "TOBAGO-1459 - Possilble NPE in SplitLayoutRenderer: merge trunk Revision #1676039 to 3.0 branch", "bug_id": "myfaces-tobago_39", "file": [{"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/d4abbfa61d416f24abea1a42cb7625526d012ebd/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/d4abbfa61d416f24abea1a42cb7625526d012ebd/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java", "sha": "b04fd1b338a7ff8a357504293b7f0d40e03d6b02", "changes": 13, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java?ref=d4abbfa61d416f24abea1a42cb7625526d012ebd", "patch": "@@ -115,15 +115,20 @@ private String createDraggableContainment(final AbstractUISplitLayout layout) {\n     final LayoutComponent firstComponent = container.getComponents().get(0);\n     final LayoutComponent secondComponent = container.getComponents().get(1);\n \n+    Measure minimum;\n     if (AbstractUISplitLayout.HORIZONTAL.equals(layout.getOrientation())) {\n-      final int minimumSize1 = firstComponent.getMinimumWidth().getPixel();\n-      final int minimumSize2 = secondComponent.getMinimumWidth().getPixel();\n+      minimum = firstComponent.getMinimumWidth();\n+      final int minimumSize1 = minimum != null ? minimum.getPixel() : 0;\n+      minimum = secondComponent.getMinimumWidth();\n+      final int minimumSize2 = minimum != null ? minimum.getPixel() : 0;\n       final int totalSize = container.getCurrentWidth().getPixel();\n       return new StringBuilder(\"[\").append(minimumSize1).append(\", 0, \").append(totalSize-minimumSize2).append(\", 0]\")\n           .toString();\n     } else {\n-      final int minimumSize1 = firstComponent.getMinimumHeight().getPixel();\n-      final int minimumSize2 = secondComponent.getMinimumHeight().getPixel();\n+      minimum = firstComponent.getMinimumHeight();\n+      final int minimumSize1 = minimum != null ? minimum.getPixel() : 0;\n+      minimum = secondComponent.getMinimumHeight();\n+      final int minimumSize2 = minimum != null ? minimum.getPixel() : 0;\n       final int totalSize = container.getCurrentHeight().getPixel();\n       return new StringBuilder(\"[0, \").append(minimumSize1).append(\", 0, \").append(totalSize-minimumSize2).append(\"]\")\n           .toString();", "filename": "tobago-extension/tobago-sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SplitLayoutRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/fa9d600c94068b46d3508e88065bd100fb80effd", "parent": "https://github.com/apache/myfaces-tobago/commit/110859d99848ad1f997f09534d63105c91c3c199", "message": "TOBAGO-1852 Sheet row to open a popup does not work\n\n* <tc:event> can now have children of type <f:ajax> and <tc:operation>\n* Fix a NPE for merging command maps\n* Fix log message when evaluateClientId\n* EventBehavior now have an id to identify related <tc:event> component\n* 'disabled' attribute of <tc:event> is now supported - does the same as rendered\n* A component can now have both <tc:event> and <f:ajax> if only one is enabled\n* Better description for the <tc:event> tag.\n* Improve demo for behavior\n* Add test for behavior.xhtml and sheet-event.xhtml", "bug_id": "myfaces-tobago_40", "file": [{"additions": 15, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/EventHandler.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/EventHandler.java", "sha": "9e6cb3a906c830adc6ee328e9f52f3a11335e48c", "changes": 44, "status": "modified", "deletions": 29, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/EventHandler.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -23,12 +23,11 @@\n import org.apache.myfaces.tobago.component.ClientBehaviors;\n import org.apache.myfaces.tobago.component.UIEvent;\n import org.apache.myfaces.tobago.internal.behavior.EventBehavior;\n+import org.apache.myfaces.tobago.internal.component.AbstractUIEvent;\n \n import javax.el.MethodExpression;\n import javax.faces.component.PartialStateHolder;\n import javax.faces.component.UIComponent;\n-import javax.faces.component.behavior.AjaxBehavior;\n-import javax.faces.component.behavior.ClientBehavior;\n import javax.faces.component.behavior.ClientBehaviorHolder;\n import javax.faces.context.FacesContext;\n import javax.faces.event.AbortProcessingException;\n@@ -42,8 +41,6 @@\n import javax.faces.view.facelets.TagAttributeException;\n import javax.faces.view.facelets.TagException;\n import java.io.IOException;\n-import java.util.List;\n-import java.util.Map;\n \n /**\n  * This tag creates an instance of AjaxBehavior, and associates it with the nearest\n@@ -141,37 +138,26 @@ public void applyAttachedObject(final FacesContext context, final UIComponent pa\n     final FaceletContext faceletContext = (FaceletContext) context\n         .getAttributes().get(FaceletContext.FACELET_CONTEXT_KEY);\n \n-    // cast to a ClientBehaviorHolder\n-    final ClientBehaviorHolder cvh = (ClientBehaviorHolder) parent;\n+    final ClientBehaviorHolder clientBehaviorHolder = (ClientBehaviorHolder) parent;\n+    final UIComponent lastChild = parent.getChildren().stream().skip(parent.getChildCount() - 1).findFirst().orElse(null);\n+    final AbstractUIEvent abstractUIEvent = lastChild instanceof AbstractUIEvent ? (AbstractUIEvent) lastChild : null;\n \n-    String eventName = getEventName();\n-    if (eventName == null) {\n-      eventName = cvh.getDefaultEventName();\n+    if (abstractUIEvent != null) {\n+      String eventName = getEventName();\n       if (eventName == null) {\n-        throw new TagAttributeException(event, \"eventName could not be defined for f:ajax tag with no wrap mode.\");\n-      }\n-    } else if (!cvh.getEventNames().contains(eventName)) {\n-      throw new TagAttributeException(event, \"event it is not a valid eventName defined for this component\");\n-    }\n-\n-    final Map<String, List<ClientBehavior>> clientBehaviors = cvh.getClientBehaviors();\n-\n-    final List<ClientBehavior> clientBehaviorList = clientBehaviors.get(eventName);\n-    if (clientBehaviorList != null && !clientBehaviorList.isEmpty()) {\n-      for (final ClientBehavior cb : clientBehaviorList) {\n-        if (cb instanceof AjaxBehavior) {\n-          // The most inner one has been applied, so according to\n-          // jsf 2.0 spec section 10.4.1.1 it is not necessary to apply\n-          // this one, because the inner one has precendece over\n-          // the outer one.\n-          return;\n+        eventName = clientBehaviorHolder.getDefaultEventName();\n+        if (eventName == null) {\n+          throw new TagAttributeException(event, \"eventName could not be defined for f:ajax tag with no wrap mode.\");\n         }\n+      } else if (!clientBehaviorHolder.getEventNames().contains(eventName)) {\n+        throw new TagAttributeException(event, \"event it is not a valid eventName defined for this component\");\n       }\n-    }\n \n-    final EventBehavior ajaxBehavior = createBehavior(context);\n+      final EventBehavior eventBehavior = createBehavior(context);\n+      eventBehavior.setId(abstractUIEvent.getId());\n \n-    cvh.addClientBehavior(eventName, ajaxBehavior);\n+      clientBehaviorHolder.addClientBehavior(eventName, eventBehavior);\n+    }\n   }\n \n   protected EventBehavior createBehavior(final FacesContext context) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/facelets/EventHandler.java"}, {"additions": 9, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/behavior/EventBehavior.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/behavior/EventBehavior.java", "sha": "8b342d3f265627c22c7fb990ead4c3d87e584216", "changes": 9, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/behavior/EventBehavior.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -56,6 +56,7 @@\n   private static final String ATTR_RENDER = \"render\";\n   private static final String ATTR_DISABLED = \"disabled\";\n   private static final String ATTR_IMMEDIATE = \"immediate\";\n+  private static final String ATTR_ID = \"id\";\n \n   /**\n    * special render and execute targets\n@@ -189,6 +190,14 @@ public boolean isImmediateSet() {\n     return (getStateHelper().get(ATTR_IMMEDIATE) != null) || (getValueExpression(ATTR_IMMEDIATE) != null);\n   }\n \n+  public String getId() {\n+    return (String) getStateHelper().eval(ATTR_ID);\n+  }\n+\n+  public void setId(final String clientId) {\n+    getStateHelper().put(ATTR_ID, clientId);\n+  }\n+\n   @Override\n   public Set<ClientBehaviorHint> getHints() {\n     return EnumSet.of(ClientBehaviorHint.SUBMITTING);", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/behavior/EventBehavior.java"}, {"additions": 3, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUIEvent.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUIEvent.java", "sha": "6265e8540a070663599b7cd29c28c3d0059a061d", "changes": 4, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUIEvent.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -21,10 +21,12 @@\n \n import org.apache.myfaces.tobago.component.ClientBehaviors;\n \n+import javax.faces.component.behavior.ClientBehaviorHolder;\n+\n /**\n  * {@link org.apache.myfaces.tobago.internal.taglib.component.EventTagDeclaration}\n  */\n-public abstract class AbstractUIEvent extends AbstractUICommandBase {\n+public abstract class AbstractUIEvent extends AbstractUICommandBase implements ClientBehaviorHolder {\n \n   public abstract ClientBehaviors getEvent();\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUIEvent.java"}, {"additions": 10, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/CommandMap.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/CommandMap.java", "sha": "b2816f076e8c5bb1839a077a3f33cf60cdb25c3e", "changes": 18, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/CommandMap.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -104,14 +104,16 @@ public static CommandMap merge(final CommandMap m1, final CommandMap m2) {\n             c1.merge(c2);\n           }\n         } else {\n-          for (final Map.Entry<ClientBehaviors, Command> entry : m2.getOther().entrySet()) {\n-            final ClientBehaviors key = entry.getKey();\n-            final Command value = entry.getValue();\n-            if (m1.other.containsKey(key)) {\n-              final Command command = m1.other.get(key);\n-              command.merge(value);\n-            } else {\n-              m1.addCommand(key, value);\n+          if (m1.other != null && m2.getOther() != null) {\n+            for (final Map.Entry<ClientBehaviors, Command> entry : m2.getOther().entrySet()) {\n+              final ClientBehaviors key = entry.getKey();\n+              final Command value = entry.getValue();\n+              if (m1.other.containsKey(key)) {\n+                final Command command = m1.other.get(key);\n+                command.merge(value);\n+              } else {\n+                m1.addCommand(key, value);\n+              }\n             }\n           }\n         }", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/CommandMap.java"}, {"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/RowRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/RowRenderer.java", "sha": "209e05ab10ed00069d94965e3a2439340b2c866e", "changes": 6, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/RowRenderer.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -33,7 +33,11 @@ protected void commandActivated(final UIComponent component) {\n     AbstractUIEvent event = null;\n     for (final UIComponent uiComponent : component.getChildren()) {\n       if (uiComponent instanceof AbstractUIEvent) {\n-        event = (AbstractUIEvent) uiComponent;\n+        AbstractUIEvent abstractUIEvent = (AbstractUIEvent) uiComponent;\n+        if (abstractUIEvent.isRendered() && !abstractUIEvent.isDisabled()) {\n+          event = (AbstractUIEvent) uiComponent;\n+          break;\n+        }\n       }\n     }\n     if (event != null) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/RowRenderer.java"}, {"additions": 47, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java", "sha": "e5d68e6ef53d151b8c31e5455a9f4299e782af34", "changes": 75, "status": "modified", "deletions": 28, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -53,6 +53,7 @@\n   /**\n    * In standard JSF this method returns a JavaScript string. Because of CSP, Tobago doesn't render JavaScript\n    * into the HTML content. It transports the return value a bit hacky by {@link CommandMap#storeCommandMap}.\n+   *\n    * @return \"dummy\" string or null, if nothing to do.\n    */\n   @Override\n@@ -63,7 +64,7 @@ public String getScript(final ClientBehaviorContext behaviorContext, final Clien\n     final ClientBehaviors eventName = ClientBehaviors.valueOf(behaviorContext.getEventName());\n \n     //// TBD: is this nice? May be implemented with a JSF behaviour?\n-    final Collapse collapse = createCollapsible(facesContext, uiComponent);\n+    Collapse collapse = createCollapsible(facesContext, uiComponent);\n \n     String executeIds = null;\n     String renderIds = null;\n@@ -73,7 +74,7 @@ public String getScript(final ClientBehaviorContext behaviorContext, final Clien\n     boolean omit = false;\n     if (behavior instanceof AjaxBehavior) {\n       final AjaxBehavior ajaxBehavior = (AjaxBehavior) behavior;\n-      if (ajaxBehavior.isDisabled()){\n+      if (ajaxBehavior.isDisabled()) {\n         return null;\n       }\n       final Collection<String> execute = ajaxBehavior.getExecute();\n@@ -97,14 +98,19 @@ public String getScript(final ClientBehaviorContext behaviorContext, final Clien\n           ComponentUtils.evaluateClientIds(facesContext, uiComponent, render.toArray(new String[render.size()]));\n       actionId = clientId;\n     } else if (behavior instanceof EventBehavior) { // <tc:event>\n-      final AbstractUIEvent event = findEvent(uiComponent, eventName);\n+      final EventBehavior eventBehavior = (EventBehavior) behavior;\n+      final AbstractUIEvent event = RenderUtils.getAbstractUIEvent(uiComponent, eventBehavior);\n+\n       if (event != null) {\n-        if (!event.isRendered()) {\n+        if (!event.isRendered() || event.isDisabled()) {\n           return null;\n         } else {\n           transition = event.isTransition();\n           target = event.getTarget();\n           actionId = event.getClientId(facesContext);\n+          if (collapse == null) {\n+            collapse = createCollapsible(facesContext, event);\n+          }\n           omit = event.isOmit() || StringUtils.isNotBlank(RenderUtils.generateUrl(facesContext, event));\n         }\n       }\n@@ -132,39 +138,52 @@ public String getScript(final ClientBehaviorContext behaviorContext, final Clien\n     return \"dummy\";\n   }\n \n-  private AbstractUIEvent findEvent(final UIComponent component, final ClientBehaviors eventName) {\n-    for (final UIComponent child : component.getChildren()) {\n-      if (child instanceof AbstractUIEvent) {\n-        final AbstractUIEvent event = (AbstractUIEvent) child;\n-        if (eventName == event.getEvent()) {\n-          return event;\n-        }\n+  @Override\n+  public void decode(final FacesContext facesContext, final UIComponent component,\n+      final ClientBehavior clientBehavior) {\n+    if (clientBehavior instanceof AjaxBehavior) {\n+      AjaxBehavior ajaxBehavior = (AjaxBehavior) clientBehavior;\n+      if (!component.isRendered() || ajaxBehavior.isDisabled()) {\n+        return;\n       }\n-    }\n-    return null;\n-  }\n \n-  @Override\n-  public void decode(final FacesContext context, final UIComponent component, final ClientBehavior behavior) {\n-    final AjaxBehavior ajaxBehavior = (AjaxBehavior) behavior;\n-    if (ajaxBehavior.isDisabled() || !component.isRendered()) {\n-      return;\n-    }\n+      dispatchBehaviorEvent(component, ajaxBehavior);\n+    } else if (clientBehavior instanceof EventBehavior) {\n+      final EventBehavior eventBehavior = (EventBehavior) clientBehavior;\n+      final AbstractUIEvent abstractUIEvent = RenderUtils.getAbstractUIEvent(component, eventBehavior);\n \n-    dispatchBehaviorEvent(component, ajaxBehavior);\n-  }\n+      if (!component.isRendered() || abstractUIEvent == null\n+          || !abstractUIEvent.isRendered() || abstractUIEvent.isDisabled()) {\n+        return;\n+      }\n \n-  private void dispatchBehaviorEvent(final UIComponent component, final AjaxBehavior ajaxBehavior) {\n+      for (List<ClientBehavior> children : abstractUIEvent.getClientBehaviors().values()) {\n+        for (ClientBehavior child : children) {\n+          decode(facesContext, component, child);\n+        }\n+      }\n+      dispatchBehaviorEvent(component, eventBehavior);\n+    }\n+  }\n \n-    final AjaxBehaviorEvent event = new AjaxBehaviorEvent(component, ajaxBehavior);\n-    final boolean isImmediate = isImmediate(ajaxBehavior, component);\n+  private void dispatchBehaviorEvent(final UIComponent component, final ClientBehavior clientBehavior) {\n+    final AjaxBehaviorEvent event = new AjaxBehaviorEvent(component, clientBehavior);\n+    final boolean isImmediate = isImmediate(clientBehavior, component);\n     event.setPhaseId(isImmediate ? PhaseId.APPLY_REQUEST_VALUES : PhaseId.INVOKE_APPLICATION);\n     component.queueEvent(event);\n   }\n \n-  private boolean isImmediate(final AjaxBehavior ajaxBehavior, final UIComponent component) {\n-    if (ajaxBehavior.isImmediateSet()) {\n-      return ajaxBehavior.isImmediate();\n+  private boolean isImmediate(final ClientBehavior clientBehavior, final UIComponent component) {\n+    if (clientBehavior instanceof AjaxBehavior) {\n+      AjaxBehavior ajaxBehavior = (AjaxBehavior) clientBehavior;\n+      if (ajaxBehavior.isImmediateSet()) {\n+        return ajaxBehavior.isImmediate();\n+      }\n+    } else if (clientBehavior instanceof EventBehavior) {\n+      EventBehavior eventBehavior = (EventBehavior) clientBehavior;\n+      if (eventBehavior.isImmediateSet()) {\n+        return eventBehavior.isImmediate();\n+      }\n     }\n     if (component instanceof EditableValueHolder) {\n       return ((EditableValueHolder) component).isImmediate();", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/renderkit/renderer/TobagoClientBehaviorRenderer.java"}, {"additions": 20, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/EventTagDeclaration.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/EventTagDeclaration.java", "sha": "abb64663da665e0108f444facf405249ee1de7d8", "changes": 20, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/EventTagDeclaration.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -19,10 +19,12 @@\n \n package org.apache.myfaces.tobago.internal.taglib.component;\n \n+import org.apache.myfaces.tobago.apt.annotation.Behavior;\n import org.apache.myfaces.tobago.apt.annotation.Tag;\n import org.apache.myfaces.tobago.apt.annotation.TagAttribute;\n import org.apache.myfaces.tobago.apt.annotation.UIComponentTag;\n import org.apache.myfaces.tobago.apt.annotation.UIComponentTagAttribute;\n+import org.apache.myfaces.tobago.component.ClientBehaviors;\n import org.apache.myfaces.tobago.component.RendererTypes;\n import org.apache.myfaces.tobago.internal.taglib.declaration.HasAction;\n import org.apache.myfaces.tobago.internal.taglib.declaration.HasActionListener;\n@@ -42,6 +44,7 @@\n \n /**\n  * Add an event behavior to the component.\n+ * It can contain f:ajax and tc:operation tags.\n  */\n @Tag(name = \"event\")\n @UIComponentTag(uiComponent = \"org.apache.myfaces.tobago.component.UIEvent\",\n@@ -53,13 +56,30 @@\n         // As long as no behavior event names are defined, ClientBehaviorHolder must be implemented for Majorra.\n         \"javax.faces.component.behavior.ClientBehaviorHolder\"\n     },\n+    behaviors = {\n+        @Behavior(name = ClientBehaviors.CHANGE),\n+        @Behavior(\n+            name = ClientBehaviors.CLICK,\n+            description = \"Behavior of a click event.\",\n+            isDefault = true),\n+        @Behavior(name = ClientBehaviors.DBLCLICK),\n+        @Behavior(name = ClientBehaviors.FOCUS),\n+        @Behavior(name = ClientBehaviors.BLUR),\n+        @Behavior(name = ClientBehaviors.MOUSEOUT),\n+        @Behavior(name = ClientBehaviors.MOUSEOVER),\n+        @Behavior(name = ClientBehaviors.COMPLETE),\n+        @Behavior(name = ClientBehaviors.LOAD),\n+        @Behavior(name = ClientBehaviors.RELOAD),\n+        @Behavior(name = ClientBehaviors.RESIZE)\n+    },\n     faceletHandler = \"org.apache.myfaces.tobago.facelets.EventHandler\")\n public interface EventTagDeclaration\n     extends HasIdBindingAndRendered, HasAction, HasActionListener, IsImmediateCommand, HasConfirmation,\n     HasLink, HasOutcome, HasFragment, IsTransition, HasTarget, IsDisabledBySecurity, IsOmit {\n \n   /**\n    * The name of the event as an instance of {@link org.apache.myfaces.tobago.component.ClientBehaviors}\n+   * This will be also overwrite events of possible f:ajax children.\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.component.ClientBehaviors\")", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/EventTagDeclaration.java"}, {"additions": 67, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/RenderUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/RenderUtils.java", "sha": "50c6efe78b9f7bda979a5c68003d9bd55ddd118c", "changes": 93, "status": "modified", "deletions": 26, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/RenderUtils.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -20,9 +20,11 @@\n package org.apache.myfaces.tobago.internal.util;\n \n import org.apache.myfaces.tobago.component.ClientBehaviors;\n+import org.apache.myfaces.tobago.internal.behavior.EventBehavior;\n import org.apache.myfaces.tobago.internal.component.AbstractUICommand;\n import org.apache.myfaces.tobago.internal.component.AbstractUICommandBase;\n import org.apache.myfaces.tobago.internal.component.AbstractUIData;\n+import org.apache.myfaces.tobago.internal.component.AbstractUIEvent;\n import org.apache.myfaces.tobago.internal.component.AbstractUITreeNodeBase;\n import org.apache.myfaces.tobago.internal.renderkit.Command;\n import org.apache.myfaces.tobago.internal.renderkit.CommandMap;\n@@ -51,6 +53,7 @@\n import java.net.URLEncoder;\n import java.util.List;\n import java.util.Map;\n+import java.util.Objects;\n \n public final class RenderUtils {\n \n@@ -289,41 +292,79 @@ public static String generateUrl(final FacesContext facesContext, final Abstract\n     return url;\n   }\n \n-  public static CommandMap getBehaviorCommands(final FacesContext facesContext, final ClientBehaviorHolder holder) {\n-    CommandMap map = null;\n-    final Map<String, List<ClientBehavior>> behaviors = holder.getClientBehaviors();\n-    for (final Map.Entry<String, List<ClientBehavior>> behaviorMap : behaviors.entrySet()) {\n-      final String key = behaviorMap.getKey();\n-      final ClientBehaviorContext context = ClientBehaviorContext.createClientBehaviorContext(\n-          facesContext, (UIComponent) holder, key, ((UIComponent) holder).getClientId(facesContext), null);\n-      for (final ClientBehavior clientBehavior : behaviorMap.getValue()) {\n-        if (clientBehavior instanceof ClientBehaviorBase) {\n-          String type = ((ClientBehaviorBase) clientBehavior).getRendererType();\n-          // XXX this is to use a different renderer for Tobago components and other components.\n-          if (type.equals(AjaxBehavior.BEHAVIOR_ID)) {\n-            type = \"org.apache.myfaces.tobago.behavior.Ajax\";\n-          }\n-          final ClientBehaviorRenderer renderer = facesContext.getRenderKit().getClientBehaviorRenderer(type);\n-          final String dummy = renderer.getScript(context, clientBehavior);\n-          if (dummy != null) {\n-            map = CommandMap.merge(map, CommandMap.restoreCommandMap(facesContext));\n+  public static CommandMap getBehaviorCommands(final FacesContext facesContext,\n+      final ClientBehaviorHolder clientBehaviorHolder) {\n+    CommandMap commandMap = null;\n+\n+    for (final Map.Entry<String, List<ClientBehavior>> entry : clientBehaviorHolder.getClientBehaviors().entrySet()) {\n+      final String eventName = entry.getKey();\n+      final ClientBehaviorContext clientBehaviorContext\n+          = getClientBehaviorContext(facesContext, clientBehaviorHolder, eventName);\n+\n+      for (final ClientBehavior clientBehavior : entry.getValue()) {\n+        if (clientBehavior instanceof EventBehavior) {\n+          final EventBehavior eventBehavior = (EventBehavior) clientBehavior;\n+          final AbstractUIEvent abstractUIEvent = getAbstractUIEvent((UIComponent) clientBehaviorHolder, eventBehavior);\n+\n+          if (abstractUIEvent != null && abstractUIEvent.isRendered() && !abstractUIEvent.isDisabled()) {\n+            for (List<ClientBehavior> children : abstractUIEvent.getClientBehaviors().values()) {\n+              for (ClientBehavior child : children) {\n+                final CommandMap childMap = getCommandMap(facesContext, clientBehaviorContext, child);\n+                commandMap = CommandMap.merge(commandMap, childMap);\n+              }\n+            }\n           }\n-        } else {\n-          LOG.warn(\"Ignoring: '{}'\", clientBehavior);\n         }\n+\n+        final CommandMap map = getCommandMap(facesContext, clientBehaviorContext, clientBehavior);\n+        commandMap = CommandMap.merge(commandMap, map);\n       }\n     }\n \n     // if there is no explicit behavior (with f:ajax or tc:event), use the command properties as default.\n-    // tbd: think about refactoring: put this into TobagoClientBehaviorRenderer\n-    if ((map == null || map.isEmpty()) && holder instanceof AbstractUICommand) {\n-      if (map == null) {\n-        map = new CommandMap();\n+    if ((commandMap == null || commandMap.isEmpty()) && clientBehaviorHolder instanceof AbstractUICommand) {\n+      if (commandMap == null) {\n+        commandMap = new CommandMap();\n       }\n-      map.addCommand(ClientBehaviors.click, new Command(facesContext, (AbstractUICommand) holder));\n+      commandMap.addCommand(ClientBehaviors.click, new Command(facesContext, (AbstractUICommand) clientBehaviorHolder));\n     }\n \n-    return map;\n+    return commandMap;\n+  }\n+\n+  private static ClientBehaviorContext getClientBehaviorContext(final FacesContext facesContext,\n+      final ClientBehaviorHolder clientBehaviorHolder, final String eventName) {\n+    UIComponent component = (UIComponent) clientBehaviorHolder;\n+    return ClientBehaviorContext.createClientBehaviorContext(facesContext, component, eventName,\n+        component.getClientId(facesContext), null);\n+  }\n+\n+  public static AbstractUIEvent getAbstractUIEvent(final UIComponent parent,\n+      final EventBehavior eventBehavior) {\n+    return (AbstractUIEvent) parent.getChildren().stream()\n+        .filter(child -> child instanceof AbstractUIEvent)\n+        .filter(child -> Objects.equals(child.getId(), eventBehavior.getId()))\n+        .findFirst().orElse(null);\n+  }\n+\n+  private static CommandMap getCommandMap(final FacesContext facesContext,\n+      final ClientBehaviorContext clientBehaviorContext, final ClientBehavior clientBehavior) {\n+    if (clientBehavior instanceof ClientBehaviorBase) {\n+      String type = ((ClientBehaviorBase) clientBehavior).getRendererType();\n+\n+      // this is to use a different renderer for Tobago components and other components.\n+      if (type.equals(AjaxBehavior.BEHAVIOR_ID)) {\n+        type = \"org.apache.myfaces.tobago.behavior.Ajax\";\n+      }\n+      final ClientBehaviorRenderer renderer = facesContext.getRenderKit().getClientBehaviorRenderer(type);\n+      final String dummy = renderer.getScript(clientBehaviorContext, clientBehavior);\n+      if (dummy != null) {\n+        return CommandMap.restoreCommandMap(facesContext);\n+      }\n+    } else {\n+      LOG.warn(\"Ignoring: '{}'\", clientBehavior);\n+    }\n+    return null;\n   }\n \n   public static void decodeClientBehaviors(final FacesContext facesContext, final UIComponent component) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/RenderUtils.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/util/ComponentUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-core/src/main/java/org/apache/myfaces/tobago/util/ComponentUtils.java", "sha": "c9045b1344da45dda7acdd6694b619da6cbb2fb3", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/util/ComponentUtils.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -692,7 +692,7 @@ public static String evaluateClientId(\n       return clientId;\n     }\n     LOG.error(\"No component found for id='{}', search base component is '{}'\",\n-        component != null ? component.getClientId(context) : \"<null>\");\n+        componentId, component != null ? component.getClientId(context) : \"<null>\");\n     return null;\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/util/ComponentUtils.java"}, {"additions": 17, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorController.java", "sha": "994253002caaf9006cf678f0c1687978ca73ab24", "changes": 19, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorController.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -19,16 +19,19 @@\n \n package org.apache.myfaces.tobago.example.demo;\n \n-import javax.enterprise.context.RequestScoped;\n+import javax.enterprise.context.SessionScoped;\n+import javax.faces.event.ActionEvent;\n+import javax.faces.event.AjaxBehaviorEvent;\n import javax.inject.Named;\n import java.io.Serializable;\n \n-@RequestScoped\n+@SessionScoped\n @Named\n public class BehaviorController implements Serializable {\n \n   private String ajax;\n   private String event;\n+  private int counter;\n \n   public String getAjax() {\n     return ajax;\n@@ -45,4 +48,16 @@ public String getEvent() {\n   public void setEvent(final String event) {\n     this.event = event;\n   }\n+\n+  public int getCounter() {\n+    return counter;\n+  }\n+\n+  public void countUp(final AjaxBehaviorEvent event) {\n+    counter++;\n+  }\n+\n+  public void countUp(final ActionEvent event) {\n+    counter++;\n+  }\n }", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorController.java"}, {"additions": 213, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorTestController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorTestController.java", "sha": "42ed101c7bea4d3cde1b3ef1eb07dfd38552431a", "changes": 213, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorTestController.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -0,0 +1,213 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.myfaces.tobago.example.demo;\n+\n+import javax.enterprise.context.SessionScoped;\n+import javax.faces.event.ActionEvent;\n+import javax.faces.event.AjaxBehaviorEvent;\n+import javax.inject.Named;\n+import java.io.Serializable;\n+\n+@SessionScoped\n+@Named\n+public class BehaviorTestController implements Serializable {\n+\n+  private int buttonActionCounter;\n+  private int buttonActionListenerCounter;\n+  private int actionCounter1;\n+  private int actionListenerCounter1;\n+  private int ajaxListenerCounter1;\n+  private int actionCounter2;\n+  private int actionListenerCounter2;\n+  private int ajaxListenerCounter2;\n+  private int actionCounter3;\n+  private int actionListenerCounter3;\n+  private int ajaxListenerCounter3;\n+  private int selector;\n+  private boolean eventEnabled1;\n+  private boolean eventEnabled2;\n+  private boolean eventEnabled3;\n+  private boolean ajaxEnabled1;\n+  private boolean ajaxEnabled2;\n+  private boolean ajaxEnabled3;\n+\n+  public BehaviorTestController() {\n+    reset();\n+  }\n+\n+  public void reset() {\n+    buttonActionCounter = 0;\n+    buttonActionListenerCounter = 0;\n+    actionCounter1 = 0;\n+    actionListenerCounter1 = 0;\n+    ajaxListenerCounter1 = 0;\n+    actionCounter2 = 0;\n+    actionListenerCounter2 = 0;\n+    ajaxListenerCounter2 = 0;\n+    actionCounter3 = 0;\n+    actionListenerCounter3 = 0;\n+    ajaxListenerCounter3 = 0;\n+  }\n+\n+  public void countButtonAction() {\n+    buttonActionCounter++;\n+  }\n+\n+  public void countButtonActionListener(ActionEvent actionEvent) {\n+    buttonActionListenerCounter++;\n+  }\n+\n+  public void countAction1() {\n+    actionCounter1++;\n+  }\n+\n+  public void countActionListener1(ActionEvent actionEvent) {\n+    actionListenerCounter1++;\n+  }\n+\n+  public void countAjaxListener1(AjaxBehaviorEvent ajaxBehaviorEvent) {\n+    ajaxListenerCounter1++;\n+  }\n+\n+  public void countAction2() {\n+    actionCounter2++;\n+  }\n+\n+  public void countActionListener2(ActionEvent actionEvent) {\n+    actionListenerCounter2++;\n+  }\n+\n+  public void countAjaxListener2(AjaxBehaviorEvent ajaxBehaviorEvent) {\n+    ajaxListenerCounter2++;\n+  }\n+\n+  public void countAction3() {\n+    actionCounter3++;\n+  }\n+\n+  public void countActionListener3(ActionEvent actionEvent) {\n+    actionListenerCounter3++;\n+  }\n+\n+  public void countAjaxListener3(AjaxBehaviorEvent ajaxBehaviorEvent) {\n+    ajaxListenerCounter3++;\n+  }\n+\n+  public int getSelector() {\n+    return selector;\n+  }\n+\n+  public void setSelector(int selector) {\n+    this.selector = selector;\n+  }\n+\n+  public void submitSelection() {\n+    eventEnabled1 = false;\n+    eventEnabled2 = false;\n+    eventEnabled3 = false;\n+    ajaxEnabled1 = false;\n+    ajaxEnabled2 = false;\n+    ajaxEnabled3 = false;\n+\n+    switch (selector) {\n+      case 1:\n+        eventEnabled1 = true;\n+        break;\n+      case 2:\n+        eventEnabled2 = true;\n+        ajaxEnabled3 = true;\n+        break;\n+      case 3:\n+        eventEnabled3 = true;\n+        ajaxEnabled1 = true;\n+        ajaxEnabled2 = true;\n+        ajaxEnabled3 = true;\n+        break;\n+    }\n+  }\n+\n+  public int getButtonActionCounter() {\n+    return buttonActionCounter;\n+  }\n+\n+  public int getButtonActionListenerCounter() {\n+    return buttonActionListenerCounter;\n+  }\n+\n+  public int getActionCounter1() {\n+    return actionCounter1;\n+  }\n+\n+  public int getActionListenerCounter1() {\n+    return actionListenerCounter1;\n+  }\n+\n+  public int getAjaxListenerCounter1() {\n+    return ajaxListenerCounter1;\n+  }\n+\n+  public int getActionCounter2() {\n+    return actionCounter2;\n+  }\n+\n+  public int getActionListenerCounter2() {\n+    return actionListenerCounter2;\n+  }\n+\n+  public int getAjaxListenerCounter2() {\n+    return ajaxListenerCounter2;\n+  }\n+\n+  public int getActionCounter3() {\n+    return actionCounter3;\n+  }\n+\n+  public int getActionListenerCounter3() {\n+    return actionListenerCounter3;\n+  }\n+\n+  public int getAjaxListenerCounter3() {\n+    return ajaxListenerCounter3;\n+  }\n+\n+  public boolean isEventEnabled1() {\n+    return eventEnabled1;\n+  }\n+\n+  public boolean isEventEnabled2() {\n+    return eventEnabled2;\n+  }\n+\n+  public boolean isEventEnabled3() {\n+    return eventEnabled3;\n+  }\n+\n+  public boolean isAjaxEnabled1() {\n+    return ajaxEnabled1;\n+  }\n+\n+  public boolean isAjaxEnabled2() {\n+    return ajaxEnabled2;\n+  }\n+\n+  public boolean isAjaxEnabled3() {\n+    return ajaxEnabled3;\n+  }\n+}", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/BehaviorTestController.java"}, {"additions": 109, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.test.js", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.test.js", "sha": "2194cb593c99713e5f97d28dcbb553885141abe9", "changes": 109, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.test.js?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -201,3 +201,112 @@ QUnit.test(\"On double click with full request\", function (assert) {\n     }\n   });\n });\n+\n+QUnit.test(\"Open popup on click with ajax\", function (assert) {\n+  assert.expect(12);\n+  var done = assert.async(7);\n+\n+  var $radioButton = jQueryFrame(\"#page\\\\:mainForm\\\\:changeExample\\\\:\\\\:3\");\n+  var $venus = jQueryFrame(\"#page\\\\:mainForm\\\\:s1\\\\:2\\\\:sample3\");\n+  var $jupiter = jQueryFrame(\"#page\\\\:mainForm\\\\:s1\\\\:5\\\\:sample3\");\n+  var $saturn = jQueryFrame(\"#page\\\\:mainForm\\\\:s1\\\\:6\\\\:sample3\");\n+  var $popup = jQueryFrame(\"#page\\\\:mainForm\\\\:popup\");\n+  var $name = jQueryFrame(\"#page\\\\:mainForm\\\\:popup\\\\:popupName\\\\:\\\\:field\");\n+  var $cancel = jQueryFrame(\"#page\\\\:mainForm\\\\:popup\\\\:cancel\");\n+\n+  $radioButton.click();\n+\n+  waitForAjax(function () {\n+    $venus = jQueryFrame($venus.selector);\n+    $jupiter = jQueryFrame($jupiter.selector);\n+    $saturn = jQueryFrame($saturn.selector);\n+    return $venus.length === 1 && $jupiter.length === 1 && $saturn.length === 1;\n+  }, function () {\n+    $venus = jQueryFrame($venus.selector);\n+    $jupiter = jQueryFrame($jupiter.selector);\n+    $saturn = jQueryFrame($saturn.selector);\n+    assert.equal($venus.length, 1);\n+    assert.equal($jupiter.length, 1);\n+    assert.equal($saturn.length, 1);\n+    done();\n+\n+    $venus.click();\n+\n+    waitForAjax(function () {\n+      $popup = jQueryFrame($popup.selector);\n+      $name = jQueryFrame($name.selector);\n+      return $popup.hasClass(\"show\") && $name.val() === \"Venus\";\n+    }, function () {\n+      $popup = jQueryFrame($popup.selector);\n+      $name = jQueryFrame($name.selector);\n+      assert.ok($popup.hasClass(\"show\"));\n+      assert.equal($name.val(), \"Venus\");\n+      done();\n+\n+      waitForAjax(function () {\n+        $cancel = jQueryFrame($cancel.selector);\n+        $popup = jQueryFrame($popup.selector);\n+\n+        $cancel.click();\n+        return !$popup.hasClass(\"show\");\n+      }, function () {\n+        $popup = jQueryFrame($popup.selector);\n+        assert.notOk($popup.hasClass(\"show\"));\n+        done();\n+\n+        $jupiter.click();\n+\n+        waitForAjax(function () {\n+          $popup = jQueryFrame($popup.selector);\n+          $name = jQueryFrame($name.selector);\n+          return $popup.hasClass(\"show\") && $name.val() === \"Jupiter\";\n+        }, function () {\n+          $popup = jQueryFrame($popup.selector);\n+          $name = jQueryFrame($name.selector);\n+          assert.ok($popup.hasClass(\"show\"));\n+          assert.equal($name.val(), \"Jupiter\");\n+          done();\n+\n+          waitForAjax(function () {\n+            $cancel = jQueryFrame($cancel.selector);\n+            $popup = jQueryFrame($popup.selector);\n+\n+            $cancel.click();\n+            return !$popup.hasClass(\"show\");\n+          }, function () {\n+            $popup = jQueryFrame($popup.selector);\n+            assert.notOk($popup.hasClass(\"show\"));\n+            done();\n+\n+            $saturn.click();\n+\n+            waitForAjax(function () {\n+              $popup = jQueryFrame($popup.selector);\n+              $name = jQueryFrame($name.selector);\n+              return $popup.hasClass(\"show\") && $name.val() === \"Saturn\";\n+            }, function () {\n+              $popup = jQueryFrame($popup.selector);\n+              $name = jQueryFrame($name.selector);\n+              assert.ok($popup.hasClass(\"show\"));\n+              assert.equal($name.val(), \"Saturn\");\n+              done();\n+\n+\n+              waitForAjax(function () {\n+                $cancel = jQueryFrame($cancel.selector);\n+                $popup = jQueryFrame($popup.selector);\n+\n+                $cancel.click();\n+                return !$popup.hasClass(\"show\");\n+              }, function () {\n+                $popup = jQueryFrame($popup.selector);\n+                assert.notOk($popup.hasClass(\"show\"));\n+                done();\n+              });\n+            });\n+          });\n+        });\n+      });\n+    });\n+  });\n+});", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.test.js"}, {"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.xhtml", "sha": "cd358ae7a4accaa7fb3cf1fbfba67eef3d91b0be", "changes": 10, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.xhtml?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -24,7 +24,8 @@\n                 xmlns:f=\"http://java.sun.com/jsf/core\">\n   <ui:param name=\"title\" value=\"#{demoBundle.sheet_event} &lt;tc:row>\"/>\n   <p>A <code class=\"language-markup\">&lt;tc:sheet/&gt;</code> can contain a\n-    <code class=\"language-markup\">&lt;tc:row/&gt;</code> tag with a containing <code class=\"language-markup\">&lt;tc:event/&gt;</code> tag.\n+    <code class=\"language-markup\">&lt;tc:row/&gt;</code> tag with a containing <code\n+            class=\"language-markup\">&lt;tc:event/&gt;</code> tag.\n     The event type can be set by the <code>event</code> attribute. Possible values are 'click' and 'dblclick'.\n   </p>\n \n@@ -62,8 +63,9 @@\n           </tc:row>\n \n           <tc:row id=\"sample3\" rendered=\"#{sheetController.columnEventSample == 3}\">\n-            <f:ajax execute=\":::popup\" render=\":::popup\" listener=\"#{sheetController.selectSolarObject}\" id=\"columnEventPopup\"/>\n-            <tc:event omit=\"true\">\n+            <tc:event>\n+              <f:ajax id=\"columnEventPopup\" execute=\":::popup\" render=\":::popup\"\n+                      listener=\"#{sheetController.selectSolarObject}\"/>\n               <tc:operation name=\"show\" for=\":::popup\"/>\n             </tc:event>\n           </tc:row>\n@@ -94,7 +96,7 @@\n \n       <tc:popup id=\"popup\">\n         <tc:box label=\"Details\">\n-          <tc:in label=\"Name\" value=\"#{sheetController.selectedSolarObject.name}\" required=\"true\"/>\n+          <tc:in id=\"popupName\" label=\"Name\" value=\"#{sheetController.selectedSolarObject.name}\" required=\"true\"/>\n           <tc:in label=\"Number\" value=\"#{sheetController.selectedSolarObject.number}\"/>\n           <tc:in label=\"Orbit\" value=\"#{sheetController.selectedSolarObject.orbit}\"/>\n           <tc:in label=\"Distance\" value=\"#{sheetController.selectedSolarObject.distance}\"/>", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/20-component/080-sheet/30-event/sheet-event.xhtml"}, {"additions": 38, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/30-behavior/behavior.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/30-behavior/behavior.xhtml", "sha": "d233191c8ee6f0dd8bef234df997b3e2d33565a9", "changes": 46, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/30-behavior/behavior.xhtml?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -28,15 +28,14 @@\n     <li><code class=\"language-markup\">&lt;f:ajax/></code> send an ajax request</li>\n     <li><code class=\"language-markup\">&lt;tc:event/></code> do a full page reload</li>\n   </ul>\n-  <p>You find more <tc:link label=\"examples\" outcome=\"/content/40-test/6000-event/event.xhtml\"/> in the test section.</p>\n   <p>Tag Library Documentation:\n     <tc:link label=\"&lt;f:ajax/>\" image=\"#{request.contextPath}/image/feather-leaf.png\"\n              link=\"http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/f/ajax.html\"/>\n     |\n     <tc:link label=\"&lt;tc:event/>\" image=\"#{request.contextPath}/image/feather-leaf.png\"\n              link=\"#{demoBundle.tagDocUrl}/#{info.stableVersion}/tld/tc/event.html\"/></p>\n \n-  <tc:section label=\"Examples\">\n+  <tc:section label=\"Basic examples\">\n     <p>Type a text into the input field. After leaving the input field, the given text is shown in the output field.</p>\n     <tc:section label=\"f:ajax\">\n       <pre><code class=\"language-markup\">&lt;tc:in label=\"Ajax Input\" value=\"\\#{behaviorController.ajax}\">\n@@ -60,11 +59,42 @@\n     </tc:section>\n   </tc:section>\n \n-  <tc:section label=\"Limitations\">\n-    <p>The <code class=\"language-markup\">&lt;f:ajax></code> tag cannot inserted along with the\n-      <code class=\"language-markup\">&lt;tc:event></code> tag if both have the same <code>event</code> attribute value.\n-      <br/>\n-      The latter also applies if <code class=\"language-markup\">&lt;f:ajax></code> is disabled\n-      or if <code class=\"language-markup\">&lt;tc:event></code> is not rendered.</p>\n+  <tc:section label=\"Change the event name\">\n+    <p>It's possible to change the event name. For example if you want a double click event, change the event name to\n+      <code>dblclick</code>. This is done for the following two buttons.</p>\n+\n+    <pre><code class=\"language-markup\">&lt;tc:button label=\"Ajax Double Click\">\n+  &lt;f:ajax event=\"dblclick\" render=\"outCounter\" listener=\"...\"/>\n+&lt;/tc:button>\n+&lt;tc:button label=\"Event Double Click\">\n+  &lt;tc:event event=\"dblclick\" actionListener=\"...\"/>\n+&lt;/tc:button></code></pre>\n+    <tc:button label=\"Ajax Double Click\">\n+      <f:ajax event=\"dblclick\" render=\"outCounter\" listener=\"#{behaviorController.countUp}\"/>\n+    </tc:button>\n+    <tc:button label=\"Event Double Click\">\n+      <tc:event event=\"dblclick\" actionListener=\"#{behaviorController.countUp}\"/>\n+    </tc:button>\n+    <tc:out id=\"outCounter\" label=\"Counter\" value=\"#{behaviorController.counter}\"/>\n+  </tc:section>\n+\n+  <tc:section label=\"Advanced\">\n+    <p><code class=\"language-markup\">&lt;tc:event></code> may contain <code class=\"language-markup\">&lt;f:ajax></code>\n+      and <code class=\"language-markup\">&lt;tc:operation></code> tags.</p>\n+    <p>This is helpfull if the parent component cannot handle operations by itself.</p>\n+    <p><tc:badge value=\"Important\" markup=\"danger\"/>\n+      The <code>event</code> attribute of the ajax children will be ignored.</p>\n+\n+    <tc:section label=\"Example\">\n+      <p>An example can be found for\n+        <tc:link label=\"&lt;tc:row>\" outcome=\"/content/20-component/080-sheet/30-event/sheet-event.xhtml\"/>\n+        Option: 'open popup on click with AJAX'.</p>\n+      <pre><code class=\"language-markup\">&lt;tc:row>\n+  &lt;tc:event>\n+    &lt;f:ajax execute=\":::popup\" render=\":::popup\" listener=\"...\"/>\n+    &lt;tc:operation name=\"show\" for=\":::popup\"/>\n+  &lt;/tc:event>\n+&lt;/tc:row></code></pre>\n+    </tc:section>\n   </tc:section>\n </ui:composition>", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/30-behavior/behavior.xhtml"}, {"additions": 292, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.test.js", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.test.js", "sha": "56ce70e9ddf89f67eba96cf10db6c2510ad7b26e", "changes": 292, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.test.js?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -0,0 +1,292 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+QUnit.test(\"Simple Event\", function (assert) {\n+  assert.expect(11);\n+  var done = assert.async();\n+  var step = 1;\n+\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:simpleEvent\");\n+  var oldCounterValues = getCounterValues();\n+\n+  $button.click();\n+\n+  jQuery(\"#page\\\\:testframe\").load(function () {\n+    if (step === 1) {\n+      compareCounterValues(assert, oldCounterValues, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0);\n+\n+      step++;\n+      done();\n+    }\n+  });\n+});\n+\n+QUnit.test(\"Simple Ajax\", function (assert) {\n+  assert.expect(11);\n+  var done = assert.async();\n+  var step = 1;\n+\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:simpleAjax\");\n+  var oldCounterValues = getCounterValues();\n+\n+  $button.click();\n+\n+  waitForAjax(function () {\n+    var newCounterValues = getCounterValues();\n+    return step === 1 && oldCounterValues !== newCounterValues;\n+  }, function () {\n+    compareCounterValues(assert, oldCounterValues, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0);\n+\n+    step++;\n+    done();\n+  });\n+});\n+\n+QUnit.test(\"Simple EventAjax\", function (assert) {\n+  assert.expect(11);\n+  var done = assert.async();\n+  var step = 1;\n+\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:simpleEventAjax\");\n+  var oldCounterValues = getCounterValues();\n+\n+  $button.click();\n+\n+  waitForAjax(function () {\n+    var newCounterValues = getCounterValues();\n+    return step === 1 && oldCounterValues !== newCounterValues;\n+  }, function () {\n+    compareCounterValues(assert, oldCounterValues, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0);\n+\n+    step++;\n+    done();\n+  });\n+});\n+\n+QUnit.test(\"Advanced Button: Option 1\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:0\");\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedButton\");\n+  testEventOption(assert, $option, $button, \"dblclick\", 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0);\n+});\n+\n+QUnit.test(\"Advanced Button: Option 2\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:1\");\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedButton\");\n+\n+  testAjaxOption(assert, $option, $button, \"dblclick\", 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1);\n+});\n+\n+QUnit.test(\"Advanced Button: Option 3\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:2\");\n+  var $button = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedButton\");\n+  testAjaxOption(assert, $option, $button, \"click\", 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1);\n+});\n+\n+QUnit.test(\"Row: Option 1\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:0\");\n+  var $row = jQueryFrame(\"#page\\\\:mainForm\\\\:sheet\\\\:0\\\\:row\");\n+  testEventOption(assert, $option, $row, \"dblclick\", 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0);\n+});\n+\n+QUnit.test(\"Row: Option 2\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:1\");\n+  var $row = jQueryFrame(\"#page\\\\:mainForm\\\\:sheet\\\\:0\\\\:row\");\n+  testAjaxOption(assert, $option, $row, \"dblclick\", 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1);\n+});\n+\n+QUnit.test(\"Row: Option 3\", function (assert) {\n+  var $option = jQueryFrame(\"#page\\\\:mainForm\\\\:advancedSelector\\\\:\\\\:2\");\n+  var $row = jQueryFrame(\"#page\\\\:mainForm\\\\:sheet\\\\:0\\\\:row\");\n+  testAjaxOption(assert, $option, $row, \"click\", 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1);\n+});\n+\n+QUnit.test(\"Input: Click Event\", function (assert) {\n+  var $input = jQueryFrame(\"#page\\\\:mainForm\\\\:inputClick\\\\:\\\\:field\");\n+  testInputSection(assert, $input, \"click\");\n+});\n+\n+function testEventOption(assert, $option, $component, event,\n+                         buttonActionPlus, buttonActionListenerPlus,\n+                         action1Plus, actionListener1Plus, ajaxListener1Plus,\n+                         action2Plus, actionListener2Plus, ajaxListener2Plus,\n+                         action3Plus, actionListener3Plus, ajaxListener3Plus) {\n+  assert.expect(13);\n+  var done = assert.async(3);\n+  var step = 1;\n+\n+  var $hide = jQueryFrame(\"#page\\\\:mainForm\\\\:hideOperationTextBox\");\n+  var $operationOut = jQueryFrame(\"#page\\\\:mainForm\\\\:operationOut\");\n+  var oldCounterValues = getCounterValues();\n+\n+  $hide.click();\n+\n+  jQuery(\"#page\\\\:testframe\").load(function () {\n+    if (step === 1) {\n+      $operationOut = jQueryFrame($operationOut.selector);\n+      $option = jQueryFrame($option.selector);\n+      assert.equal($operationOut.length, 0, \"Content of operation test box must be hidden.\");\n+\n+      $option.click();\n+\n+      step++;\n+      done();\n+    } else if (step === 2) {\n+      $component = jQueryFrame($component.selector);\n+      $component.trigger(event);\n+\n+      step++;\n+      done();\n+    } else if (step === 3) {\n+      $operationOut = jQueryFrame($operationOut.selector);\n+      assert.equal($operationOut.length, 1, \"Content of operation test box must be shown.\");\n+\n+      compareCounterValues(assert, oldCounterValues,\n+          buttonActionPlus, buttonActionListenerPlus,\n+          action1Plus, actionListener1Plus, ajaxListener1Plus,\n+          action2Plus, actionListener2Plus, ajaxListener2Plus,\n+          action3Plus, actionListener3Plus, ajaxListener3Plus);\n+\n+      step++;\n+      done();\n+    }\n+  });\n+}\n+\n+function testAjaxOption(assert, $option, $component, event,\n+                        buttonActionPlus, buttonActionListenerPlus,\n+                        action1Plus, actionListener1Plus, ajaxListener1Plus,\n+                        action2Plus, actionListener2Plus, ajaxListener2Plus,\n+                        action3Plus, actionListener3Plus, ajaxListener3Plus) {\n+  assert.expect(13);\n+  var done = assert.async(3);\n+  var step = 1;\n+\n+  var $hide = jQueryFrame(\"#page\\\\:mainForm\\\\:hideOperationTextBox\");\n+  var $operationOut = jQueryFrame(\"#page\\\\:mainForm\\\\:operationOut\");\n+  var oldCounterValues = getCounterValues();\n+\n+  $hide.click();\n+\n+  jQuery(\"#page\\\\:testframe\").load(function () {\n+    if (step === 1) {\n+      $operationOut = jQueryFrame($operationOut.selector);\n+      $option = jQueryFrame($option.selector);\n+      assert.equal($operationOut.length, 0, \"Content of operation test box must be hidden.\");\n+\n+      $option.click();\n+\n+      step++;\n+      done();\n+    } else if (step === 2) {\n+      $component = jQueryFrame($component.selector);\n+      $component.trigger(event);\n+\n+      step++;\n+      done();\n+\n+      waitForAjax(function () {\n+        var newCounterValues = getCounterValues();\n+        return step === 3 && oldCounterValues !== newCounterValues;\n+      }, function () {\n+        $operationOut = jQueryFrame($operationOut.selector);\n+        assert.equal($operationOut.length, 1, \"Content of operation test box must be shown.\");\n+\n+        compareCounterValues(assert, oldCounterValues,\n+            buttonActionPlus, buttonActionListenerPlus,\n+            action1Plus, actionListener1Plus, ajaxListener1Plus,\n+            action2Plus, actionListener2Plus, ajaxListener2Plus,\n+            action3Plus, actionListener3Plus, ajaxListener3Plus);\n+\n+        step++;\n+        done();\n+      });\n+    }\n+  });\n+}\n+\n+function testInputSection(assert, $input, eventName) {\n+  assert.expect(2);\n+  var done = assert.async(2);\n+  var step = 1;\n+\n+  var $hide = jQueryFrame(\"#page\\\\:mainForm\\\\:hideOperationTextBox\");\n+  $hide.click();\n+\n+  jQuery(\"#page\\\\:testframe\").load(function () {\n+    if (step === 1) {\n+      $input = jQueryFrame($input.selector);\n+      assert.ok(isOperationTestBoxCollapsed(), \"Content of operation test box must be hidden.\");\n+\n+      $input.trigger(eventName);\n+\n+      step++;\n+      done();\n+    } else if (step === 2) {\n+      assert.notOk(isOperationTestBoxCollapsed(), \"Content of operation test box must be shown.\");\n+\n+      step++;\n+      done();\n+    }\n+  });\n+}\n+\n+function getCounterValues() {\n+  var buttonActionCounter = jQueryFrame(\"#page\\\\:mainForm\\\\:buttonActionCounter.tobago-out\").text();\n+  var buttonActionListenerCounter = jQueryFrame(\"#page\\\\:mainForm\\\\:buttonActionListenerCounter.tobago-out\").text();\n+\n+  var actionCount1 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionCounter1.tobago-out\").text();\n+  var actionListenerCount1 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionListenerCounter1.tobago-out\").text();\n+  var ajaxListenerCount1 = jQueryFrame(\"#page\\\\:mainForm\\\\:ajaxListenerCounter1.tobago-out\").text();\n+\n+  var actionCount2 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionCounter2.tobago-out\").text();\n+  var actionListenerCount2 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionListenerCounter2.tobago-out\").text();\n+  var ajaxListenerCount2 = jQueryFrame(\"#page\\\\:mainForm\\\\:ajaxListenerCounter2.tobago-out\").text();\n+\n+  var actionCount3 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionCounter3.tobago-out\").text();\n+  var actionListenerCount3 = jQueryFrame(\"#page\\\\:mainForm\\\\:actionListenerCounter3.tobago-out\").text();\n+  var ajaxListenerCount3 = jQueryFrame(\"#page\\\\:mainForm\\\\:ajaxListenerCounter3.tobago-out\").text();\n+\n+  return [buttonActionCounter, buttonActionListenerCounter,\n+    actionCount1, actionListenerCount1, ajaxListenerCount1,\n+    actionCount2, actionListenerCount2, ajaxListenerCount2,\n+    actionCount3, actionListenerCount3, ajaxListenerCount3]\n+}\n+\n+function compareCounterValues(assert, oldCounterValues,\n+                              buttonActionPlus, buttonActionListenerPlus,\n+                              action1Plus, actionListener1Plus, ajaxListener1Plus,\n+                              action2Plus, actionListener2Plus, ajaxListener2Plus,\n+                              action3Plus, actionListener3Plus, ajaxListener3Plus) {\n+  var newCounterValues = getCounterValues();\n+\n+  assert.equal(parseInt(newCounterValues[0]), parseInt(oldCounterValues[0]) + buttonActionPlus);\n+  assert.equal(parseInt(newCounterValues[1]), parseInt(oldCounterValues[1]) + buttonActionListenerPlus);\n+  assert.equal(parseInt(newCounterValues[2]), parseInt(oldCounterValues[2]) + action1Plus);\n+  assert.equal(parseInt(newCounterValues[3]), parseInt(oldCounterValues[3]) + actionListener1Plus);\n+  assert.equal(parseInt(newCounterValues[4]), parseInt(oldCounterValues[4]) + ajaxListener1Plus);\n+  assert.equal(parseInt(newCounterValues[5]), parseInt(oldCounterValues[5]) + action2Plus);\n+  assert.equal(parseInt(newCounterValues[6]), parseInt(oldCounterValues[6]) + actionListener2Plus);\n+  assert.equal(parseInt(newCounterValues[7]), parseInt(oldCounterValues[7]) + ajaxListener2Plus);\n+  assert.equal(parseInt(newCounterValues[8]), parseInt(oldCounterValues[8]) + action3Plus);\n+  assert.equal(parseInt(newCounterValues[9]), parseInt(oldCounterValues[9]) + actionListener3Plus);\n+  assert.equal(parseInt(newCounterValues[10]), parseInt(oldCounterValues[10]) + ajaxListener3Plus);\n+}\n+\n+function isOperationTestBoxCollapsed() {\n+  var $operationOut = jQueryFrame(\"#page\\\\:mainForm\\\\:operationOut\");\n+  return $operationOut.length === 0;\n+}", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.test.js"}, {"additions": 205, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.xhtml", "sha": "3a976c5ac48a3d44b6270d815c6000ff535b39ba", "changes": 205, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.xhtml?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -0,0 +1,205 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<!--\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+-->\n+\n+<ui:composition template=\"/main.xhtml\"\n+                xmlns=\"http://www.w3.org/1999/xhtml\"\n+                xmlns:f=\"http://java.sun.com/jsf/core\"\n+                xmlns:tc=\"http://myfaces.apache.org/tobago/component\"\n+                xmlns:ui=\"http://java.sun.com/jsf/facelets\">\n+  <ui:param name=\"title\" value=\"#{demoBundle.behavior}\"/>\n+\n+\n+  <tc:box id=\"counter\" label=\"Counter\">\n+    <f:facet name=\"bar\">\n+      <tc:button id=\"reset\" label=\"Reset\" action=\"#{behaviorTestController.reset}\"/>\n+    </f:facet>\n+    <tc:segmentLayout extraSmall=\"3seg 2seg 4seg 3seg\">\n+      <tc:panel/>\n+      <tc:out value=\"Action\"/>\n+      <tc:out value=\"ActionListener\"/>\n+      <tc:out value=\"AjaxListener\"/>\n+\n+      <tc:out value=\"Button Counter\" labelLayout=\"skip\"/>\n+      <tc:out id=\"buttonActionCounter\" value=\"#{behaviorTestController.buttonActionCounter}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"buttonActionListenerCounter\" value=\"#{behaviorTestController.buttonActionListenerCounter}\"\n+              labelLayout=\"skip\"/>\n+      <tc:panel/>\n+\n+      <tc:out value=\"Counter 1\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionCounter1\" value=\"#{behaviorTestController.actionCounter1}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionListenerCounter1\" value=\"#{behaviorTestController.actionListenerCounter1}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"ajaxListenerCounter1\" value=\"#{behaviorTestController.ajaxListenerCounter1}\" labelLayout=\"skip\"/>\n+\n+      <tc:out value=\"Counter 2\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionCounter2\" value=\"#{behaviorTestController.actionCounter2}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionListenerCounter2\" value=\"#{behaviorTestController.actionListenerCounter2}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"ajaxListenerCounter2\" value=\"#{behaviorTestController.ajaxListenerCounter2}\" labelLayout=\"skip\"/>\n+\n+      <tc:out value=\"Counter 3\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionCounter3\" value=\"#{behaviorTestController.actionCounter3}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"actionListenerCounter3\" value=\"#{behaviorTestController.actionListenerCounter3}\" labelLayout=\"skip\"/>\n+      <tc:out id=\"ajaxListenerCounter3\" value=\"#{behaviorTestController.ajaxListenerCounter3}\" labelLayout=\"skip\"/>\n+    </tc:segmentLayout>\n+  </tc:box>\n+  <tc:box id=\"operationTestBox\" label=\"&lt;tc:operation> Test\" collapsedMode=\"absent\">\n+    <f:facet name=\"bar\">\n+      <tc:button id=\"hideOperationTextBox\" label=\"Hide\">\n+        <tc:operation name=\"hide\" for=\"operationTestBox\"/>\n+      </tc:button>\n+    </f:facet>\n+    <tc:out id=\"operationOut\" value=\"Content\"/>\n+  </tc:box>\n+\n+  <tc:section label=\"&lt;tc:button>\">\n+    <tc:section label=\"Basics\">\n+      <tc:button id=\"simpleEvent\" label=\"Simple Event\">\n+        <tc:event action=\"#{behaviorTestController.countAction1}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener1}\"/>\n+      </tc:button>\n+      <tc:button id=\"simpleAjax\" label=\"Simple Ajax\">\n+        <f:ajax render=\"counter operationTestBox\" listener=\"#{behaviorTestController.countAjaxListener1}\"/>\n+      </tc:button>\n+\n+      <tc:button id=\"simpleEventAjax\" label=\"Simple EventAjax\">\n+        <tc:event>\n+          <f:ajax render=\"counter operationTestBox\" listener=\"#{behaviorTestController.countAjaxListener1}\"/>\n+        </tc:event>\n+      </tc:button>\n+      <p/>\n+    </tc:section>\n+\n+    <tc:section label=\"Advanced\">\n+      <tc:selectOneRadio id=\"advancedSelector\" value=\"#{behaviorTestController.selector}\">\n+        <tc:selectItem itemValue=\"1\" itemLabel=\"Event 1 + no Ajax enabled\"/>\n+        <tc:selectItem itemValue=\"2\" itemLabel=\"Event 2 + Ajax 3 enabled\"/>\n+        <tc:selectItem itemValue=\"3\" itemLabel=\"Event 3 + all Ajax enabled\"/>\n+        <tc:event action=\"#{behaviorTestController.submitSelection}\"/>\n+      </tc:selectOneRadio>\n+      <tc:separator/>\n+\n+      <tc:button id=\"advancedButton\" label=\"Advanced Button\"\n+                 action=\"#{behaviorTestController.countButtonAction}\"\n+                 actionListener=\"#{behaviorTestController.countButtonActionListener}\">\n+        <tc:event event=\"dblclick\" action=\"#{behaviorTestController.countAction1}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener1}\"\n+                  rendered=\"#{behaviorTestController.eventEnabled1}\">\n+          <f:ajax execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\"operationTestBox\"/>\n+        </tc:event>\n+        <tc:event event=\"dblclick\" action=\"#{behaviorTestController.countAction2}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener2}\"\n+                  disabled=\"#{!behaviorTestController.eventEnabled2}\">\n+          <f:ajax execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\"operationTestBox\"/>\n+        </tc:event>\n+        <tc:event action=\"#{behaviorTestController.countAction3}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener3}\"\n+                  rendered=\"#{behaviorTestController.eventEnabled3}\">\n+          <f:ajax execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\"operationTestBox\" render=\"counter operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\"operationTestBox\"/>\n+        </tc:event>\n+      </tc:button>\n+    </tc:section>\n+  </tc:section>\n+\n+  <tc:section label=\"&lt;tc:row>\">\n+    <tc:sheet id=\"sheet\" value=\"#{sheetController.solarList}\" var=\"object\" markup=\"small\">\n+      <tc:style maxHeight=\"100px\"/>\n+      <tc:column label=\"Solarobjects\">\n+        <tc:out value=\"#{object.name}\" labelLayout=\"skip\"/>\n+      </tc:column>\n+      <tc:row id=\"row\">\n+        <tc:event id=\"e1\" event=\"dblclick\" action=\"#{behaviorTestController.countAction1}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener1}\"\n+                  rendered=\"#{behaviorTestController.eventEnabled1}\">\n+          <f:ajax execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\":::operationTestBox\"/>\n+        </tc:event>\n+        <tc:event id=\"e2\" event=\"dblclick\" action=\"#{behaviorTestController.countAction2}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener2}\"\n+                  disabled=\"#{!behaviorTestController.eventEnabled2}\">\n+          <f:ajax execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\":::operationTestBox\"/>\n+        </tc:event>\n+        <tc:event id=\"e3\" action=\"#{behaviorTestController.countAction3}\"\n+                  actionListener=\"#{behaviorTestController.countActionListener3}\"\n+                  rendered=\"#{behaviorTestController.eventEnabled3}\">\n+          <f:ajax execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener1}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled1}\"/>\n+          <f:ajax event=\"blur\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener2}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled2}\"/>\n+          <f:ajax event=\"focus\" execute=\":::operationTestBox\" render=\":::counter :::operationTestBox\"\n+                  listener=\"#{behaviorTestController.countAjaxListener3}\"\n+                  disabled=\"#{!behaviorTestController.ajaxEnabled3}\"/>\n+          <tc:operation name=\"show\" for=\":::operationTestBox\"/>\n+        </tc:event>\n+      </tc:row>\n+    </tc:sheet>\n+  </tc:section>\n+\n+  <tc:section label=\"&lt;tc:in>\">\n+    <tc:in id=\"inputClick\" label=\"Event Input (click)\">\n+      <tc:event id=\"inputEventClick\" event=\"click\">\n+        <tc:operation for=\"operationTestBox\" name=\"show\"/>\n+      </tc:event>\n+    </tc:in>\n+  </tc:section>\n+</ui:composition>", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/40-test/6500-behavior/behavior.xhtml"}, {"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/test/java/org/apache/myfaces/tobago/example/demo/QUnitTests.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fa9d600c94068b46d3508e88065bd100fb80effd/tobago-example/tobago-example-demo/src/test/java/org/apache/myfaces/tobago/example/demo/QUnitTests.java", "sha": "8f44840739f8c51757615de848eb3f5f58c4a8fe", "changes": 6, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/test/java/org/apache/myfaces/tobago/example/demo/QUnitTests.java?ref=fa9d600c94068b46d3508e88065bd100fb80effd", "patch": "@@ -555,4 +555,10 @@ public void ajaxSpecialCharacter() throws UnsupportedEncodingException, Interrup\n     final String page = \"content/40-test/50000-java/30-ajax-special-character/ajax-special-character.xhtml\";\n     runStandardTest(page);\n   }\n+\n+  @Test\n+  public void testBehavior() throws UnsupportedEncodingException, InterruptedException {\n+    final String page = \"content/40-test/6500-behavior/behavior.xhtml\";\n+    runStandardTest(page);\n+  }\n }", "filename": "tobago-example/tobago-example-demo/src/test/java/org/apache/myfaces/tobago/example/demo/QUnitTests.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/c0264a7fe1e695f514041c727d1d08810b27b8f3", "parent": "https://github.com/apache/myfaces-tobago/commit/602e6bf160a8f708160841b765ea5ffdb50c0848", "message": "TOBAGO-1171: Support for the Content Security Policy (CSP)\n NPE", "bug_id": "myfaces-tobago_41", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c0264a7fe1e695f514041c727d1d08810b27b8f3/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c0264a7fe1e695f514041c727d1d08810b27b8f3/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java", "sha": "0fde239cf2573726ca7bdfcead2f1f0cb0beb0c3", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java?ref=c0264a7fe1e695f514041c727d1d08810b27b8f3", "patch": "@@ -177,7 +177,7 @@\n   private final CspHeader cspHeader;\n \n   private UserAgent(String name, String version) {\n-    this(name, version, EnumSet.of(Capability.CONTENT_TYPE_XHTML), null);\n+    this(name, version, EnumSet.of(Capability.CONTENT_TYPE_XHTML));\n   }\n \n   private UserAgent(String name, String version, EnumSet<Capability> capabilities) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/context/UserAgent.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/fbca537a53540c408c6630f9aee96b10023cf435", "parent": "https://github.com/apache/myfaces-tobago/commit/53abf54cb8685e893085f8aa7c13fc8d5bdde415", "message": "TOBAGO-1078: Optimize auto layout for sheet\n - avoid NPE", "bug_id": "myfaces-tobago_42", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/fbca537a53540c408c6630f9aee96b10023cf435/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/fbca537a53540c408c6630f9aee96b10023cf435/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java", "sha": "8c428cd123201f898c8e6515b938f93ea8dbebc7", "changes": 8, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java?ref=fbca537a53540c408c6630f9aee96b10023cf435", "patch": "@@ -243,8 +243,12 @@ private void renderSheet(FacesContext facesContext, UISheet sheet, boolean hasCl\n     bodyStyle.setHeight(null);\n     bodyStyle.setTop(null);\n     Style sheetBodyStyle = new Style(bodyStyle);\n-    if (sheet.getNeedVerticalScrollbar()) {\n-      tableBodyWidth = tableBodyWidth.subtractNotNegative(getVerticalScrollbarWeight(facesContext, sheet));\n+    if (sheet.getNeedVerticalScrollbar() == null) {\n+      LOG.warn(\"Value of needVerticalScrollbar undefined!\"); // why this value isn't set by the layout manager?\n+    } else {\n+      if (sheet.getNeedVerticalScrollbar()) {\n+        tableBodyWidth = tableBodyWidth.subtractNotNegative(getVerticalScrollbarWeight(facesContext, sheet));\n+      }\n     }\n     sheetBodyStyle.setWidth(tableBodyWidth);\n ", "filename": "tobago-theme/tobago-theme-scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/6ee7b59cb816e95ec0a45c2542e89c3b87ae987c", "parent": "https://github.com/apache/myfaces-tobago/commit/5859e77d1b3b8c393295d5ddd74551867cbae4f9", "message": "TOBAGO-1435: New Layout: ColumnLayout which uses 12 columns (like Bootstrap)\n - fix: NPE when rendered=\"false\"", "bug_id": "myfaces-tobago_43", "file": [{"additions": 14, "raw_url": "https://github.com/apache/myfaces-tobago/raw/6ee7b59cb816e95ec0a45c2542e89c3b87ae987c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/ColumnLayoutRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/6ee7b59cb816e95ec0a45c2542e89c3b87ae987c/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/ColumnLayoutRenderer.java", "sha": "5e7942da1458f95c9fb63ea7a25c752bb7cb206b", "changes": 20, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/ColumnLayoutRenderer.java?ref=6ee7b59cb816e95ec0a45c2542e89c3b87ae987c", "patch": "@@ -72,12 +72,14 @@ public void encodeChildren(final FacesContext facesContext, final UIComponent co\n         columnLayout.getMedium(),\n         columnLayout.getLarge());\n     for (UIComponent child : children) {\n-      if (child instanceof UIExtensionPanel) {\n-        for (UIComponent subChild : child.getChildren()) {\n-          encodeChild(facesContext, writer, generator, subChild);\n+      if (child.isRendered()) {\n+        if (child instanceof UIExtensionPanel) {\n+          for (UIComponent subChild : child.getChildren()) {\n+            encodeChild(facesContext, writer, generator, subChild);\n+          }\n+        } else {\n+          encodeChild(facesContext, writer, generator, child);\n         }\n-      } else {\n-        encodeChild(facesContext, writer, generator, child);\n       }\n     }\n   }\n@@ -86,7 +88,13 @@ private void encodeChild(\n       final FacesContext facesContext, final TobagoResponseWriter writer,\n       final BootstrapCssGenerator generator, final UIComponent child) throws IOException {\n     if (child instanceof UILabel) {\n-      generator.generate(((UILabel) child).getCurrentCss());\n+      final UILabel label = (UILabel) child;\n+      Css currentCss = label.getCurrentCss();\n+      if (currentCss == null) {\n+        currentCss = new Css();\n+        label.setCurrentCss(currentCss);\n+      }\n+      generator.generate(currentCss);\n       RenderUtils.encode(facesContext, child);\n     } else {\n       writer.startElement(HtmlElements.DIV, null);", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/ColumnLayoutRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/8cf2961e45bf868eea3f5059ea4e556d87e5e205", "parent": "https://github.com/apache/myfaces-tobago/commit/c76173f82102be943b31aa13608614f76e9c50cd", "message": "TOBAGO-606: Layout-Manager\n - prevent NPE in unit tests", "bug_id": "myfaces-tobago_44", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/8cf2961e45bf868eea3f5059ea4e556d87e5e205/core/src/main/java/org/apache/myfaces/tobago/layout/math/AbstractEquation.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/8cf2961e45bf868eea3f5059ea4e556d87e5e205/core/src/main/java/org/apache/myfaces/tobago/layout/math/AbstractEquation.java", "sha": "d63ca587871c0ecfac4bc690ac39941915b13a0a", "changes": 7, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/layout/math/AbstractEquation.java?ref=8cf2961e45bf868eea3f5059ea4e556d87e5e205", "patch": "@@ -33,8 +33,11 @@ public void appendDebug(StringBuilder builder) {\n       UIComponent component = (UIComponent) debug;\n       builder.append(\" (\");\n       builder.append(component.getClass().getSimpleName());\n-      builder.append(\", id=\");\n-      builder.append(component.getClientId(FacesContext.getCurrentInstance()));\n+      FacesContext facesContext = FacesContext.getCurrentInstance();\n+      if (facesContext != null) {\n+        builder.append(\", id=\");\n+        builder.append(component.getClientId(facesContext));\n+      }\n       builder.append(\")\");\n     } else {\n       builder.append(\" (\");", "filename": "core/src/main/java/org/apache/myfaces/tobago/layout/math/AbstractEquation.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/2f10f35b67e6e9da058f6fe7ed91418a8b3683da", "parent": "https://github.com/apache/myfaces-tobago/commit/1d9c4eeea2da84cde81b5865c5782fb620c03005", "message": "(TOBAGO-176) prevent NPE when onclick is empty", "bug_id": "myfaces-tobago_45", "file": [{"additions": 3, "raw_url": "https://github.com/apache/myfaces-tobago/raw/2f10f35b67e6e9da058f6fe7ed91418a8b3683da/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/2f10f35b67e6e9da058f6fe7ed91418a8b3683da/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "sha": "3844f5953395b597f8c7540a096d273406b1e300", "changes": 4, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java?ref=2f10f35b67e6e9da058f6fe7ed91418a8b3683da", "patch": "@@ -356,7 +356,9 @@ private void renderTabGroupView(\n           // tool bar\n           UIMenuCommand menuItem = (UIMenuCommand) application.createComponent(UIMenuCommand.COMPONENT_TYPE);\n           menuItem.setRendererType(\"MenuCommand\");\n-          menuItem.getAttributes().put(ATTR_ONCLICK, onclick);\n+          if (onclick != null) {\n+            menuItem.getAttributes().put(ATTR_ONCLICK, onclick);\n+          }\n           Object label2 = tab.getAttributes().get(ATTR_LABEL);\n           if (label2 != null) {\n             menuItem.getAttributes().put(ATTR_LABEL, label2);", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/e057fbb11496c71d3e956ac59d936c99b9854222", "parent": "https://github.com/apache/myfaces-tobago/commit/b55d7ce871b15335d3912e3916109aeabb8b34ad", "message": "(TOBAGO-176) prevent NPE when label is empty", "bug_id": "myfaces-tobago_46", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/e057fbb11496c71d3e956ac59d936c99b9854222/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/e057fbb11496c71d3e956ac59d936c99b9854222/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "sha": "67b5e77ed7e91b7f9047f22ea277d3cbaeee63df", "changes": 5, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java?ref=e057fbb11496c71d3e956ac59d936c99b9854222", "patch": "@@ -357,7 +357,10 @@ private void renderTabGroupView(\n           UIMenuCommand menuItem = (UIMenuCommand) application.createComponent(UIMenuCommand.COMPONENT_TYPE);\n           menuItem.setRendererType(\"MenuCommand\");\n           menuItem.getAttributes().put(ATTR_ONCLICK, onclick);\n-          menuItem.getAttributes().put(ATTR_LABEL, tab.getAttributes().get(ATTR_LABEL));\n+          Object label2 = tab.getAttributes().get(ATTR_LABEL);\n+          if (label2 != null) {\n+            menuItem.getAttributes().put(ATTR_LABEL, label2);\n+          }\n           menu.getChildren().add(menuItem);\n \n         }", "filename": "theme/scarborough/src/main/java/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/27469a2d4d91583f9633cdcf592e9bf4cb8e6c90", "parent": "https://github.com/apache/myfaces-tobago/commit/feab1d9167d81e1c1bb3f8dab5b79ed1baf3d435", "message": "TOBAGO-297 ( tc:tree with rendered=false -> NPE in decodePhase)", "bug_id": "myfaces-tobago_47", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/27469a2d4d91583f9633cdcf592e9bf4cb8e6c90/sandbox/src/main/java/org/apache/myfaces/tobago/component/UITree.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/27469a2d4d91583f9633cdcf592e9bf4cb8e6c90/sandbox/src/main/java/org/apache/myfaces/tobago/component/UITree.java", "sha": "83340ac2e7d7f320855b6076d12c3f8b06179aaa", "changes": 5, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/sandbox/src/main/java/org/apache/myfaces/tobago/component/UITree.java?ref=27469a2d4d91583f9633cdcf592e9bf4cb8e6c90", "patch": "@@ -192,6 +192,11 @@ public boolean isSelectableTree() {\n   }\n \n   public void processDecodes(FacesContext facesContext) {\n+\n+    if (!isRendered()) {\n+      return;\n+    }\n+\n     if (ComponentUtil.isOutputOnly(this)) {\n       setValid(true);\n     } else {", "filename": "sandbox/src/main/java/org/apache/myfaces/tobago/component/UITree.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/feab1d9167d81e1c1bb3f8dab5b79ed1baf3d435", "parent": "https://github.com/apache/myfaces-tobago/commit/0b73c08c81cfed7ea1ae13c24692b37a1e7256f1", "message": "TOBAGO-297 ( tc:tree with rendered=false -> NPE in decodePhase)", "bug_id": "myfaces-tobago_48", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/feab1d9167d81e1c1bb3f8dab5b79ed1baf3d435/core/src/main/java/org/apache/myfaces/tobago/component/UITreeOld.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/feab1d9167d81e1c1bb3f8dab5b79ed1baf3d435/core/src/main/java/org/apache/myfaces/tobago/component/UITreeOld.java", "sha": "d747c69c22ab4fad4951e2dbff044290d5ebc6d1", "changes": 5, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/component/UITreeOld.java?ref=feab1d9167d81e1c1bb3f8dab5b79ed1baf3d435", "patch": "@@ -283,6 +283,11 @@ public boolean isSelectableTree() {\n   }\n \n   public void processDecodes(FacesContext facesContext) {\n+\n+    if (!isRendered()) {\n+      return;\n+    }\n+    \n     if (ComponentUtil.isOutputOnly(this)) {\n       setValid(true);\n     } else {", "filename": "core/src/main/java/org/apache/myfaces/tobago/component/UITreeOld.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/e5fa38c1130a33a2d02dec7df2da404281dfdd03", "parent": "https://github.com/apache/myfaces-tobago/commit/96f658d2e4a21e788c0e62590a039b1d26963cc2", "message": "bugfix, prevent NPE in ResourceManagerImpl if using getDefaultClientProperties", "bug_id": "myfaces-tobago_49", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/e5fa38c1130a33a2d02dec7df2da404281dfdd03/core/src/main/org/apache/myfaces/tobago/context/ClientProperties.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/e5fa38c1130a33a2d02dec7df2da404281dfdd03/core/src/main/org/apache/myfaces/tobago/context/ClientProperties.java", "sha": "1183c682c266fa61d3184785195164818634a07b", "changes": 11, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/org/apache/myfaces/tobago/context/ClientProperties.java?ref=e5fa38c1130a33a2d02dec7df2da404281dfdd03", "patch": "@@ -52,8 +52,9 @@\n \n // ///////////////////////////////////////////// constructors\n \n-  private ClientProperties() {\n-    theme = null; // fixme\n+  private ClientProperties(TobagoConfig tobagoConfig) {\n+    theme = tobagoConfig.getDefaultTheme();\n+    updateId();\n   }\n \n   private ClientProperties(FacesContext facesContext) {\n@@ -104,7 +105,7 @@ private void updateId() {\n     buffer.append(getTheme());\n     buffer.append('/');\n     buffer.append(getUserAgent());\n-    id =  buffer.toString();\n+    id = buffer.toString();\n     final UIViewRoot viewRoot = FacesContext.getCurrentInstance().getViewRoot();\n     if (viewRoot instanceof org.apache.myfaces.tobago.component.UIViewRoot) {\n       ((org.apache.myfaces.tobago.component.UIViewRoot)viewRoot).updateRendererCachePrefix();\n@@ -113,8 +114,8 @@ private void updateId() {\n \n // ///////////////////////////////////////////// logic\n \n-  public static ClientProperties getDefaultInstance() {\n-    return new ClientProperties();\n+  public static ClientProperties getDefaultInstance(FacesContext facesContext) {\n+    return new ClientProperties(TobagoConfig.getInstance(facesContext));\n   }\n \n   public static ClientProperties getInstance(UIViewRoot viewRoot) {", "filename": "core/src/main/org/apache/myfaces/tobago/context/ClientProperties.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/159dad39440512748fec128841eca3a845807d08", "parent": "https://github.com/apache/myfaces-tobago/commit/7e6617decde717a723262de33757ff8649fd6c5f", "message": "TOBAGO-1431 - NPE decoding tree state [Merged from trunk: revision 1645621]", "bug_id": "myfaces-tobago_50", "file": [{"additions": 20, "raw_url": "https://github.com/apache/myfaces-tobago/raw/159dad39440512748fec128841eca3a845807d08/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/159dad39440512748fec128841eca3a845807d08/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java", "sha": "a44f0ae4e6dbaf80b44b213e414d1ec0f25f7c7e", "changes": 36, "status": "modified", "deletions": 16, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java?ref=159dad39440512748fec128841eca3a845807d08", "patch": "@@ -259,27 +259,31 @@ public static void decodedStateOfTreeData(final FacesContext facesContext, final\n       final TreePath path = data.getPath();\n \n       // selected\n-      final SelectedState selectedState = data.getSelectedState();\n-      final boolean oldSelected = selectedState.isSelected(path);\n-      final boolean newSelected = selectedIndices.contains(rowIndex);\n-      if (newSelected != oldSelected) {\n-        if (newSelected) {\n-          selectedState.select(path);\n-        } else {\n-          selectedState.unselect(path);\n+      if (selectedIndices != null) {\n+        final SelectedState selectedState = data.getSelectedState();\n+        final boolean oldSelected = selectedState.isSelected(path);\n+        final boolean newSelected = selectedIndices.contains(rowIndex);\n+        if (newSelected != oldSelected) {\n+          if (newSelected) {\n+            selectedState.select(path);\n+          } else {\n+            selectedState.unselect(path);\n+          }\n         }\n       }\n \n       // expanded\n       if (expandedIndices != null) {\n-        final ExpandedState expandedState = data.getExpandedState();\n-        final boolean oldExpanded = expandedState.isExpanded(path);\n-        final boolean newExpanded = expandedIndices.contains(rowIndex);\n-        if (newExpanded != oldExpanded) {\n-          if (newExpanded) {\n-            expandedState.expand(path);\n-          } else {\n-            expandedState.collapse(path);\n+        if (expandedIndices != null) {\n+          final ExpandedState expandedState = data.getExpandedState();\n+          final boolean oldExpanded = expandedState.isExpanded(path);\n+          final boolean newExpanded = expandedIndices.contains(rowIndex);\n+          if (newExpanded != oldExpanded) {\n+            if (newExpanded) {\n+              expandedState.expand(path);\n+            } else {\n+              expandedState.collapse(path);\n+            }\n           }\n         }\n       }", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/util/RenderUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/2ed3c0c3621c8f7c7e0720f15cce52ccfb515382", "parent": "https://github.com/apache/myfaces-tobago/commit/0372910d981cdeea1253ec4274ac37d9f5c01c1f", "message": "Merged from trunk\nfixing NPE when there is no UITreeSelect [from revision 1640548]", "bug_id": "myfaces-tobago_51", "file": [{"additions": 14, "raw_url": "https://github.com/apache/myfaces-tobago/raw/2ed3c0c3621c8f7c7e0720f15cce52ccfb515382/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/2ed3c0c3621c8f7c7e0720f15cce52ccfb515382/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java", "sha": "4ddb839f67c9f00572a02804ad36d26ef7d8a024", "changes": 17, "status": "modified", "deletions": 3, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java?ref=2ed3c0c3621c8f7c7e0720f15cce52ccfb515382", "patch": "@@ -20,6 +20,7 @@\n package org.apache.myfaces.tobago.renderkit.html.standard.standard.tag;\n \n import org.apache.myfaces.tobago.component.RendererTypes;\n+import org.apache.myfaces.tobago.component.UITreeLabel;\n import org.apache.myfaces.tobago.component.UITreeNode;\n import org.apache.myfaces.tobago.component.UITreeSelect;\n import org.apache.myfaces.tobago.internal.component.AbstractUITree;\n@@ -174,11 +175,21 @@ private void encodeSelectBox(\n     writer.writeAttribute(HtmlAttributes.SIZE, 9); // must be > 1, but the real size comes from the layout\n //    writer.writeAttribute(HtmlAttributes.MULTIPLE, siblingMode);\n \n-    final UITreeSelect label = ComponentUtils.findDescendant(tree, UITreeSelect.class);\n-    final Object labelValue = label.getLabel();\n+    final UITreeSelect select = ComponentUtils.findDescendant(tree, UITreeSelect.class);\n+    final String labelValue;\n+    if (select != null) {\n+      labelValue = select.getLabel();\n+    } else {\n+      final UITreeLabel label = ComponentUtils.findDescendant(tree, UITreeLabel.class);\n+      if (label != null) {\n+        labelValue = label.getLabel();\n+      } else {\n+        labelValue = null;\n+      }\n+    }\n     if (labelValue != null) {\n       writer.startElement(HtmlElements.OPTGROUP, tree);\n-      writer.writeAttribute(HtmlAttributes.LABEL, labelValue.toString(), true);\n+      writer.writeAttribute(HtmlAttributes.LABEL, labelValue, true);\n       writer.endElement(HtmlElements.OPTGROUP);\n     }\n ", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/TreeListboxRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "parent": "https://github.com/apache/myfaces-tobago/commit/9f4c443a30ba81e1a026508b6b408cacf423d5d3", "message": "TOBAGO-1818 Progress in the Measure class (cleanup and CSS support)\n* update javadoc for *ListEditor classes\n* tc:segmentLayout margins can now separated by space\n* adjust description for segment layout attributes\n* fix NPE: BootstrapClass.valueOf(Measure, Attributes)\n* correct segment values greater than 12 or lower than 1 and log it\n* fix SegmentLayoutConstraint overwrite attributes\n* add a test for BootstrapClass.valueOf(Measure, Attributes)\n* improve segment layout demo page", "bug_id": "myfaces-tobago_52", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutConstraintTagDeclaration.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutConstraintTagDeclaration.java", "sha": "473b7ecca8dc0c588d7e72b1e11555509cb4c7ee", "changes": 10, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutConstraintTagDeclaration.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -36,35 +36,35 @@\n \n   /**\n    * Overwrite the default layout for extra small devices.\n-   * Possible values are: integer value &gt; 0, 'auto' and '*'.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n    */\n   @TagAttribute\n   void setExtraSmall(final ValueExpression extraSmall);\n \n   /**\n    * Overwrite the default layout for small devices.\n-   * Possible values are: integer value &gt; 0, 'auto' and '*'.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n    */\n   @TagAttribute\n   void setSmall(final ValueExpression small);\n \n   /**\n    * Overwrite the default layout for medium devices.\n-   * Possible values are: integer value &gt; 0, 'auto' and '*'.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n    */\n   @TagAttribute\n   void setMedium(final ValueExpression medium);\n \n   /**\n    * Overwrite the default layout for large devices.\n-   * Possible values are: integer value &gt; 0, 'auto' and '*'.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n    */\n   @TagAttribute\n   void setLarge(final ValueExpression large);\n \n   /**\n    * Overwrite the default layout for extra large devices.\n-   * Possible values are: integer value &gt; 0, 'auto' or '*'.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n    */\n   @TagAttribute\n   void setExtraLarge(final ValueExpression extraLarge);", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutConstraintTagDeclaration.java"}, {"additions": 25, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutTagDeclaration.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutTagDeclaration.java", "sha": "cdaeeefd8b88d3ce6a9a47dc061cae6ad0da37c2", "changes": 50, "status": "modified", "deletions": 25, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutTagDeclaration.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -49,90 +49,90 @@\n public interface SegmentLayoutTagDeclaration extends HasIdBindingAndRendered, IsVisual {\n \n   /**\n-   * The semicolon-separated definition of the columns for extra small devices.\n-   * Possible values are: integer values &gt; 0, 'auto' and '*'.\n-   * Example: '1;5;*;auto'\n+   * The space-separated definition of the columns for extra small devices.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n+   * Example: '1seg 5seg * auto'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.SegmentMeasureList\")\n   void setExtraSmall(String extraSmall);\n \n   /**\n-   * The semicolon-separated definition of the columns for small devices.\n-   * Possible values are: integer values &gt; 0, 'auto' and '*'.\n-   * Example: '1;5;*;auto'\n+   * The space-separated definition of the columns for small devices.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n+   * Example: '1seg 5seg * auto'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.SegmentMeasureList\")\n   void setSmall(String small);\n \n   /**\n-   * The semicolon-separated definition of the columns for medium devices.\n-   * Possible values are: integer values &gt; 0, 'auto' and '*'.\n-   * Example: '1;5;*;auto'\n+   * The space-separated definition of the columns for medium devices.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n+   * Example: '1seg 5seg * auto'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.SegmentMeasureList\")\n   void setMedium(String medium);\n \n   /**\n-   * The semicolon-separated definition of the columns for large devices.\n-   * Possible values are: integer values &gt; 0, 'auto' and '*'.\n-   * Example: '1;5;*;auto'\n+   * The space-separated definition of the columns for large devices.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n+   * Example: '1seg 5seg * auto'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.SegmentMeasureList\")\n   void setLarge(String large);\n \n   /**\n-   * The semicolon-separated definition of the columns for extra large devices.\n-   * Possible values are: integer values &gt; 0, 'auto' and '*'.\n-   * Example: '1;5;*;auto'\n+   * The space-separated definition of the columns for extra large devices.\n+   * Possible values are: segment values between 1 and 12, 'auto' and '*'.\n+   * Example: '1seg 5seg * auto'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute(type = \"org.apache.myfaces.tobago.layout.SegmentMeasureList\")\n   void setExtraLarge(String extraLarge);\n \n   /**\n-   * The semicolon-separated definition of the column margins for extra small devices.\n+   * The space-separated definition of the column margins for extra small devices.\n    * Allowed values are: none, left, right, both\n-   * Example: 'left;none;both'\n+   * Example: 'left none both'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute\n   void setMarginExtraSmall(String marginExtraSmall);\n \n   /**\n-   * The semicolon-separated definition of the column margins for small devices.\n+   * The space-separated definition of the column margins for small devices.\n    * Allowed values are: none, left, right, both\n-   * Example: 'left;none;both'\n+   * Example: 'left none both'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute\n   void setMarginSmall(String marginSmall);\n \n   /**\n-   * The semicolon-separated definition of the column margins for medium devices.\n+   * The space-separated definition of the column margins for medium devices.\n    * Allowed values are: none, left, right, both\n-   * Example: 'left;none;both'\n+   * Example: 'left none both'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute\n   void setMarginMedium(String marginMedium);\n \n   /**\n-   * The semicolon-separated definition of the column margins for large devices.\n+   * The space-separated definition of the column margins for large devices.\n    * Allowed values are: none, left, right, both\n-   * Example: 'left;none;both'\n+   * Example: 'left none both'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute\n   void setMarginLarge(String marginLarge);\n \n   /**\n-   * The semicolon-separated definition of the column margins for extra large devices.\n+   * The space-separated definition of the column margins for extra large devices.\n    * Allowed values are: none, left, right, both\n-   * Example: 'left;none;both'\n+   * Example: 'left none both'\n    */\n   @TagAttribute\n   @UIComponentTagAttribute", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/taglib/component/SegmentLayoutTagDeclaration.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MarginTokens.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MarginTokens.java", "sha": "bfa5501e0001c9d24db7c7dd74cadd450c814770", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MarginTokens.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -53,7 +53,7 @@ public static MarginTokens parse(final String tokens) {\n       return null;\n     }\n     final MarginTokens marginTokens = new MarginTokens();\n-    final StringTokenizer tokenizer = new StringTokenizer(tokens, \";\");\n+    final StringTokenizer tokenizer = new StringTokenizer(tokens, \"; \");\n \n     while (tokenizer.hasMoreTokens()) {\n       final String token = tokenizer.nextToken().trim();", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MarginTokens.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MeasureListEditor.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MeasureListEditor.java", "sha": "9914a9d660f8c8d5fc5fb261c2c0c52e61d0d89d", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MeasureListEditor.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -22,7 +22,7 @@\n import java.beans.PropertyEditorSupport;\n \n /**\n- * Converter for {@link Measure}\n+ * Converter for {@link MeasureList}\n  */\n public class MeasureListEditor extends PropertyEditorSupport {\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/layout/MeasureListEditor.java"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/SegmentMeasureListEditor.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/SegmentMeasureListEditor.java", "sha": "e2336b07031480ba634e61599d2ee4616751f3a9", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/layout/SegmentMeasureListEditor.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -24,7 +24,7 @@\n import java.beans.PropertyEditorSupport;\n \n /**\n- * Converter for {@link Measure}\n+ * Converter for {@link SegmentMeasureList}\n  */\n @Preliminary\n public class SegmentMeasureListEditor extends PropertyEditorSupport {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/layout/SegmentMeasureListEditor.java"}, {"additions": 28, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClass.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClass.java", "sha": "150ac9e78c0779f8d4f651307295204fcf9fdc64", "changes": 42, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClass.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -39,7 +39,6 @@\n \n /**\n  * CSS classes for the Bootstrap Library.\n- *\n  * @since 3.0.0\n  */\n public enum BootstrapClass implements CssItem {\n@@ -663,16 +662,30 @@ private void generate(\n       Object overwrite = attributes.get(attribute.name());\n \n       if (overwrite != null) {\n-        final Measure measure = Measure.valueOf(overwrite);\n-        final BootstrapClass bootstrapClass = valueOf(measure, attribute);\n+        final Measure measure = Measure.valueOf(overwrite.toString(), Measure.Unit.SEG);\n+        final BootstrapClass bootstrapClass = valueOf(getSegmentMeasure(measure), attribute);\n         result.add(bootstrapClass);\n       } else if (tokens != null) {\n         final Measure measure = tokens.get(index % tokens.getSize());\n-        final BootstrapClass bootstrapClass = valueOf(measure, attribute);\n+        final BootstrapClass bootstrapClass = valueOf(getSegmentMeasure(measure), attribute);\n         result.add(bootstrapClass);\n       }\n     }\n \n+    private Measure getSegmentMeasure(final Measure measure) {\n+      if (measure != null && Measure.Unit.SEG.equals(measure.getUnit())) {\n+        int number = (int) measure.getValue();\n+        if (number < 1) {\n+          LOG.warn(\"Segment values must been between 1 and 12. Use '1' instead of '{}'.\", number);\n+          return new Measure(1, Measure.Unit.SEG);\n+        } else if (number > 12) {\n+          LOG.warn(\"Segment values must been between 1 and 12. Use '12' instead of '{}'.\", number);\n+          return new Measure(12, Measure.Unit.SEG);\n+        }\n+      }\n+      return measure;\n+    }\n+\n     private void generate(final List<BootstrapClass> result, final MarginTokens margins,\n         final Map<String, Object> attributes, final Attributes attribute) {\n       Object overwrite = attributes.get(attribute.name());\n@@ -702,17 +715,18 @@ private void generateOffset(final List<BootstrapClass> result, final Object offs\n   public static BootstrapClass valueOf(Measure measure, Attributes attributes) {\n     final String size = getSizeSuffix(attributes);\n \n-    if (measure.getUnit() == Measure.Unit.FR) {\n-      return valueOf(\"COL\" + size);\n-    } else if (measure.getUnit() == Measure.Unit.AUTO) {\n-      return valueOf(\"COL\" + size + \"_AUTO\");\n-    } else if (measure.getUnit() == Measure.Unit.SEG) {\n-      final float value = measure.getValue();\n-      return valueOf(\n-          \"COL\" + size + \"_\" + (value == (long) value ? Long.toString((long) value) : Float.toString(value)));\n-    } else {\n-      return null;\n+    if (measure != null) {\n+      if (measure.getUnit() == Measure.Unit.FR) {\n+        return valueOf(\"COL\" + size);\n+      } else if (measure.getUnit() == Measure.Unit.AUTO) {\n+        return valueOf(\"COL\" + size + \"_AUTO\");\n+      } else if (measure.getUnit() == Measure.Unit.SEG) {\n+        final float value = measure.getValue();\n+        return valueOf(\n+            \"COL\" + size + \"_\" + (value == (long) value ? Long.toString((long) value) : Float.toString(value)));\n+      }\n     }\n+    return null;\n   }\n \n   public static BootstrapClass valueOf(Margin margin, Attributes attribute) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClass.java"}, {"additions": 16, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/16-layout/30-segment/segment-layout.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/16-layout/30-segment/segment-layout.xhtml", "sha": "462b882ca3268539fcbc56d089e88818a5d01270", "changes": 32, "status": "modified", "deletions": 16, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/16-layout/30-segment/segment-layout.xhtml?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -33,8 +33,8 @@\n     <p>This example show a segment layout with four and three columns and a segment layout with 'auto' and '*'.</p>\n     <tc:section label=\"4 Columns\">\n       <p>The sum of the values is 12.</p>\n-      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2;3;4;3\"></code></pre>\n-      <tc:segmentLayout extraSmall=\"2;3;4;3\">\n+      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2seg 3seg 4seg 3seg\"></code></pre>\n+      <tc:segmentLayout extraSmall=\"2seg 3seg 4seg 3seg\">\n         <tc:in value=\"2\"/>\n         <tc:in value=\"3\"/>\n         <tc:in value=\"4\"/>\n@@ -48,8 +48,8 @@\n     <tc:section label=\"5 Columns\">\n       <p>The sum of the values is 8. After the third element, the sequence starts from the beginning.\n         So the fourth element got a value of 2.</p>\n-      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2;2;4\"></code></pre>\n-      <tc:segmentLayout extraSmall=\"2;2;4\">\n+      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2seg 2seg 4seg\"></code></pre>\n+      <tc:segmentLayout extraSmall=\"2seg 2seg 4seg\">\n         <tc:in value=\"2\"/>\n         <tc:in value=\"2\"/>\n         <tc:in value=\"4\"/>\n@@ -59,8 +59,8 @@\n       </tc:segmentLayout>\n     </tc:section>\n     <tc:section label=\"'auto' and '*'\">\n-      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"*;auto;*\"></code></pre>\n-      <tc:segmentLayout extraSmall=\"*;auto;*\">\n+      <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"* auto *\"></code></pre>\n+      <tc:segmentLayout extraSmall=\"* auto *\">\n         <tc:panel>\n           <tc:style customClass=\"blue\"/>\n           <p>the remaining space</p>\n@@ -85,11 +85,11 @@\n       <code>small</code> and <code>extraSmall</code>.</p>\n     <p>In the following example, all attributes are used. If you are on a desktop you can see the different\n       behavior by changing the size of the browser window.</p>\n-    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraLarge=\"1\" large=\"2\"\n-      medium=\"3\" small=\"4\" extraSmall=\"6\">\n+    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraLarge=\"1seg\" large=\"2seg\"\n+      medium=\"3seg\" small=\"4seg\" extraSmall=\"6seg\">\n     ...</code></pre>\n \n-    <tc:segmentLayout extraLarge=\"1\" large=\"2\" medium=\"3\" small=\"4\" extraSmall=\"6\">\n+    <tc:segmentLayout extraLarge=\"1seg\" large=\"2seg\" medium=\"3seg\" small=\"4seg\" extraSmall=\"6seg\">\n       <tc:in value=\"1\"/>\n       <tc:in value=\"2\"/>\n       <tc:in value=\"3\"/>\n@@ -111,10 +111,10 @@\n       <code>marginExtraLarge</code>.</p>\n     <p>Possible values are <code>none</code>, <code>left</code>, <code>right</code> and <code>both</code>.</p>\n \n-    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"5;3\"\n-      marginExtraSmall=\"none;both;left;both\">\n+    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"5seg 3seg\"\n+      marginExtraSmall=\"none both left both\">\n     ...</code></pre>\n-    <tc:segmentLayout extraSmall=\"5;3\" marginExtraSmall=\"none;both;left;both\">\n+    <tc:segmentLayout extraSmall=\"5seg 3seg\" marginExtraSmall=\"none both left both\">\n       <tc:in value=\"none\"/>\n       <tc:in value=\"both\"/>\n       <tc:in value=\"none\"/>\n@@ -132,15 +132,15 @@\n     <p>Possible values are from 1 to 11 for <code>offsetExtraSmall</code>.<br/>\n       For the other attributes possible values are from 0 to 11.<br/>\n       A <code>offsetMedium=\"0\"</code> overwrite the offset from smaller proportions.</p>\n-    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2;2;2;2;2;2\">\n+    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"2seg 2seg 2seg 2seg 2seg 2seg\">\n   &lt;tc:in value=\"1\"/>\n   &lt;tc:in value=\"2\">\n     &lt;tc:segmentLayoutConstraint offsetExtraSmall=\"1\" offsetSmall=\"2\"\n       offsetMedium=\"3\" offsetLarge=\"4\" offsetExtraLarge=\"5\"/>\n   &lt;/tc:in>\n   ...\n &lt;/tc:segmentLayout></code></pre>\n-    <tc:segmentLayout extraSmall=\"2;2;2;2;2;2\">\n+    <tc:segmentLayout extraSmall=\"2seg 2seg 2seg 2seg 2seg 2seg\">\n       <tc:in value=\"1\"/>\n       <tc:in value=\"2\">\n         <tc:segmentLayoutConstraint offsetExtraSmall=\"1\" offsetSmall=\"2\" offsetMedium=\"3\" offsetLarge=\"4\"\n@@ -166,15 +166,15 @@\n       <code>extraLarge</code> for the layout.<br/>\n       And: <code>marginExtraSmall</code>, <code>marginSmall</code>, <code>marginMedium</code>, <code>marginLarge</code>,\n       <code>marginExtraLarge</code> for the margins.</p>\n-    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"4;8\">\n+    <pre><code class=\"language-markup\">&lt;tc:segmentLayout extraSmall=\"4seg 8seg\">\n   &lt;tc:in value=\"4\"/>\n   &lt;tc:in value=\"8\"/>\n   &lt;tc:in value=\"3 - both\">\n     &lt;tc:segmentLayoutConstraint extraSmall=\"3\" marginExtraSmall=\"both\"/>\n   &lt;/tc:in>\n   &lt;tc:in value=\"8\"/>\n &lt;/tc:segmentLayout></code></pre>\n-    <tc:segmentLayout extraSmall=\"4;8\">\n+    <tc:segmentLayout extraSmall=\"4seg 8seg\">\n       <tc:in value=\"4\"/>\n       <tc:in value=\"8\"/>\n       <tc:in value=\"3 - both\">", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/30-concept/16-layout/30-segment/segment-layout.xhtml"}, {"additions": 18, "raw_url": "https://github.com/apache/myfaces-tobago/raw/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-theme/tobago-theme-standard/src/test/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClassUnitTest.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66/tobago-theme/tobago-theme-standard/src/test/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClassUnitTest.java", "sha": "695576f85a6295947223546caf93ce990fb27562", "changes": 18, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/test/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClassUnitTest.java?ref=c8732e61d4556e6c8e1fba5a660d2d7e7d7ddc66", "patch": "@@ -19,6 +19,8 @@\n \n package org.apache.myfaces.tobago.renderkit.css;\n \n+import org.apache.myfaces.tobago.component.Attributes;\n+import org.apache.myfaces.tobago.layout.Measure;\n import org.junit.Assert;\n import org.junit.Test;\n \n@@ -83,4 +85,20 @@ public void testCompareBootstrapCss() throws FileNotFoundException, NoSuchFieldE\n \n     Assert.assertTrue(\"These classes are missing in bootstrap.css: \" + missing, missing.isEmpty());\n   }\n+\n+  @Test\n+  public void testValueOfMeasureAttributes() {\n+    Assert.assertEquals(BootstrapClass.COL_1,\n+        BootstrapClass.valueOf(new Measure(\"1\", Measure.Unit.SEG), Attributes.extraSmall));\n+    Assert.assertEquals(BootstrapClass.COL_12,\n+        BootstrapClass.valueOf(new Measure(\"12\", Measure.Unit.SEG), Attributes.extraSmall));\n+    Assert.assertEquals(null,\n+        BootstrapClass.valueOf((Measure) null, Attributes.extraSmall));\n+    Assert.assertEquals(BootstrapClass.COL_MD_5,\n+        BootstrapClass.valueOf(new Measure(\"5\", Measure.Unit.SEG), Attributes.medium));\n+    Assert.assertEquals(BootstrapClass.COL_LG,\n+        BootstrapClass.valueOf(Measure.valueOf(\"*\"), Attributes.large));\n+    Assert.assertEquals(BootstrapClass.COL_XL_AUTO,\n+        BootstrapClass.valueOf(Measure.valueOf(\"auto\"), Attributes.extraLarge));\n+  }\n }", "filename": "tobago-theme/tobago-theme-standard/src/test/java/org/apache/myfaces/tobago/renderkit/css/BootstrapClassUnitTest.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e", "parent": "https://github.com/apache/myfaces-tobago/commit/58e366fc0c6a0ac868b839e7f36056006043c5b0", "message": "TOBAGO-1457: Sheet sort may be performed twice and possible NPE when using method binding for sorting", "bug_id": "myfaces-tobago_53", "file": [{"additions": 29, "raw_url": "https://github.com/apache/myfaces-tobago/raw/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "sha": "5c34b9c2d3741667ecc684d4a7780fcd500addc4", "changes": 43, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java?ref=5f3bfbaf48240c08d3bcd16993f244a49bad6f1e", "patch": "@@ -54,14 +54,18 @@\n import javax.faces.component.UINamingContainer;\n import javax.faces.context.FacesContext;\n import javax.faces.event.AbortProcessingException;\n+import javax.faces.event.ComponentSystemEvent;\n import javax.faces.event.FacesEvent;\n+import javax.faces.event.ListenerFor;\n import javax.faces.event.PhaseId;\n+import javax.faces.event.PreRenderComponentEvent;\n import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n+@ListenerFor(systemEventClass = PreRenderComponentEvent.class)\n public abstract class AbstractUISheet extends AbstractUIData\n     implements SheetStateChangeSource2, SortActionSource2, OnComponentPopulated,\n     LayoutContainer, LayoutComponent, SupportsRenderedPartially {\n@@ -113,18 +117,6 @@ public void encodeBegin(final FacesContext facesContext) throws IOException {\n       }\n     }\n \n-    final MethodExpression expression = getSortActionListenerExpression();\n-    if (expression != null) {\n-      try {\n-        FacesEvent facesEvent = new SortActionEvent(this, null);\n-        expression.invoke(facesContext.getELContext(), new Object[]{facesEvent});\n-      } catch (Exception e) {\n-        LOG.warn(\"Initial sorting not possible!\", e);\n-      }\n-    } else {\n-      new Sorter().perform(this);\n-    }\n-\n     super.encodeBegin(facesContext);\n   }\n \n@@ -456,12 +448,35 @@ public void broadcast(final FacesEvent facesEvent) throws AbortProcessingExcepti\n       }\n     } else if (facesEvent instanceof SortActionEvent) {\n       getSheetState(getFacesContext()).updateSortState((SortActionEvent) facesEvent);\n+      sort(getFacesContext(), (SortActionEvent) facesEvent);\n+    }\n+  }\n+\n+  public void processEvent(ComponentSystemEvent event) {\n+    super.processEvent(event);\n+    if (event instanceof PreRenderComponentEvent) {\n+      sort(getFacesContext(), null);\n+    }\n+  }\n+\n+  protected void sort(FacesContext facesContext, SortActionEvent event) {\n+    final SheetState sheetState = getSheetState(getFacesContext());\n+    if (sheetState.isToBeSorted()) {\n       final MethodExpression expression = getSortActionListenerExpression();\n       if (expression != null) {\n-        expression.invoke(getFacesContext().getELContext(), new Object[]{facesEvent});\n+        try {\n+          if (event == null) {\n+            event =\n+                new SortActionEvent(this, (UIColumn) findComponent(getSheetState(facesContext).getSortedColumnId()));\n+          }\n+          expression.invoke(facesContext.getELContext(), new Object[]{event});\n+        } catch (Exception e) {\n+          LOG.warn(\"Sorting not possible!\", e);\n+        }\n       } else {\n-        new Sorter().perform((SortActionEvent) facesEvent);\n+        new Sorter().perform(this);\n       }\n+      sheetState.setToBeSorted(false);\n     }\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java"}, {"additions": 7, "raw_url": "https://github.com/apache/myfaces-tobago/raw/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "sha": "3533ac1b1b6b56be5ccea2d09810a8bc3e46a51e", "changes": 7, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java?ref=5f3bfbaf48240c08d3bcd16993f244a49bad6f1e", "patch": "@@ -457,6 +457,13 @@ public static String defaultString(final String string) {\n     return string == null ? \"\" : string;\n   }\n \n+  /**\n+   * Basically taken from commons-lang\n+   */\n+  public static boolean notEquals(String a, String b) {\n+    return a == null ? b != null : !a.equals(b);\n+  }\n+\n   /**\n    * Checks if the String starts like a url, e.g. http: or xyz:\n    */", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java"}, {"additions": 21, "raw_url": "https://github.com/apache/myfaces-tobago/raw/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "sha": "9c62bb9d9b2f03fe534a4d8856999b07d9cf3214", "changes": 26, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java?ref=5f3bfbaf48240c08d3bcd16993f244a49bad6f1e", "patch": "@@ -40,6 +40,7 @@\n   private int first;\n   private String sortedColumnId;\n   private boolean ascending;\n+  private boolean toBeSorted;\n   private String columnWidths;\n   private List<Integer> selectedRows;\n   private Integer[] scrollPosition;\n@@ -54,6 +55,7 @@ public void reset() {\n     first = -1;\n     sortedColumnId = null;\n     ascending = true;\n+    toBeSorted = false;\n     columnWidths = null;\n     resetSelected();\n     if (expandedState != null) {\n@@ -83,15 +85,21 @@ public String getSortedColumnId() {\n   }\n \n   public void setSortedColumnId(final String sortedColumnId) {\n-    this.sortedColumnId = sortedColumnId;\n+    if (StringUtils.notEquals(this.sortedColumnId, sortedColumnId)) {\n+      this.sortedColumnId = sortedColumnId;\n+      toBeSorted = true;\n+    }\n   }\n \n   public boolean isAscending() {\n     return ascending;\n   }\n \n   public void setAscending(final boolean ascending) {\n-    this.ascending = ascending;\n+    if (this.ascending != ascending) {\n+      this.ascending = ascending;\n+      toBeSorted = true;\n+    }\n   }\n \n   public String getColumnWidths() {\n@@ -115,10 +123,10 @@ public void updateSortState(final SortActionEvent sortEvent) {\n     final UIColumn actualColumn = sortEvent.getColumn();\n \n     if (actualColumn.getId().equals(sortedColumnId)) {\n-      ascending = !ascending;\n+      setAscending(!isAscending());\n     } else {\n-      ascending = true;\n-      sortedColumnId = actualColumn.getId();\n+      setAscending(true);\n+      setSortedColumnId(actualColumn.getId());\n     }\n   }\n \n@@ -152,6 +160,14 @@ public void setSelectedState(final SelectedState selectedState) {\n     this.selectedState = selectedState;\n   }\n \n+  public boolean isToBeSorted() {\n+    return toBeSorted;\n+  }\n+\n+  public void setToBeSorted(boolean toBeSorted) {\n+    this.toBeSorted = toBeSorted;\n+  }\n+\n   /**\n    * @deprecated since 2.0.0\n    */", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java"}, {"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/5f3bfbaf48240c08d3bcd16993f244a49bad6f1e/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "sha": "bbaa7568ee3697ca1ee87d968b46ec8004e62d17", "changes": 2, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java?ref=5f3bfbaf48240c08d3bcd16993f244a49bad6f1e", "patch": "@@ -511,6 +511,8 @@ private void sheetSorter(final SheetState sheetState, final List<SolarObject> li\n     final SolarObject sun = list.remove(0);\n     final String columnId = sheetState.getSortedColumnId();\n \n+    LOG.info(\"Sorting column '{}'\", columnId);\n+\n     Comparator<SolarObject> comparator = null;\n \n     if (\"name\".equals(columnId)) {", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/a6d5a048d69e3fe0925189dd651f25088a803e20", "parent": "https://github.com/apache/myfaces-tobago/commit/f059f564d48b240732e4a2086cfbfec7e2e9b19d", "message": "TOBAGO-828: Make Sheet work with new LayoutManager\n - fix NPE when column is rendered=false", "bug_id": "myfaces-tobago_54", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/a6d5a048d69e3fe0925189dd651f25088a803e20/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/a6d5a048d69e3fe0925189dd651f25088a803e20/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "sha": "647a2456b5548b303f3cac7cf4cb9f05c88353ad", "changes": 5, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java?ref=a6d5a048d69e3fe0925189dd651f25088a803e20", "patch": "@@ -128,6 +128,10 @@ public void mainProcessing(Orientation orientation) {\n             continue;\n           }\n           AbstractUIColumn column = (AbstractUIColumn) ((UIComponent) component).getParent();\n+          if (!column.isRendered()) {\n+            // XXX here not index++, because the widthList has only the rendered=true, todo: change it.\n+            continue;\n+          }\n           Measure width = Measure.valueOf(widthList.get(index));\n           width = width.subtractNotNegative(LayoutUtils.getBorderBegin(orientation, column));\n           width = width.subtractNotNegative(LayoutUtils.getPaddingBegin(orientation, column));\n@@ -184,6 +188,7 @@ public boolean getRendersChildren() {\n \n   private void ensureColumnWidthList(FacesContext facesContext, AbstractUISheet data) {\n     List<Integer> currentWidthList = null;\n+    // TODO: Refactor: here be should use \"getColumns()\" instead of \"getRenderedColumns()\"\n     List<UIColumn> renderedColumns = data.getRenderedColumns();\n \n     final Map attributes = data.getAttributes();", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java"}, {"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/a6d5a048d69e3fe0925189dd651f25088a803e20/tobago-example/tobago-example-test/src/main/webapp/tc/sheet/sheet-types.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/a6d5a048d69e3fe0925189dd651f25088a803e20/tobago-example/tobago-example-test/src/main/webapp/tc/sheet/sheet-types.xhtml", "sha": "932fd2bdcc384c3dc544d37a63ed75e047e4fb02", "changes": 5, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-test/src/main/webapp/tc/sheet/sheet-types.xhtml?ref=a6d5a048d69e3fe0925189dd651f25088a803e20", "patch": "@@ -25,14 +25,17 @@\n   <tc:page id=\"page\">\n     <tc:gridLayoutConstraint width=\"1100px\" height=\"600px\"/>\n \n-    <tc:sheet value=\"#{sheet.solarArray}\" id=\"sheet\" columns=\"20px;*;*;*;2*;*;*;*;*;2*\" var=\"luminary\" rows=\"20\">\n+    <tc:sheet value=\"#{sheet.solarArray}\" id=\"sheet\" columns=\"20px;*;*;*;*;2*;*;*;*;*;2*\" var=\"luminary\" rows=\"20\">\n       <tc:columnSelector />\n       <tc:column label=\"&lt;tc:out>\" id=\"c_out\">\n         <tc:out value=\"#{luminary.name}\"/>\n       </tc:column>\n       <tc:column label=\"&lt;tc:out>\" id=\"c_out_r\">\n         <tc:out value=\"#{luminary.name}\"/>\n       </tc:column>\n+      <tc:column id=\"c_not_rendered\" rendered=\"false\">\n+        <tc:out value=\"#{luminary.name}\"/>\n+      </tc:column>\n       <tc:column label=\"&lt;tc:in>\" id=\"c_in\">\n         <tc:in value=\"#{luminary.name}\" id=\"in\"/>\n       </tc:column>", "filename": "tobago-example/tobago-example-test/src/main/webapp/tc/sheet/sheet-types.xhtml"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/089b508fe395844ad107178fc183c60855d2d78e", "parent": "https://github.com/apache/myfaces-tobago/commit/5d4f203ea3968051d5422056e3052c6d0cc7081e", "message": "TOBAGO-828: Make Sheet work with new LayoutManager\n - hotfix: NPE when using UIColumnSelector", "bug_id": "myfaces-tobago_55", "file": [{"additions": 5, "raw_url": "https://github.com/apache/myfaces-tobago/raw/089b508fe395844ad107178fc183c60855d2d78e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/089b508fe395844ad107178fc183c60855d2d78e/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "sha": "dde010a49fca95c365e0672cd8e8c5bf4600f188", "changes": 5, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java?ref=089b508fe395844ad107178fc183c60855d2d78e", "patch": "@@ -122,6 +122,11 @@ public void mainProcessing(Orientation orientation) {\n \n         int index = 0;\n         for (LayoutComponent component : sheet.getComponents()) {\n+          if (component == null) {\n+            LOG.error(\"fixme: UIColumnSelector must be a LayoutComponent!\"); // fixme\n+            index++;\n+            continue;\n+          }\n           AbstractUIColumn column = (AbstractUIColumn) ((UIComponent) component).getParent();\n           Measure width = Measure.valueOf(widthList.get(index));\n           width = width.subtractNotNegative(LayoutUtils.getBorderBegin(orientation, column));", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a", "parent": "https://github.com/apache/myfaces-tobago/commit/a56dc09c94a5e2f6836b10d9a1dffea140629fd3", "message": "TOBAGO-1000 SimpleSheetState throws NPE if selectable=\"none\" is set\n - using empty list instead of null", "bug_id": "myfaces-tobago_56", "file": [{"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/component/Sorter.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/component/Sorter.java", "sha": "37656e80681ae54c8c40b9bd638494d5a7e73c46", "changes": 8, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/component/Sorter.java?ref=16b7e00b10bf4f6790fc6a5426e3de10f64ed62a", "patch": "@@ -18,14 +18,14 @@\n  */\n \n import org.apache.commons.lang.StringUtils;\n-import org.apache.myfaces.tobago.internal.component.AbstractUICommand;\n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n import org.apache.myfaces.tobago.compat.FacesUtils;\n import org.apache.myfaces.tobago.event.SortActionEvent;\n+import org.apache.myfaces.tobago.internal.component.AbstractUICommand;\n import org.apache.myfaces.tobago.internal.component.AbstractUISheet;\n import org.apache.myfaces.tobago.model.SheetState;\n import org.apache.myfaces.tobago.util.BeanComparator;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n import javax.faces.component.UIColumn;\n import javax.faces.component.UICommand;\n@@ -120,7 +120,7 @@ public void perform(SortActionEvent sortEvent) {\n \n       // memorize selected rows\n       List<Object> selectedDataRows = null;\n-      if (sheetState.getSelectedRows() != null && sheetState.getSelectedRows().size() > 0) {\n+      if (sheetState.getSelectedRows().size() > 0) {\n         selectedDataRows = new ArrayList<Object>(sheetState.getSelectedRows().size());\n         Object dataRow;\n         for (Integer index : sheetState.getSelectedRows()) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/component/Sorter.java"}, {"additions": 4, "raw_url": "https://github.com/apache/myfaces-tobago/raw/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "sha": "f743b6bcb96f1d3c2cb6502efdcd1aa3c1a5b95d", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java?ref=16b7e00b10bf4f6790fc6a5426e3de10f64ed62a", "patch": "@@ -22,7 +22,6 @@\n import org.apache.myfaces.tobago.component.Attributes;\n import org.apache.myfaces.tobago.component.ColumnEvent;\n import org.apache.myfaces.tobago.component.ComponentTypes;\n-import org.apache.myfaces.tobago.util.CreateComponentUtils;\n import org.apache.myfaces.tobago.component.Facets;\n import org.apache.myfaces.tobago.component.OnComponentPopulated;\n import org.apache.myfaces.tobago.component.RendererTypes;\n@@ -40,6 +39,7 @@\n import org.apache.myfaces.tobago.layout.LayoutTokens;\n import org.apache.myfaces.tobago.model.SheetState;\n import org.apache.myfaces.tobago.renderkit.LayoutComponentRenderer;\n+import org.apache.myfaces.tobago.util.CreateComponentUtils;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n@@ -54,6 +54,7 @@\n import javax.faces.event.PhaseId;\n import java.io.IOException;\n import java.util.ArrayList;\n+import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n@@ -246,7 +247,8 @@ private void updateSheetState(FacesContext facesContext) {\n //      state.setAscending(sortActionListener != null && sortActionListener.isAscending());\n       Map attributes = getAttributes();\n       //noinspection unchecked\n-      state.setSelectedRows((List<Integer>) attributes.get(Attributes.SELECTED_LIST_STRING));\n+      final List<Integer> list = (List<Integer>) attributes.get(Attributes.SELECTED_LIST_STRING);\n+      state.setSelectedRows(list != null ? list : Collections.<Integer>emptyList());\n       state.setColumnWidths((String) attributes.get(Attributes.WIDTH_LIST_STRING));\n       state.setScrollPosition((Integer[]) attributes.get(Attributes.SCROLL_POSITION));\n       attributes.remove(Attributes.SELECTED_LIST_STRING);", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java"}, {"additions": 3, "raw_url": "https://github.com/apache/myfaces-tobago/raw/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/16b7e00b10bf4f6790fc6a5426e3de10f64ed62a/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "sha": "2ab7a5d9d2258b2de5557c1765dee1d0867878ed", "changes": 7, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java?ref=16b7e00b10bf4f6790fc6a5426e3de10f64ed62a", "patch": "@@ -17,11 +17,10 @@\n  * limitations under the License.\n  */\n \n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n import org.apache.commons.lang.StringUtils;\n-\n import org.apache.myfaces.tobago.event.SortActionEvent;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n import javax.faces.component.UIColumn;\n import java.io.Serializable;\n@@ -45,7 +44,6 @@ public SheetState() {\n     resetSelected();\n   }\n \n-\n   public void resetSelected() {\n     selectedRows = new ArrayList<Integer>();\n   }\n@@ -55,6 +53,7 @@ public void resetSelected() {\n   }\n \n   public void setSelectedRows(List<Integer> selectedRows) {\n+    assert selectedRows != null;\n     this.selectedRows = selectedRows;\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/e10bcfd24bdebe6ccb3fa24daa775845da286869", "parent": "https://github.com/apache/myfaces-tobago/commit/f1396c853859175096bb12fcf28f3eb3c188dc93", "message": "fix for TOBAGO-87 (NPE when decoding PageState without state value in request)", "bug_id": "myfaces-tobago_57", "file": [{"additions": 7, "raw_url": "https://github.com/apache/myfaces-tobago/raw/e10bcfd24bdebe6ccb3fa24daa775845da286869/core/src/main/java/org/apache/myfaces/tobago/component/UIPage.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/e10bcfd24bdebe6ccb3fa24daa775845da286869/core/src/main/java/org/apache/myfaces/tobago/component/UIPage.java", "sha": "494a1b2ba89d47815d3f42062056c93996078e9e", "changes": 12, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/component/UIPage.java?ref=e10bcfd24bdebe6ccb3fa24daa775845da286869", "patch": "@@ -223,11 +223,13 @@ private void decodePageState(FacesContext facesContext, PageState pageState) {\n               + SUBCOMPONENT_SEP + \"form-clientDimension\";\n       value = (String) facesContext.getExternalContext()\n               .getRequestParameterMap().get(name);\n-      StringTokenizer tokenizer = new StringTokenizer(value, \";\");\n-      int width = Integer.parseInt(tokenizer.nextToken());\n-      int height = Integer.parseInt(tokenizer.nextToken());\n-      pageState.setClientWidth(width);\n-      pageState.setClientHeight(height);\n+        if (value != null) {\n+            StringTokenizer tokenizer = new StringTokenizer(value, \";\");\n+            int width = Integer.parseInt(tokenizer.nextToken());\n+            int height = Integer.parseInt(tokenizer.nextToken());\n+            pageState.setClientWidth(width);\n+            pageState.setClientHeight(height);\n+        }\n     } catch (Exception e) {\n       LOG.error(\"Error in decoding state: value='\" + value + \"'\", e);\n     }", "filename": "core/src/main/java/org/apache/myfaces/tobago/component/UIPage.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c", "parent": "https://github.com/apache/myfaces-tobago/commit/04984242ac9f325e7a11b212e719af60d96fb5e3", "message": "fix TBG-118 (TabGroup inside of a TabGroup: NPE while decoding)", "bug_id": "myfaces-tobago_58", "file": [{"additions": 10, "raw_url": "https://github.com/apache/myfaces-tobago/raw/dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c/core/src/main/org/apache/myfaces/tobago/component/UITabGroup.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c/core/src/main/org/apache/myfaces/tobago/component/UITabGroup.java", "sha": "1be508da3c5fc7a4f06b7aab0393f2dc317ac912", "changes": 16, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/org/apache/myfaces/tobago/component/UITabGroup.java?ref=dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c", "patch": "@@ -48,10 +48,6 @@\n \n // ///////////////////////////////////////////// constructor\n \n-  public UITabGroup() {\n-    LOG.warn(\"    SYSID=\" + System.identityHashCode(this));\n-  }\n-\n // ///////////////////////////////////////////// code\n \n   @Override\n@@ -61,6 +57,16 @@ public boolean getRendersChildren() {\n \n   @Override\n   public void encodeBegin(FacesContext facesContext) throws IOException {\n+\n+    ValueBinding stateBinding = getValueBinding(ATTR_STATE);\n+    Object state\n+        = stateBinding != null ? stateBinding.getValue(facesContext) : null;\n+    if (state instanceof Integer) {\n+      activeIndex = ((Integer) state).intValue();\n+    } else if (state != null) {\n+      LOG.warn(\"Illegal class in stateBinding: \" + state.getClass().getName());\n+    }\n+\n     setRenderedIndex(activeIndex);\n     super.encodeBegin(facesContext);\n   }\n@@ -187,12 +193,10 @@ public void removeTabChangeListener(TabChangeListener listener) {\n   }\n \n   private void setRenderedIndex(int index) {\n-    LOG.warn(\"set SYSID=\" + System.identityHashCode(this));\n     getAttributes().put(RENDERED_INDEX, index);\n   }\n \n   private int getRenderedIndex() {\n-    LOG.warn(\"get SYSID=\" + System.identityHashCode(this));\n     Integer integer = (Integer) getAttributes().get(RENDERED_INDEX);\n     if (integer == null) {\n       LOG.warn(\"FIXME!!! Bug TGB-118\");", "filename": "core/src/main/org/apache/myfaces/tobago/component/UITabGroup.java"}, {"additions": 0, "raw_url": "https://github.com/apache/myfaces-tobago/raw/04984242ac9f325e7a11b212e719af60d96fb5e3/core/src/main/org/apache/myfaces/tobago/taglib/component/tobago.tld", "blob_url": "https://github.com/apache/myfaces-tobago/blob/04984242ac9f325e7a11b212e719af60d96fb5e3/core/src/main/org/apache/myfaces/tobago/taglib/component/tobago.tld", "sha": "b7061713fb5cdebb1a2030a1d515aa59a2f3b280", "changes": 3417, "status": "removed", "deletions": 3417, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/org/apache/myfaces/tobago/taglib/component/tobago.tld?ref=04984242ac9f325e7a11b212e719af60d96fb5e3", "filename": "core/src/main/org/apache/myfaces/tobago/taglib/component/tobago.tld"}, {"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c/theme/scarborough/src/main/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c/theme/scarborough/src/main/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java", "sha": "92ad7e979ced3e1283e1bdfb5e218a84fed979ac", "changes": 15, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/theme/scarborough/src/main/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java?ref=dfc8a908aa9ce1ae399dc6c4c0e4fe674ed1550c", "patch": "@@ -42,7 +42,6 @@\n import javax.faces.el.EvaluationException;\n import javax.faces.el.MethodBinding;\n import javax.faces.el.MethodNotFoundException;\n-import javax.faces.el.ValueBinding;\n import javax.faces.event.ActionEvent;\n import javax.faces.event.PhaseId;\n import java.io.IOException;\n@@ -100,20 +99,8 @@ public void encodeEndTobago(FacesContext facesContext,\n      UIPanel[] tabs = component.getTabs();\n     layoutTabs(facesContext, component, tabs);\n \n-    int activeIndex;\n-    ValueBinding stateBinding = component.getValueBinding(ATTR_STATE);\n+    int activeIndex = component.getActiveIndex();\n \n-    Object state\n-        = stateBinding != null ? stateBinding.getValue(facesContext) : null;\n-    if (state == null) {\n-      activeIndex = component.getActiveIndex();\n-    } else if (state instanceof Integer) {\n-      activeIndex = ((Integer) state).intValue();\n-      component.setActiveIndex(activeIndex);\n-    } else {\n-      LOG.warn(\"Illegal class in stateBinding: \" + state.getClass().getName());\n-      activeIndex = component.getActiveIndex();\n-    }\n     String hiddenId = component.getClientId(facesContext)\n         + TabGroupRenderer.ACTIVE_INDEX_POSTFIX;\n ", "filename": "theme/scarborough/src/main/org/apache/myfaces/tobago/renderkit/html/scarborough/standard/tag/TabGroupRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/37989cf9c44057db2da68d751a31c509b6e5846d", "parent": "https://github.com/apache/myfaces-tobago/commit/3f7dead58e155ee836eb113f47fe3b000824f666", "message": "workaround  MYFACES-576 (NPE in PropertyResolverImpl.getType if the array is initilized without values)", "bug_id": "myfaces-tobago_59", "file": [{"additions": 1, "raw_url": "https://github.com/apache/myfaces-tobago/raw/37989cf9c44057db2da68d751a31c509b6e5846d/example/demo/src/main/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/37989cf9c44057db2da68d751a31c509b6e5846d/example/demo/src/main/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "sha": "1fd00da67e2a6bd6a097456dde8328db58346f36", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/example/demo/src/main/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java?ref=37989cf9c44057db2da68d751a31c509b6e5846d", "patch": "@@ -117,7 +117,7 @@ public TobagoDemoController() {\n     };\n \n     salutationItems = getSelectItems(salutationKeys, \"demo\");\n-    salutation = new String[4];\n+    this.salutation = new String[]{\"\" ,\"\" ,\"\" ,\"\"};\n \n     bool = new Boolean[10];\n     bool[0] = true;", "filename": "example/demo/src/main/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/af13423f9b88ba29a2443d9bc7a68c412e2a73bc", "parent": "https://github.com/apache/myfaces-tobago/commit/e63c82cf125c87e6545866d6909970df150b1f85", "message": "TOBAGO-1202: Sheet-Header: Support for grouped column-headers and multiline-headers\n - NPE when there is no columns attribute", "bug_id": "myfaces-tobago_60", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/af13423f9b88ba29a2443d9bc7a68c412e2a73bc/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/af13423f9b88ba29a2443d9bc7a68c412e2a73bc/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java", "sha": "ffd945759a8577fc7722608827e5c54356d71878", "changes": 7, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java?ref=af13423f9b88ba29a2443d9bc7a68c412e2a73bc", "patch": "@@ -381,9 +381,14 @@ private Measure getFooterHeight(FacesContext facesContext, AbstractUISheet sheet\n   private void layoutHeader() {\n     final AbstractUISheet sheet = (AbstractUISheet) getLayoutContainer();\n     final UIComponent header = sheet.getHeader();\n+    final LayoutTokens columns = new LayoutTokens();\n+    final List<AbstractUIColumn> renderedColumns = sheet.getRenderedColumns();\n+    for (AbstractUIColumn ignored : renderedColumns) {\n+      columns.addToken(RelativeLayoutToken.DEFAULT_INSTANCE);\n+    }\n     final LayoutTokens rows = new LayoutTokens();\n     rows.addToken(AutoLayoutToken.INSTANCE);\n-    final Grid grid = new Grid(sheet.getColumnLayout(), rows);\n+    final Grid grid = new Grid(columns, rows);\n \n     for(UIComponent child : header.getChildren()) {\n       if (child instanceof LayoutComponent) {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheetLayout.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/9ec45a94a431ced48fa47a7b4c398b22a2a60a10", "parent": "https://github.com/apache/myfaces-tobago/commit/c77cea971acdec11fffb734224229ca8ddcc1b32", "message": "Merged from trunk\nTOBAGO-1457: Sheet sort may be performed twice and possible NPE when using method binding for sorting [from revision 1675636]", "bug_id": "myfaces-tobago_61", "file": [{"additions": 29, "raw_url": "https://github.com/apache/myfaces-tobago/raw/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "sha": "42656e68dcb0551a53eb4eb622d5c62ef74243e9", "changes": 43, "status": "modified", "deletions": 14, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java?ref=9ec45a94a431ced48fa47a7b4c398b22a2a60a10", "patch": "@@ -55,14 +55,18 @@\n import javax.faces.component.UINamingContainer;\n import javax.faces.context.FacesContext;\n import javax.faces.event.AbortProcessingException;\n+import javax.faces.event.ComponentSystemEvent;\n import javax.faces.event.FacesEvent;\n+import javax.faces.event.ListenerFor;\n import javax.faces.event.PhaseId;\n+import javax.faces.event.PreRenderComponentEvent;\n import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n import java.util.Map;\n \n+@ListenerFor(systemEventClass = PreRenderComponentEvent.class)\n public abstract class AbstractUISheet extends AbstractUIData\n     implements SheetStateChangeSource2, SortActionSource2, OnComponentPopulated,\n     LayoutContainer, LayoutComponent, SupportsCss, SupportsRenderedPartially {\n@@ -112,18 +116,6 @@ public void encodeBegin(final FacesContext facesContext) throws IOException {\n       }\n     }\n \n-    final MethodExpression expression = getSortActionListenerExpression();\n-    if (expression != null) {\n-      try {\n-        FacesEvent facesEvent = new SortActionEvent(this, null);\n-        expression.invoke(facesContext.getELContext(), new Object[]{facesEvent});\n-      } catch (Exception e) {\n-        LOG.warn(\"Initial sorting not possible!\", e);\n-      }\n-    } else {\n-      new Sorter().perform(this);\n-    }\n-\n     super.encodeBegin(facesContext);\n   }\n \n@@ -455,12 +447,35 @@ public void broadcast(final FacesEvent facesEvent) throws AbortProcessingExcepti\n       }\n     } else if (facesEvent instanceof SortActionEvent) {\n       getSheetState(getFacesContext()).updateSortState((SortActionEvent) facesEvent);\n+      sort(getFacesContext(), (SortActionEvent) facesEvent);\n+    }\n+  }\n+\n+  public void processEvent(ComponentSystemEvent event) {\n+    super.processEvent(event);\n+    if (event instanceof PreRenderComponentEvent) {\n+      sort(getFacesContext(), null);\n+    }\n+  }\n+\n+  protected void sort(FacesContext facesContext, SortActionEvent event) {\n+    final SheetState sheetState = getSheetState(getFacesContext());\n+    if (sheetState.isToBeSorted()) {\n       final MethodExpression expression = getSortActionListenerExpression();\n       if (expression != null) {\n-        expression.invoke(getFacesContext().getELContext(), new Object[]{facesEvent});\n+        try {\n+          if (event == null) {\n+            event =\n+                new SortActionEvent(this, (UIColumn) findComponent(getSheetState(facesContext).getSortedColumnId()));\n+          }\n+          expression.invoke(facesContext.getELContext(), new Object[]{event});\n+        } catch (Exception e) {\n+          LOG.warn(\"Sorting not possible!\", e);\n+        }\n       } else {\n-        new Sorter().perform((SortActionEvent) facesEvent);\n+        new Sorter().perform(this);\n       }\n+      sheetState.setToBeSorted(false);\n     }\n   }\n ", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java"}, {"additions": 7, "raw_url": "https://github.com/apache/myfaces-tobago/raw/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java", "sha": "3533ac1b1b6b56be5ccea2d09810a8bc3e46a51e", "changes": 7, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java?ref=9ec45a94a431ced48fa47a7b4c398b22a2a60a10", "patch": "@@ -457,6 +457,13 @@ public static String defaultString(final String string) {\n     return string == null ? \"\" : string;\n   }\n \n+  /**\n+   * Basically taken from commons-lang\n+   */\n+  public static boolean notEquals(String a, String b) {\n+    return a == null ? b != null : !a.equals(b);\n+  }\n+\n   /**\n    * Checks if the String starts like a url, e.g. http: or xyz:\n    */", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/util/StringUtils.java"}, {"additions": 21, "raw_url": "https://github.com/apache/myfaces-tobago/raw/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java", "sha": "9c62bb9d9b2f03fe534a4d8856999b07d9cf3214", "changes": 26, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java?ref=9ec45a94a431ced48fa47a7b4c398b22a2a60a10", "patch": "@@ -40,6 +40,7 @@\n   private int first;\n   private String sortedColumnId;\n   private boolean ascending;\n+  private boolean toBeSorted;\n   private String columnWidths;\n   private List<Integer> selectedRows;\n   private Integer[] scrollPosition;\n@@ -54,6 +55,7 @@ public void reset() {\n     first = -1;\n     sortedColumnId = null;\n     ascending = true;\n+    toBeSorted = false;\n     columnWidths = null;\n     resetSelected();\n     if (expandedState != null) {\n@@ -83,15 +85,21 @@ public String getSortedColumnId() {\n   }\n \n   public void setSortedColumnId(final String sortedColumnId) {\n-    this.sortedColumnId = sortedColumnId;\n+    if (StringUtils.notEquals(this.sortedColumnId, sortedColumnId)) {\n+      this.sortedColumnId = sortedColumnId;\n+      toBeSorted = true;\n+    }\n   }\n \n   public boolean isAscending() {\n     return ascending;\n   }\n \n   public void setAscending(final boolean ascending) {\n-    this.ascending = ascending;\n+    if (this.ascending != ascending) {\n+      this.ascending = ascending;\n+      toBeSorted = true;\n+    }\n   }\n \n   public String getColumnWidths() {\n@@ -115,10 +123,10 @@ public void updateSortState(final SortActionEvent sortEvent) {\n     final UIColumn actualColumn = sortEvent.getColumn();\n \n     if (actualColumn.getId().equals(sortedColumnId)) {\n-      ascending = !ascending;\n+      setAscending(!isAscending());\n     } else {\n-      ascending = true;\n-      sortedColumnId = actualColumn.getId();\n+      setAscending(true);\n+      setSortedColumnId(actualColumn.getId());\n     }\n   }\n \n@@ -152,6 +160,14 @@ public void setSelectedState(final SelectedState selectedState) {\n     this.selectedState = selectedState;\n   }\n \n+  public boolean isToBeSorted() {\n+    return toBeSorted;\n+  }\n+\n+  public void setToBeSorted(boolean toBeSorted) {\n+    this.toBeSorted = toBeSorted;\n+  }\n+\n   /**\n    * @deprecated since 2.0.0\n    */", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/model/SheetState.java"}, {"additions": 2, "raw_url": "https://github.com/apache/myfaces-tobago/raw/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/9ec45a94a431ced48fa47a7b4c398b22a2a60a10/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java", "sha": "ba78e330b69d70100ae0b9697d193af2fcda3411", "changes": 2, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java?ref=9ec45a94a431ced48fa47a7b4c398b22a2a60a10", "patch": "@@ -518,6 +518,8 @@ private void sheetSorter(final SheetState sheetState, final List<SolarObject> li\n     final SolarObject sun = list.remove(0);\n     final String columnId = sheetState.getSortedColumnId();\n \n+    LOG.info(\"Sorting column '{}'\", columnId);\n+\n     Comparator<SolarObject> comparator = null;\n \n     if (\"name\".equals(columnId)) {", "filename": "tobago-example/tobago-example-demo/src/main/java/org/apache/myfaces/tobago/example/demo/TobagoDemoController.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/6a237550876eb76b84f9154aaa39c0b3a9d2a050", "parent": "https://github.com/apache/myfaces-tobago/commit/0e39a9898e24dbfde6dc19b83e8c49db03703dab", "message": "Fixed NPE if width is not defined in html style map.\nAdded slider/input field percentage configuration.", "bug_id": "myfaces-tobago_62", "file": [{"additions": 119, "raw_url": "https://github.com/apache/myfaces-tobago/raw/6a237550876eb76b84f9154aaa39c0b3a9d2a050/sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/sandbox/standard/tag/InputNumberSliderRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/6a237550876eb76b84f9154aaa39c0b3a9d2a050/sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/sandbox/standard/tag/InputNumberSliderRenderer.java", "sha": "6991c9014a683d4b2a16796773548ef2c5a7822e", "changes": 224, "status": "modified", "deletions": 105, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/sandbox/standard/tag/InputNumberSliderRenderer.java?ref=6a237550876eb76b84f9154aaa39c0b3a9d2a050", "patch": "@@ -20,6 +20,7 @@\n import org.apache.commons.logging.Log;\r\n import org.apache.commons.logging.LogFactory;\r\n import org.apache.myfaces.tobago.TobagoConstants;\r\n+import org.apache.myfaces.tobago.config.ThemeConfig;\r\n import static org.apache.myfaces.tobago.TobagoConstants.*;\r\n import org.apache.myfaces.tobago.component.ComponentUtil;\r\n import org.apache.myfaces.tobago.renderkit.RendererBase;\r\n@@ -37,115 +38,128 @@\n \r\n public class InputNumberSliderRenderer extends RendererBase {\r\n \r\n-  private static final Log LOG = LogFactory.getLog(InputNumberSliderRenderer.class);\r\n-\r\n-  public void encodeEnd(FacesContext facesContext, UIComponent component) throws IOException {\r\n-    String id = component.getClientId(facesContext);\r\n-    String currentValue = getCurrentValue(facesContext, component);\r\n-    boolean readonly = ComponentUtil.getBooleanAttribute(component, ATTR_READONLY);\r\n-    boolean disabled = ComponentUtil.getBooleanAttribute(component, ATTR_DISABLED);\r\n-    Integer min = ComponentUtil.getIntAttribute(component, \"min\");\r\n-    Integer max = ComponentUtil.getIntAttribute(component, \"max\");\r\n-    LOG.info(\"### min = \" + min);\r\n-    LOG.info(\"### max = \" + max);\r\n-    TobagoResponseWriter writer = (TobagoResponseWriter) facesContext.getResponseWriter();\r\n-\r\n-    HtmlStyleMap style = (HtmlStyleMap) component.getAttributes().get(ATTR_STYLE);\r\n-    int width = -1;\r\n-    int sliderWidth = 100; // fixme\r\n-    int inputWidth = 50; // fixme;\r\n-    if (style != null) {\r\n-      width = style.getInt(\"width\");\r\n-    }\r\n-    if (width >= 0) {\r\n-      sliderWidth = width * 2 / 3;\r\n-      inputWidth = width * 1 / 3;\r\n+    private static final Log LOG = LogFactory.getLog(InputNumberSliderRenderer.class);\r\n+\r\n+    public void encodeEnd(FacesContext facesContext, UIComponent component) throws IOException {\r\n+        String id = component.getClientId(facesContext);\r\n+        String currentValue = getCurrentValue(facesContext, component);\r\n+        boolean readonly = ComponentUtil.getBooleanAttribute(component, ATTR_READONLY);\r\n+        boolean disabled = ComponentUtil.getBooleanAttribute(component, ATTR_DISABLED);\r\n+        Integer min = ComponentUtil.getIntAttribute(component, \"min\");\r\n+        Integer max = ComponentUtil.getIntAttribute(component, \"max\");\r\n+        LOG.info(\"### min = \" + min);\r\n+        LOG.info(\"### max = \" + max);\r\n+        TobagoResponseWriter writer = (TobagoResponseWriter) facesContext.getResponseWriter();\r\n+\r\n+\r\n+        HtmlStyleMap style = (HtmlStyleMap) component.getAttributes().get(ATTR_STYLE);\r\n+        int width = -1;\r\n+        int sliderWidthPerc = ThemeConfig.getValue(facesContext, component, \"sliderWidthPercent\");\r\n+        if (sliderWidthPerc <= 25) {\r\n+            sliderWidthPerc = 25;\r\n+        }\r\n+        if (sliderWidthPerc >= 75) {\r\n+            sliderWidthPerc = 75;\r\n+        }\r\n+        int sliderWidth = 100; // fixme\r\n+        int inputWidth = 50; // fixme;\r\n+        if (style != null && style.containsKey(\"width\")) {\r\n+            width = style.getInt(\"width\");\r\n+        }\r\n+        if (width >= 0) {\r\n+            sliderWidth = (width * sliderWidthPerc) / 100;\r\n+            inputWidth = (width * (100 - sliderWidthPerc)) / 100;\r\n+        }\r\n+\r\n+        LOG.info(\"Slider width: \"+sliderWidth);\r\n+        LOG.info(\"Input width: \"+inputWidth);\r\n+        LOG.info(\"Width: \"+width);\r\n+        LOG.info(\"Percentage: \"+sliderWidthPerc);\r\n+\r\n+        writer.startElement(HtmlConstants.TABLE, component);\r\n+        writer.writeIdAttribute(id);\r\n+        writer.writeComponentClass();\r\n+        writer.writeAttribute(HtmlAttributes.STYLE, null, ATTR_STYLE);\r\n+        //writer.writeAttribute(\"border\",\"1\",false);\r\n+\r\n+        writer.startElement(HtmlConstants.TR);\r\n+        writer.startElement(HtmlConstants.TD);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-min-default\");\r\n+        writer.writeAttribute(HtmlAttributes.STYLE,\r\n+                HtmlRendererUtil.toStyleString(\"width\", sliderWidth / 2), null);\r\n+        writer.startElement(HtmlConstants.SPAN);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-min-default\");\r\n+        writer.writeText(min, null);\r\n+        writer.endElement(HtmlConstants.SPAN);\r\n+\r\n+        writer.endElement(HtmlConstants.TD);\r\n+        writer.startElement(HtmlConstants.TD);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-max-default\");\r\n+        writer.writeAttribute(HtmlAttributes.STYLE,\r\n+                HtmlRendererUtil.toStyleString(\"width\", sliderWidth * 1 / 2), null);\r\n+        writer.startElement(HtmlConstants.SPAN);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-max-default\");\r\n+        writer.writeText(max, null);\r\n+        writer.endElement(HtmlConstants.SPAN);\r\n+        writer.endElement(HtmlConstants.TD);\r\n+\r\n+        // the input field starts here\r\n+        writer.startElement(HtmlConstants.TD);\r\n+        writer.writeAttribute(\"rowspan\", \"2\", false);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-input-default\");\r\n+\r\n+        writer.startElement(HtmlConstants.INPUT);\r\n+        writer.writeClassAttribute(\"tobago-in-default\");\r\n+        writer.writeAttribute(HtmlAttributes.STYLE,\r\n+                HtmlRendererUtil.toStyleString(\"width\", inputWidth), null);\r\n+        String inputIdAndName = getIdForInputField(facesContext, component);\r\n+        writer.writeNameAttribute(inputIdAndName);\r\n+        writer.writeIdAttribute(inputIdAndName);\r\n+        if (currentValue != null) {\r\n+            writer.writeAttribute(HtmlAttributes.VALUE, currentValue, null);\r\n+        }\r\n+        writer.writeAttribute(HtmlAttributes.READONLY, readonly);\r\n+        writer.writeAttribute(HtmlAttributes.DISABLED, disabled);\r\n+        //writer.writeAttribute(HtmlAttributes.STYLE, null, ATTR_STYLE);\r\n+        writer.endElement(HtmlConstants.INPUT);\r\n+        writer.endElement(HtmlConstants.TD);\r\n+\r\n+        writer.endElement(HtmlConstants.TR);\r\n+        writer.startElement(HtmlConstants.TR);\r\n+        writer.startElement(HtmlConstants.TD);\r\n+        writer.writeClassAttribute(\"tobago-inputNumberSlider-slider-default\");\r\n+        writer.writeAttribute(\"colspan\", \"2\", false);\r\n+        //writer.writeAttribute(\"width\", \"200\", false);\r\n+        writer.writeAttribute(\"height\", \"5\", false);\r\n+        //writer.writeAttribute(\"bgcolor\", \"yellow\", false);\r\n+\r\n+        writer.endElement(HtmlConstants.TD);\r\n+        writer.endElement(HtmlConstants.TR);\r\n+        writer.endElement(HtmlConstants.TABLE);\r\n+\r\n+        //HtmlRendererUtil.renderFocusId(facesContext, component);\r\n     }\r\n \r\n-    writer.startElement(HtmlConstants.TABLE, component);\r\n-    writer.writeIdAttribute(id);\r\n-    writer.writeComponentClass();\r\n-    writer.writeAttribute(HtmlAttributes.STYLE, null, ATTR_STYLE);\r\n-    //writer.writeAttribute(\"border\",\"1\",false);\r\n-\r\n-    writer.startElement(HtmlConstants.TR);\r\n-    writer.startElement(HtmlConstants.TD);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-min-default\");\r\n-    writer.writeAttribute(HtmlAttributes.STYLE,\r\n-        HtmlRendererUtil.toStyleString(\"width\", sliderWidth * 1 / 2), null);\r\n-    writer.startElement(HtmlConstants.SPAN);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-min-default\");\r\n-    writer.writeText(min, null);\r\n-    writer.endElement(HtmlConstants.SPAN);\r\n-\r\n-    writer.endElement(HtmlConstants.TD);\r\n-    writer.startElement(HtmlConstants.TD);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-max-default\");\r\n-    writer.writeAttribute(HtmlAttributes.STYLE,\r\n-        HtmlRendererUtil.toStyleString(\"width\", sliderWidth * 1 / 2), null);\r\n-    writer.startElement(HtmlConstants.SPAN);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-max-default\");\r\n-    writer.writeText(max, null);\r\n-    writer.endElement(HtmlConstants.SPAN);\r\n-    writer.endElement(HtmlConstants.TD);\r\n-\r\n-    // the input field starts here\r\n-    writer.startElement(HtmlConstants.TD);\r\n-    writer.writeAttribute(\"rowspan\", \"2\", false);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-input-default\");\r\n-\r\n-    writer.startElement(HtmlConstants.INPUT);\r\n-    writer.writeClassAttribute(\"tobago-in-default\");\r\n-    writer.writeAttribute(HtmlAttributes.STYLE,\r\n-        HtmlRendererUtil.toStyleString(\"width\", inputWidth), null);        \r\n-    String inputIdAndName = getIdForInputField(facesContext, component);\r\n-    writer.writeNameAttribute(inputIdAndName);\r\n-    writer.writeIdAttribute(inputIdAndName);\r\n-    if (currentValue != null) {\r\n-      writer.writeAttribute(HtmlAttributes.VALUE, currentValue, null);\r\n-    }\r\n-    writer.writeAttribute(HtmlAttributes.READONLY, readonly);\r\n-    writer.writeAttribute(HtmlAttributes.DISABLED, disabled);\r\n-    //writer.writeAttribute(HtmlAttributes.STYLE, null, ATTR_STYLE);\r\n-    writer.endElement(HtmlConstants.INPUT);\r\n-    writer.endElement(HtmlConstants.TD);\r\n-\r\n-    writer.endElement(HtmlConstants.TR);\r\n-    writer.startElement(HtmlConstants.TR);\r\n-    writer.startElement(HtmlConstants.TD);\r\n-    writer.writeClassAttribute(\"tobago-inputNumberSlider-slider-default\");\r\n-    writer.writeAttribute(\"colspan\", \"2\", false);\r\n-    //writer.writeAttribute(\"width\", \"200\", false);\r\n-    writer.writeAttribute(\"height\", \"5\", false);\r\n-    //writer.writeAttribute(\"bgcolor\", \"yellow\", false);\r\n-\r\n-    writer.endElement(HtmlConstants.TD);\r\n-    writer.endElement(HtmlConstants.TR);\r\n-    writer.endElement(HtmlConstants.TABLE);\r\n-\r\n-    //HtmlRendererUtil.renderFocusId(facesContext, component);\r\n-  }\r\n-\r\n-  public void decode(FacesContext context, UIComponent component) {\r\n-    UIInput uiInput;\r\n-    if (component instanceof UIInput && !ComponentUtil.isOutputOnly(component)) {\r\n-      uiInput = (UIInput) component;\r\n-    } else {\r\n-      return;\r\n+    public void decode(FacesContext context, UIComponent component) {\r\n+        UIInput uiInput;\r\n+        if (component instanceof UIInput && !ComponentUtil.isOutputOnly(component)) {\r\n+            uiInput = (UIInput) component;\r\n+        } else {\r\n+            return;\r\n+        }\r\n+        String inputId = getIdForInputField(context, component);\r\n+        Map requestParameterMap = context.getExternalContext().getRequestParameterMap();\r\n+        if (requestParameterMap.containsKey(inputId)) {\r\n+            String newValue = (String) requestParameterMap.get(inputId);\r\n+            uiInput.setSubmittedValue(newValue);\r\n+        }\r\n     }\r\n-    String inputId = getIdForInputField(context, component);\r\n-    Map requestParameterMap = context.getExternalContext().getRequestParameterMap();\r\n-    if (requestParameterMap.containsKey(inputId)) {\r\n-      String newValue = (String) requestParameterMap.get(inputId);\r\n-      uiInput.setSubmittedValue(newValue);\r\n-    }\r\n-  }\r\n \r\n-  private String getIdForInputField(FacesContext context,\r\n-      UIComponent component) {\r\n-    String id = component.getClientId(context);\r\n-    return id + TobagoConstants.SUBCOMPONENT_SEP + \"input\";\r\n-  }\r\n+    private String getIdForInputField(FacesContext context,\r\n+                                      UIComponent component) {\r\n+        String id = component.getClientId(context);\r\n+        return id + TobagoConstants.SUBCOMPONENT_SEP + \"input\";\r\n+    }\r\n \r\n \r\n }\r", "filename": "sandbox/src/main/java/org/apache/myfaces/tobago/renderkit/html/sandbox/standard/tag/InputNumberSliderRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/0a58dc8f91776a2789bc6a3016a79001ebf842af", "parent": "https://github.com/apache/myfaces-tobago/commit/63393cc7e4923edd8b2ab09f5acccb13f43d0d96", "message": "Merged from trunk\nTOBAGO-1359: NPE when rendering sheet\n - working a little bit on nested sheets (not officially supported): no pretty output, but readable [from revision 1576730]", "bug_id": "myfaces-tobago_63", "file": [{"additions": 18, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "sha": "4b35fd00066973807f9baaa65edcf4109ed68a3a", "changes": 28, "status": "modified", "deletions": 10, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java?ref=0a58dc8f91776a2789bc6a3016a79001ebf842af", "patch": "@@ -370,21 +370,29 @@ public void restoreState(final FacesContext context, final Object savedState) {\n   }\n \n   public List<AbstractUIColumn> getAllColumns() {\n-    final List<AbstractUIColumn> columns = new ArrayList<AbstractUIColumn>();\n-    for (final AbstractUIColumn kid : ComponentUtils.findDescendantList(this, AbstractUIColumn.class)) {\n-      columns.add(kid);\n-    }\n-    return columns;\n+    ArrayList<AbstractUIColumn> result = new ArrayList<AbstractUIColumn>();\n+    findColumns(this, result, true);\n+    return result;\n   }\n \n   public List<AbstractUIColumn> getRenderedColumns() {\n-    final List<AbstractUIColumn> columns = new ArrayList<AbstractUIColumn>();\n-    for (final AbstractUIColumn kid : ComponentUtils.findDescendantList(this, AbstractUIColumn.class)) {\n-      if (kid.isRendered()) {\n-        columns.add(kid);\n+    ArrayList<AbstractUIColumn> result = new ArrayList<AbstractUIColumn>();\n+    findColumns(this, result, false);\n+    return result;\n+  }\n+\n+  private void findColumns(final UIComponent component, final List<AbstractUIColumn> result, final boolean all) {\n+    for (final UIComponent child : component.getChildren()) {\n+      if (all || child.isRendered()) {\n+        if (child instanceof AbstractUIColumn) {\n+          result.add((AbstractUIColumn) child);\n+        } else if (child instanceof AbstractUIData){\n+          // ignore nested sheets\n+        } else {\n+          findColumns(child, result, all);\n+        }\n       }\n     }\n-    return columns;\n   }\n \n /*  public MethodBinding getSortActionListener() {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java"}, {"additions": 47, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java", "sha": "3aeef40ca27b8c0332592564b0fbc6dedcaedd04", "changes": 47, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java?ref=0a58dc8f91776a2789bc6a3016a79001ebf842af", "patch": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.myfaces.tobago.example.data;\n+\n+public class Element {\n+\n+  private String name;\n+  private double ratio;\n+\n+  public Element(final String name, final double ratio) {\n+    this.name = name;\n+    this.ratio = ratio;\n+  }\n+\n+  public String getName() {\n+    return name;\n+  }\n+\n+  public void setName(final String name) {\n+    this.name = name;\n+  }\n+\n+  public double getRatio() {\n+    return ratio;\n+  }\n+\n+  public void setRatio(final double ratio) {\n+    this.ratio = ratio;\n+  }\n+}", "filename": "tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java"}, {"additions": 41, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java", "sha": "fe36236fa59f7b7f5ac9b9723351f32bc78fe477", "changes": 47, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java?ref=0a58dc8f91776a2789bc6a3016a79001ebf842af", "patch": "@@ -21,6 +21,8 @@\n \n import javax.swing.tree.DefaultMutableTreeNode;\n import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n import java.util.HashMap;\n import java.util.List;\n import java.util.Map;\n@@ -47,6 +49,8 @@\n \n   private String population;\n \n+  private List<Element> chemicalComposition;\n+\n   public SolarObject(\n       final String name, final String number, final String orbit, final Integer distance, final Double period,\n       final Double incl, final Double eccen, final String discoverer, final Integer discoverYear) {\n@@ -154,6 +158,14 @@ public void setPopulation(final String population) {\n     this.population = population;\n   }\n \n+  public List<Element> getChemicalComposition() {\n+    return chemicalComposition != null ? chemicalComposition : Collections.<Element>emptyList();\n+  }\n+\n+  public void setChemicalComposition(final List<Element> chemicalComposition) {\n+    this.chemicalComposition = chemicalComposition;\n+  }\n+\n   public boolean isSelectionDisabled() {\n     return number.equals(\"II\");\n   }\n@@ -165,9 +177,7 @@ public boolean isSelectionDisabled() {\n   public static List<SolarObject> getList() {\n     final SolarObject[] array = getArray();\n     final List<SolarObject> list = new ArrayList<SolarObject>(array.length);\n-    for (final SolarObject object : array) {\n-      list.add(object);\n-    }\n+    Collections.addAll(list, array);\n     return list;\n   }\n \n@@ -198,18 +208,22 @@ public static DefaultMutableTreeNode getTree() {\n     return collect;\n   }\n \n+  public static final SolarObject SUN = new SolarObject(\"Sun\", \"-\", \"-\", 0, 0.0, 0.0, 0.0, \"-\", null);\n+  public static final SolarObject EARTH =new SolarObject(\"Earth\", \"III\", \"Sun\", 149600, 365.26, 0.00, 0.02, \"-\", null);\n+  public static final SolarObject MOON = new SolarObject(\"Moon\", \"I\", \"Earth\", 384, 27.32, 5.14, 0.05, \"-\", null);\n+\n   public static final SolarObject[] DATA = {\n-      new SolarObject(\"Sun\", \"-\", \"-\", 0, 0.0, 0.0, 0.0, \"-\", null),\n+      SUN,\n       new SolarObject(\"Mercury\", \"I\", \"Sun\", 57910, 87.97, 7.00, 0.21, \"-\", null),\n       new SolarObject(\"Venus\", \"II\", \"Sun\", 108200, 224.70, 3.39, 0.01, \"-\", null),\n-      new SolarObject(\"Earth\", \"III\", \"Sun\", 149600, 365.26, 0.00, 0.02, \"-\", null),\n+      EARTH,\n       new SolarObject(\"Mars\", \"IV\", \"Sun\", 227940, 686.98, 1.85, 0.09, \"-\", null),\n       new SolarObject(\"Jupiter\", \"V\", \"Sun\", 778330, 4332.71, 1.31, 0.05, \"-\", null),\n       new SolarObject(\"Saturn\", \"VI\", \"Sun\", 1429400, 10759.50, 2.49, 0.06, \"-\", null),\n       new SolarObject(\"Uranus\", \"VII\", \"Sun\", 2870990, 30685.0, 0.77, 0.05, \"Herschel\", 1781),\n       new SolarObject(\"Neptune\", \"VIII\", \"Sun\", 4504300, 60190.0, 1.77, 0.01, \"Adams\", 1846),\n       new SolarObject(\"Pluto\", \"IX\", \"Sun\", 5913520, 90800.0, 17.15, 0.25, \"Tombaugh\", 1930),\n-      new SolarObject(\"Moon\", \"I\", \"Earth\", 384, 27.32, 5.14, 0.05, \"-\", null),\n+      MOON,\n       new SolarObject(\"Phobos\", \"I\", \"Mars\", 9, 0.32, 1.00, 0.02, \"Hall\", 1877),\n       new SolarObject(\"Deimos\", \"II\", \"Mars\", 23, 1.26, 1.80, 0.00, \"Hall\", 1877),\n       new SolarObject(\"Metis\", \"XVI\", \"Jupiter\", 128, 0.29, 0.00, 0.00, \"Synnott\", 1979),\n@@ -289,4 +303,25 @@ public static DefaultMutableTreeNode getTree() {\n       new SolarObject(\"Charon\", \"I\", \"Pluto\", 20, 6.39, 98.80, 0.00, \"Christy\", 1978)\n   };\n \n+  static {\n+    List<Element> sun = Arrays.asList(\n+        new Element(\"Hydrogen\", 0.74),\n+        new Element(\"Helium\", 0.25)\n+    );\n+    SUN.setChemicalComposition(sun);\n+    List<Element> earth = Arrays.asList(\n+        new Element(\"Silica\", 0.60),\n+        new Element(\"Alimina\", 0.15),\n+        new Element(\"Lime\", 0.05)\n+    );\n+    EARTH.setChemicalComposition(earth);\n+    List<Element> moon = Arrays.asList(\n+        new Element(\"Silica\", 0.45),\n+        new Element(\"Alimina\", 0.24),\n+        new Element(\"Lime\", 0.16)\n+    );\n+    MOON.setChemicalComposition(moon);\n+  }\n+\n+\n }", "filename": "tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java"}, {"additions": 49, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml", "sha": "3c5c7ae0e0669e3583eb36f6da32920dbeaeaea4", "changes": 49, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml?ref=0a58dc8f91776a2789bc6a3016a79001ebf842af", "patch": "@@ -0,0 +1,49 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<!--\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+-->\n+\n+<ui:composition template=\"/WEB-INF/tags/layout/overview.xhtml\"\n+                xmlns:tc=\"http://myfaces.apache.org/tobago/component\"\n+                xmlns:tx=\"http://myfaces.apache.org/tobago/extension\"\n+                xmlns:ui=\"http://java.sun.com/jsf/facelets\"\n+                xmlns:h=\"http://java.sun.com/jsf/html\"\n+                xmlns:f=\"http://java.sun.com/jsf/core\">\n+  <ui:param name=\"title\" value=\"#{overviewBundle.sheet}\"/>\n+\n+    <tc:sheet value=\"#{demo.solarList}\" id=\"sheet\"\n+              columns=\"*;2*\" var=\"luminary\">\n+      <tc:column label=\"#{overviewBundle.solarArrayName}\" id=\"name\" sortable=\"true\" markup=\"#{luminary.markup}\">\n+        <tc:out value=\"#{luminary.name}\" id=\"t_name\"/>\n+      </tc:column>\n+      <tc:column label=\"Chemical Composition\" id=\"cc\" sortable=\"false\" resizable=\"false\"\n+                 tip=\"Chemical Composition of the Crust\">\n+\n+          <tc:sheet value=\"#{luminary.chemicalComposition}\" id=\"nested\"\n+                    columns=\"*;*\" var=\"element\">\n+              <tc:column label=\"Element\" id=\"element\" sortable=\"false\" resizable=\"false\">\n+                  <tc:out value=\"#{element.name}\"/>\n+              </tc:column>\n+              <tc:column label=\"Ratio\" id=\"ratio\" sortable=\"false\" resizable=\"false\">\n+                  <tc:out value=\"#{element.ratio}\"/>\n+              </tc:column>\n+          </tc:sheet>\n+\n+      </tc:column>\n+    </tc:sheet>\n+\n+</ui:composition>", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml"}, {"additions": 8, "raw_url": "https://github.com/apache/myfaces-tobago/raw/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/0a58dc8f91776a2789bc6a3016a79001ebf842af/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "sha": "167ef49ca036aada09d898ec712240e961ef203a", "changes": 10, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java?ref=0a58dc8f91776a2789bc6a3016a79001ebf842af", "patch": "@@ -112,7 +112,7 @@ private void ensureHeader(final FacesContext facesContext, final UISheet sheet)\n     if (header == null) {\n       header = CreateComponentUtils.createComponent(facesContext, ComponentTypes.PANEL, null, \"_header\");\n       header.setTransient(true);\n-      final List<AbstractUIColumn> columns = ComponentUtils.findDescendantList(sheet, AbstractUIColumn.class);\n+      final List<AbstractUIColumn> columns = sheet.getAllColumns();\n       int i = 0;\n       for (final AbstractUIColumn column : columns) {\n         final AbstractUIOut out = (AbstractUIOut) CreateComponentUtils.createComponent(\n@@ -739,7 +739,7 @@ private void link(final FacesContext facesContext, final Application application\n     writer.endElement(HtmlElements.IMG);\n   }\n \n-  // TODO sheet.getColumnLayout() liefert ggf. eine falsche Anzahl von Spalten\n+  // TODO sheet.getColumnLayout() may return the wrong number of column...\n   // TODO\n   // TODO\n \n@@ -751,6 +751,12 @@ private void renderColumnHeaders(\n       throws IOException {\n \n     final Grid grid = sheet.getHeaderGrid();\n+    if (grid == null) {\n+      LOG.warn(\"Can't render column headers, because grid == null. One reason can be, the you use nested sheets. \" +\n+          \"The inner sheet ensureHeader() will be called outside the iterating over the rows. \" +\n+          \"Nesting sheet is currently not supported.\");\n+      return;\n+    }\n     final List<Integer> columnWidths = sheet.getWidthList();\n \n     if (LOG.isDebugEnabled()) {", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/629b92c75658a8ed70257880ad601790bcf87cf8", "parent": "https://github.com/apache/myfaces-tobago/commit/6d3126df3c263b235e6ebcb20946213ec1ad765c", "message": "TOBAGO-1359: NPE when rendering sheet\n - working a little bit on nested sheets (not officially supported): no pretty output, but readable", "bug_id": "myfaces-tobago_64", "file": [{"additions": 18, "raw_url": "https://github.com/apache/myfaces-tobago/raw/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java", "sha": "4b35fd00066973807f9baaa65edcf4109ed68a3a", "changes": 28, "status": "modified", "deletions": 10, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java?ref=629b92c75658a8ed70257880ad601790bcf87cf8", "patch": "@@ -370,21 +370,29 @@ public void restoreState(final FacesContext context, final Object savedState) {\n   }\n \n   public List<AbstractUIColumn> getAllColumns() {\n-    final List<AbstractUIColumn> columns = new ArrayList<AbstractUIColumn>();\n-    for (final AbstractUIColumn kid : ComponentUtils.findDescendantList(this, AbstractUIColumn.class)) {\n-      columns.add(kid);\n-    }\n-    return columns;\n+    ArrayList<AbstractUIColumn> result = new ArrayList<AbstractUIColumn>();\n+    findColumns(this, result, true);\n+    return result;\n   }\n \n   public List<AbstractUIColumn> getRenderedColumns() {\n-    final List<AbstractUIColumn> columns = new ArrayList<AbstractUIColumn>();\n-    for (final AbstractUIColumn kid : ComponentUtils.findDescendantList(this, AbstractUIColumn.class)) {\n-      if (kid.isRendered()) {\n-        columns.add(kid);\n+    ArrayList<AbstractUIColumn> result = new ArrayList<AbstractUIColumn>();\n+    findColumns(this, result, false);\n+    return result;\n+  }\n+\n+  private void findColumns(final UIComponent component, final List<AbstractUIColumn> result, final boolean all) {\n+    for (final UIComponent child : component.getChildren()) {\n+      if (all || child.isRendered()) {\n+        if (child instanceof AbstractUIColumn) {\n+          result.add((AbstractUIColumn) child);\n+        } else if (child instanceof AbstractUIData){\n+          // ignore nested sheets\n+        } else {\n+          findColumns(child, result, all);\n+        }\n       }\n     }\n-    return columns;\n   }\n \n /*  public MethodBinding getSortActionListener() {", "filename": "tobago-core/src/main/java/org/apache/myfaces/tobago/internal/component/AbstractUISheet.java"}, {"additions": 47, "raw_url": "https://github.com/apache/myfaces-tobago/raw/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java", "sha": "3aeef40ca27b8c0332592564b0fbc6dedcaedd04", "changes": 47, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java?ref=629b92c75658a8ed70257880ad601790bcf87cf8", "patch": "@@ -0,0 +1,47 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+package org.apache.myfaces.tobago.example.data;\n+\n+public class Element {\n+\n+  private String name;\n+  private double ratio;\n+\n+  public Element(final String name, final double ratio) {\n+    this.name = name;\n+    this.ratio = ratio;\n+  }\n+\n+  public String getName() {\n+    return name;\n+  }\n+\n+  public void setName(final String name) {\n+    this.name = name;\n+  }\n+\n+  public double getRatio() {\n+    return ratio;\n+  }\n+\n+  public void setRatio(final double ratio) {\n+    this.ratio = ratio;\n+  }\n+}", "filename": "tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/Element.java"}, {"additions": 41, "raw_url": "https://github.com/apache/myfaces-tobago/raw/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java", "sha": "fe36236fa59f7b7f5ac9b9723351f32bc78fe477", "changes": 47, "status": "modified", "deletions": 6, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java?ref=629b92c75658a8ed70257880ad601790bcf87cf8", "patch": "@@ -21,6 +21,8 @@\n \n import javax.swing.tree.DefaultMutableTreeNode;\n import java.util.ArrayList;\n+import java.util.Arrays;\n+import java.util.Collections;\n import java.util.HashMap;\n import java.util.List;\n import java.util.Map;\n@@ -47,6 +49,8 @@\n \n   private String population;\n \n+  private List<Element> chemicalComposition;\n+\n   public SolarObject(\n       final String name, final String number, final String orbit, final Integer distance, final Double period,\n       final Double incl, final Double eccen, final String discoverer, final Integer discoverYear) {\n@@ -154,6 +158,14 @@ public void setPopulation(final String population) {\n     this.population = population;\n   }\n \n+  public List<Element> getChemicalComposition() {\n+    return chemicalComposition != null ? chemicalComposition : Collections.<Element>emptyList();\n+  }\n+\n+  public void setChemicalComposition(final List<Element> chemicalComposition) {\n+    this.chemicalComposition = chemicalComposition;\n+  }\n+\n   public boolean isSelectionDisabled() {\n     return number.equals(\"II\");\n   }\n@@ -165,9 +177,7 @@ public boolean isSelectionDisabled() {\n   public static List<SolarObject> getList() {\n     final SolarObject[] array = getArray();\n     final List<SolarObject> list = new ArrayList<SolarObject>(array.length);\n-    for (final SolarObject object : array) {\n-      list.add(object);\n-    }\n+    Collections.addAll(list, array);\n     return list;\n   }\n \n@@ -198,18 +208,22 @@ public static DefaultMutableTreeNode getTree() {\n     return collect;\n   }\n \n+  public static final SolarObject SUN = new SolarObject(\"Sun\", \"-\", \"-\", 0, 0.0, 0.0, 0.0, \"-\", null);\n+  public static final SolarObject EARTH =new SolarObject(\"Earth\", \"III\", \"Sun\", 149600, 365.26, 0.00, 0.02, \"-\", null);\n+  public static final SolarObject MOON = new SolarObject(\"Moon\", \"I\", \"Earth\", 384, 27.32, 5.14, 0.05, \"-\", null);\n+\n   public static final SolarObject[] DATA = {\n-      new SolarObject(\"Sun\", \"-\", \"-\", 0, 0.0, 0.0, 0.0, \"-\", null),\n+      SUN,\n       new SolarObject(\"Mercury\", \"I\", \"Sun\", 57910, 87.97, 7.00, 0.21, \"-\", null),\n       new SolarObject(\"Venus\", \"II\", \"Sun\", 108200, 224.70, 3.39, 0.01, \"-\", null),\n-      new SolarObject(\"Earth\", \"III\", \"Sun\", 149600, 365.26, 0.00, 0.02, \"-\", null),\n+      EARTH,\n       new SolarObject(\"Mars\", \"IV\", \"Sun\", 227940, 686.98, 1.85, 0.09, \"-\", null),\n       new SolarObject(\"Jupiter\", \"V\", \"Sun\", 778330, 4332.71, 1.31, 0.05, \"-\", null),\n       new SolarObject(\"Saturn\", \"VI\", \"Sun\", 1429400, 10759.50, 2.49, 0.06, \"-\", null),\n       new SolarObject(\"Uranus\", \"VII\", \"Sun\", 2870990, 30685.0, 0.77, 0.05, \"Herschel\", 1781),\n       new SolarObject(\"Neptune\", \"VIII\", \"Sun\", 4504300, 60190.0, 1.77, 0.01, \"Adams\", 1846),\n       new SolarObject(\"Pluto\", \"IX\", \"Sun\", 5913520, 90800.0, 17.15, 0.25, \"Tombaugh\", 1930),\n-      new SolarObject(\"Moon\", \"I\", \"Earth\", 384, 27.32, 5.14, 0.05, \"-\", null),\n+      MOON,\n       new SolarObject(\"Phobos\", \"I\", \"Mars\", 9, 0.32, 1.00, 0.02, \"Hall\", 1877),\n       new SolarObject(\"Deimos\", \"II\", \"Mars\", 23, 1.26, 1.80, 0.00, \"Hall\", 1877),\n       new SolarObject(\"Metis\", \"XVI\", \"Jupiter\", 128, 0.29, 0.00, 0.00, \"Synnott\", 1979),\n@@ -289,4 +303,25 @@ public static DefaultMutableTreeNode getTree() {\n       new SolarObject(\"Charon\", \"I\", \"Pluto\", 20, 6.39, 98.80, 0.00, \"Christy\", 1978)\n   };\n \n+  static {\n+    List<Element> sun = Arrays.asList(\n+        new Element(\"Hydrogen\", 0.74),\n+        new Element(\"Helium\", 0.25)\n+    );\n+    SUN.setChemicalComposition(sun);\n+    List<Element> earth = Arrays.asList(\n+        new Element(\"Silica\", 0.60),\n+        new Element(\"Alimina\", 0.15),\n+        new Element(\"Lime\", 0.05)\n+    );\n+    EARTH.setChemicalComposition(earth);\n+    List<Element> moon = Arrays.asList(\n+        new Element(\"Silica\", 0.45),\n+        new Element(\"Alimina\", 0.24),\n+        new Element(\"Lime\", 0.16)\n+    );\n+    MOON.setChemicalComposition(moon);\n+  }\n+\n+\n }", "filename": "tobago-example/tobago-example-data/src/main/java/org/apache/myfaces/tobago/example/data/SolarObject.java"}, {"additions": 49, "raw_url": "https://github.com/apache/myfaces-tobago/raw/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml", "blob_url": "https://github.com/apache/myfaces-tobago/blob/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml", "sha": "3c5c7ae0e0669e3583eb36f6da32920dbeaeaea4", "changes": 49, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml?ref=629b92c75658a8ed70257880ad601790bcf87cf8", "patch": "@@ -0,0 +1,49 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+\n+<!--\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+-->\n+\n+<ui:composition template=\"/WEB-INF/tags/layout/overview.xhtml\"\n+                xmlns:tc=\"http://myfaces.apache.org/tobago/component\"\n+                xmlns:tx=\"http://myfaces.apache.org/tobago/extension\"\n+                xmlns:ui=\"http://java.sun.com/jsf/facelets\"\n+                xmlns:h=\"http://java.sun.com/jsf/html\"\n+                xmlns:f=\"http://java.sun.com/jsf/core\">\n+  <ui:param name=\"title\" value=\"#{overviewBundle.sheet}\"/>\n+\n+    <tc:sheet value=\"#{demo.solarList}\" id=\"sheet\"\n+              columns=\"*;2*\" var=\"luminary\">\n+      <tc:column label=\"#{overviewBundle.solarArrayName}\" id=\"name\" sortable=\"true\" markup=\"#{luminary.markup}\">\n+        <tc:out value=\"#{luminary.name}\" id=\"t_name\"/>\n+      </tc:column>\n+      <tc:column label=\"Chemical Composition\" id=\"cc\" sortable=\"false\" resizable=\"false\"\n+                 tip=\"Chemical Composition of the Crust\">\n+\n+          <tc:sheet value=\"#{luminary.chemicalComposition}\" id=\"nested\"\n+                    columns=\"*;*\" var=\"element\">\n+              <tc:column label=\"Element\" id=\"element\" sortable=\"false\" resizable=\"false\">\n+                  <tc:out value=\"#{element.name}\"/>\n+              </tc:column>\n+              <tc:column label=\"Ratio\" id=\"ratio\" sortable=\"false\" resizable=\"false\">\n+                  <tc:out value=\"#{element.ratio}\"/>\n+              </tc:column>\n+          </tc:sheet>\n+\n+      </tc:column>\n+    </tc:sheet>\n+\n+</ui:composition>", "filename": "tobago-example/tobago-example-demo/src/main/webapp/content/02-sheet/x-sheet-nested.xhtml"}, {"additions": 8, "raw_url": "https://github.com/apache/myfaces-tobago/raw/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/629b92c75658a8ed70257880ad601790bcf87cf8/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java", "sha": "6ef3b0bf8a1bb522dc9fbacb72d016c4fbd45cbf", "changes": 10, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java?ref=629b92c75658a8ed70257880ad601790bcf87cf8", "patch": "@@ -113,7 +113,7 @@ private void ensureHeader(final FacesContext facesContext, final UISheet sheet)\n     if (header == null) {\n       header = CreateComponentUtils.createComponent(facesContext, ComponentTypes.PANEL, null, \"_header\");\n       header.setTransient(true);\n-      final List<AbstractUIColumn> columns = ComponentUtils.findDescendantList(sheet, AbstractUIColumn.class);\n+      final List<AbstractUIColumn> columns = sheet.getAllColumns();\n       int i = 0;\n       for (final AbstractUIColumn column : columns) {\n         final AbstractUIOut out = (AbstractUIOut) CreateComponentUtils.createComponent(\n@@ -715,7 +715,7 @@ private void link(final FacesContext facesContext, final Application application\n     writer.endElement(HtmlElements.IMG);\n   }\n \n-  // TODO sheet.getColumnLayout() liefert ggf. eine falsche Anzahl von Spalten\n+  // TODO sheet.getColumnLayout() may return the wrong number of column...\n   // TODO\n   // TODO\n \n@@ -727,6 +727,12 @@ private void renderColumnHeaders(\n       throws IOException {\n \n     final Grid grid = sheet.getHeaderGrid();\n+    if (grid == null) {\n+      LOG.warn(\"Can't render column headers, because grid == null. One reason can be, the you use nested sheets. \" +\n+          \"The inner sheet ensureHeader() will be called outside the iterating over the rows. \" +\n+          \"Nesting sheet is currently not supported.\");\n+      return;\n+    }\n     final List<Integer> columnWidths = sheet.getWidthList();\n \n     if (LOG.isDebugEnabled()) {", "filename": "tobago-theme/tobago-theme-standard/src/main/java/org/apache/myfaces/tobago/renderkit/html/standard/standard/tag/SheetRenderer.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/2af9b78cf459551a9b301050b0ede933f7274bf6", "parent": "https://github.com/apache/myfaces-tobago/commit/21717a1bba47e6a295f49ef8ee6e1d5b750b7059", "message": "(TOBAGO-543) replace prototype with dojo as underlying ajax library\n<http://issues.apache.org/jira/browse/TOBAGO-543>\n  don't throw NPE on non Ajax request", "bug_id": "myfaces-tobago_65", "file": [{"additions": 8, "raw_url": "https://github.com/apache/myfaces-tobago/raw/2af9b78cf459551a9b301050b0ede933f7274bf6/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxUtils.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/2af9b78cf459551a9b301050b0ede933f7274bf6/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxUtils.java", "sha": "72d984e5d2a841c1d2804ecaa0fa30a06450ad86", "changes": 10, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxUtils.java?ref=2af9b78cf459551a9b301050b0ede933f7274bf6", "patch": "@@ -106,7 +106,10 @@ public static boolean isAjaxRequest(FacesContext facesContext) {\n   }\n \n   public static void removeAjaxComponent(FacesContext facesContext, String clientId) {\n-    getAjaxComponents(facesContext).remove(clientId);\n+    Map<String, UIComponent> ajaxComponents = getAjaxComponents(facesContext);\n+    if (ajaxComponents != null) {\n+      ajaxComponents.remove(clientId);\n+    }\n   }\n \n   public static void addAjaxComponent(FacesContext facesContext, String clientId) {\n@@ -115,7 +118,10 @@ public static void addAjaxComponent(FacesContext facesContext, String clientId)\n \n   public static void addAjaxComponent(FacesContext facesContext, UIComponent component) {\n     if (component instanceof AjaxComponent) {\n-      getAjaxComponents(facesContext).put(component.getClientId(facesContext), component);\n+      Map<String, UIComponent> ajaxComponents = getAjaxComponents(facesContext);\n+      if (ajaxComponents != null) {\n+        ajaxComponents.put(component.getClientId(facesContext), component);\n+      }\n     } else {\n       LOG.warn(\"Ignore non AjaxComponent : \\\"\"\n           + (component != null ? component.getClientId(facesContext) : \"null\")", "filename": "core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxUtils.java"}], "repo": "myfaces-tobago"}, {"commit": "https://github.com/apache/myfaces-tobago/commit/d9fdd909f320b99ada369c5dff2c60bc30205da0", "parent": "https://github.com/apache/myfaces-tobago/commit/afdefb72424aa72fa1be0a844a33bf54fc25c734", "message": "Ajax requests needs a different content-type.\n<http://issues.apache.org/jira/browse/TOBAGO-503>\n  fix NPE on CODE_RELOAD_REQUIRED", "bug_id": "myfaces-tobago_66", "file": [{"additions": 6, "raw_url": "https://github.com/apache/myfaces-tobago/raw/d9fdd909f320b99ada369c5dff2c60bc30205da0/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxResponseRenderer.java", "blob_url": "https://github.com/apache/myfaces-tobago/blob/d9fdd909f320b99ada369c5dff2c60bc30205da0/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxResponseRenderer.java", "sha": "087c2097bf38164dc7c6cf6f5f8a74c1bb60a673", "changes": 7, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/myfaces-tobago/contents/core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxResponseRenderer.java?ref=d9fdd909f320b99ada369c5dff2c60bc30205da0", "patch": "@@ -210,7 +210,12 @@ private void writeResponse(FacesContext facesContext, RenderKit renderKit,\n     RequestUtils.ensureEncoding(externalContext);\n     ResponseUtils.ensureNoCacheHeader(externalContext);\n     UIComponent page = ComponentUtil.findPage(facesContext);\n-    String charset = (String) page.getAttributes().get(ATTR_CHARSET);\n+    String charset;\n+    if (page != null) {  // in case of CODE_RELOAD_REQUIRED page is null\n+      charset = (String) page.getAttributes().get(ATTR_CHARSET);\n+    } else {\n+      charset = \"UTF-8\";\n+    }\n     ensureContentTypeHeader(facesContext, charset, contentType);\n     StringBuilder buffer = new StringBuilder(responseCode);\n ", "filename": "core/src/main/java/org/apache/myfaces/tobago/ajax/api/AjaxResponseRenderer.java"}], "repo": "myfaces-tobago"}]
