{
    "pig_1d64916": {
        "bug_id": "pig_1d64916",
        "commit": "https://github.com/apache/pig/commit/1d64916466db0da7c57a00a49f3235e7b190a074",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/1d64916466db0da7c57a00a49f3235e7b190a074/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=1d64916466db0da7c57a00a49f3235e7b190a074",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -44,6 +44,8 @@ PIG-626: Add access to hadoop counters (shubhamc via gates).\n \n BUG FIXES\n \n+PIG-810: Fixed NPE in PigStats (gates)\n+\n PIG-804: problem with lineage with double map redirection (pradeepkth)\n \n PIG-733: Order by sampling dumps entire sample to hdfs which causes dfs",
                "raw_url": "https://github.com/apache/pig/raw/1d64916466db0da7c57a00a49f3235e7b190a074/CHANGES.txt",
                "sha": "7175634f5ea7e879154ab9c4e3b01273594f21fe",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/pig/blob/1d64916466db0da7c57a00a49f3235e7b190a074/src/org/apache/pig/tools/pigstats/PigStats.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/tools/pigstats/PigStats.java?ref=1d64916466db0da7c57a00a49f3235e7b190a074",
                "deletions": 1,
                "filename": "src/org/apache/pig/tools/pigstats/PigStats.java",
                "patch": "@@ -172,7 +172,7 @@ else if(mode == ExecType.LOCAL)\n             \n         }\n         \n-        lastJobID = lastJob.getAssignedJobID().toString();\n+        if (lastJob != null) lastJobID = lastJob.getAssignedJobID().toString();\n         return stats;\n     }\n     ",
                "raw_url": "https://github.com/apache/pig/raw/1d64916466db0da7c57a00a49f3235e7b190a074/src/org/apache/pig/tools/pigstats/PigStats.java",
                "sha": "f0b87c7074e838c8a3fd0cb4aedc9a874f71ce09",
                "status": "modified"
            }
        ],
        "message": "PIG-810: Fixed NPE in PigStats (gates)\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/hadoop/pig/trunk@774989 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/6c0cdfeb9d2daf997df8ccea091873706ef3b160",
        "repo": "pig",
        "unit_tests": [
            "TestPigStats.java"
        ]
    },
    "pig_20eac9b": {
        "bug_id": "pig_20eac9b",
        "commit": "https://github.com/apache/pig/commit/20eac9b2672f80eb24502a176a9df2024ba70fbe",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/20eac9b2672f80eb24502a176a9df2024ba70fbe/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=20eac9b2672f80eb24502a176a9df2024ba70fbe",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -193,6 +193,8 @@ PIG-3882: Multiquery off mode execution is not done in batch and very inefficien\n  \n BUG FIXES\n \n+PIG-4017: NPE thrown from JobControlCompiler.shipToHdfs (cheolsoo)\n+\n PIG-3997: Issue on Pig docs: Testing and Diagnostics (zjffdu via cheolsoo)\n \n PIG-3998: Documentation fix: invalid page links, wrong Groovy udf example (lbendig via cheolsoo)",
                "raw_url": "https://github.com/apache/pig/raw/20eac9b2672f80eb24502a176a9df2024ba70fbe/CHANGES.txt",
                "sha": "dba86c9ade6aa95d040f79ba8e05a19186f49384",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/pig/blob/20eac9b2672f80eb24502a176a9df2024ba70fbe/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java?ref=20eac9b2672f80eb24502a176a9df2024ba70fbe",
                "deletions": 1,
                "filename": "src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java",
                "patch": "@@ -1687,7 +1687,9 @@ private static Path shipToHDFS(\n         } finally {\n             org.apache.commons.io.IOUtils.closeQuietly(is);\n             // IOUtils should not close stream to HDFS quietly\n-            os.close();\n+            if (os != null) {\n+                os.close();\n+            }\n         }\n         return dst;\n     }",
                "raw_url": "https://github.com/apache/pig/raw/20eac9b2672f80eb24502a176a9df2024ba70fbe/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/JobControlCompiler.java",
                "sha": "37341ce948d89c3b66d7a4860e5ba83a98d3c4a8",
                "status": "modified"
            }
        ],
        "message": "PIG-4017: NPE thrown from JobControlCompiler.shipToHdfs (cheolsoo)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1603315 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/63efe61aa797cb65b470019b2a6beb6c74826e61",
        "repo": "pig",
        "unit_tests": [
            "TestJobControlCompiler.java"
        ]
    },
    "pig_23dc5ce": {
        "bug_id": "pig_23dc5ce",
        "commit": "https://github.com/apache/pig/commit/23dc5ce42e783a32fd5713de05e9e330cc429731",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/23dc5ce42e783a32fd5713de05e9e330cc429731/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=23dc5ce42e783a32fd5713de05e9e330cc429731",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -99,6 +99,8 @@ OPTIMIZATIONS\n  \n BUG FIXES\n \n+PIG-3806: PigServer constructor throws NPE after PIG-3765 (aniket486)\n+\n PIG-3801: Auto local mode does not call storeSchema (aniket486)\n \n PIG-3754: InputSizeReducerEstimator.getTotalInputFileSize reports incorrect size (aniket486)",
                "raw_url": "https://github.com/apache/pig/raw/23dc5ce42e783a32fd5713de05e9e330cc429731/CHANGES.txt",
                "sha": "70b6d59884318e7be39758c61b14231baeb4a70c",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/23dc5ce42e783a32fd5713de05e9e330cc429731/src/org/apache/pig/PigServer.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/PigServer.java?ref=23dc5ce42e783a32fd5713de05e9e330cc429731",
                "deletions": 2,
                "filename": "src/org/apache/pig/PigServer.java",
                "patch": "@@ -233,6 +233,8 @@ public PigServer(PigContext context, boolean connect) throws ExecException {\n         if (connect) {\n             pigContext.connect();\n         }\n+        \n+        this.filter = new BlackAndWhitelistFilter(this);\n \n         addJarsFromProperties();\n         markPredeployedJarsFromProperties();\n@@ -244,8 +246,6 @@ public PigServer(PigContext context, boolean connect) throws ExecException {\n         if (ScriptState.get() == null) {\n             ScriptState.start(pigContext.getExecutionEngine().instantiateScriptState());\n         }\n-\n-        this.filter = new BlackAndWhitelistFilter(this);\n     }\n \n     private void addJarsFromProperties() throws ExecException {",
                "raw_url": "https://github.com/apache/pig/raw/23dc5ce42e783a32fd5713de05e9e330cc429731/src/org/apache/pig/PigServer.java",
                "sha": "54515206ca52220ccb68faf19ff54c6a034d2255",
                "status": "modified"
            }
        ],
        "message": "PIG-3806: PigServer constructor throws NPE after PIG-3765 (aniket486)\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1576549 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/c2aedcc66486ddc721a32dc4984547f049aa5541",
        "repo": "pig",
        "unit_tests": [
            "TestPigServer.java"
        ]
    },
    "pig_5a9b9eb": {
        "bug_id": "pig_5a9b9eb",
        "commit": "https://github.com/apache/pig/commit/5a9b9ebdf1554898bd3a3d59d6571f20cbc692b9",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/pig/blob/5a9b9ebdf1554898bd3a3d59d6571f20cbc692b9/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java?ref=5a9b9ebdf1554898bd3a3d59d6571f20cbc692b9",
                "deletions": 6,
                "filename": "src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "patch": "@@ -26,8 +26,8 @@\n \n import org.apache.pig.backend.executionengine.ExecException;\n import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;\n+import org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigHadoopLogger;\n import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;\n-import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;\n import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;\n import org.apache.pig.impl.PigContext;\n import org.apache.pig.impl.logicalLayer.FrontendException;\n@@ -149,15 +149,14 @@ protected void execute(LogicalExpression op) throws FrontendException {\n                     PhysicalOperator root = expPhysicalPlan.getLeaves().get(0);\n                     try {\n                         UDFContext.getUDFContext().addJobConf(ConfigurationUtil.toConfiguration(pc.getProperties(), true));\n-                        Result ret= root.getNext(root.getResultType());\n-                        if (ret.result != null) {\n-                            val = ret.result;\n-                            valSet = true;\n-                        }\n+                        PigHadoopLogger pigHadoopLogger = PigHadoopLogger.getInstance();\n+                        PhysicalOperator.setPigLogger(pigHadoopLogger);\n+                        val = root.getNext(root.getResultType()).result;\n                         UDFContext.getUDFContext().addJobConf(null);\n                     } catch (ExecException e) {\n                         throw new FrontendException(e);\n                     }\n+                    valSet = true;\n                 } else if (op instanceof UserFuncExpression) {\n                     // If solo UDF, calculate UDF\n                     UserFuncExpression udf = (UserFuncExpression)op;",
                "raw_url": "https://github.com/apache/pig/raw/5a9b9ebdf1554898bd3a3d59d6571f20cbc692b9/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "sha": "860fa474ea59bf6126a37d46740fc9d6d3df0f06",
                "status": "modified"
            }
        ],
        "message": "PIG-4169: NPE in ConstantCalculator\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1625205 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/f919fc3b742dae415a59539ab3abd08c6b8a0400",
        "repo": "pig",
        "unit_tests": [
            "TestConstantCalculator.java"
        ]
    },
    "pig_6e19aa5": {
        "bug_id": "pig_6e19aa5",
        "commit": "https://github.com/apache/pig/commit/6e19aa5c51829f525149c5ef6de69395599deacb",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/6e19aa5c51829f525149c5ef6de69395599deacb/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=6e19aa5c51829f525149c5ef6de69395599deacb",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -127,6 +127,8 @@ PIG-4639: Add better parser for Apache HTTPD access log (nielsbasjes via daijy)\n \n BUG FIXES\n \n+PIG-4873: InputSplit.getLocations return null and result a NPE in Pig (daijy)\n+\n PIG-4895: User UDFs relying on mapreduce.job.maps broken in Tez (rohini)\n \n PIG-4883: MapKeyType of splitter was set wrongly in specific multiquery case (kellyzly via rohini)",
                "raw_url": "https://github.com/apache/pig/raw/6e19aa5c51829f525149c5ef6de69395599deacb/CHANGES.txt",
                "sha": "5d917b0533962ce629770571128ad9920ba996d9",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/pig/blob/6e19aa5c51829f525149c5ef6de69395599deacb/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigSplit.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigSplit.java?ref=6e19aa5c51829f525149c5ef6de69395599deacb",
                "deletions": 3,
                "filename": "src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigSplit.java",
                "patch": "@@ -463,9 +463,11 @@ public String toString() {\n             for (int i = 0; i < wrappedSplits.length; i++) {\n                 st.append(\"Input split[\"+i+\"]:\\n   Length = \"+ wrappedSplits[i].getLength()+\"\\n   ClassName: \" +\n                     wrappedSplits[i].getClass().getName() + \"\\n   Locations:\\n\");\n-                for (String location :  wrappedSplits[i].getLocations())\n-                    st.append(\"    \"+location+\"\\n\");\n-                st.append(\"\\n-----------------------\\n\");\n+                if (wrappedSplits[i]!=null && wrappedSplits[i].getLocations()!=null) {\n+                    for (String location :  wrappedSplits[i].getLocations())\n+                        st.append(\"    \"+location+\"\\n\");\n+                    st.append(\"\\n-----------------------\\n\");\n+                }\n           }\n         } catch (IOException e) {\n           return null;",
                "raw_url": "https://github.com/apache/pig/raw/6e19aa5c51829f525149c5ef6de69395599deacb/src/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/PigSplit.java",
                "sha": "e866b28c1bcdadcb5c0201d80c9648868dd6b3ca",
                "status": "modified"
            }
        ],
        "message": "PIG-4873: InputSplit.getLocations return null and result a NPE in Pig\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1744313 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/a58d3088c37a153fe565f0b9dd7cb208e6c5ac56",
        "repo": "pig",
        "unit_tests": [
            "TestPigSplit.java"
        ]
    },
    "pig_779945c": {
        "bug_id": "pig_779945c",
        "commit": "https://github.com/apache/pig/commit/779945ca83b00b13835184b8da25548cd5e0e0c7",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/779945ca83b00b13835184b8da25548cd5e0e0c7/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=779945ca83b00b13835184b8da25548cd5e0e0c7",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -70,6 +70,8 @@ OPTIMIZATIONS\n  \n BUG FIXES\n \n+PIG-4169: NPE in ConstantCalculator (cheolsoo)\n+\n PIG-4161: check for latest Hive snapshot dependencies (daijy)\n \n PIG-4102: Adding e2e tests and several improvements for Orc predicate pushdown (daijy)",
                "raw_url": "https://github.com/apache/pig/raw/779945ca83b00b13835184b8da25548cd5e0e0c7/CHANGES.txt",
                "sha": "234073e4fd15efb3ec54f8e6b265b3f6811d607d",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/pig/blob/779945ca83b00b13835184b8da25548cd5e0e0c7/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java?ref=779945ca83b00b13835184b8da25548cd5e0e0c7",
                "deletions": 2,
                "filename": "src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "patch": "@@ -27,6 +27,7 @@\n import org.apache.pig.backend.executionengine.ExecException;\n import org.apache.pig.backend.hadoop.datastorage.ConfigurationUtil;\n import org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator;\n+import org.apache.pig.backend.hadoop.executionengine.physicalLayer.Result;\n import org.apache.pig.backend.hadoop.executionengine.physicalLayer.plans.PhysicalPlan;\n import org.apache.pig.impl.PigContext;\n import org.apache.pig.impl.logicalLayer.FrontendException;\n@@ -148,12 +149,15 @@ protected void execute(LogicalExpression op) throws FrontendException {\n                     PhysicalOperator root = expPhysicalPlan.getLeaves().get(0);\n                     try {\n                         UDFContext.getUDFContext().addJobConf(ConfigurationUtil.toConfiguration(pc.getProperties(), true));\n-                        val = root.getNext(root.getResultType()).result;\n+                        Result ret= root.getNext(root.getResultType());\n+                        if (ret.result != null) {\n+                            val = ret.result;\n+                            valSet = true;\n+                        }\n                         UDFContext.getUDFContext().addJobConf(null);\n                     } catch (ExecException e) {\n                         throw new FrontendException(e);\n                     }\n-                    valSet = true;\n                 } else if (op instanceof UserFuncExpression) {\n                     // If solo UDF, calculate UDF\n                     UserFuncExpression udf = (UserFuncExpression)op;",
                "raw_url": "https://github.com/apache/pig/raw/779945ca83b00b13835184b8da25548cd5e0e0c7/src/org/apache/pig/newplan/logical/rules/ConstantCalculator.java",
                "sha": "761781c1e3ab01b84316b45a7c23d6c873592ee8",
                "status": "modified"
            }
        ],
        "message": "PIG-4169: NPE in ConstantCalculator (cheolsoo)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1624611 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/484de09de12b17bed1d76fef8958f38163822e0c",
        "repo": "pig",
        "unit_tests": [
            "TestConstantCalculator.java"
        ]
    },
    "pig_aba9f47": {
        "bug_id": "pig_aba9f47",
        "commit": "https://github.com/apache/pig/commit/aba9f47589d8a11b8d6ad428343eb780464496af",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/aba9f47589d8a11b8d6ad428343eb780464496af/src/org/apache/pig/LoadFunc.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/LoadFunc.java?ref=aba9f47589d8a11b8d6ad428343eb780464496af",
                "deletions": 1,
                "filename": "src/org/apache/pig/LoadFunc.java",
                "patch": "@@ -303,6 +303,7 @@ public void setUDFContextSignature(String signature) {\n      */\n     public final void warn(String msg, Enum warningEnum) {\n         Counter counter = PigStatusReporter.getInstance().getCounter(warningEnum);\n-        counter.increment(1);\n+        if (counter!=null)\n+            counter.increment(1);\n     }\n }",
                "raw_url": "https://github.com/apache/pig/raw/aba9f47589d8a11b8d6ad428343eb780464496af/src/org/apache/pig/LoadFunc.java",
                "sha": "1cae5cf820b2b4137484b6ac7dedf34a3409b9cb",
                "status": "modified"
            }
        ],
        "message": "Tiny fix: NPE introduced by PIG-2332\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1208338 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/369b81c18afad938b9d33915cb63d5591cbe38c1",
        "repo": "pig",
        "unit_tests": [
            "TestLoadFunc.java"
        ]
    },
    "pig_d332485": {
        "bug_id": "pig_d332485",
        "commit": "https://github.com/apache/pig/commit/d3324852207252e156d13fc6ee75d26149ff6731",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/pig/blob/d3324852207252e156d13fc6ee75d26149ff6731/CHANGES.txt",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/CHANGES.txt?ref=d3324852207252e156d13fc6ee75d26149ff6731",
                "deletions": 0,
                "filename": "CHANGES.txt",
                "patch": "@@ -40,6 +40,8 @@ OPTIMIZATIONS\n  \n BUG FIXES\n \n+PIG-3377: New AvroStorage throws NPE when storing untyped map/array/bag (jadler via cheolsoo)\n+\n PIG-3542: Javadoc of REGEX_EXTRACT_ALL (nyigitba via daijy)\n \n PIG-3518: Need to ship jruby.jar in the release (daijy)",
                "raw_url": "https://github.com/apache/pig/raw/d3324852207252e156d13fc6ee75d26149ff6731/CHANGES.txt",
                "sha": "5897047b19536b3afaea6d64045740c3330e4b51",
                "status": "modified"
            },
            {
                "additions": 13,
                "blob_url": "https://github.com/apache/pig/blob/d3324852207252e156d13fc6ee75d26149ff6731/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java",
                "changes": 15,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java?ref=d3324852207252e156d13fc6ee75d26149ff6731",
                "deletions": 2,
                "filename": "src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java",
                "patch": "@@ -427,6 +427,9 @@ private static Schema resourceFieldSchemaToAvroSchema(\n           schema.getFields()[0].getSchema(), name, null,\n           definedRecordNames,\n           doubleColonsToDoubleUnderscores);\n+      if (innerBagSchema == null) {\n+        throw new IOException(\"AvroStorage can't save bags with untyped values; please specify a value type or a schema.\");\n+      }\n       return createNullableUnion(Schema.createArray(innerBagSchema));\n     case DataType.BIGCHARARRAY:\n       return createNullableUnion(Type.STRING);\n@@ -457,10 +460,15 @@ private static Schema resourceFieldSchemaToAvroSchema(\n     case DataType.LONG:\n       return createNullableUnion(Type.LONG);\n     case DataType.MAP:\n+      if (schema == null) {\n+        throw new IOException(\"AvroStorage can't save maps with untyped values; please specify a value type or a schema.\");\n+      }\n       byte innerType = schema.getFields()[0].getType();\n       String desc = schema.getFields()[0].getDescription();\n-      if (desc.equals(\"autogenerated from Pig Field Schema\")) {\n-        desc = null;\n+      if (desc != null) {\n+        if (desc.equals(\"autogenerated from Pig Field Schema\")) {\n+          desc = null;\n+        }\n       }\n       Schema innerSchema;\n       if (DataType.isComplex(innerType)) {\n@@ -480,6 +488,9 @@ private static Schema resourceFieldSchemaToAvroSchema(\n     case DataType.NULL:\n       return Schema.create(Type.NULL);\n     case DataType.TUPLE:\n+      if (schema == null) {\n+        throw new IOException(\"AvroStorage can't save tuples with untyped values; please specify a value type or a schema.\");\n+      }\n       Schema returnSchema = createNullableUnion(\n           resourceSchemaToAvroSchema(schema, name, null,\n               definedRecordNames, doubleColonsToDoubleUnderscores));",
                "raw_url": "https://github.com/apache/pig/raw/d3324852207252e156d13fc6ee75d26149ff6731/src/org/apache/pig/impl/util/avro/AvroStorageSchemaConversionUtilities.java",
                "sha": "fb89e9c766de24eccd2d7485d39f799cfd0397f8",
                "status": "modified"
            }
        ],
        "message": "PIG-3377: New AvroStorage throws NPE when storing untyped map/bag/tuple (jadler via cheolsoo)\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1536044 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/5358546758669c04fcf109210997424eadfc216c",
        "repo": "pig",
        "unit_tests": [
            "TestAvroStorageSchemaConversionUtilities.java"
        ]
    },
    "pig_f9a24a9": {
        "bug_id": "pig_f9a24a9",
        "commit": "https://github.com/apache/pig/commit/f9a24a9b9140444e7a0559eb727b66bc036792de",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/pig/blob/f9a24a9b9140444e7a0559eb727b66bc036792de/src/org/apache/pig/builtin/PigStorage.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/pig/contents/src/org/apache/pig/builtin/PigStorage.java?ref=f9a24a9b9140444e7a0559eb727b66bc036792de",
                "deletions": 2,
                "filename": "src/org/apache/pig/builtin/PigStorage.java",
                "patch": "@@ -28,7 +28,6 @@\n import org.apache.commons.cli.GnuParser;\n import org.apache.commons.cli.HelpFormatter;\n import org.apache.commons.cli.Option;\n-import org.apache.commons.cli.OptionBuilder;\n import org.apache.commons.cli.Options;\n import org.apache.commons.cli.ParseException;\n import org.apache.commons.logging.Log;\n@@ -166,7 +165,7 @@ private Options populateValidOptions() {\n         validOptions.addOption(TAG_SOURCE_FILE, false, \"Appends input source file name to beginning of each tuple.\");\n         validOptions.addOption(TAG_SOURCE_PATH, false, \"Appends input source file path to beginning of each tuple.\");\n         validOptions.addOption(\"tagsource\", false, \"Appends input source file name to beginning of each tuple.\");\n-        Option overwrite = new Option(null, \"Overwrites the destination.\");\n+        Option overwrite = new Option(\" \", \"Overwrites the destination.\");\n         overwrite.setLongOpt(\"overwrite\");\n         overwrite.setOptionalArg(true);\n         overwrite.setArgs(1);",
                "raw_url": "https://github.com/apache/pig/raw/f9a24a9b9140444e7a0559eb727b66bc036792de/src/org/apache/pig/builtin/PigStorage.java",
                "sha": "675f138fc36e2595b430225c2dca3853ed82656e",
                "status": "modified"
            }
        ],
        "message": "PIG-3988: PigStorage: CommandLineParser is not thread safe (tmwoodruff via rohini) - Fix NPE with commons-cli-1.0.jar\n\ngit-svn-id: https://svn.apache.org/repos/asf/pig/trunk@1601993 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/pig/commit/beaca12dc346df325f98cd01911b4ae7d51a23e1",
        "repo": "pig",
        "unit_tests": [
            "TestPigStorage.java"
        ]
    }
}