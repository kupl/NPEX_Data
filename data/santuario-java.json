{
    "santuario-java_059d726": {
        "bug_id": "santuario-java_059d726",
        "commit": "https://github.com/apache/santuario-java/commit/059d726166539e7421466339823ba6d2b0fc3fd6",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/santuario-java/blob/059d726166539e7421466339823ba6d2b0fc3fd6/src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/signature/XMLSignature.java?ref=059d726166539e7421466339823ba6d2b0fc3fd6",
                "deletions": 2,
                "filename": "src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "patch": "@@ -373,8 +373,8 @@ public XMLSignature(Element element, String baseURI, boolean secureValidation)\n \n         // If it exists use it, but it's not mandatory\n         if (keyInfoElem != null \n-            && keyInfoElem.getNamespaceURI().equals(Constants.SignatureSpecNS) \n-            && keyInfoElem.getLocalName().equals(Constants._TAG_KEYINFO)) {\n+            && Constants.SignatureSpecNS.equals(keyInfoElem.getNamespaceURI()) \n+            && Constants._TAG_KEYINFO.equals(keyInfoElem.getLocalName())) {\n             this.keyInfo = new KeyInfo(keyInfoElem, baseURI);\n             this.keyInfo.setSecureValidation(secureValidation);\n         }",
                "raw_url": "https://github.com/apache/santuario-java/raw/059d726166539e7421466339823ba6d2b0fc3fd6/src/main/java/org/apache/xml/security/signature/XMLSignature.java",
                "sha": "9b676df9251f03b55379e2e2180db0b89e4a66b8",
                "status": "modified"
            }
        ],
        "message": "[SANTUARIO-368] - NPE in XMLSignature\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1527497 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/7bbe05553af241cd1fa8b5c5884f832e7ee2c485",
        "repo": "santuario-java",
        "unit_tests": [
            "XMLSignatureTest.java"
        ]
    },
    "santuario-java_1b99955": {
        "bug_id": "santuario-java_1b99955",
        "commit": "https://github.com/apache/santuario-java/commit/1b99955f74a2ba254426a2f1aa04131d9f12d1de",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/santuario-java/blob/1b99955f74a2ba254426a2f1aa04131d9f12d1de/src/org/apache/xml/security/utils/resolver/ResourceResolver.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/org/apache/xml/security/utils/resolver/ResourceResolver.java?ref=1b99955f74a2ba254426a2f1aa04131d9f12d1de",
                "deletions": 1,
                "filename": "src/org/apache/xml/security/utils/resolver/ResourceResolver.java",
                "patch": "@@ -139,7 +139,8 @@ public static final ResourceResolver getInstance(\n            Attr uri, String BaseURI, List individualResolvers)\n               throws ResourceResolverException {\n       if (log.isDebugEnabled()) {\n-      \tlog.debug(\"I was asked to create a ResourceResolver and got \" + individualResolvers.size());\n+    \t  \n+      \tlog.debug(\"I was asked to create a ResourceResolver and got \" + (individualResolvers==null? 0 : individualResolvers.size()) );\n       \tlog.debug(\" extra resolvers to my existing \" + ResourceResolver._resolverVector.size() + \" system-wide resolvers\");\n       }\n ",
                "raw_url": "https://github.com/apache/santuario-java/raw/1b99955f74a2ba254426a2f1aa04131d9f12d1de/src/org/apache/xml/security/utils/resolver/ResourceResolver.java",
                "sha": "2d1387827455f1937c57d8018ffd80ac55bc7860",
                "status": "modified"
            }
        ],
        "message": "Fix a NPE when debug is enable.\n\ngit-svn-id: https://svn.apache.org/repos/asf/xml/security/trunk@412862 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/71aeaa5cb18f30261c6bc1f4a49670d942cdcec4",
        "repo": "santuario-java",
        "unit_tests": [
            "ResourceResolverTest.java"
        ]
    },
    "santuario-java_45ceab7": {
        "bug_id": "santuario-java_45ceab7",
        "commit": "https://github.com/apache/santuario-java/commit/45ceab71dd72ab96fe76f89421adad161fc20b11",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/santuario-java/blob/45ceab71dd72ab96fe76f89421adad161fc20b11/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java?ref=45ceab71dd72ab96fe76f89421adad161fc20b11",
                "deletions": 3,
                "filename": "src/main/java/org/apache/xml/security/algorithms/JCEMapper.java",
                "patch": "@@ -277,9 +277,11 @@ public static String getJCEKeyAlgorithmFromURI(String algorithmURI) {\n         if (log.isDebugEnabled()) {\n             log.debug(\"Request for URI \" + algorithmURI);\n         }\n-        Algorithm algorithm = algorithmsMap.get(algorithmURI);\n-        if (algorithm != null) {\n-            return algorithm.requiredKey;\n+        if (algorithmURI != null) {\n+            Algorithm algorithm = algorithmsMap.get(algorithmURI);\n+            if (algorithm != null) {\n+                return algorithm.requiredKey;\n+            }\n         }\n         return null;\n     }",
                "raw_url": "https://github.com/apache/santuario-java/raw/45ceab71dd72ab96fe76f89421adad161fc20b11/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java",
                "sha": "6643a888a654007ab3e497c4ad8f2fa2e226a7b7",
                "status": "modified"
            }
        ],
        "message": "Avoid a NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1590785 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/a2220812349e9dfdcc614c9572c836999ce180fe",
        "repo": "santuario-java",
        "unit_tests": [
            "JCEMapperTest.java"
        ]
    },
    "santuario-java_6c87fb9": {
        "bug_id": "santuario-java_6c87fb9",
        "commit": "https://github.com/apache/santuario-java/commit/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/santuario-java/blob/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/encryption/XMLCipher.java?ref=6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7",
                "deletions": 0,
                "filename": "src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "patch": "@@ -1142,6 +1142,9 @@ private EncryptedData encryptData(\n         if (serializer instanceof AbstractSerializer) {\n             ((AbstractSerializer)serializer).setSecureValidation(secureValidation);\n         }\n+        if (element != null && element.getParentNode() == null) {\n+            throw new XMLEncryptionException(\"empty\", \"The element can't be serialized as it has no parent\");\n+        }\n \n         byte[] serializedOctets = null;\n         if (serializedData == null) {\n@@ -1697,6 +1700,10 @@ private Document decryptElement(Element element) throws XMLEncryptionException {\n         if (serializer instanceof AbstractSerializer) {\n             ((AbstractSerializer)serializer).setSecureValidation(secureValidation);\n         }\n+        \n+        if (element != null && element.getParentNode() == null) {\n+            throw new XMLEncryptionException(\"empty\", \"The element can't be serialized as it has no parent\");\n+        }\n \n         if (cipherMode != DECRYPT_MODE) {\n             throw new XMLEncryptionException(\"empty\", \"XMLCipher unexpectedly not in DECRYPT_MODE...\");",
                "raw_url": "https://github.com/apache/santuario-java/raw/6c87fb9406703d6fe7f256b9a3c973b34d0a0dd7/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "sha": "890d62635addcf3db8aa2a71eb3a550987bc2f38",
                "status": "modified"
            }
        ],
        "message": "NPE fix\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1683510 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/e06f6b15a588a27d84b852407d0541bf4c8a1938",
        "repo": "santuario-java",
        "unit_tests": [
            "XMLCipherTest.java"
        ]
    },
    "santuario-java_a87886d": {
        "bug_id": "santuario-java_a87886d",
        "commit": "https://github.com/apache/santuario-java/commit/a87886d806115ca3ba3350fd5d6c7d08c0decddf",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/santuario-java/blob/a87886d806115ca3ba3350fd5d6c7d08c0decddf/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/xml/security/encryption/XMLCipher.java?ref=a87886d806115ca3ba3350fd5d6c7d08c0decddf",
                "deletions": 1,
                "filename": "src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "patch": "@@ -3645,8 +3645,12 @@ private static boolean haveFunctionalIdentityTransformer() {\n                     new javax.xml.transform.stream.StreamSource(\n                             new java.io.ByteArrayInputStream(xml.getBytes(\"UTF-8\"))), domResult);\n \n-            final boolean result = \"http://www.w3.org/2000/xmlns/\".equals(\n+            boolean result = false;\n+            if (domResult.getNode().getFirstChild().getFirstChild().hasAttributes()\n+                && domResult.getNode().getFirstChild().getFirstChild().getAttributes().getLength() >= 1) {\n+                result = \"http://www.w3.org/2000/xmlns/\".equals(\n                     domResult.getNode().getFirstChild().getFirstChild().getAttributes().item(1).getNamespaceURI());\n+            }\n             log.debug(\"Have functional IdentityTransformer: \" + result);\n             return result;\n ",
                "raw_url": "https://github.com/apache/santuario-java/raw/a87886d806115ca3ba3350fd5d6c7d08c0decddf/src/main/java/org/apache/xml/security/encryption/XMLCipher.java",
                "sha": "f8dcaf2b4e036f0dcd04efbd0b26080d362282f9",
                "status": "modified"
            }
        ],
        "message": "Avoid potential NPE in XMLCipher\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1683359 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/8812e5fd78b714902e5b58956cdc27dbed5e565b",
        "repo": "santuario-java",
        "unit_tests": [
            "XMLCipherTest.java"
        ]
    }
}