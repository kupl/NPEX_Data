[
    {
        "repo": "sling-org-apache-sling-jcr-repoinit",
        "message": "Fix NPE in processing\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@1768865 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/commit/37b0bace42349e7938b6c333089d7bc6aecbf443",
        "parent": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/commit/8cce4ea4e8408136b668b765e72017ae26b4ba83",
        "bug_id": "sling-org-apache-sling-jcr-repoinit_1",
        "file": [
            {
                "sha": "44f2e946b7c2d08fc549bb15800f4f74011282ee",
                "filename": "src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/blob/37b0bace42349e7938b6c333089d7bc6aecbf443/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/raw/37b0bace42349e7938b6c333089d7bc6aecbf443/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "status": "modified",
                "changes": 26,
                "additions": 14,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-jcr-repoinit/contents/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java?ref=37b0bace42349e7938b6c333089d7bc6aecbf443",
                "patch": "@@ -84,19 +84,21 @@ public String toString() {\n \n     @Override\n     public void processRepository(SlingRepository repo) throws Exception {\n-        // loginAdministrative is ok here, definitely an admin operation\n-        final Session s = repo.loginAdministrative(null);\n-        try {\n-            final RepoinitTextProvider p = new RepoinitTextProvider();\n-            for(String reference : config.references()) {\n-                final String repoinitText = p.getRepoinitText(reference);\n-                final List<Operation> ops = parser.parse(new StringReader(repoinitText));\n-                log.info(\"Executing {} repoinit operations\", ops.size());\n-                processor.apply(s, ops);\n-                s.save();\n+        if ( config.references() != null && config.references().length > 0 ) {\n+            // loginAdministrative is ok here, definitely an admin operation\n+            final Session s = repo.loginAdministrative(null);\n+            try {\n+                final RepoinitTextProvider p = new RepoinitTextProvider();\n+                for(String reference : config.references()) {\n+                    final String repoinitText = p.getRepoinitText(reference);\n+                    final List<Operation> ops = parser.parse(new StringReader(repoinitText));\n+                    log.info(\"Executing {} repoinit operations\", ops.size());\n+                    processor.apply(s, ops);\n+                    s.save();\n+                }\n+            } finally {\n+                s.logout();\n             }\n-        } finally {\n-            s.logout();\n         }\n     }\n }",
                "deletions": 12
            }
        ]
    },
    {
        "repo": "sling-org-apache-sling-jcr-repoinit",
        "message": "Fix NPE in activate\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@1768851 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/commit/f1f72d185e6dfb9b9c43ef81e15a31bbdb3a10e4",
        "parent": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/commit/cb53ef433b57224a5157f84a78d429f12c16d6e9",
        "bug_id": "sling-org-apache-sling-jcr-repoinit_2",
        "file": [
            {
                "sha": "f4abbe321462e72112d76eb0a5a2b4145a12a345",
                "filename": "src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/blob/f1f72d185e6dfb9b9c43ef81e15a31bbdb3a10e4/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-jcr-repoinit/raw/f1f72d185e6dfb9b9c43ef81e15a31bbdb3a10e4/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-jcr-repoinit/contents/src/main/java/org/apache/sling/jcr/repoinit/impl/RepositoryInitializer.java?ref=f1f72d185e6dfb9b9c43ef81e15a31bbdb3a10e4",
                "patch": "@@ -79,7 +79,7 @@ public void activate(Config config) {\n \n     @Override\n     public String toString() {\n-        return getClass().getSimpleName() + \", references=\" + Arrays.asList(config.references());\n+        return getClass().getSimpleName() + \", references=\" + Arrays.toString(config.references());\n     }\n \n     @Override",
                "deletions": 1
            }
        ]
    }
]