[
    {
        "repo": "jackrabbit-oak",
        "commit": "https://github.com/apache/jackrabbit-oak/commit/82819bc6c0aa9992777d4b233db641c174804233",
        "bug_id": "jackrabbit-oak_82819bc",
        "message": "OAK-5636: potential NPE in ReplicaSetInfo\n\ngit-svn-id: https://svn.apache.org/repos/asf/jackrabbit/oak/trunk@1782962 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/jackrabbit-oak/commit/302228a44592c10b690f957107fe257566f951a0",
        "patched_files": [
            "ReplicaSetInfo.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 5,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/82819bc6c0aa9992777d4b233db641c174804233/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java?ref=82819bc6c0aa9992777d4b233db641c174804233",
                "filename": "oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java",
                "deletions": 1,
                "sha": "a3477464a2ad1fc6d41460bc7161bbec2b8c32f9",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/82819bc6c0aa9992777d4b233db641c174804233/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java",
                "patch": "@@ -250,18 +250,22 @@ private void updateRevisions(Iterable<BasicBSONObject> members) {\n             }\n         }\n \n+        Set<String> hostsToCheck = new HashSet<String>();\n         if (secondaries.isEmpty()) {\n             LOG.debug(\"No secondaries found: {}\", members);\n             unknownState = true;\n+        } else {\n+            hostsToCheck.addAll(secondaries);\n         }\n \n         if (primary == null) {\n             LOG.debug(\"No primary found: {}\", members);\n             unknownState = true;\n+        } else {\n+            hostsToCheck.add(primary);\n         }\n \n         Map<String, Timestamped<RevisionVector>> vectors = null;\n-        Set<String> hostsToCheck = union(secondaries, of(primary));\n         if (!unknownState) {\n             vectors = getRootRevisions(hostsToCheck);\n             if (vectors.containsValue(null)) {",
                "changes": 6
            }
        ],
        "unit_tests": [
            "ReplicaSetInfoTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfoTest.java",
        "buggy_files": [
            "oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/mongo/replica/ReplicaSetInfo.java"
        ],
        "fixed": true
    }
]