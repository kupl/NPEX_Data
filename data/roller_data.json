[
    {
        "parent": "https://github.com/apache/roller/commit/496a37d0e5e9b9dfbc3d403ccac52b03ca4b4873",
        "bug_id": "roller_1",
        "file": [
            {
                "additions": 11,
                "sha": "7be6b923074bdd8d8c2369e94919ed507f48de67",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c3eefb87db8a13880d8bd0138518501488e714e9/app/src/main/java/org/apache/roller/weblogger/ui/rendering/servlets/PageServlet.java",
                "deletions": 6,
                "filename": "app/src/main/java/org/apache/roller/weblogger/ui/rendering/servlets/PageServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/ui/rendering/servlets/PageServlet.java?ref=c3eefb87db8a13880d8bd0138518501488e714e9",
                "patch": "@@ -420,13 +420,18 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n         if (StringUtils.isNotEmpty(page.getOutputContentType())) {\n             contentType = page.getOutputContentType() + \"; charset=utf-8\";\n         } else {\n-            String mimeType = RollerContext.getServletContext().getMimeType(\n-                    page.getLink());\n-            if (mimeType != null) {\n-                // we found a match ... set the content deviceType\n-                contentType = mimeType + \"; charset=utf-8\";\n+            final String defaultContentType = \"text/html; charset=utf-8\";\n+            if (page.getLink() == null) {\n+                contentType = defaultContentType;\n             } else {\n-                contentType = \"text/html; charset=utf-8\";\n+                String mimeType = RollerContext.getServletContext().getMimeType(\n+                        page.getLink());\n+                if (mimeType != null) {\n+                    // we found a match ... set the content deviceType\n+                    contentType = mimeType + \"; charset=utf-8\";\n+                } else {\n+                    contentType = defaultContentType;\n+                }\n             }\n         }\n ",
                "changes": 17,
                "blob_url": "https://github.com/apache/roller/blob/c3eefb87db8a13880d8bd0138518501488e714e9/app/src/main/java/org/apache/roller/weblogger/ui/rendering/servlets/PageServlet.java"
            }
        ],
        "repo": "roller",
        "message": "ROL-2057 add NPE check, patch from Kohei Nozaki\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1649453 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/c3eefb87db8a13880d8bd0138518501488e714e9"
    },
    {
        "parent": "https://github.com/apache/roller/commit/20d42109c1deebbb53dd3220cb622c9659f92a6e",
        "bug_id": "roller_2",
        "file": [
            {
                "additions": 2,
                "sha": "0a439ead075749db9f9c320205386393d705959b",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/e4167d2c1744e09926b0070fc65cd3a2d121b451/app/src/main/java/org/apache/roller/weblogger/business/startup/WebloggerStartup.java",
                "deletions": 7,
                "filename": "app/src/main/java/org/apache/roller/weblogger/business/startup/WebloggerStartup.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/business/startup/WebloggerStartup.java?ref=e4167d2c1744e09926b0070fc65cd3a2d121b451",
                "patch": "@@ -176,13 +176,8 @@ public static void prepare() throws StartupException {\n         try {\n             mailProvider = new MailProvider();\n         } catch(StartupException ex) {\n-            if (LOG.isDebugEnabled()) {\n-                LOG.debug(\"Failed to setup mail provider, continuing anyways.\\n\"\n-                        + \"Reason: \" + ex.getMessage(), ex);\n-            } else {\n-                LOG.warn(\"Failed to setup mail provider, continuing anyways.\\n\"\n-                        + \"Reason: \" + ex.getMessage());\n-            }\n+            LOG.warn(\"Failed to setup mail provider, continuing anyways.\\n\"\n+                    + \"Reason: \" + ex.getMessage());\n         }\n         \n         // now we need to deal with database install/upgrade logic",
                "changes": 9,
                "blob_url": "https://github.com/apache/roller/blob/e4167d2c1744e09926b0070fc65cd3a2d121b451/app/src/main/java/org/apache/roller/weblogger/business/startup/WebloggerStartup.java"
            },
            {
                "additions": 4,
                "sha": "ee5eb37bc029043fc4ebd3c7c037ff18f50c56ed",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/e4167d2c1744e09926b0070fc65cd3a2d121b451/app/src/main/java/org/apache/roller/weblogger/ui/core/RollerContext.java",
                "deletions": 0,
                "filename": "app/src/main/java/org/apache/roller/weblogger/ui/core/RollerContext.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/ui/core/RollerContext.java?ref=e4167d2c1744e09926b0070fc65cd3a2d121b451",
                "patch": "@@ -104,6 +104,10 @@ public void contextInitialized(ServletContextEvent sce) {\n         \n         // get the *real* path to <context>/resources\n         String ctxPath = servletContext.getRealPath(\"/\");\n+        if (ctxPath == null) {\n+            log.fatal(\"Roller requires an exploded WAR file to run.\");\n+            return;\n+        }\n         if (!ctxPath.endsWith(File.separator)) {\n             ctxPath += File.separator + \"resources\";\n         } else {",
                "changes": 4,
                "blob_url": "https://github.com/apache/roller/blob/e4167d2c1744e09926b0070fc65cd3a2d121b451/app/src/main/java/org/apache/roller/weblogger/ui/core/RollerContext.java"
            }
        ],
        "repo": "roller",
        "message": "ROL-1948 NPE check when roller.war never got expanded.\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1609108 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/e4167d2c1744e09926b0070fc65cd3a2d121b451"
    },
    {
        "parent": "https://github.com/apache/roller/commit/0c597e7435d5c8308fc3b7e9fe10533b2e3987c1",
        "bug_id": "roller_3",
        "file": [
            {
                "additions": 3,
                "sha": "2436e6a6fa915fe07c9c804ebfeace7e68db7cc3",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/97883d83a57b63707cee0588816491509f53f3c1/app/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogManagerImpl.java",
                "deletions": 0,
                "filename": "app/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogManagerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogManagerImpl.java?ref=97883d83a57b63707cee0588816491509f53f3c1",
                "patch": "@@ -534,6 +534,9 @@ public void saveThemeAssoc(WeblogThemeAssoc themeAssoc) throws WebloggerExceptio\n         \n     public List getUserWeblogs(User user, boolean enabledOnly) throws WebloggerException {\n         List weblogs = new ArrayList();\n+        if (user == null) {\n+            return weblogs;\n+        }\n         List<WeblogPermission> perms = roller.getUserManager().getWeblogPermissions(user);\n         for (WeblogPermission perm : perms) {\n             Weblog weblog = perm.getWeblog();",
                "changes": 3,
                "blob_url": "https://github.com/apache/roller/blob/97883d83a57b63707cee0588816491509f53f3c1/app/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogManagerImpl.java"
            }
        ],
        "repo": "roller",
        "message": "Don't throw NPE when user is null.\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1554552 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/97883d83a57b63707cee0588816491509f53f3c1"
    },
    {
        "parent": "https://github.com/apache/roller/commit/b0313e03a4f66f808f522c916cc56365e9af3a0a",
        "bug_id": "roller_4",
        "file": [
            {
                "additions": 7,
                "sha": "0f9e17a74d601353167309ec2e7402127e921162",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/369ff160be1ce222c6217e22df868255a242edde/app/src/main/java/org/apache/roller/weblogger/ui/rendering/mobile/MobileDeviceRepository.java",
                "deletions": 5,
                "filename": "app/src/main/java/org/apache/roller/weblogger/ui/rendering/mobile/MobileDeviceRepository.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/ui/rendering/mobile/MobileDeviceRepository.java?ref=369ff160be1ce222c6217e22df868255a242edde",
                "patch": "@@ -58,11 +58,13 @@\n \t * @return   boolean\n \t */\n \tpublic static boolean isMobileDevice(HttpServletRequest request) {\n-\n-\t\tString userAgent = request.getHeader(\"User-Agent\").toLowerCase();\n-\t\treturn (userAgent.matches(possibleDevices1) || userAgent.substring(0, 4).matches(possibleDevices2));\n-\n-\t}\n+        String userAgent = request.getHeader(\"User-Agent\");\n+        if (userAgent != null) {\n+            userAgent = request.getHeader(\"User-Agent\").toLowerCase();\n+            return (userAgent.matches(possibleDevices1) || userAgent.substring(0, 4).matches(possibleDevices2));\n+        }\n+        return false;\n+    }\n \n \tpublic static DeviceType getRequestType(HttpServletRequest request) {\n \t\tDeviceType type = DeviceType.standard;",
                "changes": 12,
                "blob_url": "https://github.com/apache/roller/blob/369ff160be1ce222c6217e22df868255a242edde/app/src/main/java/org/apache/roller/weblogger/ui/rendering/mobile/MobileDeviceRepository.java"
            }
        ],
        "repo": "roller",
        "message": "prevent NPE when no user-agent in request\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1493723 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/369ff160be1ce222c6217e22df868255a242edde"
    },
    {
        "parent": "https://github.com/apache/roller/commit/d163da516527edc636ca73a6b2c8e194ec982d75",
        "bug_id": "roller_5",
        "file": [
            {
                "additions": 6,
                "sha": "4d7a8de4135c73fad2dde1ea3cdd61c259cd3ab7",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/f46fc458ae422cd425522a3d59c2f5812c65c5ea/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java",
                "deletions": 0,
                "filename": "weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java?ref=f46fc458ae422cd425522a3d59c2f5812c65c5ea",
                "patch": "@@ -408,6 +408,12 @@ public void removeWeblogEntry(WeblogEntry entry) throws WebloggerException {\n     public List getNextPrevEntries(WeblogEntry current, String catName,\n             String locale, int maxEntries, boolean next)\n             throws WebloggerException {\n+\n+\t\tif (current == null) {\n+\t\t\tlog.debug(\"WeblogEntry current cannot be null\");\t\t\t\n+\t\t\treturn Collections.emptyList();\n+\t\t}\n+\n         Query query = null;\n         List results = null;\n         WeblogCategory category = null;",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/f46fc458ae422cd425522a3d59c2f5812c65c5ea/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java"
            }
        ],
        "repo": "roller",
        "message": "Prevent NPE when template passes null weblog\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1243080 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/f46fc458ae422cd425522a3d59c2f5812c65c5ea"
    },
    {
        "parent": "https://github.com/apache/roller/commit/1bdd93149bb588a74fa26b59641f7287889ed0c8",
        "bug_id": "roller_6",
        "file": [
            {
                "additions": 6,
                "sha": "4d7a8de4135c73fad2dde1ea3cdd61c259cd3ab7",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/f9eaafa03d438770432ba58f393fdb5f7e592775/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java",
                "deletions": 0,
                "filename": "weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java?ref=f9eaafa03d438770432ba58f393fdb5f7e592775",
                "patch": "@@ -408,6 +408,12 @@ public void removeWeblogEntry(WeblogEntry entry) throws WebloggerException {\n     public List getNextPrevEntries(WeblogEntry current, String catName,\n             String locale, int maxEntries, boolean next)\n             throws WebloggerException {\n+\n+\t\tif (current == null) {\n+\t\t\tlog.debug(\"WeblogEntry current cannot be null\");\t\t\t\n+\t\t\treturn Collections.emptyList();\n+\t\t}\n+\n         Query query = null;\n         List results = null;\n         WeblogCategory category = null;",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/f9eaafa03d438770432ba58f393fdb5f7e592775/weblogger-business/src/main/java/org/apache/roller/weblogger/business/jpa/JPAWeblogEntryManagerImpl.java"
            }
        ],
        "repo": "roller",
        "message": "Prevent NPE when template passes null weblog\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/branches/roller_5.0@1234529 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/f9eaafa03d438770432ba58f393fdb5f7e592775"
    },
    {
        "parent": "https://github.com/apache/roller/commit/1dcc6668677e98ec6c2e85ccb6a4dcc0d6e176d8",
        "bug_id": "roller_7",
        "file": [
            {
                "additions": 1,
                "sha": "a339dac7f79c29208835e42f9565e75fcba0e90d",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/69aa87385c5763f468cc4b55a4655f476b61b294/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/velocity/deprecated/OldPageHelper.java",
                "deletions": 1,
                "filename": "apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/velocity/deprecated/OldPageHelper.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/velocity/deprecated/OldPageHelper.java?ref=69aa87385c5763f468cc4b55a4655f476b61b294",
                "patch": "@@ -139,7 +139,7 @@ public boolean isUserAuthorizedToEdit() {\n         try {\n             RollerSession rses =\n                     RollerSession.getRollerSession(mRequest);\n-            if ( rses.getAuthenticatedUser() != null\n+            if ( rses != null && rses.getAuthenticatedUser() != null\n                     && mWebsite != null) {\n                 return rses.isUserAuthorizedToAdmin(mWebsite);\n             }",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/69aa87385c5763f468cc4b55a4655f476b61b294/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/velocity/deprecated/OldPageHelper.java"
            }
        ],
        "repo": "roller",
        "message": "fixing NPE thrown when roller session is null.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@546305 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/69aa87385c5763f468cc4b55a4655f476b61b294"
    },
    {
        "parent": "https://github.com/apache/roller/commit/67d5b7f4c0819c2083cfb4149346a95605f08a21",
        "bug_id": "roller_8",
        "file": [
            {
                "additions": 1,
                "sha": "a190329a6b5af138c5d51b0bb941a37e0c3de041",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/de7dd3c6b4e9ba140559ef3a617ee3d44fa88da8/src/org/apache/roller/ui/rendering/servlets/PreviewServlet.java",
                "deletions": 1,
                "filename": "src/org/apache/roller/ui/rendering/servlets/PreviewServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/PreviewServlet.java?ref=de7dd3c6b4e9ba140559ef3a617ee3d44fa88da8",
                "patch": "@@ -135,7 +135,7 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n         \n         // set the content type\n         String pageLink = previewRequest.getWeblogPageName();\n-        String mimeType = RollerContext.getServletContext().getMimeType(pageLink);\n+        String mimeType = pageLink !=  null ? RollerContext.getServletContext().getMimeType(pageLink) : null;        \n         String contentType = \"text/html; charset=utf-8\";\n         if(mimeType != null) {\n             // we found a match ... set the content type",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/de7dd3c6b4e9ba140559ef3a617ee3d44fa88da8/src/org/apache/roller/ui/rendering/servlets/PreviewServlet.java"
            }
        ],
        "repo": "roller",
        "message": "- Avoiding NPE in WebSphere.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@470171 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/de7dd3c6b4e9ba140559ef3a617ee3d44fa88da8"
    },
    {
        "parent": "https://github.com/apache/roller/commit/874c9ef197ad6f2124d1cffb54eb346f91c8dba0",
        "bug_id": "roller_9",
        "file": [
            {
                "additions": 4,
                "sha": "2eff12d0f62d00484f595e98d6473db37ac4d850",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/886b01cdc6ee1b5e19b483fbd1af1fca8a87f3d9/src/org/apache/roller/ui/rendering/servlets/PreviewResourceServlet.java",
                "deletions": 2,
                "filename": "src/org/apache/roller/ui/rendering/servlets/PreviewResourceServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/PreviewResourceServlet.java?ref=886b01cdc6ee1b5e19b483fbd1af1fca8a87f3d9",
                "patch": "@@ -116,8 +116,10 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n                 ThemeManager themeMgr = RollerFactory.getRoller().getThemeManager();\n                 Theme weblogTheme = themeMgr.getTheme(weblog.getEditorTheme());\n                 File resource = weblogTheme.getResource(resourceRequest.getResourcePath());\n-                resourceLastMod = resource.lastModified();\n-                resourceStream = new FileInputStream(resource);\n+                if(resource != null) {\n+                    resourceLastMod = resource.lastModified();\n+                    resourceStream = new FileInputStream(resource);\n+                }\n             } catch (Exception ex) {\n                 // hmmm, some kind of error getting theme.  that's an error.\n                 response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/886b01cdc6ee1b5e19b483fbd1af1fca8a87f3d9/src/org/apache/roller/ui/rendering/servlets/PreviewResourceServlet.java"
            }
        ],
        "repo": "roller",
        "message": "- Avoiding NPE (same as earlier fix for ResourceServlet)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@466134 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/886b01cdc6ee1b5e19b483fbd1af1fca8a87f3d9"
    },
    {
        "parent": "https://github.com/apache/roller/commit/471fb9c1b5601e1c06a22d920d91d3999962434a",
        "bug_id": "roller_10",
        "file": [
            {
                "additions": 4,
                "sha": "6c969294a1380d68953d99957876c53a856f75ea",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/1ae5bfc0d27f97656431d09915e7c139975b6745/src/org/apache/roller/ui/rendering/servlets/ResourceServlet.java",
                "deletions": 2,
                "filename": "src/org/apache/roller/ui/rendering/servlets/ResourceServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/ResourceServlet.java?ref=1ae5bfc0d27f97656431d09915e7c139975b6745",
                "patch": "@@ -109,8 +109,10 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n                 ThemeManager themeMgr = RollerFactory.getRoller().getThemeManager();\n                 Theme weblogTheme = themeMgr.getTheme(weblog.getEditorTheme());\n                 File resource = weblogTheme.getResource(resourceRequest.getResourcePath());\n-                resourceLastMod = resource.lastModified();\n-                resourceStream = new FileInputStream(resource);\n+                if(resource != null) {\n+                    resourceLastMod = resource.lastModified();\n+                    resourceStream = new FileInputStream(resource);\n+                }\n             } catch (Exception ex) {\n                 // hmmm, some kind of error getting theme.  that's an error.\n                 response.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/1ae5bfc0d27f97656431d09915e7c139975b6745/src/org/apache/roller/ui/rendering/servlets/ResourceServlet.java"
            }
        ],
        "repo": "roller",
        "message": "Fixed NPE when resource is not part of the theme.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@463554 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/1ae5bfc0d27f97656431d09915e7c139975b6745"
    },
    {
        "parent": "https://github.com/apache/roller/commit/991d4f1cc68e0123ca2c9c64ef8d31f6c4bd1640",
        "bug_id": "roller_11",
        "file": [
            {
                "additions": 1,
                "sha": "b84b67ffbd25714e14cf02076a68573d40cf5aee",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4cb3ac9697d7df3bd24a645fb4adafa2bcb23a5a/src/org/apache/roller/ui/core/RollerSession.java",
                "deletions": 1,
                "filename": "src/org/apache/roller/ui/core/RollerSession.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/core/RollerSession.java?ref=4cb3ac9697d7df3bd24a645fb4adafa2bcb23a5a",
                "patch": "@@ -197,7 +197,7 @@ public boolean isUserAuthorizedToAdmin(WebsiteData website)\n     private boolean hasPermissions(WebsiteData website, short mask) \n     {\n         UserData user = getAuthenticatedUser();\n-        if (user != null) \n+        if (website != null && user != null) \n         {\n             return website.hasUserPermissions(user, mask);\n         }",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/4cb3ac9697d7df3bd24a645fb4adafa2bcb23a5a/src/org/apache/roller/ui/core/RollerSession.java"
            }
        ],
        "repo": "roller",
        "message": "Preventing NPE that occurs on some URLs\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/branches/roller_3.0@437164 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/4cb3ac9697d7df3bd24a645fb4adafa2bcb23a5a"
    },
    {
        "parent": "https://github.com/apache/roller/commit/0812d2b250708ccec790d307190531f1a1a01bb5",
        "bug_id": "roller_12",
        "file": [
            {
                "additions": 9,
                "sha": "89d38dcbe99a8b9458fbac0f9d84e62d869bf3a6",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/f9011047489048b2a8953be189dc9b96bdb0a649/src/org/apache/roller/ui/core/tags/menu/BaseRollerMenu.java",
                "deletions": 3,
                "filename": "src/org/apache/roller/ui/core/tags/menu/BaseRollerMenu.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/core/tags/menu/BaseRollerMenu.java?ref=f9011047489048b2a8953be189dc9b96bdb0a649",
                "patch": "@@ -231,15 +231,21 @@ protected static WebsiteData getRequestedWeblog(HttpServletRequest request) thro\n         } else if (request.getParameter(RequestConstants.WEBLOGENTRY_ID) != null) {\n             String entryId = request.getParameter(RequestConstants.WEBLOGENTRY_ID);\n             WeblogEntryData entry = roller.getWeblogManager().getWeblogEntry(entryId);\n-            weblog = entry.getWebsite();\n+            if(entry != null) {\n+                weblog = entry.getWebsite();\n+            }\n         } else if (request.getParameter(RequestConstants.WEBLOGCATEGORY_ID) != null) {\n             String catId = request.getParameter(RequestConstants.WEBLOGCATEGORY_ID);\n             WeblogCategoryData cat = roller.getWeblogManager().getWeblogCategory(catId);\n-            weblog = cat.getWebsite();\n+            if(cat != null) {\n+                weblog = cat.getWebsite();\n+            }\n         } else if (request.getParameter(RequestConstants.FOLDER_ID) != null) {\n             String folderId = request.getParameter(RequestConstants.FOLDER_ID);\n             FolderData folder = roller.getBookmarkManager().getFolder(folderId);\n-            weblog = folder.getWebsite();\n+            if(folder != null) {\n+                weblog = folder.getWebsite();\n+            }\n         } else if (request.getSession().getAttribute(RequestConstants.WEBLOG_SESSION_STASH) != null) {\n             String handle = (String)request.getSession().getAttribute(RequestConstants.WEBLOG_SESSION_STASH);\n             weblog = roller.getUserManager().getWebsiteByHandle(handle);",
                "changes": 12,
                "blob_url": "https://github.com/apache/roller/blob/f9011047489048b2a8953be189dc9b96bdb0a649/src/org/apache/roller/ui/core/tags/menu/BaseRollerMenu.java"
            }
        ],
        "repo": "roller",
        "message": "fixing some possible NPEs.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/branches/roller_3.0@430847 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/f9011047489048b2a8953be189dc9b96bdb0a649"
    },
    {
        "parent": "https://github.com/apache/roller/commit/056de538ebbef0dbd8947284ef1db2326d66824d",
        "bug_id": "roller_13",
        "file": [
            {
                "additions": 20,
                "sha": "8e9ff6ecfbf4a49bcd4ac5762f0f6602db703550",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed/src/org/roller/presentation/velocity/PageModel.java",
                "deletions": 14,
                "filename": "src/org/roller/presentation/velocity/PageModel.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/velocity/PageModel.java?ref=3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed",
                "patch": "@@ -115,16 +115,18 @@ public void init(RollerRequest rreq) {\n     \n     /** Encapsulates folder.getBookmarks() & sorting */\n     public Collection getBookmarks(FolderDataWrapper folder) {\n-        mLogger.debug(\"Getting bookmarks for folder : \"+folder.getName());\n-        \n-        // since we already have a wrapped pojo we know the output\n-        // will be wrapped as well :)\n-        Collection bookmarks = folder.getBookmarks();\n-        \n-        // TODO: need to setup new BookmarkWrapperComparator\n-        //List mBookmarks = new ArrayList(bookmarks);\n-        //Collections.sort( mBookmarks, new BookmarkComparator() );\n-        \n+        Collection bookmarks = null;\n+        if (folder != null) {\n+            mLogger.debug(\"Getting bookmarks for folder : \"+folder.getName());\n+\n+            // since we already have a wrapped pojo we know the output\n+            // will be wrapped as well :)\n+            bookmarks = folder.getBookmarks();\n+\n+            // TODO: need to setup new BookmarkWrapperComparator\n+            //List mBookmarks = new ArrayList(bookmarks);\n+            //Collections.sort( mBookmarks, new BookmarkComparator() );\n+        }\n         return bookmarks;\n     }\n     \n@@ -742,9 +744,13 @@ public List getRecentComments(int maxCount) {\n     }\n     \n     public boolean getEmailComments() {\n-        WebsiteData website = mRollerReq.getWebsite();\n-        boolean emailComments = RollerRuntimeConfig.getBooleanProperty(\"users.comments.emailnotify\");\n-        \n-        return (website.getEmailComments().booleanValue() && emailComments);\n+        if (mRollerReq != null) {\n+            WebsiteData website = mRollerReq.getWebsite();\n+            if (website != null) {\n+                boolean emailComments = RollerRuntimeConfig.getBooleanProperty(\"users.comments.emailnotify\");        \n+                return (website.getEmailComments().booleanValue() && emailComments);\n+            }\n+        }\n+        return false;\n     }\n }",
                "changes": 34,
                "blob_url": "https://github.com/apache/roller/blob/3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed/src/org/roller/presentation/velocity/PageModel.java"
            },
            {
                "additions": 13,
                "sha": "fd012eeedccc3f86cadc353e05283c8c3aceea1a",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed/src/org/roller/util/Utilities.java",
                "deletions": 10,
                "filename": "src/org/roller/util/Utilities.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/util/Utilities.java?ref=3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed",
                "patch": "@@ -1057,17 +1057,20 @@ public static final String charToCDATA(char ch)\n         }\n     }\n     \n-    public static final String encode(String s) \n+    public static final String encode(String s)\n     {\n-        try \n-        {\n-            return URLEncoder.encode(s, \"utf-8\");\n-        } \n-        catch (UnsupportedEncodingException e) \n-        {\n-            return s;\n-        }\n-    }\n+       try\n+       {\n+           if (s != null)\n+               return URLEncoder.encode(s, \"utf-8\");\n+           else\n+               return s;\n+       }\n+       catch (UnsupportedEncodingException e)\n+       {\n+           return s;\n+       }\n+   }\n \n     /**\n      * @param string",
                "changes": 23,
                "blob_url": "https://github.com/apache/roller/blob/3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed/src/org/roller/util/Utilities.java"
            }
        ],
        "repo": "roller",
        "message": "NPE checks from Matt Schmidt\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@367184 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/3c4fd213c1e23cabe046a1647d9a10caf3f3f8ed"
    },
    {
        "parent": "https://github.com/apache/roller/commit/4354febbbdb9640e54a2313f88482a00a40edeb3",
        "bug_id": "roller_14",
        "file": [
            {
                "additions": 35,
                "sha": "029ae37640f334dcb9cda62441e667cda5bdec25",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/src/org/roller/presentation/weblog/actions/BasePingTargetsAction.java",
                "deletions": 24,
                "filename": "src/org/roller/presentation/weblog/actions/BasePingTargetsAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/weblog/actions/BasePingTargetsAction.java?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -24,6 +24,7 @@\n import org.roller.RollerException;\n import org.roller.model.PingTargetManager;\n import org.roller.model.RollerFactory;\n+import org.roller.pojos.WebsiteData;\n import org.roller.pojos.PingTargetData;\n import org.roller.presentation.BasePageModel;\n import org.roller.presentation.forms.PingTargetForm;\n@@ -92,7 +93,7 @@ public ActionForward view(ActionMapping mapping, ActionForm form,\n             BasePageModel pageModel = \n                 new BasePageModel(getPingTargetsTitle(), req, res, mapping);\n             req.setAttribute(\"model\",pageModel);            \n-            if (!hasRequiredRights(rreq))\n+            if (!hasRequiredRights(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(ACCESS_DENIED_PAGE);\n             }\n@@ -131,7 +132,7 @@ public ActionForward save(ActionMapping mapping, ActionForm form,\n             BasePageModel pageModel = \n                 new BasePageModel(getPingTargetEditTitle(), req, res, mapping);\n             req.setAttribute(\"model\",pageModel);            \n-            if (!hasRequiredRights(rreq))\n+            if (!hasRequiredRights(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(ACCESS_DENIED_PAGE);\n             }\n@@ -220,7 +221,7 @@ public ActionForward editSelected(ActionMapping mapping, ActionForm form,\n             BasePageModel pageModel = \n                 new BasePageModel(getPingTargetEditTitle(), req, res, mapping);\n             req.setAttribute(\"model\",pageModel);            \n-            if (!hasRequiredRights(rreq))\n+            if (!hasRequiredRights(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(ACCESS_DENIED_PAGE);\n             }\n@@ -256,7 +257,7 @@ public ActionForward deleteSelected(ActionMapping mapping, ActionForm form,\n             BasePageModel pageModel = new BasePageModel(\n                     getPingTargetDeleteOKTitle(), req, res, mapping);\n             req.setAttribute(\"model\",pageModel);            \n-            if (!hasRequiredRights(rreq))\n+            if (!hasRequiredRights(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(ACCESS_DENIED_PAGE);\n             }\n@@ -290,7 +291,7 @@ public ActionForward deleteConfirmed(ActionMapping mapping, ActionForm form,\n         PingTargetManager pingTargetMgr = RollerFactory.getRoller().getPingTargetManager();\n         try\n         {\n-            if (!hasRequiredRights(rreq))\n+            if (!hasRequiredRights(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(ACCESS_DENIED_PAGE);\n             }\n@@ -311,7 +312,7 @@ public ActionForward deleteConfirmed(ActionMapping mapping, ActionForm form,\n     }\n \n     // TODO: Consider unifying with other RollerRequest methods\n-    /*\n+    /**\n      * Helper to select the ping target specified by the id in the request.\n      * @param rreq\n      * @return the ping target specified by the id in the request\n@@ -334,19 +335,22 @@ private PingTargetData select(RollerRequest rreq) throws RollerException\n         return pingTarget;\n     }\n \n-    /*\n+    /**\n      * Private helper to validate a ping target.\n-     * @param rreq       the request\n+     * @param rreq the request\n      * @param pingTarget the ping target to validate\n-     * @return an <code>ActionMessages</code> object with <code>ActionMessage</code> for each error encountered, empty if no\n-     * errors were encountered.\n+     * @return an <code>ActionMessages</code> object with \n+     *         <code>ActionMessage</code> for each error encountered, \n+     *         empty if no errors were encountered.\n      * @throws RollerException\n      */\n-    private ActionMessages validate(RollerRequest rreq, PingTargetData pingTarget) throws RollerException\n+    private ActionMessages validate(\n+        RollerRequest rreq, PingTargetData pingTarget) throws RollerException\n     {\n         ActionMessages errors = new ActionMessages();\n \n-        PingTargetManager pingTargetMgr = RollerFactory.getRoller().getPingTargetManager();\n+        PingTargetManager pingTargetMgr = \n+                RollerFactory.getRoller().getPingTargetManager();\n         if (!pingTargetMgr.isNameUnique(pingTarget))\n         {\n             errors.add(ActionMessages.GLOBAL_MESSAGE,\n@@ -365,26 +369,33 @@ private ActionMessages validate(RollerRequest rreq, PingTargetData pingTarget) t\n     }\n \n \n-    /*\n-     *  Helper defined by the subclass to determine if user has adequate rights for the action.\n-     *  This and the {@link org.roller.pojos.PingTargetData#canSave()} method determine the access\n-     *  control for the action.\n+    /**\n+     * Helper defined by the subclass to determine if user has adequate \n+     * rights for the action. This and the \n+     * {@link org.roller.pojos.PingTargetData#canSave()} method determine the \n+     * access control for the action.\n      */\n-    protected abstract boolean hasRequiredRights(RollerRequest rreq) throws RollerException;\n+    protected abstract boolean hasRequiredRights(\n+            RollerRequest rreq, WebsiteData website) throws RollerException;\n \n-    /*\n+    /**\n      * Get the logger from the concrete subclass\n      */\n     protected abstract Log getLogger();\n \n-    /*\n-     * Get the ping targets for the view.  This is implemented differently in the concrete subclasses.\n+    /**\n+     * Get the ping targets for the view.  This is implemented differently in \n+     * the concrete subclasses.\n      */\n-    protected abstract List getPingTargets(RollerRequest rreq) throws RollerException;\n+    protected abstract List getPingTargets(RollerRequest rreq) \n+        throws RollerException;\n \n \n-    /*\n-     * Create a new ping target (blank). This is implemented differently in the concrete subclasses.\n+    /**\n+     * Create a new ping target (blank). This is implemented differently in \n+     * the concrete subclasses.\n      */\n-    protected abstract PingTargetData createPingTarget(RollerRequest rreq, PingTargetForm pingTargetForm) throws RollerException;\n+    protected abstract PingTargetData createPingTarget(\n+        RollerRequest rreq, PingTargetForm pingTargetForm) \n+            throws RollerException;\n }",
                "changes": 59,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/src/org/roller/presentation/weblog/actions/BasePingTargetsAction.java"
            },
            {
                "additions": 4,
                "sha": "82929ce829b8ec02ffc81cb6955c7cff3421dbaf",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/src/org/roller/presentation/weblog/actions/CustomPingTargetsAction.java",
                "deletions": 2,
                "filename": "src/org/roller/presentation/weblog/actions/CustomPingTargetsAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/weblog/actions/CustomPingTargetsAction.java?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -24,6 +24,7 @@\n import org.roller.model.PingTargetManager;\n import org.roller.model.RollerFactory;\n import org.roller.pojos.PingTargetData;\n+import org.roller.pojos.WebsiteData;\n import org.roller.presentation.forms.PingTargetForm;\n import org.roller.presentation.RollerRequest;\n import org.roller.presentation.RollerSession;\n@@ -99,10 +100,11 @@ protected PingTargetData createPingTarget(RollerRequest rreq, PingTargetForm pin\n     /*\n      *  Check if the user has editing rights.\n      */\n-    protected boolean hasRequiredRights(RollerRequest rreq) throws RollerException\n+    protected boolean hasRequiredRights(RollerRequest rreq, WebsiteData website) \n+        throws RollerException\n     {\n         RollerSession rses = RollerSession.getRollerSession(rreq.getRequest());\n-        return (rses.isUserAuthorizedToAdmin(rreq.getWebsite()) \n+        return (rses.isUserAuthorizedToAdmin(website)\n             && !PingConfig.getDisallowCustomTargets());\n     }\n ",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/src/org/roller/presentation/weblog/actions/CustomPingTargetsAction.java"
            },
            {
                "additions": 6,
                "sha": "c67eef300fe43465944bff3463c1918ea3611618",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/WEB-INF/classes/ApplicationResources.properties",
                "deletions": 0,
                "filename": "web/WEB-INF/classes/ApplicationResources.properties",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/WEB-INF/classes/ApplicationResources.properties?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -694,6 +694,7 @@ customPingTargets.disAllowedExplanation=The use of custom ping targets has been\n disabled on this site. To get an additional common ping target added, \\\n Please contact an administrator.\n \n+\n pings.title=Configure Automatic Weblog Pings\n pings.subtitle=Setup automatic pings for weblog [<b>{0}</b>]\n pings.explanation=Pings allow you to notify sites that your weblog has changed \\\n@@ -727,7 +728,12 @@ ping.pingProcessingIsSuspended=Ping processing has been suspended temporarily by\n a site administrator.\n pingResult.OK=OK\n \n+\n pingTarget.pingTarget=Ping Target\n+\n+customPingTarget.subtitle=Editing custom ping target in weblog [{0}]\n+commonPingTarget.subtitle=Editing common ping target\n+\n pingTarget.name=Name\n pingTarget.pingUrl=Ping URL\n pingTarget.addNew=Add New",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/WEB-INF/classes/ApplicationResources.properties"
            },
            {
                "additions": 2,
                "sha": "bb493a9bfda06de45a5df1979fcc23a5f45b0626",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CategoryForm.jsp",
                "deletions": 1,
                "filename": "web/weblog/CategoryForm.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/weblog/CategoryForm.jsp?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -3,7 +3,8 @@\n \r\n <p class=\"subtitle\">\r\n <c:if test=\"${state == 'add'}\">\r\n-    <fmt:message key=\"categoryForm.add.subtitle\" /></h3>\r\n+    <fmt:message key=\"categoryForm.add.subtitle\" />\r\n+    \r\n </c:if>\r\n <c:if test=\"${state == 'edit'}\">\r\n     <fmt:message key=\"categoryForm.edit.subtitle\" />\r",
                "changes": 3,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CategoryForm.jsp"
            },
            {
                "additions": 2,
                "sha": "500bc8c71c53e284d6b5b61afa08ebd39a3c6778",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargetDeleteOK.jsp",
                "deletions": 0,
                "filename": "web/weblog/CustomPingTargetDeleteOK.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/weblog/CustomPingTargetDeleteOK.jsp?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -13,6 +13,7 @@\n <tr>\n <td>\n <html:form action=\"/editor/customPingTargets\" method=\"post\">\n+    <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />\n     <html:hidden property=\"method\" value=\"deleteConfirmed\" />\n     <html:hidden property=\"id\" />\n     <div class=\"control\">\n@@ -22,6 +23,7 @@\n </td>\n <td>\n <html:form action=\"/editor/customPingTargets\" method=\"post\">\n+    <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />\n     <!-- Results in returning to the view on common ping targets. -->\n     <div class=\"control\">\n        <input type=\"submit\" value='<fmt:message key=\"pingTarget.cancel\" />' />",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargetDeleteOK.jsp"
            },
            {
                "additions": 7,
                "sha": "f75097288b0fc165ca90fb9aab701e5e509e272d",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargetEdit.jsp",
                "deletions": 1,
                "filename": "web/weblog/CustomPingTargetEdit.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/weblog/CustomPingTargetEdit.jsp?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -8,10 +8,16 @@ function cancel() {\n // -->\n </script> \n \n-<br />\n+<p class=\"subtitle\">\n+<fmt:message key=\"customPingTarget.subtitle\">\n+    <fmt:param value=\"${model.website.handle}\" />\n+</fmt:message>\n+</p>\n+\n <html:form action=\"/editor/customPingTargets\" method=\"post\" focus=\"name\">\n     <html:hidden property=\"method\" value=\"save\" />\n     <html:hidden property=\"id\" />\n+    <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />\n \n     <div class=\"formrow\">\n        <label for=\"name\" class=\"formrow\"><fmt:message key=\"pingTarget.name\" /></label>",
                "changes": 8,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargetEdit.jsp"
            },
            {
                "additions": 9,
                "sha": "8f7f8994d9e605b92db94726f154fa2d407d3a8e",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargets.jsp",
                "deletions": 0,
                "filename": "web/weblog/CustomPingTargets.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/weblog/CustomPingTargets.jsp?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -1,5 +1,9 @@\n <%@ page import=\"org.roller.presentation.RollerRequest\"%>\n <%@ include file=\"/taglibs.jsp\" %>\n+<%\n+BasePageModel pageModel = (BasePageModel)request.getAttribute(\"model\");\n+String websiteHandle = pageModel.getWebsite().getHandle();\n+%>\n \n <p class=\"subtitle\">\n    <fmt:message key=\"customPingTargets.subtitle\" >\n@@ -41,6 +45,8 @@\n                        <roller:linkparam\n                            id=\"<%= RollerRequest.PINGTARGETID_KEY %>\"\n                            name=\"pingTarget\" property=\"id\" />\n+                       <roller:linkparam\n+                           id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                        <roller:linkparam\n     \t                   id=\"method\" value=\"editSelected\" />\n                        <img src='<c:url value=\"/images/Edit16.png\"/>' border=\"0\"\n@@ -53,6 +59,8 @@\n                        <roller:linkparam\n     \t                   id=\"<%= RollerRequest.PINGTARGETID_KEY %>\"\n     \t                   name=\"pingTarget\" property=\"id\" />\n+                       <roller:linkparam\n+                           id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                        <roller:linkparam\n     \t                   id=\"method\" value=\"deleteSelected\" />\n                        <img src='<c:url value=\"/images/Remove16.gif\"/>' border=\"0\"\n@@ -70,6 +78,7 @@\n     <html:form action=\"/editor/customPingTargets\" method=\"post\">\n         <div class=\"control\">\n            <html:hidden property=\"method\" value=\"addNew\" />\n+           <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />           \n            <input type=\"submit\" value='<fmt:message key=\"pingTarget.addNew\"/>' />\n         </div>\n     </html:form>",
                "changes": 9,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/weblog/CustomPingTargets.jsp"
            },
            {
                "additions": 4,
                "sha": "b138c2ec19d2c426c3b91dff3e84c4ac1209b4f5",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/website/CommonPingTargetEdit.jsp",
                "deletions": 1,
                "filename": "web/website/CommonPingTargetEdit.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/CommonPingTargetEdit.jsp?ref=c181f4c2e36e7efed3b34c8295c648fb16b85b2d",
                "patch": "@@ -1,7 +1,10 @@\n <%@ include file=\"/taglibs.jsp\" %>\n \n \n-<br />\n+<p class=\"subtitle\">\n+<fmt:message key=\"commonPingTarget.subtitle\"/>\n+</p>\n+\n <html:form action=\"/admin/commonPingTargets\" method=\"post\" focus=\"name\">\n     <html:hidden property=\"method\" value=\"save\" />\n     <html:hidden property=\"id\" />",
                "changes": 5,
                "blob_url": "https://github.com/apache/roller/blob/c181f4c2e36e7efed3b34c8295c648fb16b85b2d/web/website/CommonPingTargetEdit.jsp"
            }
        ],
        "repo": "roller",
        "message": "NPE fixes in ping pages\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/branches/roller_2.0@264827 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/c181f4c2e36e7efed3b34c8295c648fb16b85b2d"
    },
    {
        "parent": "https://github.com/apache/roller/commit/c419731f72485f8f8aba05a582c5af93bc199b15",
        "bug_id": "roller_15",
        "file": [
            {
                "additions": 37,
                "sha": "30c68d0f9a1e3c272a093bb49d389bbe7953e0ac",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/154d67d4b7692edc9ad685d4e582a0dbde9e91f7/app/src/main/java/org/apache/roller/weblogger/business/search/operations/IndexOperation.java",
                "deletions": 58,
                "filename": "app/src/main/java/org/apache/roller/weblogger/business/search/operations/IndexOperation.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/business/search/operations/IndexOperation.java?ref=154d67d4b7692edc9ad685d4e582a0dbde9e91f7",
                "patch": "@@ -19,14 +19,15 @@\n package org.apache.roller.weblogger.business.search.operations;\n \n import java.io.IOException;\n-import java.util.Iterator;\n import java.util.List;\n \n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n import org.apache.lucene.analysis.miscellaneous.LimitTokenCountAnalyzer;\n import org.apache.lucene.document.Document;\n import org.apache.lucene.document.Field;\n+import org.apache.lucene.document.StringField;\n+import org.apache.lucene.document.TextField;\n import org.apache.lucene.index.IndexWriter;\n import org.apache.lucene.index.IndexWriterConfig;\n import org.apache.roller.weblogger.business.search.FieldConstants;\n@@ -35,7 +36,6 @@\n import org.apache.roller.weblogger.pojos.WeblogCategory;\n import org.apache.roller.weblogger.pojos.WeblogEntry;\n import org.apache.roller.weblogger.pojos.WeblogEntryComment;\n-import org.apache.roller.weblogger.util.Utilities;\n \n /**\n  * This is the base class for all index operation. These operations include:<br>\n@@ -76,14 +76,12 @@ protected Document getDocument(WeblogEntry data) {\n         String commentEmail = \"\";\n         String commentName = \"\";\n         if (indexComments) {\n-            List comments = data.getComments();\n+            List<WeblogEntryComment> comments = data.getComments();\n             if (comments != null) {\n                 StringBuilder commentEmailBld = new StringBuilder();\n                 StringBuilder commentContentBld = new StringBuilder();\n                 StringBuilder commentNameBld = new StringBuilder();\n-                for (Iterator cItr = comments.iterator(); cItr.hasNext();) {\n-                    WeblogEntryComment comment = (WeblogEntryComment) cItr\n-                            .next();\n+                for (WeblogEntryComment comment : comments) {\n                     if (comment.getContent() != null) {\n                         commentContentBld.append(comment.getContent());\n                         commentContentBld.append(\",\");\n@@ -106,73 +104,54 @@ protected Document getDocument(WeblogEntry data) {\n         Document doc = new Document();\n \n         // keyword\n-        doc.add(new Field(FieldConstants.ID, data.getId(), Field.Store.YES,\n-                Field.Index.NOT_ANALYZED));\n+        doc.add(new StringField(FieldConstants.ID, data.getId(), Field.Store.YES));\n \n         // keyword\n-        doc.add(new Field(FieldConstants.WEBSITE_HANDLE, data.getWebsite()\n-                .getHandle(), Field.Store.YES, Field.Index.NOT_ANALYZED));\n+        doc.add(new StringField(FieldConstants.WEBSITE_HANDLE, data.getWebsite()\n+                .getHandle(), Field.Store.YES));\n \n-        // unindexed\n-        doc.add(new Field(FieldConstants.ANCHOR, data.getAnchor(),\n-                Field.Store.YES, Field.Index.NO));\n-\n-        // text\n-        doc.add(new Field(FieldConstants.USERNAME, data.getCreator()\n-                .getUserName(), Field.Store.YES, Field.Index.ANALYZED));\n+        // text, don't index deleted/disabled users of a group blog\n+        if (data.getCreator() != null) {\n+            doc.add(new TextField(FieldConstants.USERNAME, data.getCreator().getUserName(),\n+                    Field.Store.YES));\n+        }\n \n         // text\n-        doc.add(new Field(FieldConstants.TITLE, data.getTitle(),\n-                Field.Store.YES, Field.Index.ANALYZED));\n+        doc.add(new TextField(FieldConstants.TITLE, data.getTitle(),\n+                Field.Store.YES));\n \n-        // text\n-        doc.add(new Field(FieldConstants.LOCALE, data.getLocale(),\n-                Field.Store.YES, Field.Index.ANALYZED));\n+        // keyword\n+        doc.add(new StringField(FieldConstants.LOCALE, data.getLocale(),\n+                Field.Store.YES));\n \n         // index the entry text, but don't store it - moved to end of block\n-        // unstored\n-        doc.add(new Field(FieldConstants.CONTENT, data.getText(),\n-                Field.Store.NO, Field.Index.ANALYZED));\n-\n-        // store an abbreviated version of the entry text, but don't index\n-        // unindexed\n-        doc.add(new Field(FieldConstants.CONTENT_STORED, Utilities\n-                .truncateNicely(Utilities.removeHTML(data.getText()), 240, 260,\n-                        \"...\"), Field.Store.YES, Field.Index.NO));\n+        doc.add(new TextField(FieldConstants.CONTENT, data.getText(),\n+                Field.Store.NO));\n \n         // keyword\n-        doc.add(new Field(FieldConstants.UPDATED, data.getUpdateTime()\n-                .toString(), Field.Store.YES, Field.Index.NOT_ANALYZED));\n+        doc.add(new StringField(FieldConstants.UPDATED, data.getUpdateTime()\n+                .toString(), Field.Store.YES));\n \n         // keyword\n-        doc.add(new Field(FieldConstants.PUBLISHED, data.getPubTime()\n-                .toString(), Field.Store.YES, Field.Index.NOT_ANALYZED));\n-\n-        // index Comments\n-        // unstored\n-        doc.add(new Field(FieldConstants.C_CONTENT, commentContent,\n-                Field.Store.NO, Field.Index.ANALYZED));\n-        // unstored\n-        doc.add(new Field(FieldConstants.C_EMAIL, commentEmail, Field.Store.NO,\n-                Field.Index.ANALYZED));\n-        // unstored\n-        doc.add(new Field(FieldConstants.C_NAME, commentName, Field.Store.NO,\n-                Field.Index.ANALYZED));\n-\n-        // unstored\n-        doc.add(new Field(FieldConstants.CONSTANT, FieldConstants.CONSTANT_V,\n-                Field.Store.NO, Field.Index.ANALYZED));\n+        doc.add(new StringField(FieldConstants.PUBLISHED, data.getPubTime()\n+                .toString(), Field.Store.YES));\n \n         // index Category\n         WeblogCategory categorydata = data.getCategory();\n-        Field category = (categorydata == null)\n-        // unstored\n-        ? new Field(FieldConstants.CATEGORY, \"\", Field.Store.NO,\n-                Field.Index.ANALYZED)\n-        // text\n-                : new Field(FieldConstants.CATEGORY, categorydata.getName(),\n-                        Field.Store.YES, Field.Index.ANALYZED);\n-        doc.add(category);\n+        if (categorydata != null) {\n+            doc.add(new StringField(FieldConstants.CATEGORY, categorydata.getName(),\n+                    Field.Store.YES));\n+        }\n+\n+        // index Comments, unstored\n+        doc.add(new TextField(FieldConstants.C_CONTENT, commentContent,\n+                Field.Store.NO));\n+\n+        // keyword\n+        doc.add(new StringField(FieldConstants.C_EMAIL, commentEmail, Field.Store.YES));\n+\n+        // keyword\n+        doc.add(new StringField(FieldConstants.C_NAME, commentName, Field.Store.YES));\n \n         return doc;\n     }",
                "changes": 95,
                "blob_url": "https://github.com/apache/roller/blob/154d67d4b7692edc9ad685d4e582a0dbde9e91f7/app/src/main/java/org/apache/roller/weblogger/business/search/operations/IndexOperation.java"
            }
        ],
        "repo": "roller",
        "message": "ROL-1929 NPE guard for null blog article creators, updated indexing code to Lucene 4.4 (replaced deprecated methods).\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1517178 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/154d67d4b7692edc9ad685d4e582a0dbde9e91f7"
    },
    {
        "parent": "https://github.com/apache/roller/commit/98f65a8004137fe9c39e4e47842ccafecb500ba5",
        "bug_id": "roller_16",
        "file": [
            {
                "additions": 5,
                "sha": "9dabdd614ae5fff065336bcc23eb498f5d57363b",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/db5694bc8135d2d11f237c5bf2be1f8762c85885/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/model/PageModel.java",
                "deletions": 3,
                "filename": "apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/model/PageModel.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/model/PageModel.java?ref=db5694bc8135d2d11f237c5bf2be1f8762c85885",
                "patch": "@@ -305,9 +305,11 @@ public WeblogEntryCommentForm getCommentForm() {\n      * Get request parameter by name.\n      */\n     public String getRequestParameter(String paramName) {\n-        String[] values = (String[])requestParameters.get(paramName);\n-        if (values != null && values.length > 0) {\n-            return values[0];\n+        if (requestParameters != null) {\n+            String[] values = (String[])requestParameters.get(paramName);\n+            if (values != null && values.length > 0) {\n+                return values[0];\n+            }\n         }\n         return null;\n     }",
                "changes": 8,
                "blob_url": "https://github.com/apache/roller/blob/db5694bc8135d2d11f237c5bf2be1f8762c85885/apps/weblogger/src/java/org/apache/roller/weblogger/ui/rendering/model/PageModel.java"
            }
        ],
        "repo": "roller",
        "message": "Fixes http://opensource.atlassian.com/projects/roller/browse/ROL-1509\n\nNPE in preview, fixed by adding null check around requestParameters reference\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@563482 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/db5694bc8135d2d11f237c5bf2be1f8762c85885"
    },
    {
        "parent": "https://github.com/apache/roller/commit/6bbf6eb5c4d372493d273d12f1b1fdafcc7063ba",
        "bug_id": "roller_17",
        "file": [
            {
                "additions": 4,
                "sha": "c17652f1d18307f781b98f143a8b52df1e7a0607",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/88e82b6c2a4cd7b11267111b36246bad9e967bf7/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/admin/ModifyUser.java",
                "deletions": 1,
                "filename": "apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/admin/ModifyUser.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/admin/ModifyUser.java?ref=88e82b6c2a4cd7b11267111b36246bad9e967bf7",
                "patch": "@@ -69,7 +69,10 @@ public void myPrepare() {\n         if(getUserName() != null) {\n             try {\n                 UserManager mgr = WebloggerFactory.getWeblogger().getUserManager();\n-                setUser(mgr.getUserByUserName(getUserName()));\n+                \n+                // use enabled = 'null' to get both enabled and disabled users\n+                setUser(mgr.getUserByUserName(getUserName(), null));\n+                \n             } catch(Exception e) {\n                 log.error(\"Error looking up user - \"+getUserName(), e);\n             }",
                "changes": 5,
                "blob_url": "https://github.com/apache/roller/blob/88e82b6c2a4cd7b11267111b36246bad9e967bf7/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/admin/ModifyUser.java"
            }
        ],
        "repo": "roller",
        "message": "Fix for ROL-1493  NPE occurs when select to edit a disable user\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@559843 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/88e82b6c2a4cd7b11267111b36246bad9e967bf7"
    },
    {
        "parent": "https://github.com/apache/roller/commit/e92eeee36a7756a86366a398be5ca1a79149ca3e",
        "bug_id": "roller_18",
        "file": [
            {
                "additions": 2,
                "sha": "4e9a63afd4772b1106d9165553a935aa0f4a4ffe",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/1dcc6668677e98ec6c2e85ccb6a4dcc0d6e176d8/apps/weblogger/src/java/org/apache/roller/weblogger/business/themes/WeblogSharedTheme.java",
                "deletions": 2,
                "filename": "apps/weblogger/src/java/org/apache/roller/weblogger/business/themes/WeblogSharedTheme.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/src/java/org/apache/roller/weblogger/business/themes/WeblogSharedTheme.java?ref=1dcc6668677e98ec6c2e85ccb6a4dcc0d6e176d8",
                "patch": "@@ -178,7 +178,7 @@ public ThemeTemplate getTemplateByName(String name) throws WebloggerException {\n         \n         // if name refers to the stylesheet then return result of getStylesheet()\n         ThemeTemplate stylesheet = getStylesheet();\n-        if(name.equals(stylesheet.getName())) {\n+        if(stylesheet != null && name.equals(stylesheet.getName())) {\n             return stylesheet;\n         }\n         \n@@ -209,7 +209,7 @@ public ThemeTemplate getTemplateByLink(String link) throws WebloggerException {\n         \n         // if name refers to the stylesheet then return result of getStylesheet()\n         ThemeTemplate stylesheet = getStylesheet();\n-        if(link.equals(stylesheet.getLink())) {\n+        if(stylesheet != null && link.equals(stylesheet.getLink())) {\n             return stylesheet;\n         }\n         ",
                "changes": 4,
                "blob_url": "https://github.com/apache/roller/blob/1dcc6668677e98ec6c2e85ccb6a4dcc0d6e176d8/apps/weblogger/src/java/org/apache/roller/weblogger/business/themes/WeblogSharedTheme.java"
            }
        ],
        "repo": "roller",
        "message": "fix for ROL-1445, an NPE caused when a theme doesn't have a stylesheet defined.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@546191 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/1dcc6668677e98ec6c2e85ccb6a4dcc0d6e176d8"
    },
    {
        "parent": "https://github.com/apache/roller/commit/d5cc21bbc27400963ddbbae3335bd69931830b87",
        "bug_id": "roller_19",
        "file": [
            {
                "additions": 8,
                "sha": "0da9379ae0afe15fab73e47502dccd9b43aa47cc",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4cae9bd87f593a359c5d3dcfc2cb04e0cdf958f2/src/org/apache/roller/business/search/operations/RebuildWebsiteIndexOperation.java",
                "deletions": 6,
                "filename": "src/org/apache/roller/business/search/operations/RebuildWebsiteIndexOperation.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/business/search/operations/RebuildWebsiteIndexOperation.java?ref=4cae9bd87f593a359c5d3dcfc2cb04e0cdf958f2",
                "patch": "@@ -75,12 +75,14 @@ public void doRun() {\n         // since this operation can be run on a separate thread we must treat\n         // the weblog object passed in as a detached object which is proned to\n         // lazy initialization problems, so requery for the object now\n-        try {\n-            UserManager uMgr = RollerFactory.getRoller().getUserManager();\n-            this.website = uMgr.getWebsite(this.website.getId());\n-        } catch (RollerException ex) {\n-            mLogger.error(\"Error getting website object\", ex);\n-            return;\n+        if(this.website != null) {\n+            try {\n+                UserManager uMgr = RollerFactory.getRoller().getUserManager();\n+                this.website = uMgr.getWebsite(this.website.getId());\n+            } catch (RollerException ex) {\n+                mLogger.error(\"Error getting website object\", ex);\n+                return;\n+            }\n         }\n         \n         IndexReader reader = beginDeleting();",
                "changes": 14,
                "blob_url": "https://github.com/apache/roller/blob/4cae9bd87f593a359c5d3dcfc2cb04e0cdf958f2/src/org/apache/roller/business/search/operations/RebuildWebsiteIndexOperation.java"
            }
        ],
        "repo": "roller",
        "message": "Fixing NPE in case of incosistent startup where this.website is null and we were trying to call this.website.getId().\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@518767 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/4cae9bd87f593a359c5d3dcfc2cb04e0cdf958f2"
    },
    {
        "parent": "https://github.com/apache/roller/commit/8e8e34cbadb7e8580a3de357589c276ed0253050",
        "bug_id": "roller_20",
        "file": [
            {
                "additions": 8,
                "sha": "ebaaf17b778033a392bc3359469dcafb0ffec14b",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/07d72db7a467fb3e3288a74c2c65ae79f98b6c57/src/org/apache/roller/pojos/WeblogEntryData.java",
                "deletions": 1,
                "filename": "src/org/apache/roller/pojos/WeblogEntryData.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/pojos/WeblogEntryData.java?ref=07d72db7a467fb3e3288a74c2c65ae79f98b6c57",
                "patch": "@@ -753,9 +753,16 @@ public boolean getCommentsStillAllowed() {\n         if (getCommentDays() == null || getCommentDays().intValue() == 0) {\n             ret = true;\n         } else {\n+            // we want to use pubtime for calculating when comments expire, but\n+            // if pubtime isn't set (like for drafts) then just use updatetime\n+            Date pubTime = getPubTime();\n+            if(pubTime == null) {\n+                pubTime = getUpdateTime();\n+            }\n+            \n             Calendar expireCal = Calendar.getInstance(\n                     getWebsite().getLocaleInstance());\n-            expireCal.setTime(getPubTime());\n+            expireCal.setTime(pubTime);\n             expireCal.add(Calendar.DATE, getCommentDays().intValue());\n             Date expireDay = expireCal.getTime();\n             Date today = new Date();",
                "changes": 9,
                "blob_url": "https://github.com/apache/roller/blob/07d72db7a467fb3e3288a74c2c65ae79f98b6c57/src/org/apache/roller/pojos/WeblogEntryData.java"
            }
        ],
        "repo": "roller",
        "message": "fix bug in WeblogEntryData.getCommentsStillAllowed() which was causing an NPE if it was called on a draft/pending entry.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@468099 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/07d72db7a467fb3e3288a74c2c65ae79f98b6c57"
    },
    {
        "parent": "https://github.com/apache/roller/commit/cfc330f23a1750f9b38792825b4e622eb39047b8",
        "bug_id": "roller_21",
        "file": [
            {
                "additions": 0,
                "sha": "6b5ac744b47fb7b56aefbe9e7034fedcfb45b62d",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/e7d44fcdd79f3592c1f3962629e1794b681f18cf/src/org/apache/roller/ui/rendering/model/WeblogEntriesPagerImpl.java",
                "deletions": 1,
                "filename": "src/org/apache/roller/ui/rendering/model/WeblogEntriesPagerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/model/WeblogEntriesPagerImpl.java?ref=e7d44fcdd79f3592c1f3962629e1794b681f18cf",
                "patch": "@@ -229,7 +229,6 @@ public String getPrevCollectionName() {\n      */\n     class SingleEntryMode implements WeblogEntriesPager {\n         String nextLink = null;\n-        WeblogEntryData entry = null;\n         WeblogEntryData nextEntry = null;\n         WeblogEntryData prevEntry = null;\n         ",
                "changes": 1,
                "blob_url": "https://github.com/apache/roller/blob/e7d44fcdd79f3592c1f3962629e1794b681f18cf/src/org/apache/roller/ui/rendering/model/WeblogEntriesPagerImpl.java"
            }
        ],
        "repo": "roller",
        "message": "Fixing NPE in pager's single entry mode\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/branches/roller_3.0@422276 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/e7d44fcdd79f3592c1f3962629e1794b681f18cf"
    },
    {
        "parent": "https://github.com/apache/roller/commit/aab8c702ee307bb904a20c030af31ae8e6975887",
        "bug_id": "roller_22",
        "file": [
            {
                "additions": 11,
                "sha": "f9f6493c4bb9a85621c6f62185ac0356273ee48f",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/weblog/actions/PingSetupAction.java",
                "deletions": 9,
                "filename": "src/org/roller/presentation/weblog/actions/PingSetupAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/weblog/actions/PingSetupAction.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -92,7 +92,7 @@ public ActionForward view(ActionMapping mapping, ActionForm form,\n         WebsiteData website = rreq.getWebsite();\n         try\n         {\n-            if (!isAuthorized(rreq))\n+            if (!isAuthorized(rreq, website))\n             {\n                 return mapping.findForward(\"access-denied\");\n             }\n@@ -174,13 +174,13 @@ public ActionForward enableSelected(ActionMapping mapping, ActionForm form,\n     {\n         RollerRequest rreq = RollerRequest.getRollerRequest(req);\n         AutoPingManager autoPingMgr = RollerFactory.getRoller().getAutopingManager();\n+        PingTargetData pingTarget = select(rreq);\n         try\n         {\n-            if (!isAuthorized(rreq))\n+            if (!isAuthorized(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(\"access-denied\");\n             }\n-            PingTargetData pingTarget = select(rreq);\n             AutoPingData autoPing = autoPingMgr.createAutoPing(pingTarget, \n                     rreq.getWebsite());\n             autoPingMgr.storeAutoPing(autoPing);\n@@ -204,13 +204,13 @@ public ActionForward disableSelected(ActionMapping mapping, ActionForm form,\n     {\n         RollerRequest rreq = RollerRequest.getRollerRequest(req);\n         AutoPingManager autoPingMgr = RollerFactory.getRoller().getAutopingManager();\n+        PingTargetData pingTarget = select(rreq);\n         try\n         {\n-            if (!isAuthorized(rreq))\n+            if (!isAuthorized(rreq, rreq.getWebsite()))\n             {\n                 return mapping.findForward(\"access-denied\");\n             }\n-            PingTargetData pingTarget = select(rreq);\n             autoPingMgr.removeAutoPing(pingTarget, rreq.getWebsite());\n             RollerFactory.getRoller().commit();\n         \n@@ -238,7 +238,7 @@ public ActionForward pingSelectedNow(ActionMapping mapping, ActionForm form,\n             WebsiteData website = rreq.getWebsite();\n             try\n             {\n-                if (!isAuthorized(rreq))\n+                if (!isAuthorized(rreq, website))\n                 {\n                     return mapping.findForward(\"access-denied\");\n                 }\n@@ -251,7 +251,8 @@ public ActionForward pingSelectedNow(ActionMapping mapping, ActionForm form,\n                 }\n                 else\n                 {\n-                    WeblogUpdatePinger.PingResult pingResult = WeblogUpdatePinger.sendPing(absoluteUrl, pingTarget, website);\n+                    WeblogUpdatePinger.PingResult pingResult = \n+                        WeblogUpdatePinger.sendPing(absoluteUrl, pingTarget, website);\n                     if (pingResult.isError())\n                     {\n                         if (mLogger.isDebugEnabled()) mLogger.debug(\"Ping Result: \" + pingResult);\n@@ -334,10 +335,11 @@ else if (ex instanceof SocketException)\n         }\n     }\n \n-    private boolean isAuthorized(RollerRequest rreq) throws RollerException\n+    private boolean isAuthorized(RollerRequest rreq, WebsiteData website) \n+        throws RollerException\n     {\n         RollerSession rses = RollerSession.getRollerSession(rreq.getRequest());\n-        return rses.isUserAuthorizedToAdmin(rreq.getWebsite()) \n+        return rses.isUserAuthorizedToAdmin(website) \n             && !PingConfig.getDisablePingUsage();\n     }\n }",
                "changes": 20,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/weblog/actions/PingSetupAction.java"
            },
            {
                "additions": 18,
                "sha": "57cae4e29f19b3dc3b54295c12d53fa45228e243",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/InviteMemberAction.java",
                "deletions": 9,
                "filename": "src/org/roller/presentation/website/actions/InviteMemberAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/website/actions/InviteMemberAction.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -41,7 +41,7 @@\n  * Allows website admin to invite new members to website.\n  * \n  * @struts.action path=\"/editor/inviteMember\" parameter=\"method\" name=\"inviteMemberForm\"\n- * @struts.action-forward name=\"inviteMember.page\"     path=\".InviteMember\"\n+ * @struts.action-forward name=\"inviteMember.page\" path=\".InviteMember\"\n  */\n public class InviteMemberAction extends DispatchAction\n {\n@@ -60,7 +60,7 @@ public ActionForward unspecified(\n         {\n             return edit(mapping, actionForm, request, response);\n         }\n-        return save(mapping, actionForm, request, response);\n+        return send(mapping, actionForm, request, response);\n     }\n     \n     /** If method param is not specified, use HTTP verb to pick method to call */\n@@ -81,13 +81,18 @@ public ActionForward edit(\n         HttpServletResponse response)\n         throws IOException, ServletException\n     {\n-        ActionForward forward = mapping.findForward(\"inviteMember.page\");        \n-        request.setAttribute(\"model\", new BasePageModel(\n-            \"inviteMember.title\", request, response, mapping));\n+        ActionForward forward = mapping.findForward(\"inviteMember.page\"); \n+        \n+        BasePageModel pageModel = new BasePageModel(\n+            \"inviteMember.title\", request, response, mapping);\n+        request.setAttribute(\"model\", pageModel);\n+        \n+        InviteMemberForm form = (InviteMemberForm)actionForm;\n+        form.setWebsiteId(pageModel.getWebsite().getId());\n         return forward; \n     }\n     \n-    public ActionForward save(\n+    public ActionForward send(\n             ActionMapping       mapping,\n             ActionForm          actionForm,\n             HttpServletRequest  request,\n@@ -101,9 +106,6 @@ public ActionForward save(\n         UserManager umgr = RollerFactory.getRoller().getUserManager();\n         UserData user = umgr.getUser(form.getUserName());\n         \n-        request.setAttribute(\"model\", new BasePageModel(\n-            \"inviteMember.title\", request, response, mapping));\n-\n         if (user == null)\n         {\n             errors.add(ActionErrors.GLOBAL_ERROR, \n@@ -118,11 +120,15 @@ public ActionForward save(\n             {\n                 errors.add(ActionErrors.GLOBAL_ERROR, \n                     new ActionError(\"inviteMember.error.userAlreadyInvited\"));\n+                request.setAttribute(\"model\", new BasePageModel(\n+                    \"inviteMember.title\", request, response, mapping));\n             }\n             else if (perms != null)\n             {\n                 errors.add(ActionErrors.GLOBAL_ERROR, \n                     new ActionError(\"inviteMember.error.userAlreadyMember\"));\n+                request.setAttribute(\"model\", new BasePageModel(\n+                    \"inviteMember.title\", request, response, mapping));\n             }\n             else\n             {\n@@ -141,6 +147,9 @@ else if (perms != null)\n                 msgs.add(ActionMessages.GLOBAL_MESSAGE, \n                     new ActionMessage(\"inviteMember.userInvited\"));\n                 \n+                request.setAttribute(\"model\", new BasePageModel(\n+                    \"inviteMemberDone.title\", request, response, mapping));\n+                \n                 forward = mapping.findForward(\"memberPermissions\");                \n             }\n         }",
                "changes": 27,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/InviteMemberAction.java"
            },
            {
                "additions": 20,
                "sha": "cab525950fe8a34f24cd015ef551e168569f32e5",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/MemberPermissionsAction.java",
                "deletions": 2,
                "filename": "src/org/roller/presentation/website/actions/MemberPermissionsAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/website/actions/MemberPermissionsAction.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -26,6 +26,7 @@\n import org.roller.presentation.BasePageModel;\n import org.roller.presentation.RollerRequest;\n import org.roller.presentation.RollerSession;\n+import org.roller.presentation.website.formbeans.MemberPermissionsForm;\n \n /**\n  * Allows website admin to change website member permissions.\n@@ -53,6 +54,17 @@ public ActionForward unspecified(\n         return save(mapping, actionForm, request, response);\n     }\n     \n+    /** Called after invite user action posted */\n+    public ActionForward send(\n+            ActionMapping       mapping,\n+            ActionForm          actionForm,\n+            HttpServletRequest  request,\n+            HttpServletResponse response)\n+            throws Exception\n+    {\n+        return edit(mapping, actionForm, request, response);\n+    }\n+    \n     public ActionForward cancel(\n             ActionMapping       mapping,\n             ActionForm          actionForm,\n@@ -70,8 +82,12 @@ public ActionForward edit(\n             HttpServletResponse response)\n             throws Exception\n     {\n-        request.setAttribute(\"model\", \n-                new MemberPermissionsPageModel(request, response, mapping));\n+        MemberPermissionsPageModel pageModel = \n+           new MemberPermissionsPageModel(request, response, mapping);\n+        request.setAttribute(\"model\", pageModel);\n+        \n+        MemberPermissionsForm form = (MemberPermissionsForm)actionForm;\n+        form.setWebsiteId(pageModel.getWebsite().getId());\n         ActionForward forward = mapping.findForward(\"memberPermissions.page\");\n         return forward;\n     }\n@@ -85,8 +101,10 @@ public ActionForward save(\n     {\n         ActionErrors errors = new ActionErrors();\n         ActionMessages msgs = new ActionMessages();\n+        \n         MemberPermissionsPageModel model = \n             new MemberPermissionsPageModel(request, response, mapping);\n+        \n         Iterator iter = model.getPermissions().iterator();\n         int removed = 0;\n         int changed = 0;",
                "changes": 22,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/MemberPermissionsAction.java"
            },
            {
                "additions": 44,
                "sha": "e9a74a467303b8528751dabe9ed4ba5c244f30e3",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/WeblogTemplateFormAction.java",
                "deletions": 39,
                "filename": "src/org/roller/presentation/website/actions/WeblogTemplateFormAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/website/actions/WeblogTemplateFormAction.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -69,7 +69,7 @@ public ActionForward add(\n                 WeblogTemplateForm form = (WeblogTemplateForm)actionForm;\n                 WeblogTemplate data = new WeblogTemplate();\n                 form.copyTo(data, request.getLocale());\n-                data.setWebsite( website );\n+                data.setWebsite(website);\n                 data.setLastModified( new java.util.Date() );\n                 data.setDescription(\"\");\n                 data.setContents(\"\");\n@@ -90,7 +90,7 @@ public ActionForward add(\n                     \n                 actionForm.reset(mapping,request);                \n                 \n-                addModelObjects(request, response, mapping);\n+                addModelObjects(request, response, mapping, website);\n             }\n             else\n             {\n@@ -115,22 +115,25 @@ public ActionForward edit(\n     {\n         ActionForward forward = mapping.findForward(\"editPage.page\");\n         try\n-        {\n-            request.setAttribute(\"model\", new BasePageModel(\n-                \"pageForm.title\", request, response, mapping));   \n+        {            \n             RollerRequest rreq = RollerRequest.getRollerRequest(request);\n-            RollerSession rses = RollerSession.getRollerSession(request);\n-            WebsiteData website = rreq.getWebsite();\n-            if ( rses.isUserAuthorizedToAdmin(website) )\n+            WeblogTemplate pd = (WeblogTemplate)rreq.getPage();\n+            \n+            RollerSession rses = RollerSession.getRollerSession(request);            \n+            if ( rses.isUserAuthorizedToAdmin(pd.getWebsite()) )\n             {\n+                BasePageModel pageModel = new BasePageModel(\n+                    \"pageForm.title\", request, response, mapping);\n+                pageModel.setWebsite(pd.getWebsite());\n+                request.setAttribute(\"model\", pageModel); \n+                \n                 UserData ud = rses.getAuthenticatedUser();\n-                WeblogTemplate pd = (WeblogTemplate) rreq.getPage();\n                 WeblogTemplateForm pf = (WeblogTemplateForm)actionForm;\n                 pf.copyFrom(pd, request.getLocale());\n \n                 PageCacheFilter.removeFromCache( request, pd.getWebsite() );\n                 \n-                addModelObjects(request, response, mapping);\n+                addModelObjects(request, response, mapping, pd.getWebsite());\n             }\n             else\n             {\n@@ -163,7 +166,7 @@ public ActionForward editPages(\n             WebsiteData website = rreq.getWebsite();\n             if ( rses.isUserAuthorizedToAdmin(website) )\n             {\n-                addModelObjects(request, response, mapping);\n+                addModelObjects(request, response, mapping, website);\n             }\n             else\n             {\n@@ -191,24 +194,22 @@ public ActionForward remove(\n             \"pagesForm.title\", request, response, mapping));\n         try\n         {\n-            RollerRequest rreq = RollerRequest.getRollerRequest(request);\n-            RollerSession rses = RollerSession.getRollerSession(request);\n-            WebsiteData website = rreq.getWebsite();\n+            UserManager mgr = RollerFactory.getRoller().getUserManager();\n+            WeblogTemplateForm form = (WeblogTemplateForm)actionForm;\n+            WeblogTemplate template = mgr.retrievePage(form.getId());\n+            WebsiteData website = template.getWebsite();\n+            \n+            RollerSession rses = RollerSession.getRollerSession(request);          \n             if ( rses.isUserAuthorizedToAdmin(website) )\n             {\n-                WeblogTemplateForm form = (WeblogTemplateForm)actionForm;\n-                UserManager mgr = RollerFactory.getRoller().getUserManager();\n-                \n-                // fetch template to be deleted (we'll need its website)\n-                WeblogTemplate template = mgr.retrievePage(form.getId());\n-                \n                 mgr.removePageSafely(template.getId());\n                 RollerFactory.getRoller().commit();\n \n                 UserData user = rses.getAuthenticatedUser();\n                 PageCacheFilter.removeFromCache(request, template.getWebsite());\n                     \n-                addModelObjects(request, response, mapping);\n+                addModelObjects(\n+                        request, response, mapping, template.getWebsite());\n                 actionForm.reset(mapping, request);\n             }\n             else\n@@ -232,6 +233,7 @@ public ActionForward remove(\n     }\n \n     //-----------------------------------------------------------------------\n+    /** Send user to remove confirmation page */\n     public ActionForward removeOk(\n         ActionMapping       mapping,\n         ActionForm          actionForm,\n@@ -246,10 +248,10 @@ public ActionForward removeOk(\n         {\n             RollerSession rses = RollerSession.getRollerSession(request);\n             RollerRequest rreq = RollerRequest.getRollerRequest(request);\n-            WebsiteData website = rreq.getWebsite();\n+            WeblogTemplate cd = (WeblogTemplate) rreq.getPage();\n+            WebsiteData website = cd.getWebsite();\n             if ( rses.isUserAuthorizedToAdmin(website) )\n             {\n-                WeblogTemplate cd = (WeblogTemplate) rreq.getPage();\n                 WeblogTemplateForm pf = (WeblogTemplateForm)actionForm;\n                 pf.copyFrom(cd, request.getLocale());\n \n@@ -280,20 +282,17 @@ public ActionForward update(\n         ActionForward forward = mapping.findForward(\"editPage.page\");\n         try\n         {\n-            RollerSession rses = RollerSession.getRollerSession(request);\n             RollerRequest rreq = RollerRequest.getRollerRequest(request);\n-            request.setAttribute(\"model\", new BasePageModel(\n-                \"pageForm.title\", request, response, mapping));\n-            WebsiteData website = rreq.getWebsite();\n-            if ( rses.isUserAuthorizedToAdmin(website) )\n+            WeblogTemplateForm form = (WeblogTemplateForm)actionForm;\n+            UserManager mgr = RollerFactory.getRoller().getUserManager();\n+            WeblogTemplate data = mgr.retrievePage(form.getId());\n+            WebsiteData website = data.getWebsite();\n+            \n+            RollerSession rses = RollerSession.getRollerSession(request);\n+            if (rses.isUserAuthorizedToAdmin(website))\n             {\n-                WeblogTemplateForm form = (WeblogTemplateForm)actionForm;\n-                UserManager mgr = RollerFactory.getRoller().getUserManager();\n-                WeblogTemplate data = mgr.retrievePage(form.getId());\n-                data.save(); // should through exception if no save permission\n                 form.copyTo(data, request.getLocale());\n                 data.setLastModified( new java.util.Date() );\n-                data.setWebsite(mgr.retrieveWebsite(form.getWebsite().getId()));\n \n                 validateLink( data );\n \n@@ -311,6 +310,11 @@ public ActionForward update(\n \n                 UserData user = rses.getAuthenticatedUser();\n                 PageCacheFilter.removeFromCache(request, data.getWebsite());\n+                \n+                BasePageModel pageModel = new BasePageModel(\n+                    \"pageForm.title\", request, response, mapping);\n+                pageModel.setWebsite(website);\n+                request.setAttribute(\"model\", pageModel);\n             }\n             else\n             {\n@@ -374,29 +378,30 @@ public ActionForward cancel(\n         throws IOException, ServletException\n     {\n         request.setAttribute(\"model\", new BasePageModel(\n-                \"pagesForm.title\", request, response, mapping));\n+            \"pagesForm.title\", request, response, mapping));\n         return (mapping.findForward(\"editPages\"));\n     }\n     \n     //-----------------------------------------------------------------------\n     private void addModelObjects( \n         HttpServletRequest  request,\n         HttpServletResponse response,\n-        ActionMapping mapping)\n+        ActionMapping mapping, \n+        WebsiteData website)\n     throws RollerException \n     {             \n         UserManager mgr = RollerFactory.getRoller().getUserManager();        \n         RollerSession rses = RollerSession.getRollerSession(request);\n         RollerRequest rreq = RollerRequest.getRollerRequest(request);\n                 \n         UserData user = rses.getAuthenticatedUser();\n-        request.setAttribute(\"user\",user);\n+        request.setAttribute(\"user\", user);\n \n         WebsiteData wd = rreq.getWebsite();\n-        request.setAttribute(\"website\", wd);\n+        request.setAttribute(\"website\", website);\n \n-        List pages = mgr.getPages(wd);\n-        request.setAttribute(\"pages\",pages);\n+        List pages = mgr.getPages(website);\n+        request.setAttribute(\"pages\", pages);\n     }\n }\n ",
                "changes": 83,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/WeblogTemplateFormAction.java"
            },
            {
                "additions": 5,
                "sha": "4cf09214de49b6f1d8c1f9a9cfe3faf4b1e48526",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/WebsiteFormAction.java",
                "deletions": 0,
                "filename": "src/org/roller/presentation/website/actions/WebsiteFormAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/website/actions/WebsiteFormAction.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -137,7 +137,12 @@ public ActionForward update(\n             WebsiteFormEx form = (WebsiteFormEx)actionForm;\n             WeblogManager wmgr = RollerFactory.getRoller().getWeblogManager();\n             UserManager umgr = RollerFactory.getRoller().getUserManager();\n+            \n             WebsiteData wd = umgr.retrieveWebsite(form.getId());\n+            \n+            // Set website in request, so subsequent action gets it\n+            RollerRequest.getRollerRequest(request).setWebsite(wd);\n+            \n             RollerSession rollerSession = RollerSession.getRollerSession(request);\n             if ( rollerSession.isUserAuthorizedToAdmin(wd))\n             {",
                "changes": 5,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/actions/WebsiteFormAction.java"
            },
            {
                "additions": 12,
                "sha": "4415b690d30b2f4ad6f171bf24a947ad9722bc24",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/formbeans/InviteMemberForm.java",
                "deletions": 0,
                "filename": "src/org/roller/presentation/website/formbeans/InviteMemberForm.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/roller/presentation/website/formbeans/InviteMemberForm.java?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -9,6 +9,8 @@\n public class InviteMemberForm extends ActionForm\n {\n     private String userName;\n+    private String websiteId;\n+    \n     public String getUserName()\n     {\n         return userName;\n@@ -17,4 +19,14 @@ public void setUserName(String userName)\n     {\n         this.userName = userName;\n     }\n+\n+    public String getWebsiteId() \n+    {\n+        return websiteId;\n+    }\n+\n+    public void setWebsiteId(String websiteId) \n+    {\n+        this.websiteId = websiteId;\n+    }\n }",
                "changes": 12,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/src/org/roller/presentation/website/formbeans/InviteMemberForm.java"
            },
            {
                "additions": 2,
                "sha": "0541ca0452161b49e4705d741e689a29c25b9231",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/WEB-INF/classes/ApplicationResources.properties",
                "deletions": 1,
                "filename": "web/WEB-INF/classes/ApplicationResources.properties",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/WEB-INF/classes/ApplicationResources.properties?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -448,6 +448,7 @@ inviteMember.error.userAlreadyMember=User already a member of this weblog\n inviteMemberDone.title=Invitation Sent\n inviteMemberDone.message=User [{0}] has been invited to join this weblog\n inviteMemberDone.inviteAnother=Invite another\n+inviteMember.userInvited=User successfully invited\n \n inviteMember.notificationSubject=Roller: invitation to join weblog \"{0}\" ({1})\n inviteMember.notificationContent=You have been invited to join weblog \"{0}\" ({1}). \\\n@@ -1347,7 +1348,7 @@ yourProfile.button.save=Save\n # ---------------------------------------------------------------- Your Weblogs\n \n yourWebsites.title=Main Menu\n-yourWebsites.subtitle=Welcome to Roller. Use this main menu page to\\\n+yourWebsites.subtitle=Welcome to Roller. Use this main menu page to \\\n manage your weblogs, your user profile and (if you have admin permissions) \\\n administer the blog server.\n ",
                "changes": 3,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/WEB-INF/classes/ApplicationResources.properties"
            },
            {
                "additions": 39,
                "sha": "b3e8f07df07947fffb54d3fa0d4b34af3c82129f",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/taglibs.jsp",
                "deletions": 25,
                "filename": "web/taglibs.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/taglibs.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -1,26 +1,40 @@\n-<%@ page language=\"java\" errorPage=\"/error.jsp\" contentType=\"text/html; charset=UTF-8\" %><%@ \n-taglib uri=\"http://java.sun.com/jstl/core\"   prefix=\"c\" %><%@ \n-taglib uri=\"http://java.sun.com/jstl/fmt\"    prefix=\"fmt\" %><%@ \n-taglib uri=\"http://struts.apache.org/tags-bean\"  prefix=\"bean\" %><%@ \n-taglib uri=\"http://struts.apache.org/tags-html\"  prefix=\"html\" %><%@ \n-taglib uri=\"http://struts.apache.org/tags-logic\" prefix=\"logic\" %><%@ \n-taglib uri=\"http://struts.apache.org/tags-tiles\" prefix=\"tiles\" %><%@ \n-taglib uri=\"http://jakarta.apache.org/taglibs/string-1.0.1\" prefix=\"str\" %><%@ \n-taglib uri=\"http://www.rollerweblogger.org/tags\" prefix=\"roller\" %><%@ \n-page import=\"org.roller.model.Roller\" %><%@ \n-page import=\"org.roller.model.RollerFactory\" %><%@ \n-page import=\"org.roller.pojos.UserData\" %><%@ \n-page import=\"org.roller.pojos.WebsiteData\" %><%@ \n-page import=\"org.roller.pojos.RollerConfigData\" %><%@ \n-page import=\"org.roller.presentation.RollerContext\" %><%@ \n-page import=\"org.roller.presentation.RollerSession\" %><%@ \n-page import=\"org.roller.config.RollerConfig\" %><%@ \n-page import=\"org.roller.presentation.RollerRequest\" %><%@ \n-page import=\"org.roller.config.RollerRuntimeConfig\" %><%@ \n-page import=\"org.roller.config.RollerConfig\" %><%@ \n-page import=\"org.roller.presentation.LanguageUtil\" %><%@ \n-page import=\"javax.servlet.jsp.jstl.core.Config\" %><%   \n+<%@ page language=\"java\" errorPage=\"/error.jsp\" contentType=\"text/html; charset=UTF-8\" %>\n+\n+<%@ taglib uri=\"http://java.sun.com/jstl/core\"       prefix=\"c\" %>\n+<%@ taglib uri=\"http://java.sun.com/jstl/fmt\"        prefix=\"fmt\" %>\n+<%@ taglib uri=\"http://struts.apache.org/tags-bean\"  prefix=\"bean\" %>\n+<%@ taglib uri=\"http://struts.apache.org/tags-html\"  prefix=\"html\" %>\n+<%@ taglib uri=\"http://struts.apache.org/tags-logic\" prefix=\"logic\" %>\n+<%@ taglib uri=\"http://struts.apache.org/tags-tiles\" prefix=\"tiles\" %>\n+<%@ taglib uri=\"http://jakarta.apache.org/taglibs/string-1.0.1\" prefix=\"str\" %>\n+\n+<%@ taglib uri=\"http://www.rollerweblogger.org/tags\" prefix=\"roller\" %>\n+\n+<%@ page import=\"javax.servlet.jsp.jstl.core.Config\" %>\n+\n+<%@ page import=\"org.roller.model.Roller\" %>\n+<%@ page import=\"org.roller.model.RollerFactory\" %>\n+\n+<%@ page import=\"org.roller.pojos.UserData\" %>\n+<%@ page import=\"org.roller.pojos.WebsiteData\" %>\n+<%@ page import=\"org.roller.pojos.RollerConfigData\" %>\n+\n+<%@ page import=\"org.roller.config.RollerConfig\" %>\n+<%@ page import=\"org.roller.config.RollerRuntimeConfig\" %>\n+<%@ page import=\"org.roller.config.RollerConfig\" %>\n+\n+<%@ page import=\"org.roller.presentation.RollerRequest\" %>\n+<%@ page import=\"org.roller.presentation.BasePageModel\" %>\n+<%@ page import=\"org.roller.presentation.RollerContext\" %>\n+<%@ page import=\"org.roller.presentation.RollerSession\" %>\n+<%@ page import=\"org.roller.presentation.LanguageUtil\" %>\n+\n+<%   \n // fmt:setLocale doesn't accept an expression, hence this hack\n-Config.set(pageContext, Config.FMT_LOCALE, LanguageUtil.getViewLocale(request), pageContext.PAGE_SCOPE); \n-%><fmt:setBundle basename=\"ApplicationResources\" /><%-- \n-Set all pages that include this page to use XHTML --%><html:xhtml />\n\\ No newline at end of file\n+Config.set(pageContext, Config.FMT_LOCALE, \n+        LanguageUtil.getViewLocale(request), pageContext.PAGE_SCOPE); \n+%>\n+<fmt:setBundle basename=\"ApplicationResources\" />\n+\n+<%-- Set Struts tags to use XHTML --%>\n+<html:xhtml />\n\\ No newline at end of file",
                "changes": 64,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/taglibs.jsp"
            },
            {
                "additions": 8,
                "sha": "39600989bbdee283d6655386336194e7761c404f",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/theme/messages.jsp",
                "deletions": 9,
                "filename": "web/theme/messages.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/theme/messages.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -13,15 +13,6 @@ function dirty() {\n -->\r\n </script>\r\n \r\n-<%-- Error Messages --%>\r\n-<logic:messagesPresent>\r\n-    <div id=\"errors\" class=\"errors\">\r\n-        <html:messages id=\"error\">\r\n-            <c:out value=\"${error}\" /><br />\r\n-        </html:messages>\r\n-    </div>\r\n-</logic:messagesPresent>\r\n-\r\n <%-- Success Messages --%>\r\n <logic:messagesPresent message=\"true\">\r\n     <div id=\"messages\" class=\"messages\">\r\n@@ -31,3 +22,11 @@ function dirty() {\n     </div>\r\n </logic:messagesPresent>\r\n \r\n+<%-- Error Messages --%>\r\n+<logic:messagesPresent>\r\n+    <div id=\"errors\" class=\"errors\">\r\n+        <html:messages id=\"error\">\r\n+            <c:out value=\"${error}\" /><br />\r\n+        </html:messages>\r\n+    </div>\r\n+</logic:messagesPresent>\r",
                "changes": 17,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/theme/messages.jsp"
            },
            {
                "additions": 16,
                "sha": "043e52a690ef11a33e51b21dc3a9c91ad2d297c9",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/weblog/Pings.jsp",
                "deletions": 0,
                "filename": "web/weblog/Pings.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/weblog/Pings.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -1,5 +1,9 @@\n <%@ page import=\"org.roller.presentation.RollerRequest\"%>\n <%@ include file=\"/taglibs.jsp\" %>\n+<%\n+BasePageModel pageModel = (BasePageModel)request.getAttribute(\"model\");\n+String websiteHandle = pageModel.getWebsite().getHandle();\n+%>\n \n <p class=\"subtitle\">\n    <fmt:message key=\"pings.subtitle\" >\n@@ -59,6 +63,8 @@\n                      <roller:linkparam\n                         id=\"<%= RollerRequest.PINGTARGETID_KEY %>\"\n                         name=\"pingTarget\" property=\"id\" />\n+                     <roller:linkparam\n+                       id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                      <roller:linkparam\n                        id=\"method\" value=\"disableSelected\" />\n                      <fmt:message key=\"pingTarget.disable\"/>\n@@ -69,6 +75,8 @@\n                      <roller:linkparam\n                         id=\"<%= RollerRequest.PINGTARGETID_KEY %>\"\n                         name=\"pingTarget\" property=\"id\" />\n+                     <roller:linkparam\n+                       id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                      <roller:linkparam\n                        id=\"method\" value=\"enableSelected\" />\n                      <fmt:message key=\"pingTarget.enable\"/>\n@@ -82,6 +90,8 @@\n                      <roller:linkparam\n                         id=\"<%= RollerRequest.PINGTARGETID_KEY %>\"\n                         name=\"pingTarget\" property=\"id\" />\n+                     <roller:linkparam\n+                       id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                      <roller:linkparam\n                        id=\"method\" value=\"pingSelectedNow\" />\n                     <fmt:message key=\"pingTarget.sendPingNow\"/>\n@@ -152,6 +162,8 @@\n                              name=\"pingTarget\" property=\"id\" />\n                            <roller:linkparam\n                              id=\"method\" value=\"disableSelected\" />\n+                           <roller:linkparam\n+                             id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                            <fmt:message key=\"pingTarget.disable\"/>\n                        </roller:link>\n                     </c:when>\n@@ -162,6 +174,8 @@\n                               name=\"pingTarget\" property=\"id\" />\n                            <roller:linkparam\n                              id=\"method\" value=\"enableSelected\" />\n+                           <roller:linkparam\n+                             id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                            <fmt:message key=\"pingTarget.enable\"/>\n                        </roller:link>\n                     </c:otherwise>\n@@ -175,6 +189,8 @@\n                             name=\"pingTarget\" property=\"id\" />\n                          <roller:linkparam\n                             id=\"method\" value=\"pingSelectedNow\" />\n+                           <roller:linkparam\n+                             id=\"weblog\" value=\"<%= websiteHandle %>\" />\n                          <fmt:message key=\"pingTarget.sendPingNow\"/>\n                      </roller:link>\n                   </td>",
                "changes": 16,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/weblog/Pings.jsp"
            },
            {
                "additions": 0,
                "sha": "2379c5c71d8a6e65e181a33cc3f4cd5e74a34e4e",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/CreateWebsite.jsp",
                "deletions": 2,
                "filename": "web/website/CreateWebsite.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/CreateWebsite.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -12,8 +12,6 @@ function cancel() {\n -->\n </script>\n \n-<h1><fmt:message key=\"createWebsite.title\" /></h1>\n-\n <p class=\"subtitle\"><fmt:message key=\"createWebsite.prompt\" /></p>\n \n <br /> ",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/CreateWebsite.jsp"
            },
            {
                "additions": 2,
                "sha": "dd9cd7e7a4bd4ce14386ed8e0722baf17db235ca",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/InviteMember.jsp",
                "deletions": 1,
                "filename": "web/website/InviteMember.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/InviteMember.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -13,7 +13,8 @@ function cancel() {\n <p class=\"subtitle\"><fmt:message key=\"inviteMember.description\" /></p>\n \n <html:form action=\"/editor/inviteMember\" method=\"post\" focus=\"userName\">\n-    <input name=\"method\" type=\"hidden\" value=\"save\" />\n+    <html:hidden property=\"websiteId\" />\n+    <input name=\"method\" type=\"hidden\" value=\"send\" />\n     \n     <div class=\"formrow\">\n        <label for=\"userName\" class=\"formrow\" />",
                "changes": 3,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/InviteMember.jsp"
            },
            {
                "additions": 6,
                "sha": "a34d7a4530a011614648850df79ba027f5e47373",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/MemberPermissionsSidebar.jsp",
                "deletions": 3,
                "filename": "web/website/MemberPermissionsSidebar.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/MemberPermissionsSidebar.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -8,9 +8,12 @@\n             <h3><fmt:message key=\"mainPage.actions\" /></h3>\n             <hr />\n             <img src='<c:url value=\"/images/ComposeMail16.gif\"/>' alt=\"mail-icon\" align=\"bottom\" />\n-            <roller:link page=\"/editor/inviteMember.do\">\n-               <fmt:message key=\"memberPermissions.inviteMember\" />\n-            </roller:link>\n+            <c:url value=\"/editor/inviteMember.do\" var=\"inviteUrl\">\n+               <c:param name=\"weblog\" value=\"${model.website.handle}\" />\n+            </c:url>\n+            <a href='<c:out value=\"${inviteUrl}\" />'>\n+                <fmt:message key=\"memberPermissions.inviteMember\" />\n+            </a>\n             <br />\n             <fmt:message key=\"memberPermissions.whyInvite\" />       \n \t\t\t<br />",
                "changes": 9,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/MemberPermissionsSidebar.jsp"
            },
            {
                "additions": 0,
                "sha": "10326773f944343a6c98a6081e4abf352d113cbb",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/YourProfile.jsp",
                "deletions": 1,
                "filename": "web/website/YourProfile.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/YourProfile.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -8,7 +8,6 @@ function cancel() {\n -->\n </script>\n \n-<h1><fmt:message key=\"yourProfile.title\" /></h1>\n <p class=\"subtitle\"><fmt:message key=\"yourProfile.description\" /></p>\n \n <html:form action=\"/editor/yourProfile\" method=\"post\" focus=\"fullName\">",
                "changes": 1,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/YourProfile.jsp"
            },
            {
                "additions": 5,
                "sha": "1f2ceeeaa44e755f8d63049cf6ff965f22e5a50e",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/edit-page.jsp",
                "deletions": 5,
                "filename": "web/website/edit-page.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/edit-page.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -37,16 +37,16 @@ function cancel() {\n             <html:textarea property=\"description\" rows=\"3\" cols=\"50\"/>\r\n             </td>\r\n         </tr>\r\n-        <tr>\r\n-            <td><fmt:message key=\"pageForm.template\" /><br />\r\n-            <html:textarea property=\"contents\" cols=\"80\" rows=\"30\" style=\"width: 100%\" />\r\n-            </td>\r\n-        </tr>\r\n+\r\n     </table>\r\n \r\n+    <fmt:message key=\"pageForm.template\" /><br />\r\n+    <html:textarea property=\"contents\" cols=\"80\" rows=\"30\" style=\"width: 100%\" />\r\n+            \r\n     <html:hidden property=\"id\"/>\r\n     <html:hidden property=\"name\"/>\r\n     <input type=\"hidden\" name=\"method\" value=\"update\" />\r\n+    <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />\r\n \r\n     <br />\r\n     <input type=\"submit\" value='<fmt:message key=\"pageForm.save\" />' /></input>\r",
                "changes": 10,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/edit-page.jsp"
            },
            {
                "additions": 1,
                "sha": "58bc0da07bf3d3cb530cd535899cbd508a8f6035",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/edit-pages-sidebar.jsp",
                "deletions": 2,
                "filename": "web/website/edit-pages-sidebar.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/web/website/edit-pages-sidebar.jsp?ref=4354febbbdb9640e54a2313f88482a00a40edeb3",
                "patch": "@@ -13,8 +13,7 @@\n                 <fmt:message key=\"pagesForm.name\"/>: <input type=\"text\" name=\"name\" size=\"30\" />\r\n \r\n                 <input type=\"submit\" value='<fmt:message key=\"pagesForm.add\" />' />\r\n-                <input type=\"hidden\" property=\"template\" \r\n-                    value=\"<html><body><fmt:message key=\"pagesForm.emptyPage\" /></body></html>\" />\r\n+                <input type=\"hidden\" name=\"weblog\" value='<c:out value=\"${model.website.handle}\" />' />\r\n                 <html:hidden property=\"method\" value=\"add\"/>\r\n \r\n              </html:form>\r",
                "changes": 3,
                "blob_url": "https://github.com/apache/roller/blob/4354febbbdb9640e54a2313f88482a00a40edeb3/web/website/edit-pages-sidebar.jsp"
            }
        ],
        "repo": "roller",
        "message": "NPE fixes in template pages, ping pages and website settings\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/branches/roller_2.0@264823 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/4354febbbdb9640e54a2313f88482a00a40edeb3"
    },
    {
        "parent": "https://github.com/apache/roller/commit/e779f6a86c62e3d7749c5eeb4e37b1bc79851a85",
        "bug_id": "roller_23",
        "file": [
            {
                "additions": 130,
                "sha": "8507c60d4fb60fb226dab9b33d5a2b928ea23747",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/f34257b6e57401493dc8fdadce8c86b04029545b/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/TemplatesRemove.java",
                "deletions": 130,
                "filename": "app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/TemplatesRemove.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/TemplatesRemove.java?ref=f34257b6e57401493dc8fdadce8c86b04029545b",
                "patch": "@@ -39,92 +39,92 @@\n  */\n public class TemplatesRemove extends UIAction {\n \n-\tprivate static final long serialVersionUID = 895186156151331087L;\n-\tprivate static Log log = LogFactory.getLog(TemplatesRemove.class);\n+    private static final long serialVersionUID = 895186156151331087L;\n+    private static Log log = LogFactory.getLog(TemplatesRemove.class);\n \n-\t// Templates to remove\n-\tprivate String[] idSelections = null;\n+    // Templates to remove\n+    private String[] idSelections = null;\n \n-\t// Limit updates to just this set of comma-separated IDs\n-\tprivate String ids = null;\n+    // Limit updates to just this set of comma-separated IDs\n+    private String ids = null;\n \n-\t// list of templates to display\n-\tprivate List<WeblogTemplate> templates = Collections.emptyList();;\n+    // list of templates to display\n+    private List<WeblogTemplate> templates = Collections.emptyList();;\n \n-\tpublic TemplatesRemove() {\n-\t\tthis.actionName = \"templatesRemove\";\n-\t\tthis.desiredMenu = \"editor\";\n-\t\tthis.pageTitle = \"editPages.title.removeOK\";\n-\t}\n+    public TemplatesRemove() {\n+        this.actionName = \"templatesRemove\";\n+        this.desiredMenu = \"editor\";\n+        this.pageTitle = \"editPages.title.removeOK\";\n+    }\n \n-\t@Override\n-\tpublic List<String> requiredWeblogPermissionActions() {\n-\t\treturn Collections.singletonList(WeblogPermission.ADMIN);\n-\t}\n+    @Override\n+    public List<String> requiredWeblogPermissionActions() {\n+        return Collections.singletonList(WeblogPermission.ADMIN);\n+    }\n \n-\tpublic void myPrepare() {\n+    public void myPrepare() {\n \n         if (getIdSelections() != null) {\n \n-\t\t\t// query for templates list\n-\t\t\ttry {\n-\n-\t\t\t\tWeblogManager mgr = WebloggerFactory.getWeblogger()\n-\t\t\t\t\t\t.getWeblogManager();\n-\n-\t\t\t\tList<WeblogTemplate> pages = new ArrayList<WeblogTemplate>();\n-\t\t\t\tWeblogTemplate template = null;\n+            // query for templates list\n+            try {\n \n-\t\t\t\tString[] idsToDelete = getIdSelections();\n-\t\t\t\tif (idsToDelete != null && idsToDelete.length > 0) {\n+                WeblogManager mgr = WebloggerFactory.getWeblogger()\n+                        .getWeblogManager();\n \n-\t\t\t\t\tfor (int i = 0; i < idsToDelete.length; i++) {\n-\t\t\t\t\t\tif (!idsToDelete[i].equals(\"\")) {\n-\t\t\t\t\t\t\ttemplate = mgr.getPage(idsToDelete[i]);\n-\t\t\t\t\t\t\tif (template != null) {\n-\t\t\t\t\t\t\t\tpages.add(template);\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n+                List<WeblogTemplate> pages = new ArrayList<WeblogTemplate>();\n+                WeblogTemplate template = null;\n \n-\t\t\t\t}\n+                String[] idsToDelete = getIdSelections();\n+                if (idsToDelete != null && idsToDelete.length > 0) {\n \n-\t\t\t\t// Set page data\n-\t\t\t\tsetTemplates(pages);\n-\t\t\t\tsetIds(Utilities.stringArrayToString(idsToDelete, \",\"));\n+                    for (int i = 0; i < idsToDelete.length; i++) {\n+                        if (!idsToDelete[i].equals(\"\")) {\n+                            template = mgr.getPage(idsToDelete[i]);\n+                            if (template != null) {\n+                                pages.add(template);\n+                            }\n+                        }\n+                    }\n \n-\t\t\t\t// Flush for operation\n-\t\t\t\tWebloggerFactory.getWeblogger().flush();\n+                }\n \n-\t\t\t} catch (Exception ex) {\n-\t\t\t\tlog.error(\"Error getting templates for weblog - \"\n-\t\t\t\t\t\t+ getActionWeblog().getHandle(), ex);\n-\t\t\t\taddError(\"error.unexpected\");\n-\t\t\t}\n+                // Set page data\n+                setTemplates(pages);\n+                setIds(Utilities.stringArrayToString(idsToDelete, \",\"));\n \n-\t\t}\n-\t}\n+                // Flush for operation\n+                WebloggerFactory.getWeblogger().flush();\n \n-\t/**\n-\t * Display the remove template confirmation.\n-\t */\n-\tpublic String execute() {\n+            } catch (Exception ex) {\n+                log.error(\"Error getting templates for weblog - \"\n+                        + getActionWeblog().getHandle(), ex);\n+                addError(\"error.unexpected\");\n+            }\n \n-\t\tif (getIds() != null && getTemplates() != null\n-\t\t\t\t&& getTemplates().size() > 0) {\n-\t\t\treturn \"confirm\";\n-\t\t} else {\n-\t\t\treturn SUCCESS;\n-\t\t}\n+        }\n+    }\n+\n+    /**\n+     * Display the remove template confirmation.\n+     */\n+    public String execute() {\n+\n+        if (getIds() != null && getTemplates() != null\n+                && getTemplates().size() > 0) {\n+            return \"confirm\";\n+        } else {\n+            return SUCCESS;\n+        }\n \n-\t}\n+    }\n \n-\t/**\n-\t * Remove Selected templates\n-\t */\n-\tpublic String remove() {\n+    /**\n+     * Remove Selected templates\n+     */\n+    public String remove() {\n \n-\t\tif (getIds() != null) {\n+        if (getIds() != null) {\n             try {\n \n                 String[] idsToDelete = Utilities.stringToStringArray(getIds(),\n@@ -143,8 +143,8 @@ public String remove() {\n                             template = mgr.getPage(idsToDelete[i]);\n                             if (!template.isRequired()\n                                     || !WeblogTemplate.ACTION_CUSTOM\n-                                    .equals(getActionWeblog()\n-                                            .getEditorTheme())) {\n+                                            .equals(getActionWeblog()\n+                                                    .getEditorTheme())) {\n \n                                 // if weblog template remove custom style sheet\n                                 // also\n@@ -157,12 +157,12 @@ public String remove() {\n                                     // Delete style sheet if the same name\n                                     if (stylesheet != null\n                                             && getActionWeblog().getTheme()\n-                                            .getStylesheet() != null\n+                                                    .getStylesheet() != null\n                                             && stylesheet.getLink().equals(\n-                                            getActionWeblog()\n-                                                    .getTheme()\n-                                                    .getStylesheet()\n-                                                    .getLink())) {\n+                                                    getActionWeblog()\n+                                                            .getTheme()\n+                                                            .getStylesheet()\n+                                                            .getLink())) {\n                                         // Same so OK to delete\n                                         WeblogTemplate css = mgr.getPageByLink(\n                                                 getActionWeblog(),\n@@ -206,63 +206,63 @@ public String remove() {\n             }\n         }\n \n-\t\treturn \"confirm\";\n-\t}\n-\n-\t/**\n-\t * Cancel.\n-\t * \n-\t * @return the string\n-\t */\n-\tpublic String cancel() {\n-\t\treturn \"cancel\";\n-\t}\n-\n-\t/**\n-\t * Gets the templates.\n-\t * \n-\t * @return the templates\n-\t */\n-\tpublic List<WeblogTemplate> getTemplates() {\n-\t\treturn templates;\n-\t}\n-\n-\t/**\n-\t * Sets the templates.\n-\t * \n-\t * @param templates\n-\t *            the new templates\n-\t */\n-\tpublic void setTemplates(List<WeblogTemplate> templates) {\n-\t\tthis.templates = templates;\n-\t}\n-\n-\t/**\n-\t * Select check boxes for deleting records\n-\t */\n-\tpublic String[] getIdSelections() {\n-\t\treturn idSelections.clone();\n-\t}\n-\n-\t/**\n-\t * Select check boxes for deleting records\n-\t */\n-\tpublic void setIdSelections(String[] idSelections) {\n-\t\tthis.idSelections = idSelections.clone();\n-\t}\n-\n-\t/**\n-\t * Comma separated list if ids to remove\n-\t */\n-\tpublic String getIds() {\n-\t\treturn ids;\n-\t}\n-\n-\t/**\n-\t * Comma separated list if ids to remove\n-\t */\n-\tpublic void setIds(String ids) {\n-\t\tthis.ids = ids;\n-\t}\n+        return \"confirm\";\n+    }\n+\n+    /**\n+     * Cancel.\n+     * \n+     * @return the string\n+     */\n+    public String cancel() {\n+        return \"cancel\";\n+    }\n+\n+    /**\n+     * Gets the templates.\n+     * \n+     * @return the templates\n+     */\n+    public List<WeblogTemplate> getTemplates() {\n+        return templates;\n+    }\n+\n+    /**\n+     * Sets the templates.\n+     * \n+     * @param templates\n+     *            the new templates\n+     */\n+    public void setTemplates(List<WeblogTemplate> templates) {\n+        this.templates = templates;\n+    }\n+\n+    /**\n+     * Select check boxes for deleting records\n+     */\n+    public String[] getIdSelections() {\n+        return idSelections;\n+    }\n+\n+    /**\n+     * Select check boxes for deleting records\n+     */\n+    public void setIdSelections(String[] idSelections) {\n+        this.idSelections = idSelections;\n+    }\n+\n+    /**\n+     * Comma separated list if ids to remove\n+     */\n+    public String getIds() {\n+        return ids;\n+    }\n+\n+    /**\n+     * Comma separated list if ids to remove\n+     */\n+    public void setIds(String ids) {\n+        this.ids = ids;\n+    }\n \n }",
                "changes": 260,
                "blob_url": "https://github.com/apache/roller/blob/f34257b6e57401493dc8fdadce8c86b04029545b/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/TemplatesRemove.java"
            },
            {
                "additions": 18,
                "sha": "288893840898c7ea0c47bacdb59877fba58cf80d",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/f34257b6e57401493dc8fdadce8c86b04029545b/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/ThemeEdit.java",
                "deletions": 11,
                "filename": "app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/ThemeEdit.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/ThemeEdit.java?ref=f34257b6e57401493dc8fdadce8c86b04029545b",
                "patch": "@@ -138,18 +138,24 @@ public String save() {\n \n                 // do theme import if necessary\n                 SharedTheme t = null;\n-                if (isImportTheme() && !StringUtils.isEmpty(getImportThemeId())) {\n-                    try {\n-                        ThemeManager themeMgr = WebloggerFactory.getWeblogger()\n-                                .getThemeManager();\n-                        t = themeMgr.getTheme(getImportThemeId());\n+\n+                try {\n+                    ThemeManager themeMgr = WebloggerFactory.getWeblogger()\n+                            .getThemeManager();\n+                    t = themeMgr.getTheme(getImportThemeId());\n+                    if (isImportTheme()\n+                            && !StringUtils.isEmpty(getImportThemeId())) {\n                         themeMgr.importTheme(getActionWeblog(), t);\n-                    } catch (Exception re) {\n-                        log.error(\"Error customizing theme for weblog - \"\n-                                + getActionWeblog().getHandle(), re);\n-                        // TODO: i18n\n-                        addError(\"Error importing theme\");\n+                    } else {\n+                        // Reset our custom from base\n+                        weblog.setCustomStylesheetPath(t.getStylesheet()\n+                                .getLink());\n                     }\n+                } catch (Exception re) {\n+                    log.error(\"Error customizing theme for weblog - \"\n+                            + getActionWeblog().getHandle(), re);\n+                    // TODO: i18n\n+                    addError(\"Error importing theme\");\n                 }\n \n                 if (!hasActionErrors()) {\n@@ -226,7 +232,8 @@ public String save() {\n                             .getWeblogManager();\n \n                     // Remove old style sheet\n-                    if (!originalTheme.equals(getThemeId())\n+                    if (!WeblogTheme.CUSTOM.equals(originalTheme)\n+                            && !originalTheme.equals(getThemeId())\n                             && getActionWeblog().getTheme().getStylesheet() != null) {\n \n                         WeblogTemplate stylesheet = mgr.getPageByLink(",
                "changes": 29,
                "blob_url": "https://github.com/apache/roller/blob/f34257b6e57401493dc8fdadce8c86b04029545b/app/src/main/java/org/apache/roller/weblogger/ui/struts2/editor/ThemeEdit.java"
            }
        ],
        "repo": "roller",
        "message": "Make sure switching back from custom does not delete our stylesheet and ensure the style sheet link is reset on switching back after setting alternate themes. NPE on the .clone().\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@1563986 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/f34257b6e57401493dc8fdadce8c86b04029545b"
    },
    {
        "parent": "https://github.com/apache/roller/commit/d5de887dcb98960d84565f4a07a81ba5aaf20d73",
        "bug_id": "roller_24",
        "file": [
            {
                "additions": 7,
                "sha": "091805a211f469ca8ef1797766bbaaeb529297d2",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/editor/MediaFileView.java",
                "deletions": 9,
                "filename": "apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/editor/MediaFileView.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/editor/MediaFileView.java?ref=778b412f968a4022c037e3a5c368e50b1ebe7ab7",
                "patch": "@@ -173,17 +173,16 @@ public String execute() {\n         MediaFileManager manager = WebloggerFactory.getWeblogger().getMediaFileManager();\r\n         try {\r\n             MediaFileDirectory directory;\r\n-            if (this.directoryId != null) {\r\n+            if (StringUtils.isNotEmpty(this.directoryId)) {\r\n                 directory = manager.getMediaFileDirectory(this.directoryId);\r\n \r\n-            } else if (this.directoryPath != null) {\r\n+            } else if (StringUtils.isNotEmpty(this.directoryPath)) {\r\n                 directory = manager.getMediaFileDirectoryByPath(getActionWeblog(), this.directoryPath);\r\n-                this.directoryId = directory.getId();\r\n \r\n             } else {\r\n                 directory = manager.getMediaFileRootDirectory(getActionWeblog());\r\n-                this.directoryId = directory.getId();\r\n             }\r\n+            this.directoryId = directory.getId();\r\n             this.directoryPath = directory.getPath();\r\n \r\n             this.childDirectories = new ArrayList<MediaFileDirectory>();\r\n@@ -194,18 +193,18 @@ public String execute() {\n \r\n             if (\"type\".equals(sortBy)) {\r\n                 Collections.sort(this.childFiles,\r\n-                        new MediaFileComparator(MediaFileComparatorType.TYPE));\r\n+                    new MediaFileComparator(MediaFileComparatorType.TYPE));\r\n \r\n             } else if (\"date_uploaded\".equals(sortBy)) {\r\n                 Collections.sort(this.childFiles,\r\n-                        new MediaFileComparator(MediaFileComparatorType.DATE_UPLOADED));\r\n+                    new MediaFileComparator(MediaFileComparatorType.DATE_UPLOADED));\r\n \r\n             } else { // default to sort by name\r\n                 sortBy = \"name\";\r\n                 Collections.sort(this.childDirectories,\r\n-                        new MediaFileDirectoryComparator(DirectoryComparatorType.NAME));\r\n+                    new MediaFileDirectoryComparator(DirectoryComparatorType.NAME));\r\n                 Collections.sort(this.childFiles,\r\n-                        new MediaFileComparator(MediaFileComparatorType.NAME));\r\n+                    new MediaFileComparator(MediaFileComparatorType.NAME));\r\n             }\r\n \r\n             this.currentDirectory = directory;\r\n@@ -269,7 +268,6 @@ public String search() {\n         String fullPath = this.currentDirectory.getPath();\r\n         if (fullPath.length() > 1) {\r\n             String[] directoryNames = fullPath.substring(1).split(\"/\");\r\n-            String directoryPath = \"\";\r\n             for (String directoryName : directoryNames) {\r\n                 directoryPath = directoryPath + \"/\" + directoryName;\r\n                 directoryHierarchy.add(new KeyValueObject(directoryPath, directoryName));\r",
                "changes": 16,
                "blob_url": "https://github.com/apache/roller/blob/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/src/java/org/apache/roller/weblogger/ui/struts2/editor/MediaFileView.java"
            },
            {
                "additions": 2,
                "sha": "67ab21da228358c9bc46c49f3a28215ab1ef5578",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/web/WEB-INF/classes/ApplicationResources.properties",
                "deletions": 2,
                "filename": "apps/weblogger/web/WEB-INF/classes/ApplicationResources.properties",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/web/WEB-INF/classes/ApplicationResources.properties?ref=778b412f968a4022c037e3a5c368e50b1ebe7ab7",
                "patch": "@@ -981,7 +981,7 @@ mediaFileAdd.name=Name\n mediaFileAdd.description=Description\n mediaFileAdd.tags=Tags (space separated)\n mediaFileAdd.copyright=Copyright statement\n-mediaFileAdd.directory=Place in directory\n+mediaFileAdd.directory=Directory\n mediaFileAdd.includeGallery=Include in Gallery?\n mediaFileAdd.upload=Upload\n mediaFileAdd.multipleNames=(Multiple names)\n@@ -1033,7 +1033,7 @@ mediaFileEdit.name=Name\n mediaFileEdit.description=Description\n mediaFileEdit.tags=Tags (space separated)\n mediaFileEdit.copyright=Copyright statement\n-mediaFileEdit.directory=Place file under\n+mediaFileEdit.directory=Directory\n mediaFileEdit.save=Save\n mediaFileEdit.cancel=Cancel\n mediaFileEdit.fileInfo=File info",
                "changes": 4,
                "blob_url": "https://github.com/apache/roller/blob/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/web/WEB-INF/classes/ApplicationResources.properties"
            },
            {
                "additions": 37,
                "sha": "7ff567540694df7f685679e899e91b1b7b3f2ba1",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/web/WEB-INF/jsps/editor/MediaFileView.jsp",
                "deletions": 16,
                "filename": "apps/weblogger/web/WEB-INF/jsps/editor/MediaFileView.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/web/WEB-INF/jsps/editor/MediaFileView.jsp?ref=778b412f968a4022c037e3a5c368e50b1ebe7ab7",
                "patch": "@@ -158,11 +158,13 @@\n     <p class=\"subtitle\">\r\n         <s:text name=\"mediaFileView.path\"/> /\r\n         <s:iterator id=\"directory\" value=\"currentDirectoryHierarchy\">\r\n+\r\n             <s:url id=\"getDirectoryByPathUrl\" action=\"mediaFileView\">\r\n                 <s:param name=\"directoryPath\" value=\"#directory.key\" />\r\n                 <s:param name=\"weblog\" value=\"%{actionWeblog.handle}\" />\r\n             </s:url>\r\n             <s:a href=\"%{getDirectoryByPathUrl}\"><s:property value=\"#directory.value\" /></s:a> /\r\n+            \r\n         </s:iterator>\r\n     </p>\r\n     <p class=\"pagetip\">\r\n@@ -179,37 +181,28 @@\n     <s:hidden name=\"directoryId\" />\r\n     <input type=\"hidden\" name=\"mediaFileId\" value=\"\" />\r\n \r\n-    <%--\r\n-    <s:url id=\"mediaFileHierarchicalViewURL\" action=\"mediaFileHierarchicalView\">\r\n-        <s:param name=\"weblog\" value=\"%{actionWeblog.handle}\" />\r\n-    </s:url>\r\n-    <p><span style=\"font-weight:bold\"><s:text name=\"mediaFileView.tabular\" /></span> |\r\n-        <s:a href=\"%{mediaFileHierarchicalViewURL}\"><s:text name=\"mediaFileView.hierarchy\" /></s:a></p>\r\n-    --%>\r\n-\r\n     <div class=\"control\">\r\n \r\n         <span style=\"padding-left:20px\">\r\n             <s:text name=\"mediaFileView.sortby\" />\r\n-            <s:select name=\"sortBy\" list=\"sortOptions\" listKey=\"key\"\r\n+            <s:select id=\"sortByMenu\" name=\"sortBy\" list=\"sortOptions\" listKey=\"key\"\r\n                   listValue=\"value\"\r\n                   onchange=\"document.mediaFileViewForm.submit();\" />\r\n         </span>\r\n \r\n         <span style=\"float:right\">\r\n-            <input type=\"button\" style=\"padding-right:20px\"\r\n+            <input id=\"deleteButton\" type=\"button\" style=\"padding-right:20px\"\r\n                value='<s:text name=\"mediaFileView.deleteSelected\" />' onclick=\"onDeleteSelected()\" />\r\n \r\n-            <input type=\"button\" style=\"padding-left:20px\"\r\n+            <input id=\"moveButton\" type=\"button\" style=\"padding-left:20px\"\r\n                value=<s:text name=\"mediaFileView.moveSelected\" /> onclick=\"onMoveSelected()\" />\r\n \r\n-            <s:select name=\"selectedDirectory\" list=\"allDirectories\" listKey=\"id\" listValue=\"path\" />\r\n+            <s:select id=\"moveTargetMenu\" name=\"selectedDirectory\" list=\"allDirectories\" listKey=\"id\" listValue=\"path\" />\r\n         </span>\r\n \r\n     </div>\r\n \r\n \r\n-\r\n     <%-- ***************************************************************** --%>\r\n \r\n     <%-- Media file folder contents --%>\r\n@@ -408,6 +401,35 @@\n </s:form>\r\n \r\n \r\n+<%-- ***************************************************************** --%>\r\n+\r\n+<%-- code to toggle buttons on/off as media file/directory selections change --%>\r\n+\r\n+<script type=\"text/javascript\">\r\n+    $(document).ready(function() {\r\n+        $(\"#deleteButton\").attr('disabled',true)\r\n+        $(\"#moveButton\").attr('disabled',true)\r\n+        $(\"#moveTargetMenu\").attr('disabled',true)\r\n+\r\n+        $(\"input[type=checkbox]\").change(function() {\r\n+            var count = 0;\r\n+            $(\"input[type=checkbox]\").each(function(index, element) {\r\n+                if (element.checked) count++;\r\n+            });\r\n+            if (count == 0) {\r\n+                $(\"#deleteButton\").attr('disabled',true)\r\n+                $(\"#moveButton\").attr('disabled',true)\r\n+                $(\"#moveTargetMenu\").attr('disabled',true)\r\n+            } else {\r\n+                $(\"#deleteButton\").attr('disabled',false)\r\n+                $(\"#moveButton\").attr('disabled',false)\r\n+                $(\"#moveTargetMenu\").attr('disabled',false)\r\n+            }\r\n+        });\r\n+    });\r\n+</script>\r\n+\r\n+\r\n <%-- ***************************************************************** --%>\r\n \r\n <%-- code to launch Media File Edit lightbox when user clicks a media file --%>\r\n@@ -429,7 +451,7 @@\n     }\r\n \r\n     YAHOO.namespace(\"mediaFileEditor\");\r\n-    function init() {\r\n+    $(document).ready(function() {\r\n         YAHOO.mediaFileEditor.lightbox = new YAHOO.widget.Panel(\r\n             \"mediafile_edit_lightbox\", {\r\n                 modal:    true,\r\n@@ -441,8 +463,7 @@\n             }\r\n         );\r\n         YAHOO.mediaFileEditor.lightbox.render(document.body);\r\n-    }\r\n-    YAHOO.util.Event.addListener(window, \"load\", init);\r\n+    });\r\n \r\n </script>\r\n \r",
                "changes": 53,
                "blob_url": "https://github.com/apache/roller/blob/778b412f968a4022c037e3a5c368e50b1ebe7ab7/apps/weblogger/web/WEB-INF/jsps/editor/MediaFileView.jsp"
            }
        ],
        "repo": "roller",
        "message": "Couple of small fixes:\n- Only show move and delete buttons when files or directories are selected\n- Fixed NPE when attempting to move files from search view\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@821575 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/778b412f968a4022c037e3a5c368e50b1ebe7ab7"
    },
    {
        "parent": "https://github.com/apache/roller/commit/21e87abb44bf971706933b4318f26cc88524ad63",
        "bug_id": "roller_25",
        "file": [
            {
                "additions": 1,
                "sha": "88c371f5f010ee4aab2d3b03e629fb14a3956f5e",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/79f6afa653677364515f287effc2aa25cd946abb/apps/weblogger/web/WEB-INF/jsps/admin/PlanetSubscriptions.jsp",
                "deletions": 1,
                "filename": "apps/weblogger/web/WEB-INF/jsps/admin/PlanetSubscriptions.jsp",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/apps/weblogger/web/WEB-INF/jsps/admin/PlanetSubscriptions.jsp?ref=79f6afa653677364515f287effc2aa25cd946abb",
                "patch": "@@ -20,7 +20,7 @@\n <script type=\"text/javascript\">\n function confirmSubDelete(subUrl) {\n   if (window.confirm('Are you sure you want to remove this subscription?')) {\n-    document.location.href='<s:url action=\"planetSubscriptions!delete\" />?groupHandle=<s:property value=\"groupHandle\"/>&subUrl='+subUrl;\n+    document.location.href='<s:url action=\"planetSubscriptions!delete\" />?groupHandle=<s:property value=\"groupHandle\"/>&subUrl='+encodeURIComponent(subUrl);\n   }\n }\n </script>",
                "changes": 2,
                "blob_url": "https://github.com/apache/roller/blob/79f6afa653677364515f287effc2aa25cd946abb/apps/weblogger/web/WEB-INF/jsps/admin/PlanetSubscriptions.jsp"
            }
        ],
        "repo": "roller",
        "message": "Applying patch for ROL-1722\nhttps://issues.apache.org/roller/browse/ROL-1722\n\nChanging display name of frontpage theme to 'Frontpage'Applying patch for ROL-1726\nhttps://issues.apache.org/roller/browse/ROL-1726\n\nFix for NPE when deleting subscription with ampersant in URL\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@669156 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/79f6afa653677364515f287effc2aa25cd946abb"
    },
    {
        "parent": "https://github.com/apache/roller/commit/1f488e4ec8d18701b420340cbb6320bf93635e23",
        "bug_id": "roller_26",
        "file": [
            {
                "additions": 0,
                "sha": "40fa1dfcbb5f16b7e5f9976421cbc0c6c34b6bf4",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3/tools/roller-core/roller-core.jar",
                "deletions": 0,
                "filename": "tools/roller-core/roller-core.jar",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/tools/roller-core/roller-core.jar?ref=2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3",
                "changes": 0,
                "blob_url": "https://github.com/apache/roller/blob/2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3/tools/roller-core/roller-core.jar"
            },
            {
                "additions": 0,
                "sha": "0119db1a82eaf1f74eef70b60710b94e2c06997b",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3/tools/roller-planet/roller-planet-business.jar",
                "deletions": 0,
                "filename": "tools/roller-planet/roller-planet-business.jar",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/tools/roller-planet/roller-planet-business.jar?ref=2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3",
                "changes": 0,
                "blob_url": "https://github.com/apache/roller/blob/2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3/tools/roller-planet/roller-planet-business.jar"
            }
        ],
        "repo": "roller",
        "message": "updating planet and core integration jars to include fixes from revisions 559126, 559889 which fix some NPEs and logging in planet code and revision 559556 which adds some additional date utility methods.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/roller/trunk@559898 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/2a1b4ab4786af95aa0a989ac39b51d3bd0eb93c3"
    },
    {
        "parent": "https://github.com/apache/roller/commit/cfe2ff8986422a08f7d76cbb5ddb4c5f201f7671",
        "bug_id": "roller_27",
        "file": [
            {
                "additions": 3,
                "sha": "58cce72e1ca8b93172bdacee2daccf5f2b90ada6",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/FeedServlet.java",
                "deletions": 3,
                "filename": "src/org/apache/roller/ui/rendering/servlets/FeedServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/FeedServlet.java?ref=1fd0ed785e505e97933036c8d1ecd5806f9820fe",
                "patch": "@@ -111,10 +111,10 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n \n \n         // determine the lastModified date for this content\n-        long lastModified = 0;\n+        long lastModified = System.currentTimeMillis();\n         if(isSiteWide) {\n             lastModified = siteWideCache.getLastModified().getTime();\n-        } else {\n+        } else if (weblog.getLastModified() != null) {\n             lastModified = weblog.getLastModified().getTime();\n         }\n \n@@ -124,7 +124,7 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n         }\n \n         // set last-modified date\n-        ModDateHeaderUtil.setLastModifiedHeader(response,lastModified);\n+        ModDateHeaderUtil.setLastModifiedHeader(response, lastModified);\n \n         // set content type\n         String accepts = request.getHeader(\"Accept\");",
                "changes": 6,
                "blob_url": "https://github.com/apache/roller/blob/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/FeedServlet.java"
            },
            {
                "additions": 2,
                "sha": "7682cbd2c44035d4ab7e779a9f7f66b0ddddf3d4",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/PageServlet.java",
                "deletions": 2,
                "filename": "src/org/apache/roller/ui/rendering/servlets/PageServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/PageServlet.java?ref=1fd0ed785e505e97933036c8d1ecd5806f9820fe",
                "patch": "@@ -164,10 +164,10 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n         \n         \n         // determine the lastModified date for this content\n-        long lastModified = 0;\n+        long lastModified = System.currentTimeMillis();\n         if(isSiteWide) {\n             lastModified = siteWideCache.getLastModified().getTime();\n-        } else {\n+        } else if (weblog.getLastModified() != null) {\n             lastModified = weblog.getLastModified().getTime();\n         }\n ",
                "changes": 4,
                "blob_url": "https://github.com/apache/roller/blob/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/PageServlet.java"
            },
            {
                "additions": 4,
                "sha": "3d67ccadd321d7f400b28ed32d3c57aae8b6700f",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/RSDServlet.java",
                "deletions": 1,
                "filename": "src/org/apache/roller/ui/rendering/servlets/RSDServlet.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/rendering/servlets/RSDServlet.java?ref=1fd0ed785e505e97933036c8d1ecd5806f9820fe",
                "patch": "@@ -95,7 +95,10 @@ public void doGet(HttpServletRequest request, HttpServletResponse response)\n         \n \n         // Respond with 304 Not Modified if it is not modified.\n-        long lastModified = weblog.getLastModified().getTime();\n+        long lastModified = System.currentTimeMillis();\n+        if (weblog.getLastModified() != null) {\n+            lastModified = weblog.getLastModified().getTime();\n+        }\n         if (ModDateHeaderUtil.respondIfNotModified(request,response,lastModified)) {\n             return;\n         }",
                "changes": 5,
                "blob_url": "https://github.com/apache/roller/blob/1fd0ed785e505e97933036c8d1ecd5806f9820fe/src/org/apache/roller/ui/rendering/servlets/RSDServlet.java"
            }
        ],
        "repo": "roller",
        "message": "Merging changes from revision 469202 back to trunk.  This was a fix for NPEs caused by unset website.lastModified attributes which was committed to the 3.0 branch only and needed to be in trunk as well.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@482257 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/1fd0ed785e505e97933036c8d1ecd5806f9820fe"
    },
    {
        "parent": "https://github.com/apache/roller/commit/0dc758beeeb519c72ac01774be79aa54fc74468e",
        "bug_id": "roller_28",
        "file": [
            {
                "additions": 39,
                "sha": "94a138d985eb8cdd5fbe4da3fd190c369401efb4",
                "status": "modified",
                "raw_url": "https://github.com/apache/roller/raw/3db687d1810989739b345a8dcb472b212ab5f437/src/org/apache/roller/ui/authoring/struts/actions/UploadFileFormAction.java",
                "deletions": 24,
                "filename": "src/org/apache/roller/ui/authoring/struts/actions/UploadFileFormAction.java",
                "contents_url": "https://api.github.com/repos/apache/roller/contents/src/org/apache/roller/ui/authoring/struts/actions/UploadFileFormAction.java?ref=3db687d1810989739b345a8dcb472b212ab5f437",
                "patch": "@@ -129,8 +129,11 @@ public ActionForward createSubdir(ActionMapping mapping,\n             \n             String path = theForm.getPath();\n             String newDir = theForm.getNewDir();\n-            if(newDir != null && newDir.trim().length() > 0 &&\n-                    newDir.indexOf(\"/\") == -1 && newDir.indexOf(\"\\\\\") == -1) {\n+            if(newDir != null && \n+                    newDir.trim().length() > 0 &&\n+                    newDir.indexOf(\"/\") == -1 && \n+                    newDir.indexOf(\"\\\\\") == -1 &&\n+                    newDir.indexOf(\"..\") == -1) {\n                 \n                 // figure the new directory path\n                 String newDirPath = newDir;\n@@ -199,7 +202,8 @@ public ActionForward upload(ActionMapping mapping,\n             FileManager fmgr = RollerFactory.getRoller().getFileManager();\n             \n             List uploaded = new ArrayList();\n-            if (theForm.getUploadedFiles().length > 0) {\n+            if (theForm.getUploadedFiles() != null &&\n+                    theForm.getUploadedFiles().length > 0) {\n                 \n                 // make sure uploads are enabled\n                 if(!RollerRuntimeConfig.getBooleanProperty(\"uploads.enabled\")) {\n@@ -236,10 +240,19 @@ public ActionForward upload(ActionMapping mapping,\n                         fileName = theForm.getPath() + \"/\" + fileName;\n                     }\n                     \n+                    // make sure fileName is valid\n+                    if (fileName.indexOf(\"/\") != -1 || \n+                            fileName.indexOf(\"\\\\\") != -1 ||\n+                            fileName.indexOf(\"..\") != -1) {\n+                        errors.add(ActionErrors.GLOBAL_ERROR,\n+                                new ActionError(\"uploadFiles.error.badPath\", fileName));\n+                        continue;\n+                    }\n+                    \n                     try {\n                         fmgr.saveFile(website, fileName,\n-                                files[i].getContentType(), \n-                                files[i].getFileSize(), \n+                                files[i].getContentType(),\n+                                files[i].getFileSize(),\n                                 files[i].getInputStream());\n                         \n                         uploaded.add(fileName);\n@@ -311,26 +324,28 @@ public ActionForward delete(ActionMapping mapping,\n             \n             int numDeleted = 0;\n             String[] deleteFiles = theForm.getDeleteFiles();\n-            for (int i=0; i < deleteFiles.length; i++) {\n-                if (deleteFiles[i].trim().startsWith(\"/\") || \n-                        deleteFiles[i].trim().startsWith(\"\\\\\") || \n-                        deleteFiles[i].indexOf(\"..\") != -1) {\n-                    // ignore absolute paths, or paths that contiain '..'\n-                } else {\n-                    try {\n-                        fmgr.deleteFile(website, deleteFiles[i]);\n-                        numDeleted++;\n-                    } catch (FileNotFoundException ex) {\n-                        errors.add(ActionErrors.GLOBAL_ERROR,\n-                                new ActionError(\"uploadFiles.error.badPath\"));\n-                    } catch (FilePathException ex) {\n-                        errors.add(ActionErrors.GLOBAL_ERROR,\n-                                new ActionError(\"uploadFiles.error.badPath\"));\n-                    } catch (FileIOException ex) {\n-                        errors.add(ActionErrors.GLOBAL_ERROR,\n-                                new ActionError(\"uploadFiles.error.delete\", deleteFiles[i]));\n+            if(deleteFiles != null) {\n+                for (int i=0; i < deleteFiles.length; i++) {\n+                    if (deleteFiles[i].trim().startsWith(\"/\") ||\n+                            deleteFiles[i].trim().startsWith(\"\\\\\") ||\n+                            deleteFiles[i].indexOf(\"..\") != -1) {\n+                        // ignore absolute paths, or paths that contiain '..'\n+                    } else {\n+                        try {\n+                            fmgr.deleteFile(website, deleteFiles[i]);\n+                            numDeleted++;\n+                        } catch (FileNotFoundException ex) {\n+                            errors.add(ActionErrors.GLOBAL_ERROR,\n+                                    new ActionError(\"uploadFiles.error.badPath\"));\n+                        } catch (FilePathException ex) {\n+                            errors.add(ActionErrors.GLOBAL_ERROR,\n+                                    new ActionError(\"uploadFiles.error.badPath\"));\n+                        } catch (FileIOException ex) {\n+                            errors.add(ActionErrors.GLOBAL_ERROR,\n+                                    new ActionError(\"uploadFiles.error.delete\", deleteFiles[i]));\n+                        }\n+                        \n                     }\n-                    \n                 }\n             }\n             ",
                "changes": 63,
                "blob_url": "https://github.com/apache/roller/blob/3db687d1810989739b345a8dcb472b212ab5f437/src/org/apache/roller/ui/authoring/struts/actions/UploadFileFormAction.java"
            }
        ],
        "repo": "roller",
        "message": "fixing a couple bugs in upload form.\n\n1. prevent creating of directories with bad character patterns like \"/\", \"\\\", and \"..\"\n\n2. fix NPEs if uploading/deleting a null list of files\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/roller/trunk@468075 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/roller/commit/3db687d1810989739b345a8dcb472b212ab5f437"
    }
]