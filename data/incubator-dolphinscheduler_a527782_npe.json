[
    {
        "repo": "incubator-dolphinscheduler",
        "commit": "https://github.com/apache/incubator-dolphinscheduler/commit/a5277827f23f9e4181c8a70c8501f91db3d4a974",
        "bug_id": "incubator-dolphinscheduler_a527782",
        "message": "merge dev-db to dev (#1426)\n\n* [dolphinscheduler-1345] [newfeature] Add DB2 Datasource (#1391)\r\n\r\n* Fix the problem that the 'queueId' is not present when creating a tenant based on the default queue. (#1409)\r\n\r\n* dolphinscheduler-#1403][bug]improve the check rules (#1408)\r\n\r\n1. When check failed, we don\u2019t know whitch parameter has is wrong, Because username\u3001password\u3001email and phone were checks together. I refactored the check method ,Now it will return failed msg by each field.\r\n2. The email check regex support [_|\\-|\\.]?) in createUser.vue, But it do not support in backend server , I fix it, Now they have the same check regex both in frontend and backend\r\n\r\n* jcip-annotations define version information and maven-assembly-plugin add groupId (#1413)\r\n\r\n* \"v-for\" add key (#1419)\r\n\r\n* [dolphinscheduler-#1397] [bug]Resources can not be previewed or updated\u00a0 (#1406)\r\n\r\nWhen create an resource the name will add the suffix, But When rename the resource there is no suffix add to the name, So When update resource name without suffix just like \"test.sh\" => \"test\" , Then the bug reproduced.\r\n\r\nTo fix this bug i add the logic bellow:\r\nWhen rename, if the name without suffix then add it ,else use the origin name\r\n\r\n* simply server module configs (#1424)\r\n\r\n* move updateTaskState into try/catch block in case of exception\r\n\r\n* fix NPE\r\n\r\n* using conf.getInt instead of getString\r\n\r\n* for AbstractZKClient, remove the log, for it will print the same log message in createZNodePath.\r\nfor AlertDao, correct the spelling.\r\n\r\n* duplicate\r\n\r\n* refactor getTaskWorkerGroupId\r\n\r\n* add friendly log\r\n\r\n* update hearbeat thread num = 1\r\n\r\n* fix the bug when worker execute task using queue. and remove checking Tenant user anymore in TaskScheduleThread\r\n\r\n* 1. move verifyTaskInstanceIsNull after taskInstance\r\n2. keep verifyTenantIsNull/verifyTaskInstanceIsNull clean and readable\r\n\r\n* fix the message\r\n\r\n* delete before check to avoid KeeperException$NoNodeException\r\n\r\n* fix the message\r\n\r\n* check processInstance state before delete tenant\r\n\r\n* check processInstance state before delete worker group\r\n\r\n* refactor\r\n\r\n* merge api constants into common constatns\r\n\r\n* update the resource perm\r\n\r\n* update the dataSource perm\r\n\r\n* fix CheckUtils.checkUserParams method\r\n\r\n* update AlertGroupService, extends from BaseService, remove duplicate methods\r\n\r\n* refactor\r\n\r\n* modify method name\r\n\r\n* add hasProjectAndPerm method\r\n\r\n* using checkProject instead of getResultStatus\r\n\r\n* delete checkAuth method, using hasProjectAndPerm instead.\r\n\r\n* correct spelling\r\n\r\n* add transactional for deleteWorkerGroupById\r\n\r\n* add Transactional for deleteProcessInstanceById method\r\n\r\n* change sqlSessionTemplate singleton\r\n\r\n* change sqlSessionTemplate singleton and reformat code\r\n\r\n* fix unsuitable error message\r\n\r\n* update shutdownhook methods\r\n\r\n* fix worker log bug\r\n\r\n* fix api server debug mode bug\r\n\r\n* upgrade zk version\r\n\r\n* delete this line ,for zkClient.close() will do the whole thing\r\n\r\n* fix master server shutdown error\r\n\r\n* degrade zk version and add FourLetterWordMain class\r\n\r\n* fix PathChildrenCache not close\r\n\r\n* add Transactional for createSession method\r\n\r\n* add more message for java-doc\r\n\r\n* delete App, let spring manage connectionFactory\r\n\r\n* add license\r\n\r\n* add class Application for test support\r\n\r\n* refactor masterServer and workerServer\r\n\r\n* add args\r\n\r\n* fix the spring transaction not work bug\r\n\r\n* remove author\r\n\r\n* delete @Bean annotation\r\n\r\n* delete master/worker properties\r\n\r\n* updates\r\n\r\n* rename application.properties to application-dao.properties\r\n\r\n* delete this class\r\n\r\n* delete master/worker properties and  refactory master/worker\r\n\r\n* delete unused imports\r\n\r\n* merge\r\n\r\n* delete unused config",
        "parent": "https://github.com/apache/incubator-dolphinscheduler/commit/18e2f753eb40f6299354f044533c05a552e7e4a3",
        "patched_files": [
            "pom.xml",
            "variablesView.vue",
            "ResourcesService.java",
            "email.vue",
            "master.properties",
            "index.vue",
            "install.sh",
            "worker.vue",
            "createDataSource.vue",
            "DataSourceService.java",
            "master.vue",
            "state.js",
            "createTenement.vue",
            "OSUtils.java",
            "db.vue",
            "secondaryMenu.vue",
            "transfer.vue",
            "UsersService.java",
            "worker.properties"
        ],
        "file": [
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/18e2f753eb40f6299354f044533c05a552e7e4a3/dockerfile/conf/dolphinscheduler/conf/master.properties",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dockerfile/conf/dolphinscheduler/conf/master.properties?ref=18e2f753eb40f6299354f044533c05a552e7e4a3",
                "filename": "dockerfile/conf/dolphinscheduler/conf/master.properties",
                "deletions": 38,
                "sha": "73c29a2db223e2ba9e81cc0a83eaa6fb18e35729",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/18e2f753eb40f6299354f044533c05a552e7e4a3/dockerfile/conf/dolphinscheduler/conf/master.properties",
                "patch": "@@ -1,38 +0,0 @@\n-#\n-# Licensed to the Apache Software Foundation (ASF) under one or more\n-# contributor license agreements.  See the NOTICE file distributed with\n-# this work for additional information regarding copyright ownership.\n-# The ASF licenses this file to You under the Apache License, Version 2.0\n-# (the \"License\"); you may not use this file except in compliance with\n-# the License.  You may obtain a copy of the License at\n-#\n-#     http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing, software\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-# See the License for the specific language governing permissions and\n-# limitations under the License.\n-#\n-\n-# master execute thread num\n-master.exec.threads=100\n-\n-# master execute task number in parallel\n-master.exec.task.number=20\n-\n-# master heartbeat interval\n-master.heartbeat.interval=10\n-\n-# master commit task retry times\n-master.task.commit.retryTimes=5\n-\n-# master commit task interval\n-master.task.commit.interval=100\n-\n-\n-# only less than cpu avg load, master server can work. default value : the number of cpu cores * 2\n-#master.max.cpuload.avg=100\n-\n-# only larger than reserved memory, master server can work. default value : physical memory * 1/10, unit is G.\n-master.reserved.memory=0.1",
                "changes": 38
            },
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/18e2f753eb40f6299354f044533c05a552e7e4a3/dockerfile/conf/dolphinscheduler/conf/worker.properties",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dockerfile/conf/dolphinscheduler/conf/worker.properties?ref=18e2f753eb40f6299354f044533c05a552e7e4a3",
                "filename": "dockerfile/conf/dolphinscheduler/conf/worker.properties",
                "deletions": 32,
                "sha": "582bb953f082fbca72c2722db2d3c388445e022b",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/18e2f753eb40f6299354f044533c05a552e7e4a3/dockerfile/conf/dolphinscheduler/conf/worker.properties",
                "patch": "@@ -1,32 +0,0 @@\n-#\n-# Licensed to the Apache Software Foundation (ASF) under one or more\n-# contributor license agreements.  See the NOTICE file distributed with\n-# this work for additional information regarding copyright ownership.\n-# The ASF licenses this file to You under the Apache License, Version 2.0\n-# (the \"License\"); you may not use this file except in compliance with\n-# the License.  You may obtain a copy of the License at\n-#\n-#     http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing, software\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-# See the License for the specific language governing permissions and\n-# limitations under the License.\n-#\n-\n-# worker execute thread num\n-worker.exec.threads=100\n-\n-# worker heartbeat interval\n-worker.heartbeat.interval=10\n-\n-# submit the number of tasks at a time\n-worker.fetch.task.num = 3\n-\n-\n-# only less than cpu avg load, worker server can work. default value : the number of cpu cores * 2\n-#worker.max.cpuload.avg=10\n-\n-# only larger than reserved memory, worker server can work. default value : physical memory * 1/6, unit is G.\n-worker.reserved.memory=1\n\\ No newline at end of file",
                "changes": 32
            },
            {
                "status": "modified",
                "additions": 12,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/DataSourceService.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/DataSourceService.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/DataSourceService.java",
                "deletions": 1,
                "sha": "5d33b46bd2541d620bd1f01b2b404f140ca307c7",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/DataSourceService.java",
                "patch": "@@ -405,9 +405,14 @@ private Connection getConnection(DbType dbType, String parameter) {\n                     datasource = JSONObject.parseObject(parameter, SQLServerDataSource.class);\n                     Class.forName(Constants.COM_SQLSERVER_JDBC_DRIVER);\n                     break;\n+                case DB2:\n+                    datasource = JSONObject.parseObject(parameter, DB2ServerDataSource.class);\n+                    Class.forName(Constants.COM_DB2_JDBC_DRIVER);\n+                    break;\n                 default:\n                     break;\n             }\n+\n             if(datasource != null){\n                 connection = DriverManager.getConnection(datasource.getJdbcUrl(), datasource.getUser(), datasource.getPassword());\n             }\n@@ -487,6 +492,7 @@ public String buildParameter(String name, String desc, DbType type, String host,\n             separator = \"&\";\n         } else if (Constants.HIVE.equals(type.name())\n                 || Constants.SPARK.equals(type.name())\n+                || Constants.DB2.equals(type.name())\n                 || Constants.SQLSERVER.equals(type.name())) {\n             separator = \";\";\n         }\n@@ -509,7 +515,9 @@ public String buildParameter(String name, String desc, DbType type, String host,\n                 for (Map.Entry<String, String> entry: map.entrySet()) {\n                     otherSb.append(String.format(\"%s=%s%s\", entry.getKey(), entry.getValue(), separator));\n                 }\n-                otherSb.deleteCharAt(otherSb.length() - 1);\n+                if (!Constants.DB2.equals(type.name())) {\n+                    otherSb.deleteCharAt(otherSb.length() - 1);\n+                }\n                 parameterMap.put(Constants.OTHER, otherSb);\n             }\n \n@@ -549,6 +557,9 @@ private String buildAddress(DbType type, String host, String port) {\n         } else if (Constants.SQLSERVER.equals(type.name())) {\n             sb.append(Constants.JDBC_SQLSERVER);\n             sb.append(host).append(\":\").append(port);\n+        }else if (Constants.DB2.equals(type.name())) {\n+            sb.append(Constants.JDBC_DB2);\n+            sb.append(host).append(\":\").append(port);\n         }\n \n         return sb.toString();",
                "changes": 13
            },
            {
                "status": "modified",
                "additions": 11,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ResourcesService.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ResourcesService.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ResourcesService.java",
                "deletions": 2,
                "sha": "97db9ee1d75ec789eced27862a4bc28f30f25200",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ResourcesService.java",
                "patch": "@@ -235,9 +235,18 @@ public Result updateResource(User loginUser,\n             }\n         }\n \n-        // updateProcessInstance data\n+        //get the file suffix\n+        String suffix = originResourceName.substring(originResourceName.lastIndexOf(\".\"));\n+\n+        //if the name without suffix then add it ,else use the origin name\n+        String nameWithSuffix = name;\n+        if(!name.endsWith(suffix)){\n+            nameWithSuffix = nameWithSuffix + suffix;\n+        }\n+\n+        // updateResource data\n         Date now = new Date();\n-        resource.setAlias(name);\n+        resource.setAlias(nameWithSuffix);\n         resource.setDescription(desc);\n         resource.setUpdateTime(now);\n ",
                "changes": 13
            },
            {
                "status": "modified",
                "additions": 34,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/UsersService.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/UsersService.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/UsersService.java",
                "deletions": 2,
                "sha": "92319e71a1d1c2a94179d11052b03590383bd712",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/UsersService.java",
                "patch": "@@ -96,8 +96,12 @@\n                                           String queue) throws Exception {\n \n         Map<String, Object> result = new HashMap<>(5);\n-        if (!CheckUtils.checkUserParams(userName, userPassword, email, phone)) {\n-            putMsg(result, Status.REQUEST_PARAMS_NOT_VALID_ERROR,userName);\n+\n+        //check all user params\n+        String msg = this.checkUserParams(userName, userPassword, email, phone);\n+\n+        if (!StringUtils.isEmpty(msg)) {\n+            putMsg(result, Status.REQUEST_PARAMS_NOT_VALID_ERROR,msg);\n             return result;\n         }\n         if (!isAdmin(loginUser)) {\n@@ -687,4 +691,32 @@ private boolean check(Map<String, Object> result, boolean bool, Status userNoOpe\n     private boolean checkTenantExists(int tenantId) {\n         return tenantMapper.queryById(tenantId) != null ? true : false;\n     }\n+\n+    /**\n+     *\n+     * @param userName\n+     * @param password\n+     * @param email\n+     * @param phone\n+     * @return if check failed return the field, otherwise return null\n+     */\n+    private String checkUserParams(String userName, String password, String email, String phone) {\n+\n+        String msg = null;\n+        if (!CheckUtils.checkUserName(userName)) {\n+\n+            msg = userName;\n+        } else if (!CheckUtils.checkPassword(password)) {\n+\n+            msg = password;\n+        } else if (!CheckUtils.checkEmail(email)) {\n+\n+            msg = email;\n+        } else if (!CheckUtils.checkPhone(phone)) {\n+\n+            msg = phone;\n+        }\n+\n+        return msg;\n+    }\n }",
                "changes": 36
            },
            {
                "status": "modified",
                "additions": 11,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java",
                "deletions": 11,
                "sha": "f25352f3f08ade26e0ca02d1052880b6a3a7e7c0",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/Constants.java",
                "patch": "@@ -31,16 +31,6 @@\n      */\n     public static final String ZOOKEEPER_PROPERTIES_PATH = \"zookeeper.properties\";\n \n-    /**\n-     * worker properties path\n-     */\n-    public static final String WORKER_PROPERTIES_PATH = \"worker.properties\";\n-\n-    /**\n-     * master properties path\n-     */\n-    public static final String MASTER_PROPERTIES_PATH = \"master.properties\";\n-\n     /**\n      * hadoop properties path\n      */\n@@ -330,7 +320,7 @@\n     /**\n      * email regex\n      */\n-    public static final Pattern REGEX_MAIL_NAME = Pattern.compile(\"^([a-z0-9A-Z]+[-|\\\\.]?)+[a-z0-9A-Z]@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\\\\.)+[a-zA-Z]{2,}$\");\n+    public static final Pattern REGEX_MAIL_NAME = Pattern.compile(\"^([a-z0-9A-Z]+[_|\\\\-|\\\\.]?)+[a-z0-9A-Z]@([a-z0-9A-Z]+(-[a-z0-9A-Z]+)?\\\\.)+[a-zA-Z]{2,}$\");\n \n     /**\n      * read permission\n@@ -652,6 +642,13 @@\n      */\n     public static final String JDBC_SQLSERVER_CLASS_NAME = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\";\n \n+\n+    /**\n+     * DB2\n+     */\n+    public static final String JDBC_DB2_CLASS_NAME = \"com.ibm.db2.jcc.DB2Driver\";\n+\n+\n     /**\n      * spark params constant\n      */\n@@ -1003,6 +1000,7 @@\n     public static final String COM_CLICKHOUSE_JDBC_DRIVER = \"ru.yandex.clickhouse.ClickHouseDriver\";\n     public static final String COM_ORACLE_JDBC_DRIVER = \"oracle.jdbc.driver.OracleDriver\";\n     public static final String COM_SQLSERVER_JDBC_DRIVER = \"com.microsoft.sqlserver.jdbc.SQLServerDriver\";\n+    public static final String COM_DB2_JDBC_DRIVER = \"com.ibm.db2.jcc.DB2Driver\";\n \n     /**\n      * database type\n@@ -1014,6 +1012,7 @@\n     public static final String CLICKHOUSE = \"CLICKHOUSE\";\n     public static final String ORACLE = \"ORACLE\";\n     public static final String SQLSERVER = \"SQLSERVER\";\n+    public static final String DB2 = \"DB2\";\n \n     /**\n      * jdbc url\n@@ -1024,6 +1023,7 @@\n     public static final String JDBC_CLICKHOUSE = \"jdbc:clickhouse://\";\n     public static final String JDBC_ORACLE = \"jdbc:oracle:thin:@//\";\n     public static final String JDBC_SQLSERVER = \"jdbc:sqlserver://\";\n+    public static final String JDBC_DB2 = \"jdbc:db2://\";\n \n \n     public static final String ADDRESS = \"address\";",
                "changes": 22
            },
            {
                "status": "modified",
                "additions": 3,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/enums/DbType.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/enums/DbType.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/enums/DbType.java",
                "deletions": 1,
                "sha": "4637771eda31f6a85a51c0c1eb4e71e0033ee786",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/enums/DbType.java",
                "patch": "@@ -32,14 +32,16 @@\n    * 4 clickhouse\n    * 5 oracle\n    * 6 sqlserver\n+   * 7 db2\n    */\n   MYSQL(0, \"mysql\"),\n   POSTGRESQL(1, \"postgresql\"),\n   HIVE(2, \"hive\"),\n   SPARK(3, \"spark\"),\n   CLICKHOUSE(4, \"clickhouse\"),\n   ORACLE(5, \"oracle\"),\n-  SQLSERVER(6, \"sqlserver\");\n+  SQLSERVER(6, \"sqlserver\"),\n+  DB2(7, \"db2\");\n \n   DbType(int code, String descp){\n     this.code = code;",
                "changes": 4
            },
            {
                "status": "added",
                "additions": 75,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DB2ServerDataSource.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DB2ServerDataSource.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DB2ServerDataSource.java",
                "deletions": 0,
                "sha": "8783c8ebbecf5c9729838005828f6e074cdc2a7f",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DB2ServerDataSource.java",
                "patch": "@@ -0,0 +1,75 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.dolphinscheduler.common.job.db;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.dolphinscheduler.common.Constants;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+import java.sql.Connection;\n+import java.sql.DriverManager;\n+import java.sql.SQLException;\n+\n+/**\n+ * data source of DB2 Server\n+ */\n+public class DB2ServerDataSource extends BaseDataSource {\n+    private static final Logger logger = LoggerFactory.getLogger(DB2ServerDataSource.class);\n+\n+    /**\n+     * gets the JDBC url for the data source connection\n+     * @return\n+     */\n+    @Override\n+    public String getJdbcUrl() {\n+        String jdbcUrl = getAddress();\n+        if (jdbcUrl.lastIndexOf(\"/\") != (jdbcUrl.length() - 1)) {\n+            jdbcUrl += \"/\";\n+        }\n+\n+        jdbcUrl += getDatabase();\n+\n+        if (StringUtils.isNotEmpty(getOther())) {\n+            jdbcUrl += \":\" + getOther();\n+        }\n+        return jdbcUrl;\n+    }\n+\n+    /**\n+     * test whether the data source can be connected successfully\n+     * @throws Exception\n+     */\n+    @Override\n+    public void isConnectable() throws Exception {\n+        Connection con = null;\n+        try {\n+            Class.forName(Constants.COM_DB2_JDBC_DRIVER);\n+            con = DriverManager.getConnection(getJdbcUrl(), getUser(), getPassword());\n+        } finally {\n+            if (con != null) {\n+                try {\n+                    con.close();\n+                } catch (SQLException e) {\n+                    logger.error(\"DB2 Server datasource try conn close conn error\", e);\n+                    throw e;\n+                }\n+            }\n+        }\n+\n+    }\n+}",
                "changes": 75
            },
            {
                "status": "modified",
                "additions": 5,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DataSourceFactory.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DataSourceFactory.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DataSourceFactory.java",
                "deletions": 0,
                "sha": "6dec9ba766a16011a9a0249f64069d2fc3284958",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/job/db/DataSourceFactory.java",
                "patch": "@@ -46,6 +46,8 @@ public static BaseDataSource getDatasource(DbType dbType, String parameter) {\n           return JSONUtils.parseObject(parameter, OracleDataSource.class);\n         case SQLSERVER:\n           return JSONUtils.parseObject(parameter, SQLServerDataSource.class);\n+        case DB2:\n+          return JSONUtils.parseObject(parameter, DB2ServerDataSource.class);\n         default:\n           return null;\n       }\n@@ -83,6 +85,9 @@ public static void loadClass(DbType dbType) throws Exception{\n       case SQLSERVER:\n         Class.forName(Constants.JDBC_SQLSERVER_CLASS_NAME);\n         break;\n+      case DB2:\n+        Class.forName(Constants.JDBC_DB2_CLASS_NAME);\n+        break;\n       default:\n         logger.error(\"not support sql type: {},can't load class\", dbType);\n         throw new IllegalArgumentException(\"not support sql type,can't load class\");",
                "changes": 5
            },
            {
                "status": "modified",
                "additions": 17,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/OSUtils.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/OSUtils.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/OSUtils.java",
                "deletions": 0,
                "sha": "fbb3970f51847fae291b6c299400cb7995d4ac0d",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/OSUtils.java",
                "patch": "@@ -267,6 +267,23 @@ public static boolean isWindows() {\n     return os.startsWith(\"Windows\");\n   }\n \n+  /**\n+   * check memory and cpu usage\n+   * @return check memory and cpu usage\n+   */\n+  public static Boolean checkResource(double systemCpuLoad, double systemReservedMemory){\n+    // judging usage\n+    double loadAverage = OSUtils.loadAverage();\n+    //\n+    double availablePhysicalMemorySize = OSUtils.availablePhysicalMemorySize();\n+\n+    if(loadAverage > systemCpuLoad || availablePhysicalMemorySize < systemReservedMemory){\n+      logger.warn(\"load or availablePhysicalMemorySize(G) is too high, it's availablePhysicalMemorySize(G):{},loadAvg:{}\", availablePhysicalMemorySize , loadAverage);\n+      return false;\n+    }else{\n+      return true;\n+    }\n+  }\n \n   /**\n    * check memory and cpu usage",
                "changes": 17
            },
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/AbstractServer.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/AbstractServer.java?ref=18e2f753eb40f6299354f044533c05a552e7e4a3",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/AbstractServer.java",
                "deletions": 49,
                "sha": "6ab677dfb1e1ef5c4ceae496cce147cc03ec76c1",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/AbstractServer.java",
                "patch": "@@ -1,49 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *    http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-package org.apache.dolphinscheduler.server.master;\n-\n-import org.apache.dolphinscheduler.common.IStoppable;\n-import org.apache.commons.configuration.Configuration;\n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n-import org.springframework.boot.CommandLineRunner;\n-import org.springframework.context.annotation.ComponentScan;\n-\n-/**\n- *   master server\n- */\n-public abstract class AbstractServer implements IStoppable {\n-\n-\n-    /**\n-     * abstract server onfiguration\n-     */\n-    protected static Configuration conf;\n-\n-    /**\n-     *  heartbeat interval, unit second\n-     */\n-    protected int heartBeatInterval;\n-\n-    /**\n-     * gracefully stop\n-     * @param cause why stopping\n-     */\n-    @Override\n-    public abstract void stop(String cause);\n-}\n-",
                "changes": 49
            },
            {
                "status": "modified",
                "additions": 20,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/MasterServer.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/MasterServer.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/MasterServer.java",
                "deletions": 22,
                "sha": "b10f248484ad19af3ddd642eb8ddb36583452225",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/MasterServer.java",
                "patch": "@@ -16,18 +16,19 @@\n  */\n package org.apache.dolphinscheduler.server.master;\n \n-import org.apache.commons.configuration.ConfigurationException;\n-import org.apache.commons.configuration.PropertiesConfiguration;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.dolphinscheduler.common.Constants;\n+import org.apache.dolphinscheduler.common.IStoppable;\n import org.apache.dolphinscheduler.common.thread.Stopper;\n import org.apache.dolphinscheduler.common.thread.ThreadPoolExecutors;\n import org.apache.dolphinscheduler.common.thread.ThreadUtils;\n import org.apache.dolphinscheduler.common.utils.OSUtils;\n import org.apache.dolphinscheduler.dao.ProcessDao;\n+import org.apache.dolphinscheduler.server.master.config.MasterConfig;\n import org.apache.dolphinscheduler.server.master.runner.MasterSchedulerThread;\n import org.apache.dolphinscheduler.server.quartz.ProcessScheduleJob;\n import org.apache.dolphinscheduler.server.quartz.QuartzExecutors;\n+import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n import org.apache.dolphinscheduler.server.zk.ZKMasterClient;\n import org.quartz.SchedulerException;\n import org.slf4j.Logger;\n@@ -45,7 +46,7 @@\n  * master server\n  */\n @ComponentScan(\"org.apache.dolphinscheduler\")\n-public class MasterServer extends AbstractServer {\n+public class MasterServer implements IStoppable {\n \n     /**\n      * logger of MasterServer\n@@ -73,6 +74,19 @@\n      */\n     private ExecutorService masterSchedulerService;\n \n+    /**\n+     *  spring application context\n+     *  only use it for initialization\n+     */\n+    @Autowired\n+    private SpringApplicationContext springApplicationContext;\n+\n+    /**\n+     * master config\n+     */\n+    @Autowired\n+    private MasterConfig masterConfig;\n+\n \n     /**\n      * master server startup\n@@ -91,26 +105,10 @@ public static void main(String[] args) {\n     @PostConstruct\n     public void run(){\n \n-        try {\n-            conf = new PropertiesConfiguration(Constants.MASTER_PROPERTIES_PATH);\n-        }catch (ConfigurationException e){\n-            logger.error(\"load configuration failed : \" + e.getMessage(),e);\n-            System.exit(1);\n-        }\n-\n         masterSchedulerService = ThreadUtils.newDaemonSingleThreadExecutor(\"Master-Scheduler-Thread\");\n \n         zkMasterClient = ZKMasterClient.getZKMasterClient(processDao);\n \n-        // heartbeat interval\n-        heartBeatInterval = conf.getInt(Constants.MASTER_HEARTBEAT_INTERVAL,\n-                Constants.defaultMasterHeartbeatInterval);\n-\n-        // master exec thread pool num\n-        int masterExecThreadNum = conf.getInt(Constants.MASTER_EXEC_THREADS,\n-                Constants.defaultMasterExecThreadNum);\n-\n-\n         heartbeatMasterService = ThreadUtils.newDaemonThreadScheduledExecutor(\"Master-Main-Thread\",Constants.defaulMasterHeartbeatThreadNum);\n \n         // heartbeat thread implement\n@@ -121,13 +119,13 @@ public void run(){\n         // regular heartbeat\n         // delay 5 seconds, send heartbeat every 30 seconds\n         heartbeatMasterService.\n-                scheduleAtFixedRate(heartBeatThread, 5, heartBeatInterval, TimeUnit.SECONDS);\n+                scheduleAtFixedRate(heartBeatThread, 5, masterConfig.getMasterHeartbeatInterval(), TimeUnit.SECONDS);\n \n         // master scheduler thread\n         MasterSchedulerThread masterSchedulerThread = new MasterSchedulerThread(\n                 zkMasterClient,\n-                processDao,conf,\n-                masterExecThreadNum);\n+                processDao,\n+                masterConfig.getMasterExecThreads());\n \n         // submit master scheduler thread\n         masterSchedulerService.execute(masterSchedulerThread);",
                "changes": 42
            },
            {
                "status": "added",
                "additions": 101,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/config/MasterConfig.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/config/MasterConfig.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/config/MasterConfig.java",
                "deletions": 0,
                "sha": "ca58f8b2f13b838100377dea6378327880559ac8",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/config/MasterConfig.java",
                "patch": "@@ -0,0 +1,101 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.dolphinscheduler.server.master.config;\n+\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class MasterConfig {\n+\n+    @Value(\"${master.exec.threads:100}\")\n+    private int masterExecThreads;\n+\n+    @Value(\"${master.exec.task.num:20}\")\n+    private int masterExecTaskNum;\n+\n+    @Value(\"${master.heartbeat.interval:10}\")\n+    private int masterHeartbeatInterval;\n+\n+    @Value(\"${master.task.commit.retryTimes:5}\")\n+    private int masterTaskCommitRetryTimes;\n+\n+    @Value(\"${master.task.commit.interval:100}\")\n+    private int masterTaskCommitInterval;\n+\n+    @Value(\"${master.max.cpuload.avg:100}\")\n+    private double masterMaxCpuloadAvg;\n+\n+    @Value(\"${master.reserved.memory:0.1}\")\n+    private double masterReservedMemory;\n+\n+    public int getMasterExecThreads() {\n+        return masterExecThreads;\n+    }\n+\n+    public void setMasterExecThreads(int masterExecThreads) {\n+        this.masterExecThreads = masterExecThreads;\n+    }\n+\n+    public int getMasterExecTaskNum() {\n+        return masterExecTaskNum;\n+    }\n+\n+    public void setMasterExecTaskNum(int masterExecTaskNum) {\n+        this.masterExecTaskNum = masterExecTaskNum;\n+    }\n+\n+    public int getMasterHeartbeatInterval() {\n+        return masterHeartbeatInterval;\n+    }\n+\n+    public void setMasterHeartbeatInterval(int masterHeartbeatInterval) {\n+        this.masterHeartbeatInterval = masterHeartbeatInterval;\n+    }\n+\n+    public int getMasterTaskCommitRetryTimes() {\n+        return masterTaskCommitRetryTimes;\n+    }\n+\n+    public void setMasterTaskCommitRetryTimes(int masterTaskCommitRetryTimes) {\n+        this.masterTaskCommitRetryTimes = masterTaskCommitRetryTimes;\n+    }\n+\n+    public int getMasterTaskCommitInterval() {\n+        return masterTaskCommitInterval;\n+    }\n+\n+    public void setMasterTaskCommitInterval(int masterTaskCommitInterval) {\n+        this.masterTaskCommitInterval = masterTaskCommitInterval;\n+    }\n+\n+    public double getMasterMaxCpuloadAvg() {\n+        return masterMaxCpuloadAvg;\n+    }\n+\n+    public void setMasterMaxCpuloadAvg(double masterMaxCpuloadAvg) {\n+        this.masterMaxCpuloadAvg = masterMaxCpuloadAvg;\n+    }\n+\n+    public double getMasterReservedMemory() {\n+        return masterReservedMemory;\n+    }\n+\n+    public void setMasterReservedMemory(double masterReservedMemory) {\n+        this.masterReservedMemory = masterReservedMemory;\n+    }\n+}",
                "changes": 101
            },
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterBaseTaskExecThread.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterBaseTaskExecThread.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterBaseTaskExecThread.java",
                "deletions": 19,
                "sha": "4934df197897eabe599a6bfa921d6d69f1486b7c",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterBaseTaskExecThread.java",
                "patch": "@@ -16,17 +16,15 @@\n  */\n package org.apache.dolphinscheduler.server.master.runner;\n \n-import org.apache.dolphinscheduler.common.Constants;\n import org.apache.dolphinscheduler.common.queue.ITaskQueue;\n import org.apache.dolphinscheduler.common.queue.TaskQueueFactory;\n import org.apache.dolphinscheduler.dao.AlertDao;\n import org.apache.dolphinscheduler.dao.ProcessDao;\n import org.apache.dolphinscheduler.dao.entity.ProcessInstance;\n import org.apache.dolphinscheduler.dao.entity.TaskInstance;\n import org.apache.dolphinscheduler.dao.utils.BeanContext;\n-import org.apache.commons.configuration.Configuration;\n-import org.apache.commons.configuration.ConfigurationException;\n-import org.apache.commons.configuration.PropertiesConfiguration;\n+import org.apache.dolphinscheduler.server.master.config.MasterConfig;\n+import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n@@ -73,18 +71,9 @@\n     protected boolean cancel;\n \n     /**\n-     * load configuration file\n+     * master config\n      */\n-    private static Configuration conf;\n-\n-    static {\n-        try {\n-            conf = new PropertiesConfiguration(Constants.MASTER_PROPERTIES_PATH);\n-        } catch (ConfigurationException e) {\n-            logger.error(e.getMessage(), e);\n-            System.exit(1);\n-        }\n-    }\n+    private MasterConfig masterConfig;\n \n     /**\n      * constructor of MasterBaseTaskExecThread\n@@ -98,6 +87,7 @@ public MasterBaseTaskExecThread(TaskInstance taskInstance, ProcessInstance proce\n         this.taskQueue = TaskQueueFactory.getTaskQueueInstance();\n         this.cancel = false;\n         this.taskInstance = taskInstance;\n+        this.masterConfig = SpringApplicationContext.getBean(MasterConfig.class);\n     }\n \n     /**\n@@ -120,10 +110,8 @@ public void kill(){\n      * @return TaskInstance\n      */\n     protected TaskInstance submit(){\n-        Integer commitRetryTimes = conf.getInt(Constants.MASTER_COMMIT_RETRY_TIMES,\n-                Constants.defaultMasterCommitRetryTimes);\n-        Integer commitRetryInterval = conf.getInt(Constants.MASTER_COMMIT_RETRY_INTERVAL,\n-                Constants.defaultMasterCommitRetryInterval);\n+        Integer commitRetryTimes = masterConfig.getMasterTaskCommitRetryTimes();\n+        Integer commitRetryInterval = masterConfig.getMasterTaskCommitInterval();\n \n         int retryTimes = 1;\n ",
                "changes": 26
            },
            {
                "status": "modified",
                "additions": 11,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterExecThread.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterExecThread.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterExecThread.java",
                "deletions": 24,
                "sha": "5446830780e935125cf3cd40c59419f0356c57fc",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterExecThread.java",
                "patch": "@@ -16,6 +16,9 @@\n  */\n package org.apache.dolphinscheduler.server.master.runner;\n \n+import com.alibaba.fastjson.JSONObject;\n+import org.apache.commons.io.FileUtils;\n+import org.apache.commons.lang3.StringUtils;\n import org.apache.dolphinscheduler.common.Constants;\n import org.apache.dolphinscheduler.common.enums.*;\n import org.apache.dolphinscheduler.common.graph.DAG;\n@@ -24,22 +27,16 @@\n import org.apache.dolphinscheduler.common.process.ProcessDag;\n import org.apache.dolphinscheduler.common.thread.Stopper;\n import org.apache.dolphinscheduler.common.thread.ThreadUtils;\n-import org.apache.dolphinscheduler.dao.DaoFactory;\n+import org.apache.dolphinscheduler.common.utils.*;\n import org.apache.dolphinscheduler.dao.ProcessDao;\n import org.apache.dolphinscheduler.dao.entity.ProcessInstance;\n import org.apache.dolphinscheduler.dao.entity.TaskInstance;\n import org.apache.dolphinscheduler.dao.utils.DagHelper;\n+import org.apache.dolphinscheduler.server.master.config.MasterConfig;\n import org.apache.dolphinscheduler.server.utils.AlertManager;\n-import com.alibaba.fastjson.JSONObject;\n-import org.apache.commons.configuration.Configuration;\n-import org.apache.commons.configuration.ConfigurationException;\n-import org.apache.commons.configuration.PropertiesConfiguration;\n-import org.apache.commons.io.FileUtils;\n-import org.apache.commons.lang3.StringUtils;\n-import org.apache.dolphinscheduler.common.utils.*;\n+import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n-import org.springframework.beans.factory.annotation.Autowired;\n \n import java.io.File;\n import java.io.IOException;\n@@ -131,9 +128,9 @@\n     private ProcessDao processDao;\n \n     /**\n-     * load configuration file\n+     * master config\n      */\n-    private static Configuration conf;\n+    private MasterConfig masterConfig;\n \n     /**\n      * constructor of MasterExecThread\n@@ -144,23 +141,13 @@ public MasterExecThread(ProcessInstance processInstance,ProcessDao processDao){\n         this.processDao = processDao;\n \n         this.processInstance = processInstance;\n-\n-        int masterTaskExecNum = conf.getInt(Constants.MASTER_EXEC_TASK_THREADS,\n-                Constants.defaultMasterTaskExecNum);\n+        this.masterConfig = SpringApplicationContext.getBean(MasterConfig.class);\n+        int masterTaskExecNum = masterConfig.getMasterExecTaskNum();\n         this.taskExecService = ThreadUtils.newDaemonFixedThreadExecutor(\"Master-Task-Exec-Thread\",\n                 masterTaskExecNum);\n     }\n \n \n-    static {\n-        try {\n-            conf = new PropertiesConfiguration(Constants.MASTER_PROPERTIES_PATH);\n-        }catch (ConfigurationException e){\n-            logger.error(\"load configuration failed : \" + e.getMessage(),e);\n-            System.exit(1);\n-        }\n-    }\n-\n     @Override\n     public void run() {\n \n@@ -927,7 +914,7 @@ private boolean checkProcessTimeOut(ProcessInstance processInstance) {\n      * @return boolean\n      */\n     private boolean canSubmitTaskToQueue() {\n-        return OSUtils.checkResource(conf, true);\n+        return OSUtils.checkResource(masterConfig.getMasterMaxCpuloadAvg(), masterConfig.getMasterReservedMemory());\n     }\n \n ",
                "changes": 35
            },
            {
                "status": "modified",
                "additions": 10,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterSchedulerThread.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterSchedulerThread.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterSchedulerThread.java",
                "deletions": 9,
                "sha": "27f417d50158374556454f1476f977ca80ab1789",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/master/runner/MasterSchedulerThread.java",
                "patch": "@@ -16,6 +16,8 @@\n  */\n package org.apache.dolphinscheduler.server.master.runner;\n \n+import org.apache.curator.framework.imps.CuratorFrameworkState;\n+import org.apache.curator.framework.recipes.locks.InterProcessMutex;\n import org.apache.dolphinscheduler.common.Constants;\n import org.apache.dolphinscheduler.common.thread.Stopper;\n import org.apache.dolphinscheduler.common.thread.ThreadUtils;\n@@ -24,10 +26,9 @@\n import org.apache.dolphinscheduler.dao.ProcessDao;\n import org.apache.dolphinscheduler.dao.entity.Command;\n import org.apache.dolphinscheduler.dao.entity.ProcessInstance;\n+import org.apache.dolphinscheduler.server.master.config.MasterConfig;\n+import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n import org.apache.dolphinscheduler.server.zk.ZKMasterClient;\n-import org.apache.commons.configuration.Configuration;\n-import org.apache.curator.framework.imps.CuratorFrameworkState;\n-import org.apache.curator.framework.recipes.locks.InterProcessMutex;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n@@ -65,23 +66,23 @@\n     private int masterExecThreadNum;\n \n     /**\n-     * Configuration of MasterSchedulerThread\n+     * master config\n      */\n-    private final Configuration conf;\n+    private MasterConfig masterConfig;\n+\n \n     /**\n      * constructor of MasterSchedulerThread\n      * @param zkClient              zookeeper master client\n      * @param processDao            process dao\n-     * @param conf                  conf\n      * @param masterExecThreadNum   master exec thread num\n      */\n-    public MasterSchedulerThread(ZKMasterClient zkClient, ProcessDao processDao, Configuration conf, int masterExecThreadNum){\n+    public MasterSchedulerThread(ZKMasterClient zkClient, ProcessDao processDao, int masterExecThreadNum){\n         this.processDao = processDao;\n         this.zkMasterClient = zkClient;\n-        this.conf = conf;\n         this.masterExecThreadNum = masterExecThreadNum;\n         this.masterExecService = ThreadUtils.newDaemonFixedThreadExecutor(\"Master-Exec-Thread\",masterExecThreadNum);\n+        this.masterConfig = SpringApplicationContext.getBean(MasterConfig.class);\n     }\n \n     /**\n@@ -97,7 +98,7 @@ public void run() {\n             InterProcessMutex mutex = null;\n             try {\n \n-                if(OSUtils.checkResource(conf, true)){\n+                if(OSUtils.checkResource(masterConfig.getMasterMaxCpuloadAvg(), masterConfig.getMasterReservedMemory())){\n                     if (zkMasterClient.getZkClient().getState() == CuratorFrameworkState.STARTED) {\n \n                         // create distributed lock with the root node path of the lock space as /dolphinscheduler/lock/failover/master",
                "changes": 19
            },
            {
                "status": "modified",
                "additions": 8,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/WorkerServer.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/WorkerServer.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/WorkerServer.java",
                "deletions": 25,
                "sha": "32dea48a4e8c26e28f2d0bdd66d5a96baaf5fa13",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/WorkerServer.java",
                "patch": "@@ -16,11 +16,10 @@\n  */\n package org.apache.dolphinscheduler.server.worker;\n \n-import org.apache.commons.configuration.ConfigurationException;\n-import org.apache.commons.configuration.PropertiesConfiguration;\n import org.apache.commons.lang.StringUtils;\n import org.apache.curator.framework.recipes.locks.InterProcessMutex;\n import org.apache.dolphinscheduler.common.Constants;\n+import org.apache.dolphinscheduler.common.IStoppable;\n import org.apache.dolphinscheduler.common.enums.ExecutionStatus;\n import org.apache.dolphinscheduler.common.enums.TaskType;\n import org.apache.dolphinscheduler.common.queue.ITaskQueue;\n@@ -34,9 +33,9 @@\n import org.apache.dolphinscheduler.dao.AlertDao;\n import org.apache.dolphinscheduler.dao.ProcessDao;\n import org.apache.dolphinscheduler.dao.entity.TaskInstance;\n-import org.apache.dolphinscheduler.server.master.AbstractServer;\n import org.apache.dolphinscheduler.server.utils.ProcessUtils;\n import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n+import org.apache.dolphinscheduler.server.worker.config.WorkerConfig;\n import org.apache.dolphinscheduler.server.worker.runner.FetchTaskThread;\n import org.apache.dolphinscheduler.server.zk.ZKWorkerClient;\n import org.slf4j.Logger;\n@@ -57,7 +56,7 @@\n  *  worker server\n  */\n @ComponentScan(\"org.apache.dolphinscheduler\")\n-public class WorkerServer extends AbstractServer {\n+public class WorkerServer implements IStoppable {\n \n     /**\n      * logger\n@@ -115,12 +114,12 @@\n      */\n     private CountDownLatch latch;\n \n-    /**\n-     * If inside combined server, WorkerServer no need to await on CountDownLatch\n-     */\n     @Value(\"${server.is-combined-server:false}\")\n     private Boolean isCombinedServer;\n \n+    @Autowired\n+    private WorkerConfig workerConfig;\n+\n     /**\n      * master server startup\n      *\n@@ -138,13 +137,6 @@ public static void main(String[] args) {\n     @PostConstruct\n     public void run(){\n \n-        try {\n-            conf = new PropertiesConfiguration(Constants.WORKER_PROPERTIES_PATH);\n-        }catch (ConfigurationException e){\n-            logger.error(\"load configuration failed\",e);\n-            System.exit(1);\n-        }\n-\n         zkWorkerClient = ZKWorkerClient.getZKWorkerClient();\n \n         this.taskQueue = TaskQueueFactory.getTaskQueueInstance();\n@@ -153,10 +145,6 @@ public void run(){\n \n         this.fetchTaskExecutorService = ThreadUtils.newDaemonSingleThreadExecutor(\"Worker-Fetch-Thread-Executor\");\n \n-        //  heartbeat interval\n-        heartBeatInterval = conf.getInt(Constants.WORKER_HEARTBEAT_INTERVAL,\n-                Constants.defaultWorkerHeartbeatInterval);\n-\n         heartbeatWorkerService = ThreadUtils.newDaemonThreadScheduledExecutor(\"Worker-Heartbeat-Thread-Executor\", Constants.defaulWorkerHeartbeatThreadNum);\n \n         // heartbeat thread implement\n@@ -166,21 +154,16 @@ public void run(){\n \n         // regular heartbeat\n         // delay 5 seconds, send heartbeat every 30 seconds\n-        heartbeatWorkerService.scheduleAtFixedRate(heartBeatThread, 5, heartBeatInterval, TimeUnit.SECONDS);\n+        heartbeatWorkerService.scheduleAtFixedRate(heartBeatThread, 5, workerConfig.getWorkerHeartbeatInterval(), TimeUnit.SECONDS);\n \n         // kill process thread implement\n         Runnable killProcessThread = getKillProcessThread();\n \n         // submit kill process thread\n         killExecutorService.execute(killProcessThread);\n \n-\n-\n-        // get worker number of concurrent tasks\n-        int taskNum = conf.getInt(Constants.WORKER_FETCH_TASK_NUM,Constants.defaultWorkerFetchTaskNum);\n-\n         // new fetch task thread\n-        FetchTaskThread fetchTaskThread = new FetchTaskThread(taskNum,zkWorkerClient, processDao,conf, taskQueue);\n+        FetchTaskThread fetchTaskThread = new FetchTaskThread(zkWorkerClient, processDao, taskQueue);\n \n         // submit fetch task thread\n         fetchTaskExecutorService.execute(fetchTaskThread);",
                "changes": 33
            },
            {
                "status": "added",
                "additions": 79,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/config/WorkerConfig.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/config/WorkerConfig.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/config/WorkerConfig.java",
                "deletions": 0,
                "sha": "c66dec8c3ee5f945fc0ab3cedc6b064871a8942b",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/config/WorkerConfig.java",
                "patch": "@@ -0,0 +1,79 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *    http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.dolphinscheduler.server.worker.config;\n+\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.stereotype.Component;\n+\n+@Component\n+public class WorkerConfig {\n+\n+    @Value(\"${worker.exec.threads:100}\")\n+    private int workerExecThreads;\n+\n+    @Value(\"${worker.heartbeat.interval:10}\")\n+    private int workerHeartbeatInterval;\n+\n+    @Value(\"${worker.fetch.task.num:3}\")\n+    private int workerFetchTaskNum;\n+\n+    @Value(\"${worker.max.cpuload.avg:10}\")\n+    private int workerMaxCpuloadAvg;\n+\n+    @Value(\"${master.reserved.memory:1}\")\n+    private double workerReservedMemory;\n+\n+    public int getWorkerExecThreads() {\n+        return workerExecThreads;\n+    }\n+\n+    public void setWorkerExecThreads(int workerExecThreads) {\n+        this.workerExecThreads = workerExecThreads;\n+    }\n+\n+    public int getWorkerHeartbeatInterval() {\n+        return workerHeartbeatInterval;\n+    }\n+\n+    public void setWorkerHeartbeatInterval(int workerHeartbeatInterval) {\n+        this.workerHeartbeatInterval = workerHeartbeatInterval;\n+    }\n+\n+    public int getWorkerFetchTaskNum() {\n+        return workerFetchTaskNum;\n+    }\n+\n+    public void setWorkerFetchTaskNum(int workerFetchTaskNum) {\n+        this.workerFetchTaskNum = workerFetchTaskNum;\n+    }\n+\n+    public double getWorkerReservedMemory() {\n+        return workerReservedMemory;\n+    }\n+\n+    public void setWorkerReservedMemory(double workerReservedMemory) {\n+        this.workerReservedMemory = workerReservedMemory;\n+    }\n+\n+    public int getWorkerMaxCpuloadAvg() {\n+        return workerMaxCpuloadAvg;\n+    }\n+\n+    public void setWorkerMaxCpuloadAvg(int workerMaxCpuloadAvg) {\n+        this.workerMaxCpuloadAvg = workerMaxCpuloadAvg;\n+    }\n+}",
                "changes": 79
            },
            {
                "status": "modified",
                "additions": 17,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/runner/FetchTaskThread.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/runner/FetchTaskThread.java?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/runner/FetchTaskThread.java",
                "deletions": 17,
                "sha": "f7ea3fad6f671b286a91fe0c05681dd011c0be31",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-server/src/main/java/org/apache/dolphinscheduler/server/worker/runner/FetchTaskThread.java",
                "patch": "@@ -16,6 +16,8 @@\n  */\n package org.apache.dolphinscheduler.server.worker.runner;\n \n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.curator.framework.recipes.locks.InterProcessMutex;\n import org.apache.dolphinscheduler.common.Constants;\n import org.apache.dolphinscheduler.common.queue.ITaskQueue;\n import org.apache.dolphinscheduler.common.thread.Stopper;\n@@ -28,10 +30,9 @@\n import org.apache.dolphinscheduler.dao.entity.TaskInstance;\n import org.apache.dolphinscheduler.dao.entity.Tenant;\n import org.apache.dolphinscheduler.dao.entity.WorkerGroup;\n+import org.apache.dolphinscheduler.server.utils.SpringApplicationContext;\n+import org.apache.dolphinscheduler.server.worker.config.WorkerConfig;\n import org.apache.dolphinscheduler.server.zk.ZKWorkerClient;\n-import org.apache.commons.configuration.Configuration;\n-import org.apache.commons.lang3.StringUtils;\n-import org.apache.curator.framework.recipes.locks.InterProcessMutex;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n \n@@ -77,11 +78,6 @@\n      */\n     private int workerExecNums;\n \n-    /**\n-     * conf\n-     */\n-    private Configuration conf;\n-\n     /**\n      *  task instance\n      */\n@@ -92,18 +88,22 @@\n      */\n     Integer taskInstId;\n \n-    public FetchTaskThread(int taskNum, ZKWorkerClient zkWorkerClient,\n-                           ProcessDao processDao, Configuration conf,\n+    /**\n+     * worker config\n+     */\n+    private WorkerConfig workerConfig;\n+\n+    public FetchTaskThread(ZKWorkerClient zkWorkerClient,\n+                           ProcessDao processDao,\n                            ITaskQueue taskQueue){\n-        this.taskNum = taskNum;\n         this.zkWorkerClient = zkWorkerClient;\n         this.processDao = processDao;\n-        this.workerExecNums = conf.getInt(Constants.WORKER_EXEC_THREADS,\n-                Constants.defaultWorkerExecThreadNum);\n-        // worker thread pool executor\n-        this.workerExecService = ThreadUtils.newDaemonFixedThreadExecutor(\"Worker-Fetch-Task-Thread\",workerExecNums);\n-        this.conf = conf;\n         this.taskQueue = taskQueue;\n+        this.workerConfig = SpringApplicationContext.getBean(WorkerConfig.class);\n+        this.taskNum = workerConfig.getWorkerFetchTaskNum();\n+        this.workerExecNums = workerConfig.getWorkerExecThreads();\n+        // worker thread pool executor\n+        this.workerExecService = ThreadUtils.newDaemonFixedThreadExecutor(\"Worker-Fetch-Task-Thread\", workerExecNums);\n         this.taskInstance = null;\n     }\n \n@@ -145,7 +145,7 @@ public void run() {\n             try {\n                 ThreadPoolExecutor poolExecutor = (ThreadPoolExecutor) workerExecService;\n                 //check memory and cpu usage and threads\n-                boolean runCheckFlag = OSUtils.checkResource(this.conf, false) && checkThreadCount(poolExecutor);\n+                boolean runCheckFlag = OSUtils.checkResource(workerConfig.getWorkerMaxCpuloadAvg(), workerConfig.getWorkerReservedMemory()) && checkThreadCount(poolExecutor);\n \n                 Thread.sleep(Constants.SLEEP_TIME_MILLIS);\n ",
                "changes": 34
            },
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/resources/master.properties",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/resources/master.properties?ref=18e2f753eb40f6299354f044533c05a552e7e4a3",
                "filename": "dolphinscheduler-server/src/main/resources/master.properties",
                "deletions": 38,
                "sha": "a3864fa095ad4d03f8912a6fe8e84a65891e6be8",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/resources/master.properties",
                "patch": "@@ -1,38 +0,0 @@\n-#\n-# Licensed to the Apache Software Foundation (ASF) under one or more\n-# contributor license agreements.  See the NOTICE file distributed with\n-# this work for additional information regarding copyright ownership.\n-# The ASF licenses this file to You under the Apache License, Version 2.0\n-# (the \"License\"); you may not use this file except in compliance with\n-# the License.  You may obtain a copy of the License at\n-#\n-#     http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing, software\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-# See the License for the specific language governing permissions and\n-# limitations under the License.\n-#\n-\n-# master execute thread num\n-master.exec.threads=100\n-\n-# master execute task number in parallel\n-master.exec.task.number=20\n-\n-# master heartbeat interval\n-master.heartbeat.interval=10\n-\n-# master commit task retry times\n-master.task.commit.retryTimes=5\n-\n-# master commit task interval\n-master.task.commit.interval=100\n-\n-\n-# only less than cpu avg load, master server can work. default value : the number of cpu cores * 2\n-master.max.cpuload.avg=100\n-\n-# only larger than reserved memory, master server can work. default value : physical memory * 1/10, unit is G.\n-master.reserved.memory=0.1",
                "changes": 38
            },
            {
                "status": "removed",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/resources/worker.properties",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-server/src/main/resources/worker.properties?ref=18e2f753eb40f6299354f044533c05a552e7e4a3",
                "filename": "dolphinscheduler-server/src/main/resources/worker.properties",
                "deletions": 32,
                "sha": "582bb953f082fbca72c2722db2d3c388445e022b",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/18e2f753eb40f6299354f044533c05a552e7e4a3/dolphinscheduler-server/src/main/resources/worker.properties",
                "patch": "@@ -1,32 +0,0 @@\n-#\n-# Licensed to the Apache Software Foundation (ASF) under one or more\n-# contributor license agreements.  See the NOTICE file distributed with\n-# this work for additional information regarding copyright ownership.\n-# The ASF licenses this file to You under the Apache License, Version 2.0\n-# (the \"License\"); you may not use this file except in compliance with\n-# the License.  You may obtain a copy of the License at\n-#\n-#     http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing, software\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n-# See the License for the specific language governing permissions and\n-# limitations under the License.\n-#\n-\n-# worker execute thread num\n-worker.exec.threads=100\n-\n-# worker heartbeat interval\n-worker.heartbeat.interval=10\n-\n-# submit the number of tasks at a time\n-worker.fetch.task.num = 3\n-\n-\n-# only less than cpu avg load, worker server can work. default value : the number of cpu cores * 2\n-#worker.max.cpuload.avg=10\n-\n-# only larger than reserved memory, worker server can work. default value : physical memory * 1/6, unit is G.\n-worker.reserved.memory=1\n\\ No newline at end of file",
                "changes": 32
            },
            {
                "status": "modified",
                "additions": 4,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/variablesView.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/variablesView.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/variablesView.vue",
                "deletions": 3,
                "sha": "1fe4bff5a875683803e016b02ed86b10c1d109f8",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/variablesView.vue",
                "patch": "@@ -25,6 +25,7 @@\n                     size=\"xsmall\"\n                     type=\"ghost\"\n                     @click=\"_copy('gbudp-' + $index)\"\n+                    :key=\"$index\"\n                     :data-clipboard-text=\"item.prop + ' = ' +item.value\"\n                     :class=\"'gbudp-' + $index\">\n               <b style=\"color: #2A455B;\">{{item.prop}}</b> = {{item.value}}\n@@ -38,12 +39,12 @@\n           &nbsp;\n         </div>\n       </div>\n-      <div class=\"list list-t\" v-for=\"(item,key,$index) in list.localParams\">\n+      <div class=\"list list-t\" v-for=\"(item,key,$index) in list.localParams\" :key=\"$index\">\n         <div class=\"task-name\">Task({{$index}})\uff1a{{key}}</div>\n         <div class=\"var-cont\" v-if=\"item.localParamsList.length\">\n           <template v-for=\"(el,index) in item.localParamsList\">\n-            <x-button size=\"xsmall\" type=\"ghost\" @click=\"_copy('copy-part-' + index)\" :data-clipboard-text=\"_rtClipboard(el,item.taskType)\" :class=\"'copy-part-' + index\">\n-              <span v-for=\"(e,k,i) in el\">\n+            <x-button size=\"xsmall\" type=\"ghost\" :key=\"index\" @click=\"_copy('copy-part-' + index)\" :data-clipboard-text=\"_rtClipboard(el,item.taskType)\" :class=\"'copy-part-' + index\">\n+              <span v-for=\"(e,k,i) in el\" :key=\"i\">\n                 <template v-if=\"item.taskType === 'SQL' || item.taskType === 'PROCEDURE'\">\n                   <template v-if=\"(k !== 'direct' && k !== 'type')\">\n                     <b style=\"color: #2A455B;\">{{k}}</b> = {{e}}",
                "changes": 7
            },
            {
                "status": "modified",
                "additions": 7,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/_source/createDataSource.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/_source/createDataSource.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/_source/createDataSource.vue",
                "deletions": 1,
                "sha": "8c55887dab347e219682906705ad88c5d9d3e9d8",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/_source/createDataSource.vue",
                "patch": "@@ -32,6 +32,7 @@\n               <x-radio :label=\"'CLICKHOUSE'\">CLICKHOUSE</x-radio>\n               <x-radio :label=\"'ORACLE'\">ORACLE</x-radio>\n               <x-radio :label=\"'SQLSERVER'\">SQLSERVER</x-radio>\n+              <x-radio :label=\"'DB2'\" class=\"radio-label-last\" >DB2</x-radio>\n             </x-radio-group>\n           </template>\n         </m-list-box-f>\n@@ -362,7 +363,7 @@\n         })\n       }\n     },\n-    \n+\n     mounted () {\n     },\n     components: { mPopup, mListBoxF }\n@@ -402,5 +403,10 @@\n         }\n       }\n     }\n+    .radio-label-last {\n+      margin-left: 0px !important;\n+    }\n   }\n+\n+\n </style>",
                "changes": 8
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/db.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/db.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/db.vue",
                "deletions": 1,
                "sha": "8147251eea6db7f5472563f65b03b145cc29ef28",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/db.vue",
                "patch": "@@ -17,7 +17,7 @@\n <template>\n   <div>\n     <div class=\"servers-wrapper mysql-model content-wrap\" v-show=\"mysqlList.length\">\n-      <div class=\"row\" v-for=\"(item,$index) in mysqlList\">\n+      <div class=\"row\" v-for=\"(item,$index) in mysqlList\" :key=\"$index\">\n         <div class=\"col-md-12\">\n           <div class=\"db-title\">\n             <span>{{item.dbType+$t('Manage')}}</span>",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/master.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/master.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/master.vue",
                "deletions": 1,
                "sha": "bd760d51cdbcbdcde6b60c30bbf6620d1897db9b",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/master.vue",
                "patch": "@@ -18,7 +18,7 @@\n   <m-list-construction :title=\"'Master ' + $t('Manage')\">\n     <template slot=\"content\">\n       <div class=\"servers-wrapper\" v-show=\"masterList.length\">\n-        <div class=\"row-box\" v-for=\"(item,$index) in masterList\">\n+        <div class=\"row-box\" v-for=\"(item,$index) in masterList\" :key=\"$index\">\n           <div class=\"row-title\">\n             <div class=\"left\">\n               <span class=\"sp\">IP: {{item.host}}</span>",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/worker.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/worker.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/worker.vue",
                "deletions": 1,
                "sha": "f9356285200d253dbc3d1937cbca67af0ade5797",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/worker.vue",
                "patch": "@@ -18,7 +18,7 @@\n   <m-list-construction :title=\"'Worker ' + $t('Manage')\">\n     <template slot=\"content\">\n       <div class=\"servers-wrapper\" v-show=\"workerList.length\">\n-        <div class=\"row-box\" v-for=\"(item,$index) in workerList\">\n+        <div class=\"row-box\" v-for=\"(item,$index) in workerList\" :key=\"$index\">\n           <div class=\"row-title\">\n             <div class=\"left\">\n               <span class=\"sp\">IP: {{item.host}}</span>",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/_source/email.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/_source/email.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/_source/email.vue",
                "deletions": 2,
                "sha": "ba99b14b08c16ac42af36a5cb92fd78e99cb6eba",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/_source/email.vue",
                "patch": "@@ -17,7 +17,7 @@\n <template>\n   <div class=\"ans-input email-model\">\n     <div class=\"clearfix input-element\" :class=\"disabled ? 'disabled' : ''\">\n-      <span class=\"tag-wrapper\" v-for=\"(item,$index) in activeList\" :class=\"activeIndex === $index ? 'active' : ''\">\n+      <span class=\"tag-wrapper\" v-for=\"(item,$index) in activeList\" :key=\"$index\" :class=\"activeIndex === $index ? 'active' : ''\">\n         <span class=\"tag-text\">{{item}}</span>\n         <i class=\"remove-tag ans-icon-close\" @click.stop=\"_del($index)\" v-if=\"!disabled\"></i>\n       </span>\n@@ -31,7 +31,7 @@\n           <div class=\"ans-scroller\" style=\" max-height: 300px;\">\n             <div class=\"scroll-area-wrapper scroll-transition\">\n               <ul class=\"dropdown-container\">\n-                <li class=\"ans-option\" v-for=\"(item,$index) in emailList\" @click.stop=\"_selectEmail($index + 1)\">\n+                <li class=\"ans-option\" v-for=\"(item,$index) in emailList\" @click.stop=\"_selectEmail($index + 1)\" :key=\"$index\">\n                   <span class=\"default-option-class\" :class=\"index === ($index + 1) ? 'active' : ''\">{{item}}</span>\n                 </li>\n               </ul>",
                "changes": 4
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/tree/index.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/tree/index.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/tree/index.vue",
                "deletions": 2,
                "sha": "94b0485a39be85ea766d1417d6a0cd4b51f2be2d",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/tree/index.vue",
                "patch": "@@ -42,7 +42,7 @@\n             <a href=\"javascript:\">\n               <span>Node Type</span>\n             </a>\n-            <a href=\"javascript:\" v-for=\"(k,v) in tasksType\">\n+            <a href=\"javascript:\" v-for=\"(k,v) in tasksType\" :key=\"v\">\n               <i class=\"fa fa-circle\" :style=\"{color:k.color}\"></i>\n               <span>{{v}}</span>\n             </a>\n@@ -51,7 +51,7 @@\n             <a href=\"javascript:\">\n               <span>{{$t('Task Status')}}</span>\n             </a>\n-            <a href=\"javascript:\" v-for=\"(item) in tasksState\">\n+            <a href=\"javascript:\" v-for=\"(item) in tasksState\" :key=\"item.id\">\n               <i class=\"fa fa-square\" :style=\"{color:item.color}\"></i>\n               <span>{{item.desc}}</span>\n             </a>",
                "changes": 4
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/gantt/index.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/gantt/index.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/gantt/index.vue",
                "deletions": 1,
                "sha": "8260998b1726bc5569a71fc591f52f9598341133",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/gantt/index.vue",
                "patch": "@@ -23,7 +23,7 @@\n             <a href=\"javascript:\">\n               <span>{{$t('Task Status')}}</span>\n             </a>\n-            <a href=\"javascript:\" v-for=\"(item) in tasksState\">\n+            <a href=\"javascript:\" v-for=\"(item) in tasksState\" :key=\"item.id\">\n               <i class=\"fa fa-square\" :style=\"{color:item.color}\"></i>\n               <span>{{item.desc}}</span>\n             </a>",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue",
                "deletions": 1,
                "sha": "ec4efeed3afdd326b4e1594f1591c693a61cac34",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue",
                "patch": "@@ -123,7 +123,7 @@\n               }\n             })\n             this.$nextTick(() => {\n-              this.queueId = this.queueList[0]\n+              this.queueId = this.queueList[0].id\n             })\n             resolve()\n           })",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 5,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/store/dag/state.js",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/conf/home/store/dag/state.js?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/conf/home/store/dag/state.js",
                "deletions": 0,
                "sha": "9eb4d74d6b3e1d3cace925f4693e75971d1716b4",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/conf/home/store/dag/state.js",
                "patch": "@@ -87,6 +87,11 @@ export default {\n       id: 6,\n       code: 'SQLSERVER',\n       disabled: false\n+    },\n+    {\n+      id: 7,\n+      code: 'DB2',\n+      disabled: false\n     }\n   ],\n   // Alarm interface",
                "changes": 5
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/module/components/secondaryMenu/secondaryMenu.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/module/components/secondaryMenu/secondaryMenu.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/module/components/secondaryMenu/secondaryMenu.vue",
                "deletions": 1,
                "sha": "8c09bfb3262db41679bf1dc124a3d0bee5947c0f",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/module/components/secondaryMenu/secondaryMenu.vue",
                "patch": "@@ -44,7 +44,7 @@\n         </template>\n         <ul v-if=\"item.isOpen && item.children.length\">\n           <template v-for=\"(el,index) in item.children\">\n-            <router-link :to=\"{ name: el.path}\" tag=\"li\" active-class=\"active\" v-if=\"el.disabled\">\n+            <router-link :to=\"{ name: el.path}\" tag=\"li\" active-class=\"active\" v-if=\"el.disabled\" :key=\"index\">\n               <span>{{el.name}}</span>\n             </router-link>\n           </template>",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/module/components/transfer/transfer.vue",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/dolphinscheduler-ui/src/js/module/components/transfer/transfer.vue?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "dolphinscheduler-ui/src/js/module/components/transfer/transfer.vue",
                "deletions": 2,
                "sha": "97780b48186bcfba21b53f1f5b26eadb7244a645",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/dolphinscheduler-ui/src/js/module/components/transfer/transfer.vue",
                "patch": "@@ -36,7 +36,7 @@\n           </div>-->\n           <div class=\"scrollbar tf-content\">\n             <ul>\n-              <li v-for=\"(item,$index) in sourceList\" :key=\"item.id\" @click=\"_ckSource(item)\">\n+              <li v-for=\"(item,$index) in sourceList\" :key=\"$index\" @click=\"_ckSource(item)\">\n                 <span>{{item.name}}</span>\n                 <a href=\"javascript:\"></a>\n               </li>\n@@ -62,7 +62,7 @@\n           </div>-->\n           <div class=\"scrollbar tf-content\">\n             <ul>\n-              <li v-for=\"(item,$index) in targetList\" :key=\"item.id\" @click=\"_ckTarget(item)\"><span>{{item.name}}</span></li>\n+              <li v-for=\"(item,$index) in targetList\" :key=\"$index\" @click=\"_ckTarget(item)\"><span>{{item.name}}</span></li>\n             </ul>\n           </div>\n         </div>",
                "changes": 4
            },
            {
                "status": "modified",
                "additions": 0,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/install.sh",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/install.sh?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "install.sh",
                "deletions": 12,
                "sha": "3699974e00e69a6e88167b5266725c4b87501c54",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/install.sh",
                "patch": "@@ -386,19 +386,7 @@ sed -i ${txt} \"s#zookeeper.connection.timeout.*#zookeeper.connection.timeout=${z\n sed -i ${txt} \"s#zookeeper.retry.sleep.*#zookeeper.retry.sleep=${zkRetrySleep}#g\" conf/zookeeper.properties\n sed -i ${txt} \"s#zookeeper.retry.maxtime.*#zookeeper.retry.maxtime=${zkRetryMaxtime}#g\" conf/zookeeper.properties\n \n-sed -i ${txt} \"s#master.exec.threads.*#master.exec.threads=${masterExecThreads}#g\" conf/master.properties\n-sed -i ${txt} \"s#master.exec.task.number.*#master.exec.task.number=${masterExecTaskNum}#g\" conf/master.properties\n-sed -i ${txt} \"s#master.heartbeat.interval.*#master.heartbeat.interval=${masterHeartbeatInterval}#g\" conf/master.properties\n-sed -i ${txt} \"s#master.task.commit.retryTimes.*#master.task.commit.retryTimes=${masterTaskCommitRetryTimes}#g\" conf/master.properties\n-sed -i ${txt} \"s#master.task.commit.interval.*#master.task.commit.interval=${masterTaskCommitInterval}#g\" conf/master.properties\n-sed -i ${txt} \"s#master.reserved.memory.*#master.reserved.memory=${masterReservedMemory}#g\" conf/master.properties\n sed -i ${txt} \"s#server.port.*#server.port=${masterPort}#g\" conf/application-master.properties\n-\n-\n-sed -i ${txt} \"s#worker.exec.threads.*#worker.exec.threads=${workerExecThreads}#g\" conf/worker.properties\n-sed -i ${txt} \"s#worker.heartbeat.interval.*#worker.heartbeat.interval=${workerHeartbeatInterval}#g\" conf/worker.properties\n-sed -i ${txt} \"s#worker.fetch.task.num.*#worker.fetch.task.num=${workerFetchTaskNum}#g\" conf/worker.properties\n-sed -i ${txt} \"s#worker.reserved.memory.*#worker.reserved.memory=${workerReservedMemory}#g\" conf/worker.properties\n sed -i ${txt} \"s#server.port.*#server.port=${workerPort}#g\" conf/application-worker.properties\n \n ",
                "changes": 12
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/incubator-dolphinscheduler/raw/a5277827f23f9e4181c8a70c8501f91db3d4a974/pom.xml",
                "contents_url": "https://api.github.com/repos/apache/incubator-dolphinscheduler/contents/pom.xml?ref=a5277827f23f9e4181c8a70c8501f91db3d4a974",
                "filename": "pom.xml",
                "deletions": 0,
                "sha": "b28eb0026a15dea26c2837cc772c307477e30427",
                "blob_url": "https://github.com/apache/incubator-dolphinscheduler/blob/a5277827f23f9e4181c8a70c8501f91db3d4a974/pom.xml",
                "patch": "@@ -109,6 +109,7 @@\n \t\t<maven-source-plugin.version>2.4</maven-source-plugin.version>\n \t\t<maven-surefire-plugin.version>2.18.1</maven-surefire-plugin.version>\n \t\t<jacoco.version>0.8.4</jacoco.version>\n+\t\t<jcip.version>1.0</jcip.version>\n \t\t<maven.deploy.skip>false</maven.deploy.skip>\n \t</properties>\n \n@@ -517,6 +518,7 @@\n \t\t\t\t</plugin>\n \n \t\t\t\t<plugin>\n+\t\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n \t\t\t\t\t<artifactId>maven-assembly-plugin</artifactId>\n \t\t\t\t\t<version>${maven-assembly-plugin.version}</version>\n \t\t\t\t</plugin>",
                "changes": 2
            }
        ],
        "unit_tests": [
            "OSUtilsTest.java",
            "UsersServiceTest.java",
            "ResourcesServiceTest.java",
            "DataSourceServiceTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "dolphinscheduler-common/src/test/java/org/apache/dolphinscheduler/common/os/OSUtilsTest.java",
        "buggy_files": [
            "pom.xml",
            "dolphinscheduler-common/pom.xml",
            "dolphinscheduler-ui/pom.xml",
            "dolphinscheduler-dist/pom.xml",
            "dolphinscheduler-dist/dolphinscheduler-front/pom.xml",
            "dolphinscheduler-dist/dolphinscheduler-backend/pom.xml",
            "dolphinscheduler-dist/dolphinscheduler-src/pom.xml",
            "dolphinscheduler-rpc/pom.xml",
            "dolphinscheduler-dao/pom.xml",
            "dolphinscheduler-server/pom.xml",
            "dolphinscheduler-api/pom.xml",
            "dolphinscheduler-alert/pom.xml",
            "dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/variablesView.vue",
            "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/ResourcesService.java",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/_source/email.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/index/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/gantt/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/list/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/instance/pages/details/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/list/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/_source/instanceConditions/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/_source/taskRecordList/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/timing/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/taskInstance/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/taskRecord/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/historyTaskRecord/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/create/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/list/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/tree/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/pages/details/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/projects/pages/definition/timing/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/dag/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/variable/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/dag/_source/startingParam/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/monitor/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/udf/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/udf/pages/resource/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/udf/pages/function/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/file/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/file/pages/edit/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/file/pages/create/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/file/pages/list/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/resource/pages/file/pages/details/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/user/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/user/pages/token/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/user/pages/account/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/user/pages/password/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/datasource/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/home/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/token/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/warningGroups/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/queue/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/workerGroups/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/index.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/users/index.vue",
            "install.sh",
            "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/worker.vue",
            "dolphinscheduler-ui/src/js/conf/home/pages/datasource/pages/list/_source/createDataSource.vue",
            "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/DataSourceService.java",
            "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/master.vue",
            "dolphinscheduler-ui/src/js/conf/home/store/projects/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/dag/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/monitor/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/resource/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/user/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/datasource/state.js",
            "dolphinscheduler-ui/src/js/conf/home/store/security/state.js",
            "dolphinscheduler-ui/src/js/conf/home/pages/security/pages/tenement/_source/createTenement.vue",
            "dolphinscheduler-common/src/main/java/org/apache/dolphinscheduler/common/utils/OSUtils.java",
            "dolphinscheduler-ui/src/js/conf/home/pages/monitor/pages/servers/db.vue",
            "dolphinscheduler-ui/src/js/module/components/secondaryMenu/secondaryMenu.vue",
            "dolphinscheduler-ui/src/js/module/components/transfer/transfer.vue",
            "dolphinscheduler-api/src/main/java/org/apache/dolphinscheduler/api/service/UsersService.java"
        ],
        "fixed": true
    }
]