[
    {
        "repo": "jackrabbit-oak",
        "commit": "https://github.com/apache/jackrabbit-oak/commit/10be946c533730a583434791c64f836861ac6ea6",
        "bug_id": "jackrabbit-oak_10be946",
        "message": "OAK-3951: TimingDocumentStoreWrapper throws NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/jackrabbit/oak/trunk@1727429 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/jackrabbit-oak/commit/0aabaec2eafcb61109307b4721210f2b646f5aa2",
        "patched_files": [
            "TimingDocumentStoreWrapper.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/10be946c533730a583434791c64f836861ac6ea6/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapper.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapper.java?ref=10be946c533730a583434791c64f836861ac6ea6",
                "filename": "oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapper.java",
                "deletions": 1,
                "sha": "414f04a64710f533f11eee031c18f832186e780d",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/10be946c533730a583434791c64f836861ac6ea6/oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapper.java",
                "patch": "@@ -433,7 +433,7 @@ private void log(String message) {\n     private static <T extends Document> int size(List<T> list) {\n         int result = 0;\n         for (T doc : list) {\n-            result += doc.getMemory();\n+            result += size(doc);\n         }\n         return result;\n     }",
                "changes": 2
            },
            {
                "status": "added",
                "additions": 37,
                "raw_url": "https://github.com/apache/jackrabbit-oak/raw/10be946c533730a583434791c64f836861ac6ea6/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapperTest.java",
                "contents_url": "https://api.github.com/repos/apache/jackrabbit-oak/contents/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapperTest.java?ref=10be946c533730a583434791c64f836861ac6ea6",
                "filename": "oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapperTest.java",
                "deletions": 0,
                "sha": "898f98dec0e9c40ce3b6cb92774ed2ec8a1f3ea4",
                "blob_url": "https://github.com/apache/jackrabbit-oak/blob/10be946c533730a583434791c64f836861ac6ea6/oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapperTest.java",
                "patch": "@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.jackrabbit.oak.plugins.document.util;\n+\n+import java.util.Collections;\n+\n+import org.apache.jackrabbit.oak.plugins.document.Collection;\n+import org.apache.jackrabbit.oak.plugins.document.Document;\n+import org.apache.jackrabbit.oak.plugins.document.DocumentStore;\n+import org.apache.jackrabbit.oak.plugins.document.UpdateOp;\n+import org.apache.jackrabbit.oak.plugins.document.memory.MemoryDocumentStore;\n+import org.junit.Test;\n+\n+public class TimingDocumentStoreWrapperTest {\n+\n+    @Test\n+    public void createOrUpdate() {\n+        DocumentStore store = new TimingDocumentStoreWrapper(new MemoryDocumentStore());\n+        UpdateOp op = new UpdateOp(\"foo\", true);\n+        op.set(Document.ID, \"foo\");\n+        store.createOrUpdate(Collection.NODES, Collections.singletonList(op));\n+    }\n+}",
                "changes": 37
            }
        ],
        "unit_tests": [
            "TimingDocumentStoreWrapperTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "oak-core/src/test/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapperTest.java",
        "buggy_files": [
            "oak-core/src/main/java/org/apache/jackrabbit/oak/plugins/document/util/TimingDocumentStoreWrapper.java"
        ],
        "fixed": true
    }
]