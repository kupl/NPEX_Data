{
    "incubator-iceberg_281e0d7": {
        "bug_id": "incubator-iceberg_281e0d7",
        "commit": "https://github.com/apache/incubator-iceberg/commit/281e0d779126e11cadea51f423abbf303ce42da9",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/incubator-iceberg/blob/281e0d779126e11cadea51f423abbf303ce42da9/core/src/main/java/org/apache/iceberg/FindFiles.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/incubator-iceberg/contents/core/src/main/java/org/apache/iceberg/FindFiles.java?ref=281e0d779126e11cadea51f423abbf303ce42da9",
                "deletions": 0,
                "filename": "core/src/main/java/org/apache/iceberg/FindFiles.java",
                "patch": "@@ -191,6 +191,12 @@ public Builder inPartitions(PartitionSpec spec, List<StructLike> partitions) {\n       Snapshot snapshot = snapshotId != null ?\n           ops.current().snapshot(snapshotId) : ops.current().currentSnapshot();\n \n+      // snapshot could be null when the table just gets created\n+      if (snapshot == null) {\n+        return CloseableIterable.empty();\n+      }\n+\n+      // when snapshot is not null\n       CloseableIterable<ManifestEntry> entries = new ManifestGroup(ops, snapshot.manifests())\n           .filterData(rowFilter)\n           .filterFiles(fileFilter)",
                "raw_url": "https://github.com/apache/incubator-iceberg/raw/281e0d779126e11cadea51f423abbf303ce42da9/core/src/main/java/org/apache/iceberg/FindFiles.java",
                "sha": "6c8c71473f92763605d6099caae79e1d53487b45",
                "status": "modified"
            },
            {
                "additions": 11,
                "blob_url": "https://github.com/apache/incubator-iceberg/blob/281e0d779126e11cadea51f423abbf303ce42da9/core/src/test/java/org/apache/iceberg/TestFindFiles.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/incubator-iceberg/contents/core/src/test/java/org/apache/iceberg/TestFindFiles.java?ref=281e0d779126e11cadea51f423abbf303ce42da9",
                "deletions": 0,
                "filename": "core/src/test/java/org/apache/iceberg/TestFindFiles.java",
                "patch": "@@ -153,6 +153,17 @@ public void testCaseSensitivity() {\n     Assert.assertEquals(pathSet(FILE_A), pathSet(files));\n   }\n \n+  @Test\n+  public void testNoSnapshot() {\n+    // a table has no snapshot when it just gets created and no data is loaded yet\n+\n+    // if not handled properly, NPE will be thrown in collect()\n+    Iterable<DataFile> files = FindFiles.in(table).collect();\n+\n+    // verify an empty collection of data file is returned\n+    Assert.assertEquals(0, Sets.newHashSet(files).size());\n+  }\n+\n   private Set<String> pathSet(DataFile... files) {\n     return Sets.newHashSet(Iterables.transform(Arrays.asList(files), file -> file.path().toString()));\n   }",
                "raw_url": "https://github.com/apache/incubator-iceberg/raw/281e0d779126e11cadea51f423abbf303ce42da9/core/src/test/java/org/apache/iceberg/TestFindFiles.java",
                "sha": "01df577859cd9421afee469f7b305378b3838226",
                "status": "modified"
            }
        ],
        "message": "Fix NullPointerException in FindFiles when there is no snapshot (#543)",
        "parent": "https://github.com/apache/incubator-iceberg/commit/4ec95e8f89f7f47ac494668139f922f861d96093",
        "patched_files": [
            "FindFiles.java"
        ],
        "repo": "incubator-iceberg",
        "unit_tests": [
            "TestFindFiles.java"
        ]
    }
}