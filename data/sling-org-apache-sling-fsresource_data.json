[
    {
        "repo": "sling-org-apache-sling-fsresource",
        "message": "SLING-1625 Check File.listFiles() result to prevent NullPointerException\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@981444 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/sling-org-apache-sling-fsresource/commit/3c49c29bdcc1666b95a69d784112be66ae548be4",
        "parent": "https://github.com/apache/sling-org-apache-sling-fsresource/commit/5f50b0393ae1c4e32a7ea31f24ed05e2a2274e99",
        "bug_id": "sling-org-apache-sling-fsresource_1",
        "file": [
            {
                "sha": "336f1c1cdbc9a15934e761deb37fab6cf77f6e32",
                "filename": "src/main/java/org/apache/sling/fsprovider/internal/FileMonitor.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-fsresource/blob/3c49c29bdcc1666b95a69d784112be66ae548be4/src/main/java/org/apache/sling/fsprovider/internal/FileMonitor.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-fsresource/raw/3c49c29bdcc1666b95a69d784112be66ae548be4/src/main/java/org/apache/sling/fsprovider/internal/FileMonitor.java",
                "status": "modified",
                "changes": 45,
                "additions": 28,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-fsresource/contents/src/main/java/org/apache/sling/fsprovider/internal/FileMonitor.java?ref=3c49c29bdcc1666b95a69d784112be66ae548be4",
                "patch": "@@ -163,22 +163,28 @@ private void check(final Monitorable monitorable, final EventAdmin localEA) {\n                     if ( changed ) {\n                         // and now update\n                         final File[] files = monitorable.file.listFiles();\n-                        final Monitorable[] children = new Monitorable[files.length];\n-                        for(int i=0; i<files.length; i++) {\n-                            // search in old list\n-                            for(int m=0;m<ds.children.length;m++) {\n-                                if ( ds.children[m].file.equals(files[i]) ) {\n-                                    children[i] = ds.children[m];\n-                                    break;\n+                        if (files != null) {\n+                            final Monitorable[] children = new Monitorable[files.length];\n+                            for (int i = 0; i < files.length; i++) {\n+                                // search in old list\n+                                for (int m = 0; m < ds.children.length; m++) {\n+                                    if (ds.children[m].file.equals(files[i])) {\n+                                        children[i] = ds.children[m];\n+                                        break;\n+                                    }\n+                                }\n+                                if (children[i] == null) {\n+                                    children[i] = new Monitorable(\n+                                        monitorable.path + '/'\n+                                            + files[i].getName(), files[i]);\n+                                    children[i].status = NonExistingStatus.SINGLETON;\n+                                    check(children[i], localEA);\n                                 }\n                             }\n-                            if ( children[i] == null ) {\n-                                children[i] = new Monitorable(monitorable.path + '/' + files[i].getName(), files[i]);\n-                                children[i].status = NonExistingStatus.SINGLETON;\n-                                check(children[i], localEA);\n-                            }\n+                            ds.children = children;\n+                        } else {\n+                            ds.children = new Monitorable[0];\n                         }\n-                        ds.children = children;\n                     }\n                 }\n             }\n@@ -241,10 +247,15 @@ public FileStatus(final File file) {\n         public DirStatus(final File dir, final String path) {\n             super(dir);\n             final File[] files = dir.listFiles();\n-            this.children = new Monitorable[files.length];\n-            for(int i=0; i<files.length; i++) {\n-                this.children[i] = new Monitorable(path + '/' + files[i].getName(), files[i]);\n-                FileMonitor.createStatus(this.children[i]);\n+            if (files != null) {\n+                this.children = new Monitorable[files.length];\n+                for (int i = 0; i < files.length; i++) {\n+                    this.children[i] = new Monitorable(path + '/'\n+                        + files[i].getName(), files[i]);\n+                    FileMonitor.createStatus(this.children[i]);\n+                }\n+            } else {\n+                this.children = new Monitorable[0];\n             }\n         }\n     }",
                "deletions": 17
            }
        ]
    },
    {
        "repo": "sling-org-apache-sling-fsresource",
        "message": "SLING-6869 fsresource: Avoid NPE when content fragment file contains invalid JSON\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@1795847 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/sling-org-apache-sling-fsresource/commit/41394c6e88d9e5d7b99cb89840a32c073bec8ed7",
        "parent": "https://github.com/apache/sling-org-apache-sling-fsresource/commit/5077302b6a48122dbf0f6779269533c11f4f7de4",
        "bug_id": "sling-org-apache-sling-fsresource_2",
        "file": [
            {
                "sha": "184d184fec2b4d551a7af4bd906bf306e4f5fdb7",
                "filename": "src/main/java/org/apache/sling/fsprovider/internal/mapper/ContentFile.java",
                "blob_url": "https://github.com/apache/sling-org-apache-sling-fsresource/blob/41394c6e88d9e5d7b99cb89840a32c073bec8ed7/src/main/java/org/apache/sling/fsprovider/internal/mapper/ContentFile.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-fsresource/raw/41394c6e88d9e5d7b99cb89840a32c073bec8ed7/src/main/java/org/apache/sling/fsprovider/internal/mapper/ContentFile.java",
                "status": "modified",
                "changes": 2,
                "additions": 1,
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-fsresource/contents/src/main/java/org/apache/sling/fsprovider/internal/mapper/ContentFile.java?ref=41394c6e88d9e5d7b99cb89840a32c073bec8ed7",
                "patch": "@@ -84,7 +84,7 @@ public ContentElement getContent() {\n             if (subPath == null) {\n                 content = rootContent;\n             }\n-            else {\n+            else if (rootContent != null) {\n                 content = rootContent.getChild(subPath);\n             }\n             contentInitialized = true;",
                "deletions": 1
            }
        ]
    }
]