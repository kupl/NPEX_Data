[
    {
        "repo": "maven-indexer",
        "message": "MINDEXER-26: fix for NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/indexer/trunk@1133439 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-indexer/commit/7f7b5aa3b5f7a296fe04fe134d95606e56e04f3b",
        "parent": "https://github.com/apache/maven-indexer/commit/5f320f1465295074f37dfffe32721e9ace1bf9c7",
        "bug_id": "maven-indexer_1",
        "file": [
            {
                "sha": "94c64def9971fb159073262a553e06e4bc517c1a",
                "filename": "indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "blob_url": "https://github.com/apache/maven-indexer/blob/7f7b5aa3b5f7a296fe04fe134d95606e56e04f3b/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "raw_url": "https://github.com/apache/maven-indexer/raw/7f7b5aa3b5f7a296fe04fe134d95606e56e04f3b/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "status": "modified",
                "changes": 39,
                "additions": 21,
                "contents_url": "https://api.github.com/repos/apache/maven-indexer/contents/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java?ref=7f7b5aa3b5f7a296fe04fe134d95606e56e04f3b",
                "patch": "@@ -351,35 +351,38 @@ private void storeDescriptor()\n     private void deleteIndexFiles( boolean full )\n         throws IOException\n     {\n-        String[] names = indexDirectory.listAll();\n-\n-        if ( names != null )\n+        if ( indexDirectory != null )\n         {\n-            IndexFileNameFilter filter = IndexFileNameFilter.getFilter();\n+            String[] names = indexDirectory.listAll();\n \n-            for ( int i = 0; i < names.length; i++ )\n+            if ( names != null )\n             {\n-                if ( filter.accept( null, names[i] ) )\n+                IndexFileNameFilter filter = IndexFileNameFilter.getFilter();\n+\n+                for ( int i = 0; i < names.length; i++ )\n                 {\n-                    indexDirectory.deleteFile( names[i] );\n+                    if ( filter.accept( null, names[i] ) )\n+                    {\n+                        indexDirectory.deleteFile( names[i] );\n+                    }\n                 }\n             }\n-        }\n \n-        if ( full )\n-        {\n-            if ( indexDirectory.fileExists( INDEX_PACKER_PROPERTIES_FILE ) )\n+            if ( full )\n             {\n-                indexDirectory.deleteFile( INDEX_PACKER_PROPERTIES_FILE );\n-            }\n+                if ( indexDirectory.fileExists( INDEX_PACKER_PROPERTIES_FILE ) )\n+                {\n+                    indexDirectory.deleteFile( INDEX_PACKER_PROPERTIES_FILE );\n+                }\n \n-            if ( indexDirectory.fileExists( INDEX_UPDATER_PROPERTIES_FILE ) )\n-            {\n-                indexDirectory.deleteFile( INDEX_UPDATER_PROPERTIES_FILE );\n+                if ( indexDirectory.fileExists( INDEX_UPDATER_PROPERTIES_FILE ) )\n+                {\n+                    indexDirectory.deleteFile( INDEX_UPDATER_PROPERTIES_FILE );\n+                }\n             }\n-        }\n \n-        IndexUtils.deleteTimestamp( indexDirectory );\n+            IndexUtils.deleteTimestamp( indexDirectory );\n+        }\n     }\n \n     public boolean isSearchable()",
                "deletions": 18
            }
        ]
    },
    {
        "repo": "maven-indexer",
        "message": "MINDEXER-71 Do not implicitly close indexing context\n\nIndexing context #rollback, #commit and #optimize operations\nwere implicitely closing indexing context in case of\nIOException and CorruptIndexException. This behaviour is\ncounter-intuitive. It is also harmful when triggered\nfrom within acquireIndexSearcher-finally-releaseIndexSearcher\nblock, in which case releaseIndexSearcher fails with NPE,\nwhich in turn masks original exception and makes \ntroubleshooting of the problem much harder than it should be.\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/indexer/trunk@1451310 13f79535-47bb-0310-9956-ffa450edef68",
        "commit": "https://github.com/apache/maven-indexer/commit/d2142395a458d751ca08195d0cf2cc47453a3a62",
        "parent": "https://github.com/apache/maven-indexer/commit/2745236a3e32c9c496a20d90abdf47ca9eaabf25",
        "bug_id": "maven-indexer_2",
        "file": [
            {
                "sha": "dda3b1834121d34c6ae639305b00c43b1295313a",
                "filename": "indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "blob_url": "https://github.com/apache/maven-indexer/blob/d2142395a458d751ca08195d0cf2cc47453a3a62/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "raw_url": "https://github.com/apache/maven-indexer/raw/d2142395a458d751ca08195d0cf2cc47453a3a62/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java",
                "status": "modified",
                "changes": 47,
                "additions": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-indexer/contents/indexer-core/src/main/java/org/apache/maven/index/context/DefaultIndexingContext.java?ref=d2142395a458d751ca08195d0cf2cc47453a3a62",
                "patch": "@@ -512,59 +512,20 @@ public void releaseIndexSearcher( final IndexSearcher is )\n     public void commit()\n         throws IOException\n     {\n-        try\n-        {\n-            getIndexWriter().commit();\n-        }\n-        catch ( CorruptIndexException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n-        catch ( IOException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n+        getIndexWriter().commit();\n     }\n \n     public void rollback()\n         throws IOException\n     {\n-        try\n-        {\n-            getIndexWriter().rollback();\n-        }\n-        catch ( CorruptIndexException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n-        catch ( IOException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n+        getIndexWriter().rollback();\n     }\n \n     public synchronized void optimize()\n         throws CorruptIndexException, IOException\n     {\n-        try\n-        {\n-            getIndexWriter().optimize();\n-            commit();\n-        }\n-        catch ( CorruptIndexException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n-        catch ( IOException e )\n-        {\n-            close( false );\n-            throw e;\n-        }\n+        getIndexWriter().optimize();\n+        commit();\n     }\n \n     public synchronized void close( boolean deleteFiles )",
                "deletions": 43
            }
        ]
    }
]