[
    {
        "repo": "commons-dbcp",
        "commit": "https://github.com/apache/commons-dbcp/commit/b137fda65be70c4431a7a09ca379e40a300760e1",
        "bug_id": "commons-dbcp_b137fda",
        "message": "Avoid NPE when calling DriverAdapterCPDS.toString() (#31)\n\n* Add test for DriverAdapterCPDS.toString()\r\n\r\nIt currently fails when connectionProperties are null\r\n\r\n* Do not access connectionProperties when it's null",
        "parent": "https://github.com/apache/commons-dbcp/commit/2ee3c53e75e9ad899ed2aa06bfd882ebeea7b4a2",
        "patched_files": [
            "DriverAdapterCPDS.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-dbcp/raw/b137fda65be70c4431a7a09ca379e40a300760e1/src/main/java/org/apache/commons/dbcp2/cpdsadapter/DriverAdapterCPDS.java",
                "contents_url": "https://api.github.com/repos/apache/commons-dbcp/contents/src/main/java/org/apache/commons/dbcp2/cpdsadapter/DriverAdapterCPDS.java?ref=b137fda65be70c4431a7a09ca379e40a300760e1",
                "filename": "src/main/java/org/apache/commons/dbcp2/cpdsadapter/DriverAdapterCPDS.java",
                "deletions": 1,
                "sha": "e80d69c4e8f36b411516e63ab09921c913c4cb08",
                "blob_url": "https://github.com/apache/commons-dbcp/blob/b137fda65be70c4431a7a09ca379e40a300760e1/src/main/java/org/apache/commons/dbcp2/cpdsadapter/DriverAdapterCPDS.java",
                "patch": "@@ -765,7 +765,7 @@ public synchronized String toString() {\n         builder.append(\", connectionProperties=\");\n         Properties tmpProps = connectionProperties;\n         final String pwdKey = \"password\";\n-        if (connectionProperties.contains(pwdKey)) {\n+        if (connectionProperties != null && connectionProperties.contains(pwdKey)) {\n             tmpProps = (Properties) connectionProperties.clone();\n             tmpProps.remove(pwdKey);\n         }",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 12,
                "raw_url": "https://github.com/apache/commons-dbcp/raw/b137fda65be70c4431a7a09ca379e40a300760e1/src/test/java/org/apache/commons/dbcp2/cpdsadapter/TestDriverAdapterCPDS.java",
                "contents_url": "https://api.github.com/repos/apache/commons-dbcp/contents/src/test/java/org/apache/commons/dbcp2/cpdsadapter/TestDriverAdapterCPDS.java?ref=b137fda65be70c4431a7a09ca379e40a300760e1",
                "filename": "src/test/java/org/apache/commons/dbcp2/cpdsadapter/TestDriverAdapterCPDS.java",
                "deletions": 0,
                "sha": "ab0a4dd8dc5de2d57aab23c50311f377b6588d6b",
                "blob_url": "https://github.com/apache/commons-dbcp/blob/b137fda65be70c4431a7a09ca379e40a300760e1/src/test/java/org/apache/commons/dbcp2/cpdsadapter/TestDriverAdapterCPDS.java",
                "patch": "@@ -367,4 +367,16 @@ public void testGetObjectInstanceChangeDescription() throws Exception {\n         final Object o = pcds.getObjectInstance(ref, null, null, null);\n         assertEquals(pcds.getDescription(), ((DriverAdapterCPDS) o).getDescription());\n     }\n+    \n+    @Test\n+    public void testToStringWithoutConnectionProperties() throws ClassNotFoundException\n+    {\n+        final DriverAdapterCPDS cleanCpds = new DriverAdapterCPDS();\n+        cleanCpds.setDriver( \"org.apache.commons.dbcp2.TesterDriver\" );\n+        cleanCpds.setUrl( \"jdbc:apache:commons:testdriver\" );\n+        cleanCpds.setUser( \"foo\" );\n+        cleanCpds.setPassword( \"bar\" );\n+\n+        cleanCpds.toString();\n+    }\n }",
                "changes": 12
            }
        ],
        "unit_tests": [
            "TestDriverAdapterCPDS.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/org/apache/commons/dbcp2/cpdsadapter/TestDriverAdapterCPDS.java",
        "buggy_files": [
            "src/main/java/org/apache/commons/dbcp2/cpdsadapter/DriverAdapterCPDS.java"
        ],
        "fixed": true
    }
]