[
    {
        "repo": "logging-log4j2",
        "commit": "https://github.com/apache/logging-log4j2/commit/f8a421972a4858bf2026d757f5d1bea7c1062a35",
        "bug_id": "logging-log4j2_f8a4219",
        "message": "[LOG4J2-914] ThrowableProxy.getExtendedStackTraceAsString causes\nNullpointerException.",
        "parent": "https://github.com/apache/logging-log4j2/commit/683c913973f6e5aefa4221dc0ab382ef6e2ebe7c",
        "patched_files": [
            "changes.xml",
            "ThrowableProxy.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/logging-log4j2/raw/f8a421972a4858bf2026d757f5d1bea7c1062a35/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java",
                "contents_url": "https://api.github.com/repos/apache/logging-log4j2/contents/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java?ref=f8a421972a4858bf2026d757f5d1bea7c1062a35",
                "filename": "log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java",
                "deletions": 1,
                "sha": "1d3af2a0677a85bfb96eecc8eb52c9aa66aa35ba",
                "blob_url": "https://github.com/apache/logging-log4j2/blob/f8a421972a4858bf2026d757f5d1bea7c1062a35/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java",
                "patch": "@@ -342,7 +342,8 @@ public String getExtendedStackTraceAsString(final List<String> ignorePackages) {\n             sb.append(\": \").append(msg);\n         }\n         sb.append(EOL);\n-        this.formatElements(sb, 0, this.throwable.getStackTrace(), this.extendedStackTrace, ignorePackages);\n+        StackTraceElement[] causedTrace = this.throwable != null ? this.throwable.getStackTrace() : null;\n+        this.formatElements(sb, 0, causedTrace, this.extendedStackTrace, ignorePackages);\n         this.formatCause(sb, this.causeProxy, ignorePackages);\n         return sb.toString();\n     }",
                "changes": 3
            },
            {
                "status": "modified",
                "additions": 10,
                "raw_url": "https://github.com/apache/logging-log4j2/raw/f8a421972a4858bf2026d757f5d1bea7c1062a35/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java",
                "contents_url": "https://api.github.com/repos/apache/logging-log4j2/contents/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java?ref=f8a421972a4858bf2026d757f5d1bea7c1062a35",
                "filename": "log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java",
                "deletions": 0,
                "sha": "850f5fb20f6c88a411ee0eef0611b60c8b1bcd2e",
                "blob_url": "https://github.com/apache/logging-log4j2/blob/f8a421972a4858bf2026d757f5d1bea7c1062a35/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java",
                "patch": "@@ -136,6 +136,16 @@ public void testSerialization() throws Exception {\n         assertArrayEquals(proxy.getExtendedStackTrace(), proxy2.getExtendedStackTrace());\n     }\n \n+    @Test\n+    public void testSerialization_getExtendedStackTraceAsString() throws Exception {\n+        final Throwable throwable = new IllegalArgumentException(\"This is a test\");\n+        final ThrowableProxy proxy = new ThrowableProxy(throwable);\n+        final byte[] binary = serialize(proxy);\n+        final ThrowableProxy proxy2 = deserialize(binary);\n+\n+        assertEquals(proxy.getExtendedStackTraceAsString(), proxy2.getExtendedStackTraceAsString());\n+    }\n+\n     @Test\n     public void testSerializationWithUnknownThrowable() throws Exception {\n ",
                "changes": 10
            },
            {
                "status": "modified",
                "additions": 3,
                "raw_url": "https://github.com/apache/logging-log4j2/raw/f8a421972a4858bf2026d757f5d1bea7c1062a35/src/changes/changes.xml",
                "contents_url": "https://api.github.com/repos/apache/logging-log4j2/contents/src/changes/changes.xml?ref=f8a421972a4858bf2026d757f5d1bea7c1062a35",
                "filename": "src/changes/changes.xml",
                "deletions": 0,
                "sha": "fe61725eed0e2a2a5fbf2ef881f99ae48d83f23c",
                "blob_url": "https://github.com/apache/logging-log4j2/blob/f8a421972a4858bf2026d757f5d1bea7c1062a35/src/changes/changes.xml",
                "patch": "@@ -32,6 +32,9 @@\n         Specify the SocketAppender connect timeout value as part of the configuration.\n         The new appender takes a new parameter connectTimeoutMillis.\n       </action>\n+      <action issue=\"LOG4J2-914\" dev=\"ggregory\" type=\"fix\" due-to=\"Kaj Bjurman\">\n+        ThrowableProxy.getExtendedStackTraceAsString causes NullpointerException.\n+      </action>\n       <action issue=\"LOG4J2-912\" dev=\"ggregory\" type=\"fix\">\n         XML configuration does not report full error message for XInclude parser configuration problems.\n       </action>",
                "changes": 3
            }
        ],
        "unit_tests": [
            "ThrowableProxyTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java",
        "buggy_files": [
            "src/changes/changes.xml",
            "log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java"
        ],
        "fixed": true
    }
]