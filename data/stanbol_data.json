[{"commit": "https://github.com/apache/stanbol/commit/0b890af1de94cd3c2b09daeca798b29cde0065e6", "parent": "https://github.com/apache/stanbol/commit/0a00306ab75c3101327073a06bd9e214c36b2a85", "message": "minor (related to STANBOL-878): ValueTypeSerializerRegistry now checks if the Service aquired for the ServiceReference parsed to addService is NULL to avoid possible NPE. While this avoid NPE in the logs it not a functional change as OSGI correctly recovers from such NPE - hence no need for an own issue\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1551157 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_1", "file": [{"additions": 14, "raw_url": "https://github.com/apache/stanbol/raw/0b890af1de94cd3c2b09daeca798b29cde0065e6/enhancer/generic/nlp-json/src/main/java/org/apache/stanbol/enhancer/nlp/json/valuetype/ValueTypeSerializerRegistry.java", "blob_url": "https://github.com/apache/stanbol/blob/0b890af1de94cd3c2b09daeca798b29cde0065e6/enhancer/generic/nlp-json/src/main/java/org/apache/stanbol/enhancer/nlp/json/valuetype/ValueTypeSerializerRegistry.java", "sha": "bd8bb98c2d93f6099584716fd0ba35e767752bad", "changes": 26, "status": "modified", "deletions": 12, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/generic/nlp-json/src/main/java/org/apache/stanbol/enhancer/nlp/json/valuetype/ValueTypeSerializerRegistry.java?ref=0b890af1de94cd3c2b09daeca798b29cde0065e6", "patch": "@@ -168,19 +168,21 @@ private SerializerTracker(BundleContext bc) {\n         @Override\n         public Object addingService(ServiceReference reference) {\n             ValueTypeSerializer<?> service = (ValueTypeSerializer<?>)bc.getService(reference);\n-            serializerLock.writeLock().lock();\n-            try {\n-                List<ServiceReference> refs = valueTypeSerializerRefs.get(service.getType());\n-                if(refs == null){\n-                    refs = new ArrayList<ServiceReference>(2);\n-                    valueTypeSerializerRefs.put(service.getType(), refs);\n-                }\n-                refs.add(reference);\n-                if(refs.size() > 1){\n-                    Collections.sort(refs);\n+            if(service != null){\n+                serializerLock.writeLock().lock();\n+                try {\n+                    List<ServiceReference> refs = valueTypeSerializerRefs.get(service.getType());\n+                    if(refs == null){\n+                        refs = new ArrayList<ServiceReference>(2);\n+                        valueTypeSerializerRefs.put(service.getType(), refs);\n+                    }\n+                    refs.add(reference);\n+                    if(refs.size() > 1){\n+                        Collections.sort(refs);\n+                    }\n+                } finally {\n+                    serializerLock.writeLock().unlock();\n                 }\n-            } finally {\n-                serializerLock.writeLock().unlock();\n             }\n             return service;\n         }", "filename": "enhancer/generic/nlp-json/src/main/java/org/apache/stanbol/enhancer/nlp/json/valuetype/ValueTypeSerializerRegistry.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/e3b1a6e78f9ff0cc9c540b5961e22472abb57eb3", "parent": "https://github.com/apache/stanbol/commit/eaacc681276814e2fc1da5c5bb07894fb4616e31", "message": "avoid NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1089027 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_2", "file": [{"additions": 3, "raw_url": "https://github.com/apache/stanbol/raw/e3b1a6e78f9ff0cc9c540b5961e22472abb57eb3/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java", "blob_url": "https://github.com/apache/stanbol/blob/e3b1a6e78f9ff0cc9c540b5961e22472abb57eb3/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java", "sha": "2ade3ed34b9035ceae42fce9bb566a9ce7abfb93", "changes": 3, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java?ref=e3b1a6e78f9ff0cc9c540b5961e22472abb57eb3", "patch": "@@ -405,6 +405,9 @@ public String getQueryUri() {\n             }\n         }\n         QueryResultList<String> entityIds;\n+        if(entitySearcher == null) {\n+            throw new ReferencedSiteException(String.format(\"EntitySearcher %s not available for remote site %s!\",entitySearcherComponentName,queryUri));\n+        }\n         try {\n             entityIds = entitySearcher.findEntities(query);\n         } catch (IOException e) {", "filename": "entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/2abf185a28448d85b367fefe1dfa922b91a62b65", "parent": "https://github.com/apache/stanbol/commit/22611633b89ad815b5f6cb1070939ce90f76286d", "message": "minor: fixed two NPE in deactivate methods\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1599974 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_3", "file": [{"additions": 1, "raw_url": "https://github.com/apache/stanbol/raw/2abf185a28448d85b367fefe1dfa922b91a62b65/commons/namespaceprefix/service/src/main/java/org/apache/stanbol/commons/namespaceprefix/service/StanbolNamespacePrefixService.java", "blob_url": "https://github.com/apache/stanbol/blob/2abf185a28448d85b367fefe1dfa922b91a62b65/commons/namespaceprefix/service/src/main/java/org/apache/stanbol/commons/namespaceprefix/service/StanbolNamespacePrefixService.java", "sha": "442d18fb3a8e438b480e8814e0a7ff8d24694e60", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/namespaceprefix/service/src/main/java/org/apache/stanbol/commons/namespaceprefix/service/StanbolNamespacePrefixService.java?ref=2abf185a28448d85b367fefe1dfa922b91a62b65", "patch": "@@ -309,12 +309,12 @@ protected NamespacePrefixProvider getService(ServiceReference ref){\n     \n     @Deactivate\n     protected void deactivate(ComponentContext ctx) {\n-        bundleContext = null;\n         if(providersTracker != null) {\n             providersTracker.close();\n             providersTracker = null;\n         }\n         mappingsFile = null;\n+        bundleContext = null;\n     }\n \n     @Override", "filename": "commons/namespaceprefix/service/src/main/java/org/apache/stanbol/commons/namespaceprefix/service/StanbolNamespacePrefixService.java"}, {"additions": 3, "raw_url": "https://github.com/apache/stanbol/raw/2abf185a28448d85b367fefe1dfa922b91a62b65/entityhub/yard/sesame/src/main/java/org/apache/stanbol/entityhub/yard/sesame/impl/SesameYardComponent.java", "blob_url": "https://github.com/apache/stanbol/blob/2abf185a28448d85b367fefe1dfa922b91a62b65/entityhub/yard/sesame/src/main/java/org/apache/stanbol/entityhub/yard/sesame/impl/SesameYardComponent.java", "sha": "17896144ae6c68ea23d5705b0b56ae564b1e7356", "changes": 4, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/yard/sesame/src/main/java/org/apache/stanbol/entityhub/yard/sesame/impl/SesameYardComponent.java?ref=2abf185a28448d85b367fefe1dfa922b91a62b65", "patch": "@@ -224,7 +224,9 @@ public void removedService(ServiceReference serviceReference, Object o) {\n         \tlog.info(\" - currently used Repository was removed (ref: {})\", serviceReference);\n             unregisterSesameYard();\n         }\n-        List<ServiceReference> others = Arrays.asList(repositoryTracker.getServiceReferences());\n+        ServiceReference[] serviceRefs = repositoryTracker.getServiceReferences();\n+        List<ServiceReference> others = serviceRefs == null ? Collections.<ServiceReference>emptyList() :\n+            Arrays.asList(serviceRefs);\n         if(others.size() > 1){\n         \tCollections.sort(others); //sort by priority\n         }", "filename": "entityhub/yard/sesame/src/main/java/org/apache/stanbol/entityhub/yard/sesame/impl/SesameYardComponent.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/b200be159372f852e750a9927930af9779327bc8", "parent": "https://github.com/apache/stanbol/commit/03164bf5229fe95f724eed7bfddb570303278b81", "message": "STANBOL-998: fixed a potential NPE in the updateServiceRegistration method\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1463218 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_4", "file": [{"additions": 6, "raw_url": "https://github.com/apache/stanbol/raw/b200be159372f852e750a9927930af9779327bc8/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteComponent.java", "blob_url": "https://github.com/apache/stanbol/blob/b200be159372f852e750a9927930af9779327bc8/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteComponent.java", "sha": "9d06c12ecf1555f94ed8ae6c534b0a80b3452491", "changes": 10, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteComponent.java?ref=b200be159372f852e750a9927930af9779327bc8", "patch": "@@ -574,10 +574,12 @@ private synchronized void updateServiceRegistration(BundleContext bc,\n             log.info(\" - register ReferencedSite '{}'\",config.getId());\n             try {\n                 referencedSite = new ReferencedSiteImpl(config,\n-                    offlineMode != null ? null : \n-                        (EntityDereferencer)dereferencerComponentInstance.getInstance(),\n-                    offlineMode != null ? null :\n-                        (EntitySearcher)searcherComponentInstance.getInstance(),\n+                    offlineMode == null && dereferencerComponentInstance != null ? \n+                        (EntityDereferencer)dereferencerComponentInstance.getInstance() :\n+                            null,\n+                    offlineMode == null && searcherComponentInstance != null ? \n+                        (EntitySearcher)searcherComponentInstance.getInstance() :\n+                            null,\n                     cache, nsPrefixService);\n                 referencedSiteRegistration = bc.registerService(Site.class.getName(), referencedSite, \n                     OsgiUtils.copyConfig(cc.getProperties()));", "filename": "entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteComponent.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/351c751700127482069b9a50e7ef0c8be4781fb8", "parent": "https://github.com/apache/stanbol/commit/10fa81080960e0fc00e32a85cc733b45f96a0edd", "message": "minor: corrected a possible NPE in logging\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1444349 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_5", "file": [{"additions": 5, "raw_url": "https://github.com/apache/stanbol/raw/351c751700127482069b9a50e7ef0c8be4781fb8/integration-tests/src/test/java/org/apache/stanbol/enhancer/it/MultiThreadedTestBase.java", "blob_url": "https://github.com/apache/stanbol/blob/351c751700127482069b9a50e7ef0c8be4781fb8/integration-tests/src/test/java/org/apache/stanbol/enhancer/it/MultiThreadedTestBase.java", "sha": "0f9de9db53cdb21380325947c73c3ec2650e60ee", "changes": 6, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/integration-tests/src/test/java/org/apache/stanbol/enhancer/it/MultiThreadedTestBase.java?ref=351c751700127482069b9a50e7ef0c8be4781fb8", "patch": "@@ -384,7 +384,11 @@ protected void performTest(TestSettings settings) throws Exception {\n         int i=1;\n         for(Entry<HttpResponse,String> failed :tracker.getFailed().entrySet()){\n             log.warn(\"Failed ({}):\",i);\n-            log.warn(\"  > Status: {}\",failed.getKey().getStatusLine());\n+            if(failed.getKey() != null){\n+                log.warn(\"  > Status: {}\",failed.getKey().getStatusLine());\n+            } else {\n+                log.warn(\" > HttpResponse is NULL\");\n+            }\n             log.warn(\"  > Content: {}\",failed.getValue());\n             i++;\n         }", "filename": "integration-tests/src/test/java/org/apache/stanbol/enhancer/it/MultiThreadedTestBase.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/e6dc2a4498b5fd6ea0029901938e42d6af3f71e0", "parent": "https://github.com/apache/stanbol/commit/ba17c809da9e84d499f51f76d212f97d72fd3e12", "message": "STANBOL-221 Fixed NPE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1140648 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_6", "file": [{"additions": 12, "raw_url": "https://github.com/apache/stanbol/raw/e6dc2a4498b5fd6ea0029901938e42d6af3f71e0/commons/jsonld/src/main/java/org/apache/stanbol/commons/jsonld/JsonLdCommon.java", "blob_url": "https://github.com/apache/stanbol/blob/e6dc2a4498b5fd6ea0029901938e42d6af3f71e0/commons/jsonld/src/main/java/org/apache/stanbol/commons/jsonld/JsonLdCommon.java", "sha": "6fe2819e1696ca749c27b0ced0f5769f353bc8fd", "changes": 20, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/jsonld/src/main/java/org/apache/stanbol/commons/jsonld/JsonLdCommon.java?ref=e6dc2a4498b5fd6ea0029901938e42d6af3f71e0", "patch": "@@ -93,20 +93,24 @@ protected String handleCURIEs(String uri) {\n     }\n \n     public String doCURIE(String uri) {\n-        for (String namespace : namespacePrefixMap.keySet()) {\n-            String prefix = namespacePrefixMap.get(namespace) + \":\";\n-            if (!uri.startsWith(prefix)) {\n-                uri = uri.replace(namespace, prefix);\n+        if (uri != null) {\n+            for (String namespace : namespacePrefixMap.keySet()) {\n+                String prefix = namespacePrefixMap.get(namespace) + \":\";\n+                if (!uri.startsWith(prefix)) {\n+                    uri = uri.replace(namespace, prefix);\n+                }\n             }\n         }\n         return uri;\n     }\n \n     public String unCURIE(String uri) {\n-        for (String namespace : namespacePrefixMap.keySet()) {\n-            String prefix = namespacePrefixMap.get(namespace) + \":\";\n-            if (uri.startsWith(prefix)) {\n-                uri = uri.replace(prefix, namespace);\n+        if (uri != null) {\n+            for (String namespace : namespacePrefixMap.keySet()) {\n+                String prefix = namespacePrefixMap.get(namespace) + \":\";\n+                if (uri.startsWith(prefix)) {\n+                    uri = uri.replace(prefix, namespace);\n+                }\n             }\n         }\n         return uri;", "filename": "commons/jsonld/src/main/java/org/apache/stanbol/commons/jsonld/JsonLdCommon.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/19ee9852de93cd24523219d35912662bd6fbf2e3", "parent": "https://github.com/apache/stanbol/commit/05c58f6db2d856f0ce5d8c8ea7591c3db4da630d", "message": "fixed potential NPE in ClerezzaYard\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1102376 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_7", "file": [{"additions": 1, "raw_url": "https://github.com/apache/stanbol/raw/19ee9852de93cd24523219d35912662bd6fbf2e3/entityhub/yard/clerezza/src/main/java/org/apache/stanbol/entityhub/yard/clerezza/impl/ClerezzaYard.java", "blob_url": "https://github.com/apache/stanbol/blob/19ee9852de93cd24523219d35912662bd6fbf2e3/entityhub/yard/clerezza/src/main/java/org/apache/stanbol/entityhub/yard/clerezza/impl/ClerezzaYard.java", "sha": "517ea4b5953f05189cbc7ab571e1451b60a2a29c", "changes": 5, "status": "modified", "deletions": 4, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/yard/clerezza/src/main/java/org/apache/stanbol/entityhub/yard/clerezza/impl/ClerezzaYard.java?ref=19ee9852de93cd24523219d35912662bd6fbf2e3", "patch": "@@ -354,15 +354,12 @@ public final Representation update(Representation representation) throws Illegal\n         return added;\n     }\n     protected final Representation store(Representation representation,boolean allowCreate,boolean canNotCreateIsError) throws IllegalArgumentException, YardException{\n-        log.info(\"store Representation \"+representation.getId());\n-//        log.info(\"  > entityhub size: \"+graph.size());\n         if(representation == null) {\n             return null;\n         }\n+        log.info(\"store Representation \" + representation.getId());\n         if(isRepresentation(representation.getId())){\n-//            log.info(\"  > remove previous version\");\n             remove(representation.getId());\n-//            log.info(\"  > entityhub size: \"+graph.size());\n         } else if(!allowCreate){\n             if(canNotCreateIsError) {\n                 throw new IllegalArgumentException(\"Parsed Representation \"+representation.getId()+\" in not managed by this Yard \"+getName()+\"(id=\"+getId()+\")\");", "filename": "entityhub/yard/clerezza/src/main/java/org/apache/stanbol/entityhub/yard/clerezza/impl/ClerezzaYard.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/d88933bf97167fbffedf056d92eb27acad444df2", "parent": "https://github.com/apache/stanbol/commit/3b0fea914238b9613f2f551df200fa97cc51eb0d", "message": "STANBOL-120 - avoid NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1088661 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_8", "file": [{"additions": 4, "raw_url": "https://github.com/apache/stanbol/raw/d88933bf97167fbffedf056d92eb27acad444df2/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/JerseyEndpoint.java", "blob_url": "https://github.com/apache/stanbol/blob/d88933bf97167fbffedf056d92eb27acad444df2/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/JerseyEndpoint.java", "sha": "669ee421a921d03332c940ebebc5fb47b876612b", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/JerseyEndpoint.java?ref=d88933bf97167fbffedf056d92eb27acad444df2", "patch": "@@ -125,8 +125,10 @@ protected void activate(ComponentContext ctx) throws IOException, ServletExcepti\n \n     @Deactivate\n     protected void deactivate(ComponentContext ctx) {\n-        for (String alias : registeredAliases) {\n-            httpService.unregister(alias);\n+        if(registeredAliases != null) {\n+            for (String alias : registeredAliases) {\n+                httpService.unregister(alias);\n+            }\n         }\n         servletContext = null;\n         componentContext = null;", "filename": "commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/JerseyEndpoint.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/f01f8245c848695bdd189e9f358c8efef5c5ee33", "parent": "https://github.com/apache/stanbol/commit/ed97051f385fed1e839b808de086d8f6c1a59338", "message": "STANBOL-1232: fixed a NPE in the StandalonEmbeddedSolrServerProvider if a SolrCore for a reuqested absolute path is not present\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1548583 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_9", "file": [{"additions": 1, "raw_url": "https://github.com/apache/stanbol/raw/f01f8245c848695bdd189e9f358c8efef5c5ee33/commons/solr/managed/src/main/java/org/apache/stanbol/commons/solr/managed/standalone/StandaloneEmbeddedSolrServerProvider.java", "blob_url": "https://github.com/apache/stanbol/blob/f01f8245c848695bdd189e9f358c8efef5c5ee33/commons/solr/managed/src/main/java/org/apache/stanbol/commons/solr/managed/standalone/StandaloneEmbeddedSolrServerProvider.java", "sha": "d2ae5e697a241660547e7481bb1eae2935b8837b", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/solr/managed/src/main/java/org/apache/stanbol/commons/solr/managed/standalone/StandaloneEmbeddedSolrServerProvider.java?ref=f01f8245c848695bdd189e9f358c8efef5c5ee33", "patch": "@@ -108,7 +108,7 @@ public EmbeddedSolrServer getSolrServer(IndexReference indexRef, String configNa\n         } else {\n             coreName = indexRef.getIndex();\n         } \n-        if(!server.isManagedIndex(coreName)){\n+        if(coreName != null && !server.isManagedIndex(coreName)){\n             if(configName != null){\n                 try {\n                     server.createSolrIndex(coreName, configName, null);", "filename": "commons/solr/managed/src/main/java/org/apache/stanbol/commons/solr/managed/standalone/StandaloneEmbeddedSolrServerProvider.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/d310213aa5fd013157b8b1520e867d3899d29829", "parent": "https://github.com/apache/stanbol/commit/fc605707dbdc19cc7b3d8efcb81bfe0a0d1c0bf2", "message": "fix potential NPE in enhancer web UI when confidence level is no defined\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1182377 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_10", "file": [{"additions": 1, "raw_url": "https://github.com/apache/stanbol/raw/d310213aa5fd013157b8b1520e867d3899d29829/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java", "blob_url": "https://github.com/apache/stanbol/blob/d310213aa5fd013157b8b1520e867d3899d29829/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java", "sha": "6c3f3d6687072d9b2a28cab3587c05f642886beb", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java?ref=d310213aa5fd013157b8b1520e867d3899d29829", "patch": "@@ -431,7 +431,7 @@ public EntitySuggestion(UriRef uri,\n             this.uri = uri;\n             this.label = label;\n             this.type = type;\n-            this.confidence = confidence;\n+            this.confidence = confidence != null ? confidence : 0.0;\n             this.entityProperties = entityProperties;\n             this.defaultThumbnails = defaultThumbnails;\n         }", "filename": "enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/0b71093f5bdb91c928e814b6da8f6e5db2742d32", "parent": "https://github.com/apache/stanbol/commit/8ce2429c3b832fa2c58de270ee1aa121f00af827", "message": "STANBOL-760: fixed some NPE related to tokens without an POS tag (can only occur if the used POS engine does not add POS annotations to all tokens of the text)\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1518631 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_11", "file": [{"additions": 17, "raw_url": "https://github.com/apache/stanbol/raw/0b71093f5bdb91c928e814b6da8f6e5db2742d32/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/Sentiment.java", "blob_url": "https://github.com/apache/stanbol/blob/0b71093f5bdb91c928e814b6da8f6e5db2742d32/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/Sentiment.java", "sha": "d2cf55a0a04c1de5321f4125be52ef3d97f04f1e", "changes": 32, "status": "modified", "deletions": 15, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/Sentiment.java?ref=0b71093f5bdb91c928e814b6da8f6e5db2742d32", "patch": "@@ -79,22 +79,24 @@ public Sentiment(Token token, double value, Sentence sentence) {\n         this.start = token.getStart();\n         this.end = token.getEnd();\n         List<Value<PosTag>> tags = token.getAnnotations(NlpAnnotations.POS_ANNOTATION);\n-        for(Value<PosTag> tag : tags){\n-            if(tag.probability() == Value.UNKNOWN_PROBABILITY ||\n-                    tag.probability() >= MIN_POS_CONF || \n-                    !Collections.disjoint(tag.value().getCategories(),PREF_LEX_CAT)){\n-                posTag = tag.value();\n-                break;\n+        if(tags != null && !tags.isEmpty()){\n+            for(Value<PosTag> tag : tags){\n+                if(tag.probability() == Value.UNKNOWN_PROBABILITY ||\n+                        tag.probability() >= MIN_POS_CONF || \n+                        !Collections.disjoint(tag.value().getCategories(),PREF_LEX_CAT)){\n+                    posTag = tag.value();\n+                    break;\n+                }\n+            }\n+            if(posTag == null){\n+                posTag = tags.get(0).value();\n+            }\n+            if(posTag.hasCategory(LexicalCategory.Noun)){\n+                addAbout(token); //add the token also as noun\n+            }\n+            if(posTag.hasCategory(LexicalCategory.Verb)){\n+                setVerb(token);\n             }\n-        }\n-        if(posTag == null){\n-            posTag = tags.get(0).value();\n-        }\n-        if(posTag.hasCategory(LexicalCategory.Noun)){\n-            addAbout(token); //add the token also as noun\n-        }\n-        if(posTag.hasCategory(LexicalCategory.Verb)){\n-            setVerb(token);\n         }\n     }\n     ", "filename": "enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/Sentiment.java"}, {"additions": 8, "raw_url": "https://github.com/apache/stanbol/raw/0b71093f5bdb91c928e814b6da8f6e5db2742d32/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/SentimentSummarizationEngine.java", "blob_url": "https://github.com/apache/stanbol/blob/0b71093f5bdb91c928e814b6da8f6e5db2742d32/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/SentimentSummarizationEngine.java", "sha": "a2366fbdd8ea47ca7c5a127b369d8847d3fa90a0", "changes": 16, "status": "modified", "deletions": 8, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/SentimentSummarizationEngine.java?ref=0b71093f5bdb91c928e814b6da8f6e5db2742d32", "patch": "@@ -416,9 +416,9 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n         Integer[] context;\n         PosTag pos = sentiment.getPosTag();\n         boolean isPredicative;\n-        if(pos.getPosHierarchy().contains(Pos.PredicativeAdjective)){\n+        if(pos != null && pos.getPosHierarchy().contains(Pos.PredicativeAdjective)){\n             isPredicative = true;\n-        } else if(pos.hasCategory(LexicalCategory.Adjective) && \n+        } else if(pos != null && pos.hasCategory(LexicalCategory.Adjective) && \n                 //Adjective that are not directly in front of a Noun\n                 nouns.get(Integer.valueOf(index+1)) == null){ \n           isPredicative = true;\n@@ -492,14 +492,14 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n                 context = new Integer[]{Integer.valueOf(index-nounContext),\n                         Integer.valueOf(index+nounContext)};\n             }\n-        } else if(pos.hasCategory(LexicalCategory.Adjective)){\n+        } else if(pos != null && pos.hasCategory(LexicalCategory.Adjective)){\n             //for all other adjective the affected noun is expected directly\n             //after the noun\n             context = new Integer[]{index,Integer.valueOf(index+1)};\n-        } else if(pos.hasCategory(LexicalCategory.Noun)){\n+        } else if(pos != null && pos.hasCategory(LexicalCategory.Noun)){\n             //a noun with an sentiment\n             context = new Integer[]{index,index};\n-        } else { //else return default\n+        } else { //else (includes pos == null) return default\n             context = new Integer[]{Integer.valueOf(index-nounContext),\n                     Integer.valueOf(index+nounContext)};\n         }\n@@ -515,17 +515,17 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n \n     private boolean isPronoun(Token token, String language) {\n         Value<PosTag> posAnnotation = token.getAnnotation(NlpAnnotations.POS_ANNOTATION);\n-        return posAnnotation.value().getPosHierarchy().contains(Pos.Pronoun);\n+        return posAnnotation == null ? false : posAnnotation.value().getPosHierarchy().contains(Pos.Pronoun);\n     }\n \n     private boolean isVerb(Token token, String language) {\n         Value<PosTag> posAnnotation = token.getAnnotation(NlpAnnotations.POS_ANNOTATION);\n-        return posAnnotation.value().hasCategory(LexicalCategory.Verb);\n+        return posAnnotation == null ? false : posAnnotation.value().hasCategory(LexicalCategory.Verb);\n     }\n     \n     private boolean isCoordinatingConjuction(Token token, String language) {\n         Value<PosTag> posAnnotation = token.getAnnotation(NlpAnnotations.POS_ANNOTATION);\n-        return posAnnotation.value().getPosHierarchy().contains(Pos.CoordinatingConjunction);\n+        return posAnnotation == null ? false : posAnnotation.value().getPosHierarchy().contains(Pos.CoordinatingConjunction);\n     }\n \n     private boolean isSectionBorder(Token token, String language) {", "filename": "enhancement-engines/sentiment-summarization/src/main/java/org/apache/stanbol/enhancer/engines/sentiment/summarize/SentimentSummarizationEngine.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/dc898d2db5faaec8c070d7db6f5bce31a44dc224", "parent": "https://github.com/apache/stanbol/commit/4b284ebd522389492907b9331fc6daad4fed00c8", "message": "STANBOL-1073: The workaround code is now only called if the JerseyEndpoint is activated. This should prevent the NPE caused by the Parser not yet beeing injected.\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1505654 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_12", "file": [{"additions": 5, "raw_url": "https://github.com/apache/stanbol/raw/dc898d2db5faaec8c070d7db6f5bce31a44dc224/commons/web/base.jersey/src/main/java/org/apache/stanbol/commons/web/base/jersey/JerseyEndpoint.java", "blob_url": "https://github.com/apache/stanbol/blob/dc898d2db5faaec8c070d7db6f5bce31a44dc224/commons/web/base.jersey/src/main/java/org/apache/stanbol/commons/web/base/jersey/JerseyEndpoint.java", "sha": "a4b50b400810c2ca5f0c079ecee00acfa8085c13", "changes": 10, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/web/base.jersey/src/main/java/org/apache/stanbol/commons/web/base/jersey/JerseyEndpoint.java?ref=dc898d2db5faaec8c070d7db6f5bce31a44dc224", "patch": "@@ -172,16 +172,16 @@ protected void activate(ComponentContext ctx) throws IOException,\n \n     /** Initialize the Jersey subsystem */\n     private synchronized void initJersey() throws NamespaceException, ServletException {\n-        //temporary workaround for STANBOL-1073\n-        InputStream in = new ByteArrayInputStream(\n-                \"<http://example.org/me> <http://xmlns.com/foaf/0.1/name> \\\"Jane Doe\\\" .\".getBytes());\n-        parser.parse(in, \"text/turtle\");\n-        //end of STANBOL-1073 work around\n         if (componentContext == null) {\n             log.debug(\" ... can not init Jersey Endpoint - Component not yet activated!\");\n             //throw new IllegalStateException(\"Null ComponentContext, not activated?\");\n             return;\n         }\n+        //temporary workaround for STANBOL-1073\n+        InputStream in = new ByteArrayInputStream(\n+                \"<http://example.org/me> <http://xmlns.com/foaf/0.1/name> \\\"Jane Doe\\\" .\".getBytes());\n+        parser.parse(in, \"text/turtle\");\n+        //end of STANBOL-1073 work around\n \n         shutdownJersey();\n ", "filename": "commons/web/base.jersey/src/main/java/org/apache/stanbol/commons/web/base/jersey/JerseyEndpoint.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/cfc71e0a094da4153c771df85920f15781a20bf1", "parent": "https://github.com/apache/stanbol/commit/7430950c8cdd0e46321b0b59538046e13ba511b3", "message": "minor: Storing an FST with no entries caused an NPE. Now it is checked if their are phrases present. If not the built FST is ignored. NOTE: This can happen if their are labels for a language, but all such labels are fully removed by the configured Analyzers\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1685794 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_13", "file": [{"additions": 9, "raw_url": "https://github.com/apache/stanbol/raw/cfc71e0a094da4153c771df85920f15781a20bf1/entityhub/indexing/destination/solryard/src/main/java/org/apache/stanbol/entityhub/indexing/destination/solryard/fst/CorpusCreationTask.java", "blob_url": "https://github.com/apache/stanbol/blob/cfc71e0a094da4153c771df85920f15781a20bf1/entityhub/indexing/destination/solryard/src/main/java/org/apache/stanbol/entityhub/indexing/destination/solryard/fst/CorpusCreationTask.java", "sha": "62d11ff898b8ebd05cb821bf25d26a452ec16600", "changes": 14, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/indexing/destination/solryard/src/main/java/org/apache/stanbol/entityhub/indexing/destination/solryard/fst/CorpusCreationTask.java?ref=cfc71e0a094da4153c771df85920f15781a20bf1", "patch": "@@ -72,11 +72,15 @@ public void run() {\n                 log.warn(\"Unable to delete existing FST fiel for {}\",corpusInfo);\n             }\n         }\n-        try {\n-            corpus.save(corpusInfo.fst);\n-        } catch (IOException e) {\n-            log.warn(\"Unable to store FST corpus \" + corpusInfo + \" to \"\n-                    + corpusInfo.fst.getAbsolutePath() + \"!\", e);\n+        if(corpus.getPhrases() != null){ //the FST is not empty\n+            try { //NOTE saving an empty corpus results in a NPE\n+                corpus.save(corpusInfo.fst);\n+            } catch (IOException e) {\n+                log.warn(\"Unable to store FST corpus \" + corpusInfo + \" to \"\n+                        + corpusInfo.fst.getAbsolutePath() + \"!\", e);\n+            }\n+        } else {\n+           log.info(\"FST for {} is empty ... no FST will be stored\",corpusInfo); \n         }\n     }\n     ", "filename": "entityhub/indexing/destination/solryard/src/main/java/org/apache/stanbol/entityhub/indexing/destination/solryard/fst/CorpusCreationTask.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/8be3403cfce38dc58e682fd6a8e8cfb66d2c46ad", "parent": "https://github.com/apache/stanbol/commit/da3546e0d5dd366c9c4c77b23bfbe0b9801c3c10", "message": "ContextHelper no longer throws a NPE in the case that a requested service is not present. This now allows correctly to request optional dependences.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1137905 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_14", "file": [{"additions": 5, "raw_url": "https://github.com/apache/stanbol/raw/8be3403cfce38dc58e682fd6a8e8cfb66d2c46ad/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/ContextHelper.java", "blob_url": "https://github.com/apache/stanbol/blob/8be3403cfce38dc58e682fd6a8e8cfb66d2c46ad/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/ContextHelper.java", "sha": "923e0286dd0ba5dc1cfc5d5ea209f6bf22cf7dbc", "changes": 6, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/ContextHelper.java?ref=8be3403cfce38dc58e682fd6a8e8cfb66d2c46ad", "patch": "@@ -25,7 +25,11 @@\n         ServiceReference reference = bundleContext.getServiceReference(clazz.getName());\n         //TODO: returning the service will cause the service reference not to be\n         //  released bundleContext.ungetService(reference) will not be called!\n-        return (T) bundleContext.getService(reference);\n+        if(reference != null){\n+            return (T) bundleContext.getService(reference);\n+        } else {\n+            return null;\n+        }\n     }\n \n }", "filename": "commons/web/base/src/main/java/org/apache/stanbol/commons/web/base/ContextHelper.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/6ccd695abf41d9648f643779464f03912a2f46f7", "parent": "https://github.com/apache/stanbol/commit/4dd4de53aa60e8c7a3106b2b1b69b050a2aafb08", "message": "STANBOL-811: The TopicClassificationEngine does no longer use File#tempFile(..) to create the folder for performing CVFold's. The root folder is now configured by the unit tests. Within OSGI the property is not set and would cause a NPE if no ManagedSolrServer is present (This should be reviewed by ogrisel); Minor: also added some loggings to the unit tests.\n\ngit-svn-id: https://svn.apache.org/repos/asf/stanbol/trunk@1450615 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_15", "file": [{"additions": 21, "raw_url": "https://github.com/apache/stanbol/raw/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/main/java/org/apache/stanbol/enhancer/engine/topic/TopicClassificationEngine.java", "blob_url": "https://github.com/apache/stanbol/blob/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/main/java/org/apache/stanbol/enhancer/engine/topic/TopicClassificationEngine.java", "sha": "949588d4acefc6b5689774b9f2bd76a546a7a42b", "changes": 31, "status": "modified", "deletions": 10, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancement-engines/topic/engine/src/main/java/org/apache/stanbol/enhancer/engine/topic/TopicClassificationEngine.java?ref=6ccd695abf41d9648f643779464f03912a2f46f7", "patch": "@@ -306,6 +306,17 @@\n     @Reference(cardinality = ReferenceCardinality.OPTIONAL_UNARY, bind = \"bindManagedSolrServer\", unbind = \"unbindManagedSolrServer\", strategy = ReferenceStrategy.EVENT, policy = ReferencePolicy.DYNAMIC)\n     protected ManagedSolrServer managedSolrServerDummy; // trick to call the super class binders\n \n+    /**\n+     * Only used for testing outside an OSGI environment (see STANBOL-811: \n+     * the previously used {@link File#createTempFile(String, String)} does not\n+     * work on some Windows versions.\n+     */\n+    private File embeddedSolrServerDir;\n+\n+    void configureEmbeddedSolrServerDir(File directory){\n+        embeddedSolrServerDir = directory;\n+    }\n+    \n     @Activate\n     protected void activate(ComponentContext context) throws ConfigurationException, InvalidSyntaxException {\n         @SuppressWarnings(\"unchecked\")\n@@ -1025,11 +1036,7 @@ synchronized public int updatePerformanceEstimates(boolean incremental) throws C\n             throw new ClassifierException(\"Another evaluation is already running\");\n         }\n         int updatedTopics = 0;\n-        File tmpfolder = null;\n         try {\n-            tmpfolder = File.createTempFile(\"stanbol-evaluation-folder-\", \".tmp\");\n-            tmpfolder.delete();\n-            tmpfolder.mkdir();\n             evaluationRunning = true;\n             int cvFoldCount = 3; // 3-folds CV is hardcoded for now\n             int cvIterationCount = 3; // make it possible to limit the number of folds to use\n@@ -1038,9 +1045,10 @@ synchronized public int updatePerformanceEstimates(boolean incremental) throws C\n             // statistics are up to date\n             getTrainingSet().optimize();\n \n-            // TODO: make the temporary folder path configurable with a property\n+            // NOTE: The folder used to create the SolrServer used for CVFold\n+            //       is now created within the #embeddedSolrServerDir\n             for (int cvFoldIndex = 0; cvFoldIndex < cvIterationCount; cvFoldIndex++) {\n-                updatedTopics = performCVFold(tmpfolder, cvFoldIndex, cvFoldCount, cvIterationCount,\n+                updatedTopics = performCVFold(cvFoldIndex, cvFoldCount, cvIterationCount,\n                     incremental);\n             }\n             SolrServer solrServer = getActiveSolrServer();\n@@ -1052,14 +1060,12 @@ synchronized public int updatePerformanceEstimates(boolean incremental) throws C\n         } catch (SolrServerException e) {\n             throw new ClassifierException(e);\n         } finally {\n-            FileUtils.deleteQuietly(tmpfolder);\n             evaluationRunning = false;\n         }\n         return updatedTopics;\n     }\n \n-    protected int performCVFold(File tmpfolder,\n-                                int cvFoldIndex,\n+    protected int performCVFold(int cvFoldIndex,\n                                 int cvFoldCount,\n                                 int cvIterations,\n                                 boolean incremental) throws ConfigurationException,\n@@ -1079,7 +1085,12 @@ protected int performCVFold(File tmpfolder,\n                 classifier.activate(context, getCanonicalConfiguration(engineName + \"-evaluation\"));\n             } else {\n                 // non-OSGi runtime, need to do the setup manually\n-                EmbeddedSolrServer evaluationServer = EmbeddedSolrHelper.makeEmbeddedSolrServer(tmpfolder,\n+                File solrServerDir = new File(embeddedSolrServerDir,engineName + \"-evaluation\");\n+                if(solrServerDir.isDirectory()){\n+                    FileUtils.forceDelete(solrServerDir);\n+                }\n+                FileUtils.forceMkdir(solrServerDir);\n+                EmbeddedSolrServer evaluationServer = EmbeddedSolrHelper.makeEmbeddedSolrServer(solrServerDir,\n                     \"evaluationclassifierserver\", \"default-topic-model\", \"default-topic-model\");\n                 classifier.configure(getCanonicalConfiguration(evaluationServer));\n             }", "filename": "enhancement-engines/topic/engine/src/main/java/org/apache/stanbol/enhancer/engine/topic/TopicClassificationEngine.java"}, {"additions": 10, "raw_url": "https://github.com/apache/stanbol/raw/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TopicEngineTest.java", "blob_url": "https://github.com/apache/stanbol/blob/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TopicEngineTest.java", "sha": "6b2127d152dc39c5523a540f61b402853b498d3e", "changes": 12, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TopicEngineTest.java?ref=6ccd695abf41d9648f643779464f03912a2f46f7", "patch": "@@ -122,7 +122,8 @@ public void setup() throws Exception {\n         classifierSolrServer = makeEmbeddedSolrServer(solrHome, \"classifierserver\", \"test-topic-model\",\n             \"default-topic-model\");\n         classifier = TopicClassificationEngine.fromParameters(getDefaultClassifierConfigParams());\n-\n+        //configure the directory used to create Embedded SolrServers for CVFold\n+        classifier.configureEmbeddedSolrServerDir(solrHome);\n         trainingSetSolrServer = makeEmbeddedSolrServer(solrHome, \"trainingsetserver\",\n             \"test-topic-trainingset\", \"default-topic-trainingset\");\n         trainingSet = new SolrTrainingSet();\n@@ -162,6 +163,7 @@ protected void loadSampleTopicsFromTSV() throws IOException, SolrServerException\n \n     @Test\n     public void testEngineConfiguration() throws ConfigurationException {\n+        log.info(\" --- testEngineConfiguration --- \");\n         Hashtable<String,Object> config = getDefaultClassifierConfigParams();\n         TopicClassificationEngine classifier = TopicClassificationEngine.fromParameters(config);\n         assertNotNull(classifier);\n@@ -199,6 +201,7 @@ public void testEngineConfiguration() throws ConfigurationException {\n \n     @Test\n     public void testImportModelFromSKOS() throws Exception {\n+        log.info(\" --- testImportModelFromSKOS --- \");\n         Parser parser = Parser.getInstance();\n         parser.bindParsingProvider(new JenaParserProvider());\n         Graph graph = parser.parse(getClass().getResourceAsStream(\"/sample-scheme.skos.rdf.xml\"),\n@@ -215,6 +218,7 @@ public void testImportModelFromSKOS() throws Exception {\n \n     @Test\n     public void testProgrammaticThesaurusConstruction() throws Exception {\n+        log.info(\" --- testProgrammaticThesaurusConstruction --- \");\n         // Register the roots of the taxonomy\n         classifier.addConcept(\"http://example.com/topics/root1\", null);\n         classifier.addConcept(\"http://example.com/topics/root2\", null);\n@@ -254,6 +258,7 @@ public void testProgrammaticThesaurusConstruction() throws Exception {\n \n     @Test\n     public void testEmptyIndexTopicClassification() throws Exception {\n+        log.info(\" --- testEmptyIndexTopicClassification --- \");\n         TopicClassificationEngine engine = TopicClassificationEngine\n                 .fromParameters(getDefaultClassifierConfigParams());\n         List<TopicSuggestion> suggestedTopics = engine.suggestTopics(\"This is a test.\");\n@@ -265,6 +270,7 @@ public void testEmptyIndexTopicClassification() throws Exception {\n     // to get updated to work with the new Solr schema + move the CSV import directly to the classifier or\n     // training set API\n     public void testTopicClassification() throws Exception {\n+        log.info(\" --- testTopicClassification --- \");\n         loadSampleTopicsFromTSV();\n         List<TopicSuggestion> suggestedTopics = classifier\n                 .suggestTopics(\"The Man Who Shot Liberty Valance is a 1962\"\n@@ -279,7 +285,7 @@ public void testTopicClassification() throws Exception {\n \n     @Test\n     public void testTrainClassifierFromExamples() throws Exception {\n-\n+        log.info(\" --- testTrainClassifierFromExamples --- \");\n         // mini taxonomy for news articles\n         String[] business = {\"urn:topics/business\", \"http://dbpedia.org/resource/Business\"};\n         String[] technology = {\"urn:topics/technology\", \"http://dbpedia.org/resource/Technology\"};\n@@ -410,6 +416,7 @@ public void testTrainClassifierFromExamples() throws Exception {\n \n     @Test\n     public void testUpdatePerformanceEstimates() throws Exception {\n+        log.info(\" --- testUpdatePerformanceEstimates --- \");\n         ClassificationReport performanceEstimates;\n         // no registered topic\n         try {\n@@ -453,6 +460,7 @@ public void testUpdatePerformanceEstimates() throws Exception {\n \n     @Test\n     public void testCrossValidation() throws Exception {\n+        log.info(\" --- testCrossValidation --- \");\n         // seed a pseudo random number generator for reproducible tests\n         Random rng = new Random(0);\n         ClassificationReport performanceEstimates;", "filename": "enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TopicEngineTest.java"}, {"additions": 6, "raw_url": "https://github.com/apache/stanbol/raw/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TrainingSetTest.java", "blob_url": "https://github.com/apache/stanbol/blob/6ccd695abf41d9648f643779464f03912a2f46f7/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TrainingSetTest.java", "sha": "e01fe60188cd379ade8e13df2daadd63d789b093", "changes": 6, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TrainingSetTest.java?ref=6ccd695abf41d9648f643779464f03912a2f46f7", "patch": "@@ -125,6 +125,7 @@ public void cleanupEmbeddedSolrServer() {\n \n     @Test\n     public void testDateSerialization() throws Exception {\n+        log.info(\" --- testDateSerialization --- \");\n         GregorianCalendar timeUtc = new GregorianCalendar(TimeZone.getTimeZone(\"UTC\"));\n         timeUtc.set(2012, 23, 12, 06, 43, 00);\n         timeUtc.set(Calendar.MILLISECOND, 0);\n@@ -138,6 +139,7 @@ public void testDateSerialization() throws Exception {\n \n     @Test\n     public void testEmptyTrainingSet() throws TrainingSetException {\n+        log.info(\" --- testEmptyTrainingSet --- \");\n         Batch<Example> examples = trainingSet.getPositiveExamples(new ArrayList<String>(), null);\n         assertEquals(examples.items.size(), 0);\n         assertFalse(examples.hasMore);\n@@ -157,6 +159,7 @@ public void testEmptyTrainingSet() throws TrainingSetException {\n \n     @Test\n     public void testStoringExamples() throws ConfigurationException, TrainingSetException {\n+        log.info(\" --- testStoringExamples --- \");\n         trainingSet.registerExample(\"example1\", \"Text of example1.\", Arrays.asList(TOPIC_1));\n         trainingSet.registerExample(\"example2\", \"Text of example2.\", Arrays.asList(TOPIC_1, TOPIC_2));\n         trainingSet.registerExample(\"example3\", \"Text of example3.\", new ArrayList<String>());\n@@ -201,6 +204,7 @@ public void testStoringExamples() throws ConfigurationException, TrainingSetExce\n \n     @Test\n     public void testBatchingPositiveExamples() throws ConfigurationException, TrainingSetException {\n+        log.info(\" --- testBatchingPositiveExamples --- \");\n         Set<String> expectedCollectedIds = new HashSet<String>();\n         Set<String> expectedCollectedText = new HashSet<String>();\n         Set<String> collectedIds = new HashSet<String>();\n@@ -243,6 +247,7 @@ public void testBatchingPositiveExamples() throws ConfigurationException, Traini\n \n     @Test\n     public void testBatchingNegativeExamplesAndAutoId() throws ConfigurationException, TrainingSetException {\n+        log.info(\" --- testBatchingNegativeExamplesAndAutoId --- \");\n         Set<String> expectedCollectedIds = new HashSet<String>();\n         Set<String> expectedCollectedText = new HashSet<String>();\n         Set<String> collectedIds = new HashSet<String>();\n@@ -276,6 +281,7 @@ public void testBatchingNegativeExamplesAndAutoId() throws ConfigurationExceptio\n \n     @Test\n     public void testHasChangedSince() throws Exception {\n+        log.info(\" --- testHasChangedSince --- \");\n         Date date0 = new Date();\n         assertFalse(trainingSet.hasChangedSince(Arrays.asList(TOPIC_1), date0));\n         assertFalse(trainingSet.hasChangedSince(Arrays.asList(TOPIC_2), date0));", "filename": "enhancement-engines/topic/engine/src/test/java/org/apache/stanbol/enhancer/engine/topic/TrainingSetTest.java"}], "repo": "stanbol"}, {"commit": "https://github.com/apache/stanbol/commit/250d599350b2fe0019bc470aba76f5addfbabb48", "parent": "https://github.com/apache/stanbol/commit/7aa6b74caaca9fdb8ac467e4b229ada7b4732c38", "message": "STANBOL-230: Adds support for using the Entityhub for linking Entities for TextAnnotations\n\n* By configuring \"local\" or \"entityhub\" one can now use the Entityhub to suggest Entities for TextAnnotations\n* Because now it is no longer true that only ReferencedSites can be used for entity tagging the engine was renamed to NamedEntityTaggingEngine. All Configuration files (e.g. in the launcher) where adapted to the new name.\n* Added a second default configuration to the full launcher that uses the Entityhub for enhancing Entities. This Configuration uses \"http://schema.org\" types for \"Person\", \"Organization\" and \"Place\" as well as the \"name\" field for lookup.\n* The ids \"local\" and \"entityhub\" are now reserved for the Entityhub and MUST NOT be used as IDs for Referenced Sites.\n* added a list of IDs reserved for the Entityhub to the Entityhub Interface.\n* added a list of prohibited IDs for ReferencedSites to the ReferencedSite interface. Currently only the IDs assigned to the Entityhub are in that list\n\n### other changes\n\n* corrected a type in the Entityhub interface (getQueryFavtory -> getQueryFactory)\n* added \"http://schema.org\" to the NamespaceEnum (prefix is \"schema\")\n* added support for a default namespace to the NamespaceEnum.\n* the NamespaceEnum now uses schema.org as default namespace. This means that the property \"name\" in configurations would be mapped to \"http://schema.org/name\".\n* The \"indexing.properties\" files of all indexing utilities used wrong IDs for EntityDereferencer and EntitySearcher implementations. This is now corrected\n* \"rdfs:label\" was hard coded to retrieve the value for the entity-label property of TextAnnotations. Now the value of the property used to search for entities is used.\n* corrected a bug in ContentItemResource (enhancer.jersey) that caused NPEs in case a Clerezza PlainLiteral had no language defined.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/stanbol/trunk@1137617 13f79535-47bb-0310-9956-ffa450edef68", "bug_id": "stanbol_16", "file": [{"additions": 4, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/EnhancementRDFUtils.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/EnhancementRDFUtils.java", "sha": "0d8849e67f1d03b665f0de225a94f36ec305af9f", "changes": 6, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/EnhancementRDFUtils.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -61,17 +61,19 @@\n      *            enhancements this textAnnotation is related to\n      * @param entity\n      *            the related entity\n+     * @param nameField the field used to extract the name\n      */\n     public static UriRef writeEntityAnnotation(EnhancementEngine engine,\n                                                LiteralFactory literalFactory,\n                                                MGraph graph,\n                                                UriRef contentItemId,\n                                                Collection<NonLiteral> relatedEnhancements,\n-                                               Entity entity) {\n+                                               Entity entity,\n+                                               String nameField) {\n         // 1. check if the returned Entity does has a label -> if not return null\n         // add labels (set only a single label. Use \"en\" if available!\n         Text label = null;\n-        Iterator<Text> labels = entity.getRepresentation().getText(RDFS_LABEL.getUnicodeString());\n+        Iterator<Text> labels = entity.getRepresentation().getText(nameField);\n         while (labels.hasNext()) {\n             Text actLabel = labels.next();\n             if (label == null) {", "filename": "enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/EnhancementRDFUtils.java"}, {"additions": 36, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/LabelBasedEntityTaggingEngine.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/LabelBasedEntityTaggingEngine.java", "sha": "6b5dd2faea92919449a237172a5cb7211f451110", "changes": 36, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/LabelBasedEntityTaggingEngine.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -0,0 +1,36 @@\n+package org.apache.stanbol.enhancer.engines.entitytagging.impl;\n+\n+import java.util.Map;\n+\n+import org.apache.felix.scr.annotations.Component;\n+import org.apache.felix.scr.annotations.ConfigurationPolicy;\n+import org.apache.felix.scr.annotations.Service;\n+import org.apache.stanbol.enhancer.servicesapi.ContentItem;\n+import org.apache.stanbol.enhancer.servicesapi.EngineException;\n+import org.apache.stanbol.enhancer.servicesapi.EnhancementEngine;\n+import org.apache.stanbol.enhancer.servicesapi.ServiceProperties;\n+\n+@Component(configurationFactory = true, policy = ConfigurationPolicy.REQUIRE, // the baseUri is required!\n+    specVersion = \"1.1\", metatype = true, immediate = true)\n+@Service\n+public class LabelBasedEntityTaggingEngine implements EnhancementEngine, ServiceProperties {\n+\n+    @Override\n+    public int canEnhance(ContentItem ci) throws EngineException {\n+        // TODO Auto-generated method stub\n+        return 0;\n+    }\n+\n+    @Override\n+    public void computeEnhancements(ContentItem ci) throws EngineException {\n+    // TODO Auto-generated method stub\n+\n+    }\n+\n+    @Override\n+    public Map<String,Object> getServiceProperties() {\n+        // TODO Auto-generated method stub\n+        return null;\n+    }\n+\n+}", "filename": "enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/LabelBasedEntityTaggingEngine.java"}, {"additions": 80, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/NamedEntityTaggingEngine.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/NamedEntityTaggingEngine.java", "previous_filename": "enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/ReferencedSiteEntityTaggingEnhancementEngine.java", "sha": "71bdd5f2658712f7234e206e738936ea8c17a0ee", "changes": 118, "status": "renamed", "deletions": 38, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/NamedEntityTaggingEngine.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -22,12 +22,15 @@\n import static org.apache.stanbol.enhancer.servicesapi.rdf.Properties.RDF_TYPE;\n \n import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.Collections;\n import java.util.Dictionary;\n import java.util.HashMap;\n+import java.util.HashSet;\n import java.util.Iterator;\n import java.util.List;\n import java.util.Map;\n+import java.util.Set;\n \n import org.apache.clerezza.rdf.core.LiteralFactory;\n import org.apache.clerezza.rdf.core.MGraph;\n@@ -54,6 +57,8 @@\n import org.apache.stanbol.enhancer.servicesapi.rdf.OntologicalClasses;\n import org.apache.stanbol.enhancer.servicesapi.rdf.Properties;\n import org.apache.stanbol.enhancer.servicesapi.rdf.TechnicalClasses;\n+import org.apache.stanbol.entityhub.servicesapi.Entityhub;\n+import org.apache.stanbol.entityhub.servicesapi.EntityhubException;\n import org.apache.stanbol.entityhub.servicesapi.defaults.NamespaceEnum;\n import org.apache.stanbol.entityhub.servicesapi.model.Entity;\n import org.apache.stanbol.entityhub.servicesapi.query.FieldQuery;\n@@ -77,45 +82,53 @@\n @Component(configurationFactory = true, policy = ConfigurationPolicy.REQUIRE, // the baseUri is required!\n specVersion = \"1.1\", metatype = true, immediate = true)\n @Service\n-public class ReferencedSiteEntityTaggingEnhancementEngine implements EnhancementEngine, ServiceProperties {\n+public class NamedEntityTaggingEngine implements EnhancementEngine, ServiceProperties {\n \n     private final Logger log = LoggerFactory.getLogger(getClass());\n \n-    @Property(value = \"dbpedia\")\n+    @Property//(value = \"dbpedia\")\n     public static final String REFERENCED_SITE_ID = \"org.apache.stanbol.enhancer.engines.entitytagging.referencedSiteId\";\n \n-    @Property(boolValue = true)\n+    @Property//(boolValue = true)\n     public static final String PERSON_STATE = \"org.apache.stanbol.enhancer.engines.entitytagging.personState\";\n \n-    @Property(value = \"dbp-ont:Person\")\n+    @Property//(value = \"dbp-ont:Person\")\n     public static final String PERSON_TYPE = \"org.apache.stanbol.enhancer.engines.entitytagging.personType\";\n \n-    @Property(boolValue = true)\n+    @Property//(boolValue = true)\n     public static final String ORG_STATE = \"org.apache.stanbol.enhancer.engines.entitytagging.organisationState\";\n \n-    @Property(value = \"dbp-ont:Organisation\")\n+    @Property//(value = \"dbp-ont:Organisation\")\n     public static final String ORG_TYPE = \"org.apache.stanbol.enhancer.engines.entitytagging.organisationType\";\n \n-    @Property(boolValue = true)\n+    @Property//(boolValue = true)\n     public static final String PLACE_STATE = \"org.apache.stanbol.enhancer.engines.entitytagging.placeState\";\n \n-    @Property(value = \"dbp-ont:Place\")\n+    @Property//(value = \"dbp-ont:Place\")\n     public static final String PLACE_TYPE = \"org.apache.stanbol.enhancer.engines.entitytagging.placeType\";\n-\n+    /**\n+     * Use the RDFS label as default\n+     */\n     @Property(value = \"rdfs:label\")\n     public static final String NAME_FIELD = \"org.apache.stanbol.enhancer.engines.entitytagging.nameField\";\n \n     /**\n-     * Service of the RICK that manages all the active referenced Site. This Service is used to lookup the\n+     * Service of the Entityhub that manages all the active referenced Site. This Service is used to lookup the\n      * configured Referenced Site when we need to enhance a content item.\n      */\n     @Reference\n     protected ReferencedSiteManager siteManager;\n \n     /**\n-     * This is the configured name of the referenced Site used to find entities. The\n-     * {@link ReferencedSiteManager} service of the RICK is used to get the actual {@link ReferencedSite}\n-     * instance for each request to this Engine.\n+     * Used to lookup Entities if the {@link #REFERENCED_SITE_ID} property is\n+     * set to \"entityhub\" or \"local\"\n+     */\n+    @Reference\n+    protected Entityhub entityhub;\n+    \n+    /**\n+     * This holds the id of the {@link ReferencedSite} used to lookup Entities\n+     * or <code>null</code> if the {@link Entityhub} is used. \n      */\n     protected String referencedSiteID;\n \n@@ -125,6 +138,7 @@\n      */\n     public static final Integer defaultOrder = ORDERING_EXTRACTION_ENHANCEMENT;\n \n+\n     /**\n      * State if text annotations of type {@link OntologicalClasses#DBPEDIA_PERSON} are enhanced by this engine\n      */\n@@ -222,6 +236,10 @@ protected void activate(ComponentContext context) throws ConfigurationException\n             throw new ConfigurationException(REFERENCED_SITE_ID,\n                     \"The ID of the Referenced Site is a required Parameter and MUST NOT be an empty String!\");\n         }\n+        if(Entityhub.ENTITYHUB_IDS.contains(this.referencedSiteID.toLowerCase())){\n+            log.info(\"Init NamedEntityTaggingEngine instance for the Entityhub\");\n+            this.referencedSiteID = null;\n+        }\n         Object state = config.get(PERSON_STATE);\n         personState = state == null ? true : Boolean.parseBoolean(state.toString());\n         state = config.get(ORG_STATE);\n@@ -252,21 +270,28 @@ protected void deactivate(ComponentContext context) {\n     }\n \n     public void computeEnhancements(ContentItem ci) throws EngineException {\n-        ReferencedSite site = siteManager.getReferencedSite(referencedSiteID);\n-        if (site == null) {\n-            String msg = String.format(\n-                \"Unable to enhance %s because Referenced Site %s is currently not active!\", ci.getId(),\n-                referencedSiteID);\n-            log.warn(msg);\n-            // TODO: throwing Exceptions is currently deactivated. We need a more clear\n-            // policy what do to in such situations\n-            // throw new EngineException(msg);\n-            return;\n-        }\n-        if (isOfflineMode() && !site.supportsLocalMode()) {\n-            log.warn(\"Unable to enhance ci {} because OfflineMode is not supported by ReferencedSite {}.\",\n-                ci.getId(), site.getId());\n-            return;\n+        final ReferencedSite site;\n+        if(referencedSiteID != null) { //lookup the referenced site\n+            site = siteManager.getReferencedSite(referencedSiteID);\n+            //ensure that it is present\n+            if (site == null) {\n+                String msg = String.format(\n+                    \"Unable to enhance %s because Referenced Site %s is currently not active!\", ci.getId(),\n+                    referencedSiteID);\n+                log.warn(msg);\n+                // TODO: throwing Exceptions is currently deactivated. We need a more clear\n+                // policy what do to in such situations\n+                // throw new EngineException(msg);\n+                return;\n+            }\n+            //and that it supports offline mode if required\n+            if (isOfflineMode() && !site.supportsLocalMode()) {\n+                log.warn(\"Unable to enhance ci {} because OfflineMode is not supported by ReferencedSite {}.\",\n+                    ci.getId(), site.getId());\n+                return;\n+            }\n+        } else { // null indicates to use the Entityhub to lookup Entities\n+            site = null;\n         }\n         UriRef contentItemId = new UriRef(ci.getId());\n \n@@ -292,20 +317,33 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n \n         for (Map.Entry<UriRef,List<UriRef>> entry : textAnnotations.entrySet()) {\n             try {\n-                computeEntityRecommentations(site, literalFactory, graph, contentItemId, entry.getKey(),\n+                computeEntityRecommentations(site,literalFactory, graph, contentItemId, entry.getKey(),\n                     entry.getValue());\n-            } catch (ReferencedSiteException e) {\n+            } catch (EntityhubException e) {\n                 throw new EngineException(this, ci, e);\n             }\n         }\n     }\n \n+    /**\n+     * Computes the Enhancements\n+     * @param site The {@link ReferencedSiteException} id or <code>null</code> to\n+     * use the {@link Entityhub}\n+     * @param literalFactory the {@link LiteralFactory} used to create RDF Literals\n+     * @param graph the graph to write the lined entities\n+     * @param contentItemId the id of the contentItem\n+     * @param textAnnotation the text annotation to enhance\n+     * @param subsumedAnnotations other text annotations for the same entity \n+     * @return the suggested {@link Entity entities}\n+     * @throws EntityhubException On any Error while looking up Entities via\n+     * the Entityhub\n+     */\n     protected final Iterable<Entity> computeEntityRecommentations(ReferencedSite site,\n-                                                                LiteralFactory literalFactory,\n-                                                                MGraph graph,\n-                                                                UriRef contentItemId,\n-                                                                UriRef textAnnotation,\n-                                                                List<UriRef> subsumedAnnotations) throws ReferencedSiteException {\n+            LiteralFactory literalFactory,\n+            MGraph graph,\n+            UriRef contentItemId,\n+            UriRef textAnnotation,\n+            List<UriRef> subsumedAnnotations) throws EntityhubException {\n         // First get the required properties for the parsed textAnnotation\n         // ... and check the values\n         String name = EnhancementEngineHelper.getString(graph, textAnnotation, ENHANCER_SELECTED_TEXT);\n@@ -325,7 +363,9 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n         name = cleanupKeywords(name);\n \n         log.debug(\"Process TextAnnotation \" + name + \" type=\" + type);\n-        FieldQuery query = site.getQueryFactory().createFieldQuery();\n+        FieldQuery query = site == null ? //if site is NULL use the Entityhub\n+                entityhub.getQueryFactory().createFieldQuery() : \n+                    site.getQueryFactory().createFieldQuery();\n         // replace spaces with plus to create an AND search for all words in the name!\n         query.setConstraint(nameField, new TextConstraint(name));// name.replace(' ', '+')));\n         if (OntologicalClasses.DBPEDIA_PERSON.equals(type)) {\n@@ -360,7 +400,9 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n             }\n         }\n         query.setLimit(this.numSuggestions);\n-        QueryResultList<Entity> results = site.findEntities(query);\n+        QueryResultList<Entity> results = site == null? //if site is NULL\n+                entityhub.findEntities(query) : //use the Entityhub\n+                    site.findEntities(query); //else the referenced site\n         log.debug(\"{} results returned by query {}\", results.size(), query);\n \n         List<NonLiteral> annotationsToRelate = new ArrayList<NonLiteral>();\n@@ -370,7 +412,7 @@ public void computeEnhancements(ContentItem ci) throws EngineException {\n         for (Entity guess : results) {\n             log.debug(\"Adding {} to ContentItem {}\", guess, contentItemId);\n             EnhancementRDFUtils.writeEntityAnnotation(this, literalFactory, graph, contentItemId,\n-                annotationsToRelate, guess);\n+                annotationsToRelate, guess, nameField);\n         }\n         return results;\n     }", "filename": "enhancer/engines/entitytagging/src/main/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/NamedEntityTaggingEngine.java"}, {"additions": 2, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/resources/OSGI-INF/metatype/metatype.properties", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/main/resources/OSGI-INF/metatype/metatype.properties", "sha": "ed47ddc55065caad538b9d4f97fba23a7fbf65c2", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/engines/entitytagging/src/main/resources/OSGI-INF/metatype/metatype.properties?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -1,8 +1,8 @@\n #===============================================================================\n #Properties and Options used to configure ReferencedSiteEntityTaggingEnhancementEngine\n #===============================================================================\n-org.apache.stanbol.enhancer.engines.entitytagging.impl.ReferencedSiteEntityTaggingEnhancementEngine.name=Entityhub Referenced Site based Entity-Tagging-Engine\n-org.apache.stanbol.enhancer.engines.entitytagging.impl.ReferencedSiteEntityTaggingEnhancementEngine.description=Enhancement Engine that uses Entities managed by a Entityhub Referenced Site for semantic lifting of TextAnnotations\n+org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine.name=Named Entity Tagging Engine\n+org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine.description=Links named entities (Persons, Organisations, Places) to Entities managed by an Entityhub Referenced Site\n \n org.apache.stanbol.enhancer.engines.entitytagging.referencedSiteId.name=Referenced Site\n org.apache.stanbol.enhancer.engines.entitytagging.referencedSiteId.description=The ID of the Entityhub Referenced Site used for semantic lifting of TextAnnotations", "filename": "enhancer/engines/entitytagging/src/main/resources/OSGI-INF/metatype/metatype.properties"}, {"additions": 2, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/test/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/TestEntityLinkingEnhancementEngine.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/engines/entitytagging/src/test/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/TestEntityLinkingEnhancementEngine.java", "sha": "d3c8f634cd4041db295d8d64c4e6907fd3a469db", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/engines/entitytagging/src/test/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/TestEntityLinkingEnhancementEngine.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -63,8 +63,8 @@\n      */\n     public static final String PLACE = \"New Zealand\";\n \n-    static ReferencedSiteEntityTaggingEnhancementEngine entityLinkingEngine\n-            = new ReferencedSiteEntityTaggingEnhancementEngine();\n+    static NamedEntityTaggingEngine entityLinkingEngine\n+            = new NamedEntityTaggingEngine();\n \n     @BeforeClass\n     public static void setUpServices() throws IOException {", "filename": "enhancer/engines/entitytagging/src/test/java/org/apache/stanbol/enhancer/engines/entitytagging/impl/TestEntityLinkingEnhancementEngine.java"}, {"additions": 1, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java", "sha": "b01ad6b35c024ad1cee5c074f18be4240a22365b", "changes": 2, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -409,7 +409,7 @@ public String getSummary() {\n                 Resource object = abstracts.next().getObject();\n                 if (object instanceof PlainLiteral) {\n                     PlainLiteral abstract_ = (PlainLiteral) object;\n-                    if (abstract_.getLanguage().equals(new Language(\"en\"))) {\n+                    if (new Language(\"en\").equals(abstract_.getLanguage())) {\n                         return abstract_.getLexicalForm();\n                     }\n                 }", "filename": "enhancer/jersey/src/main/java/org/apache/stanbol/enhancer/jersey/resource/ContentItemResource.java"}, {"additions": 5, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/EntityhubImpl.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/EntityhubImpl.java", "sha": "e03c0548b7ae3b448f255d60a9ab331f56e34650", "changes": 10, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/EntityhubImpl.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -402,7 +402,7 @@ private void deleteEntity(Yard yard,Entity entity) throws YardException {\n         }\n     }\n     private void deleteEntities(Yard yard, Collection<String> ids) throws YardException {\n-        FieldQuery fieldQuery = getQueryFavtory().createFieldQuery();\n+        FieldQuery fieldQuery = getQueryFactory().createFieldQuery();\n         Collection<String> toDelete = new HashSet<String>(ids);\n         for(String id : ids){\n             if(id != null && !id.isEmpty()){\n@@ -420,7 +420,7 @@ private void deleteEntities(Yard yard, Collection<String> ids) throws YardExcept\n \n     private void deleteMappingsbyTarget(Yard yard,String id) throws YardException {\n         if(id != null && !id.isEmpty()){\n-            FieldQuery fieldQuery = getQueryFavtory().createFieldQuery();\n+            FieldQuery fieldQuery = getQueryFactory().createFieldQuery();\n             fieldQuery.setConstraint(RdfResourceEnum.mappingTarget.getUri(), new ReferenceConstraint(id));\n             deleteEntities(yard, ModelUtils.asCollection(\n                 yard.findReferences(fieldQuery).iterator()));\n@@ -578,7 +578,7 @@ public Entity getMappingBySource(String reference) throws YardException{\n             log.warn(\"NULL parsed as Reference -> call to getMappingByEntity ignored (return null)\");\n             return null;\n         }\n-        FieldQuery fieldQuery = getQueryFavtory().createFieldQuery();\n+        FieldQuery fieldQuery = getQueryFactory().createFieldQuery();\n         fieldQuery.setConstraint(RdfResourceEnum.mappingSource.getUri(), new ReferenceConstraint(reference));\n         Yard entityhubYard = lookupYard();\n         QueryResultList<Representation> resultList = entityhubYard.findRepresentation(fieldQuery);\n@@ -609,7 +609,7 @@ public Entity getMappingBySource(String reference) throws YardException{\n             log.warn(\"NULL parsed as Reference -> call to getMappingsBySymbol ignored (return null)\");\n             return null;\n         }\n-        FieldQuery fieldQuery = getQueryFavtory().createFieldQuery();\n+        FieldQuery fieldQuery = getQueryFactory().createFieldQuery();\n         fieldQuery.setConstraint(RdfResourceEnum.mappingTarget.getUri(), new ReferenceConstraint(targetId));\n         Yard enttiyhubYard = lookupYard();\n         QueryResultList<Representation> resultList = enttiyhubYard.findRepresentation(fieldQuery);\n@@ -725,7 +725,7 @@ public Entity getMappingById(String id) throws IllegalArgumentException, Entityh\n         }\n     }\n     @Override\n-    public FieldQueryFactory getQueryFavtory() {\n+    public FieldQueryFactory getQueryFactory() {\n         Yard entityhubYard = getYard();\n         return entityhubYard==null? //if no yard available\n                 DefaultQueryFactory.getInstance(): //use the default", "filename": "entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/EntityhubImpl.java"}, {"additions": 6, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java", "sha": "140ecb100d00d73985542d6a19accbb92b78b367", "changes": 6, "status": "modified", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -612,6 +612,12 @@ protected void activate(final ComponentContext context) throws ConfigurationExce\n         }\n         //NOTE that the constructor also validation of the parsed configuration\n         siteConfiguration = new DefaultSiteConfiguration(config);\n+        if(PROHIBITED_SITE_IDS.contains(siteConfiguration.getId().toLowerCase())){\n+            throw new ConfigurationException(SiteConfiguration.ID, String.format(\n+                \"The ID '%s' of this Referenced Site is one of the following \" +\n+                \"prohibited IDs: {} (case insensitive)\",siteConfiguration.getId(),\n+                PROHIBITED_SITE_IDS));\n+        }\n         log.info(\" > initialise Referenced Site {}\",siteConfiguration.getName());\n         //if the accessUri is the same as the queryUri and both the dereferencer and\n         //the entitySearcher uses the same component, than we need only one component", "filename": "entityhub/generic/core/src/main/java/org/apache/stanbol/entityhub/core/impl/ReferencedSiteImpl.java"}, {"additions": 17, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/Entityhub.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/Entityhub.java", "sha": "e9a9c06f0726e0ff06bff3a3eceac2f7c02a2462", "changes": 18, "status": "modified", "deletions": 1, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/Entityhub.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -16,7 +16,11 @@\n  */\n package org.apache.stanbol.entityhub.servicesapi;\n \n+import java.util.Arrays;\n import java.util.Collection;\n+import java.util.Collections;\n+import java.util.HashSet;\n+import java.util.Set;\n \n import org.apache.stanbol.entityhub.servicesapi.mapping.FieldMapper;\n import org.apache.stanbol.entityhub.servicesapi.mapping.FieldMapping;\n@@ -46,6 +50,18 @@\n public interface Entityhub {\n \n     String DEFAUTL_ENTITYHUB_PREFIX = \"urn:org.apache.stanbol:entityhub\";\n+    /**\n+     * Protected keys to be used as name for the Entityhub. Such keys MUST NOT\n+     * be used as {@link ReferencedSite#getId() id}s for \n+     * {@link ReferencedSite}s. (case insensitive)<p>\n+     * The protected values are <ul>\n+     * <li><code>\"local\"</code>\n+     * <li><code>\"entityhub\"</code>\n+     * </ul>\n+     */\n+    Set<String> ENTITYHUB_IDS = Collections.unmodifiableSet(\n+        new HashSet<String>(Arrays.asList(\n+            \"local\",\"entityhub\")));\n \n     /**\n      * Getter for the Yard storing the Entities and Mappings managed by this\n@@ -150,7 +166,7 @@\n      * {@link Yard} used by the entity hub.\n      * @return the query factory\n      */\n-    FieldQueryFactory getQueryFavtory();\n+    FieldQueryFactory getQueryFactory();\n     /**\n      * Getter for the FieldMappings configured for this Site\n      * @return The {@link FieldMapping} present for this Site.", "filename": "entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/Entityhub.java"}, {"additions": 102, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/defaults/NamespaceEnum.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/defaults/NamespaceEnum.java", "sha": "c54d71b958162b73f7110e3e02b31f69a524e547", "changes": 118, "status": "modified", "deletions": 16, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/defaults/NamespaceEnum.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -19,13 +19,17 @@\n import java.util.Collections;\n import java.util.HashMap;\n import java.util.Map;\n+\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n /**\n  * Defines commonly used name spaces to prevent multiple definitions in several\n  * classes\n  * @author Rupert Westenthaler\n  *\n  */\n public enum NamespaceEnum {\n+    \n     //Namespaces defined by the entityhub\n     entityhubModel(\"entityhub\",\"http://www.iks-project.eu/ontology/rick/model/\"),\n     entityhubQuery(\"entityhub-query\",\"http://www.iks-project.eu/ontology/rick/query/\"),\n@@ -69,18 +73,76 @@\n     geonames(\"http://www.geonames.org/ontology#\"),\n     //copyright and license\n     cc(\"http://creativecommons.org/ns#\"),\n+    //Schema.org (see http://schema.org/docs/schemaorg.owl for the Ontology)\n+    schema(\"http://schema.org/\",true),\n     ;\n-    private String ns;\n-    private String prefix;\n+    /**\n+     * The logger\n+     */\n+    private static final Logger log = LoggerFactory.getLogger(NamespaceEnum.class);\n+\n+    private final String ns;\n+    private final String prefix;\n+    private final boolean defaultPrefix;\n+    /**\n+     * Defines a namespace that used the {@link #name()} as prefix.\n+     * @param ns the namespace. MUST NOT be NULL nor empty\n+     */\n     NamespaceEnum(String ns) {\n-        if(ns == null){\n-            throw new IllegalArgumentException(\"The namespace MUST NOT be NULL\");\n-        }\n-        this.ns = ns;\n+        this(null,ns,false);\n+    }\n+    /**\n+     * Defines a namespace by using the {@link #name()} as prefix. If\n+     * <code>true</code> is parsed a second parameter this namespace is marked\n+     * as the default<p>\n+     * <b>NOTE: </b> Only a single namespace can be defined as default. In case\n+     * multiple namespaces are marked as default the one with the lowest\n+     * {@link #ordinal()} will be used as default. This will be the topmost entry\n+     * in this enumeration.\n+     * @param ns the namespace. MUST NOT be <code>null</code> nor empty\n+     * @param defaultPrefix the default namespace indicator\n+     */\n+    NamespaceEnum(String ns,boolean defaultPrefix) {\n+        this(null,ns,defaultPrefix);\n     }\n+    /**\n+     * Defines a namespace with a customised prefix. This should be used if the\n+     * prefix needs to be different as the {@link #name()} of the enumeration\n+     * entry.\n+     * @param prefix the prefix. If <code>null</code> the {@link #name()} is\n+     * used. MUST NOT be an empty string\n+     * @param ns the namespace. MUST NOT be <code>null</code> nor empty\n+     */\n     NamespaceEnum(String prefix, String ns) {\n-        this(ns);\n-        this.prefix = prefix;\n+        this(prefix,ns,false);\n+    }\n+    /**\n+     * Defines a namespace with a customised prefix. This should be used if the\n+     * prefix needs to be different as the {@link #name()} of the enumeration\n+     * entry.<p>\n+     * <b>NOTE: </b> Only a single namespace can be defined as default. In case\n+     * multiple namespaces are marked as default the one with the lowest\n+     * {@link #ordinal()} will be used as default. This will be the topmost entry\n+     * in this enumeration.\n+     * @param prefix the prefix. If <code>null</code> the {@link #name()} is\n+     * used. MUST NOT be an empty string\n+     * @param ns the namespace. MUST NOT be <code>null</code> nor empty\n+     * @param defaultPrefix the default namespace indicator\n+     */\n+    NamespaceEnum(String prefix, String ns,boolean defaultPrefix) {\n+        if(ns == null || ns.isEmpty()){\n+            throw new IllegalArgumentException(\"The namespace MUST NOT be NULL nor empty\");\n+        }\n+        this.ns = ns;\n+        if(prefix == null){\n+            this.prefix = name();\n+        } else if(prefix.isEmpty()){\n+            throw new IllegalArgumentException(\"The prefix MUST NOT be emtpty.\" +\n+            \t\t\"Use NULL to use the name or parse the prefix to use\");\n+        } else {\n+            this.prefix = prefix;\n+        }\n+        this.defaultPrefix = defaultPrefix;\n     }\n     public String getNamespace(){\n         return ns;\n@@ -95,21 +157,35 @@ public String toString() {\n     /*\n      * ==== Code for Lookup Methods based on Prefix and Namespace ====\n      */\n-    private static Map<String, NamespaceEnum> prefix2Namespace;\n-    private static Map<String, NamespaceEnum> namespace2Prefix;\n+    private final static Map<String, NamespaceEnum> prefix2Namespace;\n+    private final static Map<String, NamespaceEnum> namespace2Prefix;\n+    private final static NamespaceEnum defaultNamespace;\n     static {\n         Map<String,NamespaceEnum> p2n = new HashMap<String, NamespaceEnum>();\n         Map<String,NamespaceEnum> n2p = new HashMap<String, NamespaceEnum>();\n         //The Exceptions are only thrown to check that this Enum is configured\n         //correctly!\n+        NamespaceEnum defaultNs = null;\n         for(NamespaceEnum entry : NamespaceEnum.values()){\n+            if(entry.isDefault()){\n+                if(defaultNs == null){\n+                    defaultNs = entry;\n+                } else {\n+                    log.warn(\"Found multiple default namespace definitions! Will use the one with the lowest ordinal value.\");\n+                    log.warn(\" > used default: prefix:{}, namespace:{}, ordinal:{}\",\n+                        new Object[]{defaultNs.getPrefix(),defaultNs.getNamespace(),defaultNs.ordinal()});\n+                    log.warn(\" > this one    : prefix:{}, namespace:{}, ordinal:{}\",\n+                        new Object[]{entry.getPrefix(),entry.getNamespace(),entry.ordinal()});\n+                }\n+            }\n             if(p2n.containsKey(entry.getPrefix())){\n                 throw new IllegalStateException(\n                         String.format(\"Prefix %s used for multiple namespaces: %s and %s\",\n                                 entry.getPrefix(),\n                                 p2n.get(entry.getPrefix()),\n                                 entry.getNamespace()));\n             } else {\n+                log.debug(\"add {} -> {} mapping\",entry.getPrefix(),entry.getNamespace());\n                 p2n.put(entry.getPrefix(), entry);\n             }\n             if(n2p.containsKey(entry.getNamespace())){\n@@ -119,11 +195,13 @@ public String toString() {\n                                 p2n.get(entry.getNamespace()),\n                                 entry.getNamespace()));\n             } else {\n+                log.debug(\"add {} -> {} mapping\",entry.getNamespace(),entry.getPrefix());\n                 n2p.put(entry.getNamespace(), entry);\n             }\n         }\n         prefix2Namespace = Collections.unmodifiableMap(p2n);\n         namespace2Prefix = Collections.unmodifiableMap(n2p);\n+        defaultNamespace = defaultNs;\n     }\n     /**\n      * Getter for the {@link NamespaceEnum} entry based on the string namespace\n@@ -136,18 +214,18 @@ public static NamespaceEnum forNamespace(String namespace){\n     }\n     /**\n      * Getter for the {@link NamespaceEnum} entry based on the prefix\n-     * @param prefix the prefix\n+     * @param prefix the prefix or <code>null</code> to get the default namespace\n      * @return the {@link NamespaceEnum} entry or <code>null</code> if the prased\n      *    prefix is not present\n      */\n     public static NamespaceEnum forPrefix(String prefix){\n-        return prefix2Namespace.get(prefix);\n+        return prefix == null ? defaultNamespace : prefix2Namespace.get(prefix);\n     }\n     /**\n-     * Lookup if the parsed URI uses one of the registered prefixes of this\n-     * Enumeration. If this is the case, the prefix is replaced by the namespace\n-     * and the full URI is returned. If no prefix is returned, the\n-     * parsed URI is returned\n+     * Lookup if the parsed short URI (e.g \"rdfs:label\") uses one of the \n+     * registered prefixes of this Enumeration of if the parsed short URI uses\n+     * the default namespace (e.g. \"name\"). In case the prefix could not be found\n+     * the parsed URI is returned unchanged\n      * @param shortUri the short URI\n      * @return the full URI if the parsed shortUri uses a prefix defined by this\n      * Enumeration. Otherwise the parsed value.\n@@ -162,7 +240,15 @@ public static String getFullName(String shortUri){\n             if(namespace!= null){\n                 shortUri = namespace.getNamespace()+shortUri.substring(index+1);\n             }\n+        } else if(defaultNamespace != null){\n+            shortUri = defaultNamespace.getNamespace()+shortUri;\n         }\n         return shortUri;\n     }\n+    /**\n+     * @return the defaultPrefix\n+     */\n+    public boolean isDefault() {\n+        return defaultPrefix;\n+    }\n }", "filename": "entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/defaults/NamespaceEnum.java"}, {"additions": 10, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/site/ReferencedSite.java", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/site/ReferencedSite.java", "sha": "1e4e46426bf38c05d4016da3b6165a588c16b7e8", "changes": 12, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/site/ReferencedSite.java?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -17,7 +17,9 @@\n package org.apache.stanbol.entityhub.servicesapi.site;\n \n import java.io.InputStream;\n+import java.util.Set;\n \n+import org.apache.stanbol.entityhub.servicesapi.Entityhub;\n import org.apache.stanbol.entityhub.servicesapi.mapping.FieldMapper;\n import org.apache.stanbol.entityhub.servicesapi.mapping.FieldMapping;\n import org.apache.stanbol.entityhub.servicesapi.model.Representation;\n@@ -30,10 +32,16 @@\n \n public interface ReferencedSite {\n \n+    /**\n+     * List of {@link #getId() ids} that are not allowed to be used (case\n+     * insensitive) for referenced sites.\n+     */\n+    Set<String> PROHIBITED_SITE_IDS = Entityhub.ENTITYHUB_IDS;\n     /**\n      * The Id of this site. This Method MUST return the same value as\n-     * <code>{@link #getConfiguration()}.getId()</code>. It is only there to\n-     * make it more easy to access the Id of the site\n+     * <code>{@link #getConfiguration()}.getId()</code>.\n+     * The configured ID MUST NOT be <code>null</code>, empty or one of the\n+     * {@link #PROHIBITED_SITE_IDS}.\n      * @return the ID of this site\n      */\n     String getId();", "filename": "entityhub/generic/servicesapi/src/main/java/org/apache/stanbol/entityhub/servicesapi/site/ReferencedSite.java"}, {"additions": 2, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/dblp/src/main/resources/indexing/config/indexing.properties", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/dblp/src/main/resources/indexing/config/indexing.properties", "sha": "ab74241978b61957de0aabcfd681638ffe59c14f", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/indexing/dblp/src/main/resources/indexing/config/indexing.properties?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -31,10 +31,10 @@ indexingDestination=org.apache.stanbol.entityhub.indexing.destination.solryard.S\n org.apache.stanbol.entityhub.site.entityPrefix=http://dblp.l3s.de/d2r/resource\n \n org.apache.stanbol.entityhub.site.accessUri=http://dblp.l3s.de/d2r/resource/\n-org.apache.stanbol.entityhub.site.dereferencerType=org.apache.stanbol.entityhub.site.CoolUriDereferencer\n+org.apache.stanbol.entityhub.site.dereferencerType=org.apache.stanbol.entityhub.dereferencer.CoolUriDereferencer\n # The SPARQL endpoint is a d2r server so use a standard sparql server\n org.apache.stanbol.entityhub.site.queryUri=http://dblp.l3s.de/d2r/sparql\n-org.apache.stanbol.entityhub.site.searcherType=org.apache.stanbol.entityhub.site.SparqlSearcher\n+org.apache.stanbol.entityhub.site.searcherType=org.apache.stanbol.entityhub.searcher.SparqlSearcher\n \n # The mappings used when importing an entity form this site to the Entityhub (optional)\n # The value need to point to the file with the mappings within the config directory", "filename": "entityhub/indexing/dblp/src/main/resources/indexing/config/indexing.properties"}, {"additions": 2, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/dbpedia/src/main/resources/indexing/config/indexing.properties", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/dbpedia/src/main/resources/indexing/config/indexing.properties", "sha": "dbd8f4312bd41e166738d1e08cd760dd49d1eae5", "changes": 4, "status": "modified", "deletions": 2, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/indexing/dbpedia/src/main/resources/indexing/config/indexing.properties?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -49,9 +49,9 @@ org.apache.stanbol.entityhub.site.entityPrefix=http://dbpedia.org/resource/;http\n # Dereferencer should use SPARQL because Cool URI will omit statements for popular\n # Entities. \n org.apache.stanbol.entityhub.site.accessUri=http://dbpedia.org/sparql/\n-org.apache.stanbol.entityhub.site.dereferencerType=org.apache.stanbol.entityhub.site.SparqlDereferencer\n+org.apache.stanbol.entityhub.site.dereferencerType=org.apache.stanbol.entityhub.dereferencer.SparqlDereferencer\n # The SPARQL endpoint of DBpedia supports Virtuoso specific extensions\n-org.apache.stanbol.entityhub.site.searcherType=org.apache.stanbol.entityhub.site.VirtuosoSearcher\n+org.apache.stanbol.entityhub.site.searcherType=org.apache.stanbol.entityhub.searcher.VirtuosoSearcher\n org.apache.stanbol.entityhub.site.queryUri=http://dbpedia.org/sparql\n \n # The mappings used when importing an entity form this site to the Entityhub (optional)", "filename": "entityhub/indexing/dbpedia/src/main/resources/indexing/config/indexing.properties"}, {"additions": 5, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/genericrdf/src/main/resources/indexing/config/indexing.properties", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/entityhub/indexing/genericrdf/src/main/resources/indexing/config/indexing.properties", "sha": "843399800347e7c10e91878896f8d713f4b4f537", "changes": 10, "status": "modified", "deletions": 5, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/entityhub/indexing/genericrdf/src/main/resources/indexing/config/indexing.properties?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -114,16 +114,16 @@ indexingDestination=org.apache.stanbol.entityhub.indexing.destination.solryard.S\n #org.apache.stanbol.entityhub.site.accessUri=http://example.org/resource\"\n #org.apache.stanbol.entityhub.site.dereferencerType=\n # available EntityDereferencer implementation\n-# - org.apache.stanbol.entityhub.site.CoolUriDereferencer\n-# - org.apache.stanbol.entityhub.site.SparqlDereferencer\n+# - org.apache.stanbol.entityhub.dereferencer.CoolUriDereferencer\n+# - org.apache.stanbol.entityhub.dereferencer.SparqlDereferencer\n \n # (b) search entities (queryUri and EntitySearcher implementation)\n #org.apache.stanbol.entityhub.site.queryUri=http://example.org/sparql\n #org.apache.stanbol.entityhub.site.searcherType=\n # available EntitySearcher implementation\n-# - org.apache.stanbol.entityhub.site.SparqlSearcher (generic SPARQL)\n-# - org.apache.stanbol.entityhub.site.LarqSearcher (Larq SPARQL extensions)\n-# - org.apache.stanbol.entityhub.site.VirtuosoSearcher (Virtuoso SPARQL extensions)\n+# - org.apache.stanbol.entityhub.searcher.SparqlSearcher (generic SPARQL)\n+# - org.apache.stanbol.entityhub.searcher.LarqSearcher (Larq SPARQL extensions)\n+# - org.apache.stanbol.entityhub.searcher.VirtuosoSearcher (Virtuoso SPARQL extensions)\n \n # The referenced site can also specify additional mappings to be used in the\n # case an entity of this site is imported to the Entityhub.", "filename": "entityhub/indexing/genericrdf/src/main/resources/indexing/config/indexing.properties"}, {"additions": 0, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-dbpedia.config", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-dbpedia.config", "previous_filename": "launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.ReferencedSiteEntityTaggingEnhancementEngine-DBpedia.config", "sha": "7f7f03a2d797705e1ee3ecb1b6a350bc9a59faef", "changes": 0, "status": "renamed", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-dbpedia.config?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "filename": "launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-dbpedia.config"}, {"additions": 8, "raw_url": "https://github.com/apache/stanbol/raw/250d599350b2fe0019bc470aba76f5addfbabb48/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-local.config", "blob_url": "https://github.com/apache/stanbol/blob/250d599350b2fe0019bc470aba76f5addfbabb48/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-local.config", "sha": "a25d8f22b55dc314b2065a9f1aabccf6e6bb1b14", "changes": 8, "status": "added", "deletions": 0, "contents_url": "https://api.github.com/repos/apache/stanbol/contents/launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-local.config?ref=250d599350b2fe0019bc470aba76f5addfbabb48", "patch": "@@ -0,0 +1,8 @@\n+org.apache.stanbol.enhancer.engines.entitytagging.nameField=\"name\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.personType=\"Person\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.personState=B\"true\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.referencedSiteId=\"local\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.placeState=B\"true\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.organisationState=B\"true\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.organisationType=\"Organization\"\r\n+org.apache.stanbol.enhancer.engines.entitytagging.placeType=\"Place\"\r", "filename": "launchers/full/src/main/resources/resources/config/org.apache.stanbol.enhancer.engines.entitytagging.impl.NamedEntityTaggingEngine-local.config"}], "repo": "stanbol"}]
