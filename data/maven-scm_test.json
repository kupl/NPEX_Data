{
    "maven-scm_02120da": {
        "bug_id": "maven-scm_02120da",
        "commit": "https://github.com/apache/maven-scm/commit/02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/maven-scm/blob/02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/AbstractChangeLogCommand.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/AbstractChangeLogCommand.java?ref=02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6",
                "deletions": 0,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/AbstractChangeLogCommand.java",
                "patch": "@@ -90,6 +90,10 @@ public ScmResult executeCommand( ScmProviderRepository repository, ScmFileSet fi\n \n                 endDate = new Date( System.currentTimeMillis() + (long) 1 * 24 * 60 * 60 * 1000 );\n             }\n+            else if ( endDate == null )\n+            {\n+                endDate = new Date();\n+            }\n \n             return executeChangeLogCommand( repository, fileSet, startDate, endDate, branch, datePattern );\n         }",
                "raw_url": "https://github.com/apache/maven-scm/raw/02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/AbstractChangeLogCommand.java",
                "sha": "75d3702988419c7da067503e4bd77c6d20ea47b7",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/maven-scm/blob/02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/changelog/VssHistoryCommand.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/changelog/VssHistoryCommand.java?ref=02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/changelog/VssHistoryCommand.java",
                "patch": "@@ -110,6 +110,11 @@ public Commandline buildCmdLine( VssScmProviderRepository repo, ScmFileSet fileS\n         //Display only versions that fall within specified data range.\n         if ( startDate != null )\n         {\n+            if ( endDate == null )\n+            {\n+                endDate = new Date(); // = now\n+            }\n+\n             SimpleDateFormat sdf = new SimpleDateFormat( \"dd/MM/yyyy\", Locale.ENGLISH );\n             String dateRange = sdf.format( endDate ) + \"~\" + sdf.format( startDate );\n             command.createArgument().setValue( VssConstants.FLAG_VERSION_DATE + dateRange );",
                "raw_url": "https://github.com/apache/maven-scm/raw/02120dab2bc5c2d16b97f5bb63144a5bd79dc3d6/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/changelog/VssHistoryCommand.java",
                "sha": "904292455ae5813f7b7697ae7e70d7f7396153bf",
                "status": "modified"
            }
        ],
        "message": "[SCM-278] Fix NPE when endDate is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@517192 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/052e5a234fc6d6c9391a8f02e4a8b6ab51a133f7",
        "patched_files": [
            "VssHistoryCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "VssHistoryCommandTest.java"
        ]
    },
    "maven-scm_026e5be": {
        "bug_id": "maven-scm_026e5be",
        "commit": "https://github.com/apache/maven-scm/commit/026e5bea21f86ade36ed3f09f338fbe29c699153",
        "file": [
            {
                "additions": 13,
                "blob_url": "https://github.com/apache/maven-scm/blob/026e5bea21f86ade36ed3f09f338fbe29c699153/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java?ref=026e5bea21f86ade36ed3f09f338fbe29c699153",
                "deletions": 8,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "patch": "@@ -333,14 +333,19 @@ public String toXML()\n     {\n         StringBuffer buffer = new StringBuffer();\n \n-        buffer.append( \"\\t<changelog-entry>\\n\" )\n-            .append( \"\\t\\t<date pattern=\\\"\" + DATE_PATTERN + \"\\\">\" )\n-            .append( getDateFormatted() )\n-            .append( \"</date>\\n\" )\n-            .append( \"\\t\\t<time pattern=\\\"\" + TIME_PATTERN + \"\\\">\" )\n-            .append( getTimeFormatted() )\n-            .append( \"</time>\\n\" )\n-            .append( \"\\t\\t<author><![CDATA[\" )\n+        buffer.append( \"\\t<changelog-entry>\\n\" );\n+\n+        if ( getDate() != null )\n+        {\n+            buffer.append( \"\\t\\t<date pattern=\\\"\" + DATE_PATTERN + \"\\\">\" )\n+                .append( getDateFormatted() )\n+                .append( \"</date>\\n\" )\n+                .append( \"\\t\\t<time pattern=\\\"\" + TIME_PATTERN + \"\\\">\" )\n+                .append( getTimeFormatted() )\n+                .append( \"</time>\\n\" );\n+        }\n+\n+        buffer.append( \"\\t\\t<author><![CDATA[\" )\n             .append( author )\n             .append( \"]]></author>\\n\" );\n ",
                "raw_url": "https://github.com/apache/maven-scm/raw/026e5bea21f86ade36ed3f09f338fbe29c699153/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "sha": "4459130047ca78cb4e95a9acb5d1550b2d72fa6c",
                "status": "modified"
            },
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/maven-scm/blob/026e5bea21f86ade36ed3f09f338fbe29c699153/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/ChangeLogSet.java",
                "changes": 23,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/ChangeLogSet.java?ref=026e5bea21f86ade36ed3f09f338fbe29c699153",
                "deletions": 5,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/ChangeLogSet.java",
                "patch": "@@ -105,11 +105,24 @@ public String toXML()\n         String pattern = \"yyyyMMdd HH:mm:ss z\";\n         SimpleDateFormat formatter = new SimpleDateFormat( pattern );\n \n-        buffer.append( \"<changeset datePattern=\\\"\" + pattern + \"\\\" start=\\\"\" )\n-            .append( formatter.format( startDate ) )\n-            .append( \"\\\" end=\\\"\" )\n-            .append( formatter.format( endDate ) )\n-            .append( \"\\\">\\n\" );\n+        buffer.append( \"<changeset datePattern=\\\"\" )\n+            .append( pattern )\n+            .append( \"\\\"\" );\n+\n+        if ( startDate != null )\n+        {\n+            buffer.append( \" start=\\\"\" )\n+                .append( formatter.format( startDate ) )\n+                .append( \"\\\"\" );\n+        }\n+        if ( endDate != null )\n+        {\n+            buffer.append( \" end=\\\"\" )\n+                .append( formatter.format( endDate ) )\n+                .append( \"\\\">\" );\n+        }\n+\n+        buffer.append( \"\\n\" );\n \n         //  Write out the entries\n         for ( Iterator i = getChangeSets().iterator(); i.hasNext(); )",
                "raw_url": "https://github.com/apache/maven-scm/raw/026e5bea21f86ade36ed3f09f338fbe29c699153/maven-scm-api/src/main/java/org/apache/maven/scm/command/changelog/ChangeLogSet.java",
                "sha": "1ac10ac581f5e9af94b6fd1ec49685be71f897a6",
                "status": "modified"
            }
        ],
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@374372 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/c1d24b976f08c4e548747194817c5cd2c3410cc4",
        "patched_files": [
            "ChangeSet.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ChangeSetTest.java"
        ]
    },
    "maven-scm_052e5a2": {
        "bug_id": "maven-scm_052e5a2",
        "commit": "https://github.com/apache/maven-scm/commit/052e5a234fc6d6c9391a8f02e4a8b6ab51a133f7",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/maven-scm/blob/052e5a234fc6d6c9391a8f02e4a8b6ab51a133f7/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java?ref=052e5a234fc6d6c9391a8f02e4a8b6ab51a133f7",
                "deletions": 0,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "patch": "@@ -134,6 +134,10 @@ public ChangeSet()\n      */\n     public List getFiles()\n     {\n+        if ( files == null )\n+        {\n+            return new ArrayList();\n+        }\n         return files;\n     }\n ",
                "raw_url": "https://github.com/apache/maven-scm/raw/052e5a234fc6d6c9391a8f02e4a8b6ab51a133f7/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "sha": "ef4f13ebb14f15d9724918222ff79a314d030c58",
                "status": "modified"
            }
        ],
        "message": "[SCM-283] Fix possible NPE when files list is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@517191 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/b4f98f0d051170c5fe7b3fc9cced0fa9b70cb7f2",
        "patched_files": [
            "ChangeSet.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ChangeSetTest.java"
        ]
    },
    "maven-scm_0f72920": {
        "bug_id": "maven-scm_0f72920",
        "commit": "https://github.com/apache/maven-scm/commit/0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
        "file": [
            {
                "additions": 100,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumer.java",
                "changes": 100,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumer.java?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumer.java",
                "patch": "@@ -0,0 +1,100 @@\n+package org.apache.maven.scm.provider.git.gitexe.command.update;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import org.apache.maven.scm.log.ScmLogger;\n+import org.apache.maven.scm.util.AbstractConsumer;\n+import org.apache.regexp.RE;\n+import org.apache.regexp.RESyntaxException;\n+import org.codehaus.plexus.util.StringUtils;\n+\n+/**\n+ * @author <a href=\"mailto:struberg@yahoo.de\">Mark Struberg</a>\n+ * @version $Id$\n+ */\n+public class GitLatestRevisionCommandConsumer\n+    extends AbstractConsumer\n+{\n+\n+    /**\n+     * The pattern used to match git log latest revision lines\n+     */\n+    private static final String LATESTREV_PATTERN = \"^commit \\\\s*(.*)\";\n+\n+    /**\n+     * The regular expression used to match git log latest revision lines\n+     */\n+    private RE latestRevRegexp;\n+\n+    private String latestRevision;\n+\n+    public GitLatestRevisionCommandConsumer( ScmLogger logger )\n+    {\n+        super( logger );\n+\n+        try\n+        {\n+            latestRevRegexp = new RE( LATESTREV_PATTERN );\n+        }\n+        catch ( RESyntaxException ex )\n+        {\n+            throw new RuntimeException(\n+                                        \"INTERNAL ERROR: Could not create regexp to parse git log file. This shouldn't happen. Something is probably wrong with the oro installation.\",\n+                                        ex );\n+        }\n+\n+    }\n+\n+    /** {@inheritDoc} */\n+    public void consumeLine( String line )\n+    {\n+        if ( getLogger().isDebugEnabled() )\n+        {\n+            getLogger().debug( \"GitLatestRevisionCommandConsumer consumeLine : \" + line );\n+        }\n+        if ( line == null || StringUtils.isEmpty( line ) )\n+        {\n+            return;\n+        }\n+\n+        processGetLatestRevision( line );\n+    }\n+\n+    public String getLatestRevision()\n+    {\n+        return latestRevision;\n+    }\n+\n+    /**\n+     * Process the current input line for the latest revision\n+     *\n+     * @param line A line of text from the git log output\n+     */\n+    private void processGetLatestRevision( String line )\n+    {\n+        if ( !latestRevRegexp.match( line ) )\n+        {\n+            return;\n+        }\n+\n+        latestRevision = latestRevRegexp.getParen( 1 );\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumer.java",
                "sha": "d008d4a0b05732e3957c00569147af43ed43f141",
                "status": "added"
            },
            {
                "additions": 52,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommand.java",
                "changes": 56,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommand.java?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 4,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommand.java",
                "patch": "@@ -19,6 +19,8 @@\n  * under the License.\n  */\n \n+import java.io.File;\n+\n import org.apache.maven.scm.ScmBranch;\n import org.apache.maven.scm.ScmException;\n import org.apache.maven.scm.ScmFileSet;\n@@ -63,7 +65,7 @@ protected UpdateScmResult executeUpdateCommand( ScmProviderRepository repo, ScmF\n \n         CommandLineUtils.StringStreamConsumer stderr = new CommandLineUtils.StringStreamConsumer();\n \n-        Commandline cl = createCommandLine( repository, fileSet, scmVersion );\n+        Commandline cl = createCommandLine( repository, fileSet.getBasedir(), scmVersion );\n         exitCode = GitCommandLineUtils.execute( cl, consumer, stderr, getLogger() );\n         if ( exitCode != 0 )\n         {\n@@ -74,7 +76,23 @@ protected UpdateScmResult executeUpdateCommand( ScmProviderRepository repo, ScmF\n             return new UpdateScmResult( cl.toString(), \"The git-pull origin master command failed.\",\n                                         stderr.getOutput(), false );\n         }\n-        return new UpdateScmResultWithRevision( cl.toString(), consumer.getUpdatedFiles(), null );\n+        \n+        // now let's get the latest version\n+        Commandline clRev = createLatestRevisionCommandLine( repository, fileSet.getBasedir(), scmVersion );\n+        GitLatestRevisionCommandConsumer consumerRev = new GitLatestRevisionCommandConsumer( getLogger() );\n+        exitCode = GitCommandLineUtils.execute( clRev, consumerRev, stderr, getLogger() );\n+        if ( exitCode != 0 )\n+        {\n+            if ( getLogger().isWarnEnabled() )\n+            {\n+                getLogger().warn( \"failed to update git, return code \" + exitCode );\n+            }\n+            return new UpdateScmResult( cl.toString(), \"The git-log command failed.\",\n+                                        stderr.getOutput(), false );\n+        }\n+        String latestRevision = consumerRev.getLatestRevision();\n+        \n+        return new UpdateScmResultWithRevision( cl.toString(), consumer.getUpdatedFiles(), latestRevision );\n     }\n \n     /** {@inheritDoc} */\n@@ -89,9 +107,9 @@ protected ChangeLogCommand getChangeLogCommand()\n     /**\n      * create the command line for updating the current branch with the info from the foreign repository. \n      */\n-    public static Commandline createCommandLine( GitScmProviderRepository repository, ScmFileSet fileSet, ScmVersion scmVersion ) \n+    public static Commandline createCommandLine( GitScmProviderRepository repository, File workingDirectory, ScmVersion scmVersion ) \n     {\n-        Commandline cl = GitCommandLineUtils.getBaseGitCommandLine( fileSet.getBasedir(), \"pull\" );\n+        Commandline cl = GitCommandLineUtils.getBaseGitCommandLine( workingDirectory, \"pull\" );\n         \n         cl.createArg().setLine( \"origin\" );\n \n@@ -107,4 +125,34 @@ public static Commandline createCommandLine( GitScmProviderRepository repository\n         \n         return cl;\n     }\n+    \n+    /**\n+     * @param scmVersion a valid branch or <code>null</code> if the master branch should be taken\n+     * @return CommandLine for getting the latest commit on the given branch\n+     */\n+    public static Commandline createLatestRevisionCommandLine(GitScmProviderRepository repository, File workingDirectory,\n+                                                               ScmVersion scmVersion)\n+    {\n+        Commandline cl = GitCommandLineUtils.getBaseGitCommandLine( workingDirectory, \"log\" );\n+        \n+        // only show exactly 1 commit\n+        cl.createArg().setValue( \"-n1\" ); \n+        \n+        // same as --topo-order, but ensure ordering of merges\n+        cl.createArg().setValue( \"--date-order\" );\n+        \n+        if ( scmVersion != null && scmVersion instanceof ScmBranch && \n+             scmVersion.getName() != null && scmVersion.getName().length() > 0 )\n+        {\n+            // if any branch is given, lets take em\n+            cl.createArg().setValue( scmVersion.getName() );\n+        }\n+        else\n+        {\n+            // otherwise we work on the master branch\n+            cl.createArg().setValue( \"master\" );\n+        }\n+        \n+        return cl;\n+    }\n }",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/main/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommand.java",
                "sha": "99c2c9df08facdf988c7f3d0de8e748059a8c6aa",
                "status": "modified"
            },
            {
                "additions": 77,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumerTest.java",
                "changes": 77,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumerTest.java?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumerTest.java",
                "patch": "@@ -0,0 +1,77 @@\n+package org.apache.maven.scm.provider.git.gitexe.command.update;\n+\n+import java.io.BufferedReader;\n+import java.io.File;\n+import java.io.Reader;\n+\n+import org.apache.maven.scm.log.DefaultLog;\n+import org.codehaus.plexus.PlexusTestCase;\n+import org.codehaus.plexus.util.ReaderFactory;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+/**\n+ * @author <a href=\"mailto:struberg@yahoo.de\">Mark Struberg</a>\n+ * @since 1.2\n+ * @version $Id$\n+ */\n+public class GitLatestRevisionCommandConsumerTest\n+    extends PlexusTestCase\n+{\n+    public void testUpToDate()\n+        throws Exception\n+    {\n+\n+        GitLatestRevisionCommandConsumer consumer = buildGitLatestRevisionCommandConsumer( \"/src/test/resources/git/update/git-update-latest-rev.out\" );\n+\n+        String latestRev = consumer.getLatestRevision();\n+\n+        assertNotNull( latestRev );\n+        assertEquals( \"a300c56a341bae8d0eb5ec4ed5551a11c75a5a6e\", latestRev );\n+    }\n+\n+    \n+    // utils methods\n+\n+    private GitLatestRevisionCommandConsumer buildGitLatestRevisionCommandConsumer( String fileName )\n+        throws Exception\n+    {\n+        GitLatestRevisionCommandConsumer consumer = new GitLatestRevisionCommandConsumer( new DefaultLog() );\n+\n+        BufferedReader r = getGitLogBufferedReader( fileName );\n+\n+        String line;\n+\n+        while ( ( line = r.readLine() ) != null )\n+        {\n+            //System.out.println(\" line \" + line );\n+            consumer.consumeLine( line );\n+        }\n+        return consumer;\n+    }\n+\n+    private BufferedReader getGitLogBufferedReader( String fileName )\n+        throws Exception\n+    {\n+        File f = getTestFile( fileName );\n+        Reader reader = ReaderFactory.newReader( f, \"UTF-8\" );\n+        return new BufferedReader( reader );\n+    }\n+}",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitLatestRevisionCommandConsumerTest.java",
                "sha": "59c9c2942c77c93078fc276dd6612cf5ae17de66",
                "status": "added"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandConsumerTest.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandConsumerTest.java?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 2,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandConsumerTest.java",
                "patch": "@@ -98,8 +98,10 @@ public void testOneUpdateOtherFormat()\n     \n     \n     \n-    // utils methods\n-\n+    // ----------------------------------------------------------------------\n+    // private helper functions\n+    // ----------------------------------------------------------------------\n+    \n     private void assertOneUpdate( String fileName )\n         throws Exception\n     {",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandConsumerTest.java",
                "sha": "3ede9539fa54a4ace1eca4c32f91240c1438bd85",
                "status": "modified"
            },
            {
                "additions": 89,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandTest.java",
                "changes": 89,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandTest.java?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandTest.java",
                "patch": "@@ -0,0 +1,89 @@\n+package org.apache.maven.scm.provider.git.gitexe.command.update;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import org.apache.maven.scm.ScmBranch;\n+import org.apache.maven.scm.ScmTestCase;\n+import org.apache.maven.scm.ScmVersion;\n+import org.apache.maven.scm.provider.git.repository.GitScmProviderRepository;\n+import org.apache.maven.scm.repository.ScmRepository;\n+import org.codehaus.plexus.util.cli.Commandline;\n+\n+import java.io.File;\n+\n+/**\n+ * @author <a href=\"mailto:struberg@yahoo.de\">Mark Struberg</a>\n+ * @version $Id$\n+ */\n+public class GitUpdateCommandTest\n+    extends ScmTestCase\n+{\n+    public void testCommandLineNoBranch()\n+        throws Exception\n+    {\n+        testCommandLine( \"scm:git:http://foo.com/git\", null, \"git pull origin master\" );\n+    }\n+\n+    public void testCommandLineWithBranch()\n+    throws Exception\n+    {\n+        testCommandLine( \"scm:git:http://foo.com/git\", new ScmBranch( \"mybranch\" ), \"git pull origin mybranch\" );\n+    }\n+\n+\n+    public void testCommandLineLatestRevision()\n+        throws Exception\n+    {\n+        testLatestRevisionCommandLine( \"scm:git:http://foo.com/git\", null, \"git log -n1 --date-order master\"  );\n+    }\n+    \n+    // ----------------------------------------------------------------------\n+    // private helper functions\n+    // ----------------------------------------------------------------------\n+\n+    private void testCommandLine( String scmUrl, ScmVersion branch, String commandLine )\n+        throws Exception\n+    {\n+        File workingDirectory = getTestFile( \"target/git-update-command-test\" );\n+\n+        ScmRepository repository = getScmManager().makeScmRepository( scmUrl );\n+\n+        GitScmProviderRepository gitRepository = (GitScmProviderRepository) repository.getProviderRepository();\n+\n+        Commandline cl = GitUpdateCommand.createCommandLine( gitRepository, workingDirectory, branch );\n+\n+        assertCommandLine( commandLine, workingDirectory, cl );\n+    }\n+\n+    private void testLatestRevisionCommandLine( String scmUrl, ScmBranch branch, String commandLine )\n+    throws Exception\n+    {\n+        File workingDirectory = getTestFile( \"target/git-update-command-test\" );\n+    \n+        ScmRepository repository = getScmManager().makeScmRepository( scmUrl );\n+    \n+        GitScmProviderRepository gitRepository = (GitScmProviderRepository) repository.getProviderRepository();\n+    \n+        Commandline cl = GitUpdateCommand.createLatestRevisionCommandLine( gitRepository, workingDirectory, branch );\n+    \n+        assertCommandLine( commandLine, workingDirectory, cl );\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/java/org/apache/maven/scm/provider/git/gitexe/command/update/GitUpdateCommandTest.java",
                "sha": "57e609a1134ea3a741874b437dcc85194dacc504",
                "status": "added"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/maven-scm/blob/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/resources/git/update/git-update-latest-rev.out",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/resources/git/update/git-update-latest-rev.out?ref=0f7292086489b0ecc79fff14f00ba20f9efa2bd9",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/resources/git/update/git-update-latest-rev.out",
                "patch": "@@ -0,0 +1,5 @@\n+commit a300c56a341bae8d0eb5ec4ed5551a11c75a5a6e\n+Author: Mark Struberg <struberg@yahoo.de>\n+Date:   Wed Mar 18 15:59:31 2009 +0100\n+\n+    No msg",
                "raw_url": "https://github.com/apache/maven-scm/raw/0f7292086489b0ecc79fff14f00ba20f9efa2bd9/maven-scm-providers/maven-scm-providers-git/maven-scm-provider-gitexe/src/test/resources/git/update/git-update-latest-rev.out",
                "sha": "8349bee81afc5ddb59a489607b1a345d3fbbfc82",
                "status": "added"
            }
        ],
        "message": "[SCM-441] NPE when using Git SCM 1.2-SNAPSHOT\nSubmitted by Mark Struberg \n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@755751 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/6345f6737b95f33a010e1355881a0585769ca752",
        "patched_files": [
            "GitLatestRevisionCommandConsumer.java",
            "GitUpdateCommandConsumer.java",
            "git-update-latest-rev.java",
            "GitUpdateCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "GitUpdateCommandConsumerTest.java",
            "GitLatestRevisionCommandConsumerTest.java",
            "GitUpdateCommandTest.java"
        ]
    },
    "maven-scm_12724ef": {
        "bug_id": "maven-scm_12724ef",
        "commit": "https://github.com/apache/maven-scm/commit/12724ef168ab50f522b099ef10d2d8fa2758906b",
        "file": [
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/maven-scm/blob/12724ef168ab50f522b099ef10d2d8fa2758906b/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java?ref=12724ef168ab50f522b099ef10d2d8fa2758906b",
                "deletions": 10,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "patch": "@@ -420,17 +420,16 @@ public String toXML()\n             .append( author )\n             .append( \"]]></author>\\n\" );\n \n-        for ( Iterator i = files.iterator(); i.hasNext(); )\n+        if ( files != null )\n         {\n-            ChangeFile file = (ChangeFile) i.next();\n-            buffer.append( \"\\t\\t<file>\\n\" )\n-                .append( \"\\t\\t\\t<name>\" )\n-                .append( escapeValue( file.getName() ) )\n-                .append( \"</name>\\n\" )\n-                .append( \"\\t\\t\\t<revision>\" )\n-                .append( file.getRevision() )\n-                .append( \"</revision>\\n\" );\n-            buffer.append( \"\\t\\t</file>\\n\" );\n+            for ( Iterator i = files.iterator(); i.hasNext(); )\n+            {\n+                ChangeFile file = (ChangeFile) i.next();\n+                buffer.append( \"\\t\\t<file>\\n\" ).append( \"\\t\\t\\t<name>\" ).append( escapeValue( file.getName() ) )\n+                    .append( \"</name>\\n\" ).append( \"\\t\\t\\t<revision>\" ).append( file.getRevision() )\n+                    .append( \"</revision>\\n\" );\n+                buffer.append( \"\\t\\t</file>\\n\" );\n+            }\n         }\n         buffer.append( \"\\t\\t<msg><![CDATA[\" )\n             .append( removeCDataEnd( comment ) )",
                "raw_url": "https://github.com/apache/maven-scm/raw/12724ef168ab50f522b099ef10d2d8fa2758906b/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "sha": "280c45faf0fc413c2fb001aa15b0e74530abe3f2",
                "status": "modified"
            }
        ],
        "message": "[SCM-451] NPE when file list is empty\nSubmitted by Karsten Tinnefeld\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@756910 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/033c937f9c0e9da1a815413d05690ff7920f86ce",
        "patched_files": [
            "ChangeSet.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ChangeSetTest.java"
        ]
    },
    "maven-scm_2e2d5e8": {
        "bug_id": "maven-scm_2e2d5e8",
        "commit": "https://github.com/apache/maven-scm/commit/2e2d5e897d8d0eaa6c818a56de2efa525276ba3d",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/maven-scm/blob/2e2d5e897d8d0eaa6c818a56de2efa525276ba3d/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java?ref=2e2d5e897d8d0eaa6c818a56de2efa525276ba3d",
                "deletions": 1,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "patch": "@@ -223,7 +223,12 @@ public Date getDate()\n      */\n     public void setDate( Date date )\n     {\n-        this.date = new Date( date.getTime() );\n+        if ( date != null )\n+        {\n+            this.date = new Date( date.getTime() );\n+        }\n+\n+        date = null;\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/maven-scm/raw/2e2d5e897d8d0eaa6c818a56de2efa525276ba3d/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "sha": "3464619fd05d5832c5f580da451bcb5fbc48ac77",
                "status": "modified"
            }
        ],
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@374497 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/793eaf9a5211aa4bbb1bdd5071358c9fffa1ecbb",
        "patched_files": [
            "ChangeSet.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ChangeSetTest.java"
        ]
    },
    "maven-scm_50528c9": {
        "bug_id": "maven-scm_50528c9",
        "commit": "https://github.com/apache/maven-scm/commit/50528c906a293b0059d30995394765b892936884",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/maven-scm/blob/50528c906a293b0059d30995394765b892936884/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/AbstractSvnScmProvider.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/AbstractSvnScmProvider.java?ref=50528c906a293b0059d30995394765b892936884",
                "deletions": 7,
                "filename": "maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/AbstractSvnScmProvider.java",
                "patch": "@@ -167,12 +167,6 @@ private ScmUrlParserResult parseScmUrl( String scmSpecificUrl )\n \n         String url = scmSpecificUrl;\n \n-        String user = null;\n-\n-        String password = null;\n-\n-        String protocol = null;\n-\n         // ----------------------------------------------------------------------\n         // Do some sanity checking of the SVN url\n         // ----------------------------------------------------------------------\n@@ -229,7 +223,7 @@ else if ( url.startsWith( \"svn\" ) )\n             return result;\n         }\n \n-        result.repository = new SvnScmProviderRepository( url, user, password );\n+        result.repository = new SvnScmProviderRepository( url );\n \n         return result;\n     }",
                "raw_url": "https://github.com/apache/maven-scm/raw/50528c906a293b0059d30995394765b892936884/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/AbstractSvnScmProvider.java",
                "sha": "180d53adb0002d104599c1755d89ca2f8aa20c8d",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/maven-scm/blob/50528c906a293b0059d30995394765b892936884/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/repository/SvnScmProviderRepository.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/repository/SvnScmProviderRepository.java?ref=50528c906a293b0059d30995394765b892936884",
                "deletions": 2,
                "filename": "maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/repository/SvnScmProviderRepository.java",
                "patch": "@@ -33,13 +33,18 @@\n      */\n     private String tagBase;\n \n+    public SvnScmProviderRepository( String url )\n+    {\n+        parseUrl( url );\n+    }\n+\n     public SvnScmProviderRepository( String url, String user, String password )\n     {\n+        this( url );\n+\n         setUser( user );\n \n         setPassword( password );\n-\n-        parseUrl( url );\n     }\n \n     public String getUrl()\n@@ -95,6 +100,11 @@ else if ( url.startsWith( \"svn\" ) )\n             protocol = \"svn://\";\n         }\n \n+        if ( protocol == null )\n+        {\n+            return;\n+        }\n+\n         String urlPath = url.substring( protocol.length() );\n \n         int indexAt = urlPath.indexOf( \"@\" );",
                "raw_url": "https://github.com/apache/maven-scm/raw/50528c906a293b0059d30995394765b892936884/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svn-commons/src/main/java/org/apache/maven/scm/provider/svn/repository/SvnScmProviderRepository.java",
                "sha": "169b0c0c74788664c5002060fd64a5b3a35e877e",
                "status": "modified"
            }
        ],
        "message": "o Clean code\no Fix possible NPE\no Fix user/password initialization\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@389486 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/524825c5d15947882020199312ffde78a4f41dc7",
        "patched_files": [
            "SvnScmProviderRepository.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "SvnScmProviderRepositoryTest.java"
        ]
    },
    "maven-scm_72aef29": {
        "bug_id": "maven-scm_72aef29",
        "commit": "https://github.com/apache/maven-scm/commit/72aef297d97155f5c9920518b25165db8ae6f8e8",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/maven-scm/blob/72aef297d97155f5c9920518b25165db8ae6f8e8/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/checkout/ClearCaseCheckOutCommand.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/checkout/ClearCaseCheckOutCommand.java?ref=72aef297d97155f5c9920518b25165db8ae6f8e8",
                "deletions": 1,
                "filename": "maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/checkout/ClearCaseCheckOutCommand.java",
                "patch": "@@ -62,7 +62,10 @@ protected CheckOutScmResult executeCheckOutCommand( ScmProviderRepository reposi\n         ClearCaseScmProviderRepository repo = (ClearCaseScmProviderRepository) repository;\n         File workingDirectory = fileSet.getBasedir();\n \n-        getLogger().debug( version.getType() + \": \" + version.getName() );\n+        if ( version != null )\n+        {\n+            getLogger().debug( version.getType() + \": \" + version.getName() );\n+        }\n \n         getLogger().debug( \"Running with CLEARCASE \" + settings.getClearcaseType() );\n ",
                "raw_url": "https://github.com/apache/maven-scm/raw/72aef297d97155f5c9920518b25165db8ae6f8e8/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/checkout/ClearCaseCheckOutCommand.java",
                "sha": "96c5298554eaf0a8ab89f7692cd4399455bf79df",
                "status": "modified"
            }
        ],
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@532235 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/7f65c29f5b0dac4a4660ea48eedfe74a0a4765f4",
        "patched_files": [
            "ClearCaseCheckOutCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ClearCaseCheckOutCommandTest.java"
        ]
    },
    "maven-scm_9e3cf35": {
        "bug_id": "maven-scm_9e3cf35",
        "commit": "https://github.com/apache/maven-scm/commit/9e3cf3523cfd249d4d11e343d185be800189ec5c",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/maven-scm/blob/9e3cf3523cfd249d4d11e343d185be800189ec5c/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java?ref=9e3cf3523cfd249d4d11e343d185be800189ec5c",
                "deletions": 1,
                "filename": "maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "patch": "@@ -208,7 +208,12 @@ public void setComment( String comment )\n      */\n     public Date getDate()\n     {\n-        return (Date) date.clone();\n+        if ( date != null )\n+        {\n+            return (Date) date.clone();\n+        }\n+\n+        return null;\n     }\n \n     /**",
                "raw_url": "https://github.com/apache/maven-scm/raw/9e3cf3523cfd249d4d11e343d185be800189ec5c/maven-scm-api/src/main/java/org/apache/maven/scm/ChangeSet.java",
                "sha": "c45de3d37058e75f928efcfe43db332549b2a559",
                "status": "modified"
            }
        ],
        "message": "Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@374399 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/0a65c8b568db91e27e90e7b92292a16f61bb0117",
        "patched_files": [
            "ChangeSet.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ChangeSetTest.java"
        ]
    },
    "maven-scm_a834c41": {
        "bug_id": "maven-scm_a834c41",
        "commit": "https://github.com/apache/maven-scm/commit/a834c41f40fa23fcd064502ac8cfb24eba64b0ed",
        "file": [
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/maven-scm/blob/a834c41f40fa23fcd064502ac8cfb24eba64b0ed/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtils.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtils.java?ref=a834c41f40fa23fcd064502ac8cfb24eba64b0ed",
                "deletions": 2,
                "filename": "maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtils.java",
                "patch": "@@ -45,6 +45,8 @@\n public class VssCommandLineUtils\n     implements VssConstants  // FIXME extend CommandLineUtils\n {\n+    private static File scmConfDir = new File( System.getProperty( \"user.home\" ), \".scm\" );\n+\n     public static void addFiles( Commandline cl, ScmFileSet fileSet )\n     {\n         Iterator it = fileSet.getFileList().iterator();\n@@ -107,8 +109,7 @@ public static int executeCommandline( Commandline cl, StreamConsumer consumer,\n     public static final Settings getSettings()\n     {\n         Settings settings = null;\n-        File scmUserHome = new File( System.getProperty( \"user.home\" ), \".scm\" );\n-        File settingsFile = new File( scmUserHome, \"vss-settings.xml\" );\n+        File settingsFile = new File( scmConfDir, \"vss-settings.xml\" );\n         if ( settingsFile.exists() )\n         {\n             VssXpp3Reader reader = new VssXpp3Reader();\n@@ -134,11 +135,25 @@ public static final Settings getSettings()\n         String vssDirectory = System.getProperty( \"vssDirectory\" );\n         if ( StringUtils.isNotEmpty( vssDirectory ) )\n         {\n+            if ( settings == null )\n+            {\n+                settings = new Settings();\n+            }\n             settings.setVssDirectory( vssDirectory );\n         }\n         return settings;\n     }\n \n+    protected static final File getScmConfDir()\n+    {\n+        return scmConfDir;\n+    }\n+\n+    protected static final void setScmConfDir( File directory )\n+    {\n+        scmConfDir = directory;\n+    }\n+\n     public static final String getSsDir()\n     {\n         String ssDir = \"\";",
                "raw_url": "https://github.com/apache/maven-scm/raw/a834c41f40fa23fcd064502ac8cfb24eba64b0ed/maven-scm-providers/maven-scm-provider-vss/src/main/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtils.java",
                "sha": "5f99e6553fedc9167f3fdf7f9ec28883953ea4dc",
                "status": "modified"
            },
            {
                "additions": 162,
                "blob_url": "https://github.com/apache/maven-scm/blob/a834c41f40fa23fcd064502ac8cfb24eba64b0ed/maven-scm-providers/maven-scm-provider-vss/src/test/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtilsTest.java",
                "changes": 162,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-vss/src/test/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtilsTest.java?ref=a834c41f40fa23fcd064502ac8cfb24eba64b0ed",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-provider-vss/src/test/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtilsTest.java",
                "patch": "@@ -0,0 +1,162 @@\n+package org.apache.maven.scm.provider.vss.commands;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import org.apache.maven.scm.ScmTestCase;\n+\n+import java.io.File;\n+import java.io.FileOutputStream;\n+import java.io.IOException;\n+\n+/**\n+ * @author Allan Lang\n+ * @version $Id$\n+ */\n+public class VssCommandLineUtilsTest\n+    extends ScmTestCase\n+{\n+\n+    private static final String VSS_DIRECTORY_PROPERTY = \"vssDirectory\";\n+\n+    //private ScmManager scmManager;\n+\n+    public void setUp()\n+        throws Exception\n+    {\n+        super.setUp();\n+\n+        //scmManager = getScmManager();\n+    }\n+\n+    public void testGetSettings()\n+        throws IOException\n+    {\n+        /*\n+         * If we have a genuine settings file, take a copy of this first Create\n+         * the test settings file Check getSettings from file Delete the test\n+         * settings file Check getSettings without file Check getSettings with\n+         * system property Re-instate original settings file, if existing\n+         *\n+         */\n+\n+        final String vssInstallPath = \"c:\\\\wherever\";\n+        final String vssInstallPathAlt = \"c:\\\\somewhere\";\n+        final String settingsXml =\n+            \"<vss-settings><Settings><vssDirectory>\" + vssInstallPath + \"</vssDirectory></Settings></vss-settings>\";\n+        final String settingsFilename = \"vss-settings.xml\";\n+        final String backupFilename = settingsFilename + \".backup\";\n+        boolean preExistingScmFolder = false;\n+        boolean preExistingSettings = false;\n+\n+        /*\n+         * Create a backup of the current settings file, if one exists\n+         */\n+        File scmUserHome = new File( getTestFile( \"target/vssdir\" ), \".scm\" );\n+        if ( scmUserHome.exists() )\n+        {\n+            preExistingScmFolder = true;\n+            File settingsFile = new File( scmUserHome, settingsFilename );\n+            if ( settingsFile.exists() )\n+            {\n+                preExistingSettings = true;\n+                settingsFile.renameTo( new File( scmUserHome, backupFilename ) );\n+            }\n+        }\n+        else\n+        {\n+            scmUserHome.mkdirs();\n+        }\n+\n+        /*\n+         * Create the test settings file\n+         */\n+        File testSettings = new File( scmUserHome, settingsFilename );\n+        FileOutputStream fos = new FileOutputStream( testSettings );\n+        fos.write( settingsXml.getBytes() );\n+        fos.flush();\n+        fos.close();\n+        fos = null;\n+\n+        /*\n+         * Validate that setting from settings file is returned correctly\n+         */\n+        VssCommandLineUtils.setScmConfDir( scmUserHome );\n+        assertEquals( vssInstallPath, VssCommandLineUtils.getSettings().getVssDirectory() );\n+\n+        /*\n+         * Validate that setting is overridden by system property\n+         */\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathAlt );\n+        assertEquals( vssInstallPathAlt, VssCommandLineUtils.getSettings().getVssDirectory() );\n+\n+        /*\n+         * Delete the test settings file\n+         */\n+        testSettings.delete();\n+\n+        /*\n+         * Validate that setting is still equal to system property\n+         */\n+        assertEquals( vssInstallPathAlt, VssCommandLineUtils.getSettings().getVssDirectory() );\n+\n+        /*\n+         * Re-instate the original settings file, if one existed\n+         */\n+        if ( preExistingSettings )\n+        {\n+            File backup = new File( scmUserHome, backupFilename );\n+            backup.renameTo( new File( scmUserHome, settingsFilename ) );\n+        }\n+\n+        if ( !preExistingScmFolder )\n+        {\n+            scmUserHome.delete();\n+        }\n+\n+    }\n+\n+    public void testGetSsDir()\n+    {\n+        final String vssInstallPathWindowsStyle = \"c:\\\\vss\\\\bin\";\n+        final String vssInstallPathUnixStyle = \"c:/vss/bin\";\n+        final String targetValue = \"c:/vss/bin/\";\n+\n+        // Windows style test\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathWindowsStyle );\n+        assertEquals( targetValue, VssCommandLineUtils.getSsDir() );\n+\n+        // Unix style test\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathUnixStyle );\n+        assertEquals( targetValue, VssCommandLineUtils.getSsDir() );\n+\n+        // Windows style with folder indicator\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathWindowsStyle + \"\\\\\" );\n+        assertEquals( targetValue, VssCommandLineUtils.getSsDir() );\n+\n+        // Unix style with folder indicator\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathUnixStyle + \"/\" );\n+        assertEquals( targetValue, VssCommandLineUtils.getSsDir() );\n+\n+        // Unix style with Windows style folder indicator\n+        System.setProperty( VSS_DIRECTORY_PROPERTY, vssInstallPathUnixStyle + \"\\\\\" );\n+        assertEquals( targetValue, VssCommandLineUtils.getSsDir() );\n+\n+    }\n+}",
                "raw_url": "https://github.com/apache/maven-scm/raw/a834c41f40fa23fcd064502ac8cfb24eba64b0ed/maven-scm-providers/maven-scm-provider-vss/src/test/java/org/apache/maven/scm/provider/vss/commands/VssCommandLineUtilsTest.java",
                "sha": "2ed458cd43508fe51a86c53a09b893b6e06950d2",
                "status": "added"
            }
        ],
        "message": "[SCM-338] Fix NPE when using vssDirectory system property\nSubmitted by : Allan Lang\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@656802 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/418fc6a78b19e0f440c277da5ddda48396150a03",
        "patched_files": [
            "VssCommandLineUtils.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "VssCommandLineUtilsTest.java"
        ]
    },
    "maven-scm_b3b8480": {
        "bug_id": "maven-scm_b3b8480",
        "commit": "https://github.com/apache/maven-scm/commit/b3b848065914aebbeb7b5abc8f21e19c113f441f",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/maven-scm/blob/b3b848065914aebbeb7b5abc8f21e19c113f441f/maven-scm-providers/maven-scm-provider-starteam/src/main/java/org/apache/maven/scm/provider/starteam/command/changelog/StarteamChangeLogCommand.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-starteam/src/main/java/org/apache/maven/scm/provider/starteam/command/changelog/StarteamChangeLogCommand.java?ref=b3b848065914aebbeb7b5abc8f21e19c113f441f",
                "deletions": 1,
                "filename": "maven-scm-providers/maven-scm-provider-starteam/src/main/java/org/apache/maven/scm/provider/starteam/command/changelog/StarteamChangeLogCommand.java",
                "patch": "@@ -54,7 +54,7 @@ protected ChangeLogScmResult executeChangeLogCommand( ScmProviderRepository repo\n         throws ScmException\n     {\n \n-        if ( branch != null || StringUtils.isNotEmpty( branch.getName() ) )\n+        if ( branch != null || StringUtils.isNotEmpty( (branch==null)?null:branch.getName() ) )\n         {\n             this.getLogger().warn( \"This provider doesn't support changelog with on a given branch.\" );\n         }",
                "raw_url": "https://github.com/apache/maven-scm/raw/b3b848065914aebbeb7b5abc8f21e19c113f441f/maven-scm-providers/maven-scm-provider-starteam/src/main/java/org/apache/maven/scm/provider/starteam/command/changelog/StarteamChangeLogCommand.java",
                "sha": "b9d6142897be95be3eaa24e854e41f80185f842e",
                "status": "modified"
            }
        ],
        "message": "Fix NPE related to CONTINUUM-1521\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@607771 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/e96d4e8d270211c213e6b0b1645ec0d64303f5c4",
        "patched_files": [
            "StarteamChangeLogCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "StarteamChangeLogCommandTest.java"
        ]
    },
    "maven-scm_c6280e8": {
        "bug_id": "maven-scm_c6280e8",
        "commit": "https://github.com/apache/maven-scm/commit/c6280e886b5d98b852d2c09062ec5d0d00908b7a",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/maven-scm/blob/c6280e886b5d98b852d2c09062ec5d0d00908b7a/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/update/ClearCaseUpdateCommand.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/update/ClearCaseUpdateCommand.java?ref=c6280e886b5d98b852d2c09062ec5d0d00908b7a",
                "deletions": 1,
                "filename": "maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/update/ClearCaseUpdateCommand.java",
                "patch": "@@ -69,7 +69,11 @@ protected UpdateScmResult executeUpdateCommand( ScmProviderRepository repository\n \n     protected ChangeLogCommand getChangeLogCommand()\n     {\n-        return new ClearCaseChangeLogCommand();\n+        ClearCaseChangeLogCommand changeLogCmd = new ClearCaseChangeLogCommand();\n+\n+        changeLogCmd.setLogger( getLogger() );\n+\n+        return changeLogCmd;\n     }\n \n     // ----------------------------------------------------------------------",
                "raw_url": "https://github.com/apache/maven-scm/raw/c6280e886b5d98b852d2c09062ec5d0d00908b7a/maven-scm-providers/maven-scm-provider-clearcase/src/main/java/org/apache/maven/scm/provider/clearcase/command/update/ClearCaseUpdateCommand.java",
                "sha": "023d1c1de008d5f30edc702202230e6ae48c6ec9",
                "status": "modified"
            }
        ],
        "message": "[SCM-144] Fix NPE\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@373770 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/7aca62a55d57ba18e3234bb92f220e4fc9ff99a9",
        "patched_files": [
            "ClearCaseUpdateCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "ClearCaseUpdateCommandTest.java"
        ]
    },
    "maven-scm_cc4f7e2": {
        "bug_id": "maven-scm_cc4f7e2",
        "commit": "https://github.com/apache/maven-scm/commit/cc4f7e2a42f22b386884992c91233dc2ca988dc2",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/maven-scm/blob/cc4f7e2a42f22b386884992c91233dc2ca988dc2/maven-scm-providers/maven-scm-provider-accurev/src/main/java/org/apache/maven/scm/provider/accurev/cli/DiffConsumer.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-accurev/src/main/java/org/apache/maven/scm/provider/accurev/cli/DiffConsumer.java?ref=cc4f7e2a42f22b386884992c91233dc2ca988dc2",
                "deletions": 3,
                "filename": "maven-scm-providers/maven-scm-provider-accurev/src/main/java/org/apache/maven/scm/provider/accurev/cli/DiffConsumer.java",
                "patch": "@@ -47,12 +47,12 @@ protected void startTag( List<String> tagPath, Map<String, String> attributes )\n         {\n             currentDifference = new FileDifference();\n         }\n-        else if ( \"Stream2\".equals( tagName ) )\n+        else if ( \"Stream2\".equals( tagName ) && attributes.get( \"Name\" ) != null)\n         {\n             currentDifference.setElementId( Long.parseLong( attributes.get( \"eid\" ) ) );\n             currentDifference.setNewVersion( attributes.get( \"Name\" ), attributes.get( \"Version\" ) );\n         }\n-        else if ( \"Stream1\".equals( tagName ) )\n+        else if ( \"Stream1\".equals( tagName ) && attributes.get( \"Name\" ) != null )\n         {\n             currentDifference.setElementId( Long.parseLong( attributes.get( \"eid\" ) ) );\n             currentDifference.setOldVersion( attributes.get( \"Name\" ), attributes.get( \"Version\" ) );\n@@ -66,7 +66,9 @@ protected void endTag( List<String> tagPath )\n         String tagName = getTagName( tagPath );\n         if ( \"Element\".equals( tagName ) )\n         {\n-            results.add( currentDifference );\n+            if (currentDifference.getNewFile() != null || currentDifference.getOldFile() != null) {\n+                results.add( currentDifference );\n+            }\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/maven-scm/raw/cc4f7e2a42f22b386884992c91233dc2ca988dc2/maven-scm-providers/maven-scm-provider-accurev/src/main/java/org/apache/maven/scm/provider/accurev/cli/DiffConsumer.java",
                "sha": "6c508f3a390cb00f571a02efb3021e60ee1e5cf2",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/maven-scm/blob/cc4f7e2a42f22b386884992c91233dc2ca988dc2/maven-scm-providers/maven-scm-provider-accurev/src/test/resources/diff-vvt.xml",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-accurev/src/test/resources/diff-vvt.xml?ref=cc4f7e2a42f22b386884992c91233dc2ca988dc2",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-provider-accurev/src/test/resources/diff-vvt.xml",
                "patch": "@@ -43,6 +43,13 @@\n           IsDir=\"no\"\n           elemType=\"text\"/>\n     </Change>\n+     <Change\n+        What=\"eid\">\n+      <Stream1\n+          eid=\"9\"/>\n+      <Stream2\n+          eid=\"23\"/>\n+    </Change>\n   </Element>\n   <Element>\n     <Change",
                "raw_url": "https://github.com/apache/maven-scm/raw/cc4f7e2a42f22b386884992c91233dc2ca988dc2/maven-scm-providers/maven-scm-provider-accurev/src/test/resources/diff-vvt.xml",
                "sha": "db9af4a32a0abde3ce7e741a6cd7f825a2779e9a",
                "status": "modified"
            }
        ],
        "message": "[SCM-597] NPE in AccuRev provider changelog\nSubmitted by Grant Gardner\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@1062063 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/06c342ca00ac587cb5e2087aad7f070ddeaeeb3e",
        "patched_files": [
            "DiffConsumer.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "DiffConsumerTest.java"
        ]
    },
    "maven-scm_d901ad7": {
        "bug_id": "maven-scm_d901ad7",
        "commit": "https://github.com/apache/maven-scm/commit/d901ad7dd90c5a7dc091169681c76c2ee9a2f239",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/maven-scm/blob/d901ad7dd90c5a7dc091169681c76c2ee9a2f239/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svnexe/src/main/java/org/apache/maven/scm/provider/svn/svnexe/command/changelog/SvnChangeLogCommand.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svnexe/src/main/java/org/apache/maven/scm/provider/svn/svnexe/command/changelog/SvnChangeLogCommand.java?ref=d901ad7dd90c5a7dc091169681c76c2ee9a2f239",
                "deletions": 3,
                "filename": "maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svnexe/src/main/java/org/apache/maven/scm/provider/svn/svnexe/command/changelog/SvnChangeLogCommand.java",
                "patch": "@@ -26,6 +26,7 @@\n import org.apache.maven.scm.provider.svn.command.SvnCommand;\n import org.apache.maven.scm.provider.svn.repository.SvnScmProviderRepository;\n import org.apache.maven.scm.provider.svn.svnexe.command.SvnCommandLineUtils;\n+import org.codehaus.plexus.util.StringUtils;\n import org.codehaus.plexus.util.cli.CommandLineException;\n import org.codehaus.plexus.util.cli.CommandLineUtils;\n import org.codehaus.plexus.util.cli.Commandline;\n@@ -89,8 +90,6 @@ public static Commandline createCommandLine( SvnScmProviderRepository repository\n     {\n         SimpleDateFormat dateFormat = new SimpleDateFormat( DATE_FORMAT );\n \n-        dateFormat.setTimeZone( TimeZone.getTimeZone( \"GMT\" ) );\n-\n         Commandline cl = SvnCommandLineUtils.getBaseSvnCommandLine( workingDirectory, repository );\n \n         cl.createArgument().setValue( \"log\" );\n@@ -114,7 +113,7 @@ public static Commandline createCommandLine( SvnScmProviderRepository repository\n             }\n         }\n \n-        if ( branch != null )\n+        if ( StringUtils.isNotEmpty( branch ) )\n         {\n             // By specifying a branch and this repository url below, subversion should show \n             // the changelog of that branch, but limit it to paths that also occur in this repository.",
                "raw_url": "https://github.com/apache/maven-scm/raw/d901ad7dd90c5a7dc091169681c76c2ee9a2f239/maven-scm-providers/maven-scm-providers-svn/maven-scm-provider-svnexe/src/main/java/org/apache/maven/scm/provider/svn/svnexe/command/changelog/SvnChangeLogCommand.java",
                "sha": "4994ec00d0bd641046a680f54d9a5de1b4f5cbd8",
                "status": "modified"
            }
        ],
        "message": "o Remove possible NPE in command line execution\no Remove unnecessary timezone\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@391976 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/e3c445bb26f3fa80da6f1cab4fa93e3b70809ae9",
        "patched_files": [
            "SvnChangeLogCommand.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "SvnChangeLogCommandTest.java"
        ]
    },
    "maven-scm_f5b3e32": {
        "bug_id": "maven-scm_f5b3e32",
        "commit": "https://github.com/apache/maven-scm/commit/f5b3e3200ff2774099b1b9407349ac8f04e29497",
        "file": [
            {
                "additions": 11,
                "blob_url": "https://github.com/apache/maven-scm/blob/f5b3e3200ff2774099b1b9407349ac8f04e29497/maven-scm-providers/maven-scm-provider-hg/src/main/java/org/apache/maven/scm/provider/hg/HgUtils.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-hg/src/main/java/org/apache/maven/scm/provider/hg/HgUtils.java?ref=f5b3e3200ff2774099b1b9407349ac8f04e29497",
                "deletions": 8,
                "filename": "maven-scm-providers/maven-scm-provider-hg/src/main/java/org/apache/maven/scm/provider/hg/HgUtils.java",
                "patch": "@@ -146,16 +146,19 @@ static Commandline buildCmd( File workingDir, String[] cmdAndArgs )\n     {\n         Commandline cmd = new Commandline();\n         cmd.setExecutable( HgCommandConstants.EXEC );\n-        cmd.setWorkingDirectory( workingDir.getAbsolutePath() );\n         cmd.addArguments( cmdAndArgs );\n-\n-        if ( !workingDir.exists() )\n+        if ( workingDir != null )\n         {\n-            boolean success = workingDir.mkdirs();\n-            if ( !success )\n+            cmd.setWorkingDirectory( workingDir.getAbsolutePath() );\n+\n+            if ( !workingDir.exists() )\n             {\n-                String msg = \"Working directory did not exist\" + \" and it couldn't be created: \" + workingDir;\n-                throw new ScmException( msg );\n+                boolean success = workingDir.mkdirs();\n+                if ( !success )\n+                {\n+                    String msg = \"Working directory did not exist\" + \" and it couldn't be created: \" + workingDir;\n+                    throw new ScmException( msg );\n+                }\n             }\n         }\n         return cmd;\n@@ -195,7 +198,7 @@ public static ScmResult execute( File workingDir, String[] cmdAndArgs )\n         int i = 0;\n         for ( Iterator<File> iterator = filesList.iterator(); iterator.hasNext(); i++ )\n         {\n-            File scmFile = (File) iterator.next();\n+            File scmFile = iterator.next();\n             String file = scmFile.getPath().replace( '\\\\', File.separatorChar );\n             cmd[i + cmdAndArgs.length] = file;\n ",
                "raw_url": "https://github.com/apache/maven-scm/raw/f5b3e3200ff2774099b1b9407349ac8f04e29497/maven-scm-providers/maven-scm-provider-hg/src/main/java/org/apache/maven/scm/provider/hg/HgUtils.java",
                "sha": "a745bb5416b7126bb28bd531db0c9e59c1fce12f",
                "status": "modified"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/maven-scm/blob/f5b3e3200ff2774099b1b9407349ac8f04e29497/maven-scm-providers/maven-scm-provider-hg/src/test/java/org/apache/maven/scm/provider/hg/HgUtilsTest.java",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/maven-scm/contents/maven-scm-providers/maven-scm-provider-hg/src/test/java/org/apache/maven/scm/provider/hg/HgUtilsTest.java?ref=f5b3e3200ff2774099b1b9407349ac8f04e29497",
                "deletions": 0,
                "filename": "maven-scm-providers/maven-scm-provider-hg/src/test/java/org/apache/maven/scm/provider/hg/HgUtilsTest.java",
                "patch": "@@ -0,0 +1,17 @@\n+package org.apache.maven.scm.provider.hg;\r\n+\r\n+import static org.junit.Assert.*;\r\n+import org.codehaus.plexus.util.cli.Commandline;\r\n+import org.junit.Test;\r\n+\r\n+public class HgUtilsTest\r\n+{\r\n+\r\n+    @Test\r\n+    public void testNullWorkingDirectory()\r\n+        throws Exception\r\n+    {\r\n+        Commandline cmd = HgUtils.buildCmd( null, new String[] {} );\r\n+        assertEquals( null, cmd.getWorkingDirectory() );\r\n+    }\r\n+}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/maven-scm/raw/f5b3e3200ff2774099b1b9407349ac8f04e29497/maven-scm-providers/maven-scm-provider-hg/src/test/java/org/apache/maven/scm/provider/hg/HgUtilsTest.java",
                "sha": "3aeb4391f947f99228bb04522ea1ba594150e21f",
                "status": "added"
            }
        ],
        "message": "Fix SCM-641 for HG: NPE when workingDirectory is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/scm/trunk@1241140 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-scm/commit/c1a7e71219147a5a0b977be95d14e8118f42fb7d",
        "patched_files": [
            "HgUtils.java"
        ],
        "repo": "maven-scm",
        "unit_tests": [
            "HgUtilsTest.java"
        ]
    }
}