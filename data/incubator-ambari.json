{
    "incubator-ambari_96cf16f": {
        "bug_id": "incubator-ambari_96cf16f",
        "commit": "https://github.com/apache/incubator-ambari/commit/96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/AMBARI-666-CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/AMBARI-666-CHANGES.txt?ref=96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
                "deletions": 0,
                "filename": "AMBARI-666-CHANGES.txt",
                "patch": "@@ -12,6 +12,9 @@ AMBARI-666 branch (unreleased changes)\n \n   NEW FEATURES\n \n+  AMBARI-845. Fix NPE in the server to be able to run the server api's.\n+  (mahadev)\n+\n   AMBARI-844. Mock JMX provider for manual tests. (Tom Beerbower via mahadev)\n \n   AMBARI-841. Fix comparison predicates in case where resource does not have",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/AMBARI-666-CHANGES.txt",
                "sha": "794ecf116fc80b0935be22a697f7ac4c16af8ae6",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariManagementControllerImpl.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariManagementControllerImpl.java?ref=96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
                "deletions": 5,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariManagementControllerImpl.java",
                "patch": "@@ -251,7 +251,7 @@ public TrackActionResponse createHost(HostRequest request)\n     if (LOG.isDebugEnabled()) {\n       LOG.debug(\"Received a createHost request\"\n           + \", hostname=\" + request.getHostname()\n-          + \", request=\" + request);\n+          );\n     }\n \n     Host h = clusters.getHost(request.getHostname());\n@@ -283,23 +283,27 @@ public TrackActionResponse createHostComponent(ServiceComponentHostRequest\n       request) throws AmbariException {\n     if (request.getClusterName() == null\n         || request.getClusterName().isEmpty()\n-        || request.getServiceName() == null\n-        || request.getServiceName().isEmpty()\n         || request.getComponentName() == null\n         || request.getComponentName().isEmpty()\n         || request.getHostname() == null\n         || request.getHostname().isEmpty()) {\n       // FIXME throw correct error\n       throw new AmbariException(\"Invalid arguments\");\n     }\n-\n+    \n+    // FIXME Hard coded stuff --- needs to be fixed.\n+    if (request.getServiceName() == null\n+        || request.getServiceName().isEmpty()\n+      ) {\n+      request.setServiceName(\"HDFS\");\n+    }\n     if (LOG.isDebugEnabled()) {\n       LOG.debug(\"Received a createHostComponent request\"\n           + \", clusterName=\" + request.getClusterName()\n           + \", serviceName=\" + request.getServiceName()\n           + \", componentName=\" + request.getComponentName()\n           + \", hostname=\" + request.getHostname()\n-          + \", request=\" + request);\n+          );\n     }\n \n     final Cluster cluster = clusters.getCluster(request.getClusterName());",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariManagementControllerImpl.java",
                "sha": "529e55449840a146f8d8e300c5803a694cd85668",
                "status": "modified"
            },
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariServer.java",
                "changes": 22,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariServer.java?ref=96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
                "deletions": 8,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariServer.java",
                "patch": "@@ -32,7 +32,6 @@\n import org.mortbay.jetty.security.SslSocketConnector;\n import org.mortbay.jetty.servlet.Context;\n import org.mortbay.jetty.servlet.DefaultServlet;\n-import org.mortbay.jetty.servlet.FilterHolder;\n import org.mortbay.jetty.servlet.ServletHolder;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -71,7 +70,12 @@\n   CertificateManager certMan;\n   @Inject\n   Injector injector;\n-\n+  private static AmbariManagementController clusterController = null;\n+  \n+  public static AmbariManagementController getController() {\n+    return clusterController;\n+  }\n+  \n   public void run() {\n     server = new Server(CLIENT_API_PORT);\n     serverForAgent = new Server();\n@@ -113,7 +117,7 @@ public void run() {\n       //Spring Security Filter initialization\n       DelegatingFilterProxy springSecurityFilter = new DelegatingFilterProxy();\n       springSecurityFilter.setTargetBeanName(\"springSecurityFilterChain\");\n-      root.addFilter(new FilterHolder(springSecurityFilter), \"/*\", 1);\n+      //root.addFilter(new FilterHolder(springSecurityFilter), \"/*\", 1);\n \n       //Secured connector for 2-way auth\n       SslSocketConnector sslConnectorTwoWay = new SslSocketConnector();\n@@ -155,7 +159,8 @@ public void run() {\n       sh.setInitParameter(\"com.sun.jersey.config.property.resourceConfigClass\",\n               \"com.sun.jersey.api.core.PackagesResourceConfig\");\n       sh.setInitParameter(\"com.sun.jersey.config.property.packages\",\n-              \"org.apache.ambari.server.api.rest\");\n+              \"org.apache.ambari.server.api.rest;\" +\n+              \"org.apache.ambari.server.api.services\");\n       root.addServlet(sh, \"/api/*\");\n       sh.setInitOrder(2);\n \n@@ -197,7 +202,8 @@ public void run() {\n       AmbariManagementController controller = injector.getInstance(\n           AmbariManagementController.class);\n \n-\n+      clusterController = controller;\n+      \n       // FIXME need to figure out correct order of starting things to\n       // handle restart-recovery correctly\n \n@@ -211,9 +217,9 @@ public void run() {\n       manager.start();\n       LOG.info(\"********* Started ActionManager **********\");\n \n-      RequestInjectorForTest testInjector = new RequestInjectorForTest(controller, clusters);\n-      Thread testInjectorThread = new Thread(testInjector);\n-      testInjectorThread.start();\n+      //RequestInjectorForTest testInjector = new RequestInjectorForTest(controller, clusters);\n+      //Thread testInjectorThread = new Thread(testInjector);\n+      //testInjectorThread.start();\n       \n       server.join();\n       LOG.info(\"Joined the Server\");",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/AmbariServer.java",
                "sha": "3621919f652a912ac7074c640206aabd156016df",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/ControllerModule.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/ControllerModule.java?ref=96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
                "deletions": 0,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/ControllerModule.java",
                "patch": "@@ -28,6 +28,7 @@\n import org.apache.ambari.server.state.cluster.ClustersImpl;\n \n import com.google.inject.AbstractModule;\n+import com.google.inject.Injector;\n import com.google.inject.name.Names;\n \n /**",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/ControllerModule.java",
                "sha": "f2a7689d5980ef8b1c847a8e5fea9d2fee04254c",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/internal/DefaultProviderModule.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/internal/DefaultProviderModule.java?ref=96cf16f195c35aa6617e74e9c2893c53bea1a8b5",
                "deletions": 11,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/internal/DefaultProviderModule.java",
                "patch": "@@ -18,31 +18,28 @@\n \n package org.apache.ambari.server.controller.internal;\n \n-import org.apache.ambari.server.controller.spi.ProviderModule;\n-import org.apache.ambari.server.controller.utilities.PropertyHelper;\n+import java.util.LinkedList;\n+import java.util.List;\n+\n import org.apache.ambari.server.controller.AmbariManagementController;\n-import org.apache.ambari.server.controller.AmbariManagementControllerImpl;\n+import org.apache.ambari.server.controller.AmbariServer;\n import org.apache.ambari.server.controller.spi.PropertyProvider;\n+import org.apache.ambari.server.controller.spi.ProviderModule;\n import org.apache.ambari.server.controller.spi.Resource;\n import org.apache.ambari.server.controller.spi.ResourceProvider;\n-\n-import java.util.LinkedList;\n-import java.util.List;\n-\n+import org.apache.ambari.server.controller.utilities.PropertyHelper;\n /**\n  *\n  */\n public class DefaultProviderModule implements ProviderModule {\n \n   private static final List<PropertyProvider> PROPERTY_PROVIDERS =\n       new LinkedList<PropertyProvider>();\n-\n+ \n   @Override\n   public ResourceProvider getResourceProvider(Resource.Type type) {\n-    AmbariManagementController managementController =\n-        new AmbariManagementControllerImpl(null, null);\n     return ResourceProviderImpl.getResourceProvider(type,\n         PROPERTY_PROVIDERS, PropertyHelper.getPropertyIds(type, \"DB\"),\n-        PropertyHelper.getKeyPropertyIds(type), managementController);\n+        PropertyHelper.getKeyPropertyIds(type), AmbariServer.getController());\n   }\n }",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/96cf16f195c35aa6617e74e9c2893c53bea1a8b5/ambari-server/src/main/java/org/apache/ambari/server/controller/internal/DefaultProviderModule.java",
                "sha": "3fd5672018043573bc49dd8839bab087b0f1ecb5",
                "status": "modified"
            }
        ],
        "message": "AMBARI-845. Fix NPE in the server to be able to run the server api's. (mahadev)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/ambari/branches/AMBARI-666@1396501 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/incubator-ambari/commit/947a9d5acc9e22aa1b9613bfdc5cdab74a3e78e0",
        "repo": "incubator-ambari",
        "unit_tests": [
            "AmbariManagementControllerImplTest.java",
            "AmbariServerTest.java"
        ]
    },
    "incubator-ambari_978f4cd": {
        "bug_id": "incubator-ambari_978f4cd",
        "commit": "https://github.com/apache/incubator-ambari/commit/978f4cd86a62f5b70b4af6bf9ab9e761928e2055",
        "file": [
            {
                "additions": 19,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProvider.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProvider.java?ref=978f4cd86a62f5b70b4af6bf9ab9e761928e2055",
                "deletions": 0,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProvider.java",
                "patch": "@@ -21,11 +21,18 @@\n import org.apache.ambari.server.controller.spi.Request;\n import org.apache.ambari.server.controller.spi.Resource;\n \n+import java.util.Collections;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Set;\n+\n /**\n  * A NO-OP resource provider for a gsInstaller defined cluster.\n  */\n public class GSInstallerNoOpProvider extends GSInstallerResourceProvider{\n \n+  private final Map<Resource.Type, String> keyPropertyIds = new HashMap<Resource.Type, String>();\n+\n   // ----- GSInstallerResourceProvider ---------------------------------------\n \n   @Override\n@@ -37,5 +44,17 @@ public void updateProperties(Resource resource, Request request, Predicate predi\n \n   public GSInstallerNoOpProvider(Resource.Type type, ClusterDefinition clusterDefinition) {\n     super(type, clusterDefinition);\n+    keyPropertyIds.put(type, \"id\");\n+  }\n+\n+\n+  @Override\n+  public Map<Resource.Type, String> getKeyPropertyIds() {\n+    return keyPropertyIds;\n+  }\n+\n+  @Override\n+  public Set<String> checkPropertyIds(Set<String> propertyIds) {\n+    return Collections.emptySet();\n   }\n }",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProvider.java",
                "sha": "948b7f59efee1cf05fb9f738e1e504e98f4f0913",
                "status": "modified"
            },
            {
                "additions": 10,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerResourceProvider.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerResourceProvider.java?ref=978f4cd86a62f5b70b4af6bf9ab9e761928e2055",
                "deletions": 1,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerResourceProvider.java",
                "patch": "@@ -140,8 +140,17 @@ protected ClusterDefinition getClusterDefinition() {\n     return clusterDefinition;\n   }\n \n+  /**\n+   * Get the resource provider type.\n+   *\n+   * @return the type\n+   */\n+  public Resource.Type getType() {\n+    return type;\n+  }\n+\n \n-  // ----- helper methods ----------------------------------------------------\n+// ----- helper methods ----------------------------------------------------\n \n   /**\n    * Get the set of property ids required to satisfy the given request.",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/main/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerResourceProvider.java",
                "sha": "539978ed345f9f443ac96cf075ea8bfc74758ffe",
                "status": "modified"
            },
            {
                "additions": 27,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/test/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProviderTest.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/test/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProviderTest.java?ref=978f4cd86a62f5b70b4af6bf9ab9e761928e2055",
                "deletions": 0,
                "filename": "ambari-server/src/test/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProviderTest.java",
                "patch": "@@ -0,0 +1,27 @@\n+package org.apache.ambari.server.controller.gsinstaller;\n+\n+import junit.framework.Assert;\n+import org.apache.ambari.server.controller.spi.Resource;\n+import org.junit.Test;\n+\n+import java.util.Collections;\n+\n+/**\n+ * GSInstallerNoOpProvider tests.\n+ */\n+public class GSInstallerNoOpProviderTest {\n+\n+  @Test\n+  public void testGetKeyPropertyIds() throws Exception {\n+    ClusterDefinition clusterDefinition = new ClusterDefinition(new TestGSInstallerStateProvider());\n+    GSInstallerNoOpProvider provider = new GSInstallerNoOpProvider(Resource.Type.Workflow, clusterDefinition);\n+    Assert.assertNotNull(provider.getKeyPropertyIds());\n+  }\n+\n+  @Test\n+  public void testCheckPropertyIds() throws Exception {\n+    ClusterDefinition clusterDefinition = new ClusterDefinition(new TestGSInstallerStateProvider());\n+    GSInstallerNoOpProvider provider = new GSInstallerNoOpProvider(Resource.Type.Workflow, clusterDefinition);\n+    Assert.assertTrue(provider.checkPropertyIds(Collections.singleton(\"id\")).isEmpty());\n+  }\n+}",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/978f4cd86a62f5b70b4af6bf9ab9e761928e2055/ambari-server/src/test/java/org/apache/ambari/server/controller/gsinstaller/GSInstallerNoOpProviderTest.java",
                "sha": "f0e66cd8c5910160aa14f1cb074dddf8b884e332",
                "status": "added"
            }
        ],
        "message": "AMBARI-2747 - NPE in GSInstaller provider",
        "parent": "https://github.com/apache/incubator-ambari/commit/9ab6227eb342c8215baae9998feaded9ecbea922",
        "repo": "incubator-ambari",
        "unit_tests": [
            "GSInstallerNoOpProviderTest.java"
        ]
    },
    "incubator-ambari_af3cb35": {
        "bug_id": "incubator-ambari_af3cb35",
        "commit": "https://github.com/apache/incubator-ambari/commit/af3cb35229d53803231e395df0df989a0cb9ebb9",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/client/src/main/java/org/apache/ambari/event/AsyncDispatcher.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/client/src/main/java/org/apache/ambari/event/AsyncDispatcher.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 0,
                "filename": "client/src/main/java/org/apache/ambari/event/AsyncDispatcher.java",
                "patch": "@@ -76,6 +76,7 @@ public void run() {\n     };\n   }\n \n+  @Override\n   public void start() {\n     eventHandlingThread = new Thread(createThread());\n     eventHandlingThread.start();",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/client/src/main/java/org/apache/ambari/event/AsyncDispatcher.java",
                "sha": "eb19876996d1c3c78d7222c521d382052648f969",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/client/src/main/java/org/apache/ambari/event/Dispatcher.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/client/src/main/java/org/apache/ambari/event/Dispatcher.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 0,
                "filename": "client/src/main/java/org/apache/ambari/event/Dispatcher.java",
                "patch": "@@ -28,5 +28,7 @@\n   EventHandler getEventHandler();\n \n   void register(Class<? extends Enum> eventType, EventHandler handler);\n+  \n+  void start();\n \n }",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/client/src/main/java/org/apache/ambari/event/Dispatcher.java",
                "sha": "5bb4cf07b1ef035dd5506096b1068269f00c2f47",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/components/impl/XmlComponentDefinition.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/components/impl/XmlComponentDefinition.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 2,
                "filename": "controller/src/main/java/org/apache/ambari/components/impl/XmlComponentDefinition.java",
                "patch": "@@ -89,7 +89,7 @@\n   @XmlAccessorType(XmlAccessType.FIELD)\n   @XmlType(name = \"prestart\")\n   public static class Prestart extends ScriptCommand {\n-    @XmlAttribute String runPrestartOn;\n+    @XmlAttribute String runOn;\n   }\n   \n   @XmlAccessorType(XmlAccessType.FIELD)\n@@ -284,7 +284,7 @@ private static String getUser(ScriptCommand cmd, String user) {\n         checkRole = null;\n       }\n       if (component.prestart != null) {\n-        prestartRole = component.prestart.runPrestartOn;\n+        prestartRole = component.prestart.runOn;\n       } else {\n         prestartRole = null;\n       }",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/components/impl/XmlComponentDefinition.java",
                "sha": "e3592a8c78cc3fbad2f928348e299e2748294d17",
                "status": "modified"
            },
            {
                "additions": 118,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/controller/HeartbeatHandler.java",
                "changes": 199,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/controller/HeartbeatHandler.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 81,
                "filename": "controller/src/main/java/org/apache/ambari/controller/HeartbeatHandler.java",
                "patch": "@@ -20,6 +20,7 @@\n import java.io.IOException;\n import java.util.ArrayList;\n import java.util.Collections;\n+import java.util.Comparator;\n import java.util.Date;\n import java.util.HashMap;\n import java.util.List;\n@@ -77,43 +78,49 @@ public ControllerResponse processHeartBeat(HeartBeat heartbeat)\n     Nodes.getInstance().checkAndUpdateNode(hostname, heartbeatTime);\n \n     List<Action> allActions = new ArrayList<Action>();\n-\n-    clusterName = Nodes.getInstance().getNode(hostname)\n-        .getNodeState().getClusterName();\n-    if (clusterName != null) {\n-      clusterRev = Clusters.getInstance().\n-          getClusterByName(clusterName).getLatestRevision(); \n-    }\n-    \n-    ComponentAndRoleStates componentStates = \n-        new ComponentAndRoleStates();\n-    //create some datastructures by looking at agent state\n-    inspectAgentState(heartbeat, componentStates);\n     \n-    //get the clusters the node belongs to\n-    Set<ClusterIdAndRev> clustersNodeBelongsTo = \n-        componentStates.getClustersNodeBelongsTo();\n     \n     //if the command-execution takes longer than one heartbeat interval\n     //the check for idleness will prevent the same node getting the same \n     //command more than once. In the future this could be improved\n     //to reflect the command execution state more accurately.\n-    if (heartbeat.getIdle()) {  \n-      for (ClusterIdAndRev clusterIdAndRev : clustersNodeBelongsTo) {\n+    if (heartbeat.getIdle()) {\n+      clusterName = Nodes.getInstance().getNode(hostname)\n+          .getNodeState().getClusterName();\n+      if (clusterName != null) {\n+        clusterRev = Clusters.getInstance().\n+            getClusterByName(clusterName).getLatestRevision(); \n+      }\n+      \n+      ComponentAndRoleStates componentStates = \n+          new ComponentAndRoleStates();\n+      //create some datastructures by looking at agent state\n+      inspectAgentState(heartbeat, componentStates);\n+      \n+      //get the clusters the node belongs to\n+      Set<ClusterNameAndRev> clustersNodeBelongsTo = \n+          componentStates.getClustersNodeBelongsTo();\n+      boolean newNode = false;\n+      //add the clusters the node *should* belong to\n+      if (clusterName != null) {\n+        newNode = checkAndAddClusterIds(clustersNodeBelongsTo, clusterName, \n+            clusterRev);\n+      }\n+      for (ClusterNameAndRev clusterIdAndRev : clustersNodeBelongsTo) {\n         //check whether this node is out-of-sync w.r.t what's running &\n         //installed, or is it compatible\n-        if (!isCompatible(clusterIdAndRev.getClusterId(), \n+        if (!isCompatible(clusterIdAndRev.getClusterName(), \n             clusterIdAndRev.getRevision(), clusterName, clusterRev)) {\n           createStopAndUninstallActions(componentStates, allActions, \n               clusterIdAndRev, true);\n           continue;\n         }\n         //get the cluster object corresponding to the clusterId\n         Cluster cluster = Clusters.getInstance()\n-            .getClusterByName(clusterIdAndRev.getClusterId());\n+            .getClusterByName(clusterIdAndRev.getClusterName());\n         //get the state machine reference to the cluster\n         ClusterFSM clusterFsm = StateMachineInvoker\n-            .getStateMachineClusterInstance(clusterIdAndRev.getClusterId());\n+            .getStateMachineClusterInstance(clusterIdAndRev.getClusterName());\n \n         //the state machine references to the services\n         List<ServiceFSM> clusterServices = clusterFsm.getServices();\n@@ -127,20 +134,25 @@ public ControllerResponse processHeartBeat(HeartBeat heartbeat)\n             boolean nodePlayingRole = \n                 nodePlayingRole(hostname, role.getRoleName());\n             if (nodePlayingRole) {\n-              boolean roleInstalled = componentStates.isInstalled(\n-                  clusterIdAndRev,\n-                  role.getAssociatedService().getServiceName(), \n-                  role.getRoleName());     \n-              boolean roleServerRunning = componentStates.isStarted(\n-                  clusterIdAndRev,\n-                  role.getAssociatedService().getServiceName(),\n-                  role.getRoleName()) \n-                  || componentStates.isStartInProgress(clusterIdAndRev,\n-                      role.getAssociatedService().getServiceName(), \n-                      role.getRoleName());\n-              boolean agentRoleStateChanged = componentStates.hasStateChanged(\n-                  clusterIdAndRev, role.getAssociatedService().getServiceName(), \n-                  role.getRoleName());\n+              boolean roleInstalled = false;\n+              boolean roleServerRunning = false;\n+              boolean agentRoleStateChanged = false;\n+              if (!newNode) {\n+                componentStates.isInstalled(\n+                    clusterIdAndRev,\n+                    role.getAssociatedService().getServiceName(), \n+                    role.getRoleName());     \n+                roleServerRunning = componentStates.isStarted(\n+                    clusterIdAndRev,\n+                    role.getAssociatedService().getServiceName(),\n+                    role.getRoleName()) \n+                    || componentStates.isStartInProgress(clusterIdAndRev,\n+                        role.getAssociatedService().getServiceName(), \n+                        role.getRoleName());\n+                agentRoleStateChanged = componentStates.hasStateChanged(\n+                    clusterIdAndRev, role.getAssociatedService().getServiceName(), \n+                    role.getRoleName());\n+              }\n               ComponentPlugin plugin = \n                   cluster.getComponentDefinition(service.getServiceName());\n               \n@@ -194,8 +206,8 @@ public ControllerResponse processHeartBeat(HeartBeat heartbeat)\n             }\n             //check/create the special component/service-level \n             //actions (like safemode check)\n-            checkAndCreateActions(cluster, clusterFsm,clusterIdAndRev, service, heartbeat, \n-                allActions, componentStates);\n+            checkAndCreateActions(cluster, clusterFsm,clusterIdAndRev, newNode,\n+                service, heartbeat, allActions, componentStates);\n           }\n         }\n         createStopAndUninstallActions(componentStates, allActions, clusterIdAndRev, false);\n@@ -208,11 +220,22 @@ public ControllerResponse processHeartBeat(HeartBeat heartbeat)\n     return r;\n   }\n   \n-  private void createInstallAction(ClusterIdAndRev clusterIdAndRev, \n+  private boolean checkAndAddClusterIds(Set<ClusterNameAndRev> clustersNodeBelongsTo, \n+      String clusterName, long clusterRev) {\n+    ClusterNameAndRev clusterNameAndRev = new ClusterNameAndRev(clusterName,\n+        clusterRev);\n+    if (!clustersNodeBelongsTo.contains(clusterNameAndRev)) {\n+      clustersNodeBelongsTo.add(clusterNameAndRev);\n+      return true;\n+    }\n+    return false;\n+  }\n+  \n+  private void createInstallAction(ClusterNameAndRev clusterIdAndRev, \n       String cluster, String component, String role, ComponentPlugin plugin, \n       List<Action> allActions) throws IOException {\n-    String clusterId = clusterIdAndRev.getClusterId();\n-    long clusterRev = clusterIdAndRev.getRevision();\n+    String clusterId = clusterIdAndRev.getClusterName();\n+    long clusterRev = clusterIdAndRev.getRevision();   \n     //action for creating dir structure\n     Action action = new Action();\n     action.setKind(Kind.CREATE_STRUCTURE_ACTION);\n@@ -232,7 +255,7 @@ private void createInstallAction(ClusterIdAndRev clusterIdAndRev,\n   }\n   \n   private void createStopAndUninstallActions(ComponentAndRoleStates componentAndRoleStates, \n-      List<Action> allActions, ClusterIdAndRev clusterIdAndRev, boolean forceUninstall) {\n+      List<Action> allActions, ClusterNameAndRev clusterIdAndRev, boolean forceUninstall) {\n     Map<String, \n         Map<String,RoleStateTracker>>\n     entrySet = componentAndRoleStates.getAllRoles(clusterIdAndRev);\n@@ -244,22 +267,22 @@ private void createStopAndUninstallActions(ComponentAndRoleStates componentAndRo\n       for (Map.Entry<String,RoleStateTracker> entryVal : roleSet) {\n         String roleName = entryVal.getKey();\n         if (forceUninstall) {\n-          addAction(getStopRoleAction(clusterIdAndRev.getClusterId(), \n+          addAction(getStopRoleAction(clusterIdAndRev.getClusterName(), \n               clusterIdAndRev.getRevision(), \n               componentName, roleName), allActions);\n-          addAction(getUninstallRoleAction(clusterIdAndRev.getClusterId(), \n+          addAction(getUninstallRoleAction(clusterIdAndRev.getClusterName(), \n               clusterIdAndRev.getRevision(), \n               componentName, roleName), allActions);\n         } else {\n           RoleStateTracker stateTracker = entryVal.getValue();\n           if (stateTracker.continueRunning) continue;\n \n-          addAction(getStopRoleAction(clusterIdAndRev.getClusterId(), \n+          addAction(getStopRoleAction(clusterIdAndRev.getClusterName(), \n               clusterIdAndRev.getRevision(), \n               componentName, roleName), allActions);\n \n           if (stateTracker.uninstall)\n-            addAction(getUninstallRoleAction(clusterIdAndRev.getClusterId(), \n+            addAction(getUninstallRoleAction(clusterIdAndRev.getClusterName(), \n                 clusterIdAndRev.getRevision(), \n                 componentName, roleName), allActions);\n         }\n@@ -268,8 +291,8 @@ private void createStopAndUninstallActions(ComponentAndRoleStates componentAndRo\n   }\n   private static class ComponentAndRoleStates {\n     //Convenience class to aid in heartbeat processing\n-    private Map<ClusterIdAndRev, Map<String, Map<String, RoleStateTracker>>>\n-    componentRoleMap = new HashMap<ClusterIdAndRev, \n+    private Map<ClusterNameAndRev, Map<String, Map<String, RoleStateTracker>>>\n+    componentRoleMap = new HashMap<ClusterNameAndRev, \n                            Map<String, Map<String, RoleStateTracker>>>();\n     \n     private Map<String, ActionResult> actionIds = \n@@ -278,17 +301,17 @@ private void createStopAndUninstallActions(ComponentAndRoleStates componentAndRo\n     private static Map<String, List<AgentRoleState>> previousStateMap =\n         new ConcurrentHashMap<String, List<AgentRoleState>>();\n     \n-    private Set<ClusterIdAndRev> clusterNodeBelongsTo = \n-        new TreeSet<ClusterIdAndRev>();\n+    private Set<ClusterNameAndRev> clusterNodeBelongsTo = \n+        new TreeSet<ClusterNameAndRev>();\n     \n     Map<String,Map<String,RoleStateTracker>> getAllRoles(\n-        ClusterIdAndRev clusterIdAndRev) {\n+        ClusterNameAndRev clusterIdAndRev) {\n       return componentRoleMap.get(clusterIdAndRev);\n     }\n     \n     void recordRoleState(String host, AgentRoleState state) {\n-      ClusterIdAndRev clusterIdAndRev = \n-          new ClusterIdAndRev(state.getClusterId(),\n+      ClusterNameAndRev clusterIdAndRev = \n+          new ClusterNameAndRev(state.getClusterId(),\n               state.getClusterDefinitionRevision());\n       clusterNodeBelongsTo.add(clusterIdAndRev);\n       \n@@ -319,7 +342,7 @@ void recordRoleState(String host, AgentRoleState state) {\n       }\n     }\n     \n-    boolean isRoleInstalled(ClusterIdAndRev clusterIdAndRev, String role) {\n+    boolean isRoleInstalled(ClusterNameAndRev clusterIdAndRev, String role) {\n       //problematic in the case where role is not unique (like 'client')\n       //TODO: no iteration please\n       Set<Map.Entry<String, Map<String, RoleStateTracker>>> entrySet = \n@@ -332,7 +355,7 @@ boolean isRoleInstalled(ClusterIdAndRev clusterIdAndRev, String role) {\n       return false;\n     }\n     \n-    boolean isStarted(ClusterIdAndRev clusterIdAndRev, String component, \n+    boolean isStarted(ClusterNameAndRev clusterIdAndRev, String component, \n         String role) {\n       Map<String,Map<String,RoleStateTracker>> componentsMap = \n           componentRoleMap.get(clusterIdAndRev);\n@@ -349,7 +372,7 @@ boolean isStarted(ClusterIdAndRev clusterIdAndRev, String component,\n       return false;\n     }\n     \n-    boolean isStartInProgress(ClusterIdAndRev clusterIdAndRev, \n+    boolean isStartInProgress(ClusterNameAndRev clusterIdAndRev, \n         String component, String role) {\n       Map<String,Map<String,RoleStateTracker>> componentsMap = \n           componentRoleMap.get(clusterIdAndRev);\n@@ -367,7 +390,7 @@ boolean isStartInProgress(ClusterIdAndRev clusterIdAndRev,\n       return false;\n     }\n     \n-    boolean isInstalled(ClusterIdAndRev clusterIdAndRev, \n+    boolean isInstalled(ClusterNameAndRev clusterIdAndRev, \n         String component, String role) {\n       Map<String,Map<String,RoleStateTracker>> componentsMap = \n           componentRoleMap.get(clusterIdAndRev);\n@@ -388,7 +411,7 @@ void recordActionId(String actionId, ActionResult actionResult) {\n     ActionResult getActionResult(String id) {\n       return actionIds.get(id);\n     }\n-    private void recordState(ClusterIdAndRev clusterIdAndRev, String component,\n+    private void recordState(ClusterNameAndRev clusterIdAndRev, String component,\n         String roleServer, AgentRoleState state) {\n       Map<String, Map<String, RoleStateTracker>> componentMap = null;\n       \n@@ -414,20 +437,20 @@ private void recordState(ClusterIdAndRev clusterIdAndRev, String component,\n               state.getClusterId(), state.getClusterDefinitionRevision()));\n       componentMap.put(component, roleMap);\n     }\n-    boolean hasStateChanged(ClusterIdAndRev clusterIdAndRev, String component,\n+    boolean hasStateChanged(ClusterNameAndRev clusterIdAndRev, String component,\n         String roleServer) {\n       return componentRoleMap.get(clusterIdAndRev).get(component)\n           .get(roleServer).stateChanged;\n     }\n-    Set<ClusterIdAndRev> getClustersNodeBelongsTo() {\n+    Set<ClusterNameAndRev> getClustersNodeBelongsTo() {\n       return clusterNodeBelongsTo;\n     }\n-    private void setStateChanged(ClusterIdAndRev clusterIdAndRev, \n+    private void setStateChanged(ClusterNameAndRev clusterIdAndRev, \n         String component, String roleServer) {\n       componentRoleMap.get(clusterIdAndRev).get(component)\n          .get(roleServer).stateChanged = true;\n     }\n-    private void continueRunning(ClusterIdAndRev clusterIdAndRev, \n+    private void continueRunning(ClusterNameAndRev clusterIdAndRev, \n         String component, String roleServer) {\n       componentRoleMap.get(clusterIdAndRev).get(component)\n          .get(roleServer).continueRunning = true;\n@@ -439,22 +462,26 @@ private void continueRunning(ClusterIdAndRev clusterIdAndRev,\n       SERVICE_AVAILABILITY_CHECK_ID, SERVICE_PRESTART_CHECK_ID\n   }  \n   \n-  private static class ClusterIdAndRev {\n-    String clusterId;\n+  private static class ClusterNameAndRev implements \n+  Comparable<ClusterNameAndRev> {\n+    String clusterName;\n     long revision;\n-    ClusterIdAndRev(String clusterId, long revision) {\n-      this.clusterId = clusterId;\n+    ClusterNameAndRev(String clusterName, long revision) {\n+      this.clusterName = clusterName;\n       this.revision = revision;\n     }\n-    String getClusterId() {\n-      return clusterId;\n+    String getClusterName() {\n+      return clusterName;\n     }\n     long getRevision() {\n       return revision;\n     }\n     @Override\n     public int hashCode() {\n-      return (clusterId + String.valueOf(revision)).hashCode();\n+      //note we only consider cluster names (one node can't have\n+      //more than one version of components of the same cluster name \n+      //installed)\n+      return clusterName.hashCode();\n     }\n     @Override\n     public boolean equals(Object obj) {\n@@ -465,8 +492,14 @@ public boolean equals(Object obj) {\n       if (obj == null || getClass() != obj.getClass()) {\n         return false;\n       }\n-      return this.clusterId.equals(((ClusterIdAndRev)obj).getClusterId()) &&\n-          this.clusterId.equals(((ClusterIdAndRev)obj).getRevision());\n+      //note we only compare cluster names (one node can't have\n+      //more than one version of components of the same cluster name \n+      //installed)\n+      return this.clusterName.equals(((ClusterNameAndRev)obj).getClusterName());\n+    }\n+    @Override\n+    public int compareTo(ClusterNameAndRev o) {\n+      return o.getClusterName().compareTo(getClusterName());\n     }\n   }\n \n@@ -498,10 +531,10 @@ private boolean isCompatible(String nodeClusterId, long nodeClusterRev,\n     }\n     return true;\n   }\n-  private static String getSpecialActionID(ClusterIdAndRev clusterIdAndRev, \n+  private static String getSpecialActionID(ClusterNameAndRev clusterIdAndRev, \n       ServiceFSM service, boolean availabilityChecker, \n       boolean prestartCheck) {\n-    String id = clusterIdAndRev.getClusterId() + clusterIdAndRev.getRevision() \n+    String id = clusterIdAndRev.getClusterName() + clusterIdAndRev.getRevision() \n         + service.getServiceName();\n     if (prestartCheck) {\n       id += SpecialServiceIDs.SERVICE_PRESTART_CHECK_ID.toString();\n@@ -549,10 +582,11 @@ private void checkActionResults(HeartBeat heartbeat,\n   }\n   \n   private void checkAndCreateActions(Cluster cluster,\n-      ClusterFSM clusterFsm, ClusterIdAndRev clusterIdAndRev, \n-      ServiceFSM service, HeartBeat heartbeat, List<Action> allActions, \n+      ClusterFSM clusterFsm, ClusterNameAndRev clusterIdAndRev, \n+      boolean newNode, ServiceFSM service, HeartBeat heartbeat, \n+      List<Action> allActions, \n       ComponentAndRoleStates installedOrStartedComponents) \n-          throws IOException {\n+          throws Exception {\n     //see whether the service is in the STARTED state, and if so,\n     //check whether there is any action-result that indicates success\n     //of the availability check (safemode, etc.)\n@@ -580,7 +614,7 @@ private void checkAndCreateActions(Cluster cluster,\n         if (installedOrStartedComponents.isRoleInstalled(clusterIdAndRev,\n             role)) {\n           Action action = plugin.checkService(cluster.getName(), role);\n-          fillActionDetails(action, clusterIdAndRev.getClusterId(),\n+          fillActionDetails(action, clusterIdAndRev.getClusterName(),\n               clusterIdAndRev.getRevision(),service.getServiceName(), role);\n           action.setId(id);\n           action.setKind(Action.Kind.RUN_ACTION);\n@@ -607,14 +641,17 @@ private void checkAndCreateActions(Cluster cluster,\n         ComponentPlugin plugin = \n             cluster.getComponentDefinition(service.getServiceName());\n         String role = plugin.runPreStartRole();\n-        if (!installedOrStartedComponents.isRoleInstalled(clusterIdAndRev,\n-            role)) {\n-          createInstallAction(clusterIdAndRev, cluster.getName(), \n-              service.getServiceName(), role, plugin,\n-              allActions);\n+        if (nodePlayingRole(heartbeat.getHostname(), role)) {\n+          if (newNode || \n+              !installedOrStartedComponents.isRoleInstalled(clusterIdAndRev,\n+              role)) {\n+            createInstallAction(clusterIdAndRev, cluster.getName(), \n+                service.getServiceName(), role, plugin,\n+                allActions);\n+          }\n         }\n         Action action = plugin.preStartAction(cluster.getName(), role);\n-        fillActionDetails(action, clusterIdAndRev.getClusterId(),\n+        fillActionDetails(action, clusterIdAndRev.getClusterName(),\n             clusterIdAndRev.getRevision(),service.getServiceName(), role);\n         action.setId(id);\n         action.setKind(Action.Kind.RUN_ACTION);",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/controller/HeartbeatHandler.java",
                "sha": "c70b45a0e03daa637fd918be5f0855c5389bfc1c",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterImpl.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterImpl.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 2,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterImpl.java",
                "patch": "@@ -49,7 +49,7 @@\n    *                                --START_FAILURE from any service--> FAIL\n    * ACTIVE --STOP--> STOPPING --STOP_SUCCESS from all services--> INACTIVE\n    *                             --STOP_FAILURE from any service--> UNCLEAN_STOP\n-   * FAIL --STOP--> STOPPING --STOP_SUCCESS--> INACTIVE\n+   * FAIL --STOP--> STOPPING --STOP_SUCCESS--> STOPPED\n    *                           --STOP_FAILURE--> UNCLEAN_STOP\n    * INACTIVE --RELEASE_NODES--> ATTIC\n    * ATTIC --ADD_NODES--> INACTIVE\n@@ -83,7 +83,10 @@\n   .addTransition(ClusterStateFSM.FAIL, ClusterStateFSM.STOPPING, \n       ClusterEventType.STOP)\n       \n-  .addTransition(ClusterStateFSM.STOPPING, ClusterStateFSM.INACTIVE, \n+  .addTransition(ClusterStateFSM.STOPPING, ClusterStateFSM.STOPPED, \n+      ClusterEventType.STOP_SUCCESS)\n+      \n+  .addTransition(ClusterStateFSM.STOPPED, ClusterStateFSM.STOPPED, \n       ClusterEventType.STOP_SUCCESS)\n       \n   .addTransition(ClusterStateFSM.STOPPING, ClusterStateFSM.UNCLEAN_STOP, \n@@ -120,6 +123,7 @@ public ClusterImpl(Cluster cluster, long revision,\n       serviceImpls.add(serviceImpl);\n     }\n     this.services = serviceImpls;\n+    this.clusterState = clusterState;\n   }\n   \n   public ClusterStateFSM getState() {",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterImpl.java",
                "sha": "483bf6a2053a52a32676953755f1bd2e08c3a852",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterStateFSM.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterStateFSM.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 1,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterStateFSM.java",
                "patch": "@@ -18,5 +18,5 @@\n package org.apache.ambari.resource.statemachine;\n \n public enum ClusterStateFSM {\n-  INACTIVE, STARTING, ACTIVE, FAIL, ATTIC, STOPPING, UNCLEAN_STOP\n+  INACTIVE, STARTING, ACTIVE, FAIL, ATTIC, STOPPING, UNCLEAN_STOP, STOPPED\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ClusterStateFSM.java",
                "sha": "8afa5e5afe86b2d7fa4a4b185741c00a0f0ae82f",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleImpl.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleImpl.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 4,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/RoleImpl.java",
                "patch": "@@ -40,7 +40,7 @@\n    *                                --S_START_FAILURE--> FAIL\n    * ACTIVE --S_STOP--> STOPPING --S_STOP_SUCCESS--> INACTIVE\n    *                             --S_STOP_FAILURE--> UNCLEAN_STOP\n-   * FAIL --S_STOP--> STOPPING --S_STOP_SUCCESS--> INACTIVE\n+   * FAIL --S_STOP--> STOPPING --S_STOP_SUCCESS--> STOPPED\n    *                           --S_STOP_FAILURE--> UNCLEAN_STOP\n    */\n   \n@@ -52,6 +52,9 @@\n          .addTransition(RoleState.INACTIVE, RoleState.STARTING, \n              RoleEventType.START)\n              \n+         .addTransition(RoleState.STOPPED, RoleState.STARTING, \n+             RoleEventType.START)\n+             \n          .addTransition(RoleState.STARTING, \n              EnumSet.of(RoleState.ACTIVE, RoleState.STARTING),\n              RoleEventType.START_SUCCESS, new SuccessfulStartTransition())\n@@ -77,10 +80,10 @@\n              \n          .addTransition(RoleState.FAIL, RoleState.STOPPING, RoleEventType.STOP)\n          \n-         .addTransition(RoleState.STOPPING, RoleState.INACTIVE, \n+         .addTransition(RoleState.STOPPING, RoleState.STOPPED, \n              RoleEventType.STOP_SUCCESS)\n              \n-         .addTransition(RoleState.INACTIVE, RoleState.INACTIVE,\n+         .addTransition(RoleState.STOPPED, RoleState.STOPPED,\n              RoleEventType.STOP_SUCCESS)\n              \n          .addTransition(RoleState.STOPPING, RoleState.UNCLEAN_STOP, \n@@ -199,7 +202,7 @@ public void deactivate() {\n \n   @Override\n   public boolean shouldStop() {\n-    return myState == RoleState.STOPPING || myState == RoleState.INACTIVE;\n+    return myState == RoleState.STOPPING || myState == RoleState.STOPPED;\n   }\n \n   @Override",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleImpl.java",
                "sha": "010867fbc3ad742f1d642abe43b98b5175932d7d",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleState.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleState.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 1,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/RoleState.java",
                "patch": "@@ -18,5 +18,5 @@\n package org.apache.ambari.resource.statemachine;\n \n public enum RoleState {\n-  INACTIVE, STARTING, ACTIVE, FAIL, STOPPING, UNCLEAN_STOP\n+  INACTIVE, STARTING, ACTIVE, FAIL, STOPPING, UNCLEAN_STOP, STOPPED\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/RoleState.java",
                "sha": "571aa19b0318cc4308b232e24f3c9eb1febb865f",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceImpl.java",
                "changes": 14,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceImpl.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 5,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceImpl.java",
                "patch": "@@ -33,7 +33,6 @@\n \n public class ServiceImpl implements ServiceFSM, EventHandler<ServiceEvent> {\n \n-  private ServiceState myState;\n   private ClusterFSM clusterFsm;\n   private ComponentPlugin plugin;\n   \n@@ -46,7 +45,7 @@\n    * STARTED --S_UNAVAILABLE--> FAIL\n    * ACTIVE --S_STOP--> STOPPING --S_STOP_SUCCESS--> INACTIVE\n    *                             --S_STOP_FAILURE--> UNCLEAN_STOP\n-   * FAIL --S_STOP--> STOPPING --S_STOP_SUCCESS--> INACTIVE\n+   * FAIL --S_STOP--> STOPPING --S_STOP_SUCCESS--> STOPPED\n    *                           --S_STOP_FAILURE--> UNCLEAN_STOP\n    */\n   \n@@ -59,6 +58,9 @@\n          .addTransition(ServiceState.INACTIVE, ServiceState.PRESTART, \n              ServiceEventType.START)\n              \n+         .addTransition(ServiceState.STOPPED, ServiceState.PRESTART, \n+             ServiceEventType.START)\n+             \n          .addTransition(ServiceState.PRESTART, ServiceState.FAIL, \n              ServiceEventType.PRESTART_FAILURE)  \n              \n@@ -100,7 +102,10 @@\n          .addTransition(ServiceState.FAIL, ServiceState.STOPPING, \n              ServiceEventType.STOP)\n              \n-         .addTransition(ServiceState.STOPPING, ServiceState.INACTIVE, \n+         .addTransition(ServiceState.STOPPING, ServiceState.STOPPED, \n+             ServiceEventType.STOP_SUCCESS)\n+             \n+         .addTransition(ServiceState.STOPPED, ServiceState.STOPPED, \n              ServiceEventType.STOP_SUCCESS)\n              \n          .addTransition(ServiceState.STOPPING, ServiceState.UNCLEAN_STOP,\n@@ -118,7 +123,6 @@ public ServiceImpl(Cluster cluster, ClusterFSM clusterFsm, String serviceName)\n       throws IOException {\n     this.clusterFsm = clusterFsm;\n     this.serviceName = serviceName;\n-    this.myState = ServiceState.INACTIVE;\n     //load plugin and get the roles and create them\n     this.plugin = cluster.getComponentDefinition(serviceName);\n     String[] roles = this.plugin.getActiveRoles();\n@@ -293,7 +297,7 @@ public void deactivate() {\n \n   @Override\n   public boolean isActive() {\n-    return myState == ServiceState.ACTIVE;\n+    return getServiceState() == ServiceState.ACTIVE;\n   }\n \n   @Override",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceImpl.java",
                "sha": "5a220e13228c22cae9168f91351a41829206c14c",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceState.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceState.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 1,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceState.java",
                "patch": "@@ -18,5 +18,5 @@\n package org.apache.ambari.resource.statemachine;\n \n public enum ServiceState {\n-  INACTIVE, PRESTART, STARTING, STARTED, ACTIVE, FAIL, STOPPING, UNCLEAN_STOP\n+  INACTIVE, PRESTART, STARTING, STARTED, ACTIVE, FAIL, STOPPING, UNCLEAN_STOP, STOPPED\n }\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/ServiceState.java",
                "sha": "b605060cfaa408005d11dceeb78815f27db1f4b5",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/StateMachineInvoker.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/java/org/apache/ambari/resource/statemachine/StateMachineInvoker.java?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 2,
                "filename": "controller/src/main/java/org/apache/ambari/resource/statemachine/StateMachineInvoker.java",
                "patch": "@@ -21,10 +21,8 @@\n import java.util.concurrent.ConcurrentHashMap;\n import java.util.concurrent.ConcurrentMap;\n \n-import org.apache.ambari.common.rest.entities.ClusterDefinition;\n import org.apache.ambari.common.rest.entities.ClusterState;\n import org.apache.ambari.controller.Cluster;\n-import org.apache.ambari.controller.HeartbeatHandler;\n import org.apache.ambari.event.AsyncDispatcher;\n import org.apache.ambari.event.Dispatcher;\n import org.apache.ambari.event.EventHandler;\n@@ -40,6 +38,7 @@\n     dispatcher.register(ClusterEventType.class, new ClusterEventDispatcher());\n     dispatcher.register(ServiceEventType.class, new ServiceEventDispatcher());\n     dispatcher.register(RoleEventType.class, new RoleEventDispatcher());\n+    dispatcher.start();\n   }\n   private static Log LOG = LogFactory.getLog(StateMachineInvoker.class);\n   public Dispatcher getAMBARIDispatcher() {",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/java/org/apache/ambari/resource/statemachine/StateMachineInvoker.java",
                "sha": "3d1358b4a17bd4ddebd90eb8bd13bcd741a7eecc",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/resources/org/apache/ambari/acd/hadoop-hdfs-0.1.0.acd",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/controller/src/main/resources/org/apache/ambari/acd/hadoop-hdfs-0.1.0.acd?ref=af3cb35229d53803231e395df0df989a0cb9ebb9",
                "deletions": 1,
                "filename": "controller/src/main/resources/org/apache/ambari/acd/hadoop-hdfs-0.1.0.acd",
                "patch": "@@ -28,11 +28,15 @@ import sys\n os.execl(\"stack/bin/hadoop\", \"stack/bin/hadoop\", role)\n ]]>\n   </start>\n-  <check run_on=\"namenode\" user=\"${hdfs.user}\">\n+  <check runOn=\"namenode\" user=\"${hdfs.user}\">\n <![CDATA[\n import os\n \n os.exec('stack/bin/hadoop', 'stack/bin/hadoop', 'dfsadmin', '-get')\n ]]>\n   </check>\n+\n+  <prestart runOn=\"namenode\" user=\"{hdfs.user}\">\n+<![CDATA[]]>\n+  </prestart>\n </component>",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/af3cb35229d53803231e395df0df989a0cb9ebb9/controller/src/main/resources/org/apache/ambari/acd/hadoop-hdfs-0.1.0.acd",
                "sha": "323f6279b95927fcfa8b1e2bca377018349e0615",
                "status": "modified"
            }
        ],
        "message": "AMBARI-100. Fixes couple of NPE bugs during heartbeat processing.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/ambari/trunk@1195038 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/incubator-ambari/commit/3c41f89722616a2c79f55ecfa7dac9f855f0bfaa",
        "repo": "incubator-ambari",
        "unit_tests": [
            "TestHeartbeatHandler.java"
        ]
    },
    "incubator-ambari_d4a2b2b": {
        "bug_id": "incubator-ambari_d4a2b2b",
        "commit": "https://github.com/apache/incubator-ambari/commit/d4a2b2b9eb0864dd26327c896547868f16a56f6e",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/d4a2b2b9eb0864dd26327c896547868f16a56f6e/contrib/ambari-log4j/src/main/java/org/apache/ambari/log4j/common/store/DatabaseStore.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/contrib/ambari-log4j/src/main/java/org/apache/ambari/log4j/common/store/DatabaseStore.java?ref=d4a2b2b9eb0864dd26327c896547868f16a56f6e",
                "deletions": 2,
                "filename": "contrib/ambari-log4j/src/main/java/org/apache/ambari/log4j/common/store/DatabaseStore.java",
                "patch": "@@ -96,10 +96,12 @@ public void persist(LoggingEvent originalEvent, Object parsedEvent)\n   @Override\n   public void close() throws IOException {\n     try {\n-      connection.close();\n+      if (this.initialized && this.connection != null) {\n+        connection.close();\n+      }\n     } catch (SQLException sqle) {\n       throw new IOException(\n-          \"Failed to close connectionto database \" + this.database, sqle);\n+          \"Failed to close connection to database \" + this.database, sqle);\n     }\n   }\n }",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/d4a2b2b9eb0864dd26327c896547868f16a56f6e/contrib/ambari-log4j/src/main/java/org/apache/ambari/log4j/common/store/DatabaseStore.java",
                "sha": "55934d42dc64997a244ff0b43a7efe7c99886eee",
                "status": "modified"
            },
            {
                "additions": 42,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/d4a2b2b9eb0864dd26327c896547868f16a56f6e/contrib/ambari-log4j/src/test/java/org/apache/ambari/log4j/common/store/TestDatabaseStore.java",
                "changes": 42,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/contrib/ambari-log4j/src/test/java/org/apache/ambari/log4j/common/store/TestDatabaseStore.java?ref=d4a2b2b9eb0864dd26327c896547868f16a56f6e",
                "deletions": 0,
                "filename": "contrib/ambari-log4j/src/test/java/org/apache/ambari/log4j/common/store/TestDatabaseStore.java",
                "patch": "@@ -0,0 +1,42 @@\n+/**\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.ambari.log4j.common.store;\n+\n+import junit.framework.TestCase;\n+import org.apache.ambari.log4j.common.LogStoreUpdateProvider;\n+import org.apache.log4j.spi.LoggingEvent;\n+\n+import java.io.IOException;\n+import java.sql.Connection;\n+\n+public class TestDatabaseStore extends TestCase {\n+\n+  class SampleLogStoreUpdateProvider implements LogStoreUpdateProvider {\n+    public void init(Connection connection) throws IOException {\n+    }\n+\n+    public void update(LoggingEvent originalEvent, Object parsedEvent)\n+        throws IOException {\n+    }\n+  }\n+\n+  public void testDatabaseStore() throws IOException {\n+    DatabaseStore store = new DatabaseStore(TestDatabaseStore.class.getName(), \"\", \"\", \"\",\n+        new SampleLogStoreUpdateProvider());\n+    store.close();\n+  }\n+}",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/d4a2b2b9eb0864dd26327c896547868f16a56f6e/contrib/ambari-log4j/src/test/java/org/apache/ambari/log4j/common/store/TestDatabaseStore.java",
                "sha": "bafe16c041f5377012e8d8083630f27c8f672faa",
                "status": "added"
            }
        ],
        "message": "AMBARI-2526. NPE in the ambari log4j when the threads are shutting down. (smohanty)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/ambari/trunk@1498603 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/incubator-ambari/commit/2b671a163da30ae9693726c0d6e5ce1b9f880ae2",
        "repo": "incubator-ambari",
        "unit_tests": [
            "TestDatabaseStore.java"
        ]
    },
    "incubator-ambari_dfb7f03": {
        "bug_id": "incubator-ambari_dfb7f03",
        "commit": "https://github.com/apache/incubator-ambari/commit/dfb7f03927aee48e81597a1dad0b270067c68563",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/dfb7f03927aee48e81597a1dad0b270067c68563/AMBARI-666-CHANGES.txt",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/AMBARI-666-CHANGES.txt?ref=dfb7f03927aee48e81597a1dad0b270067c68563",
                "deletions": 0,
                "filename": "AMBARI-666-CHANGES.txt",
                "patch": "@@ -12,6 +12,9 @@ AMBARI-666 branch (unreleased changes)\n \n   NEW FEATURES\n \n+  AMBARI-801. Fix heartbeat message from the agent which is causing NPE at the\n+  server. (mahadev)\n+\n   AMBARI-778. Ensure data flows across all steps in installer wizard.\n   (Jaimin Jetly via yusaku)\n ",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/dfb7f03927aee48e81597a1dad0b270067c68563/AMBARI-666-CHANGES.txt",
                "sha": "4ccfd6238b92c5c35bcdc33f8f48d5c23cce5d7d",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-agent/src/main/python/ambari_agent/Controller.py",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-agent/src/main/python/ambari_agent/Controller.py?ref=dfb7f03927aee48e81597a1dad0b270067c68563",
                "deletions": 1,
                "filename": "ambari-agent/src/main/python/ambari_agent/Controller.py",
                "patch": "@@ -107,7 +107,8 @@ def heartbeatWithServer(self):\n       try:\n         if retry==False:\n           data = json.dumps(self.heartbeat.build(id))\n-\n+          pass\n+        logger.info(\"Sending HeartBeat \" + pprint.pformat(data))\n         req = urllib2.Request(self.heartbeatUrl, data, {'Content-Type': 'application/json'})\n         \n         logger.info(data)",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-agent/src/main/python/ambari_agent/Controller.py",
                "sha": "445399cc7340282bfaf8737dc207bf23cf892e3a",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-agent/src/main/python/ambari_agent/Heartbeat.py",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-agent/src/main/python/ambari_agent/Heartbeat.py?ref=dfb7f03927aee48e81597a1dad0b270067c68563",
                "deletions": 2,
                "filename": "ambari-agent/src/main/python/ambari_agent/Heartbeat.py",
                "patch": "@@ -39,11 +39,15 @@ def build(self, id='-1'):\n     timestamp = int(time.time()*1000)\n     queueResult = self.actionQueue.result()\n     installedRoleStates = serverStatus.build()\n+    nodeStatus = { \"status\" : \"HEALTHY\",\n+                   \"cause\" : \"NONE\"}\n+    \n     heartbeat = { 'responseId'        : int(id),\n                   'timestamp'         : timestamp,\n                   'hostname'          : socket.gethostname(),\n-                  'reports'           : self.reports,\n-                  'componentStatus'   : self.componentStatus\n+                 # 'reports'           : self.reports,\n+                 # 'componentStatus'   : self.componentStatus,\n+                  'nodeStatus'        : nodeStatus\n                 }\n   \n     ",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-agent/src/main/python/ambari_agent/Heartbeat.py",
                "sha": "e9215f766fa187c951ee8b0e9937cf8debc83bf6",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/incubator-ambari/blob/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-server/src/main/java/org/apache/ambari/server/actionmanager/ActionManager.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/incubator-ambari/contents/ambari-server/src/main/java/org/apache/ambari/server/actionmanager/ActionManager.java?ref=dfb7f03927aee48e81597a1dad0b270067c68563",
                "deletions": 1,
                "filename": "ambari-server/src/main/java/org/apache/ambari/server/actionmanager/ActionManager.java",
                "patch": "@@ -21,8 +21,13 @@\n \n import org.apache.ambari.server.agent.ActionQueue;\n import org.apache.ambari.server.agent.CommandReport;\n+import org.apache.ambari.server.agent.rest.AgentResource;\n import org.apache.ambari.server.state.live.Clusters;\n import org.apache.ambari.server.utils.StageUtils;\n+import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n \n import com.google.inject.Inject;\n import com.google.inject.Singleton;\n@@ -38,7 +43,8 @@\n   private final ActionDBAccessor db;\n   private final ActionQueue actionQueue;\n   private final Clusters fsm;\n-\n+  private static Logger LOG = LoggerFactory.getLogger(ActionManager.class);\n+  \n   @Inject\n   public ActionManager(@Named(\"schedulerSleeptime\") long schedulerSleepTime,\n       @Named(\"actionTimeout\") long actionTimeout,",
                "raw_url": "https://github.com/apache/incubator-ambari/raw/dfb7f03927aee48e81597a1dad0b270067c68563/ambari-server/src/main/java/org/apache/ambari/server/actionmanager/ActionManager.java",
                "sha": "baa3df8fe89260b0fd093c6416863b726f005cad",
                "status": "modified"
            }
        ],
        "message": "AMBARI-801. Fix heartbeat message from the agent which is causing NPE at the server. (mahadev)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/ambari/branches/AMBARI-666@1393810 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/incubator-ambari/commit/ff66974b8912a037662212052cbd05b96c11f6e3",
        "repo": "incubator-ambari",
        "unit_tests": [
            "TestActionManager.java"
        ]
    }
}