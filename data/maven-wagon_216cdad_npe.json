[
    {
        "repo": "maven-wagon",
        "commit": "https://github.com/apache/maven-wagon/commit/216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
        "bug_id": "maven-wagon_216cdad",
        "message": "[WAGON-224] do not throw a NPE on subsequent transfers if a previous transfer failed in error\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/maven/wagon/trunk@680225 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/maven-wagon/commit/2b8ada1f225a31fc70647369e784965ca53b91be",
        "patched_files": [
            "ChecksumObserver.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/maven-wagon/raw/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java?ref=216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
                "filename": "wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "deletions": 1,
                "sha": "40231868b6f18d9747442034e2ea35b823710db6",
                "blob_url": "https://github.com/apache/maven-wagon/blob/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java",
                "patch": "@@ -83,7 +83,8 @@ public void transferCompleted( TransferEvent transferEvent )\n \n     public void transferError( TransferEvent transferEvent )\n     {\n-        digester = null;\n+        digester.reset();\n+        \n         actualChecksum = null;\n     }\n ",
                "changes": 3
            },
            {
                "status": "added",
                "additions": 92,
                "raw_url": "https://github.com/apache/maven-wagon/raw/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "contents_url": "https://api.github.com/repos/apache/maven-wagon/contents/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java?ref=216cdadcf2ebc78cd5182131a94ce9f35d0807fe",
                "filename": "wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "deletions": 0,
                "sha": "5ba5f2f6f1270a43c4e82db35b872b00af73fea8",
                "blob_url": "https://github.com/apache/maven-wagon/blob/216cdadcf2ebc78cd5182131a94ce9f35d0807fe/wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
                "patch": "@@ -0,0 +1,92 @@\n+package org.apache.maven.wagon.observers;\n+\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+import java.io.File;\n+import java.io.IOException;\n+import java.security.NoSuchAlgorithmException;\n+\n+import junit.framework.TestCase;\n+\n+import org.apache.maven.wagon.ConnectionException;\n+import org.apache.maven.wagon.ResourceDoesNotExistException;\n+import org.apache.maven.wagon.TransferFailedException;\n+import org.apache.maven.wagon.Wagon;\n+import org.apache.maven.wagon.WagonMock;\n+import org.apache.maven.wagon.authorization.AuthorizationException;\n+import org.apache.maven.wagon.events.TransferListener;\n+import org.apache.maven.wagon.repository.Repository;\n+\n+public class ChecksumObserverTest\n+    extends TestCase\n+{\n+    private Wagon wagon;\n+\n+    public void setUp()\n+        throws Exception\n+    {\n+        super.setUp();\n+\n+        wagon = new WagonMock( true );\n+\n+        Repository repository = new Repository();\n+        wagon.connect( repository );        \n+    }\n+    \n+    public void tearDown()\n+        throws ConnectionException\n+    {\n+        wagon.disconnect();\n+    }\n+\n+    public void testSubsequentTransfersAfterTransferError()\n+        throws NoSuchAlgorithmException, ResourceDoesNotExistException,\n+        AuthorizationException, IOException\n+    {\n+        TransferListener listener = new ChecksumObserver();\n+\n+        wagon.addTransferListener( listener );\n+\n+        File testFile = File.createTempFile( \"wagon\", \"tmp\" );\n+        testFile.deleteOnExit();\n+        \n+        try\n+        {\n+            wagon.get( \"resource\", testFile );\n+            fail();\n+        }\n+        catch ( TransferFailedException e )\n+        {\n+            assertTrue( true );\n+        }\n+\n+        try\n+        {\n+            wagon.get( \"resource\", testFile );\n+            fail();\n+        }\n+        catch ( TransferFailedException e )\n+        {\n+            assertTrue( true );\n+        }\n+        \n+        testFile.delete();\n+    }\n+}",
                "changes": 92
            }
        ],
        "unit_tests": [
            "ChecksumObserverTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "wagon-provider-api/src/test/java/org/apache/maven/wagon/observers/ChecksumObserverTest.java",
        "buggy_files": [
            "wagon-provider-api/src/main/java/org/apache/maven/wagon/observers/ChecksumObserver.java"
        ],
        "fixed": true
    }
]