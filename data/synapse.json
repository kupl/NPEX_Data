{
    "synapse_0a470e5": {
        "bug_id": "synapse_0a470e5",
        "commit": "https://github.com/apache/synapse/commit/0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/synapse/blob/0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java?ref=0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae",
                "deletions": 3,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "patch": "@@ -152,12 +152,16 @@ public Endpoint getEndpoint(String key) {\n             return (Endpoint) o;\n         } else {\n             Endpoint e = getConfiguration().getEndpoint(key);\n-            synchronized (e) {\n+            if (e != null) {\n                 if (!e.isInitialized()) {\n-                    e.init(synEnv);\n+                    synchronized (e) {\n+                        if (!e.isInitialized()) {\n+                            e.init(synEnv);\n+                        }\n+                    }\n                 }\n+                localEntries.put(key, e);\n             }\n-            localEntries.put(key, e);\n             return e;\n         }\n     }",
                "raw_url": "https://github.com/apache/synapse/raw/0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "sha": "bc1ceb010f568e0eb7e771989950e2cd0fa51ca1",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/synapse/blob/0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae/java/modules/core/src/test/java/org/apache/synapse/registry/DynamicResourceTest.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/test/java/org/apache/synapse/registry/DynamicResourceTest.java?ref=0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae",
                "deletions": 0,
                "filename": "java/modules/core/src/test/java/org/apache/synapse/registry/DynamicResourceTest.java",
                "patch": "@@ -125,6 +125,12 @@ public void testDynamicSequenceLookup() throws Exception {\n         assertTrue(seq1 != seq4);\n         assertTrue(!((SequenceMediator) seq1).isInitialized());\n \n+        // Phase 5\n+        System.out.println(\"Testing for non-existing sequences...\");\n+        synCtx = TestUtils.createSynapseMessageContext(\"<empty/>\", config);\n+        Mediator seq5 = synCtx.getSequence(\"non-existing-sequence\");\n+        assertNull(seq5);\n+\n         System.out.println(\"Dynamic sequence lookup tests were successful...\");\n     }\n \n@@ -172,6 +178,12 @@ public void testDynamicEndpointLookup() throws Exception {\n         assertTrue(ep1 != ep4);\n         assertTrue(!ep1.isInitialized());\n \n+        // Phase 5\n+        System.out.println(\"Testing for non-existing endpoints...\");\n+        synCtx = TestUtils.createSynapseMessageContext(\"<empty/>\", config);\n+        Endpoint ep5 = synCtx.getEndpoint(\"non-existing-endpoint\");\n+        assertNull(ep5);\n+\n         System.out.println(\"Dynamic endpoint lookup tests were successful...\");\n     }\n }",
                "raw_url": "https://github.com/apache/synapse/raw/0a470e53beb9b7bd73d9e6aa98c5bb02854cb0ae/java/modules/core/src/test/java/org/apache/synapse/registry/DynamicResourceTest.java",
                "sha": "1db68a72fddca464205da3086fcf785a216fc56e",
                "status": "modified"
            }
        ],
        "message": "Fixing SYNAPSE-652\n\nFixed possible NPE at Axis2MessageContext#getEndpoint() and updated the test cases to cover the respective scenario\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/synapse/trunk@946058 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/d4eee73ba3b4b0a0595d4f6e5cf8b3cef40b93c0",
        "repo": "synapse",
        "unit_tests": [
            "Axis2MessageContextTest.java"
        ]
    },
    "synapse_13bcc2a": {
        "bug_id": "synapse_13bcc2a",
        "commit": "https://github.com/apache/synapse/commit/13bcc2a11be1cf6fac002ece3c3de2ce4cbd22f3",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/synapse/blob/13bcc2a11be1cf6fac002ece3c3de2ce4cbd22f3/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediator.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediator.java?ref=13bcc2a11be1cf6fac002ece3c3de2ce4cbd22f3",
                "deletions": 1,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediator.java",
                "patch": "@@ -154,7 +154,12 @@ private boolean mediateWithExternalScript(MessageContext synCtx) {\n             } else {\r\n                 // load script if not already loaded\r\n                 if (scriptSourceCode == null) {\r\n-                    scriptSourceCode = ((OMElement) (synCtx.getEntry(key))).getText();\r\n+                    Object o = synCtx.getEntry(key);\r\n+                    if (o instanceof OMElement) {\r\n+                        scriptSourceCode = ((OMElement) (o)).getText();\r\n+                    } else if (o instanceof String) {\r\n+                        scriptSourceCode = (String) o;\r\n+                    }\r\n                 }\r\n                 // load BSFEngine if not already loaded\r\n                 if (bsfEngine == null) {\r",
                "raw_url": "https://github.com/apache/synapse/raw/13bcc2a11be1cf6fac002ece3c3de2ce4cbd22f3/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMediator.java",
                "sha": "10acf22272f6f362d79d9f14e05bdae54a178516",
                "status": "modified"
            }
        ],
        "message": "fix NPE and support loading text scripts from local registry and OMElements from remote\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/synapse/trunk@518561 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/0819a17529fbbaa22e241f909cd7e906805e1ab3",
        "repo": "synapse",
        "unit_tests": [
            "ScriptMediatorTest.java"
        ]
    },
    "synapse_1bb570d": {
        "bug_id": "synapse_1bb570d",
        "commit": "https://github.com/apache/synapse/commit/1bb570de552e2a2c5dd859f21358a0d41c61fd45",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 1,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "patch": "@@ -346,7 +346,7 @@ public Log getServiceLog() {\n         if (serviceName != null && synCfg.getProxyService(serviceName) != null) {\n             return LogFactory.getLog(SynapseConstants.SERVICE_LOGGER_PREFIX + serviceName);\n         } else {\n-            return null;\n+            return LogFactory.getLog(Axis2MessageContext.class);\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/core/axis2/Axis2MessageContext.java",
                "sha": "135c4a6f1fcaea1c19abf35352e2fb32e8258165",
                "status": "modified"
            },
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SequenceMediator.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SequenceMediator.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 4,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/mediators/base/SequenceMediator.java",
                "patch": "@@ -74,6 +74,10 @@ public boolean mediate(MessageContext synCtx) {\n \n         if (traceOrDebugOn) {\n             traceOrDebug(traceOn, \"Start : Sequence <\" + (name == null ? \"anonymous\" : name) + \">\");\n+\n+            if (traceOn && trace.isTraceEnabled()) {\n+                trace.trace(\"Message : \" + synCtx);\n+            }\n         }\n \n         if (key == null) {\n@@ -114,11 +118,10 @@ public boolean mediate(MessageContext synCtx) {\n                     }\n                 }\n \n-                return super.mediate(synCtx);\n+                boolean result = super.mediate(synCtx);\n \n-            } finally {\n-\n-                // if we pushed an error handler, pop it from the fault stack before we exit\n+                // if we pushed an error handler, pop it from the fault stack\n+                // before we exit normally without an exception\n                 if (errorHandlerMediator != null) {\n                     Stack faultStack = synCtx.getFaultStack();\n                     if (faultStack != null && !faultStack.isEmpty()) {\n@@ -132,6 +135,10 @@ public boolean mediate(MessageContext synCtx) {\n                     }\n                 }\n \n+                return result;\n+\n+            } finally {\n+\n                 //If this sequence is finished it's task normally\n                 if (statsOn) {\n                     StatisticsUtils.processSequenceStatistics(synCtx);\n@@ -140,6 +147,10 @@ public boolean mediate(MessageContext synCtx) {\n                 StatisticsUtils.processProxyServiceStatistics(synCtx);\n \n                 if (traceOrDebugOn) {\n+                    if (traceOn && trace.isTraceEnabled()) {\n+                        trace.trace(\"Message : \" + synCtx);\n+                    }\n+\n                     traceOrDebug(traceOn,\n                         \"End : Sequence <\" + (name == null ? \"anonymous\" : name) + \">\");\n                 }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SequenceMediator.java",
                "sha": "a33c2660a7c0bb84fc2ceb75941f95d1d7df50f8",
                "status": "modified"
            },
            {
                "additions": 20,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SynapseMediator.java",
                "changes": 28,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SynapseMediator.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 8,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/mediators/base/SynapseMediator.java",
                "patch": "@@ -47,18 +47,24 @@\n      */\n     public boolean mediate(MessageContext synCtx) {\n \n-        if (log.isDebugEnabled()) {\n-            log.debug(\"Synapse main mediator :: mediate()\");\n+        boolean traceOn = isTraceOn(synCtx);\n+        boolean traceOrDebugOn = isTraceOrDebugOn(traceOn);\n+\n+        if (traceOrDebugOn) {\n+            traceOrDebug(traceOn, \"Start : Mediation using '\" + SynapseConstants.MAIN_SEQUENCE_KEY +\n+                \"' sequence Message is a : \" + (synCtx.isResponse() ? \"response\" : \"request\"));\n+\n+            if (traceOn && trace.isTraceEnabled()) {\n+                trace.trace(\"Message : \" + synCtx);\n+            }\n         }\n-        boolean shouldTrace = shouldTrace(synCtx.getTracingState());\n+\n         try {\n-            if (shouldTrace) {\n-                trace.trace(\"Start : Synapse main mediator\");\n-            }\n             // If the message flow path is OUT, then process the satatistics\n             if (synCtx.isResponse()) {\n                 StatisticsUtils.processAllSequenceStatistics(synCtx);\n             }\n+\n             //put the required property for the collecttng statistics for the message mediation\n             StatisticsStack sequenceStack = (StatisticsStack) synCtx.getProperty(\n                     SynapseConstants.SEQUENCE_STATISTICS_STACK);\n@@ -69,10 +75,16 @@ public boolean mediate(MessageContext synCtx) {\n             String seqName = \"MainSequence\";\n             boolean isFault = synCtx.getEnvelope().getBody().hasFault();\n             sequenceStack.put(seqName,System.currentTimeMillis(),!synCtx.isResponse(),true,isFault);\n+\n             return super.mediate(synCtx);\n+\n         } finally {\n-            if (shouldTrace) {\n-                trace.trace(\"End : Synapse main mediator\");\n+            if (traceOrDebugOn) {\n+                if (traceOn && trace.isTraceEnabled()) {\n+                    trace.trace(\"Message : \" + synCtx);\n+                }\n+                traceOrDebug(traceOn, \"End : Mediation using '\" +\n+                    SynapseConstants.MAIN_SEQUENCE_KEY + \"' sequence\");\n             }\n         }\n     }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/base/SynapseMediator.java",
                "sha": "d50a145f569eefa13134edb3a56ed276447646c4",
                "status": "modified"
            },
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/DropMediator.java",
                "changes": 32,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/DropMediator.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 17,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/DropMediator.java",
                "patch": "@@ -39,29 +39,27 @@\n      */\n     public boolean mediate(MessageContext synCtx) {\n \n-        if (log.isDebugEnabled()) {\n-            log.debug(\"Drop mediator :: mediate()\");\n-        }\n-        boolean shouldTrace = shouldTrace(synCtx.getTracingState());\n-        if (shouldTrace) {\n-            trace.trace(\"Start : Drop mediator\");\n+        boolean traceOn = isTraceOn(synCtx);\n+        boolean traceOrDebugOn = isTraceOrDebugOn(traceOn);\n+\n+        if (traceOrDebugOn) {\n+            traceOrDebug(traceOn, \"Start : Drop mediator\");\n+\n+            if (traceOn && trace.isTraceEnabled()) {\n+                trace.trace(\"Message : \" + synCtx);\n+            }\n         }\n+\n         //If drop mediator is a child of a sequence\n         // and if this sequence is a IN or OUT sequence of a proxy service\n         StatisticsUtils.processProxyServiceStatistics(synCtx);\n         //If this a sequence is not  a IN or OUT sequence of a proxy service\n         StatisticsUtils.processAllSequenceStatistics(synCtx);\n-        if (synCtx.getTo() == null) {\n-            if (shouldTrace) {\n-                trace.trace(\"End : Drop mediator\");\n-            }\n-            return false;\n-        } else {\n-            synCtx.setTo(null);\n-            if (shouldTrace) {\n-                trace.trace(\"End : Drop mediator\");\n-            }\n-            return false;\n+\n+        if (traceOrDebugOn) {\n+            traceOrDebug(traceOn, \"End : Drop mediator\");\n         }\n+        synCtx.setTo(null);\n+        return false;\n     }\n }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/DropMediator.java",
                "sha": "b88ad5d5b5fdf8e31e0d0452753a0c3903da9fe2",
                "status": "modified"
            },
            {
                "additions": 22,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/LogMediator.java",
                "changes": 39,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/LogMediator.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 17,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/LogMediator.java",
                "patch": "@@ -43,16 +43,17 @@\n  */\n public class LogMediator extends AbstractMediator {\n \n-    /** Log levels ,according to the  log level ,the information going to log  will  be changed */\n-    public static final int CUSTOM = 0;\n-    public static final int SIMPLE = 1;\n+    /** Log levels, according to the log level selected, the information logged will change */\n+    public static final int CUSTOM  = 0;\n+    public static final int SIMPLE  = 1;\n     public static final int HEADERS = 2;\n-    public static final int FULL = 3;\n+    public static final int FULL    = 3;\n \n-    /** The default log level has set to SIMPLE */\n+    public static final String DEFAULT_SEP = \", \";\n+\n+    /** The default log level is set to SIMPLE */\n     private int logLevel = SIMPLE;\n     /** The separator for which used to separate logging information */\n-    public static final String DEFAULT_SEP = \", \";\n     private String separator = DEFAULT_SEP;\n     /** The holder for the custom properties */\n     private List properties = new ArrayList();\n@@ -65,20 +66,24 @@\n      */\n     public boolean mediate(MessageContext synCtx) {\n \n-        if (log.isDebugEnabled()) {\n-            log.debug(\"Log mediator :: mediate()\");\n-        }\n-        boolean shouldTrace = shouldTrace(synCtx.getTracingState());\n-        if (shouldTrace) {\n-            trace.trace(\"Start : Log mediator\");\n+        boolean traceOn = isTraceOn(synCtx);\n+        boolean traceOrDebugOn = isTraceOrDebugOn(traceOn);\n+\n+        if (traceOrDebugOn) {\n+            traceOrDebug(traceOn, \"Start : Log mediator\");\n+\n+            if (traceOn && trace.isTraceEnabled()) {\n+                trace.trace(\"Message : \" + synCtx);\n+            }\n         }\n-        String logMessage = getLogMessage(synCtx);\n+\n         if (log.isInfoEnabled()) {\n-            log.info(logMessage);\n+            String logMessage = getLogMessage(synCtx);\n         }\n-        if (shouldTrace) {\n-            trace.trace(logMessage);\n-            trace.trace(\"End : Log mediator\");\n+\n+\n+        if (traceOrDebugOn) {\n+            traceOrDebug(traceOn, \"End : Log mediator\");\n         }\n         return true;\n     }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/main/java/org/apache/synapse/mediators/builtin/LogMediator.java",
                "sha": "604959506efb44747b98976dea95c7648ab7b26d",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/test/java/org/apache/synapse/TestMessageContext.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/test/java/org/apache/synapse/TestMessageContext.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 1,
                "filename": "java/modules/core/src/test/java/org/apache/synapse/TestMessageContext.java",
                "patch": "@@ -29,6 +29,7 @@\n import org.apache.synapse.core.SynapseEnvironment;\n import org.apache.synapse.endpoints.Endpoint;\n import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n \n import java.util.HashMap;\n import java.util.Map;\n@@ -264,7 +265,7 @@ public void pushFaultHandler(FaultHandler fault) {\n     }\n \n     public Log getServiceLog() {\n-        return null;\n+        return LogFactory.getLog(TestMessageContext.class);\n     }\n \n     public MessageContext getSynapseContext() {",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/core/src/test/java/org/apache/synapse/TestMessageContext.java",
                "sha": "f30b3ded5bb21bff92374155a4752b0200165e98",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMessageContext.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMessageContext.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 1,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMessageContext.java",
                "patch": "@@ -38,6 +38,7 @@\n import org.apache.synapse.core.SynapseEnvironment;\n import org.apache.synapse.endpoints.Endpoint;\n import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n \n /**\n  * ScriptMessageContext decorates the Synapse MessageContext adding methods to use the\n@@ -295,6 +296,6 @@ public void pushFaultHandler(FaultHandler fault) {\n     }\n \n     public Log getServiceLog() {\n-        return null;\n+        return LogFactory.getLog(ScriptMessageContext.class);\n     }\n }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/extensions/src/main/java/org/apache/synapse/mediators/bsf/ScriptMessageContext.java",
                "sha": "eca2f93fb2e69bf1dac55aa8d293968cfbfb46f9",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/synapse/blob/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/extensions/src/test/java/org/apache/synapse/TestMessageContext.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/test/java/org/apache/synapse/TestMessageContext.java?ref=1bb570de552e2a2c5dd859f21358a0d41c61fd45",
                "deletions": 1,
                "filename": "java/modules/extensions/src/test/java/org/apache/synapse/TestMessageContext.java",
                "patch": "@@ -29,6 +29,7 @@\n import org.apache.synapse.core.SynapseEnvironment;\n import org.apache.synapse.endpoints.Endpoint;\n import org.apache.commons.logging.Log;\n+import org.apache.commons.logging.LogFactory;\n \n import java.util.HashMap;\n import java.util.Map;\n@@ -278,6 +279,6 @@ public void pushFaultHandler(FaultHandler fault) {\n     }\n \n     public Log getServiceLog() {\n-        return null;\n+        return LogFactory.getLog(TestMessageContext.class);\n     }\n }",
                "raw_url": "https://github.com/apache/synapse/raw/1bb570de552e2a2c5dd859f21358a0d41c61fd45/java/modules/extensions/src/test/java/org/apache/synapse/TestMessageContext.java",
                "sha": "970b39ded57e190d4fdbda0ac6483b1c42c1f855",
                "status": "modified"
            }
        ],
        "message": "fix NPE and undo wrong refactoring of popping the fault handler in a SequenceMediator when an exception is encountered\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/synapse/trunk@579139 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/821e682f5e57ea7bd26f83829ec44e027e13ce40",
        "repo": "synapse",
        "unit_tests": [
            "Axis2MessageContextTest.java",
            "SequenceMediatorTest.java",
            "DropMediatorTest.java"
        ]
    },
    "synapse_32e275f": {
        "bug_id": "synapse_32e275f",
        "commit": "https://github.com/apache/synapse/commit/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/synapse/blob/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/modules/core/src/main/java/org/apache/synapse/mediators/eip/splitter/IterateMediator.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/core/src/main/java/org/apache/synapse/mediators/eip/splitter/IterateMediator.java?ref=32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
                "deletions": 2,
                "filename": "java/modules/core/src/main/java/org/apache/synapse/mediators/eip/splitter/IterateMediator.java",
                "patch": "@@ -256,7 +256,9 @@ public void setTarget(Target target) {\n     public void init(SynapseEnvironment se) {\n         if (target != null) {\n             Endpoint endpoint = target.getEndpoint();\n-            endpoint.init(se);\n+            if (endpoint != null) {\n+                endpoint.init(se);\n+            }\n \n             ManagedLifecycle seq = target.getSequence();\n             if (seq != null) {\n@@ -268,7 +270,9 @@ public void init(SynapseEnvironment se) {\n     public void destroy() {\n         if (target != null) {\n             Endpoint endpoint = target.getEndpoint();\n-            endpoint.destroy();\n+            if (endpoint != null && endpoint.isInitialized()) {\n+                endpoint.destroy();\n+            }\n \n             ManagedLifecycle seq = target.getSequence();\n             if (seq != null) {",
                "raw_url": "https://github.com/apache/synapse/raw/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/modules/core/src/main/java/org/apache/synapse/mediators/eip/splitter/IterateMediator.java",
                "sha": "fcb7194b9ba1b4c99c44d832cd75d305298ed211",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/synapse/blob/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/modules/samples/src/main/java/samples/userguide/JSONClient.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/samples/src/main/java/samples/userguide/JSONClient.java?ref=32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
                "deletions": 1,
                "filename": "java/modules/samples/src/main/java/samples/userguide/JSONClient.java",
                "patch": "@@ -30,6 +30,7 @@\n import org.apache.axiom.om.OMElement;\n import org.apache.axiom.om.util.AXIOMUtil;\n \n+import javax.xml.namespace.QName;\n import java.io.File;\n import java.net.URL;\n \n@@ -98,7 +99,12 @@ public static void executeClient() throws Exception {\n                         \"</request></getQuote>\");\n \n         OMElement response = serviceClient.sendReceive(payload);\n-        System.out.println(\"Received response: \" + response);\n+        if (response.getLocalName().equals(\"getQuoteResponse\")) {\n+            OMElement last = response.getFirstElement().getFirstChildWithName(new QName(\"last\"));\n+            System.out.println(\"Standard :: Stock price = $\" + last.getText());\n+        } else {\n+            throw new Exception(\"Unexpected response : \" + response);\n+        }\n         Thread.sleep(1000);\n         if (configContext != null) {\n             configContext.terminate();",
                "raw_url": "https://github.com/apache/synapse/raw/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/modules/samples/src/main/java/samples/userguide/JSONClient.java",
                "sha": "25fe855fcafc7c8d5381e595ea8ed5acdba70e75",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/synapse/blob/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/repository/conf/axis2.xml",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/repository/conf/axis2.xml?ref=32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
                "deletions": 0,
                "filename": "java/repository/conf/axis2.xml",
                "patch": "@@ -136,6 +136,9 @@\n                          class=\"org.apache.synapse.format.hessian.HessianMessageFormatter\"/>-->\n         <!--<messageFormatter contentType=\"\"\n                          class=\"org.apache.synapse.format.hessian.HessianMessageFormatter\"/>-->\n+        <!--<messageFormatter contentType=\"application/json\"\n+                         class=\"org.apache.axis2.json.JSONMessageFormatter\"/>-->\n+\n     </messageFormatters>\n \n     <!-- ================================================= -->\n@@ -154,6 +157,8 @@\n                          class=\"org.apache.synapse.format.hessian.HessianMessageBuilder\"/>-->\n         <!--<messageBuilder contentType=\"\"\n                          class=\"org.apache.synapse.format.hessian.HessianMessageBuilder\"/>-->\n+        <!--<messageBuilder contentType=\"application/json\"\n+                         class=\"org.apache.axis2.json.JSONOMBuilder\"/>-->\n     </messageBuilders>\n \n     <!-- ================================================= -->",
                "raw_url": "https://github.com/apache/synapse/raw/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/repository/conf/axis2.xml",
                "sha": "56cf8c01d89893815a356575892aeefc65eac4f1",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/synapse/blob/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/src/site/xdoc/Synapse_Samples.xml",
                "changes": 36,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/src/site/xdoc/Synapse_Samples.xml?ref=32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
                "deletions": 15,
                "filename": "java/src/site/xdoc/Synapse_Samples.xml",
                "patch": "@@ -4025,8 +4025,9 @@ INFO LogMediator text = Stock price - 183.3635460215262</pre></div>\n <p>\n <strong>Objective: Use of both concurrency throttling and request rate based throttling </strong> </p>\n <p>\n-<strong>Prerequisites:</strong> Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000. </p>\n-<p>Start Synapse with the sample configuration 372 (i.e. synapse -sample 372). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Start Synapse with the sample configuration 372 (i.e. synapse -sample 372)</p>\n <p>Throttle policy is loaded from the &#x201c;throttle_policy. xml&#x201d; . That policy contains merging policy from sample 370 and 371. To check the functionality, it requires to run a load test. The all enabled request from the concurrency throttling will be controlled by the access rate base throttling according to the policy. </p>\n <p>Run the client as follows </p>\n <pre xml:space=\"preserve\">ant stockquote -Daddurl=http://localhost:8280/services/StockQuoteProxy</pre>\n@@ -4336,8 +4337,9 @@ Discounted price: 138.77458254967408</pre>\n <p>\n <strong>Objective: Demonstrate the use of XQuery mediator to import external XML documents to the XQuery engine</strong> </p>\n <p>\n-<strong>Prerequisites:</strong>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000. </p>\n-<p>Start Synapse with the sample configuration 391 (i.e. synapse -sample 391). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Start Synapse with the sample configuration 391 (i.e. synapse -sample 391). </p>\n <p>In this sample, data from commission.xml document is used inside XQuery . The stock quote price from the response and commission from the commission.xml document will be added and given as a new price . </p>\n <p>Invoke the client as follows. </p>\n <pre xml:space=\"preserve\">ant stockquote -Daddurl=http://localhost:8280/services/StockQuoteProxy</pre>\n@@ -4379,8 +4381,9 @@ Discounted price: 138.77458254967408</pre>\n <p>\n <strong>Objective: Demonstrate the use of Iterate mediator to split the messages in to parts and process them asynchronously and then aggregate the responses coming in to Synapse</strong> </p>\n <p>\n-<strong>Prerequisites:</strong>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000. </p>\n-<p>Start Synapse with the sample configuration 400 (i.e. synapse -sample 400). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Start Synapse with the sample configuration 400 (i.e. synapse -sample 400). </p>\n <p>In this sample, the message sent to Synapse is comprised of a number of elements of the same type. When Synapse receives this message it will iterate through those elements and then will send to the specified endpoint. When all the responses appear to Synapse then those messages will be aggregated to form the resultant response and will send back to the client. </p>\n <p>Invoke the client as follows. </p>\n <pre xml:space=\"preserve\">ant stockquote -Daddurl=http://localhost:8280/services/SplitAggregateProxy -Ditr=4</pre>\n@@ -4409,15 +4412,16 @@ Discounted price: 138.77458254967408</pre>\n <p>\n <strong>Objective: Demonstrate the use of Cache mediator in order to cache the response and use that cached response as the response for an identical xml request</strong> </p>\n <p>\n-<strong>Prerequisites:</strong>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000. </p>\n-<p>Start Synapse with the sample configuration 420 (i.e. synapse -sample 420). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Start Synapse with the sample configuration 420 (i.e. synapse -sample 420)</p>\n <p>In this sample, the message sent to Synapse is checked for an existing cached response by calculating the hash value of the request. If there is a cache hit in Synapse then this request will not be forwarded to the actual service, rather Synapse responds to the client with the cached response. In case of a cache miss that particular message will be forwarded to the actual service and caches that response in the out path for the use of consecutive requests of the same type. </p>\n <p>To observe this behaviour, invoke the client as follows. </p>\n <pre xml:space=\"preserve\">ant stockquote -Dtrpurl=http://localhost:8280/</pre>\n <p>You could notice that if you send more than one requests within 20 seconds only the first request is forwarded to the actual service, and the rest of the requests will be served by the cache inside Synapse. You could observe this by looking at the printed line of the axis2 server, as well as by observing a constant rate as the response to the client instead of the random rate, which changes by each and every 20 seconds.\n <br/> </p>\n <h2>\n-<a name=\"Callout\" id=\"Callout\">Synchronize web service invocation with Callout mediator </a></h2>\n+<a name=\"Callout\" id=\"Callout\">Synchronous Web Services Invocations with the Callout Mediator</a></h2>\n <p>The Callout mediator calls the given service URL with the request message which is given by the source attribute, waits for the response and attaches the received response to the destination which is given by the target attribute. Both the source and the target can be a key or an XPath. In the case of the source, this key refers to either a message context property or to a local entry. For the target, this key refers to a message context property only. </p>\n <h2>\n <a name=\"Sample430\" id=\"Sample430\">Sample 430: Simple Callout Mediator for synchronizing web service invocation</a></h2>\n@@ -4441,8 +4445,9 @@ Discounted price: 138.77458254967408</pre>\n <p>\n <strong>Objective:</strong> Demonstrate the use of the callout mediator for the synchronized web service invocation </p>\n <p>\n-<strong>Prerequisites:</strong> Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000. </p>\n-<p>Start Synapse with the sample configuration 430 (i.e. synapse -sample 430). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Start Synapse with the sample configuration 430 (i.e. synapse -sample 430)</p>\n <p>In this sample, the callout mediator does the direct service invocation to the StockQuoteService using the client request, gets the response and sets it as the first child of the SOAP message body. Then using the send mediator, the message is sent back to the client. </p>\n <p>Invoke the client as follows. </p>\n <pre xml:space=\"preserve\">ant stockquote -Daddurl=http://localhost:9000/services/SimpleStockQuoteService -Dtrpurl=http://localhost:8280/</pre></div>\n@@ -4500,10 +4505,11 @@ Discounted price: 138.77458254967408</pre>\n <p>\n <strong>Objective:</strong> Demonstrate the ability to switch between JSON and XML/SOAP content interchange formats</p>\n <p>\n-<strong>Prerequisites:</strong> Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000.</p>\n-<p>Setup Synapse and the sample Axis2 client for JSON (Refer <a href=\"Synapse_Samples_Setup.html#json\">Synapse Samples Setup Guide</a>\n-for details)</p>\n-<p>Start Synapse with the sample configuration 440 (i.e. synapse -sample 440). </p>\n+<strong>Prerequisites:</strong>\n+<br/>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on port 9000\n+<br/>Setup Synapse and the sample Axis2 client for JSON (Refer <a href=\"Synapse_Samples_Setup.html#json\">Synapse Samples Setup Guide</a>\n+for details)\n+<br/>Start Synapse with the sample configuration 440 (i.e. synapse -sample 440)</p>\n <p>Invoke the JSON client as follows. </p>\n <pre xml:space=\"preserve\">ant jsonclient -Daddurl=http://localhost:9000/services/SimpleStockQuoteService -Dtrpurl=http://localhost:8280/services/JSONProxy</pre>\n <p>JSON client will send a stockquote request to Synapse using the JSON content interchange format. Synapse",
                "raw_url": "https://github.com/apache/synapse/raw/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/src/site/xdoc/Synapse_Samples.xml",
                "sha": "e4a0e5c1ca1ae1e3ae3f7a4b5c50964eadde1596",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/synapse/blob/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/src/site/xdoc/Synapse_Samples_Setup.xml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/src/site/xdoc/Synapse_Samples_Setup.xml?ref=32e275f8cc8d2112d71f4989cb2b2124ef2b68d4",
                "deletions": 2,
                "filename": "java/src/site/xdoc/Synapse_Samples_Setup.xml",
                "patch": "@@ -775,12 +775,12 @@ SocketConnectPort=9876</pre>\n \n     <p>\n       <a href=\"http://json.org\">JSON</a> is a lightweight data-interchange format.\n-      It can be used as an alternative to the XML or SOAP. To enable the JSON support\n+      It can be used as an alternative to XML or SOAP. To enable the JSON support\n       in Synapse, following two jar files should be deployed into the 'lib' directory\n       of Synapse.\n     </p>\n     <ul>\n-        <li><a href=\"http://repo1.maven.org/maven2/org/apache/axis2/axis2-saaj\">axis2-saaj.jar</a></li>\n+        <li><a href=\"http://repo1.maven.org/maven2/org/apache/axis2/axis2-json\">axis2-json.jar</a></li>\n         <li><a href=\"http://jettison.codehaus.org/Download\">jettison.jar</a></li>\n     </ul>\n     <p>",
                "raw_url": "https://github.com/apache/synapse/raw/32e275f8cc8d2112d71f4989cb2b2124ef2b68d4/java/src/site/xdoc/Synapse_Samples_Setup.xml",
                "sha": "6fa8f3c7ff7507c48cd77c43176b12bca63fe7db",
                "status": "modified"
            }
        ],
        "message": "Updated docs\nFixed a NPE in the iterate mediator\nUpdated config\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/synapse/trunk@1001445 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/db0d05e53e180095212fa9b869696fbc500a0bad",
        "repo": "synapse",
        "unit_tests": [
            "IterateMediatorTest.java"
        ]
    },
    "synapse_3d3a6e0": {
        "bug_id": "synapse_3d3a6e0",
        "commit": "https://github.com/apache/synapse/commit/3d3a6e0454590031cc4cea4d02b1aef27e5dbd43",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/synapse/blob/3d3a6e0454590031cc4cea4d02b1aef27e5dbd43/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java?ref=3d3a6e0454590031cc4cea4d02b1aef27e5dbd43",
                "deletions": 5,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "patch": "@@ -83,10 +83,11 @@ public boolean mediate(MessageContext synCtx) {\n      * @return boolean which indicate whether this caller can or not access\n      */\n     protected boolean canAccess(MessageContext synContext, boolean shouldTrace) {\n-        boolean canAccess = true;\n         if (throttle == null) {\n             log.debug(\"Can not find a throttle\");\n+            return true;\n         }\n+        boolean canAccess = true;               \n         org.apache.axis2.context.MessageContext axis2MessageContext\n                 = ((Axis2MessageContext) synContext).getAxis2MessageContext();\n         //IP based throttling\n@@ -173,16 +174,16 @@ protected void init(MessageContext synContext, boolean shouldTrace) {\n         if (policyKey != null) {\n             Entry entry = synContext.getConfiguration().getEntryDefinition(policyKey);\n             if (entry == null) {\n-                log.warn(\"Cant not find a Entry from the Entry key \" + policyKey);\n+                log.debug(\"Cant not find a Entry from the Entry key \" + policyKey);\n                 return;\n             }\n             Object entryValue = entry.getValue();\n             if (entryValue == null) {\n-                log.warn(\"Cant not find a Policy(Enrty value) from the Entry key \" + policyKey);\n+                log.debug(\"Cant not find a Policy(Enrty value) from the Entry key \" + policyKey);\n                 return;\n             }\n             if (!(entryValue instanceof OMElement)) {\n-                log.warn(\"Entry value which is refered from the key \" + policyKey + \" is Incompatible \" +\n+                log.debug(\"Entry value which is refered from the key \" + policyKey + \" is Incompatible \" +\n                         \"for the policy element\");\n                 return;\n             }\n@@ -195,7 +196,7 @@ protected void init(MessageContext synContext, boolean shouldTrace) {\n             policyOmElement = inLinePolicy;\n         }\n         if (policyOmElement == null) {\n-            log.warn(\"Cant not find a Policy - Throttling will not occur\");\n+            log.debug(\"Cant not find a Policy - Throttling will not occur\");\n             return;\n         }\n         if (shouldTrace) {",
                "raw_url": "https://github.com/apache/synapse/raw/3d3a6e0454590031cc4cea4d02b1aef27e5dbd43/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "sha": "d7bec17f4ae308503841608d48eda3fd52079b95",
                "status": "modified"
            }
        ],
        "message": "fixed NPE in the throttle mediator \n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/synapse/trunk@540501 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/83bb7b082271fa061d94d7840007234ce51ced0a",
        "repo": "synapse",
        "unit_tests": [
            "ThrottleMediatorTest.java"
        ]
    },
    "synapse_5ac5aa6": {
        "bug_id": "synapse_5ac5aa6",
        "commit": "https://github.com/apache/synapse/commit/5ac5aa645cff6c2be6809bb08431ab3089b9a1f3",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/synapse/blob/5ac5aa645cff6c2be6809bb08431ab3089b9a1f3/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java?ref=5ac5aa645cff6c2be6809bb08431ab3089b9a1f3",
                "deletions": 1,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "patch": "@@ -305,7 +305,7 @@ private void performQuery(MessageContext synCtx, SynapseLog synLog) {\n                 }\n \n                 //Bind the external variables to the DynamicContext\n-                if (variables != null & !variables.isEmpty()) {\n+                if (variables != null && !variables.isEmpty()) {\n                     synLog.traceOrDebug(\"Binding  external variables to the DynamicContext\");\n                     for (int i = 0; i < variables.size(); i++) {\n                         MediatorVariable variable = (MediatorVariable) variables.get(i);",
                "raw_url": "https://github.com/apache/synapse/raw/5ac5aa645cff6c2be6809bb08431ab3089b9a1f3/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "sha": "fba246d686a67c25f99dc00623e863591a9fc194",
                "status": "modified"
            }
        ],
        "message": "SYNAPSE-505: Fix NPE in XQueryMediator due to invalid non short-circuited if. Thanks to Dave Brosius for catching this.\n\ngit-svn-id: https://svn.apache.org/repos/asf/synapse/trunk@744661 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/66329ea0fcd6538502bdb2d06db18461f04469db",
        "repo": "synapse",
        "unit_tests": [
            "XQueryMediatorTest.java"
        ]
    },
    "synapse_a84e85f": {
        "bug_id": "synapse_a84e85f",
        "commit": "https://github.com/apache/synapse/commit/a84e85f46ea045bc4205daba27765f42705aaf02",
        "file": [
            {
                "additions": 25,
                "blob_url": "https://github.com/apache/synapse/blob/a84e85f46ea045bc4205daba27765f42705aaf02/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "changes": 48,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java?ref=a84e85f46ea045bc4205daba27765f42705aaf02",
                "deletions": 23,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "patch": "@@ -352,32 +352,34 @@ private synchronized void createThrottleMetaData(OMElement policy,\n                 }\n             }\n \n-            includesIPThrottling = (\n-                throttle.getThrottleContext(ThrottleConstants.IP_BASED_THROTTLE_KEY) != null);\n+            if (throttle != null) {\n \n-            if (id != null) {\n-                concurrentAccessController = throttle.getConcurrentAccessController();\n-                concurrentLimit = concurrentAccessController.getLimit();\n+                includesIPThrottling = (\n+                    throttle.getThrottleContext(ThrottleConstants.IP_BASED_THROTTLE_KEY) != null);\n \n-                if (traceOrDebugOn) {\n-                    traceOrDebug(traceOn,\n-                        \"Initiating ConcurrentAccessControler for throttle group id : \" + id\n-                            + \" limit : \" + concurrentLimit);\n-                }\n-                \n-                org.apache.axis2.context.MessageContext axis2MessageContext\n-                    = ((Axis2MessageContext) synCtx).getAxis2MessageContext();\n-                ConfigurationContext configctx = axis2MessageContext.getConfigurationContext();\n-                Map accessContollers = (Map) configctx.getProperty(KEY);\n+                if (id != null) {\n+                    concurrentAccessController = throttle.getConcurrentAccessController();\n \n-                if(accessContollers == null){\n-                    accessContollers = new HashMap();\n-                    configctx.setProperty(KEY,accessContollers);\n-                }\n-                if (concurrentAccessController == null) {\n-                    accessContollers.remove(id);\n-                } else {\n-                    accessContollers.put(id, concurrentAccessController);\n+                    org.apache.axis2.context.MessageContext axis2MessageContext\n+                        = ((Axis2MessageContext) synCtx).getAxis2MessageContext();\n+                    ConfigurationContext configctx = axis2MessageContext.getConfigurationContext();\n+                    Map accessContollers = (Map) configctx.getProperty(KEY);\n+\n+                    if (accessContollers == null) {\n+                        accessContollers = new HashMap();\n+                        configctx.setProperty(KEY, accessContollers);\n+                    }\n+                    if (concurrentAccessController == null) {\n+                        accessContollers.remove(id);\n+                    } else {\n+                        concurrentLimit = concurrentAccessController.getLimit();\n+                        if (traceOrDebugOn) {\n+                            traceOrDebug(traceOn,\n+                                \"Initiating ConcurrentAccessControler for throttle group id : \" + id\n+                                    + \" limit : \" + concurrentLimit);\n+                        }\n+                        accessContollers.put(id, concurrentAccessController);\n+                    }\n                 }\n             }\n         }",
                "raw_url": "https://github.com/apache/synapse/raw/a84e85f46ea045bc4205daba27765f42705aaf02/java/modules/extensions/src/main/java/org/apache/synapse/mediators/throttle/ThrottleMediator.java",
                "sha": "161a232f9996e330345ba9a2f9bfde431bcc09fa",
                "status": "modified"
            }
        ],
        "message": "fixed NPE issue in throttle mediator\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/synapse/trunk@592020 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/3ee12ded1107f4292d2394b60fb2cd13721a0c2c",
        "repo": "synapse",
        "unit_tests": [
            "ThrottleMediatorTest.java"
        ]
    },
    "synapse_b7e5c69": {
        "bug_id": "synapse_b7e5c69",
        "commit": "https://github.com/apache/synapse/commit/b7e5c69c1482d1cc832c68dab7225d06aa877a90",
        "file": [
            {
                "additions": 20,
                "blob_url": "https://github.com/apache/synapse/blob/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "changes": 29,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java?ref=b7e5c69c1482d1cc832c68dab7225d06aa877a90",
                "deletions": 9,
                "filename": "java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "patch": "@@ -206,16 +206,27 @@ private void performQuery(MessageContext synCtx, boolean traceOrDebugOn, boolean\n                         querySource = (String) o;\n                     }\n \n-                    if (traceOrDebugOn) {\n-                        traceOrDebug(traceOn, \"Picked up the xquery source \" + querySource\n-                            + \"from the key \" + queryKey);\n-                        traceOrDebug(traceOn, \"Prepare an expression for the query \");\n-                    }\n+                    if (querySource != null) {\n+\n+                        if (traceOrDebugOn) {\n+                            traceOrDebug(traceOn, \"Picked up the xquery source \" + querySource\n+                                + \"from the key \" + queryKey);\n+                            traceOrDebug(traceOn, \"Prepare an expression for the query \");\n+                        }\n \n-                    //create an XQPreparedExpression using the query source\n-                    cachedPreparedExpression = cachedConnection.prepareExpression(querySource);\n-                    // need binding because the expression just has recreated\n-                    needBind = true;\n+                        //create an XQPreparedExpression using the query source\n+                        cachedPreparedExpression = cachedConnection.prepareExpression(querySource);\n+                        // need binding because the expression just has recreated\n+                        needBind = true;\n+\n+                    } else {\n+\n+                        if (traceOrDebugOn) {\n+                            traceOrDebug(traceOn, \"Couldn't find the xquery source with a key \"\n+                                + queryKey);\n+                        }\n+                        return;\n+                    }\n                 }\n \n                 //Bind the external variables to the DynamicContext",
                "raw_url": "https://github.com/apache/synapse/raw/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/modules/extensions/src/main/java/org/apache/synapse/mediators/xquery/XQueryMediator.java",
                "sha": "6c37c536e7cd5293e8f56ced71e85774a7f0c2d6",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/synapse/blob/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/repository/conf/sample/synapse_sample_700.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/repository/conf/sample/synapse_sample_700.xml?ref=b7e5c69c1482d1cc832c68dab7225d06aa877a90",
                "deletions": 1,
                "filename": "java/repository/conf/sample/synapse_sample_700.xml",
                "patch": "@@ -16,7 +16,7 @@\n   ~  specific language governing permissions and limitations\n   ~  under the License.\n   -->\n-        <!-- introduction to URL source properties, registry based properties and the XSLT mediator -->\n+        <!-- introduction to URL source properties, registry based properties and the XQuery mediator -->\n <definitions xmlns=\"http://ws.apache.org/ns/synapse\">\n \n     <!-- the SimpleURLRegistry allows access to a URL based registry (e.g. file:/// or http://) -->",
                "raw_url": "https://github.com/apache/synapse/raw/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/repository/conf/sample/synapse_sample_700.xml",
                "sha": "121083251e9f44349bc94791be43e10c708b1053",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/synapse/blob/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/repository/conf/sample/synapse_sample_701.xml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/repository/conf/sample/synapse_sample_701.xml?ref=b7e5c69c1482d1cc832c68dab7225d06aa877a90",
                "deletions": 1,
                "filename": "java/repository/conf/sample/synapse_sample_701.xml",
                "patch": "@@ -16,7 +16,7 @@\n   ~  specific language governing permissions and limitations\n   ~  under the License.\n   -->\n-        <!-- introduction to URL source properties, registry based properties and the XSLT mediator -->\n+        <!-- introduction to URL source properties, registry based properties and the XQuery mediator -->\n <definitions xmlns=\"http://ws.apache.org/ns/synapse\">\n \n     <!-- the SimpleURLRegistry allows access to a URL based registry (e.g. file:/// or http://) -->",
                "raw_url": "https://github.com/apache/synapse/raw/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/repository/conf/sample/synapse_sample_701.xml",
                "sha": "4dcbffde6f39e444bb50a58112038ddfbeb321ff",
                "status": "modified"
            },
            {
                "additions": 238,
                "blob_url": "https://github.com/apache/synapse/blob/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/src/site/resources/Synapse_Samples.html",
                "changes": 269,
                "contents_url": "https://api.github.com/repos/apache/synapse/contents/java/src/site/resources/Synapse_Samples.html?ref=b7e5c69c1482d1cc832c68dab7225d06aa877a90",
                "deletions": 31,
                "filename": "java/src/site/resources/Synapse_Samples.html",
                "patch": "@@ -232,7 +232,7 @@ <h2><a name=\"Sample0\">Sample 0:</a></h2>\n     &lt;!-- Send the messageto implicit destination --&gt;\n     &lt;send/&gt;\n &lt;/definitions&gt;\n- </pre>\n+</pre>\n \n <p><strong>Objective: Introduction to Synapse. Shows how a message could be\n made to pass through Synapse </strong><strong>and logged before it is\n@@ -2217,8 +2217,8 @@ <h2><a name=\"Sample105\">Sample 105:</a></h2>\n     &lt;/proxy&gt;\n &lt;/definitions&gt;</pre>\n \n-<p><strong>Objective: Routing the messages arrived to a proxy service without processing\n-the MustUnderstand headers (Security header)</strong></p>\n+<p><strong>Objective: Routing the messages arrived to a proxy service without\n+processing the MustUnderstand headers (Security header)</strong></p>\n \n <p><strong>Pre-Requisites:</strong><br>\n You may also need to download and install the unlimited strength policy files\n@@ -2231,28 +2231,30 @@ <h2><a name=\"Sample105\">Sample 105:</a></h2>\n \n <p></p>\n \n-<p>The proxy service will recieve secure messages with security headers which are MustUnderstand.\n-But hence element 'engageSec' is not present in the proxy configuration synapse\n-will not engage that Apache Rampart on this proxy service. It is expected that an MustUnderstand\n-failure exception on the AxisEngine would occur before the message arrives Synapse. But Synapse\n-handles this message and gets it in by setting all the headers which are MustUnderstand and not\n-processed to processed state. This will enable synapse to route the messages without reading the\n-Security headers (just routing the messages from client to service, both of which are secure). To\n-execute the client, send a stock quote request to the proxy service, and sign\n-and encrypt the request by specifying the client side security policy as\n-follows:</p>\n+<p>The proxy service will recieve secure messages with security headers which\n+are MustUnderstand. But hence element 'engageSec' is not present in the proxy\n+configuration synapse will not engage that Apache Rampart on this proxy\n+service. It is expected that an MustUnderstand failure exception on the\n+AxisEngine would occur before the message arrives Synapse. But Synapse\n+handles this message and gets it in by setting all the headers which are\n+MustUnderstand and not processed to processed state. This will enable synapse\n+to route the messages without reading the Security headers (just routing the\n+messages from client to service, both of which are secure). To execute the\n+client, send a stock quote request to the proxy service, and sign and encrypt\n+the request by specifying the client side security policy as follows:</p>\n <pre>ant stockquote -Dtrpurl=http://localhost:8080/soap/StockQuoteProxy -Dpolicy=./../../repository/conf/sample/resources/policy/client_policy_3.xml</pre>\n \n <p>By following through the debug logs or TCPMon output, you could see that\n the request received by the proxy service was signed and encrypted. Also,\n-looking up the WSDL of the proxy service by requesting the\n-URL http://localhost:8080/soap/StockQuoteProxy?wsdl reveals the security\n-policy attachments are not there and security is not engaged. When sending the message to the\n-backend service, you could verify that the security headers were there as in the original\n-message to synapse from client, and that the response received does use WS-Security,\n-and forwarded back to the client without any modification. You should note that this wont be a\n-security hole because the message inside synapse is signed and encrypted and can only be forwarded\n-to a secure service to be usefull.</p>\n+looking up the WSDL of the proxy service by requesting the URL\n+http://localhost:8080/soap/StockQuoteProxy?wsdl reveals the security policy\n+attachments are not there and security is not engaged. When sending the\n+message to the backend service, you could verify that the security headers\n+were there as in the original message to synapse from client, and that the\n+response received does use WS-Security, and forwarded back to the client\n+without any modification. You should note that this wont be a security hole\n+because the message inside synapse is signed and encrypted and can only be\n+forwarded to a secure service to be usefull.</p>\n \n <h1><a name=\"Transport\">Transports</a></h1>\n \n@@ -3103,17 +3105,97 @@ <h2><a name=\"Sample510\">Sample 510</a></h2>\n \n <h1><a name=\"AdvancedMediations\">Advanced mediations</a></h1>\n \n-<h2><a name=\"Sample600\">Sample 600</a></h2>\n-<pre>&lt;definitions xmlns=\"http://ws.apache.org/ns/synapse\"\n-             xmlns:throttle=\"http://ws.apache.org/ns/synapse/throttle\"&gt;\n+<h2>Sample 600</h2>\n+\n+<p></p>\n+<pre>&lt;definitions xmlns=\"http://ws.apache.org/ns/synapse\"&gt;\n+    &lt;sequence name=\"main\"&gt;\n+        &lt;in&gt;\n+            &lt;throttle id=\"A\"&gt;\n+                &lt;policy&gt;\n+                    &lt;!-- define throttle policy --&gt;\n+                    &lt;wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\"\n+                                xmlns:throttle=\"http://www.wso2.org/products/wso2commons/throttle\"&gt;\n+                        &lt;throttle:ThrottleAssertion&gt;\n+                            &lt;throttle:MaximumConcurrentAccess&gt;10&lt;/throttle:MaximumConcurrentAccess&gt;                            \n+                        &lt;/throttle:ThrottleAssertion&gt;\n+                    &lt;/wsp:Policy&gt;\n+                &lt;/policy&gt;\n+                &lt;onAccept&gt;\n+                    &lt;log level=\"custom\"&gt;\n+                        &lt;property name=\"text\" value=\"**Access Accept**\"/&gt;\n+                    &lt;/log&gt;\n+                    &lt;send&gt;\n+                        &lt;endpoint&gt;\n+                            &lt;address uri=\"http://localhost:9000/soap/SimpleStockQuoteService\"/&gt;\n+                        &lt;/endpoint&gt;\n+                    &lt;/send&gt;\n+                &lt;/onAccept&gt;\n+                &lt;onReject&gt;\n+                    &lt;log level=\"custom\"&gt;\n+                        &lt;property name=\"text\" value=\"**Access Denied**\"/&gt;\n+                    &lt;/log&gt;\n+                    &lt;makefault&gt;\n+                        &lt;code value=\"tns:Receiver\"\n+                              xmlns:tns=\"http://www.w3.org/2003/05/soap-envelope\"/&gt;\n+                        &lt;reason value=\"**Access Denied**\"/&gt;\n+                    &lt;/makefault&gt;\n+                    &lt;property name=\"RESPONSE\" value=\"true\"/&gt;\n+                    &lt;header name=\"To\" action=\"remove\"/&gt;\n+                    &lt;send/&gt;\n+                    &lt;drop/&gt;\n+                &lt;/onReject&gt;\n+            &lt;/throttle&gt;\n+        &lt;/in&gt;\n+        &lt;out&gt;\n+            &lt;throttle id=\"A\"/&gt;\n+            &lt;send/&gt;   \n+\n+\n+\n+\n+\n+\n+&lt;/out&gt;\n+    &lt;/sequence&gt;\n+&lt;/definitions&gt;                                                             finitions&gt;\n+</pre>\n+\n+<p> <b>Objective: Demonstrate the use of throttle mediator for concurrency\n+throttling </b></p>\n+\n+<p><strong>Pre-Requisites:</strong></p>\n+\n+<p>Deploy the SimpleStockQuoteService in sample Axis2 server and start it on\n+port 9000.</p>\n+\n+<p>Start Synapse with the sample configuration 600 (i.e. synapse -sample\n+600).</p>\n+\n+<p></p>\n+\n+<p>Above configuration specifies a throttle mediator inside the in mediator.\n+Therefore, all request messages directed to the main sequence will be\n+subjected to throttling. Throttle mediator has policy, onAccept and onReject\n+tags at top level. Policy tag specifies the throttling policy to be applied\n+for messages. In this sample policy contains only component called\n+\"MaximumConcurrentAccess\" .This indicates the maximum number of concurrent\n+request that may have passed through the synapse on a single unit of time. To\n+test concurrency throttling ,it is required to send concurrent request to\n+synapse. For synapse with above configuration ,if client send 20 request\n+concurrently ,then approximately half of those will success..</p>\n+\n+<h2><a name=\"Sample600\">Sample 601</a></h2>\n+<pre>&lt;definitions xmlns=\"http://ws.apache.org/ns/synapse\"&gt;\n     &lt;sequence name=\"main\"&gt;\n         &lt;in&gt;\n-            &lt;throttle:throttle&gt;\n+            &lt;throttle id=\"A\"&gt;\n                 &lt;policy&gt;\n                     &lt;!-- define throttle policy --&gt;\n                     &lt;wsp:Policy xmlns:wsp=\"http://schemas.xmlsoap.org/ws/2004/09/policy\"\n                                 xmlns:throttle=\"http://www.wso2.org/products/wso2commons/throttle\"&gt;\n                         &lt;throttle:ThrottleAssertion&gt;\n+                            &lt;throttle:MaximumConcurrentAccess&gt;10&lt;/throttle:MaximumConcurrentAccess&gt;\n                             &lt;wsp:All&gt;\n                                 &lt;throttle:ID throttle:type=\"IP\"&gt;Other&lt;/throttle:ID&gt;\n                                 &lt;wsp:ExactlyOne&gt;\n@@ -3181,19 +3263,22 @@ <h2><a name=\"Sample600\">Sample 600</a></h2>\n                         &lt;reason value=\"**Access Denied**\"/&gt;\n                     &lt;/makefault&gt;\n                     &lt;property name=\"RESPONSE\" value=\"true\"/&gt;\n-                    &lt;header name=\"To\" expression=\"get-property('ReplyTo')\"/&gt;\n+                    &lt;header name=\"To\" action=\"remove\"/&gt;\n                     &lt;send/&gt;\n                     &lt;drop/&gt;\n                 &lt;/onReject&gt;\n-            &lt;/throttle:throttle&gt;\n+            &lt;/throttle&gt;\n         &lt;/in&gt;\n         &lt;out&gt;\n+            &lt;throttle id=\"A\"/&gt;\n             &lt;send/&gt;\n         &lt;/out&gt;\n     &lt;/sequence&gt;\n-&lt;/definitions&gt;</pre>\n-<strong>Objective: Demonstrate the use of throttle mediator for restricting\n-request counts</strong>\n+&lt;/definitions&gt;\n+</pre>\n+\n+<p><strong>Objective: Demonstrate the use of throttle mediator for\n+restricting request counts</strong> </p>\n \n <p><strong>Pre-Requisites:</strong></p>\n \n@@ -3232,6 +3317,128 @@ <h2><a name=\"Sample600\">Sample 600</a></h2>\n [HttpServerWorker-2] INFO  LogMediator - text = **Access Accept**\n [HttpServerWorker-3] INFO  LogMediator - text = **Access Accept**\n [HttpServerWorker-4] INFO  LogMediator - text = **Access Accept**\n-[HttpServerWorker-5] INFO  LogMediator - text = **Access Denied**</pre>\n+[HttpServerWorker-5] INFO  LogMediator - text = **Access Denied**  </pre>\n+\n+<h2>Sample 700</h2>\n+<pre>&lt;definitions xmlns=\"http://ws.apache.org/ns/synapse\"&gt;\n+\n+    &lt;!-- the SimpleURLRegistry allows access to a URL based registry (e.g. file:/// or http://) --&gt;\n+    &lt;registry provider=\"org.apache.synapse.registry.url.SimpleURLRegistry\"&gt;\n+        &lt;!-- the root property of the simple URL registry helps resolve a resource URL as root + key --&gt;\n+        &lt;parameter name=\"root\"&gt;file:repository/conf/sample/resources/&lt;/parameter&gt;\n+        &lt;!-- all resources loaded from the URL registry would be cached for this number of milli seconds --&gt;\n+        &lt;parameter name=\"cachableDuration\"&gt;15000&lt;/parameter&gt;\n+    &lt;/registry&gt;\n+\n+    &lt;localEntry key=\"xquery-key-req\"\n+                src=\"file:repository/conf/sample/resources/xquery/xquery_req.xq\"/&gt;\n+    &lt;proxy name=\"StockQuoteProxy\"&gt;\n+        &lt;target&gt;\n+            &lt;inSequence&gt;\n+                &lt;xquery key=\"xquery-key-req\"&gt;\n+                    &lt;variable name=\"payload\" type=\"ELEMENT\"/&gt;\n+                &lt;/xquery&gt;\n+                &lt;send&gt;\n+                    &lt;endpoint&gt;\n+                        &lt;address uri=\"http://localhost:9000/soap/SimpleStockQuoteService\"/&gt;\n+                    &lt;/endpoint&gt;\n+                &lt;/send&gt;\n+            &lt;/inSequence&gt;\n+            &lt;outSequence&gt;\n+                &lt;out&gt;\n+                     &lt;xquery key=\"xquery/xquery_res.xq\"&gt;\n+                        &lt;variable name=\"payload\" type=\"ELEMENT\"/&gt;\n+                    &lt;/xquery&gt;\n+                     &lt;send/&gt;\n+                &lt;/out&gt;\n+            &lt;/outSequence&gt;\n+        &lt;/target&gt;\n+        &lt;publishWSDL uri=\"file:repository/conf/sample/resources/proxy/sample_proxy_1.wsdl\"/&gt;&lt;/proxy&gt;&lt;/definitions&gt;        </pre>\n+\n+<p></p>\n+\n+<p><b>Objective: Introduction transformation using XQuery mediator</b></p>\n+\n+<p><b>Pre-Requisites</b>:Start the Synapse configuration numbered 700: i.e.\n+synapse -sample 700 </p>\n+\n+<p>Start the Axis2 server and deploy the SimpleStockQuoteService if not\n+already done.</p>\n+\n+<p></p>\n+\n+<p>This example uses the XQuery mediator to perform transformations. This\n+sample behave same as sample number 8 and only different here is use of\n+XQuery instead of XSLT for transformations.</p>\n+\n+<p></p>\n+\n+<p>Execute the custom quote client as 'ant stockquote -Dmode=customquote ..'\n+</p>\n+<pre>ant stockquote -Daddurl=http://localhost:8080/soap/StockQuoteProxy\n+ -Dmode=customquote </pre>\n+\n+<p></p>\n+\n+<h2>Sample 701</h2>\n+\n+<p></p>\n+<pre>&lt;definitions xmlns=\"http://ws.apache.org/ns/synapse\"&gt;\n+\n+    &lt;!-- the SimpleURLRegistry allows access to a URL based registry (e.g. file:/// or http://) --&gt;\n+    &lt;registry provider=\"org.apache.synapse.registry.url.SimpleURLRegistry\"&gt;\n+        &lt;!-- the root property of the simple URL registry helps resolve a resource URL as root + key --&gt;\n+        &lt;parameter name=\"root\"&gt;file:repository/conf/sample/resources/&lt;/parameter&gt;\n+        &lt;!-- all resources loaded from the URL registry would be cached for this number of milli seconds --&gt;\n+        &lt;parameter name=\"cachableDuration\"&gt;15000&lt;/parameter&gt;\n+    &lt;/registry&gt;\n+\n+    &lt;proxy name=\"StockQuoteProxy\"&gt;\n+        &lt;target&gt;\n+            &lt;inSequence&gt;\n+                &lt;send&gt;\n+                    &lt;endpoint&gt;\n+                        &lt;address uri=\"http://localhost:9000/soap/SimpleStockQuoteService\"/&gt;\n+                    &lt;/endpoint&gt;\n+                &lt;/send&gt;\n+            &lt;/inSequence&gt;\n+            &lt;outSequence&gt;\n+                &lt;out&gt;\n+                    &lt;xquery key=\"xquery/xquery_commisson.xq\"&gt;\n+                        &lt;variable name=\"payload\" type=\"ELEMENT\"&gt;&lt;/variable&gt;\n+                            &lt;variable name=\"commission\" type=\"ELEMENT\" key=\"misc/commission.xml\"&gt;&lt;/variable&gt;\n+                    &lt;/xquery&gt;\n+                    &lt;send/&gt;\n+                &lt;/out&gt;\n+            &lt;/outSequence&gt;\n+        &lt;/target&gt;\n+        &lt;publishWSDL uri=\"file:repository/conf/sample/resources/proxy/sample_proxy_1.wsdl\"/&gt;&lt;/proxy&gt;&lt;/definitions&gt;   ns&gt;</pre>\n+\n+<p><b></b></p>\n+\n+<p><b><strong>Objective: Demonstrate the use of XQuery mediator to import\n+external XML documents to the xquery engine</strong></b></p>\n+\n+<p><strong>Pre-Requisites:</strong>Deploy the SimpleStockQuoteService in\n+sample Axis2 server and start it on port 9000.</p>\n+\n+<p>Start Synapse with the sample configuration 701 (i.e. synapse -sample\n+701).</p>\n+\n+<p>In this sample , data from commission.xml document use inside XQUERY\n+document. The stock quote prize from the response and commission from the\n+commission.xml document will be added and give as a new prize .</p>\n+\n+<p></p>\n+\n+<p>Invoke the client as bellow </p>\n+<pre>ant stockquote -Daddurl=http://localhost:8080/soap/StockQuoteProxy\n+</pre>\n+\n+<p></p>\n+\n+<p></p>\n+\n+<p></p>\n </body>\n </html>",
                "raw_url": "https://github.com/apache/synapse/raw/b7e5c69c1482d1cc832c68dab7225d06aa877a90/java/src/site/resources/Synapse_Samples.html",
                "sha": "1b99bdbb7d98e3995f871a253d22c920b917ef99",
                "status": "modified"
            }
        ],
        "message": "documents for throttle,xquery \nNPE fixed for Xquery\n\ngit-svn-id: https://svn.apache.org/repos/asf/webservices/synapse/trunk@585416 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/synapse/commit/07c4fa6c498c250e49edc3acc6cfbf5b5e7fc4d0",
        "repo": "synapse",
        "unit_tests": [
            "XQueryMediatorTest.java"
        ]
    }
}