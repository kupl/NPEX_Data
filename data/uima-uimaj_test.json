{
    "uima-uimaj_0577cba": {
        "bug_id": "uima-uimaj_0577cba",
        "commit": "https://github.com/apache/uima-uimaj/commit/0577cba0c27afe7d6bcf1cca337010f46146af4d",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/0577cba0c27afe7d6bcf1cca337010f46146af4d/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java?ref=0577cba0c27afe7d6bcf1cca337010f46146af4d",
                "deletions": 1,
                "filename": "uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "patch": "@@ -92,7 +92,12 @@ public void copyToArray(int srcOffset, FeatureStructure[] dest, int destOffset,\n     }\n     srcOffset += this.casImpl.getArrayStartAddress(this.addr);\n     for (int i = 0; i < length; i++) {\n-      dest[destOffset] = this.casImpl.createFS(this.casImpl.getHeap().heap[srcOffset]);\n+      FeatureStructure fs = null;\n+      final int address = this.casImpl.getHeap().heap[srcOffset];\n+      if (address != LowLevelCAS.NULL_FS_REF) {\n+        fs = this.casImpl.createFS(address);\n+      }\n+      dest[destOffset] = fs;\n       ++destOffset;\n       ++srcOffset;\n     }",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/0577cba0c27afe7d6bcf1cca337010f46146af4d/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "sha": "bf3095b1fec69e4be847039189a4f6e2300108c9",
                "status": "modified"
            },
            {
                "additions": 25,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/0577cba0c27afe7d6bcf1cca337010f46146af4d/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "changes": 25,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java?ref=0577cba0c27afe7d6bcf1cca337010f46146af4d",
                "deletions": 0,
                "filename": "uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "patch": "@@ -168,6 +168,31 @@ public void testToArray() {\n     assertTrue(array.get(0) == null);\n   }\n \n+  public void testCopyToArray() {\n+    FeatureStructure fs1 = this.cas.createFS(this.ts.getType(CAS.TYPE_NAME_ANNOTATION));\n+    FeatureStructure fs2 = this.cas.createFS(this.ts.getType(CAS.TYPE_NAME_TOP));\n+    FeatureStructure fs3 = this.cas.createFS(this.ts.getType(CASTestSetup.TOKEN_TYPE));\n+    ArrayFS array = this.cas.createArrayFS(4);\n+    array.set(0, fs1);\n+    array.set(1, fs2);\n+    array.set(2, fs3);\n+    // We now have an FS array with the last element being null\n+    final int destinationOffset = 2;\n+    final int destiniationSize = 10;\n+    FeatureStructure[] fsArray = new FeatureStructure[destiniationSize];\n+    // Copy to array, skipping first element\n+    // This must not throw an NPE, see UIMA-726\n+    array.copyToArray(1, fsArray, destinationOffset, array.size() - 1);\n+    assertTrue(fs2.equals(fsArray[destinationOffset]));\n+    assertTrue(fs3.equals(fsArray[destinationOffset+1]));\n+    for (int i = 0; i < destinationOffset; i++) {\n+      assertNull(fsArray[i]);\n+    }\n+    for (int i = (destinationOffset + 2); i < destiniationSize; i++) {\n+      assertNull(fsArray[i]);\n+    }\n+  }\n+  \n   public void testArraysOfArrays() {\n     Type annotationType = this.ts.getType(CAS.TYPE_NAME_ANNOTATION);\n     AnnotationFS annot = this.cas.createAnnotation(annotationType, 0, 5);",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/0577cba0c27afe7d6bcf1cca337010f46146af4d/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "sha": "9107de820da0e5a6e1bbb3f6ef157d2f68d20c95",
                "status": "modified"
            }
        ],
        "message": "Jira UIMA-726: fixed NPE, test case created.\n\nhttps://issues.apache.org/jira/browse/UIMA-726\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@616637 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/bbefe81af75fac7989db421268f2aa5583cc824e",
        "patched_files": [
            "ArrayFSImpl.java",
            "ArrayFS.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "ArrayFSTest.java"
        ]
    },
    "uima-uimaj_16526d6": {
        "bug_id": "uima-uimaj_16526d6",
        "commit": "https://github.com/apache/uima-uimaj/commit/16526d6f2e58da9582ff0d9dfbc7f6443513aeff",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/16526d6f2e58da9582ff0d9dfbc7f6443513aeff/uimaj-core/src/main/java/org/apache/uima/cas/impl/XmiCasDeserializer.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/cas/impl/XmiCasDeserializer.java?ref=16526d6f2e58da9582ff0d9dfbc7f6443513aeff",
                "deletions": 3,
                "filename": "uimaj-core/src/main/java/org/apache/uima/cas/impl/XmiCasDeserializer.java",
                "patch": "@@ -628,8 +628,8 @@ private void doDeferFsOrThrow(String idStr, String nameSpaceURI, String localNam\n       this.deferredFsElement = new OotsElementData(\n           idStr, \n           new XmlElementName(nameSpaceURI, localName, qualifiedName),\n-          locator.getLineNumber(),\n-          locator.getColumnNumber());\n+          (locator == null) ? 0 : locator.getLineNumber(),\n+          (locator == null) ? 0 : locator.getColumnNumber());\n       \n       deferredFSs.add(this.deferredFsElement);\n       // This next call isn't about oots data, it's reusing that to store the attributes with the deferred thing.\n@@ -1871,7 +1871,7 @@ public void ignorableWhitespace(char[] arg0, int arg1, int arg2) throws SAXExcep\n      */\n     @Override\n     public void setDocumentLocator(Locator loc) {\n-      // System.out.println(\"Setting document locator.\");\n+//       System.out.println(\"debug  DEBUG  Setting document locator.\");\n       this.locator = loc;\n     }\n ",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/16526d6f2e58da9582ff0d9dfbc7f6443513aeff/uimaj-core/src/main/java/org/apache/uima/cas/impl/XmiCasDeserializer.java",
                "sha": "0fcb0b7213d930e4bf49fa74e4dfdc121d954986",
                "status": "modified"
            }
        ],
        "message": "[UIMA-4674] avoid npe when locator value not available\n\ngit-svn-id: https://svn.apache.org/repos/asf/uima/uimaj/branches/experiment-v3-jcas@1759855 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/3fed532b0831f01ab021b914e06c93d265c380e7",
        "patched_files": [
            "XmiCasDeserializer.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "XmiCasDeserializerTest.java"
        ]
    },
    "uima-uimaj_30fc261": {
        "bug_id": "uima-uimaj_30fc261",
        "commit": "https://github.com/apache/uima-uimaj/commit/30fc261f79fb3d0c074b4954487a88858f669646",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/30fc261f79fb3d0c074b4954487a88858f669646/uimaj-core/src/main/java/org/apache/uima/cas/impl/XCASSerializer.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/cas/impl/XCASSerializer.java?ref=30fc261f79fb3d0c074b4954487a88858f669646",
                "deletions": 1,
                "filename": "uimaj-core/src/main/java/org/apache/uima/cas/impl/XCASSerializer.java",
                "patch": "@@ -540,7 +540,7 @@ private void encodePrimitiveTypeArrayFS(String[] data, String typeName, Attribut\n \n       for (int i = 0; i < data.length; i++) {\n         startElement(ARRAY_ELEMENT_TAG, emptyAttrs, 1);\n-        addText(data[i]);\n+        addText(data[i] == null ? \"\" : data[i]);\n         endElement(ARRAY_ELEMENT_TAG);\n       }\n       endElement(typeName);",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/30fc261f79fb3d0c074b4954487a88858f669646/uimaj-core/src/main/java/org/apache/uima/cas/impl/XCASSerializer.java",
                "sha": "20b3665d9721f3c2d329f686a80064e303964f61",
                "status": "modified"
            },
            {
                "additions": 26,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/30fc261f79fb3d0c074b4954487a88858f669646/uimaj-core/src/test/java/org/apache/uima/cas/impl/XCASDeserializerTest.java",
                "changes": 26,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/cas/impl/XCASDeserializerTest.java?ref=30fc261f79fb3d0c074b4954487a88858f669646",
                "deletions": 0,
                "filename": "uimaj-core/src/test/java/org/apache/uima/cas/impl/XCASDeserializerTest.java",
                "patch": "@@ -19,6 +19,8 @@\n \n package org.apache.uima.cas.impl;\n \n+import java.io.ByteArrayInputStream;\n+import java.io.ByteArrayOutputStream;\n import java.io.File;\n import java.io.FileInputStream;\n import java.io.InputStream;\n@@ -370,4 +372,28 @@ public void testv1FormatXcas() throws Exception {\n     assertTrue(gerView.getDocumentText().equals(\"das bier ist gut\"));\n     assertTrue(gerView.getAnnotationIndex().size() == 5); // 4 annots plus documentAnnotation\n   }\n+  \n+  public void testStringArrayWithNullValues() throws Exception {\n+    CAS cas = CasCreationUtils.createCas(typeSystem, new TypePriorities_impl(), indexes);\n+    StringArrayFS strArray = cas.createStringArrayFS(3);\n+    strArray.set(1, \"value\");\n+    cas.getIndexRepository().addFS(strArray);\n+    \n+    assertEquals(null, strArray.get(0));\n+    assertEquals(\"value\", strArray.get(1));\n+    assertEquals(null, strArray.get(2));\n+    \n+    //serialize to XCAS and back\n+    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n+    XCASSerializer.serialize(cas,baos);\n+    ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());\n+    XCASDeserializer.deserialize(bais, cas);\n+\n+    //check\n+    Iterator iter = cas.getIndexRepository().getAllIndexedFS(cas.getTypeSystem().getType(\"uima.cas.StringArray\"));\n+    StringArrayFS strArrayOut = (StringArrayFS)iter.next();\n+    assertEquals(null, strArrayOut.get(0));\n+    assertEquals(\"value\", strArrayOut.get(1));\n+    assertEquals(null, strArrayOut.get(2));\n+  }\n }",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/30fc261f79fb3d0c074b4954487a88858f669646/uimaj-core/src/test/java/org/apache/uima/cas/impl/XCASDeserializerTest.java",
                "sha": "6be1a1247828366c439aa0bdaef095ef1312f935",
                "status": "modified"
            }
        ],
        "message": "UIMA-1344: Fix NPE in XCASSerializer when a StringArray has a null element.  https://issues.apache.org/jira/browse/UIMA-1344\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@773917 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/6305f31d56c8ce99c34d82e2a33dd218dcdf28b9",
        "patched_files": [
            "XCASDeserializer.java",
            "XCASSerializer.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "XCASDeserializerTest.java"
        ]
    },
    "uima-uimaj_7e37e71": {
        "bug_id": "uima-uimaj_7e37e71",
        "commit": "https://github.com/apache/uima-uimaj/commit/7e37e710f9c833150b7ef0e02711c918d43480eb",
        "file": [
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/7e37e710f9c833150b7ef0e02711c918d43480eb/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java?ref=7e37e710f9c833150b7ef0e02711c918d43480eb",
                "deletions": 1,
                "filename": "uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "patch": "@@ -362,7 +362,10 @@ public void testProcess() throws Exception {\n                       .getFile(\"TextAnalysisEngineImplTest/AggregateTaeWithCasConsumer.xml\")));\n       _testProcess(aggWithCcDesc);      \n       // test that CAS Consumer ran\n-      assertTrue(outFile.exists());\n+      if (null == outFile) {\n+        outFile = JUnitExtension.getFile(\"CpmOutput.txt\");\n+      }\n+      assertTrue(outFile != null && outFile.exists());\n       assertTrue(outFile.length() > 0);\n       outFile.delete();\n       ",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/7e37e710f9c833150b7ef0e02711c918d43480eb/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "sha": "87ea363a73b54095920f251d1f0d465a52409db3",
                "status": "modified"
            }
        ],
        "message": "no Jira - correct another NPE in the same test case - if the local variable outFile is initially null, it isn't recomputed after the analysis engine runs (the AE creates the file).\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@819733 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/cf05660262eca3be82e33f25ab1e0cec46bd5636",
        "patched_files": [],
        "repo": "uima-uimaj",
        "unit_tests": [
            "AnalysisEngine_implTest.java"
        ]
    },
    "uima-uimaj_7f7d545": {
        "bug_id": "uima-uimaj_7f7d545",
        "commit": "https://github.com/apache/uima-uimaj/commit/7f7d5459a2a86ed9a10ead295c196d72ec2d2e90",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/7f7d5459a2a86ed9a10ead295c196d72ec2d2e90/uimaj-core/src/main/java/org/apache/uima/util/impl/XMLParser_impl.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/util/impl/XMLParser_impl.java?ref=7f7d5459a2a86ed9a10ead295c196d72ec2d2e90",
                "deletions": 0,
                "filename": "uimaj-core/src/main/java/org/apache/uima/util/impl/XMLParser_impl.java",
                "patch": "@@ -916,6 +916,7 @@ private URL getResourceSpecifierSchemaUrl() {\n       UIMAFramework.getLogger(CLASS_NAME).logrb(Level.WARNING, CLASS_NAME.getName(),\n               \"getSchemaURL\", LOG_RESOURCE_BUNDLE,\n               \"UIMA_resource_specifier_schema_not_found__WARNING\");\n+      return null;\n     }\n     String urlString = schemaURL.toString();\n     if (0 <= urlString.indexOf(\" \")) {",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/7f7d5459a2a86ed9a10ead295c196d72ec2d2e90/uimaj-core/src/main/java/org/apache/uima/util/impl/XMLParser_impl.java",
                "sha": "03efc96d71026e00f8ec9cf96c434ce24d1a558f",
                "status": "modified"
            }
        ],
        "message": "no Jira - fix potential NPE introduced with last fix to \ngetResourceSpecifierSchemaUrl\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@554943 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/902d8afb55c98fc25356136e0f408e8544b15cd2",
        "patched_files": [
            "XMLParser_impl.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "XMLParser_implTest.java"
        ]
    },
    "uima-uimaj_9349b33": {
        "bug_id": "uima-uimaj_9349b33",
        "commit": "https://github.com/apache/uima-uimaj/commit/9349b33c69e679ec45fdbd97bcc42994628f71a3",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/9349b33c69e679ec45fdbd97bcc42994628f71a3/uimaj-core/src/test/java/org/apache/uima/util/impl/JSR47Logger_implTest.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/util/impl/JSR47Logger_implTest.java?ref=9349b33c69e679ec45fdbd97bcc42994628f71a3",
                "deletions": 0,
                "filename": "uimaj-core/src/test/java/org/apache/uima/util/impl/JSR47Logger_implTest.java",
                "patch": "@@ -67,6 +67,12 @@ public void testIsLoggable() throws Exception {\n     org.apache.uima.util.Logger classLogger = JSR47Logger_impl.getInstance(this.getClass());\n \n     Level defaultLogLevel = (Level) logLevels.get(LogManager.getLogManager().getProperty(\".level\"));\n+    \n+    if(defaultLogLevel == null) {\n+      //no log level was specified, use default log level settings \"INFO\" that is also \n+      //used by the Java logging framework.\n+      defaultLogLevel = Level.INFO;\n+    }\n \n     // check message logging for root logger based on default log level\n     Assert.assertEquals(defaultLogLevel.isGreaterOrEqual(Level.ALL), rootLogger",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/9349b33c69e679ec45fdbd97bcc42994628f71a3/uimaj-core/src/test/java/org/apache/uima/util/impl/JSR47Logger_implTest.java",
                "sha": "0a10fc89b6f989cc8f8d24a0e6bc853168ad38d5",
                "status": "modified"
            }
        ],
        "message": "JIRA ticket UIMA-195 (https://issues.apache.org/jira/browse/UIMA-195)\n\nfix NullPointerException - use a default log level if there is no log level specified \nby the application. The default log level for the Java logging framework in this case is\n\"INFO\" so I also used \"INFO\" as default log level.\n\n\n\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@498654 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/516b39ab512cca11f58bc57749ee26e53ad0ea73",
        "patched_files": [
            "JSR47Logger_impl.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "JSR47Logger_implTest.java"
        ]
    },
    "uima-uimaj_972e8c6": {
        "bug_id": "uima-uimaj_972e8c6",
        "commit": "https://github.com/apache/uima-uimaj/commit/972e8c616838830794f91658b4de32a591a44e3b",
        "file": [
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/972e8c616838830794f91658b4de32a591a44e3b/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java?ref=972e8c616838830794f91658b4de32a591a44e3b",
                "deletions": 1,
                "filename": "uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "patch": "@@ -117,7 +117,12 @@ public void copyToArray(int srcOffset, String[] dest, int destOffset, int length\n     final CASImpl ll = this.casImpl;\n     ll.checkArrayBounds(this.addr, srcOffset, length);\n     for (int i = 0; i < length; i++) {\n-      dest[i + destOffset] = ll.ll_getFSForRef(ll.ll_getRefArrayValue(this.addr, i + srcOffset)).toString();\n+      final int address = ll.ll_getRefArrayValue(this.addr, i + srcOffset);\n+      String value = null;\n+      if (address != LowLevelCAS.NULL_FS_REF) {\n+        value = ll.ll_getFSForRef(address).toString();\n+      }\n+      dest[i + destOffset] = value;\n     }\n   }\n ",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/972e8c616838830794f91658b4de32a591a44e3b/uimaj-core/src/main/java/org/apache/uima/cas/impl/ArrayFSImpl.java",
                "sha": "b6514184483d22c4d53cd167b49dfb789a5b0654",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/972e8c616838830794f91658b4de32a591a44e3b/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java?ref=972e8c616838830794f91658b4de32a591a44e3b",
                "deletions": 0,
                "filename": "uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "patch": "@@ -180,16 +180,22 @@ public void testCopyToArray() {\n     final int destinationOffset = 2;\n     final int destiniationSize = 10;\n     FeatureStructure[] fsArray = new FeatureStructure[destiniationSize];\n+    String[] stringArray = new String[destiniationSize];\n     // Copy to array, skipping first element\n     // This must not throw an NPE, see UIMA-726\n     array.copyToArray(1, fsArray, destinationOffset, array.size() - 1);\n+    array.copyToArray(1, stringArray, destinationOffset, array.size() - 1);\n     assertTrue(fs2.equals(fsArray[destinationOffset]));\n     assertTrue(fs3.equals(fsArray[destinationOffset+1]));\n+    assertNotNull(stringArray[destinationOffset]);\n+    assertNotNull(stringArray[destinationOffset+1]);\n     for (int i = 0; i < destinationOffset; i++) {\n       assertNull(fsArray[i]);\n+      assertNull(stringArray[i]);\n     }\n     for (int i = (destinationOffset + 2); i < destiniationSize; i++) {\n       assertNull(fsArray[i]);\n+      assertNull(stringArray[i]);\n     }\n   }\n   ",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/972e8c616838830794f91658b4de32a591a44e3b/uimaj-core/src/test/java/org/apache/uima/cas/test/ArrayFSTest.java",
                "sha": "9e1b052bdf13e09f080fac315e184fd6f052b677",
                "status": "modified"
            }
        ],
        "message": "Jira UIMA-726: fixed NPE, test case created.\n\nhttps://issues.apache.org/jira/browse/UIMA-726\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@616640 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/0577cba0c27afe7d6bcf1cca337010f46146af4d",
        "patched_files": [
            "ArrayFSImpl.java",
            "ArrayFS.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "ArrayFSTest.java"
        ]
    },
    "uima-uimaj_cf05660": {
        "bug_id": "uima-uimaj_cf05660",
        "commit": "https://github.com/apache/uima-uimaj/commit/cf05660262eca3be82e33f25ab1e0cec46bd5636",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/cf05660262eca3be82e33f25ab1e0cec46bd5636/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java?ref=cf05660262eca3be82e33f25ab1e0cec46bd5636",
                "deletions": 1,
                "filename": "uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "patch": "@@ -350,7 +350,7 @@ public void testProcess() throws Exception {\n \n       // test aggregate TAE containing a CAS Consumer\n       File outFile = JUnitExtension.getFile(\"CpmOutput.txt\");\n-      if(outFile.exists()) {\n+      if(outFile != null && outFile.exists()) {\n         //outFile.delete() //can't be relied upon.  Instead set file to zero length.\n         FileOutputStream fos = new FileOutputStream(outFile, false);\n         fos.close();",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/cf05660262eca3be82e33f25ab1e0cec46bd5636/uimaj-core/src/test/java/org/apache/uima/analysis_engine/impl/AnalysisEngine_implTest.java",
                "sha": "2b808c7dc98aeba616de1873d74ded52b0707f3f",
                "status": "modified"
            }
        ],
        "message": "no Jira - correct NPE in test case - checking for existence of test output file - if it's not there, then NPE.  Discovered on Linux.  Doesn't happen on Windows - probably because the file is always there - there's another test case that creates it, and the tests could run in a different order between Windows and Linux.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/uima/uimaj/trunk@819716 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/466e8b055fe97b43a96cf23e2817ed2a9aca3d6a",
        "patched_files": [],
        "repo": "uima-uimaj",
        "unit_tests": [
            "AnalysisEngine_implTest.java"
        ]
    },
    "uima-uimaj_cf9d5c9": {
        "bug_id": "uima-uimaj_cf9d5c9",
        "commit": "https://github.com/apache/uima-uimaj/commit/cf9d5c9b007f9c377ce244d5e155d0971b048bc0",
        "file": [
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/java/org/apache/uima/UIMARuntimeException.java",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/UIMARuntimeException.java?ref=cf9d5c9b007f9c377ce244d5e155d0971b048bc0",
                "deletions": 0,
                "filename": "uimaj-core/src/main/java/org/apache/uima/UIMARuntimeException.java",
                "patch": "@@ -117,6 +117,24 @@\n    */\n   public static final String RESULT_SPEC_NULL = \"result_spec_null\";\n \n+  /**\n+   * Message key for a standard UIMA exception message:\n+   * In CasCopier, the {0} view is doesn't belong to the original {0} CAS specified when creating the CasCopier instance \n+   */\n+  public static final String VIEW_NOT_PART_OF_CAS = \"view_not_part_of_cas\";\n+  \n+  /**\n+   * Message key for a standard UIMA exception message:\n+   * Unsupported invocation of CasCopier copyCasView, specifying a source or destination as a base CAS.  \n+   */\n+  public static final String UNSUPPORTED_CAS_COPY_TO_OR_FROM_BASE_CAS = \"unsupported_cas_copy_view_base_cas\";\n+ \n+  /**\n+   * Message key for a standard UIMA exception message:\n+   * It is not permitted to use CasCopier to copy a Cas to itself, even in another view.  \n+   */\n+  public static final String ILLEGAL_CAS_COPY_TO_SAME_CAS = \"illegal_cas_copy_to_same_cas\";\n+  \n   /**\n    * Creates a new exception with a null message.\n    */",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/java/org/apache/uima/UIMARuntimeException.java",
                "sha": "0afb81ec51c0326da4890e2c776be6627118fd9b",
                "status": "modified"
            },
            {
                "additions": 101,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/java/org/apache/uima/util/CasCopier.java",
                "changes": 138,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/util/CasCopier.java?ref=cf9d5c9b007f9c377ce244d5e155d0971b048bc0",
                "deletions": 37,
                "filename": "uimaj-core/src/main/java/org/apache/uima/util/CasCopier.java",
                "patch": "@@ -53,11 +53,22 @@\n  * CasCopier and use it to copy multiple FeatureStructures. The CasCopier will remember previously\n  * copied FeatureStructures, so if you later copy another FS that has a reference to a previously\n  * copied FS, it will not duplicate the multiply-referenced FS.\n+ * \n  */\n public class CasCopier {\n-  private CAS mSrcCas;\n-  private CAS mDestCas;\n+  private final CAS mSrcBaseCas;\n+  private final CAS mDestBaseCas;\n+  \n+  private final CAS mOriginalSrcCasView;\n+  private final CAS mOriginalTgtCasView;\n+  /**\n+   * The source view name - may be null if the view is of the base CAS\n+   */\n   private String mSrcCasViewName;\n+  /**\n+   * The target view name - not used unless doing a view copy \n+   * Allows copying a view to another CAS under a different name\n+   */\n   private String mTgtCasViewName;\n   private LowLevelCAS mLowLevelDestCas;\n   final private Feature mDestSofaFeature;\n@@ -85,6 +96,9 @@\n    *       the destination CAS, the copy will fail (in other words, the lenient setting is false,\n    *       by default).\n    *\n+   * Note: The source and destination CASes must be different, and have different\n+   *       base CASs (they cannot be two different views of the same CAS)\n+   *       \n    * @param aSrcCas\n    *          the CAS to copy from.\n    * @param aDestCas\n@@ -100,6 +114,9 @@ public CasCopier(CAS aSrcCas, CAS aDestCas) {\n    * for each source CAS. This version of the constructor supports a \"lenient copy\" option. When set,\n    * the CAS copy function will ignore (not attempt to copy) FSs and features not defined in the type system\n    * of the destination CAS, rather than throwing an exception.\n+   * \n+   * Note: The source and destination CASes must be different, and have different\n+   *       base CASs (they cannot be two different views of the same CAS)\n    *\n    * @param aSrcCas\n    *          the CAS to copy from.\n@@ -109,10 +126,17 @@ public CasCopier(CAS aSrcCas, CAS aDestCas) {\n    *          ignore FSs and features not defined in the type system of the destination CAS\n    */\n   public CasCopier(CAS aSrcCas, CAS aDestCas, boolean lenient) {\n-    mSrcCas = aSrcCas;\n-    mDestCas = aDestCas;\n+    mOriginalSrcCasView = aSrcCas;\n+    mOriginalTgtCasView = aDestCas;\n+    mSrcBaseCas = ((CASImpl)aSrcCas).getBaseCAS();\n+    mDestBaseCas = ((CASImpl)aDestCas).getBaseCAS();\n+    \n     mDestSofaFeature = aDestCas.getTypeSystem().getFeatureByFullName(CAS.FEATURE_FULL_NAME_SOFA);    \n     this.lenient = lenient;\n+    \n+    if (mSrcBaseCas == mDestBaseCas) {\n+      throw new UIMARuntimeException(UIMARuntimeException.ILLEGAL_CAS_COPY_TO_SAME_CAS, null); \n+    }\n   }\n   \n   /**\n@@ -183,11 +207,16 @@ public static void copyCas(CAS aSrcCas, CAS aDestCas, boolean aCopySofa, boolean\n    * Cross-view references may result in creating additional views in the destination CAS;\n    * for these views, any Sofa data in the source is *not* copied.\n    * \n-   * @param aSrcCasView the CAS to copy from\n+   * If the source and destination CASes (as set in the constructor for this class) \n+   * are the same, or are two different views of the same CAS, then\n+   * this method will make a deep copy of all the feature structures in the view,\n+   * duplicating them, and indexing them.\n+   * \n+   * @param aSrcCasView the CAS to copy from.  This must be a view in the src Cas set by the constructor\n    * @param aCopySofa if true, the sofa data and mimeType will be copied. If false they will not.\n    */\n   public void copyCasView(CAS aSrcCasView, boolean aCopySofa) {\n-    copyCasView(aSrcCasView, getOrCreateView(mDestCas, aSrcCasView.getViewName()), aCopySofa);\n+    copyCasView(aSrcCasView, getOrCreateView(mDestBaseCas, aSrcCasView.getViewName()), aCopySofa);\n   }\n   \n   /**\n@@ -201,11 +230,16 @@ public void copyCasView(CAS aSrcCasView, boolean aCopySofa) {\n    * for these views, any Sofa data in the source is *not* copied.  Any views created because\n    * of cross-view references will have the same view name as in the source.\n    * \n+   * If the source and destination CASes (as set in the constructor for this class) \n+   * are the same, or are two different views of the same CAS, then\n+   * this method will make a deep copy of all the feature structures in the view,\n+   * duplicating them, and indexing them.\n+   *\n    * @param aSrcCasViewName the name of the view in the source CAS to copy from\n    * @param aCopySofa if true, the sofa data and mimeType will be copied. If false they will not.\n    */\n   public void copyCasView(String aSrcCasViewName, boolean aCopySofa) {\n-    copyCasView(getOrCreateView(mSrcCas, aSrcCasViewName), aCopySofa);\n+    copyCasView(getOrCreateView(mSrcBaseCas, aSrcCasViewName), aCopySofa);\n   }\n   \n   /**\n@@ -220,12 +254,17 @@ public void copyCasView(String aSrcCasViewName, boolean aCopySofa) {\n    * for these views, any Sofa data in the source is *not* copied.  Any views created because\n    * of cross-view references will have the same view name as in the source.\n    * \n+   * If the source and destination CASes (as set in the constructor for this class) \n+   * are the same, or are two different views of the same CAS, then\n+   * this method will make a deep copy of all the feature structures in the view,\n+   * duplicating them, and indexing them.\n+   * \n    * @param aSrcCasView The view in the source to copy from\n    * @param aTgtCasViewName The name of the view in the destination CAS to copy into\n    * @param aCopySofa if true, the sofa data and mimeType will be copied. If false they will not.\n    */\n   public void copyCasView(CAS aSrcCasView, String aTgtCasViewName, boolean aCopySofa) {\n-    copyCasView(aSrcCasView, getOrCreateView(mDestCas, aTgtCasViewName), aCopySofa);\n+    copyCasView(aSrcCasView, getOrCreateView(mDestBaseCas, aTgtCasViewName), aCopySofa);\n   }\n \n   /**\n@@ -238,41 +277,65 @@ public void copyCasView(CAS aSrcCasView, String aTgtCasViewName, boolean aCopySo\n    * for these views, any Sofa data in the source is *not* copied.  Any views created because\n    * of cross-view references will have the same view name as in the source.\n    * \n+   * If the source and destination CASes (as set in the constructor for this class) \n+   * are the same, or are two different views of the same CAS, then\n+   * this method will make a deep copy of all the feature structures in the view,\n+   * duplicating them, and indexing them.\n+   * \n    * @param aSrcCasViewName The name of the view in the Source CAS to copy from\n    * @param aTgtCasView The view in the destination CAS to copy into\n    * @param aCopySofa if true, the sofa data and mimeType will be copied. If false they will not.\n    */\n   public void copyCasView(String aSrcCasViewName, CAS aTgtCasView, boolean aCopySofa) {\n-    copyCasView(getOrCreateView(mSrcCas, aSrcCasViewName), aTgtCasView, aCopySofa);\n+    copyCasView(getOrCreateView(mSrcBaseCas, aSrcCasViewName), aTgtCasView, aCopySofa);\n   }\n \n   /**\n    * Does a deep copy of the contents of one CAS View into another CAS view,\n    * with a possibly different name.\n+   * \n+   * The CASes must be different (that is, they cannot be 2 views of the same CAS).  \n+   * \n    * All FeatureStructures \n    * (except for those dropped because the target type system doesn't have the needed type) that are indexed \n    * in the source CAS view will become indexed in the target view.\n    * Cross-view references may result in creating additional views in the destination CAS;\n    * for these views, any Sofa data in the source is *not* copied.  Any views created because\n    * of cross-view references will have the same view name as in the source.\n    * \n+   * If called on the same CAS (to copy one view into another one, within one CAS), it will\n+   * create duplicates of the Feature Structures.\n+   * \n    * @param aSrcCasView\n-   *          the CAS to copy from\n+   *          the CAS to copy from. This must be a view of the srcCas set in the constructor\n    * @param aCopySofa\n-   *          if true, the sofa data and mimeType will be copied. If false they will not.\n+   *          if true, the sofa data and mimeType will be copied. If false they will not.  \n+   *          If true and the sofa data is already set in the target, will throw CASRuntimeException        \n    */\n   public void copyCasView(CAS aSrcCasView, CAS aTgtCasView, boolean aCopySofa) {\n-    if (aSrcCasView == aTgtCasView) {\n-      throw new UIMARuntimeException(UIMARuntimeException.ILLEGAL_CAS_COPY_TO_SAME_CAS_SAME_VIEW, null);\n+//    if (aSrcCasView == aTgtCasView) {\n+//      throw new UIMARuntimeException(UIMARuntimeException.ILLEGAL_CAS_COPY_TO_SAME_CAS_SAME_VIEW, null);\n+//    }\n+    \n+//    if (aSrcCasView == ((CASImpl)aSrcCasView).getBaseCAS() ||\n+//        aTgtCasView == ((CASImpl)aTgtCasView).getBaseCAS())\n+//      throw new UIMARuntimeException(UIMARuntimeException.UNSUPPORTED_CAS_COPY_TO_OR_FROM_BASE_CAS, null);\n+    \n+    if (mSrcBaseCas != ((CASImpl)aSrcCasView).getBaseCAS()) {\n+      throw new UIMARuntimeException(UIMARuntimeException.VIEW_NOT_PART_OF_CAS, new Object[] {\"Source\"});\n+    }\n+    if (mDestBaseCas != ((CASImpl)aTgtCasView).getBaseCAS()) {\n+      throw new UIMARuntimeException(UIMARuntimeException.VIEW_NOT_PART_OF_CAS, new Object[] {\"Destination\"});\n     }\n     \n-    mSrcCas = aSrcCasView;\n-    mSrcCasViewName = aSrcCasView.getViewName();\n-       \n-    mDestCas = aTgtCasView;\n+    mSrcCasViewName = aSrcCasView.getViewName(); \n     mTgtCasViewName = aTgtCasView.getViewName();\n-    \n-    mLowLevelDestCas = mDestCas.getLowLevelCAS();\n+\n+    if (null == mSrcCasViewName || null == mTgtCasViewName ) {\n+      throw new UIMARuntimeException(UIMARuntimeException.UNSUPPORTED_CAS_COPY_TO_OR_FROM_BASE_CAS, null);\n+    }\n+        \n+    mLowLevelDestCas = mDestBaseCas.getLowLevelCAS();\n     \n     // The top level sofa associated with this view is copied (or not)\n     \n@@ -300,7 +363,8 @@ public void copyCasView(CAS aSrcCasView, CAS aTgtCasView, boolean aCopySofa) {\n     \n     Set<FeatureStructure> indexedFs = new HashSet<FeatureStructure>();\n     \n-    // We don't clear the map here, in order to skip actually copying the\n+    // The indexFs set starts out \"cleared\", but \n+    // we don't clear the cas copier instance map \"mFsMap\" here, in order to skip actually copying the\n     //   FSs when doing a full CAS copy with multiple views - the 2nd and subsequent\n     //   views don't copy, but they do index.\n     \n@@ -368,15 +432,15 @@ public FeatureStructure copyFs(FeatureStructure aFS) {\n     // note these variables are null if copyFs is called after\n     //   creating an instance of this class\n     if (null == mSrcCasViewName) {\n-      mSrcCasViewName = mSrcCas.getViewName();\n+      mSrcCasViewName = mOriginalSrcCasView.getViewName();  // may set it to null, if Cas is base view\n     }\n     \n     if (null == mTgtCasViewName) {\n-      mTgtCasViewName = mDestCas.getViewName();\n+      mTgtCasViewName = mOriginalTgtCasView.getViewName(); // may set it to null, if Cas is base view\n     }\n     \n     if (null == mLowLevelDestCas) {\n-      mLowLevelDestCas = mDestCas.getLowLevelCAS();\n+      mLowLevelDestCas = mDestBaseCas.getLowLevelCAS();\n     }\n     \n     return copyFs2(aFS);\n@@ -403,7 +467,7 @@ private FeatureStructure copyFs2(FeatureStructure aFS) {\n    */\n   private FeatureStructure copyFsInner(FeatureStructure aFS) {\n     // FS must be in the source CAS\n-    assert ((CASImpl) aFS.getCAS()).getBaseCAS() == ((CASImpl) mSrcCas).getBaseCAS();\n+    assert ((CASImpl) aFS.getCAS()).getBaseCAS() == mSrcBaseCas;\n \n     // check if we already copied this FS\n     FeatureStructure copy = (FeatureStructure) mFsMap.get(aFS);\n@@ -419,7 +483,7 @@ private FeatureStructure copyFsInner(FeatureStructure aFS) {\n     // same Sofa ID in the target CAS. If it does not exist it will be created.\n     if (aFS instanceof SofaFS) {\n       String destSofaId = getDestSofaId(((SofaFS) aFS).getSofaID());\n-      return getOrCreateView(mDestCas, destSofaId).getSofa();\n+      return getOrCreateView(mDestBaseCas, destSofaId).getSofa();\n     }\n \n     // DocumentAnnotation - instead of creating a new instance, reuse the automatically created\n@@ -432,7 +496,7 @@ private FeatureStructure copyFsInner(FeatureStructure aFS) {\n       //   but this is unlikely.  To have this case this would require\n       //   indexing some other feature structure in this view, which, in turn,\n       //   has a reference to the DocumentAnnotation FS belonging to another view\n-      CAS destView = getOrCreateView(mDestCas, destViewName);\n+      CAS destView = getOrCreateView(mDestBaseCas, destViewName);\n       FeatureStructure destDocAnnot = destView.getDocumentAnnotation();\n       if (destDocAnnot != null) {  // Note: is always non-null, getDocumentAnnotation creates if not exist\n         copyFeatures(aFS, destDocAnnot);\n@@ -448,7 +512,7 @@ private FeatureStructure copyFsInner(FeatureStructure aFS) {\n     }\n \n     // create a new FS of the same type in the target CAS\n-    Type destType = (mDestCas.getTypeSystem() == mSrcCas.getTypeSystem()) ? srcType : mDestCas\n+    Type destType = (mDestBaseCas.getTypeSystem() == mSrcBaseCas.getTypeSystem()) ? srcType : mDestBaseCas\n         .getTypeSystem().getType(srcType.getName());\n     if (destType == null) {\n       // If in lenient mode, do not act on this FS. Instead just\n@@ -478,7 +542,7 @@ private FeatureStructure copyFsInner(FeatureStructure aFS) {\n   }\n   \n   private String getDestSofaId(String id) {\n-    return mSrcCasViewName.equals(id) ? mTgtCasViewName : id;\n+    return (null != mSrcCasViewName && mSrcCasViewName.equals(id)) ? mTgtCasViewName : id;\n   }\n   \n   /**\n@@ -556,7 +620,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof StringArrayFS) {\n       StringArrayFS arrayFs = (StringArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      StringArrayFS destFS = mDestCas.createStringArrayFS(len);\n+      StringArrayFS destFS = mDestBaseCas.createStringArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -565,7 +629,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof IntArrayFS) {\n       IntArrayFS arrayFs = (IntArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      IntArrayFS destFS = mDestCas.createIntArrayFS(len);\n+      IntArrayFS destFS = mDestBaseCas.createIntArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -574,7 +638,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof ByteArrayFS) {\n       ByteArrayFS arrayFs = (ByteArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      ByteArrayFS destFS = mDestCas.createByteArrayFS(len);\n+      ByteArrayFS destFS = mDestBaseCas.createByteArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -583,7 +647,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof ShortArrayFS) {\n       ShortArrayFS arrayFs = (ShortArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      ShortArrayFS destFS = mDestCas.createShortArrayFS(len);\n+      ShortArrayFS destFS = mDestBaseCas.createShortArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -592,7 +656,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof LongArrayFS) {\n       LongArrayFS arrayFs = (LongArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      LongArrayFS destFS = mDestCas.createLongArrayFS(len);\n+      LongArrayFS destFS = mDestBaseCas.createLongArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -601,7 +665,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof FloatArrayFS) {\n       FloatArrayFS arrayFs = (FloatArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      FloatArrayFS destFS = mDestCas.createFloatArrayFS(len);\n+      FloatArrayFS destFS = mDestBaseCas.createFloatArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -610,7 +674,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof DoubleArrayFS) {\n       DoubleArrayFS arrayFs = (DoubleArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      DoubleArrayFS destFS = mDestCas.createDoubleArrayFS(len);\n+      DoubleArrayFS destFS = mDestBaseCas.createDoubleArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -619,7 +683,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof BooleanArrayFS) {\n       BooleanArrayFS arrayFs = (BooleanArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      BooleanArrayFS destFS = mDestCas.createBooleanArrayFS(len);\n+      BooleanArrayFS destFS = mDestBaseCas.createBooleanArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         destFS.set(i, arrayFs.get(i));\n       }\n@@ -628,7 +692,7 @@ private FeatureStructure copyArray(FeatureStructure aSrcFs) {\n     if (aSrcFs instanceof ArrayFS) {\n       ArrayFS arrayFs = (ArrayFS) aSrcFs;\n       int len = arrayFs.size();\n-      ArrayFS destFS = mDestCas.createArrayFS(len);\n+      ArrayFS destFS = mDestBaseCas.createArrayFS(len);\n       for (int i = 0; i < len; i++) {\n         FeatureStructure srcElem = arrayFs.get(i);\n         if (srcElem != null) {",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/java/org/apache/uima/util/CasCopier.java",
                "sha": "1042065a708013394430169df05c4c1533513d06",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/resources/org/apache/uima/UIMAException_Messages.properties",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/resources/org/apache/uima/UIMAException_Messages.properties?ref=cf9d5c9b007f9c377ce244d5e155d0971b048bc0",
                "deletions": 4,
                "filename": "uimaj-core/src/main/resources/org/apache/uima/UIMAException_Messages.properties",
                "patch": "@@ -39,8 +39,6 @@ define_cas_pool_called_twice = The method CasManager.defineCasPool() was called\n        \n unsupported_cas_interface = Unsupported CAS interface {0}.\n \n-illegal_copy_same_cas_same_view = CAS Copying of the same view to the same CAS with the same view name is not allowed.\n-\n type_not_found_during_cas_copy = Attempted to copy a FeatureStructure of type \"{0}\", which is not defined in the type system of the destination CAS.\n \n feature_not_found_during_cas_copy = Attempted to copy a Feature \"{0}\", which is not defined in the type system of the destination CAS.\n@@ -49,6 +47,12 @@ uima_context_null = Saved UIMA context is null; probable cause: Annotator''s ini\n \n result_spec_null = Saved result specification is null; probable cause: Annotator overrode setResultSpecification(spec) but failed to call super.setResultSpecification(spec).\n \n+view_not_part_of_cas = In CasCopier, the {0} view is doesn''t belong to the original {0} CAS specified when creating the CasCopier instance.\n+\n+illegal_cas_copy_to_same_cas = It is not permitted to use CasCopier to copy a Cas to itself, even in another view.\n+\n+unsupported_cas_copy_view_base_cas = Unsupported invocation of CasCopier copyCasView, specifying a source or destination as a base CAS.\n+\n #--------------------------\n #UIMA_IllegalStateException\n #--------------------------          \n@@ -199,7 +203,7 @@ remove_ae_from_flow_not_supported = The FlowController class {0} does not suppor\n  Analysis Engines cannot be dynamically removed from the flow.\n  \n flow_cannot_continue_after_remove = The Analysis Engine(s) {0} have been removed from the flow, and the FlowController \\\n-  has determined that the Aggregate Analysis Engine's processing can no longer continue.\n+  has determined that the Aggregate Analysis Engine''s processing can no longer continue.\n  \n  \n #-------------------------------\n@@ -393,7 +397,7 @@ sofa_mapping_not_supported_for_remote = Sofa mappings were specified for the rem\n undefined_key_in_flow = The descriptor for Aggregate Analysis Engine \"{0}\" specified an invalid flow.  The key \"{1}\" was used in the flow \\\n   but is not defined as a key in the <delegateAnalysisEngineSpecifiers> element of the descriptor. (Descriptor: {2})\n \n-invalid_action_after_cas_multiplier = The value \"{0}\" is an invalid value for the FixedFlowController's \"ActionAfterCasMultiplier\" configuration \\\n+invalid_action_after_cas_multiplier = The value \"{0}\" is an invalid value for the FixedFlowController''s \"ActionAfterCasMultiplier\" configuration \\\n   parameter.  Valid values are \"continue\", \"stop\", \"drop\", and \"dropIfNewCasProduced\".\n     \n flow_controller_requires_flow_constraints = The Flow Controller \"{0}\" requires a flow contraints element of type \"{1}\" in the aggregate descriptor. \\",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/main/resources/org/apache/uima/UIMAException_Messages.properties",
                "sha": "f11de20d6ade1a5fb387b597a62c93b3967e5790",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/test/java/org/apache/uima/util/CasCopierTest.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/test/java/org/apache/uima/util/CasCopierTest.java?ref=cf9d5c9b007f9c377ce244d5e155d0971b048bc0",
                "deletions": 0,
                "filename": "uimaj-core/src/test/java/org/apache/uima/util/CasCopierTest.java",
                "patch": "@@ -27,6 +27,7 @@\n import junit.framework.TestCase;\n \n import org.apache.uima.UIMAFramework;\n+import org.apache.uima.UIMARuntimeException;\n import org.apache.uima.cas.ArrayFS;\n import org.apache.uima.cas.CAS;\n import org.apache.uima.cas.FeatureStructure;\n@@ -97,6 +98,15 @@ public void testCopyCas() throws Exception {\n     CAS destCasBase = ((CASImpl) destCas).getBaseCAS();\n     CasCopier.copyCas(srcCasBase, destCasBase, true);\n     CasComparer.assertEquals(srcCasBase, destCasBase);\n+    \n+    //try with source and dest cas the same\n+    Exception ee = null;\n+    try {\n+      CasCopier.copyCas(srcCasBase,  srcCasBase, false);\n+    } catch (Exception e) {\n+      ee = e;\n+    }\n+    assertTrue(ee instanceof UIMARuntimeException);\n   }\n   \n   public void testCopyCasWithDifferentTypeSystemObject() throws Exception {\n@@ -209,6 +219,17 @@ public void testCopyFs() throws Exception {\n     arrFS.set(2, relFS);\n     FeatureStructure copyArrFS = copier.copyFs(arrFS);\n     CasComparer.assertEquals(arrFS, copyArrFS);\n+    \n+    // test with using base cas\n+    destCas = CasCreationUtils.createCas(typeSystem, new TypePriorities_impl(), indexes);\n+    destCas.setDocumentText(srcCas.getDocumentText());\n+    copier = new CasCopier(((CASImpl)srcCas).getBaseCAS(), ((CASImpl)destCas).getBaseCAS());\n+\n+    annotIter = srcCas.getAnnotationIndex().iterator();\n+    annot = (FeatureStructure) annotIter.next();\n+    copy = copier.copyFs(annot);\n+    // verify copy\n+    CasComparer.assertEquals(annot, copy);\n   }\n \n   public void testAnnotationWithNullSofaRef() throws Exception {",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/cf9d5c9b007f9c377ce244d5e155d0971b048bc0/uimaj-core/src/test/java/org/apache/uima/util/CasCopierTest.java",
                "sha": "671390ed3a82f41264de4ef4214f43fa2bad1087",
                "status": "modified"
            }
        ],
        "message": "[UIMA-2409] fixed NPE, and also clarified that source/dest CASes must be different; added checks, add test cases.\n\ngit-svn-id: https://svn.apache.org/repos/asf/uima/uimaj/trunk@1504178 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/a5b532c5c2e4408a7150426b275f0173b175d4bb",
        "patched_files": [
            "UIMAException_Messages.properties",
            "UIMARuntimeException.java",
            "CasCopier.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "CasCopierTest.java"
        ]
    },
    "uima-uimaj_d1ef364": {
        "bug_id": "uima-uimaj_d1ef364",
        "commit": "https://github.com/apache/uima-uimaj/commit/d1ef364a3464835ba233e8ada7bf7e9ebe4f03a6",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/uima-uimaj/blob/d1ef364a3464835ba233e8ada7bf7e9ebe4f03a6/uimaj-core/src/main/java/org/apache/uima/resource/metadata/impl/MetaDataObject_impl.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/uima-uimaj/contents/uimaj-core/src/main/java/org/apache/uima/resource/metadata/impl/MetaDataObject_impl.java?ref=d1ef364a3464835ba233e8ada7bf7e9ebe4f03a6",
                "deletions": 1,
                "filename": "uimaj-core/src/main/java/org/apache/uima/resource/metadata/impl/MetaDataObject_impl.java",
                "patch": "@@ -245,7 +245,7 @@ private void getAttributesFromBeans(final Class<? extends MetaDataObject_impl> c\n         String propName = pd.getName();\n         Class<?> propClass = pd.getPropertyType();\n         // translate primitive types (int, boolean, etc.) to wrapper classes\n-        if (propClass.isPrimitive()) {\n+        if (null != propClass && propClass.isPrimitive()) {\n           propClass = getWrapperClass(propClass);\n         }\n         MetaDataAttr mda = new MetaDataAttr(propName, pd.getReadMethod(), pd.getWriteMethod(), propClass);",
                "raw_url": "https://github.com/apache/uima-uimaj/raw/d1ef364a3464835ba233e8ada7bf7e9ebe4f03a6/uimaj-core/src/main/java/org/apache/uima/resource/metadata/impl/MetaDataObject_impl.java",
                "sha": "954a379603aa65b552a782a5e874aa440133ba21",
                "status": "modified"
            }
        ],
        "message": "[UIMA-3776] fix failing test cases which get a NPE trying to get the class info from the Java Bean when the only getter is an array getter (shows up in CPE tests)\n\ngit-svn-id: https://svn.apache.org/repos/asf/uima/uimaj/trunk@1590115 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/uima-uimaj/commit/1f5a3549ccb2312759e875ec531f279817d6a872",
        "patched_files": [
            "MetaDataObject_impl.java"
        ],
        "repo": "uima-uimaj",
        "unit_tests": [
            "MetaDataObject_implTest.java"
        ]
    }
}