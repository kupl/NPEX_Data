[
    {
        "repo": "santuario-java",
        "commit": "https://github.com/apache/santuario-java/commit/11e5627cd603b679846838dda4b109baa7244b3c",
        "bug_id": "santuario-java_11e5627",
        "message": "DOMKeyInfo.marshal should throw NPE when parent is null per KeyInfo.marshal API spec.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1485370 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/santuario-java/commit/7b15b6156011f16d25d02d7aca2cb928811048a6",
        "patched_files": [
            "KeyInfo.java",
            "DOMKeyInfo.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 4,
                "raw_url": "https://github.com/apache/santuario-java/raw/11e5627cd603b679846838dda4b109baa7244b3c/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java?ref=11e5627cd603b679846838dda4b109baa7244b3c",
                "filename": "src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "deletions": 1,
                "sha": "e1e312cdfb7be8006860f46210909454b9060ce0",
                "blob_url": "https://github.com/apache/santuario-java/blob/11e5627cd603b679846838dda4b109baa7244b3c/src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java",
                "patch": "@@ -144,7 +144,10 @@ public String getId() {\n     public void marshal(XMLStructure parent, XMLCryptoContext context)\n         throws MarshalException\n     {\n-        if (parent == null || !(parent instanceof javax.xml.crypto.dom.DOMStructure)) {\n+        if (parent == null) {\n+            throw new NullPointerException(\"parent is null\");\n+        }\n+        if (!(parent instanceof javax.xml.crypto.dom.DOMStructure)) {\n             throw new ClassCastException(\"parent must be of type DOMStructure\");\n         }\n ",
                "changes": 5
            },
            {
                "status": "modified",
                "additions": 2,
                "raw_url": "https://github.com/apache/santuario-java/raw/11e5627cd603b679846838dda4b109baa7244b3c/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "contents_url": "https://api.github.com/repos/apache/santuario-java/contents/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java?ref=11e5627cd603b679846838dda4b109baa7244b3c",
                "filename": "src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "deletions": 2,
                "sha": "ee023934ee7656955011bb44db6c6de463e94c3f",
                "blob_url": "https://github.com/apache/santuario-java/blob/11e5627cd603b679846838dda4b109baa7244b3c/src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
                "patch": "@@ -115,8 +115,8 @@ public void testMarshal() throws Exception {\n             (Collections.singletonList(fac.newKeyName(\"foo\")), \"keyid\");\n         try {\n             ki.marshal(null, null);\n-            fail(\"Should raise a ClassCastException\");\n-        } catch (ClassCastException npe) {}\n+            fail(\"Should raise a NullPointerException\");\n+        } catch (NullPointerException npe) {}\n \n         DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n         dbf.setNamespaceAware(true);",
                "changes": 4
            }
        ],
        "unit_tests": [
            "KeyInfoTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/javax/xml/crypto/test/dsig/keyinfo/KeyInfoTest.java",
        "buggy_files": [
            "src/main/java/org/apache/xml/security/keys/KeyInfo.java",
            "src/main/java/javax/xml/crypto/dsig/keyinfo/KeyInfo.java",
            "src/main/java/org/apache/jcp/xml/dsig/internal/dom/DOMKeyInfo.java"
        ],
        "fixed": true
    }
]