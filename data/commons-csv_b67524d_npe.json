[
    {
        "repo": "commons-csv",
        "commit": "https://github.com/apache/commons-csv/commit/b67524da7fd146634c7112b23e95d1d45c398b82",
        "bug_id": "commons-csv_b67524d",
        "message": "CSV-122: NullPointerException when empty header string and and null string of \"\". Thanks to Mike Lewis.\n\ngit-svn-id: https://svn.apache.org/repos/asf/commons/proper/csv/trunk@1609768 13f79535-47bb-0310-9956-ffa450edef68",
        "parent": "https://github.com/apache/commons-csv/commit/d3afa156e4ddf8ec76847504988e7979146d9fd6",
        "patched_files": [
            "changes.xml",
            "CSVParser.java"
        ],
        "file": [
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-csv/raw/b67524da7fd146634c7112b23e95d1d45c398b82/src/changes/changes.xml",
                "contents_url": "https://api.github.com/repos/apache/commons-csv/contents/src/changes/changes.xml?ref=b67524da7fd146634c7112b23e95d1d45c398b82",
                "filename": "src/changes/changes.xml",
                "deletions": 0,
                "sha": "26ad32f349d7a87d4d316fc9fa760d34b9387eb5",
                "blob_url": "https://github.com/apache/commons-csv/blob/b67524da7fd146634c7112b23e95d1d45c398b82/src/changes/changes.xml",
                "patch": "@@ -40,6 +40,7 @@\n   <body>\n \n     <release version=\"1.0\" date=\"TBD\" description=\"First release\">    \n+      <action issue=\"CSV-122\" type=\"fix\" dev=\"britter\" due-to=\"Mike Lewis\">NullPointerException when empty header string and and null string of \"\"</action>\n       <action issue=\"CSV-117\" type=\"update\" dev=\"sebb\">Validate format parameters in constructor</action>\n       <action issue=\"CSV-121\" type=\"add\" dev=\"ggregory\" due-to=\"Sebastian Hardt\">IllegalArgumentException thrown when the header contains duplicate names when the column names are empty.</action>\n       <action issue=\"CSV-120\" type=\"add\" dev=\"ggregory\" due-to=\"Sergei Lebedev\">CSVFormat#withHeader doesn't work with CSVPrinter</action>",
                "changes": 1
            },
            {
                "status": "modified",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-csv/raw/b67524da7fd146634c7112b23e95d1d45c398b82/src/main/java/org/apache/commons/csv/CSVParser.java",
                "contents_url": "https://api.github.com/repos/apache/commons-csv/contents/src/main/java/org/apache/commons/csv/CSVParser.java?ref=b67524da7fd146634c7112b23e95d1d45c398b82",
                "filename": "src/main/java/org/apache/commons/csv/CSVParser.java",
                "deletions": 1,
                "sha": "b7ca3fa9c0199a0daed3651272932b0e8a6d6f7e",
                "blob_url": "https://github.com/apache/commons-csv/blob/b67524da7fd146634c7112b23e95d1d45c398b82/src/main/java/org/apache/commons/csv/CSVParser.java",
                "patch": "@@ -381,7 +381,7 @@ public long getRecordNumber() {\n                 for (int i = 0; i < headerRecord.length; i++) {\n                     final String header = headerRecord[i];\n                     final boolean containsHeader = hdrMap.containsKey(header);\n-                    final boolean emptyHeader = header.trim().isEmpty();\n+                    final boolean emptyHeader = header == null || header.trim().isEmpty();\n                     if (containsHeader && (!emptyHeader || (emptyHeader && !this.format.getIgnoreEmptyHeaders()))) {\n                         throw new IllegalArgumentException(\"The header contains a duplicate name: \\\"\" + header +\n                                 \"\\\" in \" + Arrays.toString(headerRecord));",
                "changes": 2
            },
            {
                "status": "modified",
                "additions": 6,
                "raw_url": "https://github.com/apache/commons-csv/raw/b67524da7fd146634c7112b23e95d1d45c398b82/src/test/java/org/apache/commons/csv/CSVParserTest.java",
                "contents_url": "https://api.github.com/repos/apache/commons-csv/contents/src/test/java/org/apache/commons/csv/CSVParserTest.java?ref=b67524da7fd146634c7112b23e95d1d45c398b82",
                "filename": "src/test/java/org/apache/commons/csv/CSVParserTest.java",
                "deletions": 0,
                "sha": "f5b6cb8636edcb6e376b54b261a1745fef9b5bd4",
                "blob_url": "https://github.com/apache/commons-csv/blob/b67524da7fd146634c7112b23e95d1d45c398b82/src/test/java/org/apache/commons/csv/CSVParserTest.java",
                "patch": "@@ -661,6 +661,12 @@ public void testHeadersMissing() throws Exception {\n         CSVFormat.DEFAULT.withHeader().withIgnoreEmptyHeaders(true).parse(in).iterator();\n     }\n \n+    @Test\n+    public void testHeaderMissingWithNull() throws Exception {\n+        final Reader in = new StringReader(\"a,,c,,d\\n1,2,3,4\\nx,y,z,zz\");\n+        CSVFormat.DEFAULT.withHeader().withNullString(\"\").withIgnoreEmptyHeaders(true).parse(in).iterator();\n+    }\n+\n     @Test\n     public void testHeaderComment() throws Exception {\n         final Reader in = new StringReader(\"# comment\\na,b,c\\n1,2,3\\nx,y,z\");",
                "changes": 6
            }
        ],
        "unit_tests": [
            "CSVParserTest.java"
        ]
    },
    {
        "buggy": false,
        "test_file": "src/test/java/org/apache/commons/csv/CSVParserTest.java",
        "buggy_files": [
            "src/changes/changes.xml",
            "src/main/java/org/apache/commons/csv/CSVParser.java"
        ],
        "fixed": true
    }
]