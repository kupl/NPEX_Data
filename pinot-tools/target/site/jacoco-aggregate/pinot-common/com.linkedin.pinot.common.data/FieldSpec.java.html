<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>FieldSpec.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">pinot-tools</a> &gt; <a href="../index.html" class="el_bundle">pinot-common</a> &gt; <a href="index.source.html" class="el_package">com.linkedin.pinot.common.data</a> &gt; <span class="el_source">FieldSpec.java</span></div><h1>FieldSpec.java</h1><pre class="source lang-java linenums">/**
 * Copyright (C) 2014-2016 LinkedIn Corp. (pinot-core@linkedin.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.linkedin.pinot.common.data;

import com.google.gson.JsonArray;
import com.google.gson.JsonObject;
import com.google.gson.JsonPrimitive;
import com.linkedin.pinot.common.utils.DataSchema;
import com.linkedin.pinot.common.utils.EqualityUtils;
import javax.annotation.Nonnull;
import org.apache.avro.Schema.Type;


/**
 * The &lt;code&gt;FieldSpec&lt;/code&gt; class contains all specs related to any field (column) in {@link Schema}.
 * &lt;p&gt;There are 3 types of &lt;code&gt;FieldSpec&lt;/code&gt;:
 * {@link DimensionFieldSpec}, {@link MetricFieldSpec}, {@link TimeFieldSpec}
 * &lt;p&gt;Specs stored are as followings:
 * &lt;p&gt;- &lt;code&gt;Name&lt;/code&gt;: name of the field.
 * &lt;p&gt;- &lt;code&gt;DataType&lt;/code&gt;: type of the data stored (e.g. INTEGER, LONG, FLOAT, DOUBLE, STRING).
 * &lt;p&gt;- &lt;code&gt;IsSingleValueField&lt;/code&gt;: single-value or multi-value field.
 * &lt;p&gt;- &lt;code&gt;DefaultNullValue&lt;/code&gt;: when no value found for this field, use this value. Stored in string format.
 */
@SuppressWarnings(&quot;unused&quot;)
public abstract class FieldSpec {
<span class="fc" id="L39">  private static final Integer DEFAULT_DIMENSION_NULL_VALUE_OF_INT = Integer.MIN_VALUE;</span>
<span class="fc" id="L40">  private static final Long DEFAULT_DIMENSION_NULL_VALUE_OF_LONG = Long.MIN_VALUE;</span>
<span class="fc" id="L41">  private static final Float DEFAULT_DIMENSION_NULL_VALUE_OF_FLOAT = Float.NEGATIVE_INFINITY;</span>
<span class="fc" id="L42">  private static final Double DEFAULT_DIMENSION_NULL_VALUE_OF_DOUBLE = Double.NEGATIVE_INFINITY;</span>
  private static final String DEFAULT_DIMENSION_NULL_VALUE_OF_STRING = &quot;null&quot;;

<span class="fc" id="L45">  private static final Integer DEFAULT_METRIC_NULL_VALUE_OF_INT = 0;</span>
<span class="fc" id="L46">  private static final Long DEFAULT_METRIC_NULL_VALUE_OF_LONG = 0L;</span>
<span class="fc" id="L47">  private static final Float DEFAULT_METRIC_NULL_VALUE_OF_FLOAT = 0.0F;</span>
<span class="fc" id="L48">  private static final Double DEFAULT_METRIC_NULL_VALUE_OF_DOUBLE = 0.0D;</span>
  private static final String DEFAULT_METRIC_NULL_VALUE_OF_STRING = &quot;null&quot;;

  protected String _name;
  protected DataType _dataType;
<span class="fc" id="L53">  protected boolean _isSingleValueField = true;</span>
  protected Object _defaultNullValue;

  private transient String _stringDefaultNullValue;

  // Default constructor required by JSON de-serializer. DO NOT REMOVE.
<span class="fc" id="L59">  public FieldSpec() {</span>
<span class="fc" id="L60">  }</span>

<span class="fc" id="L62">  public FieldSpec(@Nonnull String name, @Nonnull DataType dataType, boolean isSingleValueField) {</span>
<span class="fc" id="L63">    _name = name;</span>
<span class="fc" id="L64">    _dataType = dataType.getStoredType();</span>
<span class="fc" id="L65">    _isSingleValueField = isSingleValueField;</span>
<span class="fc" id="L66">    _defaultNullValue = getDefaultNullValue(getFieldType(), _dataType, null);</span>
<span class="fc" id="L67">  }</span>

  public FieldSpec(@Nonnull String name, @Nonnull DataType dataType, boolean isSingleValueField,
<span class="fc" id="L70">      @Nonnull Object defaultNullValue) {</span>
<span class="fc" id="L71">    _name = name;</span>
<span class="fc" id="L72">    _dataType = dataType.getStoredType();</span>
<span class="fc" id="L73">    _isSingleValueField = isSingleValueField;</span>
<span class="fc" id="L74">    _stringDefaultNullValue = defaultNullValue.toString();</span>
<span class="fc" id="L75">    _defaultNullValue = getDefaultNullValue(getFieldType(), _dataType, _stringDefaultNullValue);</span>
<span class="fc" id="L76">  }</span>

  @Nonnull
  public abstract FieldType getFieldType();

  @Nonnull
  public String getName() {
<span class="fc" id="L83">    return _name;</span>
  }

  // Required by JSON de-serializer. DO NOT REMOVE.
  public void setName(@Nonnull String name) {
<span class="fc" id="L88">    _name = name;</span>
<span class="fc" id="L89">  }</span>

  @Nonnull
  public DataType getDataType() {
<span class="fc" id="L93">    return _dataType;</span>
  }

  // Required by JSON de-serializer. DO NOT REMOVE.
  public void setDataType(@Nonnull DataType dataType) {
<span class="fc" id="L98">    _dataType = dataType.getStoredType();</span>
<span class="fc" id="L99">    _defaultNullValue = getDefaultNullValue(getFieldType(), _dataType, _stringDefaultNullValue);</span>
<span class="fc" id="L100">  }</span>

  public boolean isSingleValueField() {
<span class="fc" id="L103">    return _isSingleValueField;</span>
  }

  // Required by JSON de-serializer. DO NOT REMOVE.
  public void setSingleValueField(boolean isSingleValueField) {
<span class="fc" id="L108">    _isSingleValueField = isSingleValueField;</span>
<span class="fc" id="L109">  }</span>

  @Nonnull
  public Object getDefaultNullValue() {
<span class="fc" id="L113">    return _defaultNullValue;</span>
  }

  // Required by JSON de-serializer. DO NOT REMOVE.
  public void setDefaultNullValue(@Nonnull Object defaultNullValue) {
<span class="fc" id="L118">    _stringDefaultNullValue = defaultNullValue.toString();</span>
<span class="fc bfc" id="L119" title="All 2 branches covered.">    if (_dataType != null) {</span>
<span class="fc" id="L120">      _defaultNullValue = getDefaultNullValue(getFieldType(), _dataType, _stringDefaultNullValue);</span>
    }
<span class="fc" id="L122">  }</span>

  private static Object getDefaultNullValue(@Nonnull FieldType fieldType, @Nonnull DataType dataType,
      String stringDefaultNullValue) {
<span class="fc bfc" id="L126" title="All 2 branches covered.">    if (stringDefaultNullValue != null) {</span>
<span class="pc bpc" id="L127" title="1 of 6 branches missed.">      switch (dataType) {</span>
        case INT:
<span class="fc" id="L129">          return Integer.valueOf(stringDefaultNullValue);</span>
        case LONG:
<span class="fc" id="L131">          return Long.valueOf(stringDefaultNullValue);</span>
        case FLOAT:
<span class="fc" id="L133">          return Float.valueOf(stringDefaultNullValue);</span>
        case DOUBLE:
<span class="fc" id="L135">          return Double.valueOf(stringDefaultNullValue);</span>
        case STRING:
<span class="fc" id="L137">          return stringDefaultNullValue;</span>
        default:
<span class="nc" id="L139">          throw new UnsupportedOperationException(&quot;Unsupported data type: &quot; + dataType);</span>
      }
    } else {
<span class="pc bpc" id="L142" title="1 of 3 branches missed.">      switch (fieldType) {</span>
        case METRIC:
<span class="pc bpc" id="L144" title="1 of 6 branches missed.">          switch (dataType) {</span>
            case INT:
<span class="fc" id="L146">              return DEFAULT_METRIC_NULL_VALUE_OF_INT;</span>
            case LONG:
<span class="fc" id="L148">              return DEFAULT_METRIC_NULL_VALUE_OF_LONG;</span>
            case FLOAT:
<span class="fc" id="L150">              return DEFAULT_METRIC_NULL_VALUE_OF_FLOAT;</span>
            case DOUBLE:
<span class="fc" id="L152">              return DEFAULT_METRIC_NULL_VALUE_OF_DOUBLE;</span>
            case STRING:
<span class="fc" id="L154">              return DEFAULT_METRIC_NULL_VALUE_OF_STRING;</span>
            default:
<span class="nc" id="L156">              throw new UnsupportedOperationException(</span>
                  &quot;Unknown default null value for metric field of data type: &quot; + dataType);
          }
        case DIMENSION:
        case TIME:
        case DATE_TIME:
<span class="pc bpc" id="L162" title="1 of 6 branches missed.">          switch (dataType) {</span>
            case INT:
<span class="fc" id="L164">              return DEFAULT_DIMENSION_NULL_VALUE_OF_INT;</span>
            case LONG:
<span class="fc" id="L166">              return DEFAULT_DIMENSION_NULL_VALUE_OF_LONG;</span>
            case FLOAT:
<span class="fc" id="L168">              return DEFAULT_DIMENSION_NULL_VALUE_OF_FLOAT;</span>
            case DOUBLE:
<span class="fc" id="L170">              return DEFAULT_DIMENSION_NULL_VALUE_OF_DOUBLE;</span>
            case STRING:
<span class="fc" id="L172">              return DEFAULT_DIMENSION_NULL_VALUE_OF_STRING;</span>
            default:
<span class="nc" id="L174">              throw new UnsupportedOperationException(</span>
                  &quot;Unknown default null value for dimension/time field of data type: &quot; + dataType);
          }
        default:
<span class="nc" id="L178">          throw new UnsupportedOperationException(&quot;Unsupported field type: &quot; + fieldType);</span>
      }
    }
  }

  /**
   * Returns the {@link JsonObject} representing the field spec.
   * &lt;p&gt;Only contains fields with non-default value.
   * &lt;p&gt;NOTE: here we use {@link JsonObject} to preserve the insertion order.
   */
  @Nonnull
  public JsonObject toJsonObject() {
<span class="fc" id="L190">    JsonObject jsonObject = new JsonObject();</span>
<span class="fc" id="L191">    jsonObject.addProperty(&quot;name&quot;, _name);</span>
<span class="fc" id="L192">    jsonObject.addProperty(&quot;dataType&quot;, _dataType.name());</span>
<span class="fc bfc" id="L193" title="All 2 branches covered.">    if (!_isSingleValueField) {</span>
<span class="fc" id="L194">      jsonObject.addProperty(&quot;singleValueField&quot;, false);</span>
    }
<span class="fc" id="L196">    appendDefaultNullValue(jsonObject);</span>
<span class="fc" id="L197">    return jsonObject;</span>
  }

  protected void appendDefaultNullValue(@Nonnull JsonObject jsonObject) {
<span class="fc bfc" id="L201" title="All 2 branches covered.">    if (!_defaultNullValue.equals(getDefaultNullValue(getFieldType(), _dataType, null))) {</span>
<span class="fc bfc" id="L202" title="All 2 branches covered.">      if (_defaultNullValue instanceof Number) {</span>
<span class="fc" id="L203">        jsonObject.add(&quot;defaultNullValue&quot;, new JsonPrimitive((Number) _defaultNullValue));</span>
      } else {
<span class="fc" id="L205">        jsonObject.addProperty(&quot;defaultNullValue&quot;, _defaultNullValue.toString());</span>
      }
    }
<span class="fc" id="L208">  }</span>

  @Nonnull
  public JsonObject toAvroSchemaJsonObject() {
<span class="nc" id="L212">    JsonObject jsonSchema = new JsonObject();</span>
<span class="nc" id="L213">    jsonSchema.addProperty(&quot;name&quot;, _name);</span>
<span class="nc bnc" id="L214" title="All 6 branches missed.">    switch (_dataType) {</span>
      case INT:
<span class="nc" id="L216">        jsonSchema.add(&quot;type&quot;, convertStringsToJsonArray(&quot;null&quot;, &quot;int&quot;));</span>
<span class="nc" id="L217">        return jsonSchema;</span>
      case LONG:
<span class="nc" id="L219">        jsonSchema.add(&quot;type&quot;, convertStringsToJsonArray(&quot;null&quot;, &quot;long&quot;));</span>
<span class="nc" id="L220">        return jsonSchema;</span>
      case FLOAT:
<span class="nc" id="L222">        jsonSchema.add(&quot;type&quot;, convertStringsToJsonArray(&quot;null&quot;, &quot;float&quot;));</span>
<span class="nc" id="L223">        return jsonSchema;</span>
      case DOUBLE:
<span class="nc" id="L225">        jsonSchema.add(&quot;type&quot;, convertStringsToJsonArray(&quot;null&quot;, &quot;double&quot;));</span>
<span class="nc" id="L226">        return jsonSchema;</span>
      case STRING:
<span class="nc" id="L228">        jsonSchema.add(&quot;type&quot;, convertStringsToJsonArray(&quot;null&quot;, &quot;string&quot;));</span>
<span class="nc" id="L229">        return jsonSchema;</span>
      default:
<span class="nc" id="L231">        throw new UnsupportedOperationException();</span>
    }
  }

  private static JsonArray convertStringsToJsonArray(String... strings) {
<span class="nc" id="L236">    JsonArray jsonArray = new JsonArray();</span>
<span class="nc bnc" id="L237" title="All 2 branches missed.">    for (String string : strings) {</span>
<span class="nc" id="L238">      jsonArray.add(new JsonPrimitive(string));</span>
    }
<span class="nc" id="L240">    return jsonArray;</span>
  }

  @SuppressWarnings(&quot;EqualsWhichDoesntCheckParameterClass&quot;)
  @Override
  public boolean equals(Object o) {
<span class="fc bfc" id="L246" title="All 2 branches covered.">    if (EqualityUtils.isSameReference(this, o)) {</span>
<span class="fc" id="L247">      return true;</span>
    }

<span class="fc bfc" id="L250" title="All 2 branches covered.">    if (EqualityUtils.isNullOrNotSameClass(this, o)) {</span>
<span class="fc" id="L251">      return false;</span>
    }

<span class="fc" id="L254">    FieldSpec that = (FieldSpec) o;</span>
<span class="fc bfc" id="L255" title="All 8 branches covered.">    return EqualityUtils.isEqual(_name, that._name) &amp;&amp; EqualityUtils.isEqual(_dataType, that._dataType) &amp;&amp; EqualityUtils</span>
        .isEqual(_isSingleValueField, that._isSingleValueField) &amp;&amp; EqualityUtils.isEqual(_defaultNullValue,
        that._defaultNullValue);
  }

  @Override
  public int hashCode() {
<span class="fc" id="L262">    int result = EqualityUtils.hashCodeOf(_name);</span>
<span class="fc" id="L263">    result = EqualityUtils.hashCodeOf(result, _dataType);</span>
<span class="fc" id="L264">    result = EqualityUtils.hashCodeOf(result, _isSingleValueField);</span>
<span class="fc" id="L265">    result = EqualityUtils.hashCodeOf(result, _defaultNullValue);</span>
<span class="fc" id="L266">    return result;</span>
  }

  /**
   * The &lt;code&gt;FieldType&lt;/code&gt; enum is used to demonstrate the real world business logic for a column.
   * &lt;p&gt;&lt;code&gt;DIMENSION&lt;/code&gt;: columns used to filter records.
   * &lt;p&gt;&lt;code&gt;METRIC&lt;/code&gt;: columns used to apply aggregation on. &lt;code&gt;METRIC&lt;/code&gt; field only contains numeric data.
   * &lt;p&gt;&lt;code&gt;TIME&lt;/code&gt;: time column (at most one per {@link Schema}). &lt;code&gt;TIME&lt;/code&gt; field can be used to prune
   * &lt;p&gt;&lt;code&gt;DATE_TIME&lt;/code&gt;: time column (at most one per {@link Schema}). &lt;code&gt;TIME&lt;/code&gt; field can be used to prune
   * segments, otherwise treated the same as &lt;code&gt;DIMENSION&lt;/code&gt; field.
   */
<span class="fc" id="L277">  public enum FieldType {</span>
<span class="fc" id="L278">    DIMENSION,</span>
<span class="fc" id="L279">    METRIC,</span>
<span class="fc" id="L280">    TIME,</span>
<span class="fc" id="L281">    DATE_TIME</span>
  }

  /**
   * The &lt;code&gt;DataType&lt;/code&gt; enum is used to demonstrate the data type of a column.
   * &lt;p&gt;Array &lt;code&gt;DataType&lt;/code&gt; is only used in {@link DataSchema}.
   * &lt;p&gt;In {@link Schema}, use non-array &lt;code&gt;DataType&lt;/code&gt; only.
   * &lt;p&gt;In pinot, we store data using 5 &lt;code&gt;DataType&lt;/code&gt;s: INT, LONG, FLOAT, DOUBLE, STRING. All other
   * &lt;code&gt;DataType&lt;/code&gt;s will be converted to one of them.
   */
<span class="fc" id="L291">  public enum DataType {</span>
<span class="fc" id="L292">    BOOLEAN,      // Stored as STRING.</span>
<span class="fc" id="L293">    BYTE,         // Stored as INT.</span>
<span class="fc" id="L294">    CHAR,         // Stored as STRING.</span>
<span class="fc" id="L295">    SHORT,        // Stored as INT.</span>
<span class="fc" id="L296">    INT,</span>
<span class="fc" id="L297">    LONG,</span>
<span class="fc" id="L298">    FLOAT,</span>
<span class="fc" id="L299">    DOUBLE,</span>
<span class="fc" id="L300">    STRING,</span>
<span class="fc" id="L301">    OBJECT,       // Used in dataTable to transfer data structure.</span>
    //EVERYTHING AFTER THIS MUST BE ARRAY TYPE
<span class="fc" id="L303">    BYTE_ARRAY,   // Unused.</span>
<span class="fc" id="L304">    CHAR_ARRAY,   // Unused.</span>
<span class="fc" id="L305">    SHORT_ARRAY,  // Unused.</span>
<span class="fc" id="L306">    INT_ARRAY,</span>
<span class="fc" id="L307">    LONG_ARRAY,</span>
<span class="fc" id="L308">    FLOAT_ARRAY,</span>
<span class="fc" id="L309">    DOUBLE_ARRAY,</span>
<span class="fc" id="L310">    STRING_ARRAY;</span>

    public boolean isNumber() {
<span class="fc bfc" id="L313" title="All 2 branches covered.">      switch (this) {</span>
        case BYTE:
        case SHORT:
        case INT:
        case LONG:
        case FLOAT:
        case DOUBLE:
<span class="fc" id="L320">          return true;</span>
        default:
<span class="fc" id="L322">          return false;</span>
      }
    }

    public boolean isInteger() {
<span class="fc bfc" id="L327" title="All 2 branches covered.">      switch (this) {</span>
        case BYTE:
        case SHORT:
        case INT:
        case LONG:
<span class="fc" id="L332">          return true;</span>
        default:
<span class="fc" id="L334">          return false;</span>
      }
    }

    public boolean isSingleValue() {
<span class="fc bfc" id="L339" title="All 2 branches covered.">      return this.ordinal() &lt; BYTE_ARRAY.ordinal();</span>
    }

    public DataType toMultiValue() {
<span class="pc bpc" id="L343" title="7 of 8 branches missed.">      switch (this) {</span>
        case BYTE:
<span class="nc" id="L345">          return BYTE_ARRAY;</span>
        case CHAR:
<span class="nc" id="L347">          return CHAR_ARRAY;</span>
        case INT:
<span class="fc" id="L349">          return INT_ARRAY;</span>
        case LONG:
<span class="nc" id="L351">          return LONG_ARRAY;</span>
        case FLOAT:
<span class="nc" id="L353">          return FLOAT_ARRAY;</span>
        case DOUBLE:
<span class="nc" id="L355">          return DOUBLE_ARRAY;</span>
        case STRING:
<span class="nc" id="L357">          return STRING_ARRAY;</span>
        default:
<span class="nc" id="L359">          throw new UnsupportedOperationException(&quot;Unsupported toMultiValue for data type: &quot; + this);</span>
      }
    }

    public DataType toSingleValue() {
<span class="pc bpc" id="L364" title="3 of 8 branches missed.">      switch (this) {</span>
        case BYTE_ARRAY:
<span class="nc" id="L366">          return BYTE;</span>
        case CHAR_ARRAY:
<span class="nc" id="L368">          return CHAR;</span>
        case INT_ARRAY:
<span class="fc" id="L370">          return INT;</span>
        case LONG_ARRAY:
<span class="fc" id="L372">          return LONG;</span>
        case FLOAT_ARRAY:
<span class="fc" id="L374">          return FLOAT;</span>
        case DOUBLE_ARRAY:
<span class="fc" id="L376">          return DOUBLE;</span>
        case STRING_ARRAY:
<span class="fc" id="L378">          return STRING;</span>
        default:
<span class="nc" id="L380">          throw new UnsupportedOperationException(&quot;Unsupported toSingleValue for data type: &quot; + this);</span>
      }
    }

    public boolean isCompatible(DataType anotherDataType) {
      // Single-value is not compatible with multi-value.
<span class="pc bpc" id="L386" title="1 of 2 branches missed.">      if (isSingleValue() != anotherDataType.isSingleValue()) {</span>
<span class="nc" id="L387">        return false;</span>
      }
      // Number is not compatible with String.
<span class="fc bfc" id="L390" title="All 2 branches covered.">      if (isSingleValue()) {</span>
<span class="pc bpc" id="L391" title="1 of 2 branches missed.">        return isNumber() == anotherDataType.isNumber();</span>
      } else {
<span class="pc bpc" id="L393" title="1 of 2 branches missed.">        return toSingleValue().isNumber() == anotherDataType.toSingleValue().isNumber();</span>
      }
    }

    /**
     * Return the {@link DataType} stored in pinot.
     */
    public DataType getStoredType() {
<span class="pc bpc" id="L401" title="1 of 6 branches missed.">      switch (this) {</span>
        case BYTE:
        case SHORT:
        case INT:
<span class="fc" id="L405">          return INT;</span>
        case LONG:
<span class="fc" id="L407">          return LONG;</span>
        case FLOAT:
<span class="fc" id="L409">          return FLOAT;</span>
        case DOUBLE:
<span class="fc" id="L411">          return DOUBLE;</span>
        case BOOLEAN:
        case CHAR:
        case STRING:
<span class="fc" id="L415">          return STRING;</span>
        default:
<span class="nc" id="L417">          throw new UnsupportedOperationException(&quot;Unsupported data type: &quot; + this);</span>
      }
    }

    /**
     * Return the {@link DataType} associate with the {@link Type}
     */
    public static DataType valueOf(Type avroType) {
<span class="pc bpc" id="L425" title="3 of 6 branches missed.">      switch (avroType) {</span>
        case INT:
<span class="fc" id="L427">          return INT;</span>
        case LONG:
<span class="fc" id="L429">          return LONG;</span>
        case FLOAT:
<span class="nc" id="L431">          return FLOAT;</span>
        case DOUBLE:
<span class="nc" id="L433">          return DOUBLE;</span>
        case BOOLEAN:
        case STRING:
        case ENUM:
<span class="fc" id="L437">          return STRING;</span>
        default:
<span class="nc" id="L439">          throw new UnsupportedOperationException(&quot;Unsupported Avro type: &quot; + avroType);</span>
      }
    }

    /**
     * Return number of bytes needed for storage.
     */
    public int size() {
<span class="pc bpc" id="L447" title="1 of 5 branches missed.">      switch (this) {</span>
        case INT:
<span class="fc" id="L449">          return 4;</span>
        case LONG:
<span class="fc" id="L451">          return 8;</span>
        case FLOAT:
<span class="fc" id="L453">          return 4;</span>
        case DOUBLE:
<span class="fc" id="L455">          return 8;</span>
        default:
<span class="nc" id="L457">          throw new UnsupportedOperationException(&quot;Cannot get number of bytes for: &quot; + this);</span>
      }
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>