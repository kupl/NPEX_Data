[
    {
        "commit": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/commit/044339fae434f32a3f261463cc89f15cedfa8798",
        "repo": "sling-org-apache-sling-testing-resourceresolver-mock",
        "parent": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/commit/875921a522bb400440545078de1a7fa6fb4c38dd",
        "message": "SLING-4626 NullPointerExceptions in MockResourceResolver (patch provided by Joel Richard)\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@1680749 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "sling-org-apache-sling-testing-resourceresolver-mock_1",
        "file": [
            {
                "sha": "338eef4da1e3539f58af6a692e433e10a24946c0",
                "filename": "src/main/java/org/apache/sling/testing/resourceresolver/MockResourceResolver.java",
                "status": "modified",
                "additions": 11,
                "deletions": 7,
                "changes": 18,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/blob/044339fae434f32a3f261463cc89f15cedfa8798/src/main/java/org/apache/sling/testing/resourceresolver/MockResourceResolver.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/raw/044339fae434f32a3f261463cc89f15cedfa8798/src/main/java/org/apache/sling/testing/resourceresolver/MockResourceResolver.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-testing-resourceresolver-mock/contents/src/main/java/org/apache/sling/testing/resourceresolver/MockResourceResolver.java?ref=044339fae434f32a3f261463cc89f15cedfa8798",
                "patch": "@@ -135,13 +135,15 @@ public Resource getResource(final String path) {\n         \n         // if not resource found check if this is a reference to a property\n         if (resource == null && path != null) {\n-            String name = ResourceUtil.getName(path);\n             String parentPath = ResourceUtil.getParent(path);\n-            Resource parentResource = getResourceInternal(parentPath);\n-            if (parentResource!=null) {\n-                ValueMap props = ResourceUtil.getValueMap(parentResource);\n-                if (props.containsKey(name)) {\n-                    return new MockPropertyResource(path, props, this);\n+            if (parentPath != null) {\n+                String name = ResourceUtil.getName(path);\n+                Resource parentResource = getResourceInternal(parentPath);\n+                if (parentResource!=null) {\n+                    ValueMap props = ResourceUtil.getValueMap(parentResource);\n+                    if (props.containsKey(name)) {\n+                        return new MockPropertyResource(path, props, this);\n+                    }\n                 }\n             }\n         }\n@@ -155,7 +157,9 @@ private Resource getResourceInternal(final String path) {\n         }\n         \n         String normalizedPath = ResourceUtil.normalize(path);\n-        if ( normalizedPath.startsWith(\"/\") ) {\n+        if (normalizedPath == null) {\n+            return null;\n+        } else if ( normalizedPath.startsWith(\"/\") ) {\n             if ( this.deletedResources.contains(normalizedPath) ) {\n                 return null;\n             }"
            },
            {
                "sha": "a17fa7f35054ca7e644ad9a384fa8c581e055c48",
                "filename": "src/main/java/org/apache/sling/testing/resourceresolver/MockValueMap.java",
                "status": "modified",
                "additions": 4,
                "deletions": 2,
                "changes": 6,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/blob/044339fae434f32a3f261463cc89f15cedfa8798/src/main/java/org/apache/sling/testing/resourceresolver/MockValueMap.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/raw/044339fae434f32a3f261463cc89f15cedfa8798/src/main/java/org/apache/sling/testing/resourceresolver/MockValueMap.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-testing-resourceresolver-mock/contents/src/main/java/org/apache/sling/testing/resourceresolver/MockValueMap.java?ref=044339fae434f32a3f261463cc89f15cedfa8798",
                "patch": "@@ -132,8 +132,10 @@ else if (value instanceof InputStream) {\n     \n     private static Map<String, Object> convertForWriteAll(Map<String, Object> map) {\n         Map<String,Object> newMap = new HashMap<String, Object>();\n-        for (Map.Entry<String, Object> entry : map.entrySet()) {\n-            newMap.put(entry.getKey(), convertForWrite(entry.getValue()));\n+        if (map != null) {\n+            for (Map.Entry<String, Object> entry : map.entrySet()) {\n+                newMap.put(entry.getKey(), convertForWrite(entry.getValue()));\n+            }\n         }\n         return newMap;\n     }"
            },
            {
                "sha": "7264f63df653578579c71a42fac5027464df8387",
                "filename": "src/test/java/org/apache/sling/testing/resourceresolver/RootResourceTypeTest.java",
                "status": "modified",
                "additions": 8,
                "deletions": 1,
                "changes": 9,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/blob/044339fae434f32a3f261463cc89f15cedfa8798/src/test/java/org/apache/sling/testing/resourceresolver/RootResourceTypeTest.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-testing-resourceresolver-mock/raw/044339fae434f32a3f261463cc89f15cedfa8798/src/test/java/org/apache/sling/testing/resourceresolver/RootResourceTypeTest.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-testing-resourceresolver-mock/contents/src/test/java/org/apache/sling/testing/resourceresolver/RootResourceTypeTest.java?ref=044339fae434f32a3f261463cc89f15cedfa8798",
                "patch": "@@ -38,11 +38,18 @@ public final void setUp() throws IOException, LoginException {\n         resourceResolver = new MockResourceResolverFactory().getResourceResolver(null);       \n     }\n \n-    \n+\n     @Test\n     public void testIsResourceResolver() {\n         Resource root= resourceResolver.getResource(\"/\");\n         Assert.assertTrue(root.isResourceType(\"rep:root\"));\n     }\n \n+    @Test\n+    public void testGetRootParent() {\n+        Resource rootParent = resourceResolver.getResource(\"/..\");\n+        Assert.assertNull(rootParent);\n+    }\n+\n+\n }"
            }
        ]
    }
]
