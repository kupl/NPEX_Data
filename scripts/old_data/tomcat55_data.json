[
    {
        "commit": "https://github.com/apache/tomcat55/commit/ec2f262f69c14f2c1fa862933b90c2626c5109f6",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/486fc47bab399b77bdcb756d6a282b3b7c87ddc8",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49196\nAvoid NullPointerException in PageContext.getErrorData() if an error-handling JSP page is called directly.\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@956822 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_1",
        "file": [
            {
                "sha": "62e7ce5c922575751674185a1886e115f82d0086",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 8,
                "changes": 8,
                "blob_url": "https://github.com/apache/tomcat55/blob/ec2f262f69c14f2c1fa862933b90c2626c5109f6/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/ec2f262f69c14f2c1fa862933b90c2626c5109f6/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=ec2f262f69c14f2c1fa862933b90c2626c5109f6",
                "patch": "@@ -54,14 +54,6 @@ PATCHES PROPOSED TO BACKPORT:\n               http://svn.apache.org/viewvc?view=revision&revision=749019\n   -1:\n \n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49196\n-  Avoid NullPointerException in PageContext.getErrorData() if an\n-  error-handling JSP page is called directly.\n-  It is backport of r948057.\n-  https://issues.apache.org/bugzilla/attachment.cgi?id=25534\n-  +1: kkolinko, markt, kfujino\n-  -1: \n-\n * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48990#c11\n   Do not omit exe and dll files in release builds built on Unixes,\n   to align them with the official ones built on Windows."
            },
            {
                "sha": "e0b978b9e2fbeb660d548234ca44d470f646a98f",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/tomcat55/blob/ec2f262f69c14f2c1fa862933b90c2626c5109f6/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/ec2f262f69c14f2c1fa862933b90c2626c5109f6/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=ec2f262f69c14f2c1fa862933b90c2626c5109f6",
                "patch": "@@ -133,6 +133,11 @@\n         security manager if the first access is to a JSP that uses a\n         FunctionMapper. (markt/kkolinko)\n       </fix>\n+      <fix>\n+        <bug>49196</bug>: Avoid NullPointerException in\n+        PageContext.getErrorData() if an error-handling JSP page is called\n+        directly. (kkolinko)\n+      </fix>\n     </changelog>\n   </subsection>\n   <subsection name=\"Cluster\">"
            },
            {
                "sha": "25cfb0e250b90e12d1de215ab2523b0663e99de1",
                "filename": "servletapi/jsr152/src/share/javax/servlet/jsp/PageContext.java",
                "status": "modified",
                "additions": 10,
                "deletions": 2,
                "changes": 12,
                "blob_url": "https://github.com/apache/tomcat55/blob/ec2f262f69c14f2c1fa862933b90c2626c5109f6/servletapi/jsr152/src/share/javax/servlet/jsp/PageContext.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/ec2f262f69c14f2c1fa862933b90c2626c5109f6/servletapi/jsr152/src/share/javax/servlet/jsp/PageContext.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/servletapi/jsr152/src/share/javax/servlet/jsp/PageContext.java?ref=ec2f262f69c14f2c1fa862933b90c2626c5109f6",
                "patch": "@@ -512,10 +512,18 @@ public BodyContent pushBody() {\n      * @since 2.0\n      */\n     public ErrorData getErrorData() {\n+        int status = 0;\n+        \n+        Integer status_code = (Integer)getRequest().getAttribute( \n+                \"javax.servlet.error.status_code\");\n+        // Avoid NPE if attribute is not set\n+        if (status_code != null) {\n+            status = status_code.intValue();\n+        }\n+\n         return new ErrorData( \n             (Throwable)getRequest().getAttribute( \"javax.servlet.error.exception\" ),\n-            ((Integer)getRequest().getAttribute( \n-                \"javax.servlet.error.status_code\" )).intValue(),\n+            status,\n             (String)getRequest().getAttribute( \"javax.servlet.error.request_uri\" ),\n             (String)getRequest().getAttribute( \"javax.servlet.error.servlet_name\" ) );\n     }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/f4b58a36642dc04cdf4b0522638e955d18ec70de",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/7fbee9d2e6c9bb9e5a3f70f96a4a7435cf5f8f4b",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51403\nAvoid NPE in JULI FileHandler if formatter is misconfigured\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@1156993 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_2",
        "file": [
            {
                "sha": "8738739801a5b189eb3edd3c64e8a482a87a814f",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 6,
                "changes": 6,
                "blob_url": "https://github.com/apache/tomcat55/blob/f4b58a36642dc04cdf4b0522638e955d18ec70de/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/f4b58a36642dc04cdf4b0522638e955d18ec70de/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=f4b58a36642dc04cdf4b0522638e955d18ec70de",
                "patch": "@@ -77,12 +77,6 @@ PATCHES PROPOSED TO BACKPORT:\n   +1: markt\n   -1: \n   \n-* https://issues.apache.org/bugzilla/show_bug.cgi?id=51403\n-  Avoid NPE in JULI FileHandler if formatter is misconfigured\n-  http://svn.apache.org/viewvc?rev=1137996&view=rev\n-  +1: kkolinko, markt, kfujino\n-  -1:\n-\n * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=36362\n   Handle tag files with attribute names that are not valid Java identifiers\n   http://svn.apache.org/viewvc?rev=1138950&view=rev"
            },
            {
                "sha": "7e30587ad756b543634a5308d7151ba1effb6db5",
                "filename": "connectors/juli/src/java/org/apache/juli/FileHandler.java",
                "status": "modified",
                "additions": 2,
                "deletions": 1,
                "changes": 3,
                "blob_url": "https://github.com/apache/tomcat55/blob/f4b58a36642dc04cdf4b0522638e955d18ec70de/connectors/juli/src/java/org/apache/juli/FileHandler.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/f4b58a36642dc04cdf4b0522638e955d18ec70de/connectors/juli/src/java/org/apache/juli/FileHandler.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/connectors/juli/src/java/org/apache/juli/FileHandler.java?ref=f4b58a36642dc04cdf4b0522638e955d18ec70de",
                "patch": "@@ -258,7 +258,8 @@ private void configure() {\n             try {\n                 setFormatter((Formatter) cl.loadClass(formatterName).newInstance());\n             } catch (Exception e) {\n-                // Ignore\n+                // Ignore and fallback to defaults\n+                setFormatter(new SimpleFormatter());\n             }\n         } else {\n             setFormatter(new SimpleFormatter());"
            },
            {
                "sha": "9a7142889c4e8732071300f46e064671418cdbbb",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 6,
                "deletions": 1,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/f4b58a36642dc04cdf4b0522638e955d18ec70de/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/f4b58a36642dc04cdf4b0522638e955d18ec70de/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=f4b58a36642dc04cdf4b0522638e955d18ec70de",
                "patch": "@@ -59,7 +59,12 @@\n         Fix CVE-2011-2204. Prevent user passwords appearing in log files if a\n         runtime exception (e.g. OOME) occurs while creating a new user for a\n         MemoryUserDatabase via JMX. (markt)\n-      </fix>    </changelog>\n+      </fix>\n+      <fix>\n+        <bug>51403</bug>: Avoid NullPointerException in JULI FileHandler if\n+        formatter is misconfigured. (kkolinko)\n+      </fix>\n+    </changelog>\n   </subsection>\n   <subsection name=\"Webapps\">\n     <changelog>"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/e1ab40c1e729146137896bc4c0f5ff34d765c4bf",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48582\nAvoid NPE on background compile\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@919397 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_3",
        "file": [
            {
                "sha": "20aa877e1477d4e492d73c1c7448dd32320b6a74",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 7,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=c8cedbdce41aa4c5a26903bb330a4fe03b62f36e",
                "patch": "@@ -84,10 +84,3 @@ PATCHES PROPOSED TO BACKPORT:\n   http://svn.apache.org/viewvc?rev=907819&view=rev\n   +1: kkolinko, rjung, markt\n   -1: \n-\n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48582\n-  Avoid NPE on background compile\n-  http://svn.apache.org/viewvc?rev=910471&view=rev\n-  Patch by markt\n-  +1: kkolinko, rjung, markt\n-  -1: "
            },
            {
                "sha": "e337aeaae337d2efa1a74f7d24af65fb679988dc",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 3,
                "deletions": 0,
                "changes": 3,
                "blob_url": "https://github.com/apache/tomcat55/blob/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=c8cedbdce41aa4c5a26903bb330a4fe03b62f36e",
                "patch": "@@ -250,6 +250,9 @@\n         <bug>46907</bug>: Don't swallow input stream when debug logging is\n         enabled. (markt)\n       </fix>\n+      <fix>\n+        <bug>48582</bug>: Avoid NPE on background compile. (markt)\n+      </fix>\n     </changelog>\n   </subsection>\n   <subsection name=\"Cluster\">"
            },
            {
                "sha": "d3eb8d85bda2e24fe679043814b32fcbbb55456f",
                "filename": "jasper/src/share/org/apache/jasper/servlet/JspServletWrapper.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/tomcat55/blob/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/jasper/src/share/org/apache/jasper/servlet/JspServletWrapper.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/c8cedbdce41aa4c5a26903bb330a4fe03b62f36e/jasper/src/share/org/apache/jasper/servlet/JspServletWrapper.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/jasper/src/share/org/apache/jasper/servlet/JspServletWrapper.java?ref=c8cedbdce41aa4c5a26903bb330a4fe03b62f36e",
                "patch": "@@ -157,7 +157,7 @@ public Servlet getServlet()\n     }\n \n     public ServletContext getServletContext() {\n-        return config.getServletContext();\n+        return ctxt.getServletContext();\n     }\n \n     /**"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/1e60007e10defa21539d83e3e2634d5b5683c90a",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/cb16e6a7b24944bfb08cc8fa2e53c47e9a6a9604",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48686\nFix NPE in host delete\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@918779 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_4",
        "file": [
            {
                "sha": "d0d66761a35c3dbd0b1c4ae632910727ad8330dd",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 6,
                "changes": 6,
                "blob_url": "https://github.com/apache/tomcat55/blob/1e60007e10defa21539d83e3e2634d5b5683c90a/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/1e60007e10defa21539d83e3e2634d5b5683c90a/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=1e60007e10defa21539d83e3e2634d5b5683c90a",
                "patch": "@@ -113,12 +113,6 @@ PATCHES PROPOSED TO BACKPORT:\n   +1: kkolinko, rjung\n   -1: \n \n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48686\n-  Fix NPE in host delete\n-  https://issues.apache.org/bugzilla/attachment.cgi?id=24966\n-  +1: markt, kkolinko, rjung\n-  -1: \n-\n * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48582\n   Avoid NPE on background compile\n   http://svn.apache.org/viewvc?rev=910471&view=rev"
            },
            {
                "sha": "fb6e893fbdfc82790c445b8041ee6dda35ab44ff",
                "filename": "container/webapps/admin/WEB-INF/classes/org/apache/webapp/admin/host/DeleteHostAction.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/tomcat55/blob/1e60007e10defa21539d83e3e2634d5b5683c90a/container/webapps/admin/WEB-INF/classes/org/apache/webapp/admin/host/DeleteHostAction.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/1e60007e10defa21539d83e3e2634d5b5683c90a/container/webapps/admin/WEB-INF/classes/org/apache/webapp/admin/host/DeleteHostAction.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/admin/WEB-INF/classes/org/apache/webapp/admin/host/DeleteHostAction.java?ref=1e60007e10defa21539d83e3e2634d5b5683c90a",
                "patch": "@@ -113,7 +113,7 @@ public ActionForward execute(ActionMapping mapping,\n         // this host cannot be deleted from the admin tool\n         try {\n             adminHost = Lists.getAdminAppHost(\n-                                  mBServer, \"domain\" ,request);\n+                                  mBServer, domain ,request);\n         } catch (Exception e) {\n             String message =\n                 resources.getMessage(locale, \"error.hostName.bad\","
            },
            {
                "sha": "344b9c418a9a64ec3785687634df0baddd90792c",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/tomcat55/blob/1e60007e10defa21539d83e3e2634d5b5683c90a/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/1e60007e10defa21539d83e3e2634d5b5683c90a/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=1e60007e10defa21539d83e3e2634d5b5683c90a",
                "patch": "@@ -278,6 +278,10 @@\n         in the documentation web application to specify how the defaults for the\n         various trust store attributes are determined. (markt)\n       </add>\n+      <fix>\n+        <bug>48686</bug>: Fix deleting a host via the Administration web\n+        application rather than failign with a HTTP 500 response. (markt)\n+      </fix>\n       <add>\n         Make changelog.xml be directly rendered as HTML by certain browsers.\n         (kkolinko)"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/9be444210a246b6d82cb2cee76c965c626a63caf",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/585f035e62de6c7158292f8deb20b4674d2da23e",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39844\nPrevent NPE on non-HTTP forward\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@892624 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_5",
        "file": [
            {
                "sha": "0f16cf1260d0df61db753cdf099a517ba4a2ba5c",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 6,
                "changes": 6,
                "blob_url": "https://github.com/apache/tomcat55/blob/9be444210a246b6d82cb2cee76c965c626a63caf/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/9be444210a246b6d82cb2cee76c965c626a63caf/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=9be444210a246b6d82cb2cee76c965c626a63caf",
                "patch": "@@ -33,12 +33,6 @@ PATCHES PROPOSED TO BACKPORT:\n    0: fhanik - big step for an old branch, could be risky, I'd wait until after next release if we consider it\n   -1:\n \n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39844\n-  Port r588477 (fix for #43668) by billbarker that corrected this for Tomcat 6\n-  http://people.apache.org/~markt/patches/2009-07-11-bug39844.patch\n-  +1: markt, kkolinko, rjung\n-  -1:\n-\n * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43327\n   Port from 6.0.x\n   Required to investigate 39997"
            },
            {
                "sha": "e30e39457487e4802aa1f75248b9fad6ba480f93",
                "filename": "container/catalina/src/share/org/apache/catalina/core/ApplicationDispatcher.java",
                "status": "modified",
                "additions": 27,
                "deletions": 40,
                "changes": 67,
                "blob_url": "https://github.com/apache/tomcat55/blob/9be444210a246b6d82cb2cee76c965c626a63caf/container/catalina/src/share/org/apache/catalina/core/ApplicationDispatcher.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/9be444210a246b6d82cb2cee76c965c626a63caf/container/catalina/src/share/org/apache/catalina/core/ApplicationDispatcher.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/catalina/src/share/org/apache/catalina/core/ApplicationDispatcher.java?ref=9be444210a246b6d82cb2cee76c965c626a63caf",
                "patch": "@@ -139,6 +139,16 @@ public Object run() throws ServletException, IOException {\n          * Are we performing an include() instead of a forward()?\n          */\n         boolean including = false;\n+\n+        /**\n+         * Outer most HttpServletRequest in the chain\n+         */\n+        HttpServletRequest hrequest = null;\n+\n+        /**\n+         * Outermost HttpServletResponse in the chain\n+         */\n+        HttpServletResponse hresponse = null;\n     }\n \n     // ----------------------------------------------------------- Constructors\n@@ -329,32 +339,17 @@ private void doForward(ServletRequest request, ServletResponse response)\n             checkSameObjects(request, response);\n         }\n \n-        // Identify the HTTP-specific request and response objects (if any)\n-        HttpServletRequest hrequest = null;\n-        if (request instanceof HttpServletRequest)\n-            hrequest = (HttpServletRequest) request;\n-        HttpServletResponse hresponse = null;\n-        if (response instanceof HttpServletResponse)\n-            hresponse = (HttpServletResponse) response;\n-\n-        // Handle a non-HTTP forward by passing the existing request/response\n-        if ((hrequest == null) || (hresponse == null)) {\n-\n-            if ( log.isDebugEnabled() )\n-                log.debug(\" Non-HTTP Forward\");\n-            \n-            processRequest(hrequest,hresponse,state);\n-\n-        }\n-\n+        wrapResponse(state);\n+        \n         // Handle an HTTP named dispatcher forward\n-        else if ((servletPath == null) && (pathInfo == null)) {\n+        if ((servletPath == null) && (pathInfo == null)) {\n \n             if ( log.isDebugEnabled() )\n                 log.debug(\" Named Dispatcher Forward\");\n             \n             ApplicationHttpRequest wrequest =\n                 (ApplicationHttpRequest) wrapRequest(state);\n+            HttpServletRequest hrequest = state.hrequest;\n             wrequest.setRequestURI(hrequest.getRequestURI());\n             wrequest.setContextPath(hrequest.getContextPath());\n             wrequest.setServletPath(hrequest.getServletPath());\n@@ -374,6 +369,7 @@ else if ((servletPath == null) && (pathInfo == null)) {\n                 (ApplicationHttpRequest) wrapRequest(state);\n             String contextPath = context.getPath();\n \n+            HttpServletRequest hrequest = state.hrequest;\n             if (hrequest.getAttribute(Globals.FORWARD_REQUEST_URI_ATTR) == null) {\n                 wrequest.setAttribute(Globals.FORWARD_REQUEST_URI_ATTR,\n                                       hrequest.getRequestURI());\n@@ -422,12 +418,12 @@ else if ((servletPath == null) && (pathInfo == null)) {\n                     ServletOutputStream stream = response.getOutputStream();\n                     stream.close();\n                 } catch (IllegalStateException f) {\n-                    ;\n+                    // Ignore\n                 } catch (IOException f) {\n-                    ;\n+                    // Ignore\n                 }\n             } catch (IOException e) {\n-                ;\n+                // Ignore\n             }\n         }\n \n@@ -513,23 +509,8 @@ private void doInclude(ServletRequest request, ServletResponse response)\n         // ServletResponse wresponse = null;\n         wrapResponse(state);\n \n-        // Handle a non-HTTP include\n-        if (!(request instanceof HttpServletRequest) ||\n-            !(response instanceof HttpServletResponse)) {\n-\n-            if ( log.isDebugEnabled() )\n-                log.debug(\" Non-HTTP Include\");\n-            request.setAttribute(\n-                    ApplicationFilterFactory.DISPATCHER_TYPE_ATTR,\n-                    new Integer(ApplicationFilterFactory.INCLUDE));\n-            request.setAttribute(\n-                    ApplicationFilterFactory.DISPATCHER_REQUEST_PATH_ATTR,\n-                    servletPath);\n-            invoke(request, state.outerResponse, state);\n-        }\n-\n         // Handle an HTTP named dispatcher include\n-        else if (name != null) {\n+        if (name != null) {\n \n             if ( log.isDebugEnabled() )\n                 log.debug(\" Named Dispatcher Include\");\n@@ -621,7 +602,7 @@ private void invoke(ServletRequest request, ServletResponse response,\n         }\n \n         // Initialize local variables we may need\n-        HttpServletResponse hresponse = (HttpServletResponse) response;\n+        HttpServletResponse hresponse = state.hresponse;\n         Servlet servlet = null;\n         IOException ioException = null;\n         ServletException servletException = null;\n@@ -651,7 +632,6 @@ private void invoke(ServletRequest request, ServletResponse response,\n             wrapper.getLogger().error(sm.getString(\"applicationDispatcher.allocateException\",\n                              wrapper.getName()), StandardWrapper.getRootCause(e));\n             servletException = e;\n-            servlet = null;\n         } catch (Throwable e) {\n             wrapper.getLogger().error(sm.getString(\"applicationDispatcher.allocateException\",\n                              wrapper.getName()), e);\n@@ -854,6 +834,8 @@ private ServletRequest wrapRequest(State state) {\n         ServletRequest previous = null;\n         ServletRequest current = state.outerRequest;\n         while (current != null) {\n+            if(state.hrequest == null && (current instanceof HttpServletRequest))\n+                state.hrequest = (HttpServletRequest)current;\n             if (\"org.apache.catalina.servlets.InvokerHttpRequest\".\n                 equals(current.getClass().getName()))\n                 break; // KLUDGE - Make nested RD.forward() using invoker work\n@@ -915,6 +897,11 @@ private ServletResponse wrapResponse(State state) {\n         ServletResponse previous = null;\n         ServletResponse current = state.outerResponse;\n         while (current != null) {\n+            if(state.hresponse == null && (current instanceof HttpServletResponse)) {\n+                state.hresponse = (HttpServletResponse)current;\n+                if(!state.including) // Forward only needs hresponse\n+                    return null;\n+            }\n             if (!(current instanceof ServletResponseWrapper))\n                 break;\n             if (current instanceof ApplicationHttpResponse)"
            },
            {
                "sha": "0747b4ae2abfb1201f38b23b533a52a928614a2a",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/tomcat55/blob/9be444210a246b6d82cb2cee76c965c626a63caf/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/9be444210a246b6d82cb2cee76c965c626a63caf/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=9be444210a246b6d82cb2cee76c965c626a63caf",
                "patch": "@@ -70,6 +70,10 @@\n         <bug>39231</bug>: Call LoginModule.logout() when using JAASRealm.\n         (markt/kkolinko)\n       </fix>\n+      <fix>\n+        <bug>39844</bug>: Fix NPE when performing a non-HTTP forward.\n+        (billbarker)\n+      </fix>\n       <fix>\n         <bug>41059</bug>: Reduce the chances of errors when using\n         ENABLE_CLEAR_REFERENCES. Patch by Curt Arnold. (markt) "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/073bb4d2d161d766a551aafc67d0560dca40a6cf",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/4b54a321763f0c40759afd1b000ad74bbbfd4d75",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50131\nAvoid possible NPE in debug output in PersistentValve.\nBased on the patch provided by sebb\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@1028556 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_6",
        "file": [
            {
                "sha": "79121552d1856dd213e8d86f24d42a9c7a4b52bf",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 7,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/073bb4d2d161d766a551aafc67d0560dca40a6cf/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/073bb4d2d161d766a551aafc67d0560dca40a6cf/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=073bb4d2d161d766a551aafc67d0560dca40a6cf",
                "patch": "@@ -77,13 +77,6 @@ PATCHES PROPOSED TO BACKPORT:\n   +1: kfujino, markt, rjung\n   -1:\n \n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50131\n-  Avoid possible NPE in debug output in PersistentValve.\n-  Patch by sebb\n-  https://issues.apache.org/bugzilla/attachment.cgi?id=26194\n-  +1: kkolinko, kfujino, markt\n-  -1:\n-\n * Update Commons daemon to 1.0.4\n   Version 1.0.4 is bug fixing release. (Patch is trivial changing the version\n   number to 1.0.4 in build.properties.default, so not provided)"
            },
            {
                "sha": "d4e823f417445730ad323b992f820ea2d1aecd73",
                "filename": "container/catalina/src/share/org/apache/catalina/valves/PersistentValve.java",
                "status": "modified",
                "additions": 5,
                "deletions": 3,
                "changes": 8,
                "blob_url": "https://github.com/apache/tomcat55/blob/073bb4d2d161d766a551aafc67d0560dca40a6cf/container/catalina/src/share/org/apache/catalina/valves/PersistentValve.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/073bb4d2d161d766a551aafc67d0560dca40a6cf/container/catalina/src/share/org/apache/catalina/valves/PersistentValve.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/catalina/src/share/org/apache/catalina/valves/PersistentValve.java?ref=073bb4d2d161d766a551aafc67d0560dca40a6cf",
                "patch": "@@ -178,9 +178,11 @@ public void invoke(Request request, Response response)\n                 } else {\n                     if (container.getLogger().isDebugEnabled())\n                         container.getLogger().debug(\"newsessionId store: \" + store + \" session: \" +\n-                                session + \" valid: \" + session.isValid() +\n-                                \" Staled: \" +\n-                                isSessionStale(session, System.currentTimeMillis()));\n+                                session + \n+                                (session == null ? \"\" :\n+                                    \" valid: \" + session.isValid() +\n+                                    \" stale: \" +\n+                                isSessionStale(session, System.currentTimeMillis())));\n \n                 }\n             } else {"
            },
            {
                "sha": "8a8e50f52b13777db8c503058071b87160b96ce0",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/tomcat55/blob/073bb4d2d161d766a551aafc67d0560dca40a6cf/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/073bb4d2d161d766a551aafc67d0560dca40a6cf/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=073bb4d2d161d766a551aafc67d0560dca40a6cf",
                "patch": "@@ -49,6 +49,10 @@\n   </subsection>\n   <subsection name=\"Catalina\">\n     <changelog>\n+      <fix>\n+        <bug>50131</bug>: Avoid possible NPE in debug output in PersistentValve.\n+        Patch provided by sebb. (kkolinko)\n+      </fix>\n       <fix>\n         Avoid unnecessary cast in StandardContext. (markt)\n       </fix>"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/03385f32267946c0a67b21faa70a0c47d04dfc8f",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/b85e73b7ab75b607620f09f89d20fdd2d34210e1",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49424\nAvoid NPE if client provides no data with a chunked POST request\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@956856 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_7",
        "file": [
            {
                "sha": "4dbfcb71b23ea75d4da3df718d69eaa3cd4cf7ce",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 7,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/03385f32267946c0a67b21faa70a0c47d04dfc8f/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/03385f32267946c0a67b21faa70a0c47d04dfc8f/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=03385f32267946c0a67b21faa70a0c47d04dfc8f",
                "patch": "@@ -59,10 +59,3 @@ PATCHES PROPOSED TO BACKPORT:\n   http://svn.apache.org/viewvc?view=revision&revision=955190\n   +1: kfujino\n   -1:\n-\n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49424\n-  Avoid NPE if client provides no data with a chunked POST request\n-  http://svn.apache.org/viewvc?rev=953434&view=rev\n-  (by markt)\n-  +1: kkolinko, markt, kfujino\n-  -1: "
            },
            {
                "sha": "f622c4eb7ebe7b8876ad9f3f3df8814118cb5249",
                "filename": "container/catalina/src/share/org/apache/catalina/connector/Request.java",
                "status": "modified",
                "additions": 6,
                "deletions": 1,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/03385f32267946c0a67b21faa70a0c47d04dfc8f/container/catalina/src/share/org/apache/catalina/connector/Request.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/03385f32267946c0a67b21faa70a0c47d04dfc8f/container/catalina/src/share/org/apache/catalina/connector/Request.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/catalina/src/share/org/apache/catalina/connector/Request.java?ref=03385f32267946c0a67b21faa70a0c47d04dfc8f",
                "patch": "@@ -2461,7 +2461,9 @@ protected void parseParameters() {\n                 }\n                 return;\n             }\n-            parameters.processParameters(formData, 0, formData.length);\n+            if (formData != null) {\n+                parameters.processParameters(formData, 0, formData.length);\n+            }\n         }\n \n     }\n@@ -2507,6 +2509,9 @@ protected int readPostBody(byte body[], int len)\n                 body.append(buffer, 0, len);\n             }\n         }\n+        if (body.getLength() == 0) {\n+            return null;\n+        }\n         if (body.getLength() < body.getBuffer().length) {\n             int length = body.getLength();\n             byte[] result = new byte[length];"
            },
            {
                "sha": "a534e6ed0bd307d49f7d682c4780eed6c7f64008",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/tomcat55/blob/03385f32267946c0a67b21faa70a0c47d04dfc8f/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/03385f32267946c0a67b21faa70a0c47d04dfc8f/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=03385f32267946c0a67b21faa70a0c47d04dfc8f",
                "patch": "@@ -95,6 +95,10 @@\n       <fix>\n         Fix possible overflows when calculating session statistics. (kkolinko)\n       </fix>\n+      <fix>\n+        <bug>49424</bug>: Avoid NPE if client provides no data with a chunked\n+        POST request. (markt)\n+      </fix>\n     </changelog>\n   </subsection>\n   <subsection name=\"Coyote\">"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/tomcat55/commit/18b393950a75d2e20314946c98bcc18120148557",
        "repo": "tomcat55",
        "parent": "https://github.com/apache/tomcat55/commit/6692111703a2fe28fa6f3a397046aab753feaed3",
        "message": "Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48516\nFix possible NPE when user does not exist in directory\nPatch provided by Kevin Conaway\n\ngit-svn-id: https://svn.apache.org/repos/asf/tomcat/tc5.5.x/trunk@918564 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "tomcat55_8",
        "file": [
            {
                "sha": "605bb1b4e4f5b63e6832880a64ee291d8ecdd975",
                "filename": "STATUS.txt",
                "status": "modified",
                "additions": 0,
                "deletions": 7,
                "changes": 7,
                "blob_url": "https://github.com/apache/tomcat55/blob/18b393950a75d2e20314946c98bcc18120148557/STATUS.txt",
                "raw_url": "https://github.com/apache/tomcat55/raw/18b393950a75d2e20314946c98bcc18120148557/STATUS.txt",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/STATUS.txt?ref=18b393950a75d2e20314946c98bcc18120148557",
                "patch": "@@ -140,13 +140,6 @@ PATCHES PROPOSED TO BACKPORT:\n   +1: markt, kkolinko, rjung\n   -1: \n \n-* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48516\n-  Prevent possible NPE in JNDIRealm when user does not exist\n-  Patch provided by Kevin Conaway\n-  http://svn.apache.org/viewvc?rev=898558&view=rev\n-  +1: markt, kkolinko, rjung\n-  -1: \n-\n * Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47987\n   http://svn.apache.org/viewvc?rev=832200&view=rev\n   Limit size of not found resources cache"
            },
            {
                "sha": "d29bfa5e410450f3f456f5d4cb8fd53fdb3c6b11",
                "filename": "container/catalina/src/share/org/apache/catalina/realm/JNDIRealm.java",
                "status": "modified",
                "additions": 6,
                "deletions": 2,
                "changes": 8,
                "blob_url": "https://github.com/apache/tomcat55/blob/18b393950a75d2e20314946c98bcc18120148557/container/catalina/src/share/org/apache/catalina/realm/JNDIRealm.java",
                "raw_url": "https://github.com/apache/tomcat55/raw/18b393950a75d2e20314946c98bcc18120148557/container/catalina/src/share/org/apache/catalina/realm/JNDIRealm.java",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/catalina/src/share/org/apache/catalina/realm/JNDIRealm.java?ref=18b393950a75d2e20314946c98bcc18120148557",
                "patch": "@@ -1576,8 +1576,12 @@ protected synchronized Principal getPrincipal(DirContext context,\n         \n         User user = getUser(context, username);\n         \n-        return new GenericPrincipal(this, user.username, user.password ,\n-                getRoles(context, user));\n+        if (user != null) {\n+            return new GenericPrincipal(this, user.username, user.password,\n+                    getRoles(context, user));\n+        }\n+\n+        return null;\n     }\n \n     /**"
            },
            {
                "sha": "f662599f9ec71e3c75125ca24c8755bd44bd854d",
                "filename": "container/webapps/docs/changelog.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/tomcat55/blob/18b393950a75d2e20314946c98bcc18120148557/container/webapps/docs/changelog.xml",
                "raw_url": "https://github.com/apache/tomcat55/raw/18b393950a75d2e20314946c98bcc18120148557/container/webapps/docs/changelog.xml",
                "contents_url": "https://api.github.com/repos/apache/tomcat55/contents/container/webapps/docs/changelog.xml?ref=18b393950a75d2e20314946c98bcc18120148557",
                "patch": "@@ -120,6 +120,10 @@\n         lead to a NoClassDefFoundError on first access of first jsp.\n         (kkolinko/markt)\n       </fix>\n+      <fix>\n+        <bug>48516</bug>: Prevent NPE in JNDIRealm if requested user does not\n+        exist. Patch provided by Kevin Conaway. (markt)\n+      </fix>\n       <fix>\n         Add an additional permission required by JULI when running under newer\n         JDKs and a security manager. (markt)"
            }
        ]
    }
]
