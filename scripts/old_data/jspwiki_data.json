[
    {
        "commit": "https://github.com/apache/jspwiki/commit/00132ed63742b4bbc95d869f2356acfb0bd85671",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/361cbe0ba9e7b4d5d05533b0971d7aaef0feb054",
        "message": "Fixed a nullpointerexception if page didn't exist.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@620942 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_1",
        "file": [
            {
                "sha": "4db410e5b2af031f5718081507ebb7e3bc90de2b",
                "filename": "src/webdocs/Edit.jsp",
                "status": "modified",
                "additions": 11,
                "deletions": 5,
                "changes": 16,
                "blob_url": "https://github.com/apache/jspwiki/blob/00132ed63742b4bbc95d869f2356acfb0bd85671/src/webdocs/Edit.jsp",
                "raw_url": "https://github.com/apache/jspwiki/raw/00132ed63742b4bbc95d869f2356acfb0bd85671/src/webdocs/Edit.jsp",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/Edit.jsp?ref=00132ed63742b4bbc95d869f2356acfb0bd85671",
                "patch": "@@ -32,11 +32,9 @@\n         //  is the best place to show errors, though.\n        \n         long pagedate   = Long.parseLong(request.getParameter(\"edittime\"));\n-        Date lastchange = wiki.pageLastChanged( pagereq );\n+        Date change     = wiki.pageLastChanged( pagereq );\n \n-        log.debug(\"Page date=\"+pagedate+\", last changed \"+lastchange.getTime());\n-\n-        if( lastchange.getTime() != pagedate )\n+        if( change != null && change.getTime() != pagedate )\n         {\n             //\n             // Someone changed the page while we were editing it!\n@@ -61,6 +59,14 @@\n     }\n \n     log.info(\"Editing page \"+pagereq);\n+\n+    //\n+    //  If the page does not exist, we'll get a null here.\n+    //\n+    long lastchange = 0;\n+    Date d = wiki.pageLastChanged( pagereq );\n+    if( d != null ) lastchange = d.getTime();\n+    \n %>\n \n <HTML>\n@@ -88,7 +94,7 @@\n \n       <INPUT type=\"hidden\" name=\"page\" value=\"<%=pagereq%>\">\n       <INPUT type=\"hidden\" name=\"action\" value=\"save\">\n-      <INPUT type=\"hidden\" name=\"edittime\" value=\"<%=wiki.pageLastChanged(pagereq).getTime()%>\">\n+      <INPUT type=\"hidden\" name=\"edittime\" value=\"<%=lastchange%>\">\n \n       <TEXTAREA name=\"text\" rows=\"25\" cols=\"80\"><%=wiki.getText(pagereq)%></TEXTAREA>\n "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/85297fc9cadd575b456b5dc29724e5b68cd69db3",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/d78fb1237f3c9479718dce51630772f6a911d684",
        "message": " * 2.10.2-svn-6\n\n * Fixed JSPWIKI-855: NullPointerException in FormInput.java:92, patch provided by J\u00fcrgen Weber - thanks!\n\ngit-svn-id: https://svn.apache.org/repos/asf/jspwiki/trunk@1617380 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_2",
        "file": [
            {
                "sha": "368b70cf4e2d7cba1fb1b85ca53e5a3a6d5005da",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/85297fc9cadd575b456b5dc29724e5b68cd69db3/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/85297fc9cadd575b456b5dc29724e5b68cd69db3/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=85297fc9cadd575b456b5dc29724e5b68cd69db3",
                "patch": "@@ -1,3 +1,9 @@\n+2014-08-12  Juan Pablo Santos (juanpablo AT apache DOT org)\n+\n+       * 2.10.2-svn-6\n+\n+       * Fixed JSPWIKI-855: NullPointerException in FormInput.java:92, patch provided by J\u00fcrgen Weber - thanks!\n+\n 2014-07-31  Harry Metske (metskem@apache.org)\n \n        * 2.10.2-svn-5"
            },
            {
                "sha": "9d63e7a60b0f5ef27c316eb2c8cbfd7222fb37b8",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 2,
                "deletions": 2,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/85297fc9cadd575b456b5dc29724e5b68cd69db3/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/85297fc9cadd575b456b5dc29724e5b68cd69db3/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/Release.java?ref=85297fc9cadd575b456b5dc29724e5b68cd69db3",
                "patch": "@@ -72,8 +72,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"5\";\n-    \n+    public static final String     BUILD         = \"6\";\n+\n     /**\n      *  This is the generic version string you should use when printing out the version.  It is of \n      *  the form \"VERSION.REVISION.MINORREVISION[-POSTFIX][-BUILD]\"."
            },
            {
                "sha": "c6b3174156c5aab174a27fa5ffe8a5c9d04df8f3",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/forms/FormInput.java",
                "status": "modified",
                "additions": 4,
                "deletions": 2,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/85297fc9cadd575b456b5dc29724e5b68cd69db3/jspwiki-war/src/main/java/org/apache/wiki/forms/FormInput.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/85297fc9cadd575b456b5dc29724e5b68cd69db3/jspwiki-war/src/main/java/org/apache/wiki/forms/FormInput.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/forms/FormInput.java?ref=85297fc9cadd575b456b5dc29724e5b68cd69db3",
                "patch": "@@ -43,6 +43,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     /** Parameter name for setting the size of the input field.  Value is <tt>{@value}</tt>. */\n     public static final String PARAM_SIZE  = \"size\";\n \n+    public static final String PARAM_CHECKED  = \"checked\";\n+\n     /**\n      * Generates a dynamic form element on the WikiPage.\n      * \n@@ -55,6 +57,7 @@ public String execute( WikiContext ctx, Map< String, String > params )\n         String inputValue = params.get( PARAM_VALUE );\n         String inputType  = params.get( PARAM_TYPE );\n         String size       = params.get( PARAM_SIZE );\n+        String checked    = params.get( PARAM_CHECKED );\n         ResourceBundle rb = Preferences.getBundle( ctx, WikiPlugin.CORE_PLUGINS_RESOURCEBUNDLE );\n \n         if ( inputName == null ) {\n@@ -88,9 +91,8 @@ public String execute( WikiContext ctx, Map< String, String > params )\n         \n         Element field = XhtmlUtil.input(inputType,HANDLERPARAM_PREFIX + inputName,inputValue);\n         \n-        String checked = params.get(\"checked\");\n         field.setAttribute(XHTML.ATTR_class,\n-                String.valueOf(TextUtil.isPositive(checked) || checked.equalsIgnoreCase(\"checked\")));\n+                String.valueOf(TextUtil.isPositive(checked) || \"checked\".equalsIgnoreCase(checked)));\n         \n         String oldValue = previousValues.get( inputName );\n         if ( oldValue != null )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/52e038ebe6564207851f0f468023a497bed22ef6",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/1bfeaeb6100e4c80647a0d89f4f43eb371ef53de",
        "message": "Fixed potential NPE in getName().\nIf frontpage does not exist, would die with an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625673 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_3",
        "file": [
            {
                "sha": "c90f1c9a4d3b91924782d2a4f4bcac4acd8d4d10",
                "filename": "src/com/ecyrd/jspwiki/WikiContext.java",
                "status": "modified",
                "additions": 12,
                "deletions": 6,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/52e038ebe6564207851f0f468023a497bed22ef6/src/com/ecyrd/jspwiki/WikiContext.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/52e038ebe6564207851f0f468023a497bed22ef6/src/com/ecyrd/jspwiki/WikiContext.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/WikiContext.java?ref=52e038ebe6564207851f0f468023a497bed22ef6",
                "patch": "@@ -206,15 +206,21 @@ public WikiContext( WikiEngine engine, HttpServletRequest request, Command comma\n         m_command = command;\n         \n         // If PageCommand, get the WikiPage\n-        if ( command instanceof PageCommand )\n+        if( command instanceof PageCommand )\n         {\n             m_page = (WikiPage)((PageCommand)command).getTarget();\n         }\n         \n         // If page not supplied, default to front page to avoid NPEs\n-        if ( m_page == null )\n+        if( m_page == null )\n         {\n             m_page = m_engine.getPage( m_engine.getFrontPage() );\n+            \n+            // Front page does not exist?\n+            if( m_page == null )\n+            {\n+                m_page = new WikiPage( m_engine, m_engine.getFrontPage() );\n+            }\n         }\n         \n         m_realPage = m_page;\n@@ -223,15 +229,15 @@ public WikiContext( WikiEngine engine, HttpServletRequest request, Command comma\n         boolean doLogin = ( (request != null) && m_session.isNew() );\n         \n         // Debugging...\n-        if ( log.isDebugEnabled() )\n+        if( log.isDebugEnabled() )\n         {\n             HttpSession session = ( request == null ) ? null : request.getSession( false );\n             String sid = ( session == null ) ? \"(null)\" : session.getId();\n             log.debug( \"Creating WikiContext for session ID=\" + sid + \"; target=\" + getName() );\n             log.debug( \"Do we need to log the user in? \" + doLogin );\n         }\n         \n-        if ( doLogin || m_session.isContainerStatusChanged( request ) )\n+        if( doLogin || m_session.isContainerStatusChanged( request ) )\n         {\n             try \n             {\n@@ -245,7 +251,7 @@ public WikiContext( WikiEngine engine, HttpServletRequest request, Command comma\n         }\n \n         // Mark the session as \"not new\"\n-        if ( m_session.isNew() )\n+        if( m_session.isNew() )\n         {\n             m_session.setNew( false );\n         }\n@@ -492,7 +498,7 @@ public String getName()\n     {\n         if ( m_command instanceof PageCommand )\n         {\n-            return m_page.getName();\n+            return m_page != null ? m_page.getName() : \"<no page>\";\n         }\n         return m_command.getName();\n     }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/58bcb0f69dd7a7b4985df468770cc636c3045614",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/8236caf61a27ab73cc546447492c0e375d8ede0b",
        "message": "NPE protection.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624874 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_4",
        "file": [
            {
                "sha": "8332da18477889ad56cfb385ecbabdeda2ffd7e1",
                "filename": "src/com/ecyrd/jspwiki/tags/DiffLinkTag.java",
                "status": "modified",
                "additions": 6,
                "deletions": 4,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/58bcb0f69dd7a7b4985df468770cc636c3045614/src/com/ecyrd/jspwiki/tags/DiffLinkTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/58bcb0f69dd7a7b4985df468770cc636c3045614/src/com/ecyrd/jspwiki/tags/DiffLinkTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/tags/DiffLinkTag.java?ref=58bcb0f69dd7a7b4985df468770cc636c3045614",
                "patch": "@@ -22,10 +22,7 @@\n import java.io.IOException;\n import javax.servlet.jsp.JspWriter;\n \n-import com.ecyrd.jspwiki.WikiContext;\n-import com.ecyrd.jspwiki.WikiEngine;\n-import com.ecyrd.jspwiki.WikiPage;\n-import com.ecyrd.jspwiki.WikiProvider;\n+import com.ecyrd.jspwiki.*;\n \n /**\n  *  Writes a diff link.  Body of the link becomes the link text.\n@@ -113,6 +110,11 @@ public final int doWikiStartTag()\n             WikiPage latest = engine.getPage( pageName, \n                                               WikiProvider.LATEST_VERSION );\n \n+            if( latest == null )\n+            {\n+                // This may occur if matchEnglishPlurals is on, and we access the wrong page name\n+                return SKIP_BODY;\n+            }\n             r1 = latest.getVersion();\n         }\n         else if( VER_PREVIOUS.equals(getVersion()) )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/459dc40992b5b79537e44019deb9dc69ed7c541b",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/e922ff712809118bafcd5971e5d113fda66a429a",
        "message": "JSPWIKI-822 - NPE thrown by PluginContext#getText()\n\ngit-svn-id: https://svn.apache.org/repos/asf/jspwiki/trunk@1589237 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_5",
        "file": [
            {
                "sha": "6923aef401b6f67de2941e3982733e75dab1c554",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/parser/PluginContent.java",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/459dc40992b5b79537e44019deb9dc69ed7c541b/jspwiki-war/src/main/java/org/apache/wiki/parser/PluginContent.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/459dc40992b5b79537e44019deb9dc69ed7c541b/jspwiki-war/src/main/java/org/apache/wiki/parser/PluginContent.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/parser/PluginContent.java?ref=459dc40992b5b79537e44019deb9dc69ed7c541b",
                "patch": "@@ -146,6 +146,11 @@ public String getText() {\n         }\n \n         WikiContext context = doc.getContext();\n+        \n+        if( context == null ) {\n+            log.info( \"WikiContext garbage-collected, cannot proceed\" );\n+            return getPluginName();\n+        }\n \n         Boolean wysiwygVariable = (Boolean) context.getVariable(RenderingManager.WYSIWYG_EDITOR_MODE);\n         boolean wysiwygEditorMode = false;"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/ab8c7fb529af8cb4e6f9e65094a1dbec6dbf7db7",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/d8b8f4b8ce9828afb9a418ed69da498f4596eca8",
        "message": "added some log messages and firing a FileNotFoundException if the policy file isn't found, in order to get a  meaningful exception on the log file instead of a NullPointerException on startup\n\ngit-svn-id: https://svn.apache.org/repos/asf/jspwiki/trunk@1592420 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_6",
        "file": [
            {
                "sha": "de726806dda36a7db101d1826dd01a42b2c06f2a",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/auth/AuthenticationManager.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/ab8c7fb529af8cb4e6f9e65094a1dbec6dbf7db7/jspwiki-war/src/main/java/org/apache/wiki/auth/AuthenticationManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/ab8c7fb529af8cb4e6f9e65094a1dbec6dbf7db7/jspwiki-war/src/main/java/org/apache/wiki/auth/AuthenticationManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/auth/AuthenticationManager.java?ref=ab8c7fb529af8cb4e6f9e65094a1dbec6dbf7db7",
                "patch": "@@ -19,6 +19,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n package org.apache.wiki.auth;\n \n import java.io.File;\n+import java.io.FileNotFoundException;\n import java.io.FileOutputStream;\n import java.io.IOException;\n import java.io.InputStream;\n@@ -606,6 +607,7 @@ public static boolean isUserPrincipal( Principal principal )\n      */\n     protected static URL findConfigFile( WikiEngine engine, String name )\n     {\n+        log.info( \"looking for \" + name + \" inside WEB-INF \" );\n         // Try creating an absolute path first\n         File defaultFile = null;\n         if( engine.getRootPath() != null )\n@@ -636,9 +638,13 @@ protected static URL findConfigFile( WikiEngine engine, String name )\n         \tInputStream is = null;\n             try\n             {\n+                log.info( \"looking for /\" + name + \" on classpath\" );\n                 //  create a tmp file of the policy loaded as an InputStream and return the URL to it\n                 //  \n                 is = AuthenticationManager.class.getResourceAsStream( \"/\" + name );\n+                if( is == null ) {\n+                    throw new FileNotFoundException( name + \" not found\" );\n+                }\n                 File tmpFile = File.createTempFile( \"temp.\" + name, \"\" );\n                 tmpFile.deleteOnExit();\n "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/2a8830768fdd82af33f82f9583fbf80e49e68428",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/ba01d4e5f1f180f535c99260b75229cf160d29d5",
        "message": "[JSPWIKI-599]: fixed NPEs in DefaultWikiContext.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@811981 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_7",
        "file": [
            {
                "sha": "0c93d404879f31a851cc644b82fe86e0c97c7cf2",
                "filename": "src/java/org/apache/wiki/ui/stripes/DefaultWikiContext.java",
                "status": "modified",
                "additions": 2,
                "deletions": 2,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/2a8830768fdd82af33f82f9583fbf80e49e68428/src/java/org/apache/wiki/ui/stripes/DefaultWikiContext.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/2a8830768fdd82af33f82f9583fbf80e49e68428/src/java/org/apache/wiki/ui/stripes/DefaultWikiContext.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/ui/stripes/DefaultWikiContext.java?ref=2a8830768fdd82af33f82f9583fbf80e49e68428",
                "patch": "@@ -129,8 +129,8 @@ public WikiContext deepClone()\n             copy.m_variableMap = (HashMap<String, Object>) m_variableMap.clone();\n             copy.m_request = m_request;\n             copy.m_session = m_session;\n-            copy.m_page = (WikiPage) m_page.clone();\n-            copy.m_realPage = (WikiPage) m_realPage.clone();\n+            copy.m_page = m_page == null ? null : (WikiPage) m_page.clone();\n+            copy.m_realPage = m_realPage == null ? null : (WikiPage) m_realPage.clone();\n             return copy;\n         }\n         catch( CloneNotSupportedException e )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/033b3a393587ba8d0c7907c5c1ffc17803a490f2",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/5e17dad6f6cacb943c69fb352706a7f32f63bbe0",
        "message": "Fixed NPE in JCRWikiPage.getLastModified().\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@772036 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_8",
        "file": [
            {
                "sha": "84b159a964c6cc67f9188bb36e9ec241a4fb455a",
                "filename": "src/java/org/apache/wiki/JCRWikiPage.java",
                "status": "modified",
                "additions": 6,
                "deletions": 2,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/033b3a393587ba8d0c7907c5c1ffc17803a490f2/src/java/org/apache/wiki/JCRWikiPage.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/033b3a393587ba8d0c7907c5c1ffc17803a490f2/src/java/org/apache/wiki/JCRWikiPage.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/JCRWikiPage.java?ref=033b3a393587ba8d0c7907c5c1ffc17803a490f2",
                "patch": "@@ -225,7 +225,10 @@ public Date getLastModified()\n     {\n         try\n         {\n-            return getJCRNode().getProperty( LASTMODIFIED ).getDate().getTime();\n+            if ( getJCRNode().hasProperty( LASTMODIFIED ) )\n+            {\n+                return getJCRNode().getProperty( LASTMODIFIED ).getDate().getTime();\n+            }\n         }\n         catch( RepositoryException e )\n         {\n@@ -609,4 +612,5 @@ public boolean isAttachment() throws ProviderException\n         \n         return pages;\n     }\n-}\n+    \n+}\n\\ No newline at end of file"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/3726562e763bcfe2ac76cecd56b8d0519651da8c",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/eb26d0c63f5ed98f608e990b396da32a8c11ba85",
        "message": "Fixed NPE in PermissionTag.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@766534 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_9",
        "file": [
            {
                "sha": "219fbbdf4038f76b7e29b880a601ac219f55dd39",
                "filename": "src/java/org/apache/wiki/tags/PermissionTag.java",
                "status": "modified",
                "additions": 9,
                "deletions": 4,
                "changes": 13,
                "blob_url": "https://github.com/apache/jspwiki/blob/3726562e763bcfe2ac76cecd56b8d0519651da8c/src/java/org/apache/wiki/tags/PermissionTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/3726562e763bcfe2ac76cecd56b8d0519651da8c/src/java/org/apache/wiki/tags/PermissionTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/tags/PermissionTag.java?ref=3726562e763bcfe2ac76cecd56b8d0519651da8c",
                "patch": "@@ -24,6 +24,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n import java.security.Permission;\n \n import org.apache.commons.lang.StringUtils;\n+import org.apache.wiki.WikiEngine;\n import org.apache.wiki.WikiProvider;\n import org.apache.wiki.WikiSession;\n import org.apache.wiki.action.GroupActionBean;\n@@ -152,11 +153,15 @@ else if ( page != null )\n             {\n                 try\n                 {\n-                    WikiPage latest = m_wikiContext.getEngine().getPage( page.getName() );\n-                    if( page.getVersion() != WikiProvider.LATEST_VERSION &&\n-                        latest.getVersion() != page.getVersion() )\n+                    WikiEngine engine = m_wikiContext.getEngine();\n+                    if ( engine.pageExists( page ) )\n                     {\n-                        return false;\n+                        WikiPage latest = engine.getPage( page.getName() );\n+                        if( page.getVersion() != WikiProvider.LATEST_VERSION &&\n+                            latest.getVersion() != page.getVersion() )\n+                        {\n+                            return false;\n+                        }\n                     }\n                 }\n                 catch( Exception e )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/2a3c735537a7f87c5d803f638aed83ad2b17a75e",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/196f98833e92628b1220f6452b38b5db1de0e2a9",
        "message": "Fixed NPE in VariableManager.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@766530 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_10",
        "file": [
            {
                "sha": "a3eb194965caec5e70ba4f7ba41ee95ac1ba2824",
                "filename": "src/java/org/apache/wiki/NoSuchVariableException.java",
                "status": "modified",
                "additions": 18,
                "deletions": 8,
                "changes": 26,
                "blob_url": "https://github.com/apache/jspwiki/blob/2a3c735537a7f87c5d803f638aed83ad2b17a75e/src/java/org/apache/wiki/NoSuchVariableException.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/2a3c735537a7f87c5d803f638aed83ad2b17a75e/src/java/org/apache/wiki/NoSuchVariableException.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/NoSuchVariableException.java?ref=2a3c735537a7f87c5d803f638aed83ad2b17a75e",
                "patch": "@@ -23,20 +23,30 @@ Licensed to the Apache Software Foundation (ASF) under one\n import org.apache.wiki.api.WikiException;\n \n /**\n- *  Marks that no such variable was located.\n+ * Marks that no such variable was located.\n  */\n-public class NoSuchVariableException\n-    extends WikiException\n+public class NoSuchVariableException extends WikiException\n {\n-    private static final long          serialVersionUID = 1L;\n+    private static final long serialVersionUID = 1L;\n \n     /**\n-     *  Constructs an exception.\n-     *\n-     *  @param msg Message to show\n+     * Constructs an exception.\n+     * \n+     * @param msg Message to show\n      */\n     public NoSuchVariableException( String msg )\n     {\n-        super(msg);\n+        super( msg );\n+    }\n+\n+    /**\n+     * Constructs an exception.\n+     * \n+     * @param msg Message to show\n+     * @param cause the cause of the exception\n+     */\n+    public NoSuchVariableException( String msg, Throwable cause )\n+    {\n+        super( msg, cause );\n     }\n }"
            },
            {
                "sha": "012280db0e6e95e5a715cd85eb083f08af8d2f5f",
                "filename": "src/java/org/apache/wiki/VariableManager.java",
                "status": "modified",
                "additions": 3,
                "deletions": 2,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/2a3c735537a7f87c5d803f638aed83ad2b17a75e/src/java/org/apache/wiki/VariableManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/2a3c735537a7f87c5d803f638aed83ad2b17a75e/src/java/org/apache/wiki/VariableManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/VariableManager.java?ref=2a3c735537a7f87c5d803f638aed83ad2b17a75e",
                "patch": "@@ -388,7 +388,7 @@ public String getValue( WikiContext context,\n         }\n         catch( Exception e )\n         {\n-            log.info(\"Interesting exception: cannot fetch variable value\",e);\n+            log.info( \"Interesting exception: cannot fetch variable value '\" + varName + \"'.\", e );\n         }\n         return \"\";\n     }\n@@ -420,7 +420,8 @@ public SystemVariables(WikiContext context)\n \n         public String getPagename()\n         {\n-            return m_context.getPage().getName();\n+            WikiPage page = m_context.getPage();\n+            return page == null ? null : page.getName();\n         }\n \n         public String getApplicationname()"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/94f507bbe55b1fdf1499f9639efe87378c71c352",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/bf7227a6c1028675355933c4fc24aceda43bb07e",
        "message": "Bug fix: Fixed potential NPEs in LoggerImpl.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@730421 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_11",
        "file": [
            {
                "sha": "72de8931bd5c018c172bed3fb237bd79ccdf1761",
                "filename": "src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "status": "modified",
                "additions": 4,
                "deletions": 4,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/94f507bbe55b1fdf1499f9639efe87378c71c352/src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/94f507bbe55b1fdf1499f9639efe87378c71c352/src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/log/LoggerImpl.java?ref=94f507bbe55b1fdf1499f9639efe87378c71c352",
                "patch": "@@ -143,24 +143,24 @@ public void debug( String string, Throwable t, Object... params )\n     /** {@inheritDoc} */\n     public boolean isErrorEnabled()\n     {\n-        return m_slf4jLogger.isErrorEnabled();\n+        return m_slf4jLogger == null ? false : m_slf4jLogger.isErrorEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isWarnEnabled()\n     {\n-        return m_slf4jLogger.isWarnEnabled();\n+        return m_slf4jLogger == null ? false : m_slf4jLogger.isWarnEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isInfoEnabled()\n     {\n-        return m_slf4jLogger.isInfoEnabled();\n+        return m_slf4jLogger == null ? false : m_slf4jLogger.isInfoEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isDebugEnabled()\n     {\n-        return m_slf4jLogger.isDebugEnabled();\n+        return m_slf4jLogger == null ? false : m_slf4jLogger.isDebugEnabled();\n     }\n }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/2caf9ecff448a4f366c49c34630d1ad9f60b5e22",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/d1695b71b2441b3c593cbe0e0f13f03cc2fd7205",
        "message": "JSPWIKI-326: Fixed NPE in ProfanityFilter.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@681274 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_12",
        "file": [
            {
                "sha": "df5c3dfedce54ba820ba9dd4db0823cdbf84ae06",
                "filename": "src/com/ecyrd/jspwiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/2caf9ecff448a4f366c49c34630d1ad9f60b5e22/src/com/ecyrd/jspwiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/2caf9ecff448a4f366c49c34630d1ad9f60b5e22/src/com/ecyrd/jspwiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/Release.java?ref=2caf9ecff448a4f366c49c34630d1ad9f60b5e22",
                "patch": "@@ -77,7 +77,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"5\";\n+    public static final String     BUILD         = \"6\";\n     \n     /**\n      *  This is the generic version string you should use"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/d1695b71b2441b3c593cbe0e0f13f03cc2fd7205",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/ce8237bd26cf478cbb3b1b1193400e88ec6c29cd",
        "message": "JSPWIKI-326: Fixed NPE in ProfanityFilter.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@681273 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_13",
        "file": [
            {
                "sha": "c59a2ddbaa3e3811295acac522469b50b294dbbb",
                "filename": "src/com/ecyrd/jspwiki/filters/ProfanityFilter.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/d1695b71b2441b3c593cbe0e0f13f03cc2fd7205/src/com/ecyrd/jspwiki/filters/ProfanityFilter.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/d1695b71b2441b3c593cbe0e0f13f03cc2fd7205/src/com/ecyrd/jspwiki/filters/ProfanityFilter.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/filters/ProfanityFilter.java?ref=d1695b71b2441b3c593cbe0e0f13f03cc2fd7205",
                "patch": "@@ -44,7 +44,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private static Logger     log = Logger.getLogger(ProfanityFilter.class);\n     \n     private static final String PROPERTYFILE = \"com/ecyrd/jspwiki/filters/profanity.properties\";\n-    private static String[] c_profanities;\n+    private static String[] c_profanities = new String[0];\n     \n     static \n     {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/ce8237bd26cf478cbb3b1b1193400e88ec6c29cd",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/efdfdc632826abe317350975aa58777f9074e4fa",
        "message": "JSPWIKI-326: Fixed NPE in ProfanityFilter.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@681272 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_14",
        "file": [
            {
                "sha": "8f28b490b89c63a9cc84f6297e73208996138571",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/ce8237bd26cf478cbb3b1b1193400e88ec6c29cd/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/ce8237bd26cf478cbb3b1b1193400e88ec6c29cd/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=ce8237bd26cf478cbb3b1b1193400e88ec6c29cd",
                "patch": "@@ -1,3 +1,9 @@\n+2008-07-31  Andrew Jaquith <ajaquith AT apache DOT org>\n+\n+        * 2.7.0-alpha-6\n+\n+        * JSPWIKI-326: Fixed NPE in ProfanityFilter.\n+\n 2008-07-16  Andrew Jaquith <ajaquith AT apache DOT org>\n \n         * 2.7.0-alpha-5"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/57930cf6a4b922b45d5cd00cde09f999ea07b4a1",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/75fe691b22abb8ce599262304c6cd6188d6486a0",
        "message": "JSPWIKI-185: No more NPEs.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@667786 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_15",
        "file": [
            {
                "sha": "e7226bd5bd64839b75012db0d20591fcb5e40f10",
                "filename": "src/com/ecyrd/jspwiki/util/WatchDog.java",
                "status": "modified",
                "additions": 3,
                "deletions": 1,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/57930cf6a4b922b45d5cd00cde09f999ea07b4a1/src/com/ecyrd/jspwiki/util/WatchDog.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/57930cf6a4b922b45d5cd00cde09f999ea07b4a1/src/com/ecyrd/jspwiki/util/WatchDog.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/util/WatchDog.java?ref=57930cf6a4b922b45d5cd00cde09f999ea07b4a1",
                "patch": "@@ -54,7 +54,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private boolean   m_enabled    = true;\n     private WikiEngine m_engine;\n \n-    private static Logger log = Logger.getLogger(WatchDog.class.getName());\n+    private Logger log = Logger.getLogger(WatchDog.class.getName());\n \n     private static HashMap<Integer,WeakReference<WatchDog>> c_kennel = \n         new HashMap<Integer,WeakReference<WatchDog>>();\n@@ -372,6 +372,8 @@ public void shutdownTask()\n          */\n         public void backgroundTask() throws Exception\n         {\n+            if( c_kennel == null ) return;\n+            \n             synchronized( c_kennel )\n             {\n                 for( Iterator i = c_kennel.entrySet().iterator(); i.hasNext(); )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/fb01730d19df6f1365b155d4edfaa5e3666def5a",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/556921e3c963c2bf8aa124636aab212fb2d3c660",
        "message": "NPE if author was null.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626898 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_16",
        "file": [
            {
                "sha": "bd6a5ba8ab2cd11eb0769bb1979a73a0a5145045",
                "filename": "src/com/ecyrd/jspwiki/tags/AuthorTag.java",
                "status": "modified",
                "additions": 3,
                "deletions": 2,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/fb01730d19df6f1365b155d4edfaa5e3666def5a/src/com/ecyrd/jspwiki/tags/AuthorTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/fb01730d19df6f1365b155d4edfaa5e3666def5a/src/com/ecyrd/jspwiki/tags/AuthorTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/tags/AuthorTag.java?ref=fb01730d19df6f1365b155d4edfaa5e3666def5a",
                "patch": "@@ -46,10 +46,11 @@ public final int doWikiStartTag()\n         WikiEngine engine = m_wikiContext.getEngine();\n         WikiPage   page   = m_wikiContext.getPage();\n \n-        String author = TextUtil.replaceEntities( page.getAuthor() );\n+        String author = page.getAuthor();\n \n         if( author != null && author.length() > 0 )\n         {\n+            author = TextUtil.replaceEntities(author);\n             if( engine.pageExists(author) )\n             {\n                 // FIXME: It's very boring to have to do this.\n@@ -63,8 +64,8 @@ public final int doWikiStartTag()\n                 \n                 author = mgr.getHTML( m_wikiContext, d );\n             }\n-            pageContext.getOut().print( author );\n \n+            pageContext.getOut().print( author );\n         }\n         else\n         {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/b8caf6e19ffde4ff68da007a34bde02b216110d2",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/0e32a2fdf4d521ecf5dd9bf200848b7a9ae54f68",
        "message": "Added patch from Dave Wolf to fix an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626883 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_17",
        "file": [
            {
                "sha": "5e87506ea950e85ef008deea9bb6df36cdd33dcf",
                "filename": "src/com/ecyrd/jspwiki/auth/AuthorizationManager.java",
                "status": "modified",
                "additions": 19,
                "deletions": 4,
                "changes": 23,
                "blob_url": "https://github.com/apache/jspwiki/blob/b8caf6e19ffde4ff68da007a34bde02b216110d2/src/com/ecyrd/jspwiki/auth/AuthorizationManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/b8caf6e19ffde4ff68da007a34bde02b216110d2/src/com/ecyrd/jspwiki/auth/AuthorizationManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/AuthorizationManager.java?ref=b8caf6e19ffde4ff68da007a34bde02b216110d2",
                "patch": "@@ -405,10 +405,25 @@ public final void initialize( WikiEngine engine, Properties properties ) throws\n         try\n         {\n             URL policyURL = AuthenticationManager.findConfigFile( engine, DEFAULT_POLICY );\n-            File policyFile = new File( policyURL.getPath() );\n-            m_localPolicy = new LocalPolicy( policyFile, engine.getContentEncoding() );\n-            m_localPolicy.refresh();\n-            log.info(\"Initialized local security policy: \" + policyFile.getAbsolutePath());\n+            \n+            if (policyURL != null) \n+            {\n+                File policyFile = new File( policyURL.getPath() );\n+                m_localPolicy = new LocalPolicy( policyFile, engine.getContentEncoding() );\n+                m_localPolicy.refresh();\n+                log.info(\"Initialized default security policy: \" + policyFile.getAbsolutePath());\n+            }\n+            else\n+            {\n+                StringBuffer sb = new StringBuffer(\"JSPWiki was unable to initialize the \");\n+                sb.append(\"default security policy (WEB-INF/jspwiki.policy) file. \");\n+                sb.append(\"Please ensure that the jspwiki.policy file exists in the default location. \");\n+                sb.append(\"This file should exist regardless of the existance of a global policy file. \");\n+                sb.append(\"The global policy file is identified by the java.security.policy variable. \");\n+                WikiSecurityException wse = new WikiSecurityException(sb.toString());\n+                log.fatal(sb.toString(), wse);\n+                throw wse;\n+            }\n         }\n         catch ( PolicyException e )\n         {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/46d373c0d48b8a35b3ff5a0e1ff9193fb8a582f7",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/b6ec4762a458af9e72bdd159742b17ffc004d71c",
        "message": "Fixed NPE in shutdown.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626809 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_18",
        "file": [
            {
                "sha": "b35cf30cf5a221b9e7e8f0f4cfdbb58db1c1061a",
                "filename": "src/com/ecyrd/jspwiki/util/WatchDog.java",
                "status": "modified",
                "additions": 9,
                "deletions": 1,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/46d373c0d48b8a35b3ff5a0e1ff9193fb8a582f7/src/com/ecyrd/jspwiki/util/WatchDog.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/46d373c0d48b8a35b3ff5a0e1ff9193fb8a582f7/src/com/ecyrd/jspwiki/util/WatchDog.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/util/WatchDog.java?ref=46d373c0d48b8a35b3ff5a0e1ff9193fb8a582f7",
                "patch": "@@ -132,6 +132,14 @@ public WatchDog(WikiEngine engine, Thread thread)\n      */\n     private static void scrub()\n     {\n+        //\n+        //  During finalization, the object may already be cleared (depending\n+        //  on the finalization order).  Therefore, it's possible that this\n+        //  method is called from another thread after the WatchDog itself\n+        //  has been cleared.\n+        //\n+        if( c_kennel == null ) return;\n+\n         synchronized( c_kennel )\n         {\n             for( Iterator i = c_kennel.entrySet().iterator(); i.hasNext(); )\n@@ -310,7 +318,7 @@ private void check()\n \n     /**\n      *  Strictly for debugging/informative purposes.\n-     *  \n+     *\n      *  @return Random ramblings.\n      */\n     public String toString()"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/fb2f97c214dd28c4dbe8d02a062b1aff46ae9110",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/82126f8abf3d9f77bbf9c87e438b2e4a0bac91a2",
        "message": "Fixed an NPE when adding HTTP_RESOURCE\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626596 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_19",
        "file": [
            {
                "sha": "9426708a248e8839eb4939a18c829522d170770c",
                "filename": "src/com/ecyrd/jspwiki/ui/TemplateManager.java",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/fb2f97c214dd28c4dbe8d02a062b1aff46ae9110/src/com/ecyrd/jspwiki/ui/TemplateManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/fb2f97c214dd28c4dbe8d02a062b1aff46ae9110/src/com/ecyrd/jspwiki/ui/TemplateManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/ui/TemplateManager.java?ref=fb2f97c214dd28c4dbe8d02a062b1aff46ae9110",
                "patch": "@@ -477,6 +477,10 @@ else if( type.equals(RESOURCE_JSFUNCTION) )\n         {\n             resourceString = resource;\n         }\n+        else if( type.equals(RESOURCE_HTTPHEADER) )\n+        {\n+            resourceString = resource;\n+        }\n \n         if( resourceString != null )\n         {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/7383dbe233fd0a37d2864606f4d02c151fe0d3e7",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/a69bd31fe5033acc6ab0e1152e587ac1f4870f98",
        "message": "Patch from Murray to fix an NPE in replaceString()\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625823 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_20",
        "file": [
            {
                "sha": "f0cfafb1f1559af52e0cdf2022215b83c3a1b822",
                "filename": "src/com/ecyrd/jspwiki/TextUtil.java",
                "status": "modified",
                "additions": 5,
                "deletions": 4,
                "changes": 9,
                "blob_url": "https://github.com/apache/jspwiki/blob/7383dbe233fd0a37d2864606f4d02c151fe0d3e7/src/com/ecyrd/jspwiki/TextUtil.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7383dbe233fd0a37d2864606f4d02c151fe0d3e7/src/com/ecyrd/jspwiki/TextUtil.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/TextUtil.java?ref=7383dbe233fd0a37d2864606f4d02c151fe0d3e7",
                "patch": "@@ -264,15 +264,16 @@ public static String replaceEntities( String src )\n      *  @param src  The string to find.\n      *  @param dest The string to replace <I>src</I> with.\n      */\n-\n-    public static String replaceString( String orig, String src, String dest )\n+    public final static String replaceString( String orig, String src, String dest )\n     {\n-        if( orig == null ) return null;\n+        if ( orig == null ) return null;\n+        if ( src == null || dest == null ) throw new NullPointerException();\n+        if ( src.length() == 0 ) return orig;\n \n         StringBuffer res = new StringBuffer();\n         int start, end = 0, last = 0;\n \n-        while( (start = orig.indexOf(src,end)) != -1 )\n+        while ( (start = orig.indexOf(src,end)) != -1 )\n         {\n             res.append( orig.substring( last, start ) );\n             res.append( dest );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/425705a727dd88d84309b2e569cef6e597643bd7",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/2a6d14af1fdd436faa112b79e8dc7a2b4ca69ae6",
        "message": "Fixed erroneus redirect causing NPEs\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625316 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_21",
        "file": [
            {
                "sha": "8b1b9d68a564e6a60c4ca5f2ca07ca972a45c1e0",
                "filename": "src/webdocs/NewGroup.jsp",
                "status": "modified",
                "additions": 6,
                "deletions": 1,
                "changes": 7,
                "blob_url": "https://github.com/apache/jspwiki/blob/425705a727dd88d84309b2e569cef6e597643bd7/src/webdocs/NewGroup.jsp",
                "raw_url": "https://github.com/apache/jspwiki/raw/425705a727dd88d84309b2e569cef6e597643bd7/src/webdocs/NewGroup.jsp",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/NewGroup.jsp?ref=425705a727dd88d84309b2e569cef6e597643bd7",
                "patch": "@@ -83,8 +83,13 @@\n                 response.sendRedirect( ex.getRedirect() );\n                 return;\n             }\n+\t\t\t\n+            //Moved redirect.  This fixed the issue of redirecting once the group has been created\n+            //a null recirect causes a NullPointerException\n+            response.sendRedirect( wikiContext.getURL(WikiContext.VIEW, groupContext.getPage().getName()) );\n+\n         }\n-        response.sendRedirect( wikiContext.getURL(WikiContext.VIEW,null) );\n+    \n     }\n     \n     pageContext.setAttribute( \"name\", name, PageContext.REQUEST_SCOPE );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/6f17cb7e3910248f1846a82b21a49444fbc3dcaa",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/599a2e20b75057ac1e5cd2c1b3f87eeeac2ae5be",
        "message": "pageRemoved would sometimes throw an NPE.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625313 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_22",
        "file": [
            {
                "sha": "60c7d6e37ffaf17d4448bfa7bf2f091c26fea1cf",
                "filename": "src/com/ecyrd/jspwiki/ReferenceManager.java",
                "status": "modified",
                "additions": 21,
                "deletions": 17,
                "changes": 38,
                "blob_url": "https://github.com/apache/jspwiki/blob/6f17cb7e3910248f1846a82b21a49444fbc3dcaa/src/com/ecyrd/jspwiki/ReferenceManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/6f17cb7e3910248f1846a82b21a49444fbc3dcaa/src/com/ecyrd/jspwiki/ReferenceManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/ReferenceManager.java?ref=6f17cb7e3910248f1846a82b21a49444fbc3dcaa",
                "patch": "@@ -568,31 +568,35 @@ public synchronized void pageRemoved( WikiPage page )\n     {\n         String pageName = page.getName();\n         \n-        Collection RefTo = (Collection)m_refersTo.get( pageName );\n-        Iterator it_refTo = RefTo.iterator();\n-        while( it_refTo.hasNext() )\n+        Collection refTo = (Collection)m_refersTo.get( pageName );\n+        \n+        if( refTo != null )\n         {\n-            String referredPageName = (String)it_refTo.next();\n-            Set refBy = (Set)m_referredBy.get( referredPageName );\n+            Iterator it_refTo = refTo.iterator();\n+            while( it_refTo.hasNext() )\n+            {\n+                String referredPageName = (String)it_refTo.next();\n+                Set refBy = (Set)m_referredBy.get( referredPageName );\n \n-            if( refBy == null )\n-                throw new InternalWikiException(\"Refmgr out of sync: page \"+pageName+\" refers to \"+referredPageName+\", which has null referrers.\");\n+                if( refBy == null )\n+                    throw new InternalWikiException(\"Refmgr out of sync: page \"+pageName+\" refers to \"+referredPageName+\", which has null referrers.\");\n \n-            refBy.remove(pageName);\n+                refBy.remove(pageName);\n             \n-            m_referredBy.remove( referredPageName );\n+                m_referredBy.remove( referredPageName );\n             \n-            // We won't put it back again if it becomes empty and does not exist.  It will be added\n-            // later on anyway, if it becomes referenced again.\n-            if( !(refBy.isEmpty() && !m_engine.pageExists(referredPageName)) )\n-            {\n-                m_referredBy.put( referredPageName, refBy );\n+                // We won't put it back again if it becomes empty and does not exist.  It will be added\n+                // later on anyway, if it becomes referenced again.\n+                if( !(refBy.isEmpty() && !m_engine.pageExists(referredPageName)) )\n+                {\n+                    m_referredBy.put( referredPageName, refBy );\n+                }\n             }\n+            \n+            log.debug(\"Removing from m_refersTo HashMap key:value \"+pageName+\":\"+m_refersTo.get( pageName ));\n+            m_refersTo.remove( pageName );\n         }\n \n-        log.debug(\"Removing from m_refersTo HashMap key:value \"+pageName+\":\"+m_refersTo.get( pageName ));\n-        m_refersTo.remove( pageName );\n-        \n         Set refBy = (Set) m_referredBy.get( pageName );\n         if( refBy == null || refBy.isEmpty() )\n         {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/a81451f748a8264e68b63c532fae3d713d4106e1",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/f6f6fecb24b6aecbc0a31372f2f50cd98199be47",
        "message": "Fixed npe in HighlightWord\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624877 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_23",
        "file": [
            {
                "sha": "27602338769ce79a503f6858faea2ca546af8bfc",
                "filename": "src/webdocs/scripts/jspwiki-common.js",
                "status": "modified",
                "additions": 1,
                "deletions": 0,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/a81451f748a8264e68b63c532fae3d713d4106e1/src/webdocs/scripts/jspwiki-common.js",
                "raw_url": "https://github.com/apache/jspwiki/raw/a81451f748a8264e68b63c532fae3d713d4106e1/src/webdocs/scripts/jspwiki-common.js",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/scripts/jspwiki-common.js?ref=a81451f748a8264e68b63c532fae3d713d4106e1",
                "patch": "@@ -526,6 +526,7 @@ HighlightWord.onPageLoad = function ()\n // recursive tree walk matching all text nodes\n HighlightWord.walkDomTree = function( node )\n {\n+  if(!node) return;\n   var nn = null; \n   for( var n = node.firstChild; n ; n = nn )\n   {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/ef0184e4367dac4b92a43d4bdf196bdcfee770c9",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/fbda02884b67794464cc86624c894437bc0734ba",
        "message": "Changed PagePermission constructor; fixed NPE for equals().\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624574 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_24",
        "file": [
            {
                "sha": "2120c7b179d18eca3a598185df8fad920a4d83a4",
                "filename": "src/com/ecyrd/jspwiki/auth/permissions/PagePermission.java",
                "status": "modified",
                "additions": 6,
                "deletions": 12,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/ef0184e4367dac4b92a43d4bdf196bdcfee770c9/src/com/ecyrd/jspwiki/auth/permissions/PagePermission.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/ef0184e4367dac4b92a43d4bdf196bdcfee770c9/src/com/ecyrd/jspwiki/auth/permissions/PagePermission.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/permissions/PagePermission.java?ref=ef0184e4367dac4b92a43d4bdf196bdcfee770c9",
                "patch": "@@ -37,7 +37,7 @@\n  * <i>never </i> imply others.\n  * </p>\n  * @author Andrew Jaquith\n- * @version $Revision: 1.4 $ $Date: 2005-09-02 23:47:52 $\n+ * @version $Revision: 1.5 $ $Date: 2005-09-17 18:21:06 $\n  * @since 2.3\n  */\n public final class PagePermission extends Permission\n@@ -151,9 +151,9 @@ public PagePermission( String page, String actions )\n      * @param page\n      * @param actions\n      */\n-    public PagePermission( String wiki, WikiPage page, String actions )\n+    public PagePermission( WikiPage page, String actions )\n     {\n-        this( wiki + WIKI_SEPARATOR + page.getName(), actions );\n+        this( page.getWiki() + WIKI_SEPARATOR + page.getName(), actions );\n     }\n \n     /**\n@@ -169,7 +169,7 @@ public final boolean equals( Object obj )\n         }\n         PagePermission p = (PagePermission) obj;\n         return ( p.m_mask == m_mask && p.m_page.equals( m_page ) \n-                 && p.m_wiki.equals( m_wiki ));\n+                 && p.m_wiki != null && p.m_wiki.equals( m_wiki ));\n     }\n \n     /**\n@@ -208,13 +208,7 @@ public final String getWiki()\n      */\n     public final int hashCode()\n     {\n-        int hash = m_mask;\n-        String actions = getActions();\n-        for( int i = 0; i < actions.length(); i++ )\n-        {\n-            hash += 13 * actions.hashCode();\n-        }\n-        return hash;\n+        return m_mask + ( ( 13 * m_actionString.hashCode() ) * 23 * m_wiki.hashCode() );\n     }\n \n     /**\n@@ -330,7 +324,7 @@ protected static final int impliedMask( int mask )\n      * @return the results of the test, where <code>true</code> indicates that\n      *         <code>subSet</code> is a subset of <code>superSet</code>\n      */\n-    protected final boolean isSubset( String superSet, String subSet )\n+    protected static final boolean isSubset( String superSet, String subSet )\n     {\n         // If either is null, return false\n         if ( superSet == null || subSet == null )"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/b7da11c6ff852ec819efe62289f838656560b7b9",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/fae29065b575d9156744ae05bc3e41e23cad0310",
        "message": "Fixed a couple of NPEs if the current user == null.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624328 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_25",
        "file": [
            {
                "sha": "d23b65ac9d6e4f9805bac9f0bf3970351711210c",
                "filename": "src/webdocs/Wiki.jsp",
                "status": "modified",
                "additions": 6,
                "deletions": 5,
                "changes": 11,
                "blob_url": "https://github.com/apache/jspwiki/blob/b7da11c6ff852ec819efe62289f838656560b7b9/src/webdocs/Wiki.jsp",
                "raw_url": "https://github.com/apache/jspwiki/raw/b7da11c6ff852ec819efe62289f838656560b7b9/src/webdocs/Wiki.jsp",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/Wiki.jsp?ref=b7da11c6ff852ec819efe62289f838656560b7b9",
                "patch": "@@ -11,7 +11,7 @@\n     {\n         wiki = WikiEngine.getInstance( getServletConfig() );\n     }\n-    Category log = Category.getInstance(\"JSPWiki\"); \n+    Logger log = Logger.getLogger(\"JSPWiki\"); \n     WikiEngine wiki;\n \n %><%\n@@ -21,7 +21,8 @@\n \n     NDC.push( wiki.getApplicationName()+\":\"+pagereq );\n     \n-    log.info(\"Request for page '\"+pagereq+\"' from \"+request.getRemoteAddr()+\" by \"+wikiContext.getCurrentUser().getName() );\n+    log.info(\"Request for page '\"+pagereq+\"' from \"+request.getRemoteAddr()+\n+    \t\t \" by \"+(wikiContext.getCurrentUser() != null ? wikiContext.getCurrentUser().getName() : \"unknown user\") );\n \n     String redirect = wiki.getRedirectURL( wikiContext );\n \n@@ -33,7 +34,7 @@\n \n     AuthenticationManager authMgr = wiki.getAuthenticationManager();\n     AuthorizationManager mgr = wiki.getAuthorizationManager();\n-    Principal currentUser  = wikiContext.getWikiSession().getUserPrincipal();\n+    Principal currentUser  = wikiContext.getCurrentUser();\n \n     if( !mgr.checkPermission( wikiContext,\n                               new PagePermission( pagereq, \"view\" ) ) )\n@@ -44,7 +45,7 @@\n             String msg = \"Unknown user or password.<br>Please try again.\";\n             session.setAttribute( \"msg\", msg );\n             String pageurl = wiki.encodeName( pagereq );\n-            response.sendRedirect( wiki.getBaseURL()+\"Login.jsp?page=\"+pageurl );\n+            response.sendRedirect( wikiContext.getURL( WikiContext.LOGIN, pageurl ) );\n             return;\n         }\n         else\n@@ -57,7 +58,7 @@\n                 throw new WikiSecurityException(\"Looped config detected - you must not prevent view access to page LoginError AND have strictLogins set to true!\");\n             }\n \n-            log.info(\"User \"+currentUser.getName()+\" has no access - displaying message.\");\n+            log.info(\"User \"+currentUser+\" has no access - displaying message.\");\n             response.sendRedirect( wiki.getViewURL(\"LoginError\") );\n         }\n     }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/5324d931a82af729db3218882b606a9f0dba9c78",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/fc7f226f27c21d28e3091a7b69ee7d4a5562f292",
        "message": "Added patch from someone to protect against NPEs\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624162 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_26",
        "file": [
            {
                "sha": "b2852486fefa2f36ceb74c240a4ab01493da8e3c",
                "filename": "src/com/ecyrd/jspwiki/dav/DavContext.java",
                "status": "modified",
                "additions": 17,
                "deletions": 11,
                "changes": 28,
                "blob_url": "https://github.com/apache/jspwiki/blob/5324d931a82af729db3218882b606a9f0dba9c78/src/com/ecyrd/jspwiki/dav/DavContext.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/5324d931a82af729db3218882b606a9f0dba9c78/src/com/ecyrd/jspwiki/dav/DavContext.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/dav/DavContext.java?ref=5324d931a82af729db3218882b606a9f0dba9c78",
                "patch": "@@ -9,27 +9,33 @@\n \n public class DavContext\n {\n+    public String m_davroot = \"/\";\n     public String m_davcontext = \"\";\n     public String m_page = null;\n     public int    m_depth = -1;\n     \n     public DavContext( HttpServletRequest req )\n     {\n-        String path = req.getPathInfo();\n+        m_davroot = req.getContextPath();\n         \n-        if( path.startsWith(\"/\") ) path = path.substring(1);\n+        String path = req.getPathInfo();\n+\n+        if (path != null)\n+        {\n+            if( path.startsWith(\"/\") ) path = path.substring(1);\n         \n-        int idx = path.indexOf('/');\n+            int idx = path.indexOf('/');\n         \n-        if( idx != -1 )\n-        {\n-            m_davcontext = path.substring( 0, idx );\n+            if( idx != -1 )\n+            {\n+                m_davcontext = path.substring( 0, idx );\n             \n-            m_page = path.substring( idx+1 );\n-        }\n-        else\n-        {\n-            m_davcontext = path;\n+                m_page = path.substring( idx+1 );\n+            }\n+            else\n+            {\n+                m_davcontext = path;\n+            }\n         }\n         \n         String depth = req.getHeader(\"Depth\");"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/e911437922f88682a29e8c46ef0ff694515364ac",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/ac4479a14bab071627267d2dbe1afdd483a78866",
        "message": "Added some NPE protection.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@623543 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_27",
        "file": [
            {
                "sha": "f234af1679120c7665610636b57238590c9b9431",
                "filename": "src/webdocs/Error.jsp",
                "status": "modified",
                "additions": 20,
                "deletions": 13,
                "changes": 33,
                "blob_url": "https://github.com/apache/jspwiki/blob/e911437922f88682a29e8c46ef0ff694515364ac/src/webdocs/Error.jsp",
                "raw_url": "https://github.com/apache/jspwiki/raw/e911437922f88682a29e8c46ef0ff694515364ac/src/webdocs/Error.jsp",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/Error.jsp?ref=e911437922f88682a29e8c46ef0ff694515364ac",
                "patch": "@@ -25,33 +25,40 @@\n     response.setContentType(\"text/html; charset=\"+wiki.getContentEncoding() );\n \n     String msg = \"An unknown error was caught by Error.jsp\";\n+\n+    Throwable realcause = null;\n+\n     if( exception != null )        \n     {   \n         msg = exception.getMessage();\n         if( msg == null || msg.length() == 0 )\n         {\n             msg = \"An unknown exception \"+exception.getClass().getName()+\" was caught by Error.jsp.\";\n         }\n-    }\n \n-    log.debug(\"Error.jsp exception is: \",exception);\n+        //\n+        //  This allows us to get the actual cause of the exception.\n+        //  Note the cast; at least Tomcat has two classes called \"JspException\"\n+        //  imported in JSP pages.\n+        //\n \n-    //\n-    //  This allows us to get the actual cause of the exception.\n-    //  Note the cast; at least Tomcat has two classes called \"JspException\"\n-    //  imported in JSP pages.\n-    //\n \n-    Throwable realcause = null;\n+        if( exception instanceof javax.servlet.jsp.JspException )\n+        {\n+            log.debug(\"IS JSPEXCEPTION\");\n+            realcause = ((javax.servlet.jsp.JspException)exception).getRootCause();\n+            log.debug(\"REALCAUSE=\"+realcause);\n+        }\n \n-    if( exception instanceof javax.servlet.jsp.JspException )\n+        if( realcause == null ) realcause = exception;    \n+    }\n+    else\n     {\n-        log.debug(\"IS JSPEXCEPTION\");\n-        realcause = ((javax.servlet.jsp.JspException)exception).getRootCause();\n-        log.debug(\"REALCAUSE=\"+realcause);\n+        realcause = new Exception(\"Unknown general exception\");\n     }\n \n-    if( realcause == null ) realcause = exception;    \n+    log.debug(\"Error.jsp exception is: \",exception);\n+\n \n     pageContext.setAttribute( \"message\", msg, PageContext.REQUEST_SCOPE );\n %>"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/27f023086f7f8cc8f8e2d8bb82fa796d69a30588",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/2c5f4780d1497e0891c1e0ce30631e5550988f6a",
        "message": "Ebu's npe patch.\nAdded missing copyright text.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@623438 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_28",
        "file": [
            {
                "sha": "0666ac0d95b29c5f3e4ae8315ee29f682189e035",
                "filename": "src/com/ecyrd/jspwiki/auth/modules/FileAuthenticator.java",
                "status": "modified",
                "additions": 24,
                "deletions": 2,
                "changes": 26,
                "blob_url": "https://github.com/apache/jspwiki/blob/27f023086f7f8cc8f8e2d8bb82fa796d69a30588/src/com/ecyrd/jspwiki/auth/modules/FileAuthenticator.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/27f023086f7f8cc8f8e2d8bb82fa796d69a30588/src/com/ecyrd/jspwiki/auth/modules/FileAuthenticator.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/modules/FileAuthenticator.java?ref=27f023086f7f8cc8f8e2d8bb82fa796d69a30588",
                "patch": "@@ -1,3 +1,22 @@\n+/* \n+    JSPWiki - a JSP-based WikiWiki clone.\n+\n+    Copyright (C) 2001-2004 Janne Jalkanen (Janne.Jalkanen@iki.fi)\n+\n+    This program is free software; you can redistribute it and/or modify\n+    it under the terms of the GNU Lesser General Public License as published by\n+    the Free Software Foundation; either version 2.1 of the License, or\n+    (at your option) any later version.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Lesser General Public License for more details.\n+\n+    You should have received a copy of the GNU Lesser General Public License\n+    along with this program; if not, write to the Free Software\n+    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+ */\n package com.ecyrd.jspwiki.auth.modules;\n \n import java.util.Properties;\n@@ -8,7 +27,7 @@\n import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.NoRequiredPropertyException;\n import com.ecyrd.jspwiki.auth.*;\n-import org.apache.log4j.Category;\n+import org.apache.log4j.Logger;\n \n /**\n  *  Provides a simple file-based authenticator.  This is really simple,\n@@ -24,7 +43,7 @@\n \n     private String m_fileName;\n \n-    static Category log = Category.getInstance( FileAuthenticator.class );\n+    static Logger log = Logger.getLogger( FileAuthenticator.class );\n \n     public void initialize( Properties props )\n         throws NoRequiredPropertyException\n@@ -61,6 +80,9 @@ private Properties readPasswords( String filename )\n \n     public boolean authenticate( UserProfile wup )\n     {\n+        if( wup == null || wup.getName() == null )\n+            return( false );\n+\n         try\n         {\n             Properties props = readPasswords( m_fileName );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/6f6549ebad3075c201d65e92909a84fc72686e44",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/a8abfba89e47e7c525ee0800be4b71ef5adcee7c",
        "message": "Ebu's npe prevention patch.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@623435 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_29",
        "file": [
            {
                "sha": "31e8401aa530942f6a2e427ce459d3bd78c72bff",
                "filename": "src/com/ecyrd/jspwiki/auth/UserManager.java",
                "status": "modified",
                "additions": 24,
                "deletions": 9,
                "changes": 33,
                "blob_url": "https://github.com/apache/jspwiki/blob/6f6549ebad3075c201d65e92909a84fc72686e44/src/com/ecyrd/jspwiki/auth/UserManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/6f6549ebad3075c201d65e92909a84fc72686e44/src/com/ecyrd/jspwiki/auth/UserManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/UserManager.java?ref=6f6549ebad3075c201d65e92909a84fc72686e44",
                "patch": "@@ -364,7 +364,8 @@ public boolean login( String username, String password, HttpSession session )\n         }\n \n         UserProfile wup = getUserProfile( username );\n-        wup.setPassword( password );\n+        if( wup != null )\n+            wup.setPassword( password );\n \n         boolean isValid = m_authenticator.authenticate( wup );\n \n@@ -452,10 +453,12 @@ protected UserProfile limitedLogin( HttpServletRequest request )\n         if( uid != null )\n         {\n             wup = getUserProfile( uid );\n-            wup.setLoginStatus( UserProfile.CONTAINER );            \n-\n-            HttpSession session = request.getSession( true );\n-            session.setAttribute( WIKIUSER, wup );\n+            if( wup != null )\n+            {\n+                wup.setLoginStatus( UserProfile.CONTAINER );            \n+                HttpSession session = request.getSession( true );\n+                session.setAttribute( WIKIUSER, wup );\n+            }\n         }\n         else\n         {\n@@ -469,9 +472,11 @@ protected UserProfile limitedLogin( HttpServletRequest request )\n             if( uid != null )\n             {\n                 wup = UserProfile.parseStringRepresentation( uid );\n-\n-                log.debug(\"wup=\"+wup);\n-                wup.setLoginStatus( UserProfile.COOKIE );\n+                if( wup != null )\n+                {\n+                    log.debug(\"wup=\"+wup);\n+                    wup.setLoginStatus( UserProfile.COOKIE );\n+                }\n             }\n             else\n             {\n@@ -487,10 +492,20 @@ protected UserProfile limitedLogin( HttpServletRequest request )\n                     uid = \"unknown\"; // FIXME: Magic\n                 }\n                 wup = getUserProfile( uid );\n-                wup.setLoginStatus( UserProfile.NONE );\n+                if( wup != null )\n+                    wup.setLoginStatus( UserProfile.NONE );\n             }\n         }\n \n+        // If the UserDatabase declined to give us a UserPrincipal, \n+        // we manufacture one here explicitly. \n+        if( wup == null )\n+        {\n+            wup = new UserProfile();\n+            wup.setName( GROUP_GUEST );\n+            wup.setLoginStatus( UserProfile.NONE );\n+        }\n+\n         //\n         //  FIXME:\n         //"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/99ed0c72f2266b60aa6652e9fd326fb1fbe879cc",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/1cd4b41ddfce50621fae5372da2fd28707861722",
        "message": "Fixed a NPE with NULL links list.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@621411 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_30",
        "file": [
            {
                "sha": "56a11a73b6c740cae3998e897c9eac44344207f9",
                "filename": "src/com/ecyrd/jspwiki/plugin/ReferringPagesPlugin.java",
                "status": "modified",
                "additions": 13,
                "deletions": 5,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/99ed0c72f2266b60aa6652e9fd326fb1fbe879cc/src/com/ecyrd/jspwiki/plugin/ReferringPagesPlugin.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/99ed0c72f2266b60aa6652e9fd326fb1fbe879cc/src/com/ecyrd/jspwiki/plugin/ReferringPagesPlugin.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/plugin/ReferringPagesPlugin.java?ref=99ed0c72f2266b60aa6652e9fd326fb1fbe879cc",
                "patch": "@@ -47,6 +47,7 @@ public String execute( WikiContext context, Map params )\n     {\n         ReferenceManager refmgr = context.getEngine().getReferenceManager();\n         Collection       links  = refmgr.findReferrers( context.getPage().getName() );\n+        String           wikitext;\n \n         super.initialize( context, params );\n \n@@ -60,13 +61,20 @@ public String execute( WikiContext context, Map params )\n         log.debug( \"Fetching referring pages for \"+context.getPage().getName()+\n                    \" with a max of \"+items);\n         \n-        String wikitext = wikitizeCollection( links, \"\\\\\\\\\", items );\n-\n-        if( items < links.size() && items > 0 )\n+        if( links != null && links.size() > 0 )\n         {\n-            extras = TextUtil.replaceString( extras, \"%d\", \n+            wikitext = wikitizeCollection( links, \"\\\\\\\\\", items );\n+\n+            if( items < links.size() && items > 0 )\n+            {\n+                extras = TextUtil.replaceString( extras, \"%d\", \n                                              \"\"+(links.size()-items) );\n-            wikitext += extras;\n+                wikitext += extras;\n+            }\n+        }\n+        else\n+        {\n+            wikitext = \"...nobody\";\n         }\n \n         return makeHTML( context, wikitext );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/8e830c7f4c71ab0208b2e72547a4693bafd5ec2b",
        "message": "Hopefully fixed bug with NPEs in CachingProvider.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@621389 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_31",
        "file": [
            {
                "sha": "867a17c5a27ac5618a8d3a531fcb372feea0d377",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -1,3 +1,8 @@\n+2002-02-03  Janne Jalkanen  <Janne.Jalkanen@ecyrd.com>\n+\n+        * Fixed a slow routine in TranslatorReader, shaving off roughly\n+\t10% of translation time.  Construction Exceptions is truly heavy.\n+\n 2002-01-30  Janne Jalkanen  <Janne.Jalkanen@ecyrd.com>\n \n         * v1.6.8-cvs"
            },
            {
                "sha": "3956b42386bd291ec644053eefc55d1732f2d186",
                "filename": "src/com/ecyrd/jspwiki/FileSystemProvider.java",
                "status": "modified",
                "additions": 15,
                "deletions": 1,
                "changes": 16,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/FileSystemProvider.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/FileSystemProvider.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/FileSystemProvider.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -125,6 +125,9 @@ public String getPageText( String page, int version )\n         return getPageText( page );\n     }\n \n+    /**\n+     *  Read the text directly from the correct file.\n+     */\n     private String getPageText( String page )\n     {\n         String result  = null;\n@@ -207,6 +210,14 @@ public Collection getAllPages()\n \n             WikiPage page = getPageInfo( unmangleName(wikiname.substring(0,cutpoint)),\n                                          WikiPageProvider.LATEST_VERSION );\n+            if( page == null )\n+            {\n+                // This should not really happen.\n+                // FIXME: Should we throw an exception here?\n+                log.error(\"Page \"+wikiname+\" was found in directory listing, but could not be located individually.\");\n+                continue;\n+            }\n+            \n             set.add( page );\n         }\n \n@@ -330,7 +341,10 @@ public WikiPage getPageInfo( String page, int version )\n     {\n         File file = findPage( page );\n \n-        if( !file.exists() ) return null;\n+        if( !file.exists() )\n+        {\n+            return null;\n+        }\n \n         WikiPage p = new WikiPage( page );\n         p.setLastModified( new Date(file.lastModified()) );"
            },
            {
                "sha": "45488d7b2b9238cfc0f1c02e42d8640e5564c01d",
                "filename": "src/com/ecyrd/jspwiki/QueryItem.java",
                "status": "modified",
                "additions": 17,
                "deletions": 1,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/QueryItem.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/QueryItem.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/QueryItem.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -1,7 +1,7 @@\n /* \n     JSPWiki - a JSP-based WikiWiki clone.\n \n-    Copyright (C) 2001 Janne Jalkanen (Janne.Jalkanen@iki.fi)\n+    Copyright (C) 2001-2002 Janne Jalkanen (Janne.Jalkanen@iki.fi)\n \n     This program is free software; you can redistribute it and/or modify\n     it under the terms of the GNU General Public License as published by\n@@ -19,12 +19,28 @@\n  */\n package com.ecyrd.jspwiki;\n \n+/**\n+ *  This simple class just fulfils the role of a container\n+ *  for searches.  It tells the word and whether it is requested or not.\n+ *\n+ *  @author Janne Jalkanen\n+ */\n public class QueryItem\n {\n+    /** The word is required to be in the pages */\n     public static final int REQUIRED  = 1;\n+\n+    /** The word may NOT be in the pages */\n     public static final int FORBIDDEN = -1;\n+\n+    /** The word should be in the pages, but the search engine may\n+        use its own discretion. */\n     public static final int REQUESTED = 0;\n \n+    /** The word that is being searched */\n     public String word;\n+\n+    /** The type of the word.  See above for types.  The default\n+        is REQUESTED. */\n     public int    type = REQUESTED;\n }"
            },
            {
                "sha": "0f11ebbefcf1b1f8e29a055922df3e102149e728",
                "filename": "src/com/ecyrd/jspwiki/RCSFileProvider.java",
                "status": "modified",
                "additions": 3,
                "deletions": 1,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/RCSFileProvider.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/RCSFileProvider.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/RCSFileProvider.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -160,6 +160,7 @@ else if( found && line.startsWith(\"----\")  )\n         }\n         catch( Exception e )\n         {\n+            // This also occurs when 'info' was null.\n             log.warn(\"Failed to read RCS info\",e);\n         }\n \n@@ -170,7 +171,8 @@ public String getPageText( String page, int version )\n     {\n         String result = null;\n \n-        // Let parent handle latest fetches.\n+        // Let parent handle latest fetches, since the FileSystemProvider\n+        // can do the file reading just as well.\n \n         if( version == WikiPageProvider.LATEST_VERSION )\n             return super.getPageText( page, version );"
            },
            {
                "sha": "18cbe7ed248587d1022af49f715b263ef7f6ae00",
                "filename": "src/com/ecyrd/jspwiki/ReferenceManager.java",
                "status": "modified",
                "additions": 2,
                "deletions": 1,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/ReferenceManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/ReferenceManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/ReferenceManager.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -1,7 +1,8 @@\n /* \n     JSPWiki - a JSP-based WikiWiki clone.\n \n-    Copyright (C) 2001 Janne Jalkanen (Janne.Jalkanen@iki.fi)\n+    Copyright (C) 2001-2002 Janne Jalkanen (Janne.Jalkanen@iki.fi),\n+                            Erik Bunn (ebu@memecry.net)\n \n     This program is free software; you can redistribute it and/or modify\n     it under the terms of the GNU General Public License as published by"
            },
            {
                "sha": "8dcd0191da6666b5182f718606285dbdac058aa4",
                "filename": "src/com/ecyrd/jspwiki/TranslatorReader.java",
                "status": "modified",
                "additions": 47,
                "deletions": 5,
                "changes": 52,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/TranslatorReader.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/TranslatorReader.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/TranslatorReader.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -34,6 +34,11 @@\n  *  Handles conversion from Wiki format into fully featured HTML.\n  *  This is where all the magic happens.  It is CRITICAL that this\n  *  class is tested, or all Wikis might die horribly.\n+ *  <P>\n+ *  The output of the HTML has not yet been validated against\n+ *  the HTML DTD.  However, it is very simple.\n+ *\n+ *  @author Janne Jalkanen\n  */\n // FIXME: Class still has problems with {{{: all conversion on that line where the {{{\n //        appears is done, but after that, conversion is not done.  The only real solution\n@@ -120,7 +125,11 @@ public TranslatorReader( WikiContext context, Reader in )\n     }\n \n     /**\n-     *  Adds a hook for processing link texts.\n+     *  Adds a hook for processing link texts.  This hook is called\n+     *  when the link text is written into the output stream, and\n+     *  you may use it to modify the text.  It does not affect the\n+     *  actual link, only the user-visible text.\n+     *\n      *  @param mutator The hook to call.  Null is safe.\n      */\n     public void addLinkTransmutator( StringTransmutator mutator )\n@@ -132,7 +141,8 @@ public void addLinkTransmutator( StringTransmutator mutator )\n     }\n \n     /**\n-     *  Adds a hook for processing local links.\n+     *  Adds a hook for processing local links.  The engine\n+     *  transforms both non-existing and existing page links.\n      *\n      *  @param mutator The hook to call.  Null is safe.\n      */\n@@ -175,7 +185,7 @@ protected static Collection getImagePatterns( WikiEngine engine )\n     }\n \n     /**\n-     *  Returns true, if the link exists.\n+     *  Returns true, if the link exists.  This is simply a shortcut.\n      */\n     private boolean linkExists( String link )\n     {\n@@ -184,6 +194,11 @@ private boolean linkExists( String link )\n \n     /**\n      *  Calls a transmutator chain.\n+     *\n+     *  @param list Chain to call\n+     *  @param text Text that should be passed to the mutate() method\n+     *              of each of the mutators in the chain.\n+     *  @return The result of the mutation.\n      */\n \n     private String callMutatorChain( Collection list, String text )\n@@ -205,6 +220,10 @@ private String callMutatorChain( Collection list, String text )\n \n     /**\n      *  Write a HTMLized link depending on its type.\n+     *\n+     *  @param type Type of the link.\n+     *  @param link The actual link.\n+     *  @param text The user-visible text for the link.\n      */\n     private String makeLink( int type, String link, String text )\n     {\n@@ -322,7 +341,8 @@ private String cleanLink( String link )\n     }\n \n     /**\n-     *  Figures out if a link is an off-site link.\n+     *  Figures out if a link is an off-site link.  This recognizes\n+     *  the most common protocols by checking how it starts.\n      */\n     private boolean isExternalLink( String link )\n     {\n@@ -348,7 +368,8 @@ private boolean isImageLink( String link )\n     }\n \n     // FIXME: Non-optimal.\n-    private boolean isNumber( String s )\n+    /*\n+    private boolean isNumber2( String s )\n     {\n         try\n         {\n@@ -360,7 +381,28 @@ private boolean isNumber( String s )\n         }\n         return true;\n     }\n+    */\n+    /**\n+     *  Returns true, if the argument contains a number, otherwise false.\n+     *  In a quick test this is roughly the same speed as Integer.parseInt()\n+     *  if the argument is a number, and roughly ten times the speed, if\n+     *  the argument is NOT a number.\n+     */\n \n+    private boolean isNumber( String s )\n+    {\n+        if( s.charAt(0) == '-' && s.length() > 1)\n+            s = s.substring(1);\n+\n+        for( int i = 0; i < s.length(); i++ )\n+        {\n+            if( !Character.isDigit(s.charAt(i)) )\n+                return false;\n+        }\n+\n+        return true;\n+    }\n+    \n     private String setHyperLinks( String line )\n     {\n         int start, end = 0;"
            },
            {
                "sha": "d4e54f0c48b3bff5593d94b640dd06df2bb380b4",
                "filename": "src/com/ecyrd/jspwiki/WikiPageProvider.java",
                "status": "modified",
                "additions": 0,
                "deletions": 1,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/WikiPageProvider.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/src/com/ecyrd/jspwiki/WikiPageProvider.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/WikiPageProvider.java?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -69,7 +69,6 @@\n     /**\n      *  Returns all pages.  Each element in the returned\n      *  Collection should be a WikiPage.\n-     *  @deprecated\n      */\n \n     public Collection getAllPages();"
            },
            {
                "sha": "f4a7f2c0a3df8c487c1e26f2e9ed994282184303",
                "filename": "tests/etc/jspwiki.properties",
                "status": "modified",
                "additions": 2,
                "deletions": 2,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/tests/etc/jspwiki.properties",
                "raw_url": "https://github.com/apache/jspwiki/raw/a4d6fd613fb13a42deb436b4341db765ac2a9ac0/tests/etc/jspwiki.properties",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/etc/jspwiki.properties?ref=a4d6fd613fb13a42deb436b4341db765ac2a9ac0",
                "patch": "@@ -12,7 +12,7 @@ jspwiki.pageProvider = com.ecyrd.jspwiki.FileSystemProvider\n #\n #  Determines where wiki files are kept.\n #\n-jspwiki.fileSystemProvider.pageDir = /tmp/\n+jspwiki.fileSystemProvider.pageDir = c:\\\\tmp\\\\\n \n #\n #  Special page references.\n@@ -64,7 +64,7 @@ jspwiki.translatorReader.inlinePattern.3 = http://images.com/*\n log4j.appender.FileLog = org.apache.log4j.RollingFileAppender\n log4j.appender.FileLog.MaxFileSize    = 10MB\n log4j.appender.FileLog.MaxBackupIndex = 14\n-log4j.appender.FileLog.File = /tmp/jspwikitests.log\n+log4j.appender.FileLog.File = c:\\\\tmp\\\\jspwikitests.log\n log4j.appender.FileLog.layout = org.apache.log4j.PatternLayout\n log4j.appender.FileLog.layout.ConversionPattern=%d [%t] %p %c %x - %m%n\n "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/959481fcc7530c9f56d58631dc6e09a9b118cbf6",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/d89f509d063e2d3153908dec4babce0d5a1179be",
        "message": "2012-12-12  Harry Metske <metskem@apache.org>\n\n       * 2.9.1-svn-5\n        \n        * fixed JSPWIKI-742 NullPointerException in PriorityList (reported by Rakesh K. Cherukuri)\n        * minor updates to build.xml to properly handle build failures (I am not an ant expert...)\n \n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@1420898 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_32",
        "file": [
            {
                "sha": "48e55122b7d627129e58568645ff9b06a9dad4c7",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 8,
                "deletions": 1,
                "changes": 9,
                "blob_url": "https://github.com/apache/jspwiki/blob/959481fcc7530c9f56d58631dc6e09a9b118cbf6/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/959481fcc7530c9f56d58631dc6e09a9b118cbf6/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=959481fcc7530c9f56d58631dc6e09a9b118cbf6",
                "patch": "@@ -1,4 +1,11 @@\n-2012-12-09  Juan Pablo Santos (juanpablo AT apache DOT org)\n+2012-12-12  Harry Metske <metskem@apache.org>\n+\n+       * 2.9.1-svn-5\n+        \n+        * fixed JSPWIKI-742 NullPointerException in PriorityList (reported by Rakesh K. Cherukuri)\n+        * minor updates to build.xml to properly handle build failures (I am not an ant expert...)\n+ \n+ 2012-12-09  Juan Pablo Santos (juanpablo AT apache DOT org)\n \n        * Sonar Ant task executed even if there are tests failures\n        "
            },
            {
                "sha": "0f327112eac79c220a7b4e5e02defb2bcbee74fa",
                "filename": "build.xml",
                "status": "modified",
                "additions": 4,
                "deletions": 4,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/959481fcc7530c9f56d58631dc6e09a9b118cbf6/build.xml",
                "raw_url": "https://github.com/apache/jspwiki/raw/959481fcc7530c9f56d58631dc6e09a9b118cbf6/build.xml",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/build.xml?ref=959481fcc7530c9f56d58631dc6e09a9b118cbf6",
                "patch": "@@ -863,13 +863,13 @@\n   \t    <report format=\"noframes\" todir=\"${tests.reports}\" />\n   \t </junitreport>\n      \n-     <antcall target=\"fail-build\">\n-       <param name=\"test.failed\" value=\"@{test.failed}\"/>\n+     <antcall target=\"fail-build-if-junit-fails\">\n+       <param name=\"test.failed\" value=\"${test.failed}\"/>\n      </antcall>\n   </target>\n \t\n-  <target name=\"fail-build\" unless=\"continue_even_with_test_failures\">\n-  \t<fail message=\"Test failure detected, check test results.\" if=\"test.failed\" />\n+  <target name=\"fail-build-if-junit-fails\" unless=\"continue_even_with_test_failures\">\n+  \t<fail message=\"Test failure(s) detected, check test results.\" if=\"${test.failed}\" />\n   </target>\n \n   <target name=\"tests-auth\" depends=\"jar,tests-init,jartests\""
            },
            {
                "sha": "9337d882b46fd88f1d565a332cb037e0f6432f94",
                "filename": "src/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/959481fcc7530c9f56d58631dc6e09a9b118cbf6/src/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/959481fcc7530c9f56d58631dc6e09a9b118cbf6/src/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/org/apache/wiki/Release.java?ref=959481fcc7530c9f56d58631dc6e09a9b118cbf6",
                "patch": "@@ -75,7 +75,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"4\";\n+    public static final String     BUILD         = \"5\";\n     \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "13938aba702580c56e36b8b24b368662321649be",
                "filename": "src/org/apache/wiki/util/PriorityList.java",
                "status": "modified",
                "additions": 4,
                "deletions": 5,
                "changes": 9,
                "blob_url": "https://github.com/apache/jspwiki/blob/959481fcc7530c9f56d58631dc6e09a9b118cbf6/src/org/apache/wiki/util/PriorityList.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/959481fcc7530c9f56d58631dc6e09a9b118cbf6/src/org/apache/wiki/util/PriorityList.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/org/apache/wiki/util/PriorityList.java?ref=959481fcc7530c9f56d58631dc6e09a9b118cbf6",
                "patch": "@@ -19,7 +19,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n package org.apache.wiki.util;\n \n import java.util.AbstractList;\n-import java.util.ArrayList;\n+import java.util.concurrent.CopyOnWriteArrayList;\n \n /**\n  *  Builds a simple, priority-based List implementation.  The list\n@@ -30,11 +30,10 @@ Licensed to the Apache Software Foundation (ASF) under one\n  *  Priority is an integer, and the list is sorted in descending order\n  *  (that is, 100 is before 10 is before 0 is before -40).\n  */\n-@SuppressWarnings(\"unchecked\")\n public class PriorityList\n     extends AbstractList\n {\n-    private ArrayList<Object> m_elements = new ArrayList<Object>();\n+    private CopyOnWriteArrayList<Item> m_elements = new CopyOnWriteArrayList<Item>();\n \n     /**\n      *  This is the default priority, which is used if no priority\n@@ -55,7 +54,7 @@ public void add( Object o, int priority )\n \n         for( ; i < m_elements.size(); i++ )\n         {\n-            Item item = (Item) m_elements.get(i);\n+            Item item = m_elements.get(i);\n \n             if( item.m_priority < priority )\n             {\n@@ -91,7 +90,7 @@ public boolean add( Object o )\n      */\n     public Object get( int index )\n     {\n-        return ((Item)m_elements.get( index )).m_object;\n+        return m_elements.get( index ).m_object;\n     }\n \n     /**"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/1e79951c1f3136e03e23b0fa45007f28669068f5",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/8c5533ae32d1e215b83f7d4c844dd77535251f9c",
        "message": "2.5.117 - Page renaming caused a NullPointerException under some circumstances,\n        filed as Bug 85. Fixed, seemed to be caused when renaming a non-existing page\n        (cfr. with http://bugs.jspwiki.org/show_bug.cgi?id=85). Added some JUnit tests to\n        check this.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626714 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_33",
        "file": [
            {
                "sha": "abb36e73146da3fcd2529df9a36649f4862cfb3a",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 7,
                "deletions": 0,
                "changes": 7,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e79951c1f3136e03e23b0fa45007f28669068f5/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e79951c1f3136e03e23b0fa45007f28669068f5/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=1e79951c1f3136e03e23b0fa45007f28669068f5",
                "patch": "@@ -1,3 +1,10 @@\n+2007-08-17  Juan Pablo Santos <juanpablo.santos@gmail.com>\n+\n+        * 2.5.117 - Page renaming caused a NullPointerException under some circumstances,\n+        filed as Bug 85. Fixed, seemed to be caused when renaming a non-existing page \n+        (cfr. with http://bugs.jspwiki.org/show_bug.cgi?id=85). Added some JUnit tests to \n+        check this.\n+        \n 2007-08-15  Dirk Frederickx (dirk.frederickx@gmail.com)\n \n         * 2.5.116 - More fixes for IE"
            },
            {
                "sha": "80d663d420afc32496be4f32224e4cb6a8c83a62",
                "filename": "src/com/ecyrd/jspwiki/PageRenamer.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e79951c1f3136e03e23b0fa45007f28669068f5/src/com/ecyrd/jspwiki/PageRenamer.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e79951c1f3136e03e23b0fa45007f28669068f5/src/com/ecyrd/jspwiki/PageRenamer.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/PageRenamer.java?ref=1e79951c1f3136e03e23b0fa45007f28669068f5",
                "patch": "@@ -233,7 +233,7 @@ private void updateReferrerOnRename(WikiContext context, String oldName, String\n \n             if (context.getPage() != null)\n             {\n-                PageLock lock = m_wikiEngine.getPageManager().getCurrentLock( m_wikiEngine.getPage(referrerName) );\n+                PageLock lock = m_wikiEngine.getPageManager().getCurrentLock( context.getPage() );\n                 m_wikiEngine.getPageManager().unlockPage( lock );\n \n                 tempCtx.getPage().setAuthor( context.getCurrentUser().getName() );"
            },
            {
                "sha": "5f321e6723f86bc2d49406da6c8ac76717548bca",
                "filename": "src/com/ecyrd/jspwiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e79951c1f3136e03e23b0fa45007f28669068f5/src/com/ecyrd/jspwiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e79951c1f3136e03e23b0fa45007f28669068f5/src/com/ecyrd/jspwiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/Release.java?ref=1e79951c1f3136e03e23b0fa45007f28669068f5",
                "patch": "@@ -64,7 +64,7 @@\n     public static final int        REVISION      = 5;\n \n     /** The minor revision, or a \"build number\", if you wish. */\n-    public static final int        MINORREVISION = 116;\n+    public static final int        MINORREVISION = 117;\n \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "be6dd7995cc90d509ce323d5982b436be21688b5",
                "filename": "tests/com/ecyrd/jspwiki/PageRenamerTest.java",
                "status": "modified",
                "additions": 72,
                "deletions": 0,
                "changes": 72,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e79951c1f3136e03e23b0fa45007f28669068f5/tests/com/ecyrd/jspwiki/PageRenamerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e79951c1f3136e03e23b0fa45007f28669068f5/tests/com/ecyrd/jspwiki/PageRenamerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/PageRenamerTest.java?ref=1e79951c1f3136e03e23b0fa45007f28669068f5",
                "patch": "@@ -322,6 +322,78 @@ public void testExtendedLinks() throws Exception\n         assertEquals( \"[Link to Test|Test|target='_new']\", m_engine.getText( \"TestPage\" ).trim() );\n     }\n     \n+    public void testBug85_case1() throws Exception \n+    {\n+        // renaming a non-existing page\n+        // This fails under 2.5.116, cfr. with http://bugs.jspwiki.org/show_bug.cgi?id=85\n+        // m_engine.saveText( \"TestPage\", \"blablahblahbla\" );\n+        try\n+        {\n+            rename(\"TestPage123\", \"Main8887\");\n+            rename(\"Main8887\", \"TestPage123\"); \n+        }\n+        catch (NullPointerException npe)\n+        {\n+            npe.printStackTrace();\n+            System.out.println(\"NPE: Bug 85 caught?\");\n+            fail();\n+        }\n+    }\n+    \n+    public void testBug85_case2() throws Exception \n+    {\n+        try\n+        {\n+            // renaming a non-existing page, but we call m_engine.saveText() before renaming \n+            // this does not fail under 2.5.116\n+            m_engine.saveText( \"TestPage1234\", \"blablahblahbla\" );\n+            rename(\"TestPage1234\", \"Main8887\");\n+            rename(\"Main8887\", \"TestPage1234\");\n+        }\n+        catch (NullPointerException npe)\n+        {\n+            npe.printStackTrace();\n+            System.out.println(\"NPE: Bug 85 caught?\");\n+            fail();\n+        }\n+    }\n+    \n+    public void testBug85_case3() throws Exception \n+    {\n+        try\n+        {\n+            // renaming an existing page\n+            // this does not fail under 2.5.116\n+            // m_engine.saveText( \"Main\", \"blablahblahbla\" );\n+            rename(\"Main\", \"Main8887\");\n+            rename(\"Main8887\", \"Main\");\n+        }\n+        catch (NullPointerException npe)\n+        {\n+            npe.printStackTrace();\n+            System.out.println(\"NPE: Bug 85 caught?\");\n+            fail();\n+        }\n+    }\n+    \n+    public void testBug85_case4() throws Exception \n+    {\n+        try\n+        {\n+            // renaming an existing page, and we call m_engine.saveText() before renaming\n+            // this does not fail under 2.5.116\n+            m_engine.saveText( \"Main\", \"blablahblahbla\" );\n+            rename(\"Main\", \"Main8887\");\n+            rename(\"Main8887\", \"Main\");\n+        }\n+        catch (NullPointerException npe)\n+        {\n+            npe.printStackTrace();\n+            System.out.println(\"NPE: Bug 85 caught?\");\n+            fail();\n+        }\n+    }\n+    \n     public static Test suite()\n     {\n         return new TestSuite( PageRenamerTest.class );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/8056b5b5d6b429dd98e5aa1cdee62cb858619124",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/43147593da6f8390a6a2a736dc816ab8ca0721a6",
        "message": "is now a bit more verbose if\n        there is no internet connection and it cannot find local\n        DTDs.  It also throws a InternalWikiExcepton instead of\n        a generic RuntimeException or a NullPointerException...\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625215 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_34",
        "file": [
            {
                "sha": "706f212bbbc8a9706f8e78691aeeaf8a1be8bad0",
                "filename": "src/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizer.java",
                "status": "modified",
                "additions": 31,
                "deletions": 7,
                "changes": 38,
                "blob_url": "https://github.com/apache/jspwiki/blob/8056b5b5d6b429dd98e5aa1cdee62cb858619124/src/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizer.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/8056b5b5d6b429dd98e5aa1cdee62cb858619124/src/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizer.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizer.java?ref=8056b5b5d6b429dd98e5aa1cdee62cb858619124",
                "patch": "@@ -21,6 +21,7 @@\n import org.xml.sax.InputSource;\n import org.xml.sax.SAXException;\n \n+import com.ecyrd.jspwiki.InternalWikiException;\n import com.ecyrd.jspwiki.WikiContext;\n import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.WikiSession;\n@@ -33,7 +34,7 @@\n  * method {@link #isContainerAuthorized()} that queries the web application\n  * descriptor to determine if the container manages authorization.\n  * @author Andrew Jaquith\n- * @version $Revision: 1.14 $ $Date: 2006-02-21 19:49:58 $\n+ * @version $Revision: 1.15 $ $Date: 2006-04-17 09:39:31 $\n  * @since 2.3\n  */\n public class WebContainerAuthorizer implements Authorizer\n@@ -75,7 +76,10 @@ public void initialize( WikiEngine engine, Properties props )\n     {\n         m_engine = engine;\n         m_containerAuthorized = false;\n-        try {\n+\n+        // FIXME: Error handling here is not very verbose\n+        try \n+        {\n             Document webxml = getWebXml();\n             if ( webxml != null )\n             {\n@@ -94,11 +98,13 @@ public void initialize( WikiEngine engine, Properties props )\n         }\n         catch ( IOException e )\n         {\n-            throw new RuntimeException( e.getMessage() );\n+            log.error(\"Initialization failed: \",e);\n+            throw new InternalWikiException( e.getClass().getName()+\": \"+e.getMessage() );\n         }\n         catch ( JDOMException e )\n         {\n-            throw new RuntimeException( e.getMessage() );\n+            log.error(\"Malformed XML in web.xml\",e);\n+            throw new InternalWikiException( e.getClass().getName()+\": \"+e.getMessage() );\n         }\n         \n         if ( m_containerRoles.length > 0 )\n@@ -304,13 +310,18 @@ protected Document getWebXml() throws JDOMException, IOException\n         {\n             ClassLoader cl = WebContainerAuthorizer.class.getClassLoader();\n             url = cl.getResource( \"WEB-INF/web.xml\" );\n-            log.info( \"Examining \" + url.toExternalForm() );\n+            if( url != null )\n+                log.info( \"Examining \" + url.toExternalForm() );\n         }\n         else\n         {\n             url = m_engine.getServletContext().getResource( \"/WEB-INF/web.xml\" );\n-            log.info( \"Examining \" + url.toExternalForm() );\n+            if( url != null )\n+                log.info( \"Examining \" + url.toExternalForm() );\n         }\n+        if( url == null )\n+            throw new IOException(\"Unable to find web.xml for processing.\");\n+            \n         log.debug( \"Processing web.xml at \" + url.toExternalForm() );\n         doc = builder.build( url );\n         return doc;\n@@ -324,7 +335,7 @@ protected Document getWebXml() throws JDOMException, IOException\n      * kept at <code>http://java.sun.com/dtd/web-app_2_3.dtd</code>. The\n      * local copy is stored at <code>WEB-INF/dtd/web-app_2_3.dtd</code>.</p>\n      * @author Andrew Jaquith\n-     * @version $Revision: 1.14 $ $Date: 2006-02-21 19:49:58 $\n+     * @version $Revision: 1.15 $ $Date: 2006-04-17 09:39:31 $\n      */\n     public class LocalEntityResolver implements EntityResolver\n     {\n@@ -361,6 +372,19 @@ public InputSource resolveEntity( String publicId, String systemId ) throws SAXE\n                 return is;\n             }\n             \n+            //\n+            //  Let's fall back to default behaviour of the container, and let's\n+            //  also let the user know what is going on.  This caught me by surprise\n+            //  while running JSPWiki on an unconnected laptop...\n+            //\n+            //  The DTD needs to be resolved and read because it contains things like\n+            //  entity definitions...\n+            //\n+            log.info(\"Please note: There are no local DTD references in /WEB-INF/dtd/\"+file+\"; falling back to default behaviour.\"+\n+                     \" This may mean that the XML parser will attempt to connect to the internet to find the DTD.\"+\n+                     \" If you are running JSPWiki locally in an unconnected network, you might want to put the DTD files in place to avoid nasty UnknownHostExceptions.\");\n+            \n+            \n             // Fall back to default behaviour\n             return null;\n         }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/f65f3a24bbb0fdc18ef52a51361ca3d332c72e1a",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/211c70edc6b8639dbb867ceb98e9e6bacb18698f",
        "message": "Reworked bottom line display so that it would fit better with\nlong usernames or IP addresses.\nFixed a NullPointerException occurring when page would not exist.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@621357 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_35",
        "file": [
            {
                "sha": "e4c6c907f3a9976508ff27ab951607fc62e957e9",
                "filename": "src/webdocs/Wiki.jsp",
                "status": "modified",
                "additions": 13,
                "deletions": 6,
                "changes": 19,
                "blob_url": "https://github.com/apache/jspwiki/blob/f65f3a24bbb0fdc18ef52a51361ca3d332c72e1a/src/webdocs/Wiki.jsp",
                "raw_url": "https://github.com/apache/jspwiki/raw/f65f3a24bbb0fdc18ef52a51361ca3d332c72e1a/src/webdocs/Wiki.jsp",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/webdocs/Wiki.jsp?ref=f65f3a24bbb0fdc18ef52a51361ca3d332c72e1a",
                "patch": "@@ -127,24 +127,31 @@\n              <% if( isEditable ) { %>\n                  <A HREF=\"<%=wiki.getBaseURL()%>Edit.jsp?page=<%=pageurl%>\">Edit <%=pageReference%></A>.\n              <% } %>\n+             <% if( wikipage != null ) { %>\n+                 &nbsp;&nbsp;\n+                 <A HREF=\"<%=wiki.getBaseURL()%>PageInfo.jsp?page=<%=pageurl%>\">More info...</A></I><BR>\n+             <% } %>\n           </td>\n-          <td align=\"right\">\n+        </tr>\n+        <tr>\n+          <td align=\"left\">\n+             <FONT size=\"-1\">\n \t     <%\n-             java.util.Date lastchange = wikipage.getLastModified();\n-\n-             if( lastchange != null )\n+             if( wikipage != null )\n              {\n+                 java.util.Date lastchange = wikipage.getLastModified();\n+\n                  // FIXME: We want to use pageLastChanged(pagereq, version) below...)\n                  %>\n-                 <I>This page last changed on <A HREF=\"<%=wiki.getBaseURL()%>Diff.jsp?page=<%=pageurl%>&r1=<%=version%>\"><%=lastchange%></A> by <%=wikipage.getAuthor()%>.  \n-                    <A HREF=\"<%=wiki.getBaseURL()%>PageInfo.jsp?page=<%=pageurl%>\">More info...</A></I><BR>\n+                 <I>This page last changed on <A HREF=\"<%=wiki.getBaseURL()%>Diff.jsp?page=<%=pageurl%>&r1=<%=version%>\"><%=lastchange%></A> by <%=wikipage.getAuthor()%>.\n                  <%\n              } else {\n                  %>\n                  <I>Page not created yet.</I>\n                  <%\n              }\n              %>\n+             </FONT>\n           </td>\n         </tr>\n       </table>"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/6b6d1dfa2b8c71b34453ea3b62a10b1f8f72125f",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/73d9267370865e4d32b4bb5d54c931c3ea0eaac3",
        "message": "fixed runtime NPE on WikiJSPFilter (m_engine used before having been initialized)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@1488660 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_36",
        "file": [
            {
                "sha": "7896737bd3ad09ff726062a6278b602a9f3f13fb",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/ui/WikiJSPFilter.java",
                "status": "modified",
                "additions": 2,
                "deletions": 1,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/6b6d1dfa2b8c71b34453ea3b62a10b1f8f72125f/jspwiki-war/src/main/java/org/apache/wiki/ui/WikiJSPFilter.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/6b6d1dfa2b8c71b34453ea3b62a10b1f8f72125f/jspwiki-war/src/main/java/org/apache/wiki/ui/WikiJSPFilter.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/ui/WikiJSPFilter.java?ref=6b6d1dfa2b8c71b34453ea3b62a10b1f8f72125f",
                "patch": "@@ -68,12 +68,13 @@ Licensed to the Apache Software Foundation (ASF) under one\n public class WikiJSPFilter extends WikiServletFilter\n {\n     private Boolean m_useOutputStream;\n-    private String m_wiki_encoding = m_engine.getWikiProperties().getProperty(WikiEngine.PROP_ENCODING);\n+    private String m_wiki_encoding;\n \n     /** {@inheritDoc} */\n     public void init( FilterConfig config ) throws ServletException\n     {\n         super.init( config );\n+        m_wiki_encoding = m_engine.getWikiProperties().getProperty(WikiEngine.PROP_ENCODING);\n         ServletContext context = config.getServletContext();\n         m_useOutputStream = UtilJ2eeCompat.useOutputStream( context.getServerInfo() );\n     }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/dd8c00c9e4e48a6dfbb5ba0bcdb122ab59997e4a",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/65a1d67ede1e00001b89a64cdcd9058e9eea796b",
        "message": "Adding a NPE check to fight an annoying problem at jspwiki.org.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@703235 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_37",
        "file": [
            {
                "sha": "610212e93dc0cd8ba1040efd049c5fba9bc6b43e",
                "filename": "src/com/ecyrd/jspwiki/auth/user/XMLUserDatabase.java",
                "status": "modified",
                "additions": 3,
                "deletions": 0,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/dd8c00c9e4e48a6dfbb5ba0bcdb122ab59997e4a/src/com/ecyrd/jspwiki/auth/user/XMLUserDatabase.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/dd8c00c9e4e48a6dfbb5ba0bcdb122ab59997e4a/src/com/ecyrd/jspwiki/auth/user/XMLUserDatabase.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/user/XMLUserDatabase.java?ref=dd8c00c9e4e48a6dfbb5ba0bcdb122ab59997e4a",
                "patch": "@@ -611,6 +611,9 @@ private UserProfile findByAttribute( String matchAttribute, String index )\n         checkForRefresh();\n         \n         NodeList users = c_dom.getElementsByTagName( USER_TAG );\n+        \n+        if( users == null ) return null;\n+        \n         for( int i = 0; i < users.getLength(); i++ )\n         {\n             Element user = (Element) users.item( i );"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/82f0f18fa392b154e6c72d9b24de8e70cfcdbcb6",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/40438317d8d2a307af2468f48e3d5988d4cbb7e0",
        "message": "Fixed NPE in RSSImageLinkTag, which erroneously assumes that RSSGenerator is always available. However, it might not be if RSS feeds are disabled.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@683491 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_38",
        "file": [
            {
                "sha": "cfcc383bd85c705a7fc570076533319dea3ea688",
                "filename": "src/com/ecyrd/jspwiki/tags/RSSImageLinkTag.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/82f0f18fa392b154e6c72d9b24de8e70cfcdbcb6/src/com/ecyrd/jspwiki/tags/RSSImageLinkTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/82f0f18fa392b154e6c72d9b24de8e70cfcdbcb6/src/com/ecyrd/jspwiki/tags/RSSImageLinkTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/tags/RSSImageLinkTag.java?ref=82f0f18fa392b154e6c72d9b24de8e70cfcdbcb6",
                "patch": "@@ -95,7 +95,7 @@ public final int doWikiStartTag()\n         JspWriter out = pageContext.getOut();\n         ResourceBundle rb = m_wikiContext.getBundle( InternationalizationManager.CORE_BUNDLE );\n \n-        if( engine.getRSSGenerator().isEnabled() )\n+        if( engine.getRSSGenerator() != null && engine.getRSSGenerator().isEnabled() )\n         {\n             if( RSSGenerator.MODE_FULL.equals(m_mode) )\n             {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/4af7285a100a299ba5c4a51f92a904c9870b9411",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/23e39649df4f2cb9790638324b8c6e5fedd3588e",
        "message": "JSPWIKI-299: Deleting an attachment from a page which had been recently renamed caused an NPE.  Reported by Harry Metske.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@672715 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_39",
        "file": [
            {
                "sha": "9b8214d1ddd9069fa24c8c242048a99ff164730b",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 8,
                "deletions": 0,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/4af7285a100a299ba5c4a51f92a904c9870b9411/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/4af7285a100a299ba5c4a51f92a904c9870b9411/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=4af7285a100a299ba5c4a51f92a904c9870b9411",
                "patch": "@@ -1,3 +1,11 @@\n+2008-06-30  Janne Jalkanen <jalkanen@apache.org>\n+\n+        * 2.7.0-svn-52\n+        \n+        * JSPWIKI-299: Deleting an attachment from a page which\n+        had been recently renamed caused an NPE.  Reported by Harry\n+        Metske.\n+\n 2008-06-29  Janne Jalkanen <jalkanen@apache.org>\n \n         * Moved all pages from wikipages under wikipages/en, and"
            },
            {
                "sha": "0427f65c695130cc541198d181aff68292243088",
                "filename": "src/com/ecyrd/jspwiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/4af7285a100a299ba5c4a51f92a904c9870b9411/src/com/ecyrd/jspwiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/4af7285a100a299ba5c4a51f92a904c9870b9411/src/com/ecyrd/jspwiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/Release.java?ref=4af7285a100a299ba5c4a51f92a904c9870b9411",
                "patch": "@@ -77,7 +77,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"51\";\n+    public static final String     BUILD         = \"52\";\n     \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "6d228aeae0a3f9775312491b93d64c0a215df07b",
                "filename": "src/com/ecyrd/jspwiki/providers/CachingAttachmentProvider.java",
                "status": "modified",
                "additions": 26,
                "deletions": 4,
                "changes": 30,
                "blob_url": "https://github.com/apache/jspwiki/blob/4af7285a100a299ba5c4a51f92a904c9870b9411/src/com/ecyrd/jspwiki/providers/CachingAttachmentProvider.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/4af7285a100a299ba5c4a51f92a904c9870b9411/src/com/ecyrd/jspwiki/providers/CachingAttachmentProvider.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/providers/CachingAttachmentProvider.java?ref=4af7285a100a299ba5c4a51f92a904c9870b9411",
                "patch": "@@ -31,6 +31,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n import com.ecyrd.jspwiki.attachment.AttachmentManager;\n import com.ecyrd.jspwiki.util.ClassUtil;\n import com.opensymphony.oscache.base.Cache;\n+import com.opensymphony.oscache.base.CacheEntry;\n import com.opensymphony.oscache.base.NeedsRefreshException;\n import com.opensymphony.oscache.base.events.*;\n \n@@ -419,6 +420,21 @@ public void moveAttachmentsForPage( String oldParent, String newParent )\n         m_provider.moveAttachmentsForPage(oldParent, newParent);\n         m_cache.removeEntry( newParent ); \n         m_cache.removeEntry( oldParent );\n+        \n+        //\n+        //  This is a kludge to make sure that the pages are removed\n+        //  from the other cache as well.\n+        //\n+        String checkName = oldParent + \"/\";\n+        \n+        Collection<String> names = cloneCollection( m_allCollector.m_allItems.keySet() );\n+        for( String name : names )\n+        {\n+            if( name.startsWith( checkName ) )\n+            {\n+                m_attCache.removeEntry( name );\n+            }\n+        }\n     }\n \n     /**\n@@ -456,11 +472,17 @@ public void cacheEntryRemoved( CacheEntryEvent aEvent )\n                 {\n                     log.debug( \"attachment cache entry removed: \" + aEvent.getKey() );\n                 }\n-                Attachment item = (Attachment) aEvent.getEntry().getContent();\n-\n-                if( item != null )\n+                \n+                CacheEntry e = aEvent.getEntry();\n+                \n+                if( e != null )\n                 {\n-                    m_allItems.remove( item.getName() );\n+                    Attachment item = (Attachment) e.getContent();\n+\n+                    if( item != null )\n+                    {\n+                        m_allItems.remove( item.getName() );\n+                    }\n                 }\n             }\n         }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/e6d405d09ca4f8c10e0fed34cd2b4f40d359c5c1",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/9449e18420c1bbc9a52f234c6fab17560d71c9e5",
        "message": "Bugfix: Found and killed an NPE in TextUtil that was causing NewGroups.jsp to fail.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@625161 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_40",
        "file": [
            {
                "sha": "79ca60d41c6a7743a2fd0e3dbc4540f009da1a8e",
                "filename": "src/com/ecyrd/jspwiki/TextUtil.java",
                "status": "modified",
                "additions": 7,
                "deletions": 1,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/e6d405d09ca4f8c10e0fed34cd2b4f40d359c5c1/src/com/ecyrd/jspwiki/TextUtil.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/e6d405d09ca4f8c10e0fed34cd2b4f40d359c5c1/src/com/ecyrd/jspwiki/TextUtil.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/TextUtil.java?ref=e6d405d09ca4f8c10e0fed34cd2b4f40d359c5c1",
                "patch": "@@ -144,8 +144,14 @@ protected static String urlDecode( byte[] bytes, String encoding )\n      */\n     public static String urlEncodeUTF8( String text )\n     {\n+        // If text is null, just return an empty string\n+        if ( text == null )\n+        {\n+            return \"\";\n+        }\n+        \n         byte[] rs = {};\n-\n+        \n         try\n         {\n             rs = text.getBytes(\"UTF-8\");"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/85008859e84df601f7337edbef684720e02c067e",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/02f8c877c0afd862dffd8c3603b3085eff473050",
        "message": "getVersionHistory() now returns a List\nTemporary fix to a NPE when running Windows.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@622452 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_41",
        "file": [
            {
                "sha": "380e92e24e60b250cc3d29921aad15b54b44f06d",
                "filename": "src/com/ecyrd/jspwiki/providers/BasicAttachmentProvider.java",
                "status": "modified",
                "additions": 2,
                "deletions": 2,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/85008859e84df601f7337edbef684720e02c067e/src/com/ecyrd/jspwiki/providers/BasicAttachmentProvider.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/85008859e84df601f7337edbef684720e02c067e/src/com/ecyrd/jspwiki/providers/BasicAttachmentProvider.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/providers/BasicAttachmentProvider.java?ref=85008859e84df601f7337edbef684720e02c067e",
                "patch": "@@ -146,7 +146,7 @@ private int findLatestVersion( Attachment att )\n             int cutpoint = pages[i].indexOf( '.' );\n             if( cutpoint > 0 )\n             {\n-                String pageNum = pages[i].substring( 0, cutpoint );\n+                String pageNum = ( cutpoint > 0 ) ? pages[i].substring( 0, cutpoint ) : pages[i] ;\n \n                 try\n                 {\n@@ -432,7 +432,7 @@ public Attachment getAttachmentInfo( WikiPage page, String name, int version )\n         return att;\n     }\n \n-    public Collection getVersionHistory( Attachment att )\n+    public List getVersionHistory( Attachment att )\n     {\n         ArrayList list = new ArrayList();\n "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/7e35b0bf86c7b78bafae93bc0fa49793e6b2f950",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/3eac9e23b36e8eb6fa564bd33679a1e5c30c9be1",
        "message": "Now fails gracefully instead of NPE when input file is not proper.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@622350 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_42",
        "file": [
            {
                "sha": "aca673f4e2bf73af60ab5096103f76d3098bd526",
                "filename": "src/com/ecyrd/jspwiki/attachment/AttachmentServlet.java",
                "status": "modified",
                "additions": 24,
                "deletions": 5,
                "changes": 29,
                "blob_url": "https://github.com/apache/jspwiki/blob/7e35b0bf86c7b78bafae93bc0fa49793e6b2f950/src/com/ecyrd/jspwiki/attachment/AttachmentServlet.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7e35b0bf86c7b78bafae93bc0fa49793e6b2f950/src/com/ecyrd/jspwiki/attachment/AttachmentServlet.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/attachment/AttachmentServlet.java?ref=7e35b0bf86c7b78bafae93bc0fa49793e6b2f950",
                "patch": "@@ -208,6 +208,8 @@ public void doPost( HttpServletRequest  req, HttpServletResponse res )\n      *\n      *  @return The page to which we should go next.\n      */\n+\n+    // FIXME: Error reporting is non-existent - the user gets no feedback whatsoever.\n     protected String upload( HttpServletRequest req )\n     {\n         String msg     = \"\";\n@@ -231,9 +233,25 @@ protected String upload( HttpServletRequest req )\n             {\n                 String part = (String) files.nextElement();\n                 File   f    = multi.getFile( part );\n-                InputStream in;\n                 AttachmentManager mgr = m_engine.getAttachmentManager();\n+                InputStream in;\n+\n+                //\n+                //  Is a file to be uploaded.\n+                //\n+\n+                String filename = multi.getFileSystemName( part );\n+\n+                if( filename == null || filename.trim().length() == 0 )\n+                {\n+                    log.error(\"Empty file name given.\");\n \n+                    return nextPage;\n+                }\n+\n+                //\n+                //  Attempt to open the input stream\n+                //\n                 if( f != null )\n                 {\n                     in = new FileInputStream( f );\n@@ -243,11 +261,12 @@ protected String upload( HttpServletRequest req )\n                     in = multi.getFileContents( part );\n                 }\n \n-                //\n-                //  Is a file to be uploaded.\n-                //\n+                if( in == null )\n+                {\n+                    log.error(\"File could not be opened.\");\n \n-                String filename = multi.getFileSystemName( part );\n+                    return nextPage;\n+                }\n \n                 //\n                 //  Check whether we already have this kind of a page."
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/7a24a129ab55caa0ebda308cff3cca39ae571efa",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/0c52a3aaede526056ec94f1b6c10d355a1fbf424",
        "message": "3.0.0-svn-43 JSPWIKI-452 - The LoggerFactory is now also multi-wiki-per-JVM capable\n        Fixed a lot JUnit tests, mostly adding a m_engine.shutdown() to the tearDown()\n        \n        Removed the NPE checks from LoggerImpl, the NPE's were a result of stopping\n        the webapp before stopping the background threads, this has been solved by\n        invoking engine.shutdown() from the SessionMonitor (thanks to Andrew).\n        \n        Cleanup of AdminBeanManager and WikiEngine\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@731025 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_43",
        "file": [
            {
                "sha": "b7bfa39aa92e5ae6d4959208e14712daba2d2889",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 13,
                "deletions": 0,
                "changes": 13,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -1,3 +1,16 @@\n+2009-01-03  Harry Metske <metskem@apache.org>\n+\n+        * 3.0.0-svn-43\n+        \n+        * JSPWIKI-452 - The LoggerFactory is now also multi-wiki-per-JVM capable\n+        Fixed a lot JUnit tests, mostly adding a m_engine.shutdown() to the tearDown()\n+        \n+        Removed the NPE checks from LoggerImpl, the NPE's were a result of stopping\n+        the webapp before stopping the background threads, this has been solved by\n+        invoking engine.shutdown() from the SessionMonitor (thanks to Andrew).\n+        \n+        Cleanup of AdminBeanManager and WikiEngine\n+\n 2009-01-02  Harry Metske <metskem@apache.org>\n \n         * 3.0.0-svn-42"
            },
            {
                "sha": "5e76924a257c9ba29dff24e71cca41eff4ed2a32",
                "filename": "src/com/ecyrd/jspwiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/Release.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -77,7 +77,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"42\";\n+    public static final String     BUILD         = \"43\";\n     \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "b9c9959da2943592e51ad5a68d4da5de34d86a17",
                "filename": "src/com/ecyrd/jspwiki/WikiEngine.java",
                "status": "modified",
                "additions": 2,
                "deletions": 16,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/WikiEngine.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/WikiEngine.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/WikiEngine.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -428,25 +428,11 @@ private void initialize( Properties props )\n         m_startTime  = new Date();\n         m_properties = props;\n \n-        //\n-        //  Initialized log4j.  However, make sure that\n-        //  we don't initialize it multiple times.  Also, if\n-        //  all of the log4j statements have been removed from\n-        //  the property file, we do not do any property setting\n-        //  either.q\n-        //\n-//        if( !c_configured )\n-//        {\n-//            if( props.getProperty(\"log4j.rootCategory\") != null )\n-//            {\n-//                PropertyConfigurator.configure( props );\n-//            }\n-//            c_configured = true;\n-//        }\n+        LoggerFactory.initialize( m_properties.getProperty( PROP_APPNAME ) );\n \n         log.info(\"*******************************************\");\n         log.info(Release.APPNAME+\" \"+Release.getVersionString()+\" starting. Whee!\");\n-\n+        \n         fireEvent( WikiEngineEvent.INITIALIZING ); // begin initialization\n \n         log.debug(\"Java version: \"+System.getProperty(\"java.runtime.version\"));"
            },
            {
                "sha": "442d611070ac021d3ecf8f956e5bf0f7eb36a5c6",
                "filename": "src/com/ecyrd/jspwiki/log/LoggerFactory.java",
                "status": "modified",
                "additions": 36,
                "deletions": 12,
                "changes": 48,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/log/LoggerFactory.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/log/LoggerFactory.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/log/LoggerFactory.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -32,6 +32,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n import org.slf4j.bridge.SLF4JBridgeHandler;\n \n import com.ecyrd.jspwiki.Release;\n+import com.ecyrd.jspwiki.WikiEngine;\n+import com.ecyrd.jspwiki.parser.MarkupParser;\n \n /**\n  * <p>\n@@ -62,12 +64,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private static final String LOG4J_LOGGER_CLASS = \"org.apache.log4j.Logger\";\n \n     private static HashMap<String, LoggerImpl> c_registeredLoggers = new HashMap<String, LoggerImpl>( 200 );\n-\n-    /**\n-     *   @TODO  We need something here to make the Logger MBeans unique across the JVM, this will not work if you\n-     *                     run multiple wiki's in the same JVM, same is true for other MBeans. \n-     */\n-    private static final String OBJECTNAME_PREFIX = Release.APPNAME + \":component=Loggers,name=\";\n+    \n+    private static String c_wikiName = null;\n \n     static\n     {\n@@ -80,7 +78,19 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private LoggerFactory()\n     {}\n \n-\n+    /**\n+     * The wikiName should be passed to us as soon as possible.\n+     * This means that we cannot register all LoggerMBeans because \n+     * some request for Loggers come in before we have the wikiName\n+     * \n+     * @param wikiName the name of the Wiki, this is necessary if we run multiple\n+     *                           wikis in the same JVM\n+     */\n+    public static void initialize( String wikiName )\n+    {\n+        c_wikiName = MarkupParser.cleanLink( wikiName );\n+    }\n+    \n     /**\n      *  Utility method for locating a Logger based on a Class.\n      *  \n@@ -156,11 +166,20 @@ private static void registerLoggerMBean( String loggerName )\n             Class mbeanClass = Class.forName( \"org.apache.log4j.jmx.LoggerDynamicMBean\" );\n             Constructor constr = mbeanClass.getConstructor( loggerClass );\n             Object dynMBean = constr.newInstance( arglist );\n-            ObjectName mbeanName = new ObjectName( Release.APPNAME + \":component=Loggers,name=\" + loggerName );\n-            MBeanServer mbeanServer =  ManagementFactory.getPlatformMBeanServer();\n-            if( !mbeanServer.isRegistered( mbeanName ) )\n+            ObjectName mbeanName = new ObjectName( getObjectNamePrefix() + loggerName );\n+            MBeanServer mbeanServer = ManagementFactory.getPlatformMBeanServer();\n+            if( c_wikiName != null )\n             {\n-                mbeanServer.registerMBean( dynMBean, mbeanName );\n+                if( !mbeanServer.isRegistered( mbeanName ) )\n+                {\n+                    mbeanServer.registerMBean( dynMBean, mbeanName );\n+                }\n+                else\n+                {\n+                    throw new RuntimeException( \"JMX bean named \" + getObjectNamePrefix() + loggerName\n+                                                + \" is already registered. Hint: are you running 2 webapps with the same \"\n+                                                + WikiEngine.PROP_APPNAME + \"?\" );\n+                }\n             }\n         }\n         catch( ClassNotFoundException cnfe )\n@@ -189,7 +208,7 @@ public static void unRegisterAllLoggerMBeans()\n         {\n             try\n             {\n-                ObjectName mbeanName = new ObjectName( OBJECTNAME_PREFIX + loggerName );\n+                ObjectName mbeanName = new ObjectName( getObjectNamePrefix() + loggerName );\n                 ManagementFactory.getPlatformMBeanServer().unregisterMBean( mbeanName );\n             }\n             catch( Exception e )\n@@ -198,4 +217,9 @@ public static void unRegisterAllLoggerMBeans()\n             }\n         }\n     }\n+    \n+    private static String getObjectNamePrefix() \n+    {\n+        return Release.APPNAME + \":wiki=\" + c_wikiName + \",component=Loggers,name=\";\n+    }\n }"
            },
            {
                "sha": "6b05d2faab3d834480ab4ebb6f84876ebaf4643d",
                "filename": "src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "status": "modified",
                "additions": 4,
                "deletions": 4,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/log/LoggerImpl.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/log/LoggerImpl.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -143,24 +143,24 @@ public void debug( String string, Throwable t, Object... params )\n     /** {@inheritDoc} */\n     public boolean isErrorEnabled()\n     {\n-        return m_slf4jLogger == null ? false : m_slf4jLogger.isErrorEnabled();\n+        return m_slf4jLogger.isErrorEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isWarnEnabled()\n     {\n-        return m_slf4jLogger == null ? false : m_slf4jLogger.isWarnEnabled();\n+        return m_slf4jLogger.isWarnEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isInfoEnabled()\n     {\n-        return m_slf4jLogger == null ? false : m_slf4jLogger.isInfoEnabled();\n+        return m_slf4jLogger.isInfoEnabled();\n     }\n \n     /** {@inheritDoc} */\n     public boolean isDebugEnabled()\n     {\n-        return m_slf4jLogger == null ? false : m_slf4jLogger.isDebugEnabled();\n+        return m_slf4jLogger.isDebugEnabled();\n     }\n }"
            },
            {
                "sha": "f10701309caeca3cefaacf7253ba4a7f44ebf6e3",
                "filename": "src/com/ecyrd/jspwiki/ui/admin/AdminBeanManager.java",
                "status": "modified",
                "additions": 1,
                "deletions": 16,
                "changes": 17,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/ui/admin/AdminBeanManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/ui/admin/AdminBeanManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/ui/admin/AdminBeanManager.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -59,8 +59,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n     public AdminBeanManager( WikiEngine engine )\n     {\n-        log.info(\"Using JDK 1.5 Platform MBeanServer\");\n-        m_mbeanServer = MBeanServerFactory15.getServer();\n+        m_mbeanServer = ManagementFactory.getPlatformMBeanServer();\n \n         m_engine = engine;\n \n@@ -253,20 +252,6 @@ public AdminBean findBean( String id )\n         return null;\n     }\n \n-    /**\n-     *  Provides a JDK 1.5-compliant version of the MBeanServerFactory. This\n-     *  will simply bind to the platform MBeanServer.\n-     */\n-    private static final class MBeanServerFactory15\n-    {\n-        private MBeanServerFactory15()\n-        {}\n-\n-        public static MBeanServer getServer()\n-        {\n-            return ManagementFactory.getPlatformMBeanServer();\n-        }\n-    }\n \n     /**\n      *  Returns the type identifier for a string type."
            },
            {
                "sha": "f2d3da56fc5a7941a6329b8257b44f0e98808e2c",
                "filename": "src/com/ecyrd/jspwiki/util/ClassUtil.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/util/ClassUtil.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/src/com/ecyrd/jspwiki/util/ClassUtil.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/util/ClassUtil.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -311,7 +311,7 @@ public static Object getMappedObject( String requestedClass, Object[] initargs )\n         {\n             log.info( \"You tried to instantiate an abstract class \"+requestedClass, e );\n             \n-            throw new WikiException(\"Failed to instantiate class \"+requestedClass);\n+            throw new WikiException(\"Failed to instantiate class \"+requestedClass + \", reason: \" + e.getCause());\n         }\n     }\n "
            },
            {
                "sha": "c82f15b7285b10f8be7af262d6cf9759730a5946",
                "filename": "tests/com/ecyrd/jspwiki/PageManagerTest.java",
                "status": "modified",
                "additions": 1,
                "deletions": 0,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/PageManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/PageManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/PageManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -50,6 +50,7 @@ public void setUp()\n \n     public void tearDown()\n     {\n+        engine.shutdown();\n     }\n \n     public void testPageCacheExists()"
            },
            {
                "sha": "89572c6a4b4414b7e0d5f85b1f2e16c15eb281fd",
                "filename": "tests/com/ecyrd/jspwiki/ReferenceManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ReferenceManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ReferenceManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/ReferenceManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -92,6 +92,8 @@ public void tearDown()\n         engine.deletePage( \"NewBug\" );\n         engine.deletePage( \"BugOne\" );\n         engine.deletePage( \"BugTwo\" );\n+        \n+        engine.shutdown();\n     }\n \n     public void testNonExistant1()"
            },
            {
                "sha": "2daf9936b5f5c85bbeb0183ec5873b8c9a2ba4e7",
                "filename": "tests/com/ecyrd/jspwiki/VariableManagerTest.java",
                "status": "modified",
                "additions": 4,
                "deletions": 1,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/VariableManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/VariableManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/VariableManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -36,6 +36,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     WikiContext     m_context;\n \n     static final String PAGE_NAME = \"TestPage\";\n+    \n+    TestEngine testEngine = null;\n \n     public VariableManagerTest( String s )\n     {\n@@ -51,7 +53,7 @@ public void setUp()\n             props.load( TestEngine.findTestProperties() );\n \n             m_variableManager = new VariableManager( props );\n-            TestEngine testEngine = new TestEngine( props );\n+            testEngine = new TestEngine( props );\n             m_context = testEngine.getWikiContextFactory().newViewContext( testEngine.createPage(WikiName.valueOf(PAGE_NAME)) );\n \n         }\n@@ -60,6 +62,7 @@ public void setUp()\n \n     public void tearDown()\n     {\n+        testEngine.shutdown();\n     }\n \n     public void testIllegalInsert1()"
            },
            {
                "sha": "4fb80cd2ee90054ca75b4e7c0e4db1cf320eb664",
                "filename": "tests/com/ecyrd/jspwiki/WikiEngineTest.java",
                "status": "modified",
                "additions": 112,
                "deletions": 111,
                "changes": 223,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/WikiEngineTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/WikiEngineTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/WikiEngineTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -72,7 +72,8 @@ public void setUp()\n                            Long.toString(PAGEPROVIDER_RESCAN_PERIOD) );\n \n         TestEngine.emptyWorkDir();\n-        m_engine = new TestEngine(props);        \n+        \n+        m_engine = new TestEngine(props);\n     }\n \n     public void tearDown()\n@@ -87,6 +88,8 @@ public void tearDown()\n         }\n \n         TestEngine.emptyWorkDir();\n+        \n+        m_engine.shutdown();\n     }\n     \n     public void testNonExistantDirectory()\n@@ -100,24 +103,25 @@ public void testNonExistantDirectory()\n         props.setProperty( FileSystemProvider.PROP_PAGEDIR, \n                            newdir );\n \n-        new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n \n         File f = new File( newdir );\n \n         assertTrue( \"didn't create it\", f.exists() );\n         assertTrue( \"isn't a dir\", f.isDirectory() );\n \n         f.delete();\n+        \n     }\n \n-    public void testNonExistantDirProperty()\n-        throws Exception\n+    public void testNonExistantDirProperty() throws Exception\n     {\n         props.remove( FileSystemProvider.PROP_PAGEDIR );\n-\n         try\n         {\n-            new TestEngine( props );\n+            m_engine.shutdown();\n+            m_engine = new TestEngine( props );\n \n             fail( \"Wiki did not warn about missing property.\" );\n         }\n@@ -264,17 +268,16 @@ public void testEncodeNameLatin1()\n                       m_engine.encodeName(name) );\n     }\n \n-    public void testEncodeNameUTF8()\n-        throws Exception\n+    public void testEncodeNameUTF8() throws Exception\n     {\n         String name = \"\\u0041\\u2262\\u0391\\u002E\";\n \n         props.setProperty( WikiEngine.PROP_ENCODING, \"UTF-8\" );\n \n-        WikiEngine engine = new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n \n-        assertEquals( \"A%E2%89%A2%CE%91.\",\n-                      engine.encodeName(name) );\n+        assertEquals( \"A%E2%89%A2%CE%91.\", m_engine.encodeName( name ) );\n     }\n \n     public void testReadLinks()\n@@ -351,77 +354,73 @@ public void testBeautifyTitleArticle2()\n     }\n     */\n \n-    public void testLatestGet()\n-        throws Exception\n+    public void testLatestGet() throws Exception\n     {\n-        props.setProperty( \"jspwiki.pageProvider\", \n-                           \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n+        props.setProperty( \"jspwiki.pageProvider\", \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n         props.setProperty( \"jspwiki.usePageCache\", \"false\" );\n \n-        WikiEngine engine = new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n \n-        WikiPage p = engine.getPage( \"test\", -1 );\n+        WikiPage p = m_engine.getPage( \"test\", -1 );\n \n-        VerySimpleProvider vsp = (VerySimpleProvider) engine.getPageManager().getProvider();\n+        VerySimpleProvider vsp = (VerySimpleProvider) m_engine.getPageManager().getProvider();\n \n         assertEquals( \"wrong page\", \"test\", vsp.m_latestReq );\n         assertEquals( \"wrong version\", -1, vsp.m_latestVers );\n-        assertNotNull(\"null\", p);\n+        assertNotNull( \"null\", p );\n     }\n \n-    public void testLatestGet2()\n-        throws Exception\n+    public void testLatestGet2() throws Exception\n     {\n-        props.setProperty( \"jspwiki.pageProvider\", \n-                           \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n-        props.setProperty( \"jspwiki.usePageCache\", \"false\" );\n+            props.setProperty( \"jspwiki.pageProvider\", \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n+            props.setProperty( \"jspwiki.usePageCache\", \"false\" );\n \n-        WikiEngine engine = new TestEngine( props );\n+            m_engine.shutdown();\n+            m_engine = new TestEngine( props );\n \n-        String p = engine.getText( \"test\", -1 );\n+            String p = m_engine.getText( \"test\", -1 );\n \n-        VerySimpleProvider vsp = (VerySimpleProvider) engine.getPageManager().getProvider();\n+            VerySimpleProvider vsp = (VerySimpleProvider) m_engine.getPageManager().getProvider();\n \n-        assertEquals( \"wrong page\", \"test\", vsp.m_latestReq );\n-        assertEquals( \"wrong version\", -1, vsp.m_latestVers );\n-        assertNotNull(\"null\", p);\n-    }\n+            assertEquals( \"wrong page\", \"test\", vsp.m_latestReq );\n+            assertEquals( \"wrong version\", -1, vsp.m_latestVers );\n+            assertNotNull( \"null\", p );\n+        }\n \n-    public void testLatestGet3()\n-        throws Exception\n+    public void testLatestGet3() throws Exception\n     {\n-        props.setProperty( \"jspwiki.pageProvider\", \n-                           \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n-        props.setProperty( \"jspwiki.usePageCache\", \"false\" );\n+            props.setProperty( \"jspwiki.pageProvider\", \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n+            props.setProperty( \"jspwiki.usePageCache\", \"false\" );\n \n-        WikiEngine engine = new TestEngine( props );\n+            m_engine.shutdown();\n+            m_engine = new TestEngine( props );\n \n-        String p = engine.getHTML( \"test\", -1 );\n+            String p = m_engine.getHTML( \"test\", -1 );\n \n-        VerySimpleProvider vsp = (VerySimpleProvider) engine.getPageManager().getProvider();\n+            VerySimpleProvider vsp = (VerySimpleProvider) m_engine.getPageManager().getProvider();\n \n-        assertEquals( \"wrong page\", \"test\", vsp.m_latestReq );\n-        assertEquals( \"wrong version\", 5, vsp.m_latestVers );\n-        assertNotNull(\"null\", p);\n-    }\n+            assertEquals( \"wrong page\", \"test\", vsp.m_latestReq );\n+            assertEquals( \"wrong version\", 5, vsp.m_latestVers );\n+            assertNotNull( \"null\", p );\n+        }\n \n-    public void testLatestGet4()\n-        throws Exception\n+    public void testLatestGet4() throws Exception\n     {\n-        props.setProperty( \"jspwiki.pageProvider\", \n-                           \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n+        props.setProperty( \"jspwiki.pageProvider\", \"com.ecyrd.jspwiki.providers.VerySimpleProvider\" );\n         props.setProperty( \"jspwiki.usePageCache\", \"true\" );\n \n-        WikiEngine engine = new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n \n-        String p = engine.getHTML( VerySimpleProvider.PAGENAME, -1 );\n+        String p = m_engine.getHTML( VerySimpleProvider.PAGENAME, -1 );\n \n-        CachingProvider cp = (CachingProvider)engine.getPageManager().getProvider();\n+        CachingProvider cp = (CachingProvider) m_engine.getPageManager().getProvider();\n         VerySimpleProvider vsp = (VerySimpleProvider) cp.getRealProvider();\n \n         assertEquals( \"wrong page\", VerySimpleProvider.PAGENAME, vsp.m_latestReq );\n         assertEquals( \"wrong version\", -1, vsp.m_latestVers );\n-        assertNotNull(\"null\", p);\n+        assertNotNull( \"null\", p );\n     }\n \n     /**\n@@ -696,49 +695,50 @@ public void testDeletePageAndAttachments2()\n         assertNull( \"referrers\", refs );\n     }\n     \n-    public void testDeleteVersion()\n-        throws Exception\n+    public void testDeleteVersion() throws Exception\n     {\n         props.setProperty( \"jspwiki.pageProvider\", \"VersioningFileProvider\" );\n-        \n-        TestEngine engine = new TestEngine( props );\n-        engine.saveText( NAME1, \"Test1\" );\n-        engine.saveText( NAME1, \"Test2\" );\n-        engine.saveText( NAME1, \"Test3\" );\n \n-        WikiPage page = engine.getPage( NAME1, 3 );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n+        m_engine.saveText( NAME1, \"Test1\" );\n+        m_engine.saveText( NAME1, \"Test2\" );\n+        m_engine.saveText( NAME1, \"Test3\" );\n+\n+        WikiPage page = m_engine.getPage( NAME1, 3 );\n+\n+        m_engine.deleteVersion( page );\n+\n+        assertNull( \"got page\", m_engine.getPage( NAME1, 3 ) );\n+\n+        String content = m_engine.getText( NAME1, WikiProvider.LATEST_VERSION );\n \n-        engine.deleteVersion( page );\n-        \n-        assertNull( \"got page\", engine.getPage( NAME1, 3 ) );\n-        \n-        String content = engine.getText( NAME1, WikiProvider.LATEST_VERSION );\n-        \n         assertEquals( \"content\", \"Test2\", content.trim() );\n     }\n \n-    public void testDeleteVersion2()\n-        throws Exception\n+    public void testDeleteVersion2() throws Exception\n     {\n-        props.setProperty( \"jspwiki.pageProvider\", \"VersioningFileProvider\" );\n-    \n-        TestEngine engine = new TestEngine( props );\n-        engine.saveText( NAME1, \"Test1\" );\n-        engine.saveText( NAME1, \"Test2\" );\n-        engine.saveText( NAME1, \"Test3\" );\n+            props.setProperty( \"jspwiki.pageProvider\", \"VersioningFileProvider\" );\n \n-        WikiPage page = engine.getPage( NAME1, 1 );\n-        \n-        engine.deleteVersion( page );\n-        \n-        assertNull( \"got page\", engine.getPage( NAME1, 1 ) );\n-        \n-        String content = engine.getText( NAME1, WikiProvider.LATEST_VERSION );\n-        \n-        assertEquals( \"content\", \"Test3\", content.trim() );\n-        \n-        assertEquals( \"content1\", \"\", engine.getText(NAME1, 1).trim() );\n-    }\n+            m_engine.shutdown();\n+            m_engine = new TestEngine( props );\n+            m_engine.saveText( NAME1, \"Test1\" );\n+            m_engine.saveText( NAME1, \"Test2\" );\n+            m_engine.saveText( NAME1, \"Test3\" );\n+\n+            WikiPage page = m_engine.getPage( NAME1, 1 );\n+\n+            m_engine.deleteVersion( page );\n+\n+            assertNull( \"got page\", m_engine.getPage( NAME1, 1 ) );\n+\n+            String content = m_engine.getText( NAME1, WikiProvider.LATEST_VERSION );\n+\n+            assertEquals( \"content\", \"Test3\", content.trim() );\n+\n+            assertEquals( \"content1\", \"\", m_engine.getText( NAME1, 1 ).trim() );\n+        }\n+    \n     \n     /**\n      *  Assumes that CachingProvider is in use.\n@@ -853,34 +853,35 @@ public void testExternalModification()\n     }\n \n     /**\n-     *  Tests BugReadingOfVariableNotWorkingForOlderVersions\n+     * Tests BugReadingOfVariableNotWorkingForOlderVersions\n+     * \n      * @throws Exception\n      */\n-    public void testOldVersionVars()\n-        throws Exception\n-    {   \n-        Properties pr = new Properties();\n-        pr.load( TestEngine.findTestProperties(\"/jspwiki_vers.properties\"));\n-        \n-        pr.setProperty( PageManager.PROP_USECACHE, \"true\" );\n-        \n-        TestEngine engine = new TestEngine( pr );\n-        \n-        engine.saveText( NAME1, \"[{SET foo=bar}]\" );\n-    \n-        engine.saveText( NAME1, \"[{SET foo=notbar}]\");\n-    \n-        WikiPage v1 = engine.getPage( NAME1, 1 );\n-        \n-        WikiPage v2 = engine.getPage( NAME1, 2 );\n-        \n-        assertEquals( \"V1\", \"bar\", v1.getAttribute(\"foo\") );\n-        \n-        // FIXME: The following must run as well\n-        assertEquals( \"V2\", \"notbar\", v2.getAttribute(\"foo\") );\n-        \n-        engine.deletePage( NAME1 );\n-    }\n+    public void testOldVersionVars() throws Exception\n+    {\n+            Properties pr = new Properties();\n+            pr.load( TestEngine.findTestProperties( \"/jspwiki_vers.properties\" ) );\n+\n+            pr.setProperty( PageManager.PROP_USECACHE, \"true\" );\n+\n+            m_engine.shutdown();\n+            m_engine = new TestEngine( pr );\n+\n+            m_engine.saveText( NAME1, \"[{SET foo=bar}]\" );\n+\n+            m_engine.saveText( NAME1, \"[{SET foo=notbar}]\" );\n+\n+            WikiPage v1 = m_engine.getPage( NAME1, 1 );\n+\n+            WikiPage v2 = m_engine.getPage( NAME1, 2 );\n+\n+            assertEquals( \"V1\", \"bar\", v1.getAttribute( \"foo\" ) );\n+\n+            // FIXME: The following must run as well\n+            assertEquals( \"V2\", \"notbar\", v2.getAttribute( \"foo\" ) );\n+\n+            m_engine.deletePage( NAME1 );\n+        }\n     \n     public void testSpacedNames1()\n         throws Exception"
            },
            {
                "sha": "c6fe47b58fe2567410a99d785d2972765f5ffe54",
                "filename": "tests/com/ecyrd/jspwiki/WikiSessionTest.java",
                "status": "modified",
                "additions": 3,
                "deletions": 0,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/WikiSessionTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/WikiSessionTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/WikiSessionTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -63,6 +63,7 @@ protected void setUp() throws Exception\n     protected void tearDown() throws Exception\n     {\n         super.tearDown();\n+        m_engine.shutdown();\n     }\n \n     public void testRoles() throws Exception\n@@ -202,6 +203,8 @@ public void testAuthenticationCookieWhenOn() throws WikiException, ServletExcept\n         Properties props = new Properties();\n         props.load( TestEngine.findTestProperties() );\n         props.setProperty( AuthenticationManager.PROP_ALLOW_COOKIE_AUTH, \"true\");\n+        \n+        m_engine.shutdown();\n         m_engine = new TestEngine( props );\n         \n         MockHttpServletRequest request;"
            },
            {
                "sha": "5ca142d2616f6a0a2a8ec907b4447628d0b362b3",
                "filename": "tests/com/ecyrd/jspwiki/action/GroupActionBeanTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/GroupActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/GroupActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/GroupActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -66,6 +66,8 @@ public void setUp()\n     public void tearDown()\n     {\n         deleteGroup( \"TestGroup\" );\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testView() throws Exception"
            },
            {
                "sha": "f6ce4f4c6ba3987dda6f76874333dc37dbd79f22",
                "filename": "tests/com/ecyrd/jspwiki/action/LoginActionBeanTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/LoginActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/LoginActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/LoginActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -61,6 +61,11 @@ public void setUp()\n         }\n     }\n \n+    public void tearDown()\n+    {\n+        m_engine.shutdown();\n+    }\n+\n     public void testLogin() throws Exception\n     {\n         MockRoundtrip trip;"
            },
            {
                "sha": "ab800edc0a4b00bfe37a82172a486ccca7944cdd",
                "filename": "tests/com/ecyrd/jspwiki/action/RenameActionBeanTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/RenameActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/RenameActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/RenameActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -52,6 +52,11 @@ public void setUp()\n             throw new RuntimeException(\"Could not set up TestEngine: \" + e.getMessage());\n         }\n     }\n+\n+    public void tearDown()\n+    {\n+        m_engine.shutdown();\n+    }\n     \n     public void testValidation() throws Exception {\n         // Save test page"
            },
            {
                "sha": "b361d0a4d85e0fe1e8320040f40f18bbb7665cb0",
                "filename": "tests/com/ecyrd/jspwiki/action/UserPreferencesActionBeanTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/UserPreferencesActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/UserPreferencesActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/UserPreferencesActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -55,6 +55,12 @@ public void setUp()\n         }\n     }\n \n+    public void tearDown()\n+    {\n+        m_engine.shutdown();\n+    }\n+    \n+\n     public void testCreateAssertedName() throws Exception\n     {\n         MockRoundtrip trip;"
            },
            {
                "sha": "0b0def61ff4c1f6ee3e21bfaed871cac9c453991",
                "filename": "tests/com/ecyrd/jspwiki/action/UserProfileActionBeanTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/UserProfileActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/UserProfileActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/UserProfileActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -54,6 +54,12 @@ public void setUp()\n         }\n     }\n \n+    public void tearDown()\n+    {\n+        m_engine.shutdown();\n+    }\n+    \n+\n     public void testMissingParameters() throws Exception\n     {\n         MockRoundtrip trip;"
            },
            {
                "sha": "5facfcada8e3095e12fdfcdd50c56934e2d70ae6",
                "filename": "tests/com/ecyrd/jspwiki/action/ViewActionBeanTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/ViewActionBeanTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/ViewActionBeanTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/ViewActionBeanTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -49,6 +49,12 @@ public void setUp()\n             throw new RuntimeException(\"Could not set up TestEngine: \" + e.getMessage());\n         }\n     }\n+\n+    public void tearDown()\n+    {\n+        m_engine.shutdown();\n+    }\n+    \n     \n     public void testView() throws Exception {\n         // Save page Main"
            },
            {
                "sha": "0f77575d8d5d9b41d83107509451552e0c57eb44",
                "filename": "tests/com/ecyrd/jspwiki/action/WikiContextFactoryTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/WikiContextFactoryTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/action/WikiContextFactoryTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/action/WikiContextFactoryTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -62,6 +62,8 @@ protected void setUp() throws Exception\n     protected void tearDown() throws Exception\n     {\n         m_engine.deletePage( \"TestPage\" );\n+        \n+        m_engine.shutdown();\n     }\n     \n     public void testNewActionBean() throws WikiException"
            },
            {
                "sha": "b436e67c46dc47e7203a3ed41aca7af229b989a5",
                "filename": "tests/com/ecyrd/jspwiki/attachment/AttachmentManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/attachment/AttachmentManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/attachment/AttachmentManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/attachment/AttachmentManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -86,6 +86,8 @@ public void tearDown()\n         TestEngine.deleteAttachments(NAMEU);\n \n         TestEngine.emptyWorkDir();\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testEnabled()        "
            },
            {
                "sha": "de76d99ef122b13edc4a908e694cccaedc7f7ac5",
                "filename": "tests/com/ecyrd/jspwiki/auth/AuthenticationManagerTest.java",
                "status": "modified",
                "additions": 13,
                "deletions": 6,
                "changes": 19,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/AuthenticationManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/AuthenticationManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/AuthenticationManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -29,7 +29,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n import junit.framework.TestSuite;\n \n import com.ecyrd.jspwiki.TestEngine;\n-import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.WikiSession;\n import com.ecyrd.jspwiki.WikiSessionTest;\n import com.ecyrd.jspwiki.auth.authorize.Group;\n@@ -65,7 +64,13 @@ public void setUp() throws Exception\n         m_groupMgr = m_engine.getGroupManager();\n         m_session = WikiSessionTest.adminSession( m_engine );\n     }\n-    \n+\n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     public void testIsUserPrincipal()\n     {\n         assertTrue( AuthenticationManager.isUserPrincipal( new WikiPrincipal( \"Foo\" ) ) );\n@@ -83,8 +88,9 @@ public void testCustomJAASLoginModule() throws Exception\n         props.put( \"jspwiki.loginModule.class\", \"com.ecyrd.jspwiki.auth.login.CookieAssertionLoginModule\" );\n \n         // Init the engine and verify that we initialized with a custom auth login module\n-        WikiEngine engine = new TestEngine( props );\n-        AuthenticationManager authMgr= engine.getAuthenticationManager();\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n+        AuthenticationManager authMgr= m_engine.getAuthenticationManager();\n         assertEquals( CookieAssertionLoginModule.class, authMgr.m_loginModuleClass );\n     }\n \n@@ -99,8 +105,9 @@ public void testCustomJAASLoginModuleOptions() throws Exception\n         props.put( \"jspwiki.loginModule.options.key3\", \"value3\" );\n         \n         // Init the engine and verify that we initialized with the correct options\n-        WikiEngine engine = new TestEngine( props );\n-        AuthenticationManager authMgr= engine.getAuthenticationManager();\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n+        AuthenticationManager authMgr= m_engine.getAuthenticationManager();\n         Map<String,String> options = authMgr.m_loginModuleOptions;\n         assertEquals( 3, options.size() );\n         assertTrue( options.containsKey( \"key1\" ) );"
            },
            {
                "sha": "9928228c5b698b5ed007bee1887955d151dd3df0",
                "filename": "tests/com/ecyrd/jspwiki/auth/AuthorizationManagerTest.java",
                "status": "modified",
                "additions": 7,
                "deletions": 0,
                "changes": 7,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/AuthorizationManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/AuthorizationManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/AuthorizationManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -102,6 +102,12 @@ public void setUp() throws Exception\n         m_session = WikiSessionTest.adminSession( m_engine );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     /**\n      * Tests the default policy. Anonymous users can read, Authenticated can\n      * edit, etc. Uses the default tests/etc/jspwiki.policy file installed by\n@@ -696,6 +702,7 @@ public void testUserPolicy() throws Exception\n         props.put( AuthorizationManager.POLICY, \"jspwiki-testUserPolicy.policy\" );\n         \n         // Initialize the test engine\n+        m_engine.shutdown();\n         m_engine = new TestEngine( props );\n         m_auth = m_engine.getAuthorizationManager();\n         m_groupMgr = m_engine.getGroupManager();"
            },
            {
                "sha": "16f2d4c6252d7c539a4e9b347a23f3ebbc9f023e",
                "filename": "tests/com/ecyrd/jspwiki/auth/GroupManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/GroupManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/GroupManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/GroupManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -95,6 +95,8 @@ public void tearDown() throws WikiException\n         m_groupMgr.removeGroup( \"Test\" );\n         m_groupMgr.removeGroup( \"Test2\" );\n         m_groupMgr.removeGroup( \"Test3\" );\n+        \n+        m_engine.shutdown();\n    }\n \n     public void testParseGroup() throws WikiSecurityException"
            },
            {
                "sha": "899bc84b4f59f0d3a5aa43fdfa8cfa674ddefc28",
                "filename": "tests/com/ecyrd/jspwiki/auth/UserManagerTest.java",
                "status": "modified",
                "additions": 3,
                "deletions": 2,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/UserManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/UserManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/UserManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -36,8 +36,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n import com.ecyrd.jspwiki.auth.user.*;\n import com.ecyrd.jspwiki.workflow.*;\n \n-\n-\n /**\n  * @author Andrew Jaquith\n  */\n@@ -76,6 +74,8 @@ protected void tearDown() throws Exception\n     {\n         groupManager.removeGroup( m_groupName );\n     }\n+    \n+    m_engine.shutdown();\n   }\n \n   /** Call this setup program to use the save-profile workflow. */\n@@ -89,6 +89,7 @@ protected void setUpWithWorkflow() throws Exception\n       \n       // Make sure we are using the XML user database\n       props.put( XMLUserDatabase.PROP_USERDATABASE, \"tests/etc/userdatabase.xml\" );\n+      m_engine.shutdown();\n       m_engine  = new TestEngine( props );\n       m_mgr = m_engine.getUserManager();\n       m_db = m_mgr.getUserDatabase();"
            },
            {
                "sha": "fa38264a223916be9dbdd67c2a5fe96acc13ea8d",
                "filename": "tests/com/ecyrd/jspwiki/auth/acl/AclImplTest.java",
                "status": "modified",
                "additions": 7,
                "deletions": 3,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/acl/AclImplTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/acl/AclImplTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/acl/AclImplTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -53,6 +53,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private GroupManager m_groupMgr;\n \n     private WikiSession  m_session;\n+    \n+    private TestEngine m_engine  = null;\n \n     public AclImplTest( String s )\n     {\n@@ -69,9 +71,9 @@ public void setUp() throws Exception\n         super.setUp();\n         Properties props = new Properties();\n         props.load( TestEngine.findTestProperties() );\n-        TestEngine engine  = new TestEngine( props );\n-        m_groupMgr = engine.getGroupManager();\n-        m_session = WikiSessionTest.adminSession( engine );\n+        m_engine  = new TestEngine( props );\n+        m_groupMgr = m_engine.getGroupManager();\n+        m_session = WikiSessionTest.adminSession( m_engine );\n \n         m_acl = new AclImpl();\n         m_aclGroup = new AclImpl();\n@@ -136,6 +138,8 @@ public void tearDown() throws Exception\n     {\n         m_groupMgr.removeGroup( \"FooGroup\" );\n         m_groupMgr.removeGroup( \"BarGroup\" );\n+        \n+        m_engine.shutdown();\n     }\n \n     private boolean inArray( Object[] array, Object key )"
            },
            {
                "sha": "6967fabe0a48ae66307eb40a47dcde360b7693e0",
                "filename": "tests/com/ecyrd/jspwiki/auth/acl/DefaultAclManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/acl/DefaultAclManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/acl/DefaultAclManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/acl/DefaultAclManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -70,6 +70,8 @@ public void tearDown()\n         catch ( ProviderException e )\n         {\n         }\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testGetPermissions()"
            },
            {
                "sha": "f2ddb3d90ad484f9799ef52891b391629d0e3513",
                "filename": "tests/com/ecyrd/jspwiki/auth/authorize/GroupTest.java",
                "status": "modified",
                "additions": 10,
                "deletions": 2,
                "changes": 12,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/GroupTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/GroupTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/authorize/GroupTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -36,6 +36,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     Group m_group;\n     String m_wiki;\n     \n+    WikiEngine m_engine  = null;\n+    \n     public GroupTest( String s )\n     {\n         super( s );\n@@ -45,11 +47,17 @@ public void setUp() throws Exception\n     {\n         Properties props = new Properties();\n         props.load( TestEngine.findTestProperties() );\n-        WikiEngine engine  = new TestEngine( props );\n-        m_wiki = engine.getApplicationName();\n+        m_engine  = new TestEngine( props );\n+        m_wiki = m_engine.getApplicationName();\n         \n         m_group = new Group( \"TestGroup\", m_wiki );\n     }\n+\n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n     \n     public void testAdd1()\n     {"
            },
            {
                "sha": "fb28c6aa94e60053a67526622cf2b7198f2e7b15",
                "filename": "tests/com/ecyrd/jspwiki/auth/authorize/JDBCGroupDatabaseTest.java",
                "status": "modified",
                "additions": 7,
                "deletions": 3,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/JDBCGroupDatabaseTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/JDBCGroupDatabaseTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/authorize/JDBCGroupDatabaseTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -49,6 +49,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     private JDBCGroupDatabase m_db  = null;\n \n     private String            m_wiki;\n+    \n+    private TestEngine m_engine = null;\n \n     /**\n      * @see junit.framework.TestCase#setUp()\n@@ -59,8 +61,8 @@ protected void setUp() throws Exception\n \n         Properties props = new Properties();\n         props.load( TestEngine.findTestProperties() );\n-        WikiEngine engine = new TestEngine( props );\n-        m_wiki = engine.getApplicationName();\n+        m_engine = new TestEngine( props );\n+        m_wiki = m_engine.getApplicationName();\n \n         // Set up the mock JNDI initial context\n         TestJNDIContext.initialize();\n@@ -87,7 +89,7 @@ protected void setUp() throws Exception\n \n         // Initialize the user database\n         m_db = new JDBCGroupDatabase();\n-        m_db.initialize( engine, new Properties() );\n+        m_db.initialize( m_engine, new Properties() );\n     }\n \n     public void tearDown() throws Exception\n@@ -96,6 +98,8 @@ public void tearDown() throws Exception\n         {\n             m_conn.close();\n         }\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testDelete() throws WikiException"
            },
            {
                "sha": "316a5900018b2b0ac8906173710abac91e9f8d94",
                "filename": "tests/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizerTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/authorize/WebContainerAuthorizerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -58,6 +58,12 @@ public void setUp() throws Exception\n         }\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     public void testConstraints() throws Exception\n     {\n         assertTrue( m_authorizer.isConstrained( \"/Delete.jsp\", new Role( \"Admin\" ) ) );"
            },
            {
                "sha": "d7ec60f9ac5b61c2f7121b58d86e586e755176c8",
                "filename": "tests/com/ecyrd/jspwiki/auth/authorize/XMLGroupDatabaseTest.java",
                "status": "modified",
                "additions": 11,
                "deletions": 4,
                "changes": 15,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/XMLGroupDatabaseTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/authorize/XMLGroupDatabaseTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/authorize/XMLGroupDatabaseTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -27,7 +27,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n import junit.framework.TestCase;\n \n import com.ecyrd.jspwiki.TestEngine;\n-import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.auth.NoSuchPrincipalException;\n import com.ecyrd.jspwiki.auth.WikiPrincipal;\n import com.ecyrd.jspwiki.auth.WikiSecurityException;\n@@ -43,6 +42,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n   private XMLGroupDatabase m_db;\n \n   private String           m_wiki;\n+  \n+  private TestEngine m_engine  = null;\n \n   /**\n    * @see junit.framework.TestCase#setUp()\n@@ -52,10 +53,16 @@ protected void setUp() throws Exception\n       super.setUp();\n       Properties props = new Properties();\n       props.load( TestEngine.findTestProperties() );\n-      WikiEngine engine  = new TestEngine( props );\n+      m_engine  = new TestEngine( props );\n       m_db = new XMLGroupDatabase();\n-      m_db.initialize( engine, props );\n-      m_wiki = engine.getApplicationName();\n+      m_db.initialize( m_engine, props );\n+      m_wiki = m_engine.getApplicationName();\n+  }\n+\n+  protected void tearDown() throws Exception\n+  {\n+      super.tearDown();\n+      m_engine.shutdown();\n   }\n \n   public void testDelete() throws WikiException"
            },
            {
                "sha": "163e923c1a51863cf642c6b416d5bea05d020d33",
                "filename": "tests/com/ecyrd/jspwiki/auth/login/AnonymousLoginModuleTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/AnonymousLoginModuleTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/AnonymousLoginModuleTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/login/AnonymousLoginModuleTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -129,4 +129,10 @@ protected void setUp() throws Exception\n         }\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n }\n\\ No newline at end of file"
            },
            {
                "sha": "aabd8d481e771e83bb1f02c88c6df8845c0557aa",
                "filename": "tests/com/ecyrd/jspwiki/auth/login/CookieAssertionLoginModuleTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/CookieAssertionLoginModuleTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/CookieAssertionLoginModuleTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/login/CookieAssertionLoginModuleTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -141,4 +141,10 @@ protected void setUp() throws Exception\n         }\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n }\n\\ No newline at end of file"
            },
            {
                "sha": "26e99c07678b99c1bcc8158381919d678686931a",
                "filename": "tests/com/ecyrd/jspwiki/auth/login/UserDatabaseLoginModuleTest.java",
                "status": "modified",
                "additions": 8,
                "deletions": 2,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/UserDatabaseLoginModuleTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/UserDatabaseLoginModuleTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/login/UserDatabaseLoginModuleTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -33,7 +33,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n import com.ecyrd.jspwiki.NoRequiredPropertyException;\n import com.ecyrd.jspwiki.TestEngine;\n-import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.auth.WikiPrincipal;\n import com.ecyrd.jspwiki.auth.authorize.Role;\n import com.ecyrd.jspwiki.auth.user.UserDatabase;\n@@ -47,6 +46,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     UserDatabase db;\n \n     Subject      subject;\n+    \n+    private TestEngine m_engine = null;\n \n     public final void testLogin()\n     {\n@@ -122,7 +123,7 @@ protected void setUp() throws Exception\n         Properties props = new Properties();\n         props.load( TestEngine.findTestProperties() );\n         props.put(XMLUserDatabase.PROP_USERDATABASE, \"tests/etc/userdatabase.xml\");\n-        WikiEngine m_engine  = new TestEngine(props);\n+       m_engine  = new TestEngine(props);\n         db = new XMLUserDatabase();\n         subject = new Subject();\n         try\n@@ -136,4 +137,9 @@ protected void setUp() throws Exception\n         }\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n }\n\\ No newline at end of file"
            },
            {
                "sha": "7c286cd9d5fee244e1e4ccf724537b98dc934e89",
                "filename": "tests/com/ecyrd/jspwiki/auth/login/WebContainerLoginModuleTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/WebContainerLoginModuleTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/login/WebContainerLoginModuleTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/login/WebContainerLoginModuleTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -169,5 +169,11 @@ protected void setUp() throws Exception\n             assertTrue( false );\n         }\n     }\n+    \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n \n }\n\\ No newline at end of file"
            },
            {
                "sha": "ee08bc30963b6039467a15cbcd764fb81ffc4ef9",
                "filename": "tests/com/ecyrd/jspwiki/auth/user/UserProfileTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 3,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/user/UserProfileTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/user/UserProfileTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/user/UserProfileTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -28,7 +28,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n import junit.framework.TestSuite;\n \n import com.ecyrd.jspwiki.TestEngine;\n-import com.ecyrd.jspwiki.WikiEngine;\n \n /**\n  *  Tests the DefaultUserProfile class.\n@@ -38,17 +37,20 @@ Licensed to the Apache Software Foundation (ASF) under one\n {\n     private UserDatabase m_db;\n     \n+    private TestEngine m_engine  = null;\n+    \n     public void setUp()\n         throws Exception\n     {\n             Properties props = new Properties();\n             props.load( TestEngine.findTestProperties() );\n-            WikiEngine engine  = new TestEngine(props);\n-            m_db = engine.getUserManager().getUserDatabase();\n+            m_engine  = new TestEngine(props);\n+            m_db = m_engine.getUserManager().getUserDatabase();\n     }\n \n     public void tearDown()\n     {\n+        m_engine.shutdown();\n     }\n     \n     public void testSetAttribute()"
            },
            {
                "sha": "c80a06081728845bd30a046f82125dd14685e18b",
                "filename": "tests/com/ecyrd/jspwiki/auth/user/XMLUserDatabaseTest.java",
                "status": "modified",
                "additions": 10,
                "deletions": 3,
                "changes": 13,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/user/XMLUserDatabaseTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/auth/user/XMLUserDatabaseTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/auth/user/XMLUserDatabaseTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -29,7 +29,6 @@ Licensed to the Apache Software Foundation (ASF) under one\n import junit.framework.TestCase;\n \n import com.ecyrd.jspwiki.TestEngine;\n-import com.ecyrd.jspwiki.WikiEngine;\n import com.ecyrd.jspwiki.auth.NoSuchPrincipalException;\n import com.ecyrd.jspwiki.auth.Users;\n import com.ecyrd.jspwiki.auth.WikiPrincipal;\n@@ -45,6 +44,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n {\n \n   private XMLUserDatabase m_db;\n+  \n+  private TestEngine m_engine = null;\n \n   /**\n    * @see junit.framework.TestCase#setUp()\n@@ -55,9 +56,15 @@ protected void setUp() throws Exception\n       Properties props = new Properties();\n       props.load( TestEngine.findTestProperties() );\n       props.put(XMLUserDatabase.PROP_USERDATABASE, \"tests/etc/userdatabase.xml\");\n-      WikiEngine engine  = new TestEngine(props);\n+      m_engine  = new TestEngine(props);\n       m_db = new XMLUserDatabase();\n-      m_db.initialize(engine, props);\n+      m_db.initialize(m_engine, props);\n+  }\n+  \n+  protected void tearDown() throws Exception\n+  {\n+      super.tearDown();\n+      m_engine.shutdown();\n   }\n \n   public void testDeleteByLoginName() throws WikiSecurityException"
            },
            {
                "sha": "514bf9123bb77de2f0c4ed1e73ab9b7378bab6dd",
                "filename": "tests/com/ecyrd/jspwiki/content/PageRenamerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/content/PageRenamerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/content/PageRenamerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/content/PageRenamerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -73,6 +73,8 @@ protected void tearDown() throws Exception\n         TestEngine.deleteTestPage(\"Link two\");\n \n         TestEngine.emptyWorkDir();\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testSimpleRename()"
            },
            {
                "sha": "5ec52f6b9d4f58f6ad6728ecd000058c73c62c80",
                "filename": "tests/com/ecyrd/jspwiki/dav/AttachmentDavProviderTest.java",
                "status": "modified",
                "additions": 10,
                "deletions": 8,
                "changes": 18,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/AttachmentDavProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/AttachmentDavProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/dav/AttachmentDavProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -35,32 +35,34 @@ Licensed to the Apache Software Foundation (ASF) under one\n {\n     Properties props = new Properties();\n \n-    TestEngine engine;\n+    private TestEngine m_engine = null;\n \n     AttachmentDavProvider m_provider;\n     \n     protected void setUp() throws Exception\n     {\n         props.load( TestEngine.findTestProperties() );\n \n-        engine = new TestEngine(props);\n+        m_engine = new TestEngine(props);\n \n-        m_provider = new AttachmentDavProvider(engine);\n+        m_provider = new AttachmentDavProvider(m_engine);\n     }\n \n     protected void tearDown() throws Exception\n     {\n         TestEngine.deleteAttachments( \"TestPage\" );\n         TestEngine.deleteTestPage(\"TestPage\");\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testGetPageURL()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n-        Attachment att = new Attachment(engine,\"TestPage\",\"deceit of the tribbles.txt\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n+        Attachment att = new Attachment(m_engine,\"TestPage\",\"deceit of the tribbles.txt\");\n         \n-        engine.getAttachmentManager().storeAttachment( att, engine.makeAttachmentFile() );\n+        m_engine.getAttachmentManager().storeAttachment( att, m_engine.makeAttachmentFile() );\n         \n         DavItem di = m_provider.getItem( new DavPath(\"TestPage/deceit of the tribbles.txt\") );\n         \n@@ -72,7 +74,7 @@ public void testGetPageURL()\n     public void testDirURL()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n     \n         DavItem di = m_provider.getItem( new DavPath(\"\") );\n     \n@@ -84,7 +86,7 @@ public void testDirURL()\n     public void testDirURL2()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n \n         DavItem di = m_provider.getItem( new DavPath(\"TestPage/\") );\n "
            },
            {
                "sha": "57d49859ab1adbdd7a207c0907485f95045d980a",
                "filename": "tests/com/ecyrd/jspwiki/dav/HTMLPagesDavProviderTest.java",
                "status": "modified",
                "additions": 8,
                "deletions": 6,
                "changes": 14,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/HTMLPagesDavProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/HTMLPagesDavProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/dav/HTMLPagesDavProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -35,28 +35,30 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n     Properties props = new Properties();\n \n-    TestEngine engine;\n+    private TestEngine m_engine = null;\n \n     HTMLPagesDavProvider m_provider;\n         \n     protected void setUp() throws Exception\n     {\n         props.load( TestEngine.findTestProperties() );\n \n-        engine = new TestEngine(props);\n+        m_engine = new TestEngine(props);\n \n-        m_provider = new HTMLPagesDavProvider(engine);\n+        m_provider = new HTMLPagesDavProvider(m_engine);\n     }\n \n     protected void tearDown() throws Exception\n     {\n         TestEngine.deleteTestPage(\"TestPage\");\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testGetPageURL()\n     throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n             \n         DavItem di = m_provider.getItem( new DavPath(\"t/TestPage.html\") );\n             \n@@ -67,7 +69,7 @@ public void testGetPageURL()\n     public void testDirURL()\n     throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n         \n         DavItem di = m_provider.getItem( new DavPath(\"\") );\n         \n@@ -79,7 +81,7 @@ public void testDirURL()\n     public void testDirURL2()\n     throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n \n         DavItem di = m_provider.getItem( new DavPath(\"t/\") );\n "
            },
            {
                "sha": "7d5fe14499099b79eb5894ccb77e05f23664f725",
                "filename": "tests/com/ecyrd/jspwiki/dav/RawPagesDavProviderTest.java",
                "status": "modified",
                "additions": 8,
                "deletions": 6,
                "changes": 14,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/RawPagesDavProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/dav/RawPagesDavProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/dav/RawPagesDavProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -34,28 +34,30 @@ Licensed to the Apache Software Foundation (ASF) under one\n {\n     Properties props = new Properties();\n \n-    TestEngine engine;\n+    private TestEngine m_engine = null;\n \n     RawPagesDavProvider m_provider;\n     \n     protected void setUp() throws Exception\n     {\n         props.load( TestEngine.findTestProperties() );\n \n-        engine = new TestEngine(props);\n+        m_engine = new TestEngine(props);\n \n-        m_provider = new RawPagesDavProvider(engine);\n+        m_provider = new RawPagesDavProvider(m_engine);\n     }\n \n     protected void tearDown() throws Exception\n     {\n         TestEngine.deleteTestPage(\"TestPage\");\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testGetPageURL()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n         \n         DavItem di = m_provider.getItem( new DavPath(\"t/TestPage.txt\") );\n         \n@@ -66,7 +68,7 @@ public void testGetPageURL()\n     public void testDirURL()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n     \n         DavItem di = m_provider.getItem( new DavPath(\"\") );\n     \n@@ -78,7 +80,7 @@ public void testDirURL()\n     public void testDirURL2()\n         throws Exception\n     {\n-        engine.saveText(\"TestPage\", \"foobar\");\n+        m_engine.saveText(\"TestPage\", \"foobar\");\n \n         DavItem di = m_provider.getItem( new DavPath(\"t/\") );\n "
            },
            {
                "sha": "42ed93bca356deac878f00860d6c993877bb77cc",
                "filename": "tests/com/ecyrd/jspwiki/diff/ContextualDiffProviderTest.java",
                "status": "modified",
                "additions": 20,
                "deletions": 2,
                "changes": 22,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/diff/ContextualDiffProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/diff/ContextualDiffProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/diff/ContextualDiffProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -33,6 +33,23 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n public class ContextualDiffProviderTest extends TestCase\n {\n+    private TestEngine m_engine = null;\n+    \n+    public void setUp() throws Exception\n+    {\n+        Properties props = new Properties();\n+        props.load( TestEngine.findTestProperties() );\n+        m_engine = new TestEngine(props);\n+    }\n+\n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n+    \n+    \n     /**\n      * Sets up some shorthand notation for writing test cases.\n      * <p>\n@@ -199,9 +216,10 @@ private void diffTest(String contextLimit, String oldText, String newText, Strin\n         diff.initialize(null, props);\n \n         props.load( TestEngine.findTestProperties() );\n-        TestEngine engine = new TestEngine(props);\n+        m_engine.shutdown();\n+        m_engine = new TestEngine(props);\n         \n-        WikiContext ctx = engine.getWikiContextFactory().newViewContext( engine.createPage( \"Dummy\" ) );\n+        WikiContext ctx = m_engine.getWikiContextFactory().newViewContext( m_engine.createPage( \"Dummy\" ) );\n         String actualDiff = diff.makeDiffHtml( ctx, oldText, newText);\n \n         assertEquals(expectedDiff, actualDiff);"
            },
            {
                "sha": "a5bde7292f7f93c9536b6f6761186b04ef2981d2",
                "filename": "tests/com/ecyrd/jspwiki/filters/FilterManagerTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 4,
                "changes": 9,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/filters/FilterManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/filters/FilterManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/filters/FilterManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -30,7 +30,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n {\n     Properties props = new Properties();\n \n-    TestEngine engine;\n+    private TestEngine m_engine = null;\n \n     public FilterManagerTest( String s )\n     {\n@@ -41,18 +41,19 @@ public void setUp()\n         throws Exception\n     {\n         props.load( TestEngine.findTestProperties() );\n-        engine = new TestEngine(props);\n+        m_engine = new TestEngine(props);\n     }\n \n     public void tearDown()\n     {\n+        m_engine.shutdown();\n     }\n \n     @SuppressWarnings(\"deprecation\")\n     public void testInitFilters()\n         throws Exception\n     {\n-        FilterManager m = new FilterManager( engine, props );\n+        FilterManager m = new FilterManager( m_engine, props );\n \n         List l = m.getFilterList();\n \n@@ -71,7 +72,7 @@ public void testInitFilters()\n     public void testInitParams()\n         throws Exception\n     {\n-        FilterManager m = new FilterManager( engine, props );\n+        FilterManager m = new FilterManager( m_engine, props );\n \n         List l = m.getFilterList();\n "
            },
            {
                "sha": "ea5da3ce632aa62e4a9d88f0d1f0b9d21bae9cb9",
                "filename": "tests/com/ecyrd/jspwiki/parser/JSPWikiMarkupParserTest.java",
                "status": "modified",
                "additions": 16,
                "deletions": 15,
                "changes": 31,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/parser/JSPWikiMarkupParserTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/parser/JSPWikiMarkupParserTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/parser/JSPWikiMarkupParserTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -53,7 +53,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n     static final String PAGE_NAME = \"testpage\";\n \n-    TestEngine testEngine;\n+    private TestEngine testEngine;\n \n \n     public JSPWikiMarkupParserTest( String s )\n@@ -73,6 +73,8 @@ public void setUp()\n     public void tearDown()\n     {\n         deleteCreatedPages();\n+        \n+        testEngine.shutdown();\n     }\n \n     private void newPage( String name )\n@@ -144,6 +146,7 @@ private String translate_nofollow( String src )\n         props.load( TestEngine.findTestProperties() );\n \n         props.setProperty( \"jspwiki.translatorReader.useRelNofollow\", \"true\" );\n+        testEngine.shutdown();\n         TestEngine testEngine2 = new TestEngine( props );\n \n         WikiContext context = testEngine2.getWikiContextFactory().newViewContext( testEngine2.createPage( PAGE_NAME ) );\n@@ -690,7 +693,7 @@ public void testAttachmentLink2()\n     {\n         props.setProperty( \"jspwiki.encoding\", \"ISO-8859-1\" );\n \n-        //TODO\n+        testEngine.shutdown();\n         TestEngine testEngine2 = new TestEngine( props );\n \n         testEngine2.saveText( \"Test\", \"foo \");\n@@ -714,41 +717,37 @@ public void testAttachmentLink2()\n     public void testAttachmentLink3()\n     throws Exception\n     {\n-        TestEngine testEngine2 = new TestEngine( props );\n-\n-        testEngine2.saveText( \"TestPage\", \"foo \");\n+        testEngine.saveText( \"TestPage\", \"foo \");\n         created.addElement( \"TestPage\" );\n \n-        Attachment att = new Attachment( testEngine2, \"TestPage\", \"TestAtt.txt\" );\n+        Attachment att = new Attachment( testEngine, \"TestPage\", \"TestAtt.txt\" );\n         att.setAuthor( \"FirstPost\" );\n \n-        testEngine2.getAttachmentManager().storeAttachment( att, testEngine.makeAttachmentFile() );\n+        testEngine.getAttachmentManager().storeAttachment( att, testEngine.makeAttachmentFile() );\n \n         String src = \"[Test page/TestAtt.txt]\";\n \n         assertEquals( \"<a class=\\\"attachment\\\" href=\\\"/attach/TestPage/TestAtt.txt\\\">Test page/TestAtt.txt</a>\"+\n                       \"<a href=\\\"/PageInfo.jsp?page=TestPage/TestAtt.txt\\\" class=\\\"infolink\\\"><img src=\\\"/images/attachment_small.png\\\" border=\\\"0\\\" alt=\\\"(info)\\\" /></a>\",\n-                      translate(testEngine2,src));\n+                      translate(testEngine,src));\n     }\n \n     public void testAttachmentLink4()\n     throws Exception\n     {\n-        TestEngine testEngine2 = new TestEngine( props );\n-\n-        testEngine2.saveText( \"TestPage\", \"foo \");\n+        testEngine.saveText( \"TestPage\", \"foo \");\n         created.addElement( \"TestPage\" );\n \n-        Attachment att = new Attachment( testEngine2, \"TestPage\", \"TestAtt.txt\" );\n+        Attachment att = new Attachment( testEngine, \"TestPage\", \"TestAtt.txt\" );\n         att.setAuthor( \"FirstPost\" );\n \n-        testEngine2.getAttachmentManager().storeAttachment( att, testEngine.makeAttachmentFile() );\n+        testEngine.getAttachmentManager().storeAttachment( att, testEngine.makeAttachmentFile() );\n \n-        String src = \"[\"+testEngine2.beautifyTitle(\"TestPage/TestAtt.txt\")+\"]\";\n+        String src = \"[\"+testEngine.beautifyTitle(\"TestPage/TestAtt.txt\")+\"]\";\n \n         assertEquals( \"<a class=\\\"attachment\\\" href=\\\"/attach/TestPage/TestAtt.txt\\\">Test Page/TestAtt.txt</a>\"+\n                       \"<a href=\\\"/PageInfo.jsp?page=TestPage/TestAtt.txt\\\" class=\\\"infolink\\\"><img src=\\\"/images/attachment_small.png\\\" border=\\\"0\\\" alt=\\\"(info)\\\" /></a>\",\n-                      translate(testEngine2,src));\n+                      translate(testEngine,src));\n     }\n \n     public void testNoHyperlink()\n@@ -1198,6 +1197,7 @@ public void testHTMLWhenAllowed()\n         String src = \"<p>\";\n \n         props.setProperty( \"jspwiki.translatorReader.allowHTML\", \"true\" );\n+        testEngine.shutdown();\n         testEngine = new TestEngine( props );\n \n         WikiPage page = testEngine.createPage( WikiName.valueOf( PAGE_NAME ) );\n@@ -1213,6 +1213,7 @@ public void testHTMLWhenAllowedPre()\n         String src = \"{{{ <br /> }}}\";\n \n         props.setProperty( \"jspwiki.translatorReader.allowHTML\", \"true\" );\n+        testEngine.shutdown();\n         testEngine = new TestEngine( props );\n \n         WikiPage page = testEngine.createPage( WikiName.valueOf( PAGE_NAME ) );"
            },
            {
                "sha": "7ee66835c19dd7c7ef3e486d6c66ee7737d94591",
                "filename": "tests/com/ecyrd/jspwiki/plugin/CounterPluginTest.java",
                "status": "modified",
                "additions": 1,
                "deletions": 0,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/CounterPluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/CounterPluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/CounterPluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -60,6 +60,7 @@ public void setUp()\n \n     public void tearDown()\n     {\n+        testEngine.shutdown();\n     }\n \n     private String translate( String src )"
            },
            {
                "sha": "b454ebae8d486ef4f11f8ab34740eff7f79662c8",
                "filename": "tests/com/ecyrd/jspwiki/plugin/DenouncePluginTest.java",
                "status": "modified",
                "additions": 1,
                "deletions": 0,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/DenouncePluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/DenouncePluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/DenouncePluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -82,6 +82,7 @@ public void tearDown() {\n         TestEngine.deleteTestPage(\"TestPage\");\n         TestEngine.deleteTestPage(\"Foobar\");\n         TestEngine.emptyWorkDir();\n+        engine.shutdown();\n     }\n \n     public void testSLURPBot() throws Exception {"
            },
            {
                "sha": "d402dac01a0dc111ff862f6280135fad22be5ddc",
                "filename": "tests/com/ecyrd/jspwiki/plugin/InsertPageTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/InsertPageTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/InsertPageTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/InsertPageTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -47,6 +47,8 @@ protected void tearDown() throws Exception\n         TestEngine.deleteTestPage( \"Test_Page\" );\n         TestEngine.deleteTestPage( \"TestPage\" );\n         TestEngine.deleteTestPage( \"Test Page\" );\n+        \n+        testEngine.shutdown();\n     }\n \n     public void testRecursive() throws Exception"
            },
            {
                "sha": "bcb670276113c2a418df781cfe9425bc1d6278b0",
                "filename": "tests/com/ecyrd/jspwiki/plugin/PluginIndexPluginTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/PluginIndexPluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/PluginIndexPluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/PluginIndexPluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -49,6 +49,8 @@ public void setUp() throws Exception\n     public void tearDown()\n     {\n         TestEngine.emptyWorkDir();\n+        \n+        engine.shutdown();\n     }\n \n     public static Test suite()"
            },
            {
                "sha": "17700e3763712ca80741f60476f215da9d4a4474",
                "filename": "tests/com/ecyrd/jspwiki/plugin/PluginManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/PluginManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/PluginManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/PluginManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -64,6 +64,8 @@ public void setUp()\n     public void tearDown() throws ProviderException\n     {\n         engine.deletePage(\"Testpage\");\n+        \n+        engine.shutdown();\n     }\n \n     public void testSimpleInsert()"
            },
            {
                "sha": "eed1d722b050c7f90911b9caf4b6a7529ab3dcff",
                "filename": "tests/com/ecyrd/jspwiki/plugin/ReferredPagesPluginTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/ReferredPagesPluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/ReferredPagesPluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/ReferredPagesPluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -70,6 +70,8 @@ public void tearDown()\n         TestEngine.deleteTestPage( \"IPointToTwoPages\" );\n         \n         TestEngine.emptyWorkDir();\n+        \n+        engine.shutdown();\n     }\n \n     /**"
            },
            {
                "sha": "d38d2773388869753f5194d0741c64d275c791f7",
                "filename": "tests/com/ecyrd/jspwiki/plugin/ReferringPagesPluginTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/ReferringPagesPluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/ReferringPagesPluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/ReferringPagesPluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -76,6 +76,8 @@ public void tearDown()\n         TestEngine.deleteTestPage( \"Foobar5\" );\n         TestEngine.deleteTestPage( \"Foobar6\" );\n         TestEngine.deleteTestPage( \"Foobar7\" );\n+        \n+        engine.shutdown();\n     }\n \n     private String mkLink( String page )"
            },
            {
                "sha": "6edc71510a81f5f347041c958590f3966e31c535",
                "filename": "tests/com/ecyrd/jspwiki/plugin/TableOfContentsTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/TableOfContentsTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/TableOfContentsTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/TableOfContentsTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -64,6 +64,8 @@ protected void tearDown() throws Exception\n         super.tearDown();\n         \n         testEngine.deletePage( \"Test\" );\n+        \n+        testEngine.shutdown();\n     }\n \n     public void testHeadingVariables()"
            },
            {
                "sha": "9508d82101c31f03c968587c5435bba74b35097d",
                "filename": "tests/com/ecyrd/jspwiki/plugin/UndefinedPagesPluginTest.java",
                "status": "modified",
                "additions": 1,
                "deletions": 0,
                "changes": 1,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/UndefinedPagesPluginTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/plugin/UndefinedPagesPluginTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/plugin/UndefinedPagesPluginTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -63,6 +63,7 @@ public void tearDown()\n         TestEngine.deleteTestPage( \"TestPage\" );\n         TestEngine.deleteTestPage( \"Foobar\" );\n         TestEngine.emptyWorkDir();\n+        engine.shutdown();\n     }\n \n     private String wikitize( String s )"
            },
            {
                "sha": "1dbe50f1ee6f553200ab6a9ffef60ce4f9176c43",
                "filename": "tests/com/ecyrd/jspwiki/providers/BasicAttachmentProviderTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/BasicAttachmentProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/BasicAttachmentProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/providers/BasicAttachmentProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -111,6 +111,8 @@ public void tearDown()\n         TestEngine.deleteAll( f );\n         \n         TestEngine.emptyWorkDir();\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testExtension()"
            },
            {
                "sha": "b149fb5c60f1af36990d8eda284f13d0d25c6ab6",
                "filename": "tests/com/ecyrd/jspwiki/providers/CachingProviderTest.java",
                "status": "modified",
                "additions": 17,
                "deletions": 6,
                "changes": 23,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/CachingProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/CachingProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/providers/CachingProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -35,7 +35,11 @@ Licensed to the Apache Software Foundation (ASF) under one\n import com.ecyrd.jspwiki.util.FileUtil;\n \n public class CachingProviderTest extends TestCase\n+\n {\n+    private Properties props = new Properties();\n+    private TestEngine m_engine = null;\n+\n     public CachingProviderTest( String s )\n     {\n         super( s );\n@@ -44,13 +48,18 @@ public CachingProviderTest( String s )\n     public void setUp()\n         throws Exception\n     {\n+        props.load( TestEngine.findTestProperties() );\n+        m_engine = new TestEngine( props );\n+\n         TestEngine.emptyWorkDir();\n     }\n \n     public void tearDown()\n     {\n         TestEngine.emptyWorkDir();\n         TestEngine.deleteTestPage(\"Testi\");\n+        \n+        m_engine.shutdown();\n     }\n \n     /**\n@@ -66,17 +75,18 @@ public void testInitialization()\n         props.setProperty( \"jspwiki.pageProvider\", \"com.ecyrd.jspwiki.providers.CounterProvider\" );\n         props.setProperty( \"jspwiki.cachingProvider.capacity\", \"100\" );\n \n-        TestEngine engine = new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n \n-        CounterProvider p = (CounterProvider)((CachingProvider)engine.getPageManager().getProvider()).getRealProvider();\n+        CounterProvider p = (CounterProvider)((CachingProvider)m_engine.getPageManager().getProvider()).getRealProvider();\n \n         assertEquals(\"init\", 1, p.m_initCalls);\n         assertEquals(\"getAllPages\", 1, p.m_getAllPagesCalls);\n         assertEquals(\"pageExists\", 0, p.m_pageExistsCalls);\n         assertEquals(\"getPage\", 2, p.m_getPageCalls); // These two are for non-existant pages (with and without s)\n         assertEquals(\"getPageText\", 4, p.m_getPageTextCalls);\n \n-        engine.getPage( \"Foo\" );\n+        m_engine.getPage( \"Foo\" );\n \n         assertEquals(\"pageExists2\", 0, p.m_pageExistsCalls);\n         assertEquals(\"getPage2\", 2, p.m_getPageCalls);\n@@ -90,7 +100,8 @@ public void testSneakyAdd()\n \n         props.setProperty( \"jspwiki.cachingProvider.cacheCheckInterval\", \"2\" );\n         \n-        TestEngine engine = new TestEngine( props );\n+        m_engine.shutdown();\n+        m_engine = new TestEngine( props );\n         \n         String dir = props.getProperty( FileSystemProvider.PROP_PAGEDIR );\n         \n@@ -103,10 +114,10 @@ public void testSneakyAdd()\n         \n         Thread.sleep( 4000L ); // Make sure we wait long enough\n         \n-        WikiPage p = engine.getPage( \"Testi\" );\n+        WikiPage p = m_engine.getPage( \"Testi\" );\n         assertNotNull( \"page did not exist?\", p );\n         \n-        String text = engine.getText( \"Testi\");\n+        String text = m_engine.getText( \"Testi\");\n         assertEquals(\"text\", \"[fuufaa]\", text );\n         \n         // TODO: ReferenceManager check as well"
            },
            {
                "sha": "411b620c74cce002405adfa5262dfed33493478e",
                "filename": "tests/com/ecyrd/jspwiki/providers/FileSystemProviderTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/FileSystemProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/FileSystemProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/providers/FileSystemProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -67,6 +67,8 @@ public void setUp()\n     public void tearDown()\n     {\n         TestEngine.deleteAll( new File(m_pagedir) );\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testScandinavianLetters()"
            },
            {
                "sha": "657ed75a5cb0ed75cb7957b7dd5639d7749cb684",
                "filename": "tests/com/ecyrd/jspwiki/providers/RCSFileProviderTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/RCSFileProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/RCSFileProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/providers/RCSFileProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -76,6 +76,8 @@ public void tearDown()\n         f = new File( files, \"RCS\" );\n \n         f.delete();\n+        \n+        engine.shutdown();\n     }\n \n     /**"
            },
            {
                "sha": "4ae6ff31d27fb0a4383403cd7c15366e26f20261",
                "filename": "tests/com/ecyrd/jspwiki/providers/VersioningFileProviderTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/VersioningFileProviderTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/providers/VersioningFileProviderTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/providers/VersioningFileProviderTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -65,6 +65,8 @@ public void tearDown()\n         f = new File( files, \"OLD\" );\n \n         TestEngine.deleteAll(f);\n+        \n+        engine.shutdown();\n     }\n \n     /**"
            },
            {
                "sha": "49d18a0a61cfdaf32f14f83e9a52bd4b735ba0dc",
                "filename": "tests/com/ecyrd/jspwiki/render/CreoleRendererTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/render/CreoleRendererTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/render/CreoleRendererTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/render/CreoleRendererTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -47,6 +47,12 @@ protected void setUp() throws Exception\n         super.setUp();\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_testEngine.shutdown();\n+    }\n+\n     private String render(String s) throws IOException\n     {\n         WikiPage dummyPage = m_testEngine.createPage(\"TestPage\");"
            },
            {
                "sha": "d374ebb24c9d5e2ed8e79433675e04da84f99371",
                "filename": "tests/com/ecyrd/jspwiki/render/WysiwygEditingRendererTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/render/WysiwygEditingRendererTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/render/WysiwygEditingRendererTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/render/WysiwygEditingRendererTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -54,6 +54,8 @@ public void tearDown()\n     {\n         TestEngine.deleteTestPage( \"WysiwygEditingRendererTest\" );\n         TestEngine.deleteTestPage( \"This Pagename Has Spaces\" );\n+        \n+        m_testEngine.shutdown();\n     }\n \n     private String render(String s) throws IOException"
            },
            {
                "sha": "245927a4abbf16e71363315e3a10655567ada0e2",
                "filename": "tests/com/ecyrd/jspwiki/rss/RSSGeneratorTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/rss/RSSGeneratorTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/rss/RSSGeneratorTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/rss/RSSGeneratorTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -66,6 +66,8 @@ protected void setUp() throws Exception\n     protected void tearDown() throws Exception\n     {\n         TestEngine.deleteAll( new File(props.getProperty( FileSystemProvider.PROP_PAGEDIR )) );\n+        \n+        m_testEngine.shutdown();\n     }\n \n     public void testBlogRSS()"
            },
            {
                "sha": "22a7bc320632bb9341816a1fd455bc7696bffb34",
                "filename": "tests/com/ecyrd/jspwiki/search/SearchManagerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/search/SearchManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/search/SearchManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/search/SearchManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -63,6 +63,8 @@ protected void tearDown() throws Exception\n         super.tearDown();\n         \n         TestEngine.deleteTestPage(\"TestPage\");\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testDefaultProvider()"
            },
            {
                "sha": "f68de224bbe75137f2d6e5567716095dd2c7d1a4",
                "filename": "tests/com/ecyrd/jspwiki/ui/InputValidatorTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ui/InputValidatorTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ui/InputValidatorTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/ui/InputValidatorTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -51,6 +51,12 @@ protected void setUp() throws Exception\n         val = new InputValidator( TEST, context );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        testEngine.shutdown();\n+    }\n+\n     public void testUnsafePattern()\n     {\n         Pattern unsafe = InputValidator.UNSAFE_PATTERN;"
            },
            {
                "sha": "493766bbb43ab61c911a9e6ccf7f9cc009028757",
                "filename": "tests/com/ecyrd/jspwiki/ui/stripes/HandlerInfoTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ui/stripes/HandlerInfoTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/ui/stripes/HandlerInfoTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/ui/stripes/HandlerInfoTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -55,6 +55,12 @@ public void setUp()\n         }\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     public void testGetRequestContext() throws Exception\n     {\n         assertEquals( \"createGroup\", HandlerInfo.getHandlerInfo( GroupActionBean.class, \"create\" ).getRequestContext() );"
            },
            {
                "sha": "2fa21183d5947b613743b4e01e62ad7cbb9e0a15",
                "filename": "tests/com/ecyrd/jspwiki/url/DefaultURLConstructorTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/DefaultURLConstructorTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/DefaultURLConstructorTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/url/DefaultURLConstructorTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -47,6 +47,12 @@ protected void setUp() throws Exception\n         props.load( TestEngine.findTestProperties() );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        testEngine.shutdown();\n+    }\n+\n     private URLConstructor getConstructor( String baseURL, String prefix )\n         throws WikiException\n     {"
            },
            {
                "sha": "78bd29c127b2954b1e5d4113bc234bc594024757",
                "filename": "tests/com/ecyrd/jspwiki/url/ShortURLConstructorTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/ShortURLConstructorTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/ShortURLConstructorTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/url/ShortURLConstructorTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -47,6 +47,12 @@ protected void setUp() throws Exception\n         props.load( TestEngine.findTestProperties() );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        testEngine.shutdown();\n+    }\n+\n     private URLConstructor getConstructor( String baseURL, String prefix )\n         throws WikiException\n     {"
            },
            {
                "sha": "4fb5b3888f89cd705a8659feb8ca37bf2f4d79ed",
                "filename": "tests/com/ecyrd/jspwiki/url/ShortViewURLConstructorTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/ShortViewURLConstructorTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/url/ShortViewURLConstructorTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/url/ShortViewURLConstructorTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -47,6 +47,12 @@ protected void setUp() throws Exception\n         props.load( TestEngine.findTestProperties() );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        testEngine.shutdown();\n+    }\n+\n     private URLConstructor getConstructor( String baseURL, String prefix )\n         throws WikiException\n     {"
            },
            {
                "sha": "a4c5d63b59b70ab1e15f4d5851a26b8882f02fe0",
                "filename": "tests/com/ecyrd/jspwiki/util/ClassUtilTest.java",
                "status": "modified",
                "additions": 3,
                "deletions": 3,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/util/ClassUtilTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/util/ClassUtilTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/util/ClassUtilTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -36,9 +36,9 @@ public ClassUtilTest( String s )\n     public void testFindClass()\n         throws Exception\n     {\n-        Class foo = ClassUtil.findClass( \"com.ecyrd.jspwiki.api\", \"WikiPage\" );\n+        Class foo = ClassUtil.findClass( \"org.apache.jspwiki.api\", \"WikiPage\" );\n \n-        assertEquals( foo.getName(), \"com.ecyrd.jspwiki.api.WikiPage\" );\n+        assertEquals( foo.getName(), \"org.apache.jspwiki.api.WikiPage\" );\n     }\n \n     /**\n@@ -49,7 +49,7 @@ public void testFindClassNoClass()\n     {\n         try\n         {\n-            Class foo = ClassUtil.findClass( \"com.ecyrd.jspwiki\", \"MubbleBubble\" );\n+            Class foo = ClassUtil.findClass( \"org.apache.jspwiki\", \"MubbleBubble\" );\n             fail(\"Found class:\"+foo);\n         }\n         catch( ClassNotFoundException e )"
            },
            {
                "sha": "4ada9939c9021b9bdba3d345184cea011af44ad2",
                "filename": "tests/com/ecyrd/jspwiki/util/MailUtilTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 2,
                "changes": 7,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/util/MailUtilTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/util/MailUtilTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/util/MailUtilTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -58,6 +58,8 @@ Licensed to the Apache Software Foundation (ASF) under one\n     static final String TEST_RECEIVER = \"someone@somewhere.org\";\n     static final String TEST_SENDER = \"homer.simpson@burns.com\";\n     \n+    private TestEngine m_engine= null;\n+    \n     public MailUtilTest( String s )\n     {\n         super( s );\n@@ -68,13 +70,14 @@ public void setUp()\n     {\n         m_props.load( TestEngine.findTestProperties() );\n         \n-        TestEngine testEngine = new TestEngine( m_props );\n+        m_engine = new TestEngine( m_props );\n         \n-        m_context = testEngine.getWikiContextFactory().newViewContext( testEngine.createPage( PAGE_NAME ) );\n+        m_context = m_engine.getWikiContextFactory().newViewContext( m_engine.createPage( PAGE_NAME ) );\n     }\n \n     public void tearDown()\n     {\n+        m_engine.shutdown();\n     }\n \n     /**"
            },
            {
                "sha": "5e365d201196dc03fe93c3dc7574de5f4f107313",
                "filename": "tests/com/ecyrd/jspwiki/workflow/ApprovalWorkflowTest.java",
                "status": "modified",
                "additions": 5,
                "deletions": 0,
                "changes": 5,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/ApprovalWorkflowTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/ApprovalWorkflowTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/workflow/ApprovalWorkflowTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -62,6 +62,11 @@ protected void setUp() throws Exception\n         m_builder = WorkflowBuilder.getBuilder( m_engine );\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n \n     public void testBuildApprovalWorkflow() throws WikiException\n     {"
            },
            {
                "sha": "20ae7d452a5b8b5805d85c32f38f80d265cb18d4",
                "filename": "tests/com/ecyrd/jspwiki/workflow/DecisionQueueTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/DecisionQueueTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/DecisionQueueTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/workflow/DecisionQueueTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -71,6 +71,12 @@ protected void setUp() throws Exception\n         m_queue.add(d3);\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     public void testAdd()\n     {\n         Decision[] decisions = m_queue.decisions();"
            },
            {
                "sha": "a91dec2f9b554401358db45a2bdebc23c3b729c6",
                "filename": "tests/com/ecyrd/jspwiki/workflow/WorkflowManagerTest.java",
                "status": "modified",
                "additions": 6,
                "deletions": 0,
                "changes": 6,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/WorkflowManagerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/workflow/WorkflowManagerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/workflow/WorkflowManagerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -58,6 +58,12 @@ protected void setUp() throws Exception\n         w.addMessageArgument(\"MyPage\");\n     }\n \n+    protected void tearDown() throws Exception\n+    {\n+        super.tearDown();\n+        m_engine.shutdown();\n+    }\n+\n     public void testStart() throws WikiException\n     {\n         // Once we start the workflow, it should show that it's started"
            },
            {
                "sha": "1989db10bf293af9f2b46e85efc63eea0cfb0212",
                "filename": "tests/com/ecyrd/jspwiki/xmlrpc/RPCHandlerTest.java",
                "status": "modified",
                "additions": 2,
                "deletions": 0,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/xmlrpc/RPCHandlerTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/7a24a129ab55caa0ebda308cff3cca39ae571efa/tests/com/ecyrd/jspwiki/xmlrpc/RPCHandlerTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/com/ecyrd/jspwiki/xmlrpc/RPCHandlerTest.java?ref=7a24a129ab55caa0ebda308cff3cca39ae571efa",
                "patch": "@@ -61,6 +61,8 @@ public void tearDown()\n         TestEngine.deleteTestPage( NAME1 );\n         TestEngine.deleteAttachments( NAME1 );\n         TestEngine.emptyWorkDir();\n+        \n+        m_engine.shutdown();\n     }\n \n     public void testNonexistantPage()"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/539c6495cb2d40eb38b815deb82ed8868d85396b",
        "message": " * 2.10.1-svn-15\n       \n * Fixed JSPWIKI-822 - NPE thrown by PluginContext#getText()\n       \n * JSPWIKI-814 - VersioningFileProvider does migrate original page properties (thanks to Brian Burch)\n\ngit-svn-id: https://svn.apache.org/repos/asf/jspwiki/trunk@1589240 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_44",
        "file": [
            {
                "sha": "75d694b5d7cf6acae9186a39fb987646d18cbb59",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 8,
                "deletions": 0,
                "changes": 8,
                "blob_url": "https://github.com/apache/jspwiki/blob/1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1",
                "patch": "@@ -1,3 +1,11 @@\n+2014-04-20  Juan Pablo Santos (juanpablo AT apache DOT org)\n+\n+       * 2.10.1-svn-15\n+       \n+       * Fixed JSPWIKI-822 - NPE thrown by PluginContext#getText()\n+       \n+       * JSPWIKI-814 - VersioningFileProvider does migrate original page properties (thanks to Brian Burch)\n+\n 2014-04-20  Juan Pablo Santos (juanpablo AT apache DOT org)\n \n        * 2.10.1-svn-14"
            },
            {
                "sha": "c7618450c001d2f5522618b68ed6971c1fb5a83b",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/Release.java?ref=1b5a0c3c11dd7aea448f966e96aea6fc27ea63d1",
                "patch": "@@ -72,7 +72,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"14\";\n+    public static final String     BUILD         = \"15\";\n     \n     /**\n      *  This is the generic version string you should use when printing out the version.  It is of "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/c53d53c5005835b3330aa23fcf34af1e1cf3c50f",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/33f7b18db041a0731e07ab165855875665954c0d",
        "message": "* 2.10.0-svn-3\n\n* JSPWIKI-771: inherit ASF parent pom. Deleted release profile in favour of\n  apache-release and gpg configuration (both present on parent pom);\n  added <ciManagement/>, <issueManagement/> and <mailingLists/> sections.\n       \n* fixed runtime NPE on WikiJSPFilter (m_engine used before having been initialized)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@1488662 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_45",
        "file": [
            {
                "sha": "89bc6031fb2d5df0c790e609057cd732fd099a7e",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 10,
                "deletions": 0,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/c53d53c5005835b3330aa23fcf34af1e1cf3c50f/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/c53d53c5005835b3330aa23fcf34af1e1cf3c50f/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=c53d53c5005835b3330aa23fcf34af1e1cf3c50f",
                "patch": "@@ -1,3 +1,13 @@\n+2013-06-02  Juan Pablo Santos (juanpablo AT apache DOT org)\n+\n+       * 2.10.0-svn-3\n+\n+       * JSPWIKI-771: inherit ASF parent pom. Deleted release profile in favour of\n+         apache-release and gpg configuration (both present on parent pom);\n+         added <ciManagement/>, <issueManagement/> and <mailingLists/> sections.\n+       \n+       * fixed runtime NPE on WikiJSPFilter (m_engine used before having been initialized)\n+\n 2013-06-01  Harry Metske (metskem@apache.org)\n \n        * 2.10.0-svn-2"
            },
            {
                "sha": "83428cfee833972b5c6b48b90960264aaf0e57e6",
                "filename": "jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/c53d53c5005835b3330aa23fcf34af1e1cf3c50f/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/c53d53c5005835b3330aa23fcf34af1e1cf3c50f/jspwiki-war/src/main/java/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/jspwiki-war/src/main/java/org/apache/wiki/Release.java?ref=c53d53c5005835b3330aa23fcf34af1e1cf3c50f",
                "patch": "@@ -75,7 +75,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"2\";\n+    public static final String     BUILD         = \"3\";\n     \n     /**\n      *  This is the generic version string you should use"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/42babbee3224143690dc87d95160628841b17634",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/2530a461bba7b5bf0e18c2704b6e1797f9f59933",
        "message": "Fixed bug in BreadCrumbs tag that was causing non-WikiPage contexts to appear as page \"Main\". These contexts are now omitted. Fixed related bug where non-WikiPage contexts were causing NPEs in certain tags, like FeedDiscovery and PermissionTag.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@782492 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_46",
        "file": [
            {
                "sha": "82cd0bf07a27bbc57e26f45d3a4125d876830204",
                "filename": "src/java/org/apache/wiki/tags/BreadcrumbsTag.java",
                "status": "modified",
                "additions": 1,
                "deletions": 2,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/BreadcrumbsTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/BreadcrumbsTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/tags/BreadcrumbsTag.java?ref=42babbee3224143690dc87d95160628841b17634",
                "patch": "@@ -122,15 +122,14 @@ public int doWikiStartTag() throws IOException\n         HttpSession session = pageContext.getSession();\n         FixedQueue  trail = (FixedQueue) session.getAttribute(BREADCRUMBTRAIL_KEY);\n \n-        String page = m_wikiContext.getPage().getName();\n-\n         if( trail == null )\n         {\n             trail = new FixedQueue(m_maxQueueSize);\n         }\n \n         if( m_wikiContext.getRequestContext().equals( WikiContext.VIEW ) )\n         {\n+            String page = m_wikiContext.getPage().getName();\n             if( m_wikiContext.getEngine().pageExists( page ) )\n             {\n                 if( trail.isEmpty() )"
            },
            {
                "sha": "94d48da4fc16f565f91e99824c4f8dafdabb44f4",
                "filename": "src/java/org/apache/wiki/tags/FeedDiscoveryTag.java",
                "status": "modified",
                "additions": 26,
                "deletions": 25,
                "changes": 51,
                "blob_url": "https://github.com/apache/jspwiki/blob/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/FeedDiscoveryTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/FeedDiscoveryTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/tags/FeedDiscoveryTag.java?ref=42babbee3224143690dc87d95160628841b17634",
                "patch": "@@ -44,42 +44,43 @@ public final int doWikiStartTag()\n         throws IOException\n     {\n         WikiEngine engine = m_wikiContext.getEngine();\n-        WikiPage   page   = m_wikiContext.getPage();\n-\n-        String encodedName = engine.encodeName( page.getName() );\n-\n         String rssURL      = engine.getGlobalRSSURL();\n-        String rssFeedURL  = engine.getURL(WikiContext.NONE, \"rss.jsp\", \n-                                           \"page=\"+encodedName+\"&amp;mode=wiki\",\n-                                           true );\n         \n         if( rssURL != null )\n         {\n             String siteName = BlogUtil.getSiteName(m_wikiContext);\n             siteName = TextUtil.replaceEntities( siteName );\n-            \n             pageContext.getOut().print(\"<link rel=\\\"alternate\\\" type=\\\"application/rss+xml\\\" title=\\\"RSS wiki feed for the entire site.\\\" href=\\\"\"+rssURL+\"\\\" />\\n\");\n-            pageContext.getOut().print(\"<link rel=\\\"alternate\\\" type=\\\"application/rss+xml\\\" title=\\\"RSS wiki feed for page \"+siteName+\".\\\" href=\\\"\"+rssFeedURL+\"\\\" />\\n\");\n-\n-            // TODO: Enable this\n-            /*\n-            pageContext.getOut().print(\"<link rel=\\\"service.post\\\" type=\\\"application/atom+xml\\\" title=\\\"\"+\n-                                       siteName+\"\\\" href=\\\"\"+atomPostURL+\"\\\" />\\n\");\n-            */\n-            // FIXME: This does not work always, as plugins are not initialized until the first fetch\n-            if( \"true\".equals(page.getAttribute(WeblogPlugin.ATTR_ISWEBLOG)) )\n+            \n+            WikiPage   page   = m_wikiContext.getPage();\n+            if ( page != null )\n             {\n-                String blogFeedURL = engine.getURL(WikiContext.NONE,\"rss.jsp\",\"page=\"+encodedName,true);\n-                String atomFeedURL = engine.getURL(WikiContext.NONE,\"rss.jsp\",\"page=\"+encodedName+\"&amp;type=atom\",true);\n-        \n-                pageContext.getOut().print(\"<link rel=\\\"alternate\\\" type=\\\"application/rss+xml\\\" title=\\\"RSS feed for weblog \"+\n-                                           siteName+\".\\\" href=\\\"\"+blogFeedURL+\"\\\" />\\n\");\n+                String encodedName = engine.encodeName( page == null ? engine.getFrontPage() : page.getName() );\n+                String rssFeedURL  = engine.getURL(WikiContext.NONE, \"rss.jsp\", \n+                                                   \"page=\"+encodedName+\"&amp;mode=wiki\",\n+                                                   true );\n+                pageContext.getOut().print(\"<link rel=\\\"alternate\\\" type=\\\"application/rss+xml\\\" title=\\\"RSS wiki feed for page \"+siteName+\".\\\" href=\\\"\"+rssFeedURL+\"\\\" />\\n\");\n+                \n+                // TODO: Enable this\n+                /*\n+                pageContext.getOut().print(\"<link rel=\\\"service.post\\\" type=\\\"application/atom+xml\\\" title=\\\"\"+\n+                                           siteName+\"\\\" href=\\\"\"+atomPostURL+\"\\\" />\\n\");\n+                */\n+                // FIXME: This does not work always, as plugins are not initialized until the first fetch\n+                if( \"true\".equals(page.getAttribute(WeblogPlugin.ATTR_ISWEBLOG)) )\n+                {\n+                    String blogFeedURL = engine.getURL(WikiContext.NONE,\"rss.jsp\",\"page=\"+encodedName,true);\n+                    String atomFeedURL = engine.getURL(WikiContext.NONE,\"rss.jsp\",\"page=\"+encodedName+\"&amp;type=atom\",true);\n+            \n+                    pageContext.getOut().print(\"<link rel=\\\"alternate\\\" type=\\\"application/rss+xml\\\" title=\\\"RSS feed for weblog \"+\n+                                               siteName+\".\\\" href=\\\"\"+blogFeedURL+\"\\\" />\\n\");\n \n-                pageContext.getOut().print(\"<link rel=\\\"service.feed\\\" type=\\\"application/atom+xml\\\" title=\\\"Atom 1.0 weblog feed for \"+\n-                                           siteName+\"\\\" href=\\\"\"+atomFeedURL+\"\\\" />\\n\");\n+                    pageContext.getOut().print(\"<link rel=\\\"service.feed\\\" type=\\\"application/atom+xml\\\" title=\\\"Atom 1.0 weblog feed for \"+\n+                                               siteName+\"\\\" href=\\\"\"+atomFeedURL+\"\\\" />\\n\");\n+                }\n             }\n         }\n-\n+        \n         return SKIP_BODY;\n     }\n }"
            },
            {
                "sha": "ea662f9222846158aa7409f5da55bc139c64ae62",
                "filename": "src/java/org/apache/wiki/tags/PermissionTag.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/PermissionTag.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/42babbee3224143690dc87d95160628841b17634/src/java/org/apache/wiki/tags/PermissionTag.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/tags/PermissionTag.java?ref=42babbee3224143690dc87d95160628841b17634",
                "patch": "@@ -119,7 +119,7 @@ private boolean checkPermission( String permission )\n             || EDIT_PREFERENCES.equals( permission ) || EDIT_PROFILE.equals( permission )\n             || LOGIN.equals( permission ) )\n         {\n-            gotPermission = mgr.checkPermission( session, new WikiPermission( page.getWiki(), permission ) );\n+            gotPermission = mgr.checkPermission( session, new WikiPermission( \"*\", permission ) );\n         }\n         else if ( VIEW_GROUP.equals( permission ) )\n         {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/26b8f108f910130e3cd3281808032d156acc7af9",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/41a0a10e4ff74089d7ecd39d2ee608296f384294",
        "message": "Fixed bug in XMLUserDatabase that was preventing UIDs from being saved, which generated tons of NPEs afterwards. Added unit tests to check for correct saving of UIDs. Tightened input filtering on user profile fields to prohibit more characters. [Forward-ported from 2.8.2-svn-14].\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@756319 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_47",
        "file": [
            {
                "sha": "fa8333c9177cf8388908bb56e20933f1c01cccbb",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 10,
                "deletions": 0,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -1,3 +1,13 @@\n+2009-03-19  Andrew Jaquith <ajaquith AT apache DOT org>\n+\n+        * 3.0.0-svn-86\n+\n+        * Fixed bug in XMLUserDatabase that was preventing UIDs from being\n+        saved, which generated tons of NPEs afterwards. Added unit tests\n+        to check for correct saving of UIDs. Tightened input filtering on\n+        user profile fields to prohibit more characters. [Forward-ported\n+        from 2.8.2-svn-14].\n+        \n 2009-03-18  Andrew Jaquith <ajaquith AT apache DOT org>\n \n         * 3.0.0-svn-85"
            },
            {
                "sha": "48ffdde5ac64f41c93ae2d139d81746a5c0225c1",
                "filename": "src/java/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/Release.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -77,7 +77,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"85\";\n+    public static final String     BUILD         = \"86\";\n     \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "a50ebe20dbdf4d94630a859c3ad8bec534f65bfc",
                "filename": "src/java/org/apache/wiki/api/WikiPage.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/api/WikiPage.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/api/WikiPage.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/api/WikiPage.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -66,7 +66,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n     public String getName();\n     \n     /**\n-     * Returns the full, qualified, name of the WikiPage that includes the wiki name.\n+     * Returns the full, qualified, name of the WikiPage that includes the wiki space.\n      * Used by the {@link org.apache.wiki.ui.stripes.HandlerInfo} class and\n      * {@link org.apache.wiki.ui.stripes.HandlerPermission} annotations.\n      * @return the qualified page name, for example <code>mywiki:Main</code>"
            },
            {
                "sha": "a18ed9a111b99b3ec0993934d76fc97d9e34fa6d",
                "filename": "src/java/org/apache/wiki/auth/user/XMLUserDatabase.java",
                "status": "modified",
                "additions": 2,
                "deletions": 1,
                "changes": 3,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/auth/user/XMLUserDatabase.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/auth/user/XMLUserDatabase.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/auth/user/XMLUserDatabase.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -546,6 +546,7 @@ public synchronized void save( UserProfile profile ) throws WikiSecurityExceptio\n             }\n         }\n         \n+        setAttribute( user, UID, profile.getUid() );\n         setAttribute( user, LAST_MODIFIED, c_format.format( modDate ) );\n         setAttribute( user, LOGIN_NAME, profile.getLoginName() );\n         setAttribute( user, FULL_NAME, profile.getFullname() );\n@@ -623,7 +624,7 @@ private UserProfile findByAttribute( String matchAttribute, String index )\n                 \n                 // Parse basic attributes\n                 profile.setUid( user.getAttribute( UID ) );\n-                if ( profile.getUid() == null )\n+                if ( profile.getUid() == null || profile.getUid().length() == 0 )\n                 {\n                     profile.setUid( generateUid( this ) );\n                 }"
            },
            {
                "sha": "782058c762f651001f9996050e38ffb4f7e4e64a",
                "filename": "src/java/org/apache/wiki/ui/InputValidator.java",
                "status": "modified",
                "additions": 2,
                "deletions": 2,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/ui/InputValidator.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/src/java/org/apache/wiki/ui/InputValidator.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/ui/InputValidator.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -52,7 +52,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n \n     protected static final Pattern EMAIL_PATTERN  = Pattern.compile( \"^[0-9a-zA-Z-_\\\\.\\\\+]+@([0-9a-zA-Z-_]+\\\\.)+[a-zA-Z]+$\" );\n \n-    protected static final Pattern UNSAFE_PATTERN = Pattern.compile( \"[\\\\x00\\\\r\\\\n\\\\x0f\\\"':<>;&@\\\\xff{}\\\\$%\\\\\\\\]\" );\n+    protected static final Pattern UNSAFE_PATTERN = Pattern.compile( \"[\\\\x00\\\\r\\\\n\\\\x0f\\\"':<>\\\\[\\\\];#&@\\\\xff{}\\\\$%\\\\\\\\]\" );\n \n     /** Used when checking against IDs such as a full name when saving groups.\n      *  @since 2.4.82 */\n@@ -147,7 +147,7 @@ public final boolean validate( String input, String label, int type )\n             valid = !matcher.find();\n             if ( !valid )\n             {\n-                Object[] args = { label, \"&quot;&#39;&lt;&gt;;&amp;\\\\@{}%$\" };\n+                Object[] args = { label, \"&quot;&#39;&lt;&gt;;&amp;[]#\\\\@{}%$\" };\n                 m_session.addMessage( m_form, MessageFormat.format( rb.getString(\"validate.unsafechars\"),\n                                                                     args ) );\n             }"
            },
            {
                "sha": "73c854aea72fdb15722dc52150e4184576a6ee71",
                "filename": "tests/java/org/apache/wiki/auth/user/JDBCUserDatabaseTest.java",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/tests/java/org/apache/wiki/auth/user/JDBCUserDatabaseTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/tests/java/org/apache/wiki/auth/user/JDBCUserDatabaseTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/java/org/apache/wiki/auth/user/JDBCUserDatabaseTest.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -437,6 +437,10 @@ public void testSave() throws Exception\n             assertNotNull( profile.getCreated() );\n             assertNotNull( profile.getLastModified() );\n             assertEquals( profile.getCreated(), profile.getLastModified() );\n+            \n+            // Make sure we can find it by uid\n+            String uid = profile.getUid();\n+            assertNotNull( m_db.findByUid( uid ) );\n         }\n         catch( NoSuchPrincipalException e )\n         {"
            },
            {
                "sha": "afbf272b850f7545f5b7d8af1166d57fdeaf30b4",
                "filename": "tests/java/org/apache/wiki/auth/user/XMLUserDatabaseTest.java",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/26b8f108f910130e3cd3281808032d156acc7af9/tests/java/org/apache/wiki/auth/user/XMLUserDatabaseTest.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/26b8f108f910130e3cd3281808032d156acc7af9/tests/java/org/apache/wiki/auth/user/XMLUserDatabaseTest.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/tests/java/org/apache/wiki/auth/user/XMLUserDatabaseTest.java?ref=26b8f108f910130e3cd3281808032d156acc7af9",
                "patch": "@@ -357,6 +357,10 @@ public void testSave() throws Exception\n           profile = m_db.findByEmail(\"user@example.com\");\n           assertEquals(\"user@example.com\", profile.getEmail());\n           assertTrue( CryptoUtil.verifySaltedPassword( \"password\".getBytes(), profile.getPassword() ) );\n+          \n+          // Make sure we can find it by uid\n+          String uid = profile.getUid();\n+          assertNotNull( m_db.findByUid( uid ) );\n       }\n       catch (NoSuchPrincipalException e)\n       {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/60034137ee0914b389cfe80d0d8e0f1eed380a4e",
        "message": "ContentManager now throws a PageNotFoundException when\na page cannot be found, instead of returning null. This is\nto reduce the amount of NPEs that might otherwise appear.\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@753038 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_48",
        "file": [
            {
                "sha": "4a53fbc9a78dc93f7da6269ee015ac8239cc4cad",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "blob_url": "https://github.com/apache/jspwiki/blob/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
                "patch": "@@ -4,6 +4,10 @@\n         \n         * Fixed issue in ContentManager.getPage() not properly\n         catching exceptions.\n+        \n+        * ContentManager now throws a PageNotFoundException when\n+        a page cannot be found, instead of returning null. This is\n+        to reduce the amount of NPEs that might otherwise appear.\n \n 2009-02-22  Andrew Jaquith <ajaquith AT apache DOT org>\n "
            },
            {
                "sha": "553019c0ca85b5fea8250b54db050f65dbcafd8d",
                "filename": "src/java/org/apache/wiki/PageManager.java",
                "status": "modified",
                "additions": 13,
                "deletions": 2,
                "changes": 15,
                "blob_url": "https://github.com/apache/jspwiki/blob/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/PageManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/PageManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/PageManager.java?ref=1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
                "patch": "@@ -144,7 +144,11 @@ public Collection getAllPages()\n     public String getPageText( String pageName, int version )\n         throws ProviderException\n     {\n-        return m_engine.getContentManager().getPage( WikiName.valueOf( pageName ), version ).getContentAsString();\n+        WikiPage p = m_engine.getContentManager().getPage( WikiName.valueOf( pageName ), version );\n+        \n+        if( p != null ) return p.getContentAsString();\n+        \n+        return null;\n     }\n \n     /**\n@@ -278,7 +282,14 @@ public String getProviderDescription()\n      */\n     public int getTotalPageCount()\n     {\n-        return m_engine.getContentManager().getTotalPageCount( null );\n+        try\n+        {\n+            return m_engine.getContentManager().getTotalPageCount( null );\n+        }\n+        catch( ProviderException e )\n+        {\n+            return -1;\n+        }\n     }\n \n     /**"
            },
            {
                "sha": "472675b6172da846e3ba812acddd115de7c84367",
                "filename": "src/java/org/apache/wiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/Release.java?ref=1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
                "patch": "@@ -77,7 +77,7 @@ Licensed to the Apache Software Foundation (ASF) under one\n      *  <p>\n      *  If the build identifier is empty, it is not added.\n      */\n-    public static final String     BUILD         = \"81\";\n+    public static final String     BUILD         = \"82\";\n     \n     /**\n      *  This is the generic version string you should use"
            },
            {
                "sha": "729f4eabe92d2379364070651883dd3ab419b10e",
                "filename": "src/java/org/apache/wiki/content/ContentManager.java",
                "status": "modified",
                "additions": 31,
                "deletions": 20,
                "changes": 51,
                "blob_url": "https://github.com/apache/jspwiki/blob/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/content/ContentManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/content/ContentManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/content/ContentManager.java?ref=1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
                "patch": "@@ -72,6 +72,11 @@ Licensed to the Apache Software Foundation (ASF) under one\n  *  and \"jackrabbit\" for <a href=\"http://jackrabbit.apache.org\">Apache Jackrabbit</a>.\n  *  <p>\n  *  If there is no property defined, defaults to \"priha\".\n+ *  <p>\n+ *  The methods in this class always return valid values. In case they cannot\n+ *  be acquired by some means, it throws an Exception.  This is different from\n+ *  the way the old PageManager used to work, so you can go ahead and get rid\n+ *  of all the null-checks from your old code.\n  *\n  *  FIXME:\n  *    * This class is currently designed to be a drop-in replacement for PageManager.\n@@ -554,7 +559,7 @@ public WikiPage getPage( String pageName, int version )\n      */\n \n     public List<WikiPage> getVersionHistory( WikiName path )\n-        throws ProviderException\n+        throws ProviderException, PageNotFoundException\n     {\n         List<WikiPage> result = new ArrayList<WikiPage>();\n         JCRWikiPage base = getPage(path);\n@@ -572,6 +577,10 @@ public WikiPage getPage( String pageName, int version )\n                 result.add( new JCRWikiPage(m_engine,v) );\n             }\n         }\n+        catch( PathNotFoundException e )\n+        {\n+            throw new PageNotFoundException(path);\n+        }\n         catch( RepositoryException e )\n         {\n             throw new ProviderException(\"Unable to get version history\",e);\n@@ -602,21 +611,14 @@ public String getProviderDescription()\n      *  \n      *  @param space Name of the Wiki space.  May be null, in which\n      *  case all spaces will be counted\n-     *  @return The number of pages, or -1, if there is an error.\n+     *  @return The number of pages.\n+     *  @throws ProviderException If there was an error.\n      */\n     // FIXME: Unfortunately this method is very slow, since it involves gobbling\n     //        up the entire repo.\n-    public int getTotalPageCount(String space)\n+    public int getTotalPageCount(String space) throws ProviderException\n     {\n-        try\n-        {\n-            return getAllPages(space).size();\n-        }\n-        catch( ProviderException e )\n-        {\n-            log.error( \"Unable to count pages: \",e );\n-            return -1;\n-        }\n+        return getAllPages(space).size();\n     }\n     /**\n      *  Returns true, if the page exists (any version).\n@@ -625,7 +627,6 @@ public int getTotalPageCount(String space)\n      *  @return A boolean value describing the existence of a page\n      *  @throws ProviderException If the backend fails or the wikiPath is illegal.\n      */\n- \n     public boolean pageExists( WikiName wikiPath )\n         throws ProviderException\n     {\n@@ -682,9 +683,10 @@ public boolean pageExists( WikiName wikiPath, int version )\n      *  \n      *  @param page The page to delete.\n      *  @throws ProviderException if the page fails\n+     *  @throws PageNotFoundException If the page in question does not exist.\n      */\n     public void deleteVersion( WikiPage page )\n-        throws ProviderException\n+        throws ProviderException, PageNotFoundException\n     {\n         fireEvent( WikiPageEvent.PAGE_DELETE_REQUEST, page.getName() );\n \n@@ -696,6 +698,10 @@ public void deleteVersion( WikiPage page )\n             \n             fireEvent( WikiPageEvent.PAGE_DELETED, jcrPage.getName() );\n         }\n+        catch( PathNotFoundException e )\n+        {\n+            throw new PageNotFoundException(page.getQualifiedName());\n+        }\n         catch( RepositoryException e )\n         {\n             throw new ProviderException(\"Unable to delete a page\",e);\n@@ -707,10 +713,11 @@ public void deleteVersion( WikiPage page )\n      *  \n      *  @param page The WikiPage to delete\n      *  @throws ProviderException If the backend fails or the page is illegal.\n+     *  @throws PageNotFoundException If the page has already disappeared.\n      */\n     \n     public void deletePage( WikiPage page )\n-        throws ProviderException\n+        throws ProviderException, PageNotFoundException\n     {\n         fireEvent( WikiPageEvent.PAGE_DELETE_REQUEST, page.getName() );\n \n@@ -741,6 +748,10 @@ public void deletePage( WikiPage page )\n             \n             fireEvent( WikiPageEvent.PAGE_DELETED, page.getName() );\n         }\n+        catch( PathNotFoundException e )\n+        {\n+            throw new PageNotFoundException(page.getQualifiedName());\n+        }\n         catch( RepositoryException e )\n         {\n             throw new ProviderException(\"Deletion of pages failed.\",e);\n@@ -1001,8 +1012,9 @@ public JCRWikiPage addPage( WikiName path, String contentType ) throws ProviderE\n      *  @param path the path\n      *  @return the {@link JCRWikiPage} \n      *  @throws ProviderException If the backend fails.\n+     *  @throws PageNotFoundException If the page does not exist.\n      */\n-    public JCRWikiPage getPage( WikiName path ) throws ProviderException\n+    public JCRWikiPage getPage( WikiName path ) throws ProviderException, PageNotFoundException\n     {\n         try\n         {\n@@ -1015,7 +1027,7 @@ public JCRWikiPage getPage( WikiName path ) throws ProviderException\n         }\n         catch( PathNotFoundException e )\n         {\n-            return null;\n+            throw new PageNotFoundException( path );\n         }\n         catch( RepositoryException e )\n         {\n@@ -1027,7 +1039,7 @@ public JCRWikiPage getPage( WikiName path ) throws ProviderException\n         }\n     }\n \n-    public JCRWikiPage getPage( WikiName path, int version ) throws ProviderException\n+    public JCRWikiPage getPage( WikiName path, int version ) throws ProviderException, PageNotFoundException\n     {\n         try\n         {\n@@ -1056,8 +1068,7 @@ public JCRWikiPage getPage( WikiName path, int version ) throws ProviderExceptio\n         }\n         catch( PathNotFoundException e )\n         {\n-            // Page was not found at all.\n-            return null;\n+            throw new PageNotFoundException( path );\n         }\n         catch( RepositoryException e )\n         {"
            },
            {
                "sha": "62fbcf65d663e079e3dcfc4ece4ca899260592d0",
                "filename": "src/java/org/apache/wiki/content/PageNotFoundException.java",
                "status": "added",
                "additions": 52,
                "deletions": 0,
                "changes": 52,
                "blob_url": "https://github.com/apache/jspwiki/blob/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/content/PageNotFoundException.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1819daff7b50eaf9fa5f14a23f59f155a4b8debf/src/java/org/apache/wiki/content/PageNotFoundException.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/java/org/apache/wiki/content/PageNotFoundException.java?ref=1819daff7b50eaf9fa5f14a23f59f155a4b8debf",
                "patch": "@@ -0,0 +1,52 @@\n+/*\n+    JSPWiki - a JSP-based WikiWiki clone.\n+\n+    Licensed to the Apache Software Foundation (ASF) under one\n+    or more contributor license agreements.  See the NOTICE file\n+    distributed with this work for additional information\n+    regarding copyright ownership.  The ASF licenses this file\n+    to you under the Apache License, Version 2.0 (the\n+    \"License\"); you may not use this file except in compliance\n+    with the License.  You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+    Unless required by applicable law or agreed to in writing,\n+    software distributed under the License is distributed on an\n+    \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+    KIND, either express or implied.  See the License for the\n+    specific language governing permissions and limitations\n+    under the License.      \n+ */\n+package org.apache.wiki.content;\n+\n+import org.apache.wiki.providers.ProviderException;\n+\n+/**\n+ *  A particular kind of exception noting that the WikiPage or attachment \n+ *  in question was not found.\n+ *  \n+ *  @since 3.0\n+ */\n+public class PageNotFoundException extends ProviderException\n+{\n+    private static final long serialVersionUID = 1L;\n+\n+    /**\n+     *  Construct an exception from a String path. \n+     *  @param path The path to the nonexistant WikiPage.\n+     */\n+    public PageNotFoundException( String path )\n+    {\n+        super( path );\n+    }\n+\n+    /**\n+     *  Construct an exception from a WikiName path. \n+     *  @param path The path to the nonexistant WikiPage.\n+     */\n+    public PageNotFoundException( WikiName path )\n+    {\n+        super( path.toString() );\n+    }\n+}"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/1e3329514207242e1fc77a86281ce43739b5f4b5",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/3b4d89be7cbba860ddbdfa3a9f52a261096ed569",
        "message": "[JSPWIKI-116] Under certain circumstances, calls to UserManager.getUserDatabase() are made before the user database is actually initialized, resulting in NPEs. To resolve, we simply replaced internal references to m_userDatabase with getUserDatabase(), which lazily initializes the database if it has not already happened.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626951 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_49",
        "file": [
            {
                "sha": "de38a46079e4c02b2b17f70ed1e514672c0a3f40",
                "filename": "ChangeLog",
                "status": "modified",
                "additions": 10,
                "deletions": 0,
                "changes": 10,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e3329514207242e1fc77a86281ce43739b5f4b5/ChangeLog",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e3329514207242e1fc77a86281ce43739b5f4b5/ChangeLog",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/ChangeLog?ref=1e3329514207242e1fc77a86281ce43739b5f4b5",
                "patch": "@@ -1,3 +1,13 @@\n+2007-12-10  Andrew Jaquith <andrew AT apache DOT org>\n+\n+        * 2.6.1-cvs-2\n+        \n+        * [JSPWIKI-116] Under certain circumstances, calls to\n+        UserManager.getUserDatabase() are made before the user database is\n+        actually initialized, resulting in NPEs. To resolve, we simply replaced\n+        internal references to m_userDatabase with getUserDatabase(),\n+        which lazily initializes the database if it has not already happened.\n+        \n 2007-12-25  Janne Jalkanen <jalkanen@ecyrd.com>\n \n         * 2.6.1-cvs-1"
            },
            {
                "sha": "bec6f7219baaa30c4f515497d6135c6ab71da9cf",
                "filename": "src/com/ecyrd/jspwiki/Release.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e3329514207242e1fc77a86281ce43739b5f4b5/src/com/ecyrd/jspwiki/Release.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e3329514207242e1fc77a86281ce43739b5f4b5/src/com/ecyrd/jspwiki/Release.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/Release.java?ref=1e3329514207242e1fc77a86281ce43739b5f4b5",
                "patch": "@@ -66,7 +66,7 @@\n     public static final int        REVISION      = 6;\n \n     /** The minor revision.  */\n-    public static final int        MINORREVISION = 1;\n+    public static final int        MINORREVISION = 2;\n \n     /** The build number/identifier.  This is a String as opposed to an integer, just\n      *  so that people can add other identifiers to it.  The build number is incremented"
            },
            {
                "sha": "ebc43378d609ea3cb16bccd50af776620c1fce24",
                "filename": "src/com/ecyrd/jspwiki/auth/UserManager.java",
                "status": "modified",
                "additions": 11,
                "deletions": 11,
                "changes": 22,
                "blob_url": "https://github.com/apache/jspwiki/blob/1e3329514207242e1fc77a86281ce43739b5f4b5/src/com/ecyrd/jspwiki/auth/UserManager.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1e3329514207242e1fc77a86281ce43739b5f4b5/src/com/ecyrd/jspwiki/auth/UserManager.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/UserManager.java?ref=1e3329514207242e1fc77a86281ce43739b5f4b5",
                "patch": "@@ -215,7 +215,7 @@ public final UserProfile getUserProfile( WikiSession session )\n             user = session.getUserPrincipal();\n             try\n             {\n-                profile = m_database.find( user.getName() );\n+                profile = getUserDatabase().find( user.getName() );\n                 newProfile = false;\n             }\n             catch( NoSuchPrincipalException e )\n@@ -225,7 +225,7 @@ public final UserProfile getUserProfile( WikiSession session )\n \n         if ( newProfile )\n         {\n-            profile = m_database.newProfile();\n+            profile = getUserDatabase().newProfile();\n             if ( user != null )\n             {\n                 profile.setLoginName( user.getName() );\n@@ -299,7 +299,7 @@ public final void setUserProfile( WikiSession session, UserProfile profile ) thr\n         UserProfile otherProfile;\n         try\n         {\n-            otherProfile = m_database.findByLoginName( profile.getLoginName() );\n+            otherProfile = getUserDatabase().findByLoginName( profile.getLoginName() );\n             if ( otherProfile != null && !otherProfile.equals( oldProfile ) )\n             {\n                 throw new DuplicateUserException( \"The login name '\" + profile.getLoginName() + \"' is already taken.\" );\n@@ -310,7 +310,7 @@ public final void setUserProfile( WikiSession session, UserProfile profile ) thr\n         }\n         try\n         {\n-            otherProfile = m_database.findByFullName( profile.getFullname() );\n+            otherProfile = getUserDatabase().findByFullName( profile.getFullname() );\n             if ( otherProfile != null && !otherProfile.equals( oldProfile ) )\n             {\n                 throw new DuplicateUserException( \"The full name '\" + profile.getFullname() + \"' is already taken.\" );\n@@ -382,11 +382,11 @@ public final void setUserProfile( WikiSession session, UserProfile profile ) thr\n             // If login name changed, rename it first\n             if ( nameChanged && oldProfile != null && !oldProfile.getLoginName().equals( profile.getLoginName() ) )\n             {\n-                m_database.rename( oldProfile.getLoginName(), profile.getLoginName() );\n+                getUserDatabase().rename( oldProfile.getLoginName(), profile.getLoginName() );\n             }\n \n             // Now, save the profile (userdatabase will take care of timestamps for us)\n-            m_database.save( profile );\n+            getUserDatabase().save( profile );\n \n             if ( nameChanged )\n             {\n@@ -501,7 +501,7 @@ public final void validateProfile( WikiContext context, UserProfile profile )\n         // unless we're allowed to add profiles to the container\n         if ( m_engine.getAuthenticationManager().isContainerAuthenticated()\n              && !context.getWikiSession().isAuthenticated()\n-             && !m_database.isSharedWithContainer() )\n+             && !getUserDatabase().isSharedWithContainer() )\n         {\n             session.addMessage( SESSION_MESSAGES, rb.getString(\"security.error.createprofilebeforelogin\") );\n         }\n@@ -539,7 +539,7 @@ public final void validateProfile( WikiContext context, UserProfile profile )\n         // It's illegal to use as a full name someone else's login name\n         try\n         {\n-            otherProfile = m_database.find( fullName );\n+            otherProfile = getUserDatabase().find( fullName );\n             if ( otherProfile != null && !profile.equals( otherProfile ) && !fullName.equals( otherProfile.getFullname() ) )\n             {\n                 Object[] args = { fullName };\n@@ -553,7 +553,7 @@ public final void validateProfile( WikiContext context, UserProfile profile )\n         // It's illegal to use as a login name someone else's full name\n         try\n         {\n-            otherProfile = m_database.find( loginName );\n+            otherProfile = getUserDatabase().find( loginName );\n             if ( otherProfile != null && !profile.equals( otherProfile ) && !loginName.equals( otherProfile.getLoginName() ) )\n             {\n                 Object[] args = { loginName };\n@@ -568,7 +568,7 @@ public final void validateProfile( WikiContext context, UserProfile profile )\n     public Principal[] listWikiNames()\n         throws WikiSecurityException\n     {\n-        return m_database.getWikiNames();\n+        return getUserDatabase().getWikiNames();\n     }\n \n     /**\n@@ -822,7 +822,7 @@ public UserProfile getUserInfo( String uid )\n             throws NoSuchPrincipalException\n         {\n             log.info(\"request \"+uid);\n-            UserProfile prof = m_database.find( uid );\n+            UserProfile prof = getUserDatabase().find( uid );\n \n             log.info(\"answer \"+prof);\n "
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/3741265b380d20f07d300c3e5e5d420d7c4c5ce9",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/b17a9384475195886715dcf65db29b1c345e1e7c",
        "message": "Removed some cut-n-past code which was not being used.\nAdded fix for Bug 25, and self-reference pages For Bug 21\nAdded an extra NPE check\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626658 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_50",
        "file": [
            {
                "sha": "f120a1beeb0e8d3e8cadd2a2d8b617c24705fdae",
                "filename": "src/com/ecyrd/jspwiki/PageRenamer.java",
                "status": "modified",
                "additions": 9,
                "deletions": 7,
                "changes": 16,
                "blob_url": "https://github.com/apache/jspwiki/blob/3741265b380d20f07d300c3e5e5d420d7c4c5ce9/src/com/ecyrd/jspwiki/PageRenamer.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/3741265b380d20f07d300c3e5e5d420d7c4c5ce9/src/com/ecyrd/jspwiki/PageRenamer.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/PageRenamer.java?ref=3741265b380d20f07d300c3e5e5d420d7c4c5ce9",
                "patch": "@@ -55,13 +55,6 @@\n     private Pattern m_longLinkPattern = null;\n     private Pattern m_camelCaseLinkPattern = null;\n \n-    /** Extension to be appended onto directories to denote they contain attachments. */\n-    public static final String DIR_EXTENSION   = \"-att\";\n-    \n-    /** Property key denoting storage directory for attachments. */\n-    public static final String PROP_STORAGEDIR = \"jspwiki.basicAttachmentProvider.storageDir\";\n-\n-\n     /**\n      * Constructor, ties this renamer instance to a WikiEngine.\n      * @param engine the wiki engine\n@@ -206,6 +199,10 @@ private void updateReferrersOnRename( WikiContext context,\n             updateReferrerOnRename( context, oldName, newName, changeReferrers, referrerName );\n         }\n \n+        //  Manage self-references, which the RefMgr is not managing for us\n+        \n+        updateReferrerOnRename( context, oldName, newName, changeReferrers, newName );\n+        \n         m_wikiEngine.getReferenceManager().clearPageEntries( oldName );\n \n         String text = m_wikiEngine.getText( newName );\n@@ -328,6 +325,11 @@ private String replaceLongLinks( String text, String oldName, String replacement\n             String anchor = \"\";\n             String subpage = \"\";\n \n+            if( link == null )\n+            {\n+                throw new InternalWikiException( \"Null link while trying to rename!  Culprit text is \"+text );\n+            }\n+            \n             int hash;\n             if( (hash = link.indexOf('#')) != -1 )\n             {"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/1a08b5b7ecf250414274434b8db821a31048d32a",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/87cd277eca3dd34f280569d6c907b264d89b9eda",
        "message": "    1. Handle defined & undefined wiki pages that have a CSS class value other than\n       the default ones.\n    2. Prevent NPE when a link tag doesn't have a title attribute.\n    3. Prevent a FCKeditor bug involving whitespace in a PRE tag from occuring.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@626233 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_51",
        "file": [
            {
                "sha": "176b8a127551bc4a24a220f0a3cbb838b3d60076",
                "filename": "src/com/ecyrd/jspwiki/render/WysiwygEditingRenderer.java",
                "status": "modified",
                "additions": 32,
                "deletions": 33,
                "changes": 65,
                "blob_url": "https://github.com/apache/jspwiki/blob/1a08b5b7ecf250414274434b8db821a31048d32a/src/com/ecyrd/jspwiki/render/WysiwygEditingRenderer.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/1a08b5b7ecf250414274434b8db821a31048d32a/src/com/ecyrd/jspwiki/render/WysiwygEditingRenderer.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/render/WysiwygEditingRenderer.java?ref=1a08b5b7ecf250414274434b8db821a31048d32a",
                "patch": "@@ -73,49 +73,48 @@ private void processChildren(Element baseElement)\n                         \n                         XHtmlToWikiConfig wikiConfig = new XHtmlToWikiConfig( m_context );\n                         \n-                        if( classValue.equals( \"wikipage\" ) )\n+                        // Get the url for wiki page link - it's typically \"Wiki.jsp?page=MyPage\"\n+                        // or when using the ShortURLConstructor option, it's \"wiki/MyPage\" .\n+                        String wikiPageLinkUrl = wikiConfig.getWikiJspPage();\n+                        String editPageLinkUrl = wikiConfig.getEditJspPage();\n+                        \n+                        if( classValue.equals( \"wikipage\" )\n+                            || ( hrefAttr != null && hrefAttr.getValue().startsWith( wikiPageLinkUrl ) ) )\n                         {\n-                            // get the url for wiki page link - it's typically \"Wiki.jsp?page=MyPage\"\n-                            // or when using the ShortURLConstructor option, it's \"wiki/MyPage\" .\n-                            String wikiPageLinkUrl = wikiConfig.getWikiJspPage();\n-\n-                            if( hrefAttr != null && hrefAttr.getValue().startsWith( wikiPageLinkUrl ) ) // we might not need this check\n-                            {\n-                                String newHref = null;\n+                            String newHref = null;\n \n-                                // Remove the leading url string so that users will only see the\n-                                // wikipage's name when editing an existing wiki link.\n-                                // For example, change \"Wiki.jsp?page=MyPage\" to just \"MyPage\".\n-                                newHref = hrefAttr.getValue().substring( wikiPageLinkUrl.length() );\n+                            // Remove the leading url string so that users will only see the\n+                            // wikipage's name when editing an existing wiki link.\n+                            // For example, change \"Wiki.jsp?page=MyPage\" to just \"MyPage\".\n+                            newHref = hrefAttr.getValue().substring( wikiPageLinkUrl.length() );\n                                 \n-                                // Handle links with section anchors.\n-                                // For example, we need to translate the html string \"TargetPage#section-TargetPage-Heading2\"\n-                                // to this wiki string: \"TargetPage#Heading2\".\n-                                hrefAttr.setValue( newHref.replaceFirst( \".+#section-(.+)-(.+)\", \"$1#$2\" ) );\n-                            }\n-                        }\n-                        else if( classValue.equals( \"editpage\" ) )\n+                            // Handle links with section anchors.\n+                            // For example, we need to translate the html string \"TargetPage#section-TargetPage-Heading2\"\n+                            // to this wiki string: \"TargetPage#Heading2\".\n+                            hrefAttr.setValue( newHref.replaceFirst( \".+#section-(.+)-(.+)\", \"$1#$2\" ) );\n+                        }                        \n+                        else if ( classValue.equals( \"editpage\" ) \n+                            || ( hrefAttr != null && hrefAttr.getValue().startsWith( editPageLinkUrl ) ) )\n                         {\n-                            String editPageLinkUrl = wikiConfig.getEditJspPage();\n-\n-                            if( hrefAttr != null && hrefAttr.getValue().startsWith( editPageLinkUrl ) ) // we might not need this check\n+                            Attribute titleAttr = element.getAttribute( \"title\" );\n+                            if( titleAttr != null )\n                             {\n-                                Attribute titleAttr = element.getAttribute( \"title\" );\n+                                // remove the title since we don't want to eventually save the default undefined page title.\n                                 titleAttr.detach();\n-                                \n-                                String newHref = null;\n-                                newHref = hrefAttr.getValue().substring( editPageLinkUrl.length() );\n-                                hrefAttr.setValue( newHref.replaceFirst( \".+#section-(.+)-(.+)\", \"$1#$2\" ) );\n-                                                             \n-                                // only remove the href if it's the same as the link text.\n-                                if( hrefAttr.getValue().equals( element.getText() ) )\n-                                {\n-                                    hrefAttr.detach();\n-                                }\n                             }\n+\n+                            hrefAttr.setValue( hrefAttr.getValue().substring( editPageLinkUrl.length() ) );\n                         }\n                     }\n                 } // end of check for \"a\" element\n+                else if( elementName.equals( \"pre\" ) )\n+                {\n+                    // We need to trim the surrounding whitespace to accomodate a FCK bug: when the first line \n+                    // of a <pre> tag contains only whitespace, then all the linebreaks in the <pre>\n+                    // tag will be lost due to FCK's html tidying.\n+                    String text = element.getTextTrim();\n+                    element.setText( text );\n+                }\n \n                 processChildren( element );\n             }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/jspwiki/commit/264a8efa3475b5d06f689a1620d40fc70a958883",
        "repo": "jspwiki",
        "parent": "https://github.com/apache/jspwiki/commit/a15e8b642e6a6b10aef6e2d1926741d04cacbe52",
        "message": "Fixed a NPE in JDBCUserDatabase that was triggered by a user editing a profile, but electing not to change the password. It now exhibits correct behavoir: no password means \"use the old one\", just like with XMLUserDatabase.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/jspwiki/trunk@624717 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "jspwiki_52",
        "file": [
            {
                "sha": "3cb7d5e7b80edc04718dd881d81a54c4a20c8d71",
                "filename": "src/com/ecyrd/jspwiki/auth/user/JDBCUserDatabase.java",
                "status": "modified",
                "additions": 24,
                "deletions": 10,
                "changes": 34,
                "blob_url": "https://github.com/apache/jspwiki/blob/264a8efa3475b5d06f689a1620d40fc70a958883/src/com/ecyrd/jspwiki/auth/user/JDBCUserDatabase.java",
                "raw_url": "https://github.com/apache/jspwiki/raw/264a8efa3475b5d06f689a1620d40fc70a958883/src/com/ecyrd/jspwiki/auth/user/JDBCUserDatabase.java",
                "contents_url": "https://api.github.com/repos/apache/jspwiki/contents/src/com/ecyrd/jspwiki/auth/user/JDBCUserDatabase.java?ref=264a8efa3475b5d06f689a1620d40fc70a958883",
                "patch": "@@ -77,6 +77,12 @@\n  *     <td><code>wiki_name</code></td>\n  *     <td>The column containing the user's wiki name</td>\n  *   </tr>\n+ *   <tr>\n+ *     <td><code>jspwiki.userdatabase.hashPrefix</code></td>\n+ *     <td><code>true</code></td>\n+ *     <td>Whether or not to prepend a prefix for the hash algorithm, <em>e.g.</em>,\n+ *         <code>{SHA}</code>.</td>\n+ *   </tr>\n  * </table>\n  * <p>This class hashes passwords using SHA-1. All of the underying SQL commands used by this class are implemented using\n  * prepared statements, so it is immune to SQL injection attacks.</p>\n@@ -97,7 +103,7 @@\n  * see <a href=\"http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html\">\n  * http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html</a>.\n  * @author Andrew R. Jaquith\n- * @version $Revision: 1.1 $ $Date: 2005-10-19 12:09:19 $\n+ * @version $Revision: 1.2 $ $Date: 2005-10-25 05:54:15 $\n  * @since 2.3\n  */public class JDBCUserDatabase extends AbstractUserDatabase\n {\n@@ -108,6 +114,8 @@\n \n     public static final String DEFAULT_DB_FULL_NAME  = \"full_name\";\n \n+    public static final String DEFAULT_DB_HASH_PREFIX = \"true\";\n+    \n     public static final String DEFAULT_DB_JNDI_NAME  = \"jdbc/UserDatabase\";\n \n     public static final String DEFAULT_DB_MODIFIED   = \"modified\";\n@@ -127,6 +135,8 @@\n     public static final String PROP_DB_FULL_NAME     = \"jspwiki.userdatabase.fullName\";\n \n     public static final String PROP_DB_DATASOURCE    = \"jspwiki.userdatabase.datasource\";\n+    \n+    public static final String PROP_DB_HASH_PREFIX   = \"jspwiki.userdatabase.hashPrefix\";\n \n     public static final String PROP_DB_LOGIN_NAME    = \"jspwiki.userdatabase.loginName\";\n \n@@ -149,6 +159,7 @@\n     private String m_table = null;\n     private String m_email = null;\n     private String m_fullName = null;\n+    private boolean m_hashPrefix = true;\n     private String m_loginName = null;\n     private String m_password = null;\n     private String m_wikiName = null;\n@@ -212,6 +223,7 @@ public void initialize( WikiEngine engine, Properties props ) throws NoRequiredP\n             m_table     = props.getProperty( PROP_DB_TABLE, DEFAULT_DB_TABLE );\n             m_email     = props.getProperty( PROP_DB_EMAIL, DEFAULT_DB_EMAIL );\n             m_fullName  = props.getProperty( PROP_DB_FULL_NAME, DEFAULT_DB_FULL_NAME );\n+            m_hashPrefix = Boolean.valueOf( props.getProperty( PROP_DB_HASH_PREFIX, DEFAULT_DB_HASH_PREFIX ) ).booleanValue();\n             m_loginName = props.getProperty( PROP_DB_LOGIN_NAME, DEFAULT_DB_LOGIN_NAME );\n             m_password  = props.getProperty( PROP_DB_PASSWORD, DEFAULT_DB_PASSWORD );\n             m_wikiName  = props.getProperty( PROP_DB_WIKI_NAME, DEFAULT_DB_WIKI_NAME );\n@@ -293,20 +305,22 @@ public void save( UserProfile profile ) throws WikiSecurityException\n         }\n         \n         // Get a clean password from the passed profile.\n-        // Hash the password if it isn't null, doesn't exist, or has changed.\n-        // Blank password is the same as null\n+        // Blank password is the same as null, which means we re-use the existing one.\n         String password = profile.getPassword();\n         String existingPassword = ( existingProfile == null ) ? null : existingProfile.getPassword();\n-        if ( password.equals(\"\") )\n+        if ( \"\".equals( password ) )\n         {\n             password = null;\n         }\n-        if ( password != null) \n-            {\n-            if ( existingPassword != null || !password.equals( existingPassword ) ) \n-            {\n-                password =  SHA_PREFIX + getHash( password );\n-            }\n+        if ( password == null) \n+        {\n+            password = existingPassword;\n+        }\n+        \n+        // If password changed, hash it before we save\n+        if ( !password.equals( existingPassword ) )\n+        {\n+            password =  ( m_hashPrefix ) ? SHA_PREFIX + getHash( password ) : getHash( password );\n         }\n         \n         try"
            }
        ]
    }
]
