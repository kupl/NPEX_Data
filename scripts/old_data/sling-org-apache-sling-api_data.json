[
    {
        "commit": "https://github.com/apache/sling-org-apache-sling-api/commit/d354f2a59b5af26d9f0573139be149875385f8da",
        "repo": "sling-org-apache-sling-api",
        "parent": "https://github.com/apache/sling-org-apache-sling-api/commit/74c7bab6a720af1a01f9d72ab38385c1cec531d5",
        "message": "SLING-988 Ensure ResourceUtil.getValueMap does not throw a\nNullPointerException (thanks Julian Sedding for providing\nthe patch)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/sling/trunk@780748 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "sling-org-apache-sling-api_1",
        "file": [
            {
                "sha": "53f48af1fa6946b9882f17775731d6e6f14e77f5",
                "filename": "src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "status": "modified",
                "additions": 6,
                "deletions": 3,
                "changes": 9,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/d354f2a59b5af26d9f0573139be149875385f8da/src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/d354f2a59b5af26d9f0573139be149875385f8da/src/main/java/org/apache/sling/api/resource/ResourceUtil.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/main/java/org/apache/sling/api/resource/ResourceUtil.java?ref=d354f2a59b5af26d9f0573139be149875385f8da",
                "patch": "@@ -285,11 +285,14 @@ public static boolean isNonExistingResource(Resource res) {\n      * @param res The <code>Resource</code> to adapt to the value map.\n      * @return A value map.\n      */\n+    @SuppressWarnings(\"unchecked\")\n     public static ValueMap getValueMap(final Resource res) {\n-        ValueMap map = (res == null ? null : res.adaptTo(ValueMap.class));\n-        if ( map == null ) {\n+        ValueMap map = (res == null)\n+                ? ValueMap.EMPTY\n+                : res.adaptTo(ValueMap.class);\n+        if (map == null) {\n             Map m = res.adaptTo(Map.class);\n-            if ( m != null ) {\n+            if (m != null) {\n                 map = new ValueMapDecorator(m);\n             } else {\n                 map = ValueMap.EMPTY;"
            },
            {
                "sha": "8284fbb512a528deb5de0d4af8c4efba1fe8c3e0",
                "filename": "src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "status": "modified",
                "additions": 7,
                "deletions": 0,
                "changes": 7,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/d354f2a59b5af26d9f0573139be149875385f8da/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/d354f2a59b5af26d9f0573139be149875385f8da/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/test/java/org/apache/sling/api/resource/ResourceUtilTest.java?ref=d354f2a59b5af26d9f0573139be149875385f8da",
                "patch": "@@ -147,4 +147,11 @@ public void testGetName() {\n         assertEquals(\"b\", ResourceUtil.getName(\"/b/c/..\"));\n         assertEquals(\"\", ResourceUtil.getName(\"/b/c/../..\"));\n     }\n+\n+    public void testGetValueMap() {\n+        // expect an empty ValueMap \n+        ValueMap valueMap = ResourceUtil.getValueMap(null);\n+        assertNotNull(valueMap);\n+        assertEquals(0, valueMap.size());\n+    }\n }"
            }
        ]
    },
    {
        "commit": "https://github.com/apache/sling-org-apache-sling-api/commit/c035e55b5e271dd9f220551f2240c85b2db66ddc",
        "repo": "sling-org-apache-sling-api",
        "parent": "https://github.com/apache/sling-org-apache-sling-api/commit/1a9d9925fb047b9c2ef4c13a143ed36cfd29e15a",
        "message": "SLING-1352 : ValueMapDecorator#get(String name, T defaultValue) throws NPE if default value is null\n\ngit-svn-id: https://svn.apache.org/repos/asf/sling/trunk@906858 13f79535-47bb-0310-9956-ffa450edef68",
        "bug_id": "sling-org-apache-sling-api_2",
        "file": [
            {
                "sha": "b40e726a9a4ed115c2152cc1b48f9023366b41d4",
                "filename": "src/main/java/org/apache/sling/api/resource/ValueMap.java",
                "status": "modified",
                "additions": 1,
                "deletions": 1,
                "changes": 2,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/c035e55b5e271dd9f220551f2240c85b2db66ddc/src/main/java/org/apache/sling/api/resource/ValueMap.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/c035e55b5e271dd9f220551f2240c85b2db66ddc/src/main/java/org/apache/sling/api/resource/ValueMap.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/main/java/org/apache/sling/api/resource/ValueMap.java?ref=c035e55b5e271dd9f220551f2240c85b2db66ddc",
                "patch": "@@ -54,7 +54,7 @@\n      * @param defaultValue The default value to use if the named property does\n      *            not exist or cannot be converted to the requested type. The\n      *            default value is also used to define the type to convert the\n-     *            value to. If this is <code>null</code> any existing propert is\n+     *            value to. If this is <code>null</code> any existing property is\n      *            not converted.\n      * @return Return named value converted to type T or the default value if\n      *         non existing or can't be converted."
            },
            {
                "sha": "d9c942ff6391680f801950ca560e93dd3678fd3d",
                "filename": "src/main/java/org/apache/sling/api/wrappers/ValueMapDecorator.java",
                "status": "modified",
                "additions": 3,
                "deletions": 0,
                "changes": 3,
                "blob_url": "https://github.com/apache/sling-org-apache-sling-api/blob/c035e55b5e271dd9f220551f2240c85b2db66ddc/src/main/java/org/apache/sling/api/wrappers/ValueMapDecorator.java",
                "raw_url": "https://github.com/apache/sling-org-apache-sling-api/raw/c035e55b5e271dd9f220551f2240c85b2db66ddc/src/main/java/org/apache/sling/api/wrappers/ValueMapDecorator.java",
                "contents_url": "https://api.github.com/repos/apache/sling-org-apache-sling-api/contents/src/main/java/org/apache/sling/api/wrappers/ValueMapDecorator.java?ref=c035e55b5e271dd9f220551f2240c85b2db66ddc",
                "patch": "@@ -113,6 +113,9 @@ public ValueMapDecorator(Map<String, Object> base) {\n      */\n     @SuppressWarnings(\"unchecked\")\n     public <T> T get(String name, T defaultValue) {\n+        if ( defaultValue == null ) {\n+            return (T)get(name);\n+        }\n         T value = get(name, (Class<T>) defaultValue.getClass());\n         return value == null ? defaultValue : value;\n     }"
            }
        ]
    }
]
