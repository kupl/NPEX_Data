[
    {
        "parent": "https://github.com/apache/incubator-hudi/commit/def18a5086cac23266dec4e285cc7850ef8ac011",
        "bug_id": "incubator-hudi_1",
        "file": [
            {
                "additions": 1,
                "sha": "77b93133fcdbbca965de92d3d3b86354b06e8939",
                "status": "modified",
                "raw_url": "https://github.com/apache/incubator-hudi/raw/842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java",
                "deletions": 1,
                "filename": "hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-hudi/contents/hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java?ref=842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8",
                "patch": "@@ -227,7 +227,7 @@ public String showLogFileRecords(\n         }\n       }\n     }\n-    String[][] rows = new String[allRecords.size() + 1][];\n+    String[][] rows = new String[allRecords.size()][];\n     int i = 0;\n     for (IndexedRecord record : allRecords) {\n       String[] data = new String[1];",
                "changes": 2,
                "blob_url": "https://github.com/apache/incubator-hudi/blob/842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java"
            },
            {
                "additions": 1,
                "sha": "4b4c2834043bef39de03b6564afb7a2d4879cc9b",
                "status": "modified",
                "raw_url": "https://github.com/apache/incubator-hudi/raw/842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java",
                "deletions": 1,
                "filename": "hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-hudi/contents/hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java?ref=842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8",
                "patch": "@@ -77,7 +77,7 @@ public String addPartitionMeta(\n     List<String> partitionPaths =\n         FSUtils.getAllPartitionFoldersThreeLevelsDown(HoodieCLI.fs, client.getBasePath());\n     Path basePath = new Path(client.getBasePath());\n-    String[][] rows = new String[partitionPaths.size() + 1][];\n+    String[][] rows = new String[partitionPaths.size()][];\n \n     int ind = 0;\n     for (String partition : partitionPaths) {",
                "changes": 2,
                "blob_url": "https://github.com/apache/incubator-hudi/blob/842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java"
            }
        ],
        "repo": "incubator-hudi",
        "message": "[HUDI-470] Fix NPE when print result via hudi-cli (#1138)",
        "commit": "https://github.com/apache/incubator-hudi/commit/842eabb27fc7b4295a6ad8a44fb21ba0394c7aa8"
    },
    {
        "parent": "https://github.com/apache/incubator-hudi/commit/8df4b83017f74173b8289ab50b0f723a38e8eebe",
        "bug_id": "incubator-hudi_2",
        "file": [
            {
                "additions": 10,
                "sha": "363e0a3b4f77c68896c680083d7bc009ff520b92",
                "status": "modified",
                "raw_url": "https://github.com/apache/incubator-hudi/raw/24a09c775f6d4b855e2096001f5e034da80158a8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/SavepointsCommand.java",
                "deletions": 5,
                "filename": "hudi-cli/src/main/java/org/apache/hudi/cli/commands/SavepointsCommand.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-hudi/contents/hudi-cli/src/main/java/org/apache/hudi/cli/commands/SavepointsCommand.java?ref=24a09c775f6d4b855e2096001f5e034da80158a8",
                "patch": "@@ -84,8 +84,8 @@ public String showSavepoints() throws IOException {\n \n   @CliCommand(value = \"savepoint create\", help = \"Savepoint a commit\")\n   public String savepoint(@CliOption(key = {\"commit\"}, help = \"Commit to savepoint\") final String commitTime,\n-      @CliOption(key = {\"user\"}, help = \"User who is creating the savepoint\") final String user,\n-      @CliOption(key = {\"comments\"}, help = \"Comments for creating the savepoint\") final String comments)\n+      @CliOption(key = {\"user\"}, unspecifiedDefaultValue = \"default\", help = \"User who is creating the savepoint\") final String user,\n+      @CliOption(key = {\"comments\"}, unspecifiedDefaultValue = \"default\", help = \"Comments for creating the savepoint\") final String comments)\n       throws Exception {\n     HoodieActiveTimeline activeTimeline = HoodieCLI.tableMetadata.getActiveTimeline();\n     HoodieTimeline timeline = activeTimeline.getCommitTimeline().filterCompletedInstants();\n@@ -95,13 +95,18 @@ public String savepoint(@CliOption(key = {\"commit\"}, help = \"Commit to savepoint\n       return \"Commit \" + commitTime + \" not found in Commits \" + timeline;\n     }\n \n-    HoodieWriteClient client = createHoodieClient(null, HoodieCLI.tableMetadata.getBasePath());\n+    JavaSparkContext jsc = SparkUtil.initJavaSparkConf(\"Create Savepoint\");\n+    HoodieWriteClient client = createHoodieClient(jsc, HoodieCLI.tableMetadata.getBasePath());\n+    String result;\n     if (client.savepoint(commitTime, user, comments)) {\n       // Refresh the current\n       refreshMetaClient();\n-      return String.format(\"The commit \\\"%s\\\" has been savepointed.\", commitTime);\n+      result = String.format(\"The commit \\\"%s\\\" has been savepointed.\", commitTime);\n+    } else {\n+      result = String.format(\"Failed: Could not savepoint commit \\\"%s\\\".\", commitTime);\n     }\n-    return String.format(\"Failed: Could not savepoint commit \\\"%s\\\".\", commitTime);\n+    jsc.close();\n+    return result;\n   }\n \n   @CliCommand(value = \"savepoint rollback\", help = \"Savepoint a commit\")",
                "changes": 15,
                "blob_url": "https://github.com/apache/incubator-hudi/blob/24a09c775f6d4b855e2096001f5e034da80158a8/hudi-cli/src/main/java/org/apache/hudi/cli/commands/SavepointsCommand.java"
            },
            {
                "additions": 5,
                "sha": "3a21e5639bf6f7113b2ab9ccaf952bc9948f0ece",
                "status": "modified",
                "raw_url": "https://github.com/apache/incubator-hudi/raw/24a09c775f6d4b855e2096001f5e034da80158a8/hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java",
                "deletions": 1,
                "filename": "hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java",
                "contents_url": "https://api.github.com/repos/apache/incubator-hudi/contents/hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java?ref=24a09c775f6d4b855e2096001f5e034da80158a8",
                "patch": "@@ -61,10 +61,14 @@ public static SparkLauncher initLauncher(String propertiesFile) throws URISyntax\n \n   public static JavaSparkContext initJavaSparkConf(String name) {\n     SparkConf sparkConf = new SparkConf().setAppName(name);\n-    String defMasterFromEnv = sparkConf.get(\"spark.master\");\n+\n+    String defMasterFromEnv = sparkConf.getenv(\"SPARK_MASTER\");\n     if ((null == defMasterFromEnv) || (defMasterFromEnv.isEmpty())) {\n       sparkConf.setMaster(DEFUALT_SPARK_MASTER);\n+    } else {\n+      sparkConf.setMaster(defMasterFromEnv);\n     }\n+\n     sparkConf.set(\"spark.serializer\", \"org.apache.spark.serializer.KryoSerializer\");\n     sparkConf.set(\"spark.driver.maxResultSize\", \"2g\");\n     sparkConf.set(\"spark.eventLog.overwrite\", \"true\");",
                "changes": 6,
                "blob_url": "https://github.com/apache/incubator-hudi/blob/24a09c775f6d4b855e2096001f5e034da80158a8/hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java"
            }
        ],
        "repo": "incubator-hudi",
        "message": "[HUDI-387] Fix NPE when create savepoint via hudi-cli (#1085)",
        "commit": "https://github.com/apache/incubator-hudi/commit/24a09c775f6d4b855e2096001f5e034da80158a8"
    },
    {
        "parent": "https://github.com/apache/incubator-hudi/commit/89cd6b072687b056324f34e1b2c9e59ff50d8c40",
        "bug_id": "incubator-hudi_3",
        "file": [
            {
                "additions": 1,
                "sha": "f0e960fa17e3b47deda2b8ef3760c36c05c3e03c",
                "status": "modified",
                "raw_url": "https://github.com/apache/incubator-hudi/raw/2eaa42abdeb336150eb59159e3fcf1b37f060ac1/pom.xml",
                "deletions": 1,
                "filename": "pom.xml",
                "contents_url": "https://api.github.com/repos/apache/incubator-hudi/contents/pom.xml?ref=2eaa42abdeb336150eb59159e3fcf1b37f060ac1",
                "patch": "@@ -362,7 +362,7 @@\n       <dependency>\n         <groupId>com.beust</groupId>\n         <artifactId>jcommander</artifactId>\n-        <version>1.48</version>\n+        <version>1.72</version>\n       </dependency>\n \n       <dependency>",
                "changes": 2,
                "blob_url": "https://github.com/apache/incubator-hudi/blob/2eaa42abdeb336150eb59159e3fcf1b37f060ac1/pom.xml"
            }
        ],
        "repo": "incubator-hudi",
        "message": "Updated jcommander version to fix NPE in HoodieDeltaStreamer tool",
        "commit": "https://github.com/apache/incubator-hudi/commit/2eaa42abdeb336150eb59159e3fcf1b37f060ac1"
    }
]