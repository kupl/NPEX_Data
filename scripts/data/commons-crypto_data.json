[
    {
        "commit": "https://github.com/apache/commons-crypto/commit/46f2dfce52847349acf6f84dfe02a77868f5f449",
        "file": [
            {
                "patch": "@@ -84,11 +84,9 @@ public static boolean isNativeCodeLoaded() {\n      */\n     public OpensslCryptoRandom(Properties props)\n             throws NoSuchAlgorithmException {\n-        if (!nativeEnabled) {\n-            fallback = new JavaCryptoRandom(props);\n-        } else {\n-            fallback = null;\n-        }\n+        //fallback needs to be initialized here in any case cause even if\n+        //nativeEnabled is true OpensslCryptoRandomNative.nextRandBytes may fail\n+        fallback = new JavaCryptoRandom(props);\n     }\n \n     /**\n@@ -145,7 +143,7 @@ final protected int next(int numBits) {\n      */\n     @Override\n     public void close() {\n-        if (!nativeEnabled && fallback != null) {\n+        if (fallback != null) {\n             fallback.close();\n         }\n     }",
                "additions": 4,
                "raw_url": "https://github.com/apache/commons-crypto/raw/46f2dfce52847349acf6f84dfe02a77868f5f449/src/main/java/org/apache/commons/crypto/random/OpensslCryptoRandom.java",
                "status": "modified",
                "changes": 10,
                "deletions": 6,
                "sha": "1813624ef18f167cd457f32d5c4f67e3ba54d2b9",
                "blob_url": "https://github.com/apache/commons-crypto/blob/46f2dfce52847349acf6f84dfe02a77868f5f449/src/main/java/org/apache/commons/crypto/random/OpensslCryptoRandom.java",
                "filename": "src/main/java/org/apache/commons/crypto/random/OpensslCryptoRandom.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/main/java/org/apache/commons/crypto/random/OpensslCryptoRandom.java?ref=46f2dfce52847349acf6f84dfe02a77868f5f449"
            }
        ],
        "bug_id": "commons-crypto_1",
        "parent": "https://github.com/apache/commons-crypto/commit/ff397177233a5e927cc2dcb41383bb626c34d56f",
        "message": "CRYPTO-61: fix possible NPE if OpensslCryptoRandomNative.nextRandBytes fails",
        "repo": "commons-crypto"
    },
    {
        "commit": "https://github.com/apache/commons-crypto/commit/77284d6ac3345867fe0449183ae0e11760f4f29c",
        "file": [
            {
                "patch": "@@ -41,8 +41,8 @@\n   public static final String CHIMERA_JAVA_SECURE_RANDOM_ALGORITHM_DEFAULT =\n       \"SHA1PRNG\";\n \n-  public static final String CHIMERA_SECURE_RANDOM_CLASSES_KEY =\n-      CONF_PREFIX + \".secure.random.classes\";\n+  public static final String CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY =\n+      CONF_PREFIX + \".crypto.secure.random.classes\";\n \n   public static final int CHIMERA_CRYPTO_BUFFER_SIZE_DEFAULT = 8192;\n   public static final String CHIMERA_CRYPTO_BUFFER_SIZE_KEY =",
                "additions": 2,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "status": "modified",
                "changes": 4,
                "deletions": 2,
                "sha": "20c06d1d2248ff0a4149250f455a98b9df4b3d24",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "filename": "src/main/java/com/intel/chimera/conf/ConfigurationKeys.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/main/java/com/intel/chimera/conf/ConfigurationKeys.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c"
            },
            {
                "patch": "@@ -25,7 +25,7 @@\n \n import com.intel.chimera.utils.ReflectionUtils;\n import static com.intel.chimera.conf.ConfigurationKeys\n-    .CHIMERA_SECURE_RANDOM_CLASSES_KEY;\n+    .CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY;\n \n /**\n  * The Factory for SecureRandom.\n@@ -36,25 +36,27 @@\n \n   public static SecureRandom getSecureRandom(Properties props) {\n     String secureRandomClasses = props.getProperty(\n-        CHIMERA_SECURE_RANDOM_CLASSES_KEY);\n+        CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY);\n     if (secureRandomClasses == null) {\n       secureRandomClasses = System.getProperty(\n-          CHIMERA_SECURE_RANDOM_CLASSES_KEY);\n+          CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY);\n     }\n \n     SecureRandom random = null;\n-    for (String klassName : Splitter.on(',').trimResults().omitEmptyStrings()\n-        .split(secureRandomClasses)) {\n-      try {\n-        final Class klass = ReflectionUtils.getClassByName(klassName);\n-        random = (SecureRandom) ReflectionUtils.newInstance(klass, props);\n-        if (random != null) {\n-          break;\n+    if (secureRandomClasses != null) {\n+      for (String klassName : Splitter.on(',').trimResults().omitEmptyStrings()\n+          .split(secureRandomClasses)) {\n+        try {\n+          final Class klass = ReflectionUtils.getClassByName(klassName);\n+          random = (SecureRandom) ReflectionUtils.newInstance(klass, props);\n+          if (random != null) {\n+            break;\n+          }\n+        } catch (ClassCastException e) {\n+          LOG.error(\"Class {} is not a Cipher.\", klassName);\n+        } catch (ClassNotFoundException e) {\n+          LOG.error(\"Cipher {} not found.\", klassName);\n         }\n-      } catch (ClassCastException e) {\n-        LOG.error(\"Class {} is not a Cipher.\", klassName);\n-      } catch (ClassNotFoundException e) {\n-        LOG.error(\"Cipher {} not found.\", klassName);\n       }\n     }\n ",
                "additions": 16,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "status": "modified",
                "changes": 30,
                "deletions": 14,
                "sha": "e418fe0f458b4e533a3230050d97b28ebdca7572",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "filename": "src/main/java/com/intel/chimera/random/SecureRandomFactory.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/main/java/com/intel/chimera/random/SecureRandomFactory.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c"
            },
            {
                "patch": "@@ -28,7 +28,7 @@\n   @Override\n   public SecureRandom getSecureRandom() throws IOException {\n     Properties props = new Properties();\n-    props.setProperty(ConfigurationKeys.CHIMERA_SECURE_RANDOM_CLASSES_KEY,\n+    props.setProperty(ConfigurationKeys.CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY,\n         JavaSecureRandom.class.getName());\n     SecureRandom random = SecureRandomFactory.getSecureRandom(props);\n     if ( !(random instanceof JavaSecureRandom)) {",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "status": "modified",
                "changes": 2,
                "deletions": 1,
                "sha": "154e884f79278a6188193fdcb10e540cfa531131",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "filename": "src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/test/java/com/intel/chimera/random/TestJavaSecureRandom.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c"
            },
            {
                "patch": "@@ -28,7 +28,7 @@\n   @Override\n   public SecureRandom getSecureRandom() throws IOException {\n     Properties props = new Properties();\n-    props.setProperty(ConfigurationKeys.CHIMERA_SECURE_RANDOM_CLASSES_KEY,\n+    props.setProperty(ConfigurationKeys.CHIMERA_CRYPTO_SECURE_RANDOM_CLASSES_KEY,\n         OpensslSecureRandom.class.getName());\n     SecureRandom random = SecureRandomFactory.getSecureRandom(props);\n     if ( !(random instanceof OpensslSecureRandom)) {",
                "additions": 1,
                "raw_url": "https://github.com/apache/commons-crypto/raw/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "status": "modified",
                "changes": 2,
                "deletions": 1,
                "sha": "07edca5a979ce22702fef5920a8c319373a8def4",
                "blob_url": "https://github.com/apache/commons-crypto/blob/77284d6ac3345867fe0449183ae0e11760f4f29c/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "filename": "src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java",
                "contents_url": "https://api.github.com/repos/apache/commons-crypto/contents/src/test/java/com/intel/chimera/random/TestOpensslSecureRandom.java?ref=77284d6ac3345867fe0449183ae0e11760f4f29c"
            }
        ],
        "bug_id": "commons-crypto_2",
        "parent": "https://github.com/apache/commons-crypto/commit/a6fab706187bce528ca561e9cb411c01d69d07ef",
        "message": "Rename security random with crypto prefix and do NPE check for factory method",
        "repo": "commons-crypto"
    }
]