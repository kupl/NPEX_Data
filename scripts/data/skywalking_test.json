{
    "skywalking_4e50132": {
        "bug_id": "skywalking_4e50132",
        "commit": "https://github.com/apache/skywalking/commit/4e501328171f434c74144d373be6df0264f43a24",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/.gitignore",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/.gitignore?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": ".gitignore",
                "patch": "@@ -18,3 +18,5 @@ OALLexer.tokens\n .vscode \n .checkstyle\n .externalToolBuilders\n+/test/plugin/dist\n+/test/plugin/workspace",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/.gitignore",
                "sha": "c8c84886d0767eecbb7bb753f19bf5dffb778e1b",
                "status": "modified"
            },
            {
                "additions": 11,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/CHANGES.md",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/CHANGES.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "CHANGES.md",
                "patch": "@@ -2,6 +2,15 @@ Changes by Version\n ==================\n Release Notes.\n \n+6.6.0\n+------------------\n+TODO\n+\n+#### Project\n+- [**IMPORTANT**] Local span and exit span are not treated as endpoint detected at client and local. Only entry span is the endpoint. Reduce the load of register and memory cost.\n+\n+All issues and pull requests are [here](https://github.com/apache/skywalking/milestone/37?closed=1)\n+\n 6.5.0\n ------------------\n \n@@ -74,6 +83,8 @@ Release Notes.\n - Update als setup doc as istio 1.3 released (#3470)\n - Fill faq reply in official document. (#3450)\n \n+All issues and pull requests are [here](https://github.com/apache/skywalking/milestone/36?closed=1)\n+\n \n 6.4.0\n ------------------",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/CHANGES.md",
                "sha": "8724c472a08d0a88278e55a3c9d100b35bc4693b",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "patch": "@@ -317,11 +317,14 @@\n          */\n         public static class OPGroup {\n             /**\n-             * Rules for RestTemplate plugin\n+             * Since 6.6.0, exit span is not requesting endpoint register,\n+             * this group rule is not required.\n+             *\n+             * Keep this commented, just as a reminder that, it will be reused in a RPC server side plugin.\n              */\n-            public static class RestTemplate implements OPGroupDefinition {\n-                public static Map<String, String> RULE = new HashMap<String, String>();\n-            }\n+//            public static class RestTemplate implements OPGroupDefinition {\n+//                public static Map<String, String> RULE = new HashMap<String, String>();\n+//            }\n         }\n \n         public static class Light4J {",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "sha": "2bc276c3b58edb6d7bc0862fa9574437fbfc169e",
                "status": "modified"
            },
            {
                "additions": 64,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java",
                "changes": 106,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 42,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java",
                "patch": "@@ -74,7 +74,7 @@\n     /**\n      * Active spans stored in a Stack, usually called 'ActiveSpanStack'. This {@link LinkedList} is the in-memory\n      * storage-structure. <p> I use {@link LinkedList#removeLast()}, {@link LinkedList#addLast(Object)} and {@link\n-     * LinkedList#last} instead of {@link #pop()}, {@link #push(AbstractSpan)}, {@link #peek()}\n+     * LinkedList#getLast()} instead of {@link #pop()}, {@link #push(AbstractSpan)}, {@link #peek()}\n      */\n     private LinkedList<AbstractSpan> activeSpanStack = new LinkedList<AbstractSpan>();\n \n@@ -131,34 +131,58 @@ public void inject(ContextCarrier carrier) {\n         } else {\n             carrier.setPeerId(peerId);\n         }\n+\n+        AbstractSpan firstSpan = first();\n+        String firstSpanOperationName = firstSpan.getOperationName();\n+\n         List<TraceSegmentRef> refs = this.segment.getRefs();\n-        int operationId;\n-        String operationName;\n+        int operationId = DictionaryUtil.inexistence();\n+        String operationName = \"\";\n         int entryApplicationInstanceId;\n+\n         if (refs != null && refs.size() > 0) {\n             TraceSegmentRef ref = refs.get(0);\n             operationId = ref.getEntryEndpointId();\n             operationName = ref.getEntryEndpointName();\n             entryApplicationInstanceId = ref.getEntryServiceInstanceId();\n         } else {\n-            AbstractSpan firstSpan = first();\n-            operationId = firstSpan.getOperationId();\n-            operationName = firstSpan.getOperationName();\n+            if (firstSpan.isEntry()) {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n+                operationId = firstSpan.getOperationId();\n+                operationName = firstSpanOperationName;\n+            }\n             entryApplicationInstanceId = this.segment.getApplicationInstanceId();\n+\n         }\n         carrier.setEntryServiceInstanceId(entryApplicationInstanceId);\n \n         if (operationId == DictionaryUtil.nullValue()) {\n             if (!StringUtil.isEmpty(operationName)) {\n                 carrier.setEntryEndpointName(operationName);\n+            } else {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n             }\n         } else {\n             carrier.setEntryEndpointId(operationId);\n         }\n \n-        int parentOperationId = first().getOperationId();\n+        int parentOperationId = firstSpan.getOperationId();\n         if (parentOperationId == DictionaryUtil.nullValue()) {\n-            carrier.setParentEndpointName(first().getOperationName());\n+            if (firstSpan.isEntry() && !StringUtil.isEmpty(firstSpanOperationName)) {\n+                carrier.setParentEndpointName(firstSpanOperationName);\n+            } else {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n+                carrier.setParentEndpointId(DictionaryUtil.inexistence());\n+            }\n         } else {\n             carrier.setParentEndpointId(parentOperationId);\n         }\n@@ -195,33 +219,57 @@ public ContextSnapshot capture() {\n             activeSpan().getSpanId(),\n             segment.getRelatedGlobalTraces());\n         int entryOperationId;\n-        String entryOperationName;\n+        String entryOperationName = \"\";\n         int entryApplicationInstanceId;\n         AbstractSpan firstSpan = first();\n+        String firstSpanOperationName = firstSpan.getOperationName();\n+\n         if (refs != null && refs.size() > 0) {\n             TraceSegmentRef ref = refs.get(0);\n             entryOperationId = ref.getEntryEndpointId();\n             entryOperationName = ref.getEntryEndpointName();\n             entryApplicationInstanceId = ref.getEntryServiceInstanceId();\n         } else {\n-            entryOperationId = firstSpan.getOperationId();\n-            entryOperationName = firstSpan.getOperationName();\n+            if (firstSpan.isEntry()) {\n+                entryOperationId = firstSpan.getOperationId();\n+                entryOperationName = firstSpanOperationName;\n+            } else {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n+                entryOperationId = DictionaryUtil.inexistence();\n+            }\n             entryApplicationInstanceId = this.segment.getApplicationInstanceId();\n         }\n         snapshot.setEntryApplicationInstanceId(entryApplicationInstanceId);\n \n         if (entryOperationId == DictionaryUtil.nullValue()) {\n             if (!StringUtil.isEmpty(entryOperationName)) {\n                 snapshot.setEntryOperationName(entryOperationName);\n+            } else {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n             }\n         } else {\n             snapshot.setEntryOperationId(entryOperationId);\n         }\n \n-        if (firstSpan.getOperationId() == DictionaryUtil.nullValue()) {\n-            snapshot.setParentOperationName(firstSpan.getOperationName());\n+        int parentOperationId = firstSpan.getOperationId();\n+        if (parentOperationId == DictionaryUtil.nullValue()) {\n+            if (firstSpan.isEntry() && !StringUtil.isEmpty(firstSpanOperationName)) {\n+                snapshot.setParentOperationName(firstSpanOperationName);\n+            } else {\n+                /**\n+                 * Since 6.6.0, if first span is not entry span, then this is an internal segment(no RPC),\n+                 * rather than an endpoint.\n+                 */\n+                snapshot.setParentOperationId(DictionaryUtil.inexistence());\n+            }\n         } else {\n-            snapshot.setParentOperationId(firstSpan.getOperationId());\n+            snapshot.setParentOperationId(parentOperationId);\n         }\n         return snapshot;\n     }\n@@ -341,39 +389,13 @@ public AbstractSpan createExitSpan(final String operationName, final String remo\n                     new PossibleFound.FoundAndObtain() {\n                         @Override\n                         public Object doProcess(final int peerId) {\n-                            return DictionaryManager.findEndpointSection()\n-                                .findOnly(segment.getServiceId(), operationName)\n-                                .doInCondition(\n-                                    new PossibleFound.FoundAndObtain() {\n-                                        @Override\n-                                        public Object doProcess(int operationId) {\n-                                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationId, peerId);\n-                                        }\n-                                    }, new PossibleFound.NotFoundAndObtain() {\n-                                        @Override\n-                                        public Object doProcess() {\n-                                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationName, peerId);\n-                                        }\n-                                    });\n+                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationName, peerId);\n                         }\n                     },\n                     new PossibleFound.NotFoundAndObtain() {\n                         @Override\n                         public Object doProcess() {\n-                            return DictionaryManager.findEndpointSection()\n-                                .findOnly(segment.getServiceId(), operationName)\n-                                .doInCondition(\n-                                    new PossibleFound.FoundAndObtain() {\n-                                        @Override\n-                                        public Object doProcess(int operationId) {\n-                                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationId, remotePeer);\n-                                        }\n-                                    }, new PossibleFound.NotFoundAndObtain() {\n-                                        @Override\n-                                        public Object doProcess() {\n-                                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationName, remotePeer);\n-                                        }\n-                                    });\n+                            return new ExitSpan(spanIdGenerator++, parentSpanId, operationName, remotePeer);\n                         }\n                     });\n             push(exitSpan);",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/TracingContext.java",
                "sha": "ccb9aae523513298321938ee689015664f9e849b",
                "status": "modified"
            },
            {
                "additions": 19,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/StackBasedTracingSpan.java",
                "changes": 33,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/StackBasedTracingSpan.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 14,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/StackBasedTracingSpan.java",
                "patch": "@@ -89,21 +89,26 @@ protected StackBasedTracingSpan(int spanId, int parentSpanId, String operationNa\n     @Override\n     public boolean finish(TraceSegment owner) {\n         if (--stackDepth == 0) {\n-            if (this.operationId == DictionaryUtil.nullValue()) {\n-                this.operationId = (Integer)DictionaryManager.findEndpointSection()\n-                    .findOrPrepare4Register(owner.getServiceId(), operationName, this.isEntry(), this.isExit())\n-                    .doInCondition(\n-                        new PossibleFound.FoundAndObtain() {\n-                            @Override public Object doProcess(int value) {\n-                                return value;\n+            /**\n+             * Since 6.6.0, only entry span requires the op name register, which is endpoint.\n+             */\n+            if (this.isEntry()) {\n+                if (this.operationId == DictionaryUtil.nullValue()) {\n+                    this.operationId = (Integer)DictionaryManager.findEndpointSection()\n+                        .findOrPrepare4Register(owner.getServiceId(), operationName)\n+                        .doInCondition(\n+                            new PossibleFound.FoundAndObtain() {\n+                                @Override public Object doProcess(int value) {\n+                                    return value;\n+                                }\n+                            },\n+                            new PossibleFound.NotFoundAndObtain() {\n+                                @Override public Object doProcess() {\n+                                    return DictionaryUtil.nullValue();\n+                                }\n                             }\n-                        },\n-                        new PossibleFound.NotFoundAndObtain() {\n-                            @Override public Object doProcess() {\n-                                return DictionaryUtil.nullValue();\n-                            }\n-                        }\n-                    );\n+                        );\n+                }\n             }\n             return super.finish(owner);\n         } else {",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/context/trace/StackBasedTracingSpan.java",
                "sha": "cdf26a8d7e10c2e6efaba1228904c6cb3f8fc43e",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/DictionaryUtil.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/DictionaryUtil.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/DictionaryUtil.java",
                "patch": "@@ -30,4 +30,11 @@ public static int nullValue() {\n     public static boolean isNull(int id) {\n         return id == nullValue();\n     }\n+\n+    /**\n+     * @return -1 represent the object doesn't exist.\n+     */\n+    public static int inexistence() {\n+        return -1;\n+    }\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/DictionaryUtil.java",
                "sha": "d8ac1d55ec89c26effda301b0de6eaf36462787f",
                "status": "modified"
            },
            {
                "additions": 9,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/EndpointNameDictionary.java",
                "changes": 45,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/EndpointNameDictionary.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 36,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/EndpointNameDictionary.java",
                "patch": "@@ -37,21 +37,20 @@\n     private Map<OperationNameKey, Integer> endpointDictionary = new ConcurrentHashMap<OperationNameKey, Integer>();\n     private Set<OperationNameKey> unRegisterEndpoints = new ConcurrentSet<OperationNameKey>();\n \n-    public PossibleFound findOrPrepare4Register(int serviceId, String endpointName,\n-        boolean isEntry, boolean isExit) {\n-        return find0(serviceId, endpointName, isEntry, isExit, true);\n+    public PossibleFound findOrPrepare4Register(int serviceId, String endpointName) {\n+        return find0(serviceId, endpointName, true);\n     }\n \n     public PossibleFound findOnly(int serviceId, String endpointName) {\n-        return find0(serviceId, endpointName, false, false, false);\n+        return find0(serviceId, endpointName, false);\n     }\n \n     private PossibleFound find0(int serviceId, String endpointName,\n-        boolean isEntry, boolean isExit, boolean registerWhenNotFound) {\n+        boolean registerWhenNotFound) {\n         if (endpointName == null || endpointName.length() == 0) {\n             return new NotFound();\n         }\n-        OperationNameKey key = new OperationNameKey(serviceId, endpointName, isEntry, isExit);\n+        OperationNameKey key = new OperationNameKey(serviceId, endpointName);\n         Integer operationId = endpointDictionary.get(key);\n         if (operationId != null) {\n             return new Found(operationId);\n@@ -72,7 +71,7 @@ public void syncRemoteDictionary(\n                 Endpoint endpoint = Endpoint.newBuilder()\n                     .setServiceId(operationNameKey.getServiceId())\n                     .setEndpointName(operationNameKey.getEndpointName())\n-                    .setFrom(operationNameKey.getSpanType())\n+                    .setFrom(DetectPoint.server)\n                     .build();\n                 builder.addEndpoints(endpoint);\n             }\n@@ -81,9 +80,7 @@ public void syncRemoteDictionary(\n                 for (EndpointMappingElement element : serviceNameMappingCollection.getElementsList()) {\n                     OperationNameKey key = new OperationNameKey(\n                         element.getServiceId(),\n-                        element.getEndpointName(),\n-                        DetectPoint.server.equals(element.getFrom()),\n-                        DetectPoint.client.equals(element.getFrom()));\n+                        element.getEndpointName());\n                     unRegisterEndpoints.remove(key);\n                     endpointDictionary.put(key, element.getEndpointId());\n                 }\n@@ -98,14 +95,10 @@ public void clear() {\n     private class OperationNameKey {\n         private int serviceId;\n         private String endpointName;\n-        private boolean isEntry;\n-        private boolean isExit;\n \n-        public OperationNameKey(int serviceId, String endpointName, boolean isEntry, boolean isExit) {\n+        public OperationNameKey(int serviceId, String endpointName) {\n             this.serviceId = serviceId;\n             this.endpointName = endpointName;\n-            this.isEntry = isEntry;\n-            this.isExit = isExit;\n         }\n \n         public int getServiceId() {\n@@ -128,8 +121,7 @@ public String getEndpointName() {\n             if (serviceId == key.serviceId && endpointName.equals(key.endpointName)) {\n                 isServiceEndpointMatch = true;\n             }\n-            return isServiceEndpointMatch && isEntry == key.isEntry\n-                && isExit == key.isExit;\n+            return isServiceEndpointMatch;\n         }\n \n         @Override public int hashCode() {\n@@ -138,30 +130,11 @@ public String getEndpointName() {\n             return result;\n         }\n \n-        boolean isEntry() {\n-            return isEntry;\n-        }\n-\n-        boolean isExit() {\n-            return isExit;\n-        }\n-\n-        DetectPoint getSpanType() {\n-            if (isEntry) {\n-                return DetectPoint.server;\n-            } else if (isExit) {\n-                return DetectPoint.client;\n-            } else {\n-                return DetectPoint.UNRECOGNIZED;\n-            }\n-        }\n \n         @Override public String toString() {\n             return \"OperationNameKey{\" +\n                 \"serviceId=\" + serviceId +\n                 \", endpointName='\" + endpointName + '\\'' +\n-                \", isEntry=\" + isEntry +\n-                \", isExit=\" + isExit +\n                 '}';\n         }\n     }",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/dictionary/EndpointNameDictionary.java",
                "sha": "3447d8a18e1aaa0e970e72436b6ba121c521689b",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/async/RestExecuteInterceptor.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/async/RestExecuteInterceptor.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 10,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/async/RestExecuteInterceptor.java",
                "patch": "@@ -20,12 +20,9 @@\n \n import java.lang.reflect.Method;\n import java.net.URI;\n-import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n-import org.apache.skywalking.apm.agent.core.conf.Config;\n import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.context.ContextSnapshot;\n-import org.apache.skywalking.apm.agent.core.context.OperationNameFormatService;\n import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n@@ -37,22 +34,16 @@\n import org.springframework.http.HttpMethod;\n \n public class RestExecuteInterceptor implements InstanceMethodsAroundInterceptor {\n-    private OperationNameFormatService nameFormatService;\n-\n     @Override\n     public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         MethodInterceptResult result) throws Throwable {\n         final URI requestURL = (URI)allArguments[0];\n         final HttpMethod httpMethod = (HttpMethod)allArguments[1];\n         final ContextCarrier contextCarrier = new ContextCarrier();\n \n-        if (nameFormatService == null) {\n-            nameFormatService = ServiceManager.INSTANCE.findService(OperationNameFormatService.class);\n-        }\n-\n         String remotePeer = requestURL.getHost() + \":\" + (requestURL.getPort() > 0 ? requestURL.getPort() : \"https\".equalsIgnoreCase(requestURL.getScheme()) ? 443 : 80);\n \n-        String formatURIPath = nameFormatService.formatOperationName(Config.Plugin.OPGroup.RestTemplate.class, requestURL.getPath());\n+        String formatURIPath = requestURL.getPath();\n         AbstractSpan span = ContextManager.createExitSpan(\n             formatURIPath,\n             contextCarrier, remotePeer);",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/async/RestExecuteInterceptor.java",
                "sha": "48bbf2aff67d72e57a6980cfe22883a2428ca8d4",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/sync/RestExecuteInterceptor.java",
                "changes": 15,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/sync/RestExecuteInterceptor.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 12,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/sync/RestExecuteInterceptor.java",
                "patch": "@@ -20,36 +20,27 @@\n \n import java.lang.reflect.Method;\n import java.net.URI;\n-import org.apache.skywalking.apm.agent.core.boot.ServiceManager;\n-import org.apache.skywalking.apm.agent.core.conf.Config;\n import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n-import org.apache.skywalking.apm.agent.core.context.OperationNameFormatService;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.agent.core.context.ContextManager;\n-import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n import org.springframework.http.HttpMethod;\n \n public class RestExecuteInterceptor implements InstanceMethodsAroundInterceptor {\n-    private OperationNameFormatService nameFormatService;\n-\n     @Override\n     public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         MethodInterceptResult result) throws Throwable {\n         final URI requestURL = (URI)allArguments[0];\n         final HttpMethod httpMethod = (HttpMethod)allArguments[1];\n         final ContextCarrier contextCarrier = new ContextCarrier();\n \n-        if (nameFormatService == null) {\n-            nameFormatService = ServiceManager.INSTANCE.findService(OperationNameFormatService.class);\n-        }\n-\n         String remotePeer = requestURL.getHost() + \":\" + (requestURL.getPort() > 0 ? requestURL.getPort() : \"https\".equalsIgnoreCase(requestURL.getScheme()) ? 443 : 80);\n-        String formatURIPath = nameFormatService.formatOperationName(Config.Plugin.OPGroup.RestTemplate.class, requestURL.getPath());\n+        String formatURIPath = requestURL.getPath();\n         AbstractSpan span = ContextManager.createExitSpan(formatURIPath, contextCarrier, remotePeer);\n \n         span.setComponent(ComponentsDefine.SPRING_REST_TEMPLATE);",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/apm-sniffer/apm-sdk-plugin/spring-plugins/resttemplate-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/resttemplate/sync/RestExecuteInterceptor.java",
                "sha": "66b0e779da2ae8258ac8c961e543caa6abb373da",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/FAQ/README.md",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/FAQ/README.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "docs/en/FAQ/README.md",
                "patch": "@@ -18,3 +18,4 @@ These are known and common FAQs. We welcome you to contribute yours.\n * [IllegalStateException when install Java agent on WebSphere 7](install_agent_on_websphere.md)\n * [\"FORBIDDEN/12/index read-only / allow delete (api)\" appears in the log](https://discuss.elastic.co/t/forbidden-12-index-read-only-allow-delete-api/110282)\n * [No data shown and backend replies with \"Variable 'serviceId' has coerced Null value for NonNull type 'ID!'\"](time-and-timezone.md)\n+* [**Unexpected endpoint register** warning after 6.6.0](Unexpected-endpoint-register.md)",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/FAQ/README.md",
                "sha": "3e0e79fcd7a23e317e660ef8c4cd49356551f13d",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/FAQ/Unexpected-endpoint-register.md",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/FAQ/Unexpected-endpoint-register.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "docs/en/FAQ/Unexpected-endpoint-register.md",
                "patch": "@@ -0,0 +1,12 @@\n+# Local span and Exit span should not be register\n+\n+Since 6.6.0, SkyWalking cancelled the local span and exit span register. If old java agent(before 6.6.0) is still running,\n+and do register to 6.6.0+ backend, you will face the following warning message.\n+```\n+class=RegisterServiceHandler, message = Unexpected endpoint register, endpoint isn't detected from server side.\n+```\n+\n+This will not harm the backend or cause any issue. This is a reminder that, your agent or other client should follow the new protocol\n+requirements.\n+\n+You could simply use `log4j2.xml` to filter this warning message out.\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/FAQ/Unexpected-endpoint-register.md",
                "sha": "dd732daef683ab881c1c14328e018781efaf9848",
                "status": "added"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/guides/Plugin-test.md",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/guides/Plugin-test.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "docs/en/guides/Plugin-test.md",
                "patch": "@@ -230,7 +230,7 @@ registryItems:\n | --- | ---\n | applications | The registered service codes. Normally, not 0 should be enough.\n | instances | The number of service instances exists in this test case.\n-| operationNames | All endpoint registered in this test case. Also means, the operation names of all entry and exit spans.\n+| operationNames | All endpoint registered in this test case. Also means, the operation names of all entry spans.\n \n \n **Segment verify description format**",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/guides/Plugin-test.md",
                "sha": "207e41a18cc194d9b0fb692788e6a7ff2eb5af35",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/protocols/Skywalking-Cross-Process-Propagation-Headers-Protocol-v2.md",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/protocols/Skywalking-Cross-Process-Propagation-Headers-Protocol-v2.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "docs/en/protocols/Skywalking-Cross-Process-Propagation-Headers-Protocol-v2.md",
                "patch": "@@ -38,6 +38,8 @@ _This value can use exchange/compress collector service to get the id(integer) t\n 1. Parent endpoint of the parent service. **String(BASE64 encoded)**. \n _This value can use exchange/compress collector service to get the id(integer) to represent the string. If you use the string, it must start with `#`, others use integer directly._\n \n+endpoint id = -1 and parent endpoint name is empty mean there is no real parent endpoint. Since 6.6.0\n+\n ## Sample values\n 1. Short version, `1-TRACEID-SEGMENTID-3-5-2-IPPORT`\n 1. Complete version, `1-TRACEID-SEGMENTID-3-5-2-IPPORT-ENTRYURI-PARENTURI`",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/protocols/Skywalking-Cross-Process-Propagation-Headers-Protocol-v2.md",
                "sha": "fa4b4a73b0f257d38f32085d334a1a5106caa8bc",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/setup/service-agent/java-agent/README.md",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/README.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "docs/en/setup/service-agent/java-agent/README.md",
                "patch": "@@ -158,6 +158,9 @@ Now, we have the following known bootstrap plugins.\n SkyWalking java agent supports plugin to extend [the supported list](Supported-list.md). Please follow \n our [Plugin Development Guide](../../../guides/Java-Plugin-Development-Guide.md).\n \n+If some RPC framework endpoints(server side) could include parameter, please read [Operation Name Group Rule](op_name_group_rule.md),\n+and consider to add this feature.\n+\n # Test\n If you are interested in plugin compatible tests or agent performance, see the following reports.\n * [Plugin Test](https://github.com/SkyAPMTest/agent-integration-test-report)",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/setup/service-agent/java-agent/README.md",
                "sha": "787d90ea3f99190f25948203e9d40c766e43fc16",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/docs/en/setup/service-agent/java-agent/op_name_group_rule.md",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/op_name_group_rule.md?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "docs/en/setup/service-agent/java-agent/op_name_group_rule.md",
                "patch": "@@ -4,8 +4,7 @@ Those operation name are also as known endpoint name in most cases.\n Such as /api/checkTicket/tk/{userToken}.\n \n We solved most of these cases, by leverage the parameter pattern path in framework, such as SpringMVC, Webflux, etc. \n-But it is undetected in RPC client side, such as HTTP restful client.\n-In this case, we have to ask the users to set the group rule manually.\n+In this case, it is undetected in this way, so we have to ask the users to set the group rule manually.\n \n All rules are supported to set through agent.config, system properties and system env, like other agent settings.\n - Config format, `plugin.opgroup.`plugin name`.rule[`rule name`]`=pattern regex expression",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/docs/en/setup/service-agent/java-agent/op_name_group_rule.md",
                "sha": "6deaca2c0d4352466e2e7adfa41ffb62c492bd30",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/Const.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/Const.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 0,
                "filename": "oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/Const.java",
                "patch": "@@ -32,6 +32,7 @@\n     public static final int USER_SERVICE_ID = 1;\n     public static final int USER_INSTANCE_ID = 1;\n     public static final int USER_ENDPOINT_ID = 1;\n+    public static final int INEXISTENCE_ENDPOINT_ID = -1;\n     public static final String USER_CODE = \"User\";\n     public static final String SEGMENT_SPAN_SPLIT = \"S\";\n     public static final String UNKNOWN = \"Unknown\";",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-core/src/main/java/org/apache/skywalking/oap/server/core/Const.java",
                "sha": "f7e7bf3c386773b3c8ae63947a6226071d44e6c4",
                "status": "modified"
            },
            {
                "additions": 13,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-register-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/register/provider/handler/v6/grpc/RegisterServiceHandler.java",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-register-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/register/provider/handler/v6/grpc/RegisterServiceHandler.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 8,
                "filename": "oap-server/server-receiver-plugin/skywalking-register-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/register/provider/handler/v6/grpc/RegisterServiceHandler.java",
                "patch": "@@ -163,14 +163,19 @@ public RegisterServiceHandler(ModuleManager moduleManager) {\n             int serviceId = endpoint.getServiceId();\n             String endpointName = endpoint.getEndpointName();\n \n-            int endpointId = inventoryService.getOrCreate(serviceId, endpointName, DetectPoint.fromNetworkProtocolDetectPoint(endpoint.getFrom()));\n-\n-            if (endpointId != Const.NONE) {\n-                builder.addElements(EndpointMappingElement.newBuilder()\n-                    .setServiceId(serviceId)\n-                    .setEndpointName(endpointName)\n-                    .setEndpointId(endpointId)\n-                    .setFrom(endpoint.getFrom()));\n+            DetectPoint detectPoint = DetectPoint.fromNetworkProtocolDetectPoint(endpoint.getFrom());\n+            if (DetectPoint.SERVER.equals(detectPoint)) {\n+                int endpointId = inventoryService.getOrCreate(serviceId, endpointName, detectPoint);\n+\n+                if (endpointId != Const.NONE) {\n+                    builder.addElements(EndpointMappingElement.newBuilder()\n+                        .setServiceId(serviceId)\n+                        .setEndpointName(endpointName)\n+                        .setEndpointId(endpointId)\n+                        .setFrom(endpoint.getFrom()));\n+                }\n+            } else {\n+                logger.warn(\"Unexpected endpoint register, endpoint isn't detected from server side. {}\", request);\n             }\n         });\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-register-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/register/provider/handler/v6/grpc/RegisterServiceHandler.java",
                "sha": "3e9a60535e94cb8bbf8173c1637ec98a01217e72",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParse.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParse.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParse.java",
                "patch": "@@ -141,7 +141,7 @@ private boolean preBuild(List<UniqueId> traceIds, SegmentDecorator segmentDecora\n         for (int i = 0; i < segmentDecorator.getSpansCount(); i++) {\n             SpanDecorator spanDecorator = segmentDecorator.getSpans(i);\n \n-            if (!SpanIdExchanger.getInstance(moduleManager).exchange(spanDecorator, segmentCoreInfo.getServiceId())) {\n+            if (!SpanExchanger.getInstance(moduleManager).exchange(spanDecorator, segmentCoreInfo.getServiceId())) {\n                 exchanged = false;\n             } else {\n                 for (int j = 0; j < spanDecorator.getRefsCount(); j++) {",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParse.java",
                "sha": "1b527bcaba5cf0c2a2d05a8b5abc3ced0d93b443",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParseV2.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParseV2.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParseV2.java",
                "patch": "@@ -158,7 +158,7 @@ private boolean preBuild(List<UniqueId> traceIds, SegmentDecorator segmentDecora\n         for (int i = 0; i < segmentDecorator.getSpansCount(); i++) {\n             SpanDecorator spanDecorator = segmentDecorator.getSpans(i);\n \n-            if (!SpanIdExchanger.getInstance(moduleManager).exchange(spanDecorator, segmentCoreInfo.getServiceId())) {\n+            if (!SpanExchanger.getInstance(moduleManager).exchange(spanDecorator, segmentCoreInfo.getServiceId())) {\n                 exchanged = false;\n             } else {\n                 for (int j = 0; j < spanDecorator.getRefsCount(); j++) {",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/SegmentParseV2.java",
                "sha": "583301bbe15be198ef80dd2d31d3ae9c2d1d3bad",
                "status": "modified"
            },
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/endpoint/MultiScopesSpanListener.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/endpoint/MultiScopesSpanListener.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 5,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/endpoint/MultiScopesSpanListener.java",
                "patch": "@@ -106,7 +106,11 @@ public void parseEntry(SpanDecorator spanDecorator, SegmentCoreInfo segmentCoreI\n             for (int i = 0; i < spanDecorator.getRefsCount(); i++) {\n                 ReferenceDecorator reference = spanDecorator.getRefs(i);\n                 SourceBuilder sourceBuilder = new SourceBuilder();\n-                sourceBuilder.setSourceEndpointId(reference.getParentEndpointId());\n+                if (reference.getParentEndpointId() == Const.INEXISTENCE_ENDPOINT_ID) {\n+                    sourceBuilder.setSourceEndpointId(Const.USER_ENDPOINT_ID);\n+                } else {\n+                    sourceBuilder.setSourceEndpointId(reference.getParentEndpointId());\n+                }\n \n                 final int networkAddressId = reference.getNetworkAddressId();\n                 final int serviceIdByPeerId = serviceInventoryCache.getServiceId(networkAddressId);\n@@ -161,10 +165,8 @@ public void parseEntry(SpanDecorator spanDecorator, SegmentCoreInfo segmentCoreI\n         int destInstanceId = instanceInventoryCache.getServiceInstanceId(destServiceId, peerId);\n         int mappingServiceInstanceId = instanceInventoryCache.get(destInstanceId).getMappingServiceInstanceId();\n \n-        sourceBuilder.setSourceEndpointId(Const.USER_ENDPOINT_ID);\n         sourceBuilder.setSourceServiceInstanceId(segmentCoreInfo.getServiceInstanceId());\n         sourceBuilder.setSourceServiceId(segmentCoreInfo.getServiceId());\n-        sourceBuilder.setDestEndpointId(spanDecorator.getOperationNameId());\n         if (Const.NONE == mappingServiceId) {\n             sourceBuilder.setDestServiceId(destServiceId);\n         } else {\n@@ -235,10 +237,14 @@ private void setPublicAttrs(SourceBuilder sourceBuilder, SpanDecorator spanDecor\n \n         sourceBuilder.setSourceServiceName(serviceInventoryCache.get(sourceBuilder.getSourceServiceId()).getName());\n         sourceBuilder.setSourceServiceInstanceName(instanceInventoryCache.get(sourceBuilder.getSourceServiceInstanceId()).getName());\n-        sourceBuilder.setSourceEndpointName(endpointInventoryCache.get(sourceBuilder.getSourceEndpointId()).getName());\n+        if (sourceBuilder.getSourceEndpointId() != Const.NONE) {\n+            sourceBuilder.setSourceEndpointName(endpointInventoryCache.get(sourceBuilder.getSourceEndpointId()).getName());\n+        }\n         sourceBuilder.setDestServiceName(serviceInventoryCache.get(sourceBuilder.getDestServiceId()).getName());\n         sourceBuilder.setDestServiceInstanceName(instanceInventoryCache.get(sourceBuilder.getDestServiceInstanceId()).getName());\n-        sourceBuilder.setDestEndpointName(endpointInventoryCache.get(sourceBuilder.getDestEndpointId()).getName());\n+        if (sourceBuilder.getDestEndpointId() != Const.NONE) {\n+            sourceBuilder.setDestEndpointName(endpointInventoryCache.get(sourceBuilder.getDestEndpointId()).getName());\n+        }\n     }\n \n     @Override public void build() {\n@@ -255,6 +261,9 @@ private void setPublicAttrs(SourceBuilder sourceBuilder, SpanDecorator spanDecor\n              * Parent endpoint could be none, because in SkyWalking Cross Process Propagation Headers Protocol v2,\n              * endpoint in ref could be empty, based on that, endpoint relation maybe can't be established.\n              * So, I am making this source as optional.\n+             *\n+             * Also, since 6.6.0, source endpoint could be none, if this trace begins by an internal task(local span or exit span), such as Timer,\n+             * rather than, normally begin as an entry span, like a RPC server side.\n              */\n             if (endpointRelation != null) {\n                 sourceReceiver.receive(endpointRelation);",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/endpoint/MultiScopesSpanListener.java",
                "sha": "705c782fc49fe5528e07fe91707395a2e901182f",
                "status": "modified"
            },
            {
                "additions": 16,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/segment/SegmentSpanListener.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/segment/SegmentSpanListener.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/segment/SegmentSpanListener.java",
                "patch": "@@ -19,6 +19,7 @@\n package org.apache.skywalking.oap.server.receiver.trace.provider.parser.listener.segment;\n \n import org.apache.skywalking.apm.network.language.agent.UniqueId;\n+import org.apache.skywalking.oap.server.core.Const;\n import org.apache.skywalking.oap.server.core.CoreModule;\n import org.apache.skywalking.oap.server.core.cache.EndpointInventoryCache;\n import org.apache.skywalking.oap.server.core.source.Segment;\n@@ -51,6 +52,7 @@\n     private SAMPLE_STATUS sampleStatus = SAMPLE_STATUS.UNKNOWN;\n     private int entryEndpointId = 0;\n     private int firstEndpointId = 0;\n+    private String firstEndpointName = \"\";\n \n     private SegmentSpanListener(ModuleManager moduleManager, TraceSegmentSampler sampler) {\n         this.sampler = sampler;\n@@ -85,6 +87,7 @@ public void parseFirst(SpanDecorator spanDecorator, SegmentCoreInfo segmentCoreI\n         segment.setVersion(segmentCoreInfo.isV2() ? 2 : 1);\n \n         firstEndpointId = spanDecorator.getOperationNameId();\n+        firstEndpointName = spanDecorator.getOperationName();\n     }\n \n     @Override public void parseEntry(SpanDecorator spanDecorator, SegmentCoreInfo segmentCoreInfo) {\n@@ -124,9 +127,19 @@ public void parseFirst(SpanDecorator spanDecorator, SegmentCoreInfo segmentCoreI\n             return;\n         }\n \n-        if (entryEndpointId == 0) {\n-            segment.setEndpointId(firstEndpointId);\n-            segment.setEndpointName(serviceNameCacheService.get(firstEndpointId).getName());\n+        if (entryEndpointId == Const.NONE) {\n+            if (firstEndpointId != Const.NONE) {\n+                /**\n+                 * Since 6.6.0, only entry span is treated as an endpoint. Other span's endpoint id == 0.\n+                 */\n+                segment.setEndpointId(firstEndpointId);\n+                segment.setEndpointName(serviceNameCacheService.get(firstEndpointId).getName());\n+            } else {\n+                /**\n+                 * Only fill first operation name for the trace list query, as no endpoint id.\n+                 */\n+                segment.setEndpointName(firstEndpointName);\n+            }\n         } else {\n             segment.setEndpointId(entryEndpointId);\n             segment.setEndpointName(serviceNameCacheService.get(entryEndpointId).getName());",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/listener/segment/SegmentSpanListener.java",
                "sha": "492b1d6de9ff9551e9200a7fe50d09d97a675892",
                "status": "modified"
            },
            {
                "additions": 15,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/ReferenceIdExchanger.java",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/ReferenceIdExchanger.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 5,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/ReferenceIdExchanger.java",
                "patch": "@@ -70,6 +70,10 @@ private ReferenceIdExchanger(ModuleManager moduleManager) {\n                 standardBuilder.setEntryEndpointId(entryEndpointId);\n                 standardBuilder.setEntryEndpointName(Const.EMPTY_STRING);\n             }\n+        } else {\n+            /**\n+             * Since 6.6.0, endpoint id could be -1, as it is not an endpoint. Such as local span and exist span.\n+             */\n         }\n \n         if (standardBuilder.getParentEndpointId() == 0) {\n@@ -88,6 +92,10 @@ private ReferenceIdExchanger(ModuleManager moduleManager) {\n                 standardBuilder.setParentEndpointId(parentEndpointId);\n                 standardBuilder.setParentEndpointName(Const.EMPTY_STRING);\n             }\n+        } else {\n+            /**\n+             * Since 6.6.0, endpoint id could be -1, as it is not an endpoint. Such as local span and exist span.\n+             */\n         }\n \n         if (standardBuilder.getNetworkAddressId() == 0 && !Strings.isNullOrEmpty(standardBuilder.getNetworkAddress())) {\n@@ -104,16 +112,18 @@ private ReferenceIdExchanger(ModuleManager moduleManager) {\n                 standardBuilder.setNetworkAddressId(networkAddressId);\n                 standardBuilder.setNetworkAddress(Const.EMPTY_STRING);\n             }\n+        } else {\n+            /**\n+             * Since 6.6.0, endpoint id could be -1, as it is not an endpoint. Such as local span and exist span.\n+             */\n         }\n         return exchanged;\n     }\n \n     /**\n-     * Endpoint in ref could be local or exit span's operation name.\n-     * Especially if it is local span operation name,\n-     * exchange may not happen at agent, such as Java agent,\n-     * then put literal endpoint string in the header,\n-     * Need to try to get the id by assuming the endpoint name is detected at server, local or client.\n+     * Endpoint in ref could be local or exit span's operation name. Especially if it is local span operation name,\n+     * exchange may not happen at agent, such as Java agent, then put literal endpoint string in the header, Need to try\n+     * to get the id by assuming the endpoint name is detected at server, local or client.\n      *\n      * If agent does the exchange, then always use endpoint id.\n      */",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/ReferenceIdExchanger.java",
                "sha": "0fcff21bf4ab650da27fb52e14584be7d84fe2c0",
                "status": "modified"
            },
            {
                "additions": 25,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/SpanExchanger.java",
                "changes": 43,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/SpanExchanger.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 18,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/SpanExchanger.java",
                "patch": "@@ -22,6 +22,7 @@\n import com.google.gson.JsonObject;\n import org.apache.skywalking.apm.network.common.KeyStringValuePair;\n import org.apache.skywalking.apm.network.language.agent.SpanLayer;\n+import org.apache.skywalking.apm.network.language.agent.SpanType;\n import org.apache.skywalking.oap.server.core.Const;\n import org.apache.skywalking.oap.server.core.CoreModule;\n import org.apache.skywalking.oap.server.core.cache.ServiceInstanceInventoryCache;\n@@ -45,11 +46,11 @@\n /**\n  * @author peng-yongsheng\n  */\n-public class SpanIdExchanger implements IdExchanger<SpanDecorator> {\n+public class SpanExchanger implements IdExchanger<SpanDecorator> {\n \n-    private static final Logger logger = LoggerFactory.getLogger(SpanIdExchanger.class);\n+    private static final Logger logger = LoggerFactory.getLogger(SpanExchanger.class);\n \n-    private static SpanIdExchanger EXCHANGER;\n+    private static SpanExchanger EXCHANGER;\n     private final ServiceInventoryCache serviceInventoryCacheDAO;\n     private final IServiceInventoryRegister serviceInventoryRegister;\n     private final ServiceInstanceInventoryCache serviceInstanceInventoryCacheDAO;\n@@ -58,14 +59,14 @@\n     private final INetworkAddressInventoryRegister networkAddressInventoryRegister;\n     private final IComponentLibraryCatalogService componentLibraryCatalogService;\n \n-    public static SpanIdExchanger getInstance(ModuleManager moduleManager) {\n+    public static SpanExchanger getInstance(ModuleManager moduleManager) {\n         if (EXCHANGER == null) {\n-            EXCHANGER = new SpanIdExchanger(moduleManager);\n+            EXCHANGER = new SpanExchanger(moduleManager);\n         }\n         return EXCHANGER;\n     }\n \n-    private SpanIdExchanger(ModuleManager moduleManager) {\n+    private SpanExchanger(ModuleManager moduleManager) {\n         this.serviceInventoryCacheDAO = moduleManager.find(CoreModule.NAME).provider().getService(ServiceInventoryCache.class);\n         this.serviceInventoryRegister = moduleManager.find(CoreModule.NAME).provider().getService(IServiceInventoryRegister.class);\n         this.serviceInstanceInventoryCacheDAO = moduleManager.find(CoreModule.NAME).provider().getService(ServiceInstanceInventoryCache.class);\n@@ -135,19 +136,25 @@ private SpanIdExchanger(ModuleManager moduleManager) {\n         }\n \n         if (standardBuilder.getOperationNameId() == Const.NONE) {\n-            String endpointName = Strings.isNullOrEmpty(standardBuilder.getOperationName()) ? Const.DOMAIN_OPERATION_NAME : standardBuilder.getOperationName();\n-            int endpointId = endpointInventoryRegister.getOrCreate(serviceId, endpointName, DetectPoint.fromSpanType(standardBuilder.getSpanType()));\n-\n-            if (endpointId == 0) {\n-                if (logger.isDebugEnabled()) {\n-                    logger.debug(\"endpoint name: {} from service id: {} exchange failed\", endpointName, serviceId);\n+            /**\n+             * Only operation name of entry span is being treated as an endpoint,\n+             * so, since 6.6.0, only it triggers register.\n+             */\n+            if (SpanType.Entry.equals(standardBuilder.getSpanType())) {\n+                String endpointName = Strings.isNullOrEmpty(standardBuilder.getOperationName()) ? Const.DOMAIN_OPERATION_NAME : standardBuilder.getOperationName();\n+                int endpointId = endpointInventoryRegister.getOrCreate(serviceId, endpointName, DetectPoint.fromSpanType(standardBuilder.getSpanType()));\n+\n+                if (endpointId == 0) {\n+                    if (logger.isDebugEnabled()) {\n+                        logger.debug(\"endpoint name: {} from service id: {} exchange failed\", endpointName, serviceId);\n+                    }\n+\n+                    exchanged = false;\n+                } else {\n+                    standardBuilder.toBuilder();\n+                    standardBuilder.setOperationNameId(endpointId);\n+                    standardBuilder.setOperationName(Const.EMPTY_STRING);\n                 }\n-\n-                exchanged = false;\n-            } else {\n-                standardBuilder.toBuilder();\n-                standardBuilder.setOperationNameId(endpointId);\n-                standardBuilder.setOperationName(Const.EMPTY_STRING);\n             }\n         }\n         return exchanged;",
                "previous_filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/SpanIdExchanger.java",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/main/java/org/apache/skywalking/oap/server/receiver/trace/provider/parser/standardization/SpanExchanger.java",
                "sha": "b3518834e7a4068cb39eeb7471185d27853e1116",
                "status": "renamed"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceAMock.java",
                "changes": 9,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceAMock.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 7,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceAMock.java",
                "patch": "@@ -90,11 +90,7 @@ private ByteString createSegment(long startTimestamp, UniqueId.Builder segmentId\n         span.setParentSpanId(0);\n         span.setStartTime(startTimestamp + 100);\n         span.setEndTime(startTimestamp + 500);\n-        if (isPrepare) {\n-            span.setOperationName(\"org.apache.skywalking.Local.do\");\n-        } else {\n-            span.setOperationNameId(3);\n-        }\n+        span.setOperationName(\"org.apache.skywalking.Local.do\");\n         span.setIsError(false);\n         return span;\n     }\n@@ -108,12 +104,11 @@ private ByteString createSegment(long startTimestamp, UniqueId.Builder segmentId\n         span.setStartTime(startTimestamp + 120);\n         span.setEndTime(startTimestamp + 5800);\n         span.setComponentId(ComponentsDefine.DUBBO.getId());\n+        span.setOperationName(DUBBO_ENDPOINT);\n         if (isPrepare) {\n             span.setPeer(DUBBO_ADDRESS);\n-            span.setOperationName(DUBBO_ENDPOINT);\n         } else {\n             span.setPeerId(2);\n-            span.setOperationNameId(6);\n         }\n         span.setIsError(false);\n         return span;",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceAMock.java",
                "sha": "dd6d25ada7e2c18ba241a74002288742cbd4d246",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceBMock.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceBMock.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceBMock.java",
                "patch": "@@ -119,11 +119,10 @@ private ByteString createSegment(long startTimestamp, UniqueId.Builder segmentId\n         span.addTags(KeyWithStringValue.newBuilder().setKey(\"db.statement\").setValue(\"select * from database where complex = 1;\").build());\n         span.addTags(KeyWithStringValue.newBuilder().setKey(\"db.type\").setValue(\"mongodb\").build());\n \n+        span.setOperationName(\"mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]\");\n         if (isPrepare) {\n-            span.setOperationName(\"mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]\");\n             span.setPeer(\"localhost:27017\");\n         } else {\n-            span.setOperationNameId(7);\n             span.setPeerId(3);\n         }\n         return span;\n@@ -140,11 +139,10 @@ private ByteString createSegment(long startTimestamp, UniqueId.Builder segmentId\n         span.setComponentId(ComponentsDefine.ROCKET_MQ_PRODUCER.getId());\n         span.setIsError(false);\n \n+        span.setOperationName(ROCKET_MQ_ENDPOINT);\n         if (isPrepare) {\n-            span.setOperationName(ROCKET_MQ_ENDPOINT);\n             span.setPeer(ROCKET_MQ_ADDRESS);\n         } else {\n-            span.setOperationNameId(8);\n             span.setPeerId(4);\n         }\n         return span;",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/oap-server/server-receiver-plugin/skywalking-trace-receiver-plugin/src/test/java/org/apache/skywalking/oap/server/receiver/trace/mock/ServiceBMock.java",
                "sha": "73893ee1e0202943a2803f0467e2732d1b7bedb4",
                "status": "modified"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/apm-toolkit-trace-scenario/config/expectedData.yaml",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/apm-toolkit-trace-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 6,
                "filename": "test/plugin/scenarios/apm-toolkit-trace-scenario/config/expectedData.yaml",
                "patch": "@@ -20,9 +20,8 @@ registryItems:\n   instances:\n     - {apm-toolkit-trace-scenario: 1}\n   operationNames:\n-    - apm-toolkit-trace-scenario: [/apm-toolkit-trace-scenario/case/asyncVisit/runnable,\n-                                   /case/asyncVisit/runnable, /case/asyncVisit/callable, /apm-toolkit-trace-scenario/case/asyncVisit/callable,\n-                                   /case/tool-kit,/apm-toolkit-trace-scenario/case/asyncVisit/supplier,/case/asyncVisit/supplier]\n+    - apm-toolkit-trace-scenario: [/case/asyncVisit/runnable, /case/asyncVisit/callable,\n+                                   /case/tool-kit, /case/asyncVisit/supplier]\n   heartbeat: []\n segmentItems:\n   - applicationCode: apm-toolkit-trace-scenario\n@@ -163,7 +162,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/apm-toolkit-trace-scenario/case/asyncVisit/callable'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: Thread/org.apache.skywalking.apm.toolkit.trace.CallableWrapper/call,\n+              - {parentEndpointId: -1, parentEndpoint: '',\n                  networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 1,\n                  parentTraceSegmentId: not null, parentServiceInstanceId: 1,\n                  networkAddress: 'localhost:8080', entryEndpoint: /case/tool-kit, entryServiceInstanceId: 1}\n@@ -258,7 +257,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/apm-toolkit-trace-scenario/case/asyncVisit/runnable'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: Thread/org.apache.skywalking.apm.toolkit.trace.RunnableWrapper/run,\n+              - {parentEndpointId: -1, parentEndpoint: '',\n                  networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 1,\n                  parentTraceSegmentId: not null, parentServiceInstanceId: 1,\n                  networkAddress: 'localhost:8080', entryEndpoint: /case/tool-kit, entryServiceInstanceId: 1}\n@@ -317,7 +316,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/apm-toolkit-trace-scenario/case/asyncVisit/supplier'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: Thread/org.apache.skywalking.apm.toolkit.trace.SupplierWrapper/get,\n+              - {parentEndpointId: -1, parentEndpoint: '',\n                  networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 1,\n                  parentTraceSegmentId: not null, parentServiceInstanceId: 1,\n                  networkAddress: 'localhost:8080', entryEndpoint: /case/tool-kit, entryServiceInstanceId: 1}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/apm-toolkit-trace-scenario/config/expectedData.yaml",
                "sha": "788aa918f45bc6e2cbcc466aec802fe21622a677",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/canal-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/canal-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/canal-scenario/config/expectedData.yaml",
                "patch": "@@ -19,7 +19,7 @@ registryItems:\n   instances:\n     - {canal-scenario: 1}\n   operationNames:\n-    - canal-scenario: [Canal/example, /canal-scenario/case/canal-case]\n+    - canal-scenario: [/canal-scenario/case/canal-case]\n   heartbeat: []\n segmentItems:\n   - applicationCode: canal-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/canal-scenario/config/expectedData.yaml",
                "sha": "de5e7c29eb87a8feeeb966a7ecb218a04505ee9b",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/cassandra-java-driver-3.x-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/cassandra-java-driver-3.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/cassandra-java-driver-3.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,7 +19,7 @@ registryItems:\n   instances:\n     - {cassandra-java-driver-3.x-scenario: 1}\n   operationNames:\n-    - cassandra-java-driver-3.x-scenario: [Cassandra/execute, Cassandra/executeAsync, /cassandra-java-driver-3.x-scenario/case/cassandra]\n+    - cassandra-java-driver-3.x-scenario: [/cassandra-java-driver-3.x-scenario/case/cassandra]\n   heartbeat: []\n segmentItems:\n   - applicationCode: cassandra-java-driver-3.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/cassandra-java-driver-3.x-scenario/config/expectedData.yaml",
                "sha": "233019790841d4ff1f8640a6e10564d0cf5116f1",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/dubbo-2.5.x-scenario/config/expectedData.yaml",
                "changes": 20,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/dubbo-2.5.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 19,
                "filename": "test/plugin/scenarios/dubbo-2.5.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,30 +19,12 @@ registryItems:\n   instances:\n     - {dubbo-2.5.x-scenario: 1}\n   operationNames:\n-    - dubbo-2.5.x-scenario: [/dubbo-2.5.x-scenario/case/healthCheck, /dubbo-2.5.x-scenario/case/dubbo, org.apache.skywalking.apm.testcase.dubbo.services.GreetService.doBusiness()]\n+    - dubbo-2.5.x-scenario: [/dubbo-2.5.x-scenario/case/dubbo, org.apache.skywalking.apm.testcase.dubbo.services.GreetService.doBusiness()]\n   heartbeat: []\n segmentItems:\n   - applicationCode: dubbo-2.5.x-scenario\n     segmentSize: ge 3\n     segments:\n-      - segmentId: not null\n-        spans:\n-          - operationName: /dubbo-2.5.x-scenario/case/healthCheck\n-            operationId: 0\n-            parentSpanId: -1\n-            spanId: 0\n-            spanLayer: Http\n-            startTime: nq 0\n-            endTime: nq 0\n-            componentId: 1\n-            componentName: ''\n-            isError: false\n-            spanType: Entry\n-            peer: ''\n-            peerId: 0\n-            tags:\n-              - {key: url, value: 'http://localhost:8080/dubbo-2.5.x-scenario/case/healthCheck'}\n-              - {key: http.method, value: HEAD}\n       - segmentId: not null\n         spans:\n           - operationName: org.apache.skywalking.apm.testcase.dubbo.services.GreetService.doBusiness()",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/dubbo-2.5.x-scenario/config/expectedData.yaml",
                "sha": "5fa2275fcb391978e4f405093bbfa58f64dc11d8",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/dubbo-2.7.x-scenario/config/expectedData.yaml",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/dubbo-2.7.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 20,
                "filename": "test/plugin/scenarios/dubbo-2.7.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,32 +19,13 @@ registryItems:\n   instances:\n     - {dubbo-2.7.x-scenario: 1}\n   operationNames:\n-    - dubbo-2.7.x-scenario: [/dubbo-2.7.x-scenario/case/healthCheck,\n-                             /dubbo-2.7.x-scenario/case/dubbo,\n+    - dubbo-2.7.x-scenario: [/dubbo-2.7.x-scenario/case/dubbo,\n                              org.apache.skywalking.apm.testcase.dubbo.services.GreetService.doBusiness()]\n   heartbeat: []\n segmentItems:\n   - applicationCode: dubbo-2.7.x-scenario\n     segmentSize: ge 3\n     segments:\n-      - segmentId: not null\n-        spans:\n-          - operationName: /dubbo-2.7.x-scenario/case/healthCheck\n-            operationId: 0\n-            parentSpanId: -1\n-            spanId: 0\n-            spanLayer: Http\n-            startTime: nq 0\n-            endTime: nq 0\n-            componentId: 1\n-            componentName: ''\n-            isError: false\n-            spanType: Entry\n-            peer: ''\n-            peerId: 0\n-            tags:\n-              - {key: url, value: 'http://localhost:8080/dubbo-2.7.x-scenario/case/healthCheck'}\n-              - {key: http.method, value: HEAD}\n       - segmentId: not null\n         spans:\n           - operationName: org.apache.skywalking.apm.testcase.dubbo.services.GreetService.doBusiness()",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/dubbo-2.7.x-scenario/config/expectedData.yaml",
                "sha": "b48b542ddace97baf79f7d32a6292f7b1dc07926",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/ehcache-2.x-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/ehcache-2.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/ehcache-2.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,7 +19,7 @@ registryItems:\n   instances:\n     - {ehcache-2.x-scenario: 1}\n   operationNames:\n-    - ehcache-2.x-scenario: [/ehcache-2.x-scenario/case/ehcache, /ehcache-2.x-scenario/healthCheck]\n+    - ehcache-2.x-scenario: [/ehcache-2.x-scenario/case/ehcache]\n   heartbeat: []\n segmentItems:\n   - applicationCode: ehcache-2.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/ehcache-2.x-scenario/config/expectedData.yaml",
                "sha": "b2a077a07bc1818f7321a52616e362a9f6970587",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-5.x-scenario/config/expectedData.yaml",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/elasticsearch-5.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "test/plugin/scenarios/elasticsearch-5.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,10 +19,7 @@ registryItems:\n     instances:\n     - {elasticsearch-5.x-scenario: 1}\n     operationNames:\n-    - elasticsearch-5.x-scenario: [Elasticsearch/IndexRequest, Elasticsearch/GetRequest,\n-                                   Elasticsearch/SearchRequest, Elasticsearch/UpdateRequest,\n-                                   Elasticsearch/DeleteRequest, Elasticsearch/DeleteIndexRequest,\n-                                   /case/elasticsearch]\n+    - elasticsearch-5.x-scenario: [/case/elasticsearch]\n     heartbeat: []\n segmentItems:\n - applicationCode: elasticsearch-5.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-5.x-scenario/config/expectedData.yaml",
                "sha": "36058787b1bacc8ee58e21ef5ed5f1f18b4b7f71",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-6.x-scenario/config/expectedData.yaml",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/elasticsearch-6.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "test/plugin/scenarios/elasticsearch-6.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,10 +19,7 @@ registryItems:\n     instances:\n     - {elasticsearch-6.x-scenario: 1}\n     operationNames:\n-    - elasticsearch-6.x-scenario: [Elasticsearch/CreateRequest, Elasticsearch/IndexRequest,\n-                                   Elasticsearch/GetRequest, Elasticsearch/SearchRequest,\n-                                   Elasticsearch/UpdateRequest, Elasticsearch/DeleteRequest,\n-                                   /elasticsearch-case/case/elasticsearch]\n+    - elasticsearch-6.x-scenario: [/elasticsearch-case/case/elasticsearch]\n     heartbeat: []\n segmentItems:\n - applicationCode: elasticsearch-6.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-6.x-scenario/config/expectedData.yaml",
                "sha": "38fb50b1b29378495fb3f1c3fba56dfde1f68675",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-7.x-scenario/config/expectedData.yaml",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/elasticsearch-7.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "test/plugin/scenarios/elasticsearch-7.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,10 +19,7 @@ registryItems:\n   instances:\n   - {elasticsearch-7.x-scenario: 1}\n   operationNames:\n-  - elasticsearch-7.x-scenario: [Elasticsearch/CreateRequest, Elasticsearch/IndexRequest,\n-                                 Elasticsearch/GetRequest, Elasticsearch/SearchRequest,\n-                                 Elasticsearch/UpdateRequest, Elasticsearch/DeleteRequest,\n-                                 /elasticsearch-case/case/elasticsearch]\n+  - elasticsearch-7.x-scenario: [/elasticsearch-case/case/elasticsearch]\n   heartbeat: []\n segmentItems:\n - applicationCode: elasticsearch-7.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/elasticsearch-7.x-scenario/config/expectedData.yaml",
                "sha": "d7454bf4f2d300ce9e24ab61b372ecfe1d30366d",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/hystrix-scenario/config/expectedData.yaml",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/hystrix-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/hystrix-scenario/config/expectedData.yaml",
                "patch": "@@ -47,7 +47,8 @@ segmentItems:\n         - {key: message, value: not null}\n         - {key: stack, value: not null}\n       refs:\n-      - {parentEndpointId: 0, parentEndpoint: /case/hystrix-scenario, networkAddressId: 0, entryEndpointId: 0, refType: CrossThread, parentSpanId: 0, parentTraceSegmentId: '${hystrix-scenario[2]}', parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/hystrix-scenario, entryServiceInstanceId: nq 0 }\n+      - {parentEndpointId: 0, parentEndpoint: /case/hystrix-scenario, networkAddressId: 0, entryEndpointId: 0, refType: CrossThread,\n+         parentSpanId: 0, parentTraceSegmentId: '${hystrix-scenario[2]}', parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/hystrix-scenario, entryServiceInstanceId: nq 0 }\n   - segmentId: not null\n     spans:\n     - operationName: Hystrix/TestACommand/Fallback\n@@ -64,7 +65,8 @@ segmentItems:\n       peer: ''\n       peerId: 0\n       refs:\n-      - {parentEndpointId: 0, parentEndpoint: Hystrix/TestACommand/Execution, networkAddressId: 0, entryEndpointId: 0, refType: CrossThread, parentSpanId: 0, parentTraceSegmentId: '${hystrix-scenario[0]}', parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/hystrix-scenario, entryServiceInstanceId: nq 0}\n+      - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0, entryEndpointId: 0, refType: CrossThread, parentSpanId: 0,\n+         parentTraceSegmentId: '${hystrix-scenario[0]}', parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/hystrix-scenario, entryServiceInstanceId: nq 0}\n   - segmentId: not null\n     spans:\n     - operationName: Hystrix/TestBCommand/Execution",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/hystrix-scenario/config/expectedData.yaml",
                "sha": "e1a1c9e24331b1c29e914aa5269d04baac46ba96",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/jedis-scenario/config/expectedData.yaml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/jedis-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/jedis-scenario/config/expectedData.yaml",
                "patch": "@@ -20,8 +20,7 @@ registryItems:\n   instances:\n     - {jedis-scenario: 1}\n   operationNames:\n-    - jedis-scenario: [Jedis/set, Jedis/echo, Jedis/del,\n-                       Jedis/get, /jedis-scenario/case/jedis-scenario]\n+    - jedis-scenario: [/jedis-scenario/case/jedis-scenario]\n   heartbeat: []\n segmentItems:\n   - applicationCode: jedis-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/jedis-scenario/config/expectedData.yaml",
                "sha": "181927b4d55627c653f021e8dd21bdbcd2c6b7b4",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/jetty-scenario/config/expectedData.yaml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/jetty-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/jetty-scenario/config/expectedData.yaml",
                "patch": "@@ -22,8 +22,7 @@ registryItems:\n   - {jettyclient-scenario: 1}\n   operationNames:\n   - jettyserver-scenario: [/jettyserver-case/case/receiveContext-0]\n-  - jettyclient-scenario: [/jettyserver-case/case/receiveContext-0,\n-                           /jettyclient-case/case/jettyclient-case,\n+  - jettyclient-scenario: [/jettyclient-case/case/jettyclient-case,\n                            /jettyclient-case/case/healthCheck]\n segmentItems:\n - applicationCode: jettyserver-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/jetty-scenario/config/expectedData.yaml",
                "sha": "ecfa7dd49611f28b06905c83920c59164ff798bf",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/kafka-scenario/config/expectedData.yaml",
                "changes": 23,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/kafka-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 21,
                "filename": "test/plugin/scenarios/kafka-scenario/config/expectedData.yaml",
                "patch": "@@ -19,31 +19,12 @@ registryItems:\n   instances:\n     - {kafka-scenario: 1}\n   operationNames:\n-    - kafka-scenario: [Kafka/test/Producer, Kafka/test/Consumer/testGroup,\n-                       /case/healthCheck, /case/kafka-case]\n+    - kafka-scenario: [Kafka/test/Consumer/testGroup, /case/kafka-case]\n   heartbeat: []\n segmentItems:\n   - applicationCode: kafka-scenario\n-    segmentSize: gt 4\n+    segmentSize: gt 3\n     segments:\n-      - segmentId: not null\n-        spans:\n-          - operationName: /case/healthCheck\n-            operationId: 0\n-            parentSpanId: -1\n-            spanId: 0\n-            spanLayer: Http\n-            startTime: nq 0\n-            endTime: nq 0\n-            componentId: 14\n-            componentName: ''\n-            isError: false\n-            spanType: Entry\n-            peer: ''\n-            peerId: 0\n-            tags:\n-              - {key: url, value: 'http://localhost:8080/kafka-scenario/case/healthCheck'}\n-              - {key: http.method, value: HEAD}\n       - segmentId: not null\n         spans:\n           - operationName: Kafka/Producer/Callback",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/kafka-scenario/config/expectedData.yaml",
                "sha": "b85df953f2c6eeebe881403dadf8d8417550dcc2",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/mongodb-3.x-scenario/config/expectedData.yaml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/mongodb-3.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/mongodb-3.x-scenario/config/expectedData.yaml",
                "patch": "@@ -20,8 +20,7 @@ registryItems:\n   instances:\n     - {mongodb-3.x-scenario: 1}\n   operationNames:\n-    - mongodb-3.x-scenario: [/mongodb-case/case/mongodb, MongoDB/DropDatabaseOperation, MongoDB/FindOperation,\n-                             MongoDB/CreateCollectionOperation, MongoDB/MixedBulkWriteOperation]\n+    - mongodb-3.x-scenario: [/mongodb-case/case/mongodb]\n   heartbeat: []\n \n segmentItems:",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/mongodb-3.x-scenario/config/expectedData.yaml",
                "sha": "20bce04a0305f4cd5973ebf986713af87f8ec532",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/mysql-scenario/config/expectedData.yaml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/mysql-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/mysql-scenario/config/expectedData.yaml",
                "patch": "@@ -19,8 +19,7 @@ registryItems:\n   instances:\n     - {mysql-scenario: 1}\n   operationNames:\n-    - mysql-scenario: [Mysql/JDBI/Statement/execute, /mysql-scenario/case/healthCheck,\n-                       Mysql/JDBI/PreparedStatement/execute, /mysql-scenario/case/mysql-scenario, Mysql/JDBI/Connection/close]\n+    - mysql-scenario: [/mysql-scenario/case/healthCheck, /mysql-scenario/case/mysql-scenario]\n segmentItems:\n   - applicationCode: mysql-scenario\n     segmentSize: ge 2",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/mysql-scenario/config/expectedData.yaml",
                "sha": "be73e68b30633b667ad379519ceb3c0642c1d9a7",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/netty-socketio-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/netty-socketio-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/netty-socketio-scenario/config/expectedData.yaml",
                "patch": "@@ -20,7 +20,7 @@ registryItems:\n   instances:\n     - {netty-socketio-scenario: 1}\n   operationNames:\n-    - netty-socketio-scenario: [/netty-socketio-scenario/case/netty-socketio, /socket.io/,\n+    - netty-socketio-scenario: [/netty-socketio-scenario/case/netty-socketio,\n                                 /netty-socketio-scenario/healthCheck, SocketIO/onConnect, SocketIO/send_data/receive]\n   heartbeat: []\n segmentItems:",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/netty-socketio-scenario/config/expectedData.yaml",
                "sha": "021e00c2dd0bef4a8c0be1436c458ae97d87c73d",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/okhttp-scenario/config/expectedData.yaml",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/okhttp-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 4,
                "filename": "test/plugin/scenarios/okhttp-scenario/config/expectedData.yaml",
                "patch": "@@ -20,7 +20,7 @@ registryItems:\n   instances:\n   - {okhttp-scenario: 1}\n   operationNames:\n-  - okhttp-scenario: [/case/receiveContext-0, /okhttp-case/case/receiveContext-0,/case/healthCheck, /case/okhttp-case, /case/receiveContext-1]\n+  - okhttp-scenario: [/case/receiveContext-0, /case/healthCheck, /case/okhttp-case, /case/receiveContext-1]\n   heartbeat: []\n segmentItems:\n - applicationCode: okhttp-scenario\n@@ -76,7 +76,9 @@ segmentItems:\n       - {key: url, value: 'http://127.0.0.1:8080/okhttp-case/case/receiveContext-0'}\n       - {key: http.method, value: GET}\n       refs:\n-      - {parentEndpointId: 0, parentEndpoint: /okhttp-case/case/receiveContext-0, networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 0, parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '127.0.0.1:8080', entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}\n+      - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0, entryEndpointId: 0,\n+         refType: CrossProcess, parentSpanId: 0, parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '127.0.0.1:8080',\n+         entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}\n   - segmentId: not null\n     spans:\n     - operationName: /case/receiveContext-1\n@@ -96,7 +98,8 @@ segmentItems:\n       - {key: url, value: 'http://127.0.0.1:8080/okhttp-case/case/receiveContext-1'}\n       - {key: http.method, value: GET}\n       refs:\n-      - {parentEndpointId: 0, parentEndpoint: /okhttp-case/case/receiveContext-0, networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 0, parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '127.0.0.1:8080', entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}\n+      - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0, entryEndpointId: 0, refType: CrossProcess, parentSpanId: 0,\n+         parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '127.0.0.1:8080', entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}\n   - segmentId: not null\n     spans:\n     - operationName: /okhttp-case/case/receiveContext-0\n@@ -116,4 +119,5 @@ segmentItems:\n       - {key: http.method, value: GET}\n       - {key: url, value: 'http://127.0.0.1:8080/okhttp-case/case/receiveContext-0'}\n       refs:\n-      - {parentEndpointId: 0, parentEndpoint: /case/okhttp-case, networkAddressId: 0, entryEndpointId: 0, refType: CrossThread, parentSpanId: 1, parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}\n+      - {parentEndpointId: 0, parentEndpoint: '/case/okhttp-case', networkAddressId: 0, entryEndpointId: 0, refType: CrossThread, parentSpanId: 1,\n+         parentTraceSegmentId: nq 0, parentServiceInstanceId: nq 0, networkAddress: '', entryEndpoint: /case/okhttp-case, entryServiceInstanceId: nq 0}",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/okhttp-scenario/config/expectedData.yaml",
                "sha": "6d4af0cfca4a8d9d884bea91f7aef5c359d1eb27",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/oracle-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/oracle-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/oracle-scenario/config/expectedData.yaml",
                "patch": "@@ -19,9 +19,7 @@ registryItems:\n   instances:\n   - {oracle-scenario: 1}\n   operationNames:\n-  - oracle-scenario: [Oracle/JDBI/Connection/close, Oracle/JDBI/PreparedStatement/executeQuery,\n-                      Oracle/JDBI/PreparedStatement/execute, Oracle/JDBI/Statement/execute,\n-                      /oracle-scenario/case/oracle]\n+  - oracle-scenario: [/oracle-scenario/case/oracle]\n segmentItems:\n - applicationCode: oracle-scenario\n   segmentSize: ge 1",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/oracle-scenario/config/expectedData.yaml",
                "sha": "c85f2f792ff020889e72f1840f037d71840df451",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/postgresql-above9.4.1207-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/postgresql-above9.4.1207-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/postgresql-above9.4.1207-scenario/config/expectedData.yaml",
                "patch": "@@ -19,9 +19,7 @@ registryItems:\n     instances:\n     - {postgresql-above9.4.1207-scenario: 1}\n     operationNames:\n-    - postgresql-above9.4.1207-scenario: [/postgresql-scenario/case/postgres, PostgreSQL/JDBI/PreparedStatement/executeWithFlags,\n-                            PostgreSQL/JDBI/CallableStatement/executeWithFlags, PostgreSQL/JDBI/Statement/execute,\n-                            PostgreSQL/JDBI/Connection/close]\n+    - postgresql-above9.4.1207-scenario: [/postgresql-scenario/case/postgres]\n segmentItems:\n - applicationCode: postgresql-above9.4.1207-scenario\n   segmentSize: ge 1",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/postgresql-above9.4.1207-scenario/config/expectedData.yaml",
                "sha": "2fa965b4a6afb5ec9f6c1836cab62baae0e645b7",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/postgresql-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/postgresql-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/postgresql-scenario/config/expectedData.yaml",
                "patch": "@@ -19,9 +19,7 @@ registryItems:\n     instances:\n     - {postgresql-scenario: 1}\n     operationNames:\n-    - postgresql-scenario: [/postgresql-scenario/case/postgres, PostgreSQL/JDBI/PreparedStatement/execute,\n-                            PostgreSQL/JDBI/CallableStatement/execute, PostgreSQL/JDBI/Statement/execute,\n-                            PostgreSQL/JDBI/Connection/close]\n+    - postgresql-scenario: [/postgresql-scenario/case/postgres]\n     heartbeat: []\n segmentItems:\n - applicationCode: postgresql-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/postgresql-scenario/config/expectedData.yaml",
                "sha": "06405767355ac3b6c0be764873cecf39d09344e0",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/pulsar-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/pulsar-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/pulsar-scenario/config/expectedData.yaml",
                "patch": "@@ -20,7 +20,7 @@ registryItems:\n   instances:\n   - {pulsar-scenario: nq 0}\n   operationNames:\n-  - pulsar-scenario: [Pulsar/test/Producer, /case/pulsar-case, Pulsar/test/Consumer/test]\n+  - pulsar-scenario: [/case/pulsar-case, Pulsar/test/Consumer/test]\n segmentItems:\n - applicationCode: pulsar-scenario\n   segmentSize: ge 3",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/pulsar-scenario/config/expectedData.yaml",
                "sha": "559082791e78a5c5ae6431b8fd060fd8c04318c7",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/rabbitmq-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/rabbitmq-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/rabbitmq-scenario/config/expectedData.yaml",
                "patch": "@@ -19,7 +19,7 @@ registryItems:\n   instances:\n   - {rabbitmq-scenario: 1}\n   operationNames:\n-  - rabbitmq-scenario: [/rabbitmq-scenario/case/rabbitmq,RabbitMQ/Topic/Queue/test/Producer,RabbitMQ/Topic/Queue/test/Consumer]\n+  - rabbitmq-scenario: [/rabbitmq-scenario/case/rabbitmq, RabbitMQ/Topic/Queue/test/Consumer]\n segmentItems:\n - applicationCode: rabbitmq-scenario\n   segmentSize: gt 2",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/rabbitmq-scenario/config/expectedData.yaml",
                "sha": "8b6b964b80763ab0d06b4b35a8bedfa010252a6f",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/redisson-scenario/config/expectedData.yaml",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/redisson-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 1,
                "filename": "test/plugin/scenarios/redisson-scenario/config/expectedData.yaml",
                "patch": "@@ -20,7 +20,7 @@ registryItems:\n   instances:\n     - {redisson-scenario: 1}\n   operationNames:\n-    - redisson-scenario: [/case/healthCheck, Redisson/BATCH_EXECUTE, Redisson/SET, /case/redisson-case]\n+    - redisson-scenario: [/case/healthCheck, /case/redisson-case]\n   heartbeat: []\n segmentItems:\n   - applicationCode: redisson-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/redisson-scenario/config/expectedData.yaml",
                "sha": "aac27237eb819ab44dc9b1e356eb59b3442872e0",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/solrj-7.x-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/solrj-7.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/solrj-7.x-scenario/config/expectedData.yaml",
                "patch": "@@ -19,9 +19,7 @@ registryItems:\n   instances:\n     - {solrj-7.x-scenario: nq 0}\n   operationNames:\n-    - solrj-7.x-scenario: [/solrj-scenario/case/solrj, solrJ/mycore/update/COMMIT, solrJ/mycore/update/DELETE_BY_IDS,\n-                           solrJ/mycore/select, solrJ/mycore/update/DELETE_BY_QUERY, solrJ/mycore/get,\n-                           solrJ/mycore/update/OPTIMIZE, solrJ/mycore/update/ADD]\n+    - solrj-7.x-scenario: [/solrj-scenario/case/solrj]\n   heartbeat: []\n segmentItems:\n   - applicationCode: solrj-7.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/solrj-7.x-scenario/config/expectedData.yaml",
                "sha": "efe708f2d278f70d5bf7b71d97e232fe574b84f9",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-3.1.x-scenario/config/expectedData.yaml",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-3.1.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/spring-3.1.x-scenario/config/expectedData.yaml",
                "patch": "@@ -20,9 +20,8 @@ registryItems:\n     - {spring-3.1.x-scenario: 1}\n   operationNames:\n     - spring-3.1.x-scenario: ['{DELETE}/delete/{id}', /case/resttemplate, '{GET}/get/{id}',\n-                              /spring-3.1.x-scenario/delete/1, '{POST}/create/', /healthCheck, /case/spring3,\n-                              /spring-3.1.x-scenario/case/spring3/, /spring-3.1.x-scenario/update/1, '{PUT}/update/{id}',\n-                              /spring-3.1.x-scenario/create/, /spring-3.1.x-scenario/get/1]\n+                              '{POST}/create/', /healthCheck, /case/spring3,\n+                              '{PUT}/update/{id}']\n   heartbeat: []\n segmentItems:\n   - applicationCode: spring-3.1.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-3.1.x-scenario/config/expectedData.yaml",
                "sha": "5f5acdfdc1a20af66c4c61045c2720f0f8af23a2",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-4.1.x-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-4.1.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/spring-4.1.x-scenario/config/expectedData.yaml",
                "patch": "@@ -20,9 +20,7 @@ registryItems:\n     - {spring-4.1.x-scenario: 1}\n   operationNames:\n     - spring-4.1.x-scenario: ['{DELETE}/delete/{id}', /case/resttemplate, '{GET}/get/{id}',\n-                              /spring-4.1.x-scenario/delete/1, '{POST}/create/', /healthCheck, /case/spring3,\n-                              /spring-4.1.x-scenario/case/spring3/, /spring-4.1.x-scenario/update/1, '{PUT}/update/{id}',\n-                              /spring-4.1.x-scenario/create/, /spring-4.1.x-scenario/get/1]\n+                               '{POST}/create/', /healthCheck, /case/spring3, '{PUT}/update/{id}']\n   heartbeat: []\n segmentItems:\n   - applicationCode: spring-4.1.x-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-4.1.x-scenario/config/expectedData.yaml",
                "sha": "0f4931bb411e8d216ae69267afa648a3416f4487",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-4.3.x-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-4.3.x-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/spring-4.3.x-scenario/config/expectedData.yaml",
                "patch": "@@ -20,9 +20,7 @@ registryItems:\n     - {spring-4.3.x-scenario: 1}\n   operationNames:\n     - spring-4.3.x-scenario: [/create/, '/delete/{id}', /inherit/child/test, /healthCheck,\n-                              /spring-4.3.x-scenario/case/spring3/, /spring-4.3.x-scenario/create/, /spring-4.3.x-scenario/get/1,\n-                              '/get/{id}', '/update/{id}', /case/resttemplate, /spring-4.3.x-scenario/delete/1,\n-                              /spring-4.3.x-scenario/inherit/child/test, /spring-4.3.x-scenario/update/1,\n+                              '/get/{id}', '/update/{id}', /case/resttemplate,\n                               /case/spring3]\n   heartbeat: []\n segmentItems:",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-4.3.x-scenario/config/expectedData.yaml",
                "sha": "982805a273c3de948cc19023690f6d22448d70bb",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-async-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-async-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/scenarios/spring-async-scenario/config/expectedData.yaml",
                "patch": "@@ -63,7 +63,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/spring-async-scenario/case/asyncVisit'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: SpringAsync, networkAddressId: 0, entryEndpointId: 0,\n+              - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0, entryEndpointId: 0,\n                  refType: CrossProcess, parentSpanId: 1, parentTraceSegmentId: not null,\n                  parentServiceInstanceId: 1, networkAddress: 'localhost:8080', entryEndpoint: /spring-async-scenario/case/spring-async,\n                  entryServiceInstanceId: 1}\n@@ -86,7 +86,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/spring-async-scenario/case/asyncVisit'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: SpringAsync, networkAddressId: 0, entryEndpointId: 0,\n+              - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0, entryEndpointId: 0,\n                  refType: CrossProcess, parentSpanId: 1, parentTraceSegmentId: not null,\n                  parentServiceInstanceId: 1, networkAddress: 'localhost:8080', entryEndpoint: /spring-async-scenario/case/spring-async,\n                  entryServiceInstanceId: 1}",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-async-scenario/config/expectedData.yaml",
                "sha": "e2377b747040e574b251551c2bac5d88e399afc4",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "patch": "@@ -20,9 +20,7 @@ registryItems:\n   instances:\n     - {spring-tx-scenario: 1}\n   operationNames:\n-    - spring-tx-scenario: [Mysql/JDBI/Statement/execute, Mysql/JDBI/Connection/commit,\n-                           Mysql/JDBI/PreparedStatement/executeUpdate, /case/spring-tx-case, /case/healthCheck,\n-                           Mysql/JDBI/Connection/close, Mysql/JDBI/Statement/executeQuery]\n+    - spring-tx-scenario: [/case/spring-tx-case, /case/healthCheck]\n   heartbeat: []\n segmentItems:\n   - applicationCode: spring-tx-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "sha": "46a42e601d956e44368fd0899bf943a743fe4786",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/undertow-scenario/config/expectedData.yaml",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/undertow-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/undertow-scenario/config/expectedData.yaml",
                "patch": "@@ -20,7 +20,7 @@ registryItems:\n   instances:\n     - {undertow-scenario: 1}\n   operationNames:\n-    - undertow-scenario: [/undertow-scenario/case/undertow1, /undertow-scenario/case/undertow, /undertow-routing-scenario/case/undertow,\n+    - undertow-scenario: [/undertow-scenario/case/undertow1, /undertow-scenario/case/undertow,\n                           '/undertow-routing-scenario/case/{context}']\n   heartbeat: []\n segmentItems:\n@@ -64,7 +64,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8081/undertow-routing-scenario/case/undertow'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: UndertowDispatch, networkAddressId: 0,\n+              - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0,\n                  entryEndpointId: 0, refType: CrossProcess, parentSpanId: 1, parentTraceSegmentId: not null,\n                  parentServiceInstanceId: 1, networkAddress: 'localhost:8081', entryEndpoint: /undertow-scenario/case/undertow,\n                  entryServiceInstanceId: 1}\n@@ -87,7 +87,7 @@ segmentItems:\n               - {key: url, value: 'http://localhost:8080/undertow-scenario/case/undertow1'}\n               - {key: http.method, value: GET}\n             refs:\n-              - {parentEndpointId: 0, parentEndpoint: UndertowDispatch, networkAddressId: 0,\n+              - {parentEndpointId: -1, parentEndpoint: '', networkAddressId: 0,\n                  entryEndpointId: 0, refType: CrossProcess, parentSpanId: 1, parentTraceSegmentId: not null,\n                  parentServiceInstanceId: 1, networkAddress: 'localhost:8080', entryEndpoint: /undertow-scenario/case/undertow,\n                  entryServiceInstanceId: 1}",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/undertow-scenario/config/expectedData.yaml",
                "sha": "010032df772de18c57427dad624994dd330bf5f7",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/webflux-scenario/config/expectedData.yaml",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/webflux-scenario/config/expectedData.yaml?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 3,
                "filename": "test/plugin/scenarios/webflux-scenario/config/expectedData.yaml",
                "patch": "@@ -27,9 +27,7 @@ registryItems:\n                                   WEBFLUX.handle, org.apache.skywalking.apm.testcase.sc.webflux.projectB.controller.TestAnnotationController.error,\n                                   org.apache.skywalking.apm.testcase.sc.webflux.projectB.controller.TestAnnotationController.healthCheck,\n                                   RoutingConfiguration.org.apache.skywalking.apm.testcase.sc.webflux.projectB.route.TestHandler]\n-    - webflux-projectA-scenario: [/testcase/annotation/mono/hello, /projectA/testcase,\n-                                  /testcase/annotation/success, /testcase/annotation/healthCheck, /notFound, /projectA/healthCheck,\n-                                  /testcase/route/error, /testcase/route/success, /testcase/annotation/error]\n+    - webflux-projectA-scenario: [/projectA/testcase]\n   heartbeat: []\n segmentItems:\n   - applicationCode: webflux-projectB-scenario",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/scenarios/webflux-scenario/config/expectedData.yaml",
                "sha": "9c29c6df9403e9a10ef1c44b615d5d0ff42ee419",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentAssert.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentAssert.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentAssert.java",
                "patch": "@@ -211,8 +211,8 @@ private static SegmentRef findSegmentRef(List<SegmentRef> actual, SegmentRef exp\n \n     private static boolean simpleSegmentRefEquals(SegmentRef expected, SegmentRef actual) {\n         try {\n-            ExpressParser.parse(expected.entryServiceName()).assertValue(\"entry service name\", actual.entryServiceName());\n-            ExpressParser.parse(expected.parentServiceName()).assertValue(\"parent service name\", actual.parentServiceName());\n+            ExpressParser.parse(expected.entryEndpointName()).assertValue(\"entry service name\", actual.entryEndpointName());\n+            ExpressParser.parse(expected.parentEndpointName()).assertValue(\"parent service name\", actual.parentEndpointName());\n             ExpressParser.parse(expected.refType()).assertValue(\"ref type\", actual.refType());\n             return true;\n         } catch (ValueAssertFailedException e) {",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentAssert.java",
                "sha": "8baaf370c53157f21da6359f6e03e4b9afb4e606",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentRefAssert.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentRefAssert.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 6,
                "filename": "test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentRefAssert.java",
                "patch": "@@ -57,17 +57,17 @@ private static SegmentRef findSegmentRef(List<SegmentRef> actual, SegmentRef exp\n \n     private static boolean segmentRefEquals(SegmentRef expected, SegmentRef actual) {\n         try {\n-            ExpressParser.parse(expected.entryServiceName()).assertValue(\"entry service name\", actual.entryServiceName());\n+            ExpressParser.parse(expected.entryEndpointName()).assertValue(\"entry endpoint name\", actual.entryEndpointName());\n             ExpressParser.parse(expected.networkAddress()).assertValue(\"network address\", actual.networkAddress());\n             ExpressParser.parse(expected.parentTraceSegmentId()).assertValue(\"parent segment id\", actual.parentTraceSegmentId());\n             ExpressParser.parse(expected.parentSpanId()).assertValue(\"span id\", actual.parentSpanId());\n-            ExpressParser.parse(expected.entryServiceId()).assertValue(\"entry service id\", actual.entryServiceId());\n+            ExpressParser.parse(expected.entryEndpointId()).assertValue(\"entry endpoint id\", actual.entryEndpointId());\n             ExpressParser.parse(expected.networkAddressId()).assertValue(\"network address id\", actual.networkAddressId());\n-            ExpressParser.parse(expected.parentApplicationInstanceId()).assertValue(\"parent application instance id\", actual.parentApplicationInstanceId());\n-            ExpressParser.parse(expected.parentServiceId()).assertValue(\"parent service id\", actual.parentServiceId());\n-            ExpressParser.parse(expected.parentServiceName()).assertValue(\"parent service name\", actual.parentServiceName());\n+            ExpressParser.parse(expected.parentServiceInstanceId()).assertValue(\"parent application instance id\", actual.parentServiceInstanceId());\n+            ExpressParser.parse(expected.parentEndpointId()).assertValue(\"parent endpoint id\", actual.parentEndpointId());\n+            ExpressParser.parse(expected.parentEndpointName()).assertValue(\"parent endpoint name\", actual.parentEndpointName());\n             ExpressParser.parse(expected.refType()).assertValue(\"ref type\", actual.refType());\n-            ExpressParser.parse(expected.entryApplicationInstanceId()).assertValue(\"entry application instance id\", actual.entryApplicationInstanceId());\n+            ExpressParser.parse(expected.entryServiceInstanceId()).assertValue(\"entry application instance id\", actual.entryServiceInstanceId());\n             return true;\n         } catch (ValueAssertFailedException e) {\n             throw new SegmentRefAssertFailedException(e, expected, actual);",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/SegmentRefAssert.java",
                "sha": "fffc10a1740b6d84bab40c21cc32112e1d94ef82",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/exception/SegmentRefNotFoundException.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/exception/SegmentRefNotFoundException.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 2,
                "filename": "test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/exception/SegmentRefNotFoundException.java",
                "patch": "@@ -40,9 +40,9 @@ public String getCauseMessage() {\n             String reason = cause.getFailedCause().getCauseMessage();\n \n             StringBuilder actualSegmentRef = new StringBuilder(String.format(\"\\nSegmentRef:\\t%s\\n\", reason));\n-            actualSegmentRef.append(String.format(\" - entryServiceName:\\t\\t%s\\n\", actual.entryServiceName()))\n+            actualSegmentRef.append(String.format(\" - entryServiceName:\\t\\t%s\\n\", actual.entryEndpointName()))\n                 .append(String.format(\" - networkAddress:\\t\\t\\t%s\\n\", actual.networkAddress()))\n-                .append(String.format(\" - parentServiceName:\\t\\t%s\\n\", actual.parentServiceName()))\n+                .append(String.format(\" - parentServiceName:\\t\\t%s\\n\", actual.parentEndpointName()))\n                 .append(String.format(\" - parentSpanId:\\t\\t\\t%s\\n\", actual.parentSpanId()))\n                 .append(String.format(\" - parentTraceSegmentId:\\t%s\\n\", actual.parentTraceSegmentId()))\n                 .append(String.format(\" - refType:\\t\\t\\t\\t\\t%s\", actual.refType())).toString();",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/assertor/exception/SegmentRefNotFoundException.java",
                "sha": "268efb96cc604fd659359f46049b875e50e5f787",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentForRead.java",
                "changes": 16,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentForRead.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 8,
                "filename": "test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentForRead.java",
                "patch": "@@ -110,19 +110,19 @@ public void setEntryServiceInstanceId(String entryServiceInstanceId) {\n             this.entryServiceInstanceId = entryServiceInstanceId;\n         }\n \n-        @Override public String parentServiceId() {\n+        @Override public String parentEndpointId() {\n             return parentEndpointId;\n         }\n \n-        @Override public String parentServiceName() {\n+        @Override public String parentEndpointName() {\n             return parentEndpoint;\n         }\n \n         @Override public String networkAddressId() {\n             return networkAddressId;\n         }\n \n-        @Override public String entryServiceId() {\n+        @Override public String entryEndpointId() {\n             return entryEndpointId;\n         }\n \n@@ -138,31 +138,31 @@ public void setEntryServiceInstanceId(String entryServiceInstanceId) {\n             return parentTraceSegmentId;\n         }\n \n-        @Override public String parentApplicationInstanceId() {\n+        @Override public String parentServiceInstanceId() {\n             return parentServiceInstanceId;\n         }\n \n         @Override public String networkAddress() {\n             return networkAddress;\n         }\n \n-        @Override public String entryServiceName() {\n+        @Override public String entryEndpointName() {\n             return entryEndpoint;\n         }\n \n         @Override public void parentTraceSegmentId(String parentTraceSegmentId) {\n             this.parentTraceSegmentId = parentTraceSegmentId;\n         }\n \n-        @Override public String entryApplicationInstanceId() {\n+        @Override public String entryServiceInstanceId() {\n             return entryServiceInstanceId;\n         }\n \n         @Override public String toString() {\n             StringBuilder actualSegmentRef = new StringBuilder(\"\\nSegmentRef:\\n\");\n-            return actualSegmentRef.append(String.format(\" - entryServiceName:\\t\\t%s\\n\", entryServiceName()))\n+            return actualSegmentRef.append(String.format(\" - entryServiceName:\\t\\t%s\\n\", entryEndpointName()))\n                 .append(String.format(\" - networkAddress:\\t\\t\\t%s\\n\", networkAddress()))\n-                .append(String.format(\" - parentServiceName:\\t\\t%s\\n\", parentServiceName()))\n+                .append(String.format(\" - parentServiceName:\\t\\t%s\\n\", parentEndpointName()))\n                 .append(String.format(\" - parentSpanId:\\t\\t\\t%s\\n\", parentSpanId()))\n                 .append(String.format(\" - parentTraceSegmentId:\\t%s\\n\", parentTraceSegmentId()))\n                 .append(String.format(\" - refType:\\t\\t\\t\\t\\t%s\", refType())).toString();",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentForRead.java",
                "sha": "b5c6dc5b7a62cd2c6c92ceab91e96d1a5e4899f7",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/skywalking/blob/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentRef.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentRef.java?ref=4e501328171f434c74144d373be6df0264f43a24",
                "deletions": 6,
                "filename": "test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentRef.java",
                "patch": "@@ -21,27 +21,27 @@\n  */\n public interface SegmentRef {\n \n-    String parentServiceId();\n+    String parentEndpointId();\n \n-    String parentServiceName();\n+    String parentEndpointName();\n \n     String networkAddressId();\n \n-    String entryServiceId();\n+    String entryEndpointId();\n \n     String refType();\n \n     String parentSpanId();\n \n     String parentTraceSegmentId();\n \n-    String parentApplicationInstanceId();\n+    String parentServiceInstanceId();\n \n     String networkAddress();\n \n-    String entryServiceName();\n+    String entryEndpointName();\n \n     void parentTraceSegmentId(String parentTraceSegmentId);\n \n-    String entryApplicationInstanceId();\n+    String entryServiceInstanceId();\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/4e501328171f434c74144d373be6df0264f43a24/test/plugin/validator/src/main/java/org/apache/skywalking/plugin/test/agent/tool/validator/entity/SegmentRef.java",
                "sha": "c654f68e8f80561aa90371cbc478bbfce849e592",
                "status": "modified"
            }
        ],
        "message": "Remove the local/exit span register mechanism in Java agent scenario (#4059)\n\n* Remove the local span and exit span register mechanism in Java agent scenario.\r\n\r\n* Fix config, plugin, and document, as exit span is not required register anymore.\r\n\r\n* Try to fix the test case expected data due to no register for exit span.\r\n\r\n* Fix toolkit case.\r\n\r\n* Remove exit span from plugin test framework document.\r\n\r\n* Update protocol, FAQ, and CHANGELOG documents to highlight this change.\r\n\r\n* Fix NPE when no entry span in the whole segment. Set endpoint to null in segment entity.\r\n\r\n* Fix the snapshot and add inexistence operation name id.\r\n\r\n* Fix several async cases.\r\n\r\n* Fix undertow test case.\r\n\r\n* Fix wrong error log name.\r\n\r\n* Keep name consistent with 6.x concepts.\r\n\r\n* Try to fix 3 async scenarios.\r\n\r\n* Fix okhttp case.\r\n\r\n* Fix Spring Async case.\r\n\r\n* Fix another NPE\r\n\r\n* Fix NPE when first span has no endpoint id when it is local or exit span.\r\n\r\n* Still fill first operation name when no endpoint id.",
        "parent": "https://github.com/apache/skywalking/commit/23311ca1dc75f810842d7faf2d545fc12b37cf6b",
        "patched_files": [
            ".java",
            "MultiScopesSpanListener.java",
            "DictionaryUtil.java",
            "RegisterServiceHandler.java",
            "SpanExchanger.java",
            "Config.java",
            "SegmentForRead.java",
            "ServiceBMock.java",
            "ReferenceIdExchanger.java",
            "StackBasedTracingSpan.java",
            "SegmentRef.java",
            "CHANGES.java",
            "SegmentParseV2.java",
            "Skywalking-Cross-Process-Propagation-Headers-Protocol-v2.java",
            "RestExecuteInterceptor.java",
            "SegmentParse.java",
            "EndpointNameDictionary.java",
            "SegmentRefNotFoundException.java",
            "Unexpected-endpoint-register.java",
            "README.java",
            "op_name_group_rule.java",
            "SegmentRefAssert.java",
            "expectedData.java",
            "Const.java",
            "SegmentAssert.java",
            "SegmentSpanListener.java",
            "ServiceAMock.java",
            "TracingContext.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "TracingContextTest.java",
            "Plugin-test.java",
            "DictionaryUtilTests.java"
        ]
    },
    "skywalking_5eea1ae": {
        "bug_id": "skywalking_5eea1ae",
        "commit": "https://github.com/apache/skywalking/commit/5eea1ae7670b58acaa7278ee3b3e730235d17bc7",
        "file": [
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/skywalking/blob/5eea1ae7670b58acaa7278ee3b3e730235d17bc7/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java?ref=5eea1ae7670b58acaa7278ee3b3e730235d17bc7",
                "deletions": 13,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "patch": "@@ -15,17 +15,15 @@\n  * limitations under the License.\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.patch;\n \n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n-\n import java.lang.reflect.Method;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.List;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n \n /**\n  * {@link AopExpressionMatchInterceptor} check if the method is match the enhanced method\n@@ -42,30 +40,33 @@ public AopExpressionMatchInterceptor() {\n     }\n \n     @Override\n-    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, MethodInterceptResult result) {\n+    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        MethodInterceptResult result) {\n \n     }\n \n     @Override\n-    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Object ret) {\n-        Method targetAopMethod = (Method) allArguments[1];\n-        Class<?> targetAopClass = (Class<?>) allArguments[2];\n-        if (EnhancedInstance.class.isAssignableFrom(targetAopClass) && isEnhancedMethod(targetAopMethod)) {\n+    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        Object ret) {\n+        Method targetAopMethod = (Method)allArguments[1];\n+        Class<?> targetAopClass = (Class<?>)allArguments[2];\n+        if (targetAopClass != null && EnhancedInstance.class.isAssignableFrom(targetAopClass) && isEnhancedMethod(targetAopMethod)) {\n             return false;\n         }\n         return ret;\n     }\n \n     @Override\n-    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Throwable t) {\n+    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        Throwable t) {\n \n     }\n \n     private boolean isEnhancedMethod(Method targetMethod) {\n         for (Method method : methods) {\n             if (method.getName().equals(targetMethod.getName())\n-                    && method.getReturnType().equals(targetMethod.getReturnType())\n-                    && equalParamTypes(method.getParameterTypes(), targetMethod.getParameterTypes())) {\n+                && method.getReturnType().equals(targetMethod.getReturnType())\n+                && equalParamTypes(method.getParameterTypes(), targetMethod.getParameterTypes())) {\n                 return true;\n             }\n         }",
                "raw_url": "https://github.com/apache/skywalking/raw/5eea1ae7670b58acaa7278ee3b3e730235d17bc7/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "sha": "5c99a886904ef3eae8d455c155c42390186dc71a",
                "status": "modified"
            }
        ],
        "message": "Fix #1488: Fix NPE when the targetAop class is null (#1507)",
        "parent": "https://github.com/apache/skywalking/commit/6295af53fbd32559dbcaf8d2cb4d59dd6a32c7e7",
        "patched_files": [
            "AopExpressionMatchInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "AopExpressionMatchInterceptorTest.java"
        ]
    },
    "skywalking_630e623": {
        "bug_id": "skywalking_630e623",
        "commit": "https://github.com/apache/skywalking/commit/630e62312ce1dc37d60780351d15f68ff47dd5f0",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/630e62312ce1dc37d60780351d15f68ff47dd5f0/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java?ref=630e62312ce1dc37d60780351d15f68ff47dd5f0",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "patch": "@@ -44,7 +44,8 @@ public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allA\n         Object ret) throws Throwable {\n         AdvisedSupport advisedSupport = (AdvisedSupport)allArguments[0];\n \n-        if (EnhancedInstance.class.isAssignableFrom(advisedSupport.getTargetClass())) {\n+        Class targetClass = advisedSupport.getTargetClass();\n+        if (targetClass != null && EnhancedInstance.class.isAssignableFrom(targetClass)) {\n             return true;\n         }\n         return ret;",
                "raw_url": "https://github.com/apache/skywalking/raw/630e62312ce1dc37d60780351d15f68ff47dd5f0/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "sha": "a7300e4190d3a68a7e0dacc729031f171e309752",
                "status": "modified"
            }
        ],
        "message": "Fix #1454: fix NPE issue about spring apo interceptor (#1467)",
        "parent": "https://github.com/apache/skywalking/commit/7744911c32e7179ffdf6b9cbaed19ae019338fc6",
        "patched_files": [
            "CreateAopProxyInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "CreateAopProxyInterceptorTest.java"
        ]
    },
    "skywalking_6ae5174": {
        "bug_id": "skywalking_6ae5174",
        "commit": "https://github.com/apache/skywalking/commit/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
        "file": [
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "patch": "@@ -122,6 +122,8 @@\n \n     public static final OfficialComponent RESTEASY =  new OfficialComponent(62, \"RESTEasy\");\n \n+    public static final OfficialComponent SOLRJ =  new OfficialComponent(63, \"solrj\");\n+\n     private static ComponentsDefine INSTANCE = new ComponentsDefine();\n \n     private String[] components;\n@@ -179,6 +181,7 @@ public ComponentsDefine() {\n         addComponent(VERTX);\n         addComponent(SPRING_CLOUD_GATEWAY);\n         addComponent(RESTEASY);\n+        addComponent(SOLRJ);\n     }\n \n     private void addComponent(OfficialComponent component) {",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "sha": "c8dec42ee00f7c61cc0de856ed2c8f02dda527f4",
                "status": "modified"
            },
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "changes": 12,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "patch": "@@ -193,5 +193,17 @@\n              */\n             public static boolean USE_QUALIFIED_NAME_AS_OPERATION_NAME = false;\n         }\n+\n+        public static class SolrJ {\n+            /**\n+             * If true, trace all the query parameters(include deleteByIds and deleteByQuery) in Solr query request, default is false.\n+             */\n+            public static boolean TRACE_STATEMENT = false;\n+\n+            /**\n+             * If true, trace all the operation parameters in Solr request, default is false.\n+             */\n+            public static boolean TRACE_OPS_PARAMS = false;\n+        }\n     }\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "sha": "a1e4f81dccc3ec9178d4e2e452a62991badad780",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/pom.xml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/pom.xml?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/pom.xml",
                "patch": "@@ -73,6 +73,7 @@\n         <module>dubbo-2.7.x-conflict-patch</module>\n         <module>vertx-plugins</module>\n         <module>resteasy-plugin</module>\n+        <module>solrj-7.x-plugin</module>\n     </modules>\n     <packaging>pom</packaging>\n \n@@ -182,4 +183,4 @@\n             </plugin>\n         </plugins>\n     </build>\n-</project>\n+</project>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/pom.xml",
                "sha": "71725d366f314ffc1015f47212baa80a2c1ccd9d",
                "status": "modified"
            },
            {
                "additions": 47,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/pom.xml",
                "changes": 47,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/pom.xml?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/pom.xml",
                "patch": "@@ -0,0 +1,47 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>apm-sdk-plugin</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>6.2.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <artifactId>apm-solrj-7.x-plugin</artifactId>\n+    <packaging>jar</packaging>\n+\n+    <name>solrj-7.x-plugin</name>\n+    <url>http://maven.apache.org</url>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <solr-solrj.version>7.7.1</solr-solrj.version>\n+\t</properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.apache.solr</groupId>\n+            <artifactId>solr-solrj</artifactId>\n+            <version>${solr-solrj.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+    </dependencies>\n+\n+</project>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/pom.xml",
                "sha": "31b931ade3bb9b44caa9282831c2cbc036103e4d",
                "status": "added"
            },
            {
                "additions": 229,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptor.java",
                "changes": 229,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptor.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptor.java",
                "patch": "@@ -0,0 +1,229 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj;\n+\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceConstructorInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.solrj.commons.SolrjInstance;\n+import org.apache.skywalking.apm.plugin.solrj.commons.SolrjTags;\n+import org.apache.solr.client.solrj.SolrRequest;\n+import org.apache.solr.client.solrj.impl.HttpSolrClient;\n+import org.apache.solr.client.solrj.request.AbstractUpdateRequest;\n+import org.apache.solr.client.solrj.request.QueryRequest;\n+import org.apache.solr.client.solrj.request.UpdateRequest;\n+import org.apache.solr.common.SolrDocumentList;\n+import org.apache.solr.common.SolrException;\n+import org.apache.solr.common.SolrInputDocument;\n+import org.apache.solr.common.params.CommonParams;\n+import org.apache.solr.common.params.ModifiableSolrParams;\n+import org.apache.solr.common.params.SolrParams;\n+import org.apache.solr.common.params.UpdateParams;\n+import org.apache.solr.common.util.NamedList;\n+\n+import java.lang.reflect.Method;\n+import java.net.MalformedURLException;\n+import java.net.URL;\n+import java.util.ArrayList;\n+import java.util.Iterator;\n+import java.util.List;\n+\n+public class SolrClientInterceptor implements InstanceMethodsAroundInterceptor, InstanceConstructorInterceptor {\n+    private static final String DB_TYPE = \"Solr\";\n+\n+    @Override\n+    public void onConstruct(EnhancedInstance objInst, Object[] allArguments) {\n+        SolrjInstance instance = new SolrjInstance();\n+        HttpSolrClient client = (HttpSolrClient) objInst;\n+\n+        try {\n+            URL url = new URL(client.getBaseURL());\n+            instance.setRemotePeer(url.getHost() + \":\" + url.getPort());\n+\n+            String path = url.getPath();\n+            int idx = path.lastIndexOf('/');\n+            if (idx > 0) {\n+                instance.setCollection(path.substring(idx + 1));\n+            }\n+        } catch (MalformedURLException ignore) {\n+        }\n+        objInst.setSkyWalkingDynamicField(instance);\n+    }\n+\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                             MethodInterceptResult result) throws Throwable {\n+        SolrRequest<?> request = (SolrRequest<?>) allArguments[0];\n+        SolrjInstance instance = (SolrjInstance) objInst.getSkyWalkingDynamicField();\n+\n+        SolrParams params = getParams(request.getParams());\n+        String collection = getCollection(instance, allArguments[2]);\n+\n+        if (\"/update\".equals(request.getPath())) {\n+            AbstractUpdateRequest update = (AbstractUpdateRequest) request;\n+\n+            AbstractUpdateRequest.ACTION action = update.getAction();\n+            if (action == null) {\n+                if (update instanceof UpdateRequest) {\n+                    AbstractSpan span = null;\n+\n+                    UpdateRequest ur = (UpdateRequest) update;\n+                    List<SolrInputDocument> documents = ur.getDocuments();\n+                    if (documents == null) {\n+                        String actionName = \"DELETE_BY_IDS\";\n+\n+                        List<String> deleteBy = ur.getDeleteById();\n+                        if (deleteBy == null) {\n+                            actionName = \"DELETE_BY_QUERY\";\n+                            deleteBy = ur.getDeleteQuery();\n+                        }\n+                        if (deleteBy == null) {\n+                            deleteBy = new ArrayList<String>();\n+                        }\n+                        String operator = getOperatorNameWithAction(collection, request.getPath(), actionName);\n+                        span = getSpan(operator, instance.getRemotePeer());\n+                        if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+                            span.tag(Tags.DB_STATEMENT, deleteBy.toString());\n+                        }\n+                    } else {\n+                        String operator = getOperatorNameWithAction(collection, request.getPath(), \"ADD\");\n+                        span = getSpan(operator, instance.getRemotePeer());\n+                        if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+                            span.tag(SolrjTags.TAG_DOCS_SIZE, String.valueOf(documents.size()));\n+                        }\n+                    }\n+                    if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+                        span.tag(SolrjTags.TAG_COMMIT_WITHIN, String.valueOf(ur.getCommitWithin()));\n+                    }\n+                } else {\n+                    getSpan(getOperatorName(collection, request.getPath()), instance.getRemotePeer());\n+                }\n+            } else {\n+                String operator = getOperatorNameWithAction(collection, request.getPath(), action.name());\n+                AbstractSpan span = getSpan(operator, instance.getRemotePeer());\n+\n+                if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+                    if (action == AbstractUpdateRequest.ACTION.COMMIT) {\n+                        span.tag(SolrjTags.TAG_SOFT_COMMIT, params.get(UpdateParams.SOFT_COMMIT, \"\"));\n+                    } else {\n+                        span.tag(SolrjTags.TAG_MAX_OPTIMIZE_SEGMENTS, params.get(UpdateParams.MAX_OPTIMIZE_SEGMENTS, \"1\"));\n+                    }\n+                }\n+            }\n+        } else if (request instanceof QueryRequest) {\n+            AbstractSpan span = getSpan(getOperatorName(collection, request.getPath()), instance.getRemotePeer());\n+\n+            span.tag(SolrjTags.TAG_START, params.get(CommonParams.START, \"0\"));\n+            span.tag(SolrjTags.TAG_QT, params.get(CommonParams.QT, request.getPath()));\n+\n+            if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+                span.tag(Tags.DB_STATEMENT, toQueryString(params));\n+            }\n+        } else {\n+            getSpan(getOperatorName(collection, request.getPath()), instance.getRemotePeer());\n+        }\n+    }\n+\n+    @Override\n+    @SuppressWarnings(\"unchecked\")\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments,\n+                              Class<?>[] argumentsTypes, Object ret) throws Throwable {\n+        if (!ContextManager.isActive()) {\n+            return ret;\n+        }\n+\n+        AbstractSpan span = ContextManager.activeSpan();\n+        if (ret != null) {\n+            NamedList<Object> result = (NamedList<Object>) ret;\n+            NamedList<Object> header = (NamedList<Object>) result.get(\"responseHeader\");\n+\n+            if (header != null) {\n+                span.tag(SolrjTags.TAG_Q_TIME, String.valueOf(header.get(\"QTime\")));\n+            }\n+            SolrDocumentList list = (SolrDocumentList) result.get(\"response\");\n+            if (list != null) {\n+                span.tag(SolrjTags.TAG_NUM_FOUND, String.valueOf(list.getNumFound()));\n+            }\n+        }\n+\n+        ContextManager.stopSpan();\n+        return ret;\n+    }\n+\n+    @Override\n+    public void handleMethodException(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, Throwable t) {\n+        if (ContextManager.isActive()) {\n+            AbstractSpan span = ContextManager.activeSpan();\n+            int code = 500;\n+            if (t instanceof SolrException) {\n+                code = ((SolrException) t).code();\n+            }\n+            span.tag(SolrjTags.TAG_STATUS, String.valueOf(code));\n+            span.errorOccurred().log(t);\n+        }\n+    }\n+\n+    private static final AbstractSpan getSpan(String operatorName, String remotePeer) {\n+        return ContextManager.createExitSpan(operatorName, remotePeer)\n+                .setComponent(ComponentsDefine.SOLRJ)\n+                .setLayer(SpanLayer.DB)\n+                .tag(Tags.DB_TYPE, DB_TYPE);\n+    }\n+\n+    private static final String getOperatorNameWithAction(String collection, String path, String action) {\n+        return String.format(\"solrJ/%s%s/%s\", collection, path, action);\n+    }\n+\n+    private static final String getOperatorName(String collection, String path) {\n+        return String.format(\"solrJ/%s%s\", collection, path);\n+    }\n+\n+    private static final String getCollection(SolrjInstance instance, Object argument) {\n+        if (null == argument) {\n+            return instance.getCollection();\n+        }\n+        return String.valueOf(argument);\n+    }\n+\n+    private static final SolrParams getParams(SolrParams params) {\n+        if (params == null) {\n+            return new ModifiableSolrParams();\n+        }\n+        return params;\n+    }\n+\n+    private static final String toQueryString(SolrParams params) {\n+        final StringBuilder sb = new StringBuilder(128);\n+        boolean first = true;\n+        for (final Iterator<String> it = params.getParameterNamesIterator(); it.hasNext();) {\n+            final String name = it.next();\n+            for (String val : params.getParams(name)) {\n+                sb.append(first ? '?' : '&').append(name).append('=').append(val);\n+                first = false;\n+            }\n+        }\n+        return sb.toString();\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptor.java",
                "sha": "5c4d69a22bfb76f6959c32b835cb196aec69a605",
                "status": "added"
            },
            {
                "additions": 59,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrConnectorInterceptor.java",
                "changes": 59,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrConnectorInterceptor.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrConnectorInterceptor.java",
                "patch": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj;\n+\n+import org.apache.http.client.methods.HttpUriRequest;\n+import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n+import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+\n+import java.lang.reflect.Method;\n+\n+public class SolrConnectorInterceptor implements InstanceMethodsAroundInterceptor {\n+\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                             MethodInterceptResult result) throws Throwable {\n+        HttpUriRequest request = (HttpUriRequest) allArguments[0];\n+\n+        ContextCarrier carrier = new ContextCarrier();\n+        ContextManager.inject(carrier);\n+\n+        CarrierItem items = carrier.items();\n+        while (items.hasNext()) {\n+            items = items.next();\n+            request.setHeader(items.getHeadKey(), items.getHeadValue());\n+        }\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                              Object ret) throws Throwable {\n+        return ret;\n+    }\n+\n+    @Override\n+    public void handleMethodException(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes, Throwable t) {\n+        if (ContextManager.isActive()) {\n+            ContextManager.activeSpan().errorOccurred().log(t);\n+        }\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/SolrConnectorInterceptor.java",
                "sha": "d6c00b5662656fb4ae5fc6a987828569fa638f7e",
                "status": "added"
            },
            {
                "additions": 39,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjInstance.java",
                "changes": 39,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjInstance.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjInstance.java",
                "patch": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj.commons;\n+\n+public class SolrjInstance {\n+    private String collection = \"Unknown\";\n+    private String remotePeer = \"Unknown\";\n+\n+    public String getCollection() {\n+        return collection;\n+    }\n+\n+    public void setCollection(String collection) {\n+        this.collection = collection;\n+    }\n+\n+    public String getRemotePeer() {\n+        return remotePeer;\n+    }\n+\n+    public void setRemotePeer(String remotePeer) {\n+        this.remotePeer = remotePeer;\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjInstance.java",
                "sha": "91e4cfb362f065c5bf644cd7dd44f9bffa8c2571",
                "status": "added"
            },
            {
                "additions": 39,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjTags.java",
                "changes": 39,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjTags.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjTags.java",
                "patch": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj.commons;\n+\n+import org.apache.skywalking.apm.agent.core.context.tag.StringTag;\n+\n+public class SolrjTags {\n+    public static StringTag TAG_QT = new StringTag(\"qt\");\n+    public static StringTag TAG_COLLECTION = new StringTag(\"collection\");\n+\n+    public static StringTag TAG_Q_TIME = new StringTag(\"QTime\");\n+    public static StringTag TAG_STATUS = new StringTag(\"status\");\n+\n+    public static StringTag TAG_START = new StringTag(\"start\");\n+    public static StringTag TAG_SORT_BY = new StringTag(\"sort\");\n+    public static StringTag TAG_NUM_FOUND = new StringTag(\"numFound\");\n+\n+    public static StringTag TAG_SOFT_COMMIT = new StringTag(\"softCommit\");\n+    public static StringTag TAG_COMMIT_WITHIN = new StringTag(\"commitWithin\");\n+    public static StringTag TAG_MAX_OPTIMIZE_SEGMENTS = new StringTag(\"maxOptimizeSegs\");\n+\n+    public static StringTag TAG_DOCS_SIZE = new StringTag(\"docsSize\");\n+    public static StringTag TAG_DELETE_VALUE = new StringTag(\"delete.by\");\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/commons/SolrjTags.java",
                "sha": "3040b850b5291ec1384c65711c2fa3a20aceaa0b",
                "status": "added"
            },
            {
                "additions": 64,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/HttpClientInstrumentation.java",
                "changes": 64,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/HttpClientInstrumentation.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/HttpClientInstrumentation.java",
                "patch": "@@ -0,0 +1,64 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import net.bytebuddy.matcher.ElementMatchers;\n+import org.apache.http.client.methods.HttpUriRequest;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.ClassInstanceMethodsEnhancePluginDefine;\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+import org.apache.skywalking.apm.agent.core.plugin.match.NameMatch;\n+\n+public class HttpClientInstrumentation extends ClassInstanceMethodsEnhancePluginDefine {\n+    private static String ENHANCE_CLASS = \"org.apache.http.impl.client.CloseableHttpClient\";\n+\n+    @Override\n+    protected ConstructorInterceptPoint[] getConstructorsInterceptPoints() {\n+        return new ConstructorInterceptPoint[]{};\n+    }\n+\n+    @Override\n+    protected InstanceMethodsInterceptPoint[] getInstanceMethodsInterceptPoints() {\n+        return new InstanceMethodsInterceptPoint[]{\n+            new InstanceMethodsInterceptPoint() {\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return ElementMatchers.named(\"execute\").and(ElementMatchers.takesArgument(0, HttpUriRequest.class));\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return \"org.apache.skywalking.apm.plugin.solrj.SolrConnectorInterceptor\";\n+                }\n+            }\n+        };\n+    }\n+\n+    @Override\n+    protected ClassMatch enhanceClass() {\n+        return NameMatch.byName(ENHANCE_CLASS);\n+    }\n+}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/HttpClientInstrumentation.java",
                "sha": "56e752b07282d5bedee2f6cdfc3707961f37c3f7",
                "status": "added"
            },
            {
                "additions": 75,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/SolrClientInstrumentation.java",
                "changes": 75,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/SolrClientInstrumentation.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/SolrClientInstrumentation.java",
                "patch": "@@ -0,0 +1,75 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.solrj.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import net.bytebuddy.matcher.ElementMatchers;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.ClassInstanceMethodsEnhancePluginDefine;\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+import org.apache.skywalking.apm.agent.core.plugin.match.NameMatch;\n+\n+public class SolrClientInstrumentation extends ClassInstanceMethodsEnhancePluginDefine {\n+\n+    @Override\n+    protected ConstructorInterceptPoint[] getConstructorsInterceptPoints() {\n+        return new ConstructorInterceptPoint[]{\n+            new ConstructorInterceptPoint() {\n+\n+                @Override\n+                public String getConstructorInterceptor() {\n+                    return \"org.apache.skywalking.apm.plugin.solrj.SolrClientInterceptor\";\n+                }\n+\n+                @Override\n+                public ElementMatcher<MethodDescription> getConstructorMatcher() {\n+                    return ElementMatchers.any();\n+                }\n+            }\n+        };\n+    }\n+\n+    @Override\n+    protected InstanceMethodsInterceptPoint[] getInstanceMethodsInterceptPoints() {\n+        return new InstanceMethodsInterceptPoint[]{\n+            new InstanceMethodsInterceptPoint() {\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return ElementMatchers.named(\"request\").and(ElementMatchers.takesArguments(3));\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return \"org.apache.skywalking.apm.plugin.solrj.SolrClientInterceptor\";\n+                }\n+            }\n+        };\n+    }\n+\n+    @Override\n+    protected ClassMatch enhanceClass() {\n+        return NameMatch.byName(\"org.apache.solr.client.solrj.impl.HttpSolrClient\");\n+    }\n+}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/solrj/define/SolrClientInstrumentation.java",
                "sha": "75f3a2e27b83c72e301c29dae91ddf8e5717527c",
                "status": "added"
            },
            {
                "additions": 18,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/resources/skywalking-plugin.def",
                "changes": 18,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/resources/skywalking-plugin.def?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/resources/skywalking-plugin.def",
                "patch": "@@ -0,0 +1,18 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+solrj-7.x=org.apache.skywalking.apm.plugin.solrj.define.SolrClientInstrumentation\n+solrj-7.x=org.apache.skywalking.apm.plugin.solrj.define.HttpClientInstrumentation\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/main/resources/skywalking-plugin.def",
                "sha": "fd2fd6cd0b67f5f4a98a1bde79440ecd817569f3",
                "status": "added"
            },
            {
                "additions": 428,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptorTest.java",
                "changes": 428,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptorTest.java?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptorTest.java",
                "patch": "@@ -0,0 +1,428 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.solrj;\n+\n+import com.google.common.collect.Lists;\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.test.helper.SegmentHelper;\n+import org.apache.skywalking.apm.agent.test.tools.*;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.solrj.commons.SolrjInstance;\n+import org.apache.solr.client.solrj.ResponseParser;\n+import org.apache.solr.client.solrj.SolrRequest;\n+import org.apache.solr.client.solrj.impl.HttpSolrClient;\n+import org.apache.solr.client.solrj.request.AbstractUpdateRequest;\n+import org.apache.solr.client.solrj.request.QueryRequest;\n+import org.apache.solr.client.solrj.request.UpdateRequest;\n+import org.apache.solr.common.*;\n+import org.apache.solr.common.params.ModifiableSolrParams;\n+import org.apache.solr.common.util.NamedList;\n+import org.junit.Assert;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.runner.RunWith;\n+import org.mockito.Mock;\n+import org.powermock.modules.junit4.PowerMockRunner;\n+import org.powermock.modules.junit4.PowerMockRunnerDelegate;\n+\n+import java.lang.reflect.Method;\n+import java.util.List;\n+\n+import static org.mockito.Mockito.when;\n+\n+@RunWith(PowerMockRunner.class)\n+@PowerMockRunnerDelegate(TracingSegmentRunner.class)\n+public class SolrClientInterceptorTest {\n+    SolrClientInterceptor interceptor = new SolrClientInterceptor();\n+\n+    @SegmentStoragePoint\n+    private SegmentStorage segmentStorage;\n+\n+    @Rule\n+    public AgentServiceRule serviceRule = new AgentServiceRule();\n+\n+    @Mock\n+    private HttpSolrClient client;\n+\n+    @Mock\n+    private Method method;\n+\n+    @Mock\n+    private EnhancedInstance enhancedInstance;\n+\n+    private Object[] arguments = null;\n+    private Class[] argumentType = new Class[] {\n+        SolrRequest.class,\n+        ResponseParser.class,\n+        String.class\n+    };\n+    private String collection = null;\n+    private HttpSolrClient.Builder builder;\n+\n+    @Mock\n+    private SolrjInstance instance;\n+    private NamedList<Object> header;\n+\n+    @Before\n+    public void setup() throws Exception {\n+        builder = new HttpSolrClient.Builder().withBaseSolrUrl(\"http://solr-server:8983/solr/collection\");\n+        enhancedInstance = new EnhanceHttpSolrClient(builder);\n+\n+        when(instance.getCollection()).thenReturn(\"collection\");\n+        when(instance.getRemotePeer()).thenReturn(\"solr-server:8983\");\n+        enhancedInstance.setSkyWalkingDynamicField(instance);\n+\n+        header = new NamedList<Object>();\n+        header.add(\"status\", 0);\n+        header.add(\"QTime\", 5);\n+\n+//        Config.Plugin.SolrJ.TRACE_STATEMENT = true;\n+//        Config.Plugin.SolrJ.TRACE_OPS_PARAMS = true;\n+    }\n+\n+\n+    @Test\n+    public void testConstructor() throws Throwable {\n+        arguments = new Object[] {builder};\n+        interceptor.onConstruct(enhancedInstance, arguments);\n+        SolrjInstance instance = (SolrjInstance) enhancedInstance.getSkyWalkingDynamicField();\n+        Assert.assertEquals(instance.getRemotePeer(), \"solr-server:8983\");\n+        Assert.assertEquals(instance.getCollection(), \"collection\");\n+    }\n+\n+\n+    @Test\n+    public void testUpdateWithAdd() throws Throwable {\n+        UpdateRequest request = new UpdateRequest();\n+        List<SolrInputDocument> docs = Lists.newArrayList();\n+        for (int start = 0; start < 100; start++) {\n+            SolrInputDocument doc = new SolrInputDocument();\n+            doc.addField(\"id\", start);\n+            docs.add(doc);\n+        }\n+        arguments = new Object[] {\n+            request.add(docs),\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        Assert.assertEquals(segments.size(), 1);\n+\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        int pox = 0;\n+        if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+            SpanAssert.assertTag(span, ++pox, \"100\");\n+        }\n+        if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+            SpanAssert.assertTag(span, ++pox, \"-1\");\n+        }\n+        spanCommonAssert(span, pox,\"solrJ/collection/update/ADD\");\n+    }\n+\n+    @Test\n+    public void testUpdateWithCommit() throws Throwable {\n+        final boolean softCommit = false;\n+        AbstractUpdateRequest request = (new UpdateRequest()).setAction(AbstractUpdateRequest.ACTION.COMMIT, true, true, false);\n+        arguments = new Object[]{\n+            request,\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        Assert.assertEquals(segments.size(), 1);\n+\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        int start = 0;\n+        AbstractTracingSpan span = spans.get(0);\n+        if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+            SpanAssert.assertTag(span, ++start, String.valueOf(softCommit));\n+        }\n+        spanCommonAssert(span, start, \"solrJ/collection/update/COMMIT\");\n+    }\n+\n+    @Test\n+    public void testUpdateWithOptimize() throws Throwable {\n+        final int maxSegments = 1;\n+        AbstractUpdateRequest request = (new UpdateRequest()).setAction(AbstractUpdateRequest.ACTION.OPTIMIZE, false, true, maxSegments);\n+        arguments = new Object[]{\n+            request,\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        int start = 0;\n+        if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+            SpanAssert.assertTag(span, ++start, String.valueOf(maxSegments));\n+        }\n+        spanCommonAssert(span, start, \"solrJ/collection/update/OPTIMIZE\");\n+    }\n+\n+    @Test\n+    public void testQuery() throws Throwable {\n+        QueryRequest request = new QueryRequest();\n+        arguments = new Object[] {\n+            request,\n+            null,\n+            collection\n+        };\n+\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getQueryResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        querySpanAssert(span, \"/select\", 100, \"solrJ/collection/select\");\n+    }\n+\n+    @Test\n+    public void testGet() throws Throwable {\n+        ModifiableSolrParams reqParams = new ModifiableSolrParams();\n+        if (StringUtils.isEmpty(reqParams.get(\"qt\"))) {\n+            reqParams.set(\"qt\", new String[]{\"/get\"});\n+        }\n+        reqParams.set(\"ids\", new String[] {\"99\", \"98\"});\n+        QueryRequest request = new QueryRequest(reqParams);\n+\n+        arguments = new Object[] {\n+            request,\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getGetResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        querySpanAssert(span, \"/get\", 1, \"solrJ/collection/get\");\n+    }\n+\n+    @Test\n+    public void testDeleteById() throws Throwable {\n+        UpdateRequest request = new UpdateRequest();\n+        arguments = new Object[] {\n+            request.deleteById(\"12\"),\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        spanDeleteAssert(span, \"solrJ/collection/update/DELETE_BY_IDS\", \"[12]\");\n+    }\n+\n+    @Test\n+    public void testDeleteByQuery() throws Throwable {\n+        UpdateRequest request = new UpdateRequest();\n+        arguments = new Object[] {\n+            request.deleteByQuery(\"id:[2 TO 5]\"),\n+            null,\n+            collection\n+        };\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, getResponse());\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        spanDeleteAssert(span, \"solrJ/collection/update/DELETE_BY_QUERY\", \"[id:[2 TO 5]]\");\n+    }\n+\n+    @Test\n+    public void testException() throws Throwable {\n+        QueryRequest request = new QueryRequest();\n+        arguments = new Object[] {\n+            request,\n+            null,\n+            collection\n+        };\n+        NamedList<Object> response = new NamedList<Object>();\n+        NamedList<Object> header = new NamedList<Object>();\n+        header.add(\"status\", 500);\n+        header.add(\"QTime\", 5);\n+        response.add(\"responseHeader\", header);\n+\n+        interceptor.beforeMethod(enhancedInstance, method, arguments, argumentType, null);\n+        interceptor.handleMethodException(enhancedInstance, method, arguments, argumentType,\n+                new SolrException(SolrException.ErrorCode.SERVER_ERROR, \"for test\",  new Exception()));\n+        interceptor.afterMethod(enhancedInstance, method, arguments, argumentType, response);\n+\n+        List<TraceSegment> segments = segmentStorage.getTraceSegments();\n+        List<AbstractTracingSpan> spans = SegmentHelper.getSpans(segments.get(0));\n+\n+        Assert.assertEquals(segments.size(), 1);\n+        Assert.assertEquals(spans.size(), 1);\n+\n+        AbstractTracingSpan span = spans.get(0);\n+        SpanAssert.assertOccurException(span, true);\n+    }\n+\n+\n+\n+    private void querySpanAssert(AbstractSpan span, String qt, int numFound, String operationName) {\n+        Assert.assertEquals(span.getOperationName(), operationName);\n+        SpanAssert.assertTag(span, 0, \"Solr\");\n+        SpanAssert.assertTag(span, 1, \"0\");\n+        SpanAssert.assertTag(span, 2, qt);\n+\n+        int start = 3;\n+        if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+            start++;\n+        }\n+        SpanAssert.assertTag(span, start++, \"5\");\n+        SpanAssert.assertTag(span, start++, String.valueOf(numFound));\n+    }\n+\n+    private void spanCommonAssert(AbstractSpan span, int start, String operationName) {\n+        SpanAssert.assertComponent(span, ComponentsDefine.SOLRJ);\n+        SpanAssert.assertOccurException(span, false);\n+        SpanAssert.assertLogSize(span, 0);\n+        SpanAssert.assertLayer(span, SpanLayer.DB);\n+\n+        SpanAssert.assertTag(span, 0, \"Solr\");\n+        SpanAssert.assertTag(span, start + 1, \"5\");\n+\n+        Assert.assertEquals(span.getOperationName(), operationName);\n+    }\n+\n+    private void spanDeleteAssert(AbstractSpan span, String operationName, String statement) {\n+        Assert.assertEquals(span.getOperationName(), operationName);\n+        SpanAssert.assertComponent(span, ComponentsDefine.SOLRJ);\n+        SpanAssert.assertOccurException(span, false);\n+        SpanAssert.assertLogSize(span, 0);\n+        SpanAssert.assertLayer(span, SpanLayer.DB);\n+\n+        SpanAssert.assertTag(span, 0, \"Solr\");\n+\n+        int start = 0;\n+        if (Config.Plugin.SolrJ.TRACE_STATEMENT) {\n+            SpanAssert.assertTag(span, ++start, statement);\n+        }\n+        if (Config.Plugin.SolrJ.TRACE_OPS_PARAMS) {\n+            SpanAssert.assertTag(span, ++start, \"-1\");\n+        }\n+\n+        SpanAssert.assertTag(span, start + 1, \"5\");\n+    }\n+\n+    private NamedList<Object> getResponse() {\n+        NamedList<Object> response = new NamedList<Object>();\n+        response.add(\"responseHeader\", header);\n+        return response;\n+    }\n+\n+    private NamedList<Object> getQueryResponse() {\n+        NamedList<Object> response = new NamedList<Object>();\n+        response.add(\"responseHeader\", header);\n+        SolrDocumentList list = new SolrDocumentList();\n+        list.setStart(0);\n+        list.setNumFound(100);\n+        list.setMaxScore(.0f);\n+\n+        for (int start = 0; start < 10; start++) {\n+            SolrDocument doc = new SolrDocument();\n+            doc.addField(\"id\", start);\n+            doc.addField(\"_version\", 1634676349644832768L);\n+            list.add(doc);\n+        }\n+        response.add(\"response\", list);\n+        return response;\n+    }\n+\n+    private NamedList<Object> getGetResponse() {\n+        NamedList<Object> response = new NamedList<Object>();\n+        response.add(\"responseHeader\", header);\n+        SolrDocumentList list = new SolrDocumentList();\n+        list.setStart(0);\n+        list.setNumFound(1);\n+        list.setMaxScore(.0f);\n+\n+        SolrDocument doc = new SolrDocument();\n+        doc.addField(\"id\", 1);\n+        doc.addField(\"_version\", 1634676349644832768L);\n+        list.add(doc);\n+\n+        response.add(\"response\", list);\n+        return response;\n+    }\n+\n+    class EnhanceHttpSolrClient extends HttpSolrClient implements EnhancedInstance {\n+        Object value = null;\n+\n+        protected EnhanceHttpSolrClient(Builder builder) {\n+            super(builder);\n+        }\n+\n+        @Override\n+        public Object getSkyWalkingDynamicField() {\n+            return value;\n+        }\n+\n+        @Override\n+        public void setSkyWalkingDynamicField(Object value) {\n+            this.value = value;\n+        }\n+    }\n+\n+}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/apm-sniffer/apm-sdk-plugin/solrj-7.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/solrj/SolrClientInterceptorTest.java",
                "sha": "c7311a8c6b884617add3cca28f1aac104c4df0c6",
                "status": "added"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/docs/en/setup/service-agent/java-agent/README.md",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/README.md?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "docs/en/setup/service-agent/java-agent/README.md",
                "patch": "@@ -82,6 +82,8 @@ property key | Description | Default |\n `plugin.elasticsearch.trace_dsl`|If true, trace all the DSL(Domain Specific Language) in ElasticSearch access, default is false.|`false`|\n `plugin.springmvc.use_qualified_name_as_endpoint_name`|If true, the fully qualified method name will be used as the endpoint name instead of the request URL, default is false.|`false`|\n `plugin.toolit.use_qualified_name_as_operation_name`|If true, the fully qualified method name will be used as the operation name instead of the given operation name, default is false.|`false`|\n+`plugin.solrj.trace_statement`|If true, trace all the query parameters(include deleteByIds and deleteByQuery) in Solr query request, default is false.|`false`|\n+`plugin.solrj.trace_ops_params`|If true, trace all the operation parameters in Solr request, default is false.|`false`|\n \n ## Optional Plugins\n Java agent plugins are all pluggable. Optional plugins could be provided in `optional-plugins` folder under agent or 3rd party repositores.",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/docs/en/setup/service-agent/java-agent/README.md",
                "sha": "9b727d5d2a2492be7b2aef047c2280c40f9b2d76",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/docs/en/setup/service-agent/java-agent/Supported-list.md",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/Supported-list.md?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "docs/en/setup/service-agent/java-agent/Supported-list.md",
                "patch": "@@ -53,6 +53,7 @@\n     * [Xmemcached](https://github.com/killme2008/xmemcached) 2.x\n   * [Elasticsearch](https://github.com/elastic/elasticsearch)\n     * [transport-client](https://github.com/elastic/elasticsearch/tree/master/client/transport) 5.2.x-5.6.x\n+  * [SolrJ](https://lucene.apache.org/solr) 7.0.0-7.7.1\n * Service Discovery\n   * [Netflix Eureka](https://github.com/Netflix/eureka)\n * Distributed Coordination",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/docs/en/setup/service-agent/java-agent/Supported-list.md",
                "sha": "dcfda3d8ca733087b8130aa1da3e844249107483",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/oap-server/server-core/src/test/resources/component-libraries.yml",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-core/src/test/resources/component-libraries.yml?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "oap-server/server-core/src/test/resources/component-libraries.yml",
                "patch": "@@ -198,6 +198,12 @@ spring-cloud-gateway:\n RESTEasy:\n   id: 62\n   languages: Java\n+SolrJ:\n+  id: 63\n+  languages: Java\n+Solr:\n+  id: 64\n+  languages: Java\n \n # .NET/.NET Core components\n # [3000, 4000) for C#/.NET only\n@@ -295,3 +301,4 @@ Component-Server-Mappings:\n   Pomelo.EntityFrameworkCore.MySql: Mysql\n   Npgsql.EntityFrameworkCore.PostgreSQL: PostgreSQL\n   transport-client: Elasticsearch\n+  SolrJ: Solr",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/oap-server/server-core/src/test/resources/component-libraries.yml",
                "sha": "86d29e5206138a66ebb5f043bc7f194cb58e4b9a",
                "status": "modified"
            },
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/oap-server/server-starter/src/main/resources/component-libraries.yml",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-starter/src/main/resources/component-libraries.yml?ref=6ae517423ce4ea3bbd523f80f56c685b9f8fc60e",
                "deletions": 0,
                "filename": "oap-server/server-starter/src/main/resources/component-libraries.yml",
                "patch": "@@ -216,6 +216,12 @@ spring-cloud-gateway:\n RESTEasy:\n   id: 62\n   languages: Java\n+SolrJ:\n+  id: 63\n+  languages: Java\n+Solr:\n+  id: 64\n+  languages: Java\n \n # .NET/.NET Core components\n # [3000, 4000) for C#/.NET only\n@@ -315,3 +321,4 @@ Component-Server-Mappings:\n   Pomelo.EntityFrameworkCore.MySql: Mysql\n   Npgsql.EntityFrameworkCore.PostgreSQL: PostgreSQL\n   transport-client: Elasticsearch\n+  SolrJ: Solr",
                "raw_url": "https://github.com/apache/skywalking/raw/6ae517423ce4ea3bbd523f80f56c685b9f8fc60e/oap-server/server-starter/src/main/resources/component-libraries.yml",
                "sha": "87e213f1ad7e3894ff977d85a338c37d4132a91e",
                "status": "modified"
            }
        ],
        "message": "Provide plugin for Solr-7.x(client) (#2730)\n\n* new branch for solrj-plugin\r\n\r\n* rollback and add module solrj-plugin\r\n\r\n* preparing to pr\r\n\r\n* to resolve reviewers' suggestions\r\n\r\n* remove unused code\r\n\r\n* remove unused code\r\n\r\n* remove unused comments\r\n\r\n* To avoid NPE\r\n\r\n* fix typo\r\n\r\n* Change to JRE6\r\n\r\n* fix pom.xml merge incorrectly. and java.net.URL instead of Regex\r\n\r\n* Using RuntimeContext instead of ThreadLocal\r\n\r\n* To reduce unnecessary tags\r\n\r\n* add test cases\r\n\r\n* fix validation fail\r\n\r\n* add solrj-plugin into component-libraries & Supported-list\r\n\r\n* to trace all patch to avoid recheck status of span\r\n\r\n* remove unnecessary properites\r\n\r\n* remove unnecessary tags\r\n\r\n* Add the config to document of setup",
        "parent": "https://github.com/apache/skywalking/commit/3217ff1444a922a9f57fde64e5d73bbd8fcefe5c",
        "patched_files": [
            "ComponentsDefine.java",
            "SolrClientInstrumentation.java",
            "Supported-list.java",
            "SolrConnectorInterceptor.java",
            "SolrClientInterceptor.java",
            "Config.java",
            "skywalking-plugin.java",
            "README.java",
            "SolrjTags.java",
            "pom.java",
            "component-libraries.java",
            "HttpClientInstrumentation.java",
            "SolrjInstance.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "SolrClientInterceptorTest.java"
        ]
    },
    "skywalking_6b99abf": {
        "bug_id": "skywalking_6b99abf",
        "commit": "https://github.com/apache/skywalking/commit/6b99abffff801cc7bfd6ce32919329b1acb0bd8a",
        "file": [
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/skywalking/blob/6b99abffff801cc7bfd6ce32919329b1acb0bd8a/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java?ref=6b99abffff801cc7bfd6ce32919329b1acb0bd8a",
                "deletions": 23,
                "filename": "apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "patch": "@@ -18,23 +18,14 @@\n \n package org.apache.skywalking.apm.plugin.httpClient.v4;\n \n-import org.apache.http.HttpHost;\n-import org.apache.http.HttpRequest;\n-import org.apache.http.HttpResponse;\n-import org.apache.http.StatusLine;\n-import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n-import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n-import org.apache.skywalking.apm.agent.core.context.ContextManager;\n-import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n-import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n-import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-\n import java.lang.reflect.Method;\n import java.net.URL;\n+import org.apache.http.*;\n+import org.apache.skywalking.apm.agent.core.context.*;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.*;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.*;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n \n public class HttpClientExecuteInterceptor implements InstanceMethodsAroundInterceptor {\n \n@@ -73,16 +64,19 @@\n             return ret;\n         }\n \n-        HttpResponse response = (HttpResponse)ret;\n-        StatusLine responseStatusLine = response.getStatusLine();\n-        if (responseStatusLine != null) {\n-            int statusCode = responseStatusLine.getStatusCode();\n-            AbstractSpan span = ContextManager.activeSpan();\n-            if (statusCode >= 400) {\n-                span.errorOccurred();\n-                Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+        if (ret != null) {\n+            HttpResponse response = (HttpResponse)ret;\n+            StatusLine responseStatusLine = response.getStatusLine();\n+            if (responseStatusLine != null) {\n+                int statusCode = responseStatusLine.getStatusCode();\n+                AbstractSpan span = ContextManager.activeSpan();\n+                if (statusCode >= 400) {\n+                    span.errorOccurred();\n+                    Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+                }\n             }\n         }\n+        \n         ContextManager.stopSpan();\n         return ret;\n     }",
                "raw_url": "https://github.com/apache/skywalking/raw/6b99abffff801cc7bfd6ce32919329b1acb0bd8a/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "sha": "5d2cf2908385e48480b964e87fc337008267d810",
                "status": "modified"
            }
        ],
        "message": "[Agent] Apache http client plugin bug (#1448) (#1452)\n\n* #1447\r\n\r\nFixed the after method interceptor for the apache http client NPE error when the response is null cause by the doExecute method throw a exception.",
        "parent": "https://github.com/apache/skywalking/commit/86bb1c05e420b8e11ab137775fc0a0f0790cb28e",
        "patched_files": [
            "HttpClientExecuteInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "HttpClientExecuteInterceptorTest.java"
        ]
    },
    "skywalking_6ffd927": {
        "bug_id": "skywalking_6ffd927",
        "commit": "https://github.com/apache/skywalking/commit/6ffd92792d176b9af2562dd1d165576d05542c48",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/Jenkinsfile-Agent-Test-2",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/Jenkinsfile-Agent-Test-2?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 1,
                "filename": "Jenkinsfile-Agent-Test-2",
                "patch": "@@ -67,7 +67,7 @@ pipeline {\n                 sh './mvnw -f test/plugin/pom.xml clean package -DskipTests docker:build'\n             }\n         }\n-        stage('Test Cases Report (136)') {\n+        stage('Test Cases Report (146)') {\n             steps {\n                 echo \"Test Cases Report\"\n             }\n@@ -82,6 +82,12 @@ pipeline {\n             parallel {\n                 stage('Group1') {\n                     stages {\n+                        stage('spring-tx 4.x+ (10)') {\n+                            steps {\n+                                sh 'bash test/plugin/run.sh spring-tx-scenario'\n+                            }\n+                        }\n+\n                         stage('spring 4.3.x-5.2.x (54)') {\n                             steps {\n                                 sh 'bash test/plugin/run.sh spring-4.3.x-scenario'",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/Jenkinsfile-Agent-Test-2",
                "sha": "eb15e93e4799649afd9993f084c2b5a5a4368d55",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "patch": "@@ -145,4 +145,6 @@\n     public static final OfficialComponent SOCKET_IO = new OfficialComponent(76, \"SocketIO\");\n \n     public static final OfficialComponent REST_HIGH_LEVEL_CLIENT = new OfficialComponent(77, \"rest-high-level-client\");\n+\n+    public static final OfficialComponent SPRING_TX = new OfficialComponent(78, \"spring-tx\");\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-protocol/apm-network/src/main/java/org/apache/skywalking/apm/network/trace/component/ComponentsDefine.java",
                "sha": "6d1eedfeeb39a3be3eacc2687d4eb761602425aa",
                "status": "modified"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "changes": 8,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "patch": "@@ -330,5 +330,13 @@\n              */\n             public static boolean TRACE_HANDLER_CHAIN = false;\n         }\n+\n+        public static class SpringTransaction {\n+\n+            /**\n+             * If true, the transaction definition name will be simplified\n+             */\n+            public static boolean SIMPLIFY_TRANSACTION_DEFINITION_NAME = false;\n+        }\n     }\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/apm-agent-core/src/main/java/org/apache/skywalking/apm/agent/core/conf/Config.java",
                "sha": "89632bd7f30e773ade391a79ca6f0994029011e4",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/pom.xml",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/pom.xml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/pom.xml",
                "patch": "@@ -30,6 +30,7 @@\n \n     <modules>\n         <module>spring-annotation-plugin</module>\n+        <module>spring-tx-plugin</module>\n         <module>optional-spring-cloud</module>\n     </modules>\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/pom.xml",
                "sha": "3284106e16194dc1a76b6e530fcd1032fa2bb22c",
                "status": "modified"
            },
            {
                "additions": 43,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/pom.xml",
                "changes": 43,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/pom.xml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/pom.xml",
                "patch": "@@ -0,0 +1,43 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <parent>\n+        <artifactId>optional-spring-plugins</artifactId>\n+        <groupId>org.apache.skywalking</groupId>\n+        <version>6.6.0-SNAPSHOT</version>\n+    </parent>\n+    <modelVersion>4.0.0</modelVersion>\n+    <packaging>jar</packaging>\n+\n+    <artifactId>apm-spring-tx-plugin</artifactId>\n+\n+    <properties>\n+        <spring-tx.version>5.1.2.RELEASE</spring-tx.version>\n+    </properties>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.springframework</groupId>\n+            <artifactId>spring-tx</artifactId>\n+            <version>${spring-tx.version}</version>\n+            <scope>provided</scope>\n+        </dependency>\n+    </dependencies>\n+</project>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/pom.xml",
                "sha": "04b7e9e08f3def421452c6dfab0e1f177c8ba163",
                "status": "added"
            },
            {
                "additions": 59,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/EndTransactionMethodInterceptor.java",
                "changes": 59,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/EndTransactionMethodInterceptor.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/EndTransactionMethodInterceptor.java",
                "patch": "@@ -0,0 +1,59 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.spring.transaction;\n+\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.spring.transaction.context.Constants;\n+import org.springframework.transaction.TransactionStatus;\n+\n+import java.lang.reflect.Method;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class EndTransactionMethodInterceptor implements InstanceMethodsAroundInterceptor {\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                             MethodInterceptResult result) throws Throwable {\n+        AbstractSpan span = ContextManager.createLocalSpan(Constants.OPERATION_NAME_SPRING_TRANSACTION_PREFIX + method.getName());\n+        TransactionStatus status = (TransactionStatus) allArguments[0];\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_IS_NEW_TRANSACTION, String.valueOf(status.isNewTransaction()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_HAS_SAVEPOINT, String.valueOf(status.hasSavepoint()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_ROLLBACK_ONLY, String.valueOf(status.isRollbackOnly()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_IS_COMPLETED, String.valueOf(status.isCompleted()));\n+        span.setComponent(ComponentsDefine.SPRING_TX);\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                              Object ret) throws Throwable {\n+        ContextManager.stopSpan();\n+        return ret;\n+    }\n+\n+    @Override\n+    public void handleMethodException(EnhancedInstance objInst, Method method, Object[] allArguments,\n+                                      Class<?>[] argumentsTypes, Throwable t) {\n+        ContextManager.activeSpan().errorOccurred().log(t);\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/EndTransactionMethodInterceptor.java",
                "sha": "f3ea9df55ec1bfa72e9e7f9979d92b1556ce2f3f",
                "status": "added"
            },
            {
                "additions": 81,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/GetTransactionMethodInterceptor.java",
                "changes": 81,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/GetTransactionMethodInterceptor.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/GetTransactionMethodInterceptor.java",
                "patch": "@@ -0,0 +1,81 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.spring.transaction;\n+\n+import org.apache.skywalking.apm.agent.core.conf.Config;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n+import org.apache.skywalking.apm.plugin.spring.transaction.context.Constants;\n+import org.springframework.transaction.TransactionDefinition;\n+\n+import java.lang.reflect.Method;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class GetTransactionMethodInterceptor implements InstanceMethodsAroundInterceptor {\n+    @Override\n+    public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                             MethodInterceptResult result) throws Throwable {\n+        if (allArguments[0] == null) {\n+            AbstractSpan span = ContextManager.createLocalSpan(Constants.OPERATION_NAME_SPRING_TRANSACTION_NO_TRANSACTION_DEFINITION_GIVEN);\n+            span.setComponent(ComponentsDefine.SPRING_TX);\n+            return;\n+        }\n+        TransactionDefinition definition = (TransactionDefinition) allArguments[0];\n+        AbstractSpan span = ContextManager.createLocalSpan(Constants.OPERATION_NAME_SPRING_TRANSACTION_GET_TRANSACTION_METHOD + buildOperationName(definition.getName()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_ISOLATION_LEVEL, String.valueOf(definition.getIsolationLevel()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_PROPAGATION_BEHAVIOR, String.valueOf(definition.getPropagationBehavior()));\n+        span.tag(Constants.TAG_SPRING_TRANSACTION_TIMEOUT, String.valueOf(definition.getTimeout()));\n+        span.setComponent(ComponentsDefine.SPRING_TX);\n+    }\n+\n+    @Override\n+    public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n+                              Object ret) throws Throwable {\n+        ContextManager.stopSpan();\n+        return ret;\n+    }\n+\n+    @Override\n+    public void handleMethodException(EnhancedInstance objInst, Method method, Object[] allArguments,\n+                                      Class<?>[] argumentsTypes, Throwable t) {\n+        ContextManager.activeSpan().errorOccurred().log(t);\n+    }\n+\n+    private String buildOperationName(String transactionDefinitionName) {\n+        if (!Config.Plugin.SpringTransaction.SIMPLIFY_TRANSACTION_DEFINITION_NAME) {\n+            return transactionDefinitionName;\n+        }\n+        String[] ss = transactionDefinitionName.split(\"\\\\.\");\n+\n+        int simplifiedLength = ss.length - 2;\n+        if (simplifiedLength < 0) {\n+            return transactionDefinitionName;\n+        }\n+        StringBuilder name = new StringBuilder();\n+        for (int i = 0; i < ss.length - 1; i++) {\n+            name.append(i < simplifiedLength ? ss[i].charAt(0) : ss[i]).append(\".\");\n+        }\n+        return name.append(ss[ss.length - 1]).toString();\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/GetTransactionMethodInterceptor.java",
                "sha": "64059b9da21790598e47c4d9ba6f7426927c6bb2",
                "status": "added"
            },
            {
                "additions": 35,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/context/Constants.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/context/Constants.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/context/Constants.java",
                "patch": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package org.apache.skywalking.apm.plugin.spring.transaction.context;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+\n+public interface Constants {\n+    String OPERATION_NAME_SPRING_TRANSACTION_PREFIX = \"TX/\";\n+    String OPERATION_NAME_SPRING_TRANSACTION_GET_TRANSACTION_METHOD = OPERATION_NAME_SPRING_TRANSACTION_PREFIX + \"get/\";\n+    String OPERATION_NAME_SPRING_TRANSACTION_NO_TRANSACTION_DEFINITION_GIVEN = OPERATION_NAME_SPRING_TRANSACTION_GET_TRANSACTION_METHOD + \"noTransactionDefinitionGiven\";\n+    String TAG_SPRING_TRANSACTION_ISOLATION_LEVEL = \"isolationLevel\";\n+    String TAG_SPRING_TRANSACTION_PROPAGATION_BEHAVIOR = \"propagationBehavior\";\n+    String TAG_SPRING_TRANSACTION_TIMEOUT = \"timeout\";\n+    String TAG_SPRING_TRANSACTION_IS_NEW_TRANSACTION = \"isNewTransaction\";\n+    String TAG_SPRING_TRANSACTION_HAS_SAVEPOINT = \"hasSavepoint\";\n+    String TAG_SPRING_TRANSACTION_ROLLBACK_ONLY = \"rollbackOnly\";\n+    String TAG_SPRING_TRANSACTION_IS_COMPLETED = \"isCompleted\";\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/context/Constants.java",
                "sha": "37001362aafc8d547d63be0d8e733dedd8f7ab8d",
                "status": "added"
            },
            {
                "additions": 80,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/define/AbstractPlatformTransactionManagerInstrumentation.java",
                "changes": 80,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/define/AbstractPlatformTransactionManagerInstrumentation.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/define/AbstractPlatformTransactionManagerInstrumentation.java",
                "patch": "@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ */\n+package org.apache.skywalking.apm.plugin.spring.transaction.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.ClassInstanceMethodsEnhancePluginDefine;\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+public class AbstractPlatformTransactionManagerInstrumentation extends ClassInstanceMethodsEnhancePluginDefine {\n+\n+    @Override\n+    public ConstructorInterceptPoint[] getConstructorsInterceptPoints() {\n+        return new ConstructorInterceptPoint[0];\n+    }\n+\n+    @Override\n+    public InstanceMethodsInterceptPoint[] getInstanceMethodsInterceptPoints() {\n+        return new InstanceMethodsInterceptPoint[]{\n+            new InstanceMethodsInterceptPoint() {\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return named(\"getTransaction\");\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return \"org.apache.skywalking.apm.plugin.spring.transaction.GetTransactionMethodInterceptor\";\n+                }\n+\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+            }, new InstanceMethodsInterceptPoint() {\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return named(\"commit\").or(named(\"rollback\"));\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return \"org.apache.skywalking.apm.plugin.spring.transaction.EndTransactionMethodInterceptor\";\n+                }\n+\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+            }\n+        };\n+    }\n+\n+    @Override\n+    public ClassMatch enhanceClass() {\n+        return byName(\"org.springframework.transaction.support.AbstractPlatformTransactionManager\");\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/transaction/define/AbstractPlatformTransactionManagerInstrumentation.java",
                "sha": "5b1372a47ad9cfc7b8c424408e8171aa6894487f",
                "status": "added"
            },
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/resources/skywalking-plugin.def",
                "changes": 17,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/resources/skywalking-plugin.def?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/resources/skywalking-plugin.def",
                "patch": "@@ -0,0 +1,17 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+spring-tx=org.apache.skywalking.apm.plugin.spring.transaction.define.AbstractPlatformTransactionManagerInstrumentation",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/apm-sniffer/optional-plugins/optional-spring-plugins/spring-tx-plugin/src/main/resources/skywalking-plugin.def",
                "sha": "2eae6963851649a8215640fa6a362607a46573ac",
                "status": "added"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/guides/Plugin-test.md",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/guides/Plugin-test.md?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 1,
                "filename": "docs/en/guides/Plugin-test.md",
                "patch": "@@ -630,9 +630,10 @@ canal 1.0.24-1.1.2 | 5 | 214.05\n \n \n ### Workload 2\n-#### Group 1 (2351.54s)\n+#### Group 1 (2906.54s)\n scenario name | versions | elapsed time (sec)\n ---|---|---\n+spring-tx 4.x+ | 10 | 555.00\n spring 4.3.x-5.2.x | 54 | 1769.32\n dubbo 2.5.x-2.6.x | 10 | 367.23\n dubbo 2.7.x | 4 | 214.99",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/guides/Plugin-test.md",
                "sha": "193cc992c7830eb68cfff00cee16b0973b03d098",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/setup/service-agent/java-agent/README.md",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/README.md?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "docs/en/setup/service-agent/java-agent/README.md",
                "patch": "@@ -109,6 +109,7 @@ property key | Description | Default |\n `plugin.solrj.trace_ops_params`|If true, trace all the operation parameters in Solr request, default is false.|`false`|\n `plugin.light4j.trace_handler_chain`|If true, trace all middleware/business handlers that are part of the Light4J handler chain for a request.|false|\n `plugin.opgroup.*`|Support operation name customize group rules in different plugins. Read [Group rule supported plugins](op_name_group_rule.md)|Not set|\n+`plugin.springtransaction.simplify_transaction_definition_name`|If true, the transaction definition name will be simplified.|false|\n \n ## Optional Plugins\n Java agent plugins are all pluggable. Optional plugins could be provided in `optional-plugins` folder under agent or 3rd party repositories.\n@@ -124,6 +125,7 @@ Now, we have the following known optional plugins.\n * [Customize enhance](Customize-enhance-trace.md) Trace methods based on description files, rather than write plugin or change source codes.\n * Plugin of Spring Cloud Gateway 2.1.x in optional plugin folder. Please only active this plugin when you install agent in Spring Gateway.\n * Plugin of [Play Framework](https://www.playframework.com/) 2.6+ (JDK 1.8 required & Scala 2.12/2.13) in optional plugin folder. Please only active this plugin when you install agent in [Play Framework](https://www.playframework.com/). \n+* Plugin of Spring Transaction in optional plugin folder. The reason of being optional plugin is, many local span are generated, which also spend more CPU, memory and network.\n \n ## Bootstrap class plugins\n All bootstrap plugins are optional, due to unexpected risk. Bootstrap plugins are provided in `bootstrap-plugins` folder.",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/setup/service-agent/java-agent/README.md",
                "sha": "b478a2fda8e5bcf21bb49938480d482271757472",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/setup/service-agent/java-agent/Supported-list.md",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/docs/en/setup/service-agent/java-agent/Supported-list.md?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "docs/en/setup/service-agent/java-agent/Supported-list.md",
                "patch": "@@ -70,6 +70,7 @@\n * Spring Ecosystem\n   * Spring Bean annotations(@Bean, @Service, @Component, @Repository) 3.x and 4.x (Optional\u00b2)\n   * Spring Core Async SuccessCallback/FailureCallback/ListenableFutureCallback 4.x\n+  * Spring Transaction 4.x and 5.x (Optional\u00b2)\n * [Hystrix: Latency and Fault Tolerance for Distributed Systems](https://github.com/Netflix/Hystrix) 1.4.20 -> 1.5.12\n * Scheduler\n   * [Elastic Job](https://github.com/elasticjob/elastic-job) 2.x",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/docs/en/setup/service-agent/java-agent/Supported-list.md",
                "sha": "e14c23d3df4ec467b834f817725f3cc652471c08",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/oap-server/server-core/src/test/resources/component-libraries.yml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-core/src/test/resources/component-libraries.yml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "oap-server/server-core/src/test/resources/component-libraries.yml",
                "patch": "@@ -233,6 +233,9 @@ SocketIO:\n rest-high-level-client:\n   id: 77\n   languages: Java\n+spring-tx:\n+  id: 78\n+  languages: Java\n \n # .NET/.NET Core components\n # [3000, 4000) for C#/.NET only",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/oap-server/server-core/src/test/resources/component-libraries.yml",
                "sha": "fe1aa1f625124ad6b80629fd3ac3df15ae9fed22",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/oap-server/server-starter/src/main/resources/component-libraries.yml",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/oap-server/server-starter/src/main/resources/component-libraries.yml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "oap-server/server-starter/src/main/resources/component-libraries.yml",
                "patch": "@@ -260,6 +260,9 @@ SocketIO:\n rest-high-level-client:\n   id: 77\n   languages: Java\n+spring-tx:\n+  id: 78\n+  languages: Java\n \n # .NET/.NET Core components\n # [3000, 4000) for C#/.NET only",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/oap-server/server-starter/src/main/resources/component-libraries.yml",
                "sha": "1f8f73d84ffb0c6b14c3a5aa7f5c76ba80c73caa",
                "status": "modified"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/bin/startup.sh",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/bin/startup.sh?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/bin/startup.sh",
                "patch": "@@ -0,0 +1,21 @@\n+#!/bin/bash\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+home=\"$(cd \"$(dirname $0)\"; pwd)\"\n+\n+java -Dmysql.servers=${MYSQL_SERVERS} -Dskywalking.plugin.springtransaction.simplify_transaction_definition_name=true -jar ${agent_opts} ${home}/../libs/spring-tx-scenario.jar &\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/bin/startup.sh",
                "sha": "012d0342fd5a3102979363c6d6ed59d17a8c3797",
                "status": "added"
            },
            {
                "additions": 168,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "changes": 168,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "patch": "@@ -0,0 +1,168 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+registryItems:\n+  applications:\n+    - {spring-tx-scenario: 2}\n+  instances:\n+    - {spring-tx-scenario: 1}\n+  operationNames:\n+    - spring-tx-scenario: [Mysql/JDBI/Statement/execute, Mysql/JDBI/Connection/commit,\n+                           Mysql/JDBI/PreparedStatement/executeUpdate, /case/spring-tx-case, /case/healthCheck,\n+                           Mysql/JDBI/Connection/close, Mysql/JDBI/Statement/executeQuery]\n+  heartbeat: []\n+segmentItems:\n+  - applicationCode: spring-tx-scenario\n+    segmentSize: nq 0\n+    segments:\n+      - segmentId: not null\n+        spans:\n+          - operationName: TX/get/t.o.a.s.a.t.s.t.s.i.DemoServiceImpl.doBiz\n+            operationId: 0\n+            parentSpanId: 0\n+            spanId: 1\n+            spanLayer: Unknown\n+            startTime: not null\n+            endTime: not null\n+            componentId: 78\n+            componentName: ''\n+            isError: false\n+            spanType: Local\n+            peer: ''\n+            peerId: 0\n+            tags:\n+              - {key: isolationLevel, value: '-1'}\n+              - {key: propagationBehavior, value: '0'}\n+              - {key: timeout, value: '-1'}\n+          - operationName: Mysql/JDBI/PreparedStatement/executeUpdate\n+            operationId: 0\n+            parentSpanId: 0\n+            spanId: 2\n+            spanLayer: Database\n+            startTime: not null\n+            endTime: not null\n+            componentId: 33\n+            componentName: ''\n+            isError: false\n+            spanType: Exit\n+            peer: mysql:3306\n+            peerId: 0\n+            tags:\n+              - {key: db.type, value: sql}\n+              - {key: db.instance, value: ''}\n+              - {key: db.statement, value: 'insert into `test`.`table_demo`(name) values(?)'}\n+          - operationName: Mysql/JDBI/PreparedStatement/executeUpdate\n+            operationId: 0\n+            parentSpanId: 0\n+            spanId: 3\n+            spanLayer: Database\n+            startTime: not null\n+            endTime: not null\n+            componentId: 33\n+            componentName: ''\n+            isError: false\n+            spanType: Exit\n+            peer: mysql:3306\n+            peerId: 0\n+            tags:\n+              - {key: db.type, value: sql}\n+              - {key: db.instance, value: ''}\n+              - {key: db.statement, value: 'insert into `test`.`table_demo`(name) values(?)'}\n+          - operationName: Mysql/JDBI/Connection/commit\n+            operationId: 0\n+            parentSpanId: 4\n+            spanId: 5\n+            spanLayer: Database\n+            startTime: not null\n+            endTime: not null\n+            componentId: 33\n+            componentName: ''\n+            isError: false\n+            spanType: Exit\n+            peer: mysql:3306\n+            peerId: 0\n+            tags:\n+              - {key: db.type, value: sql}\n+              - {key: db.instance, value: ''}\n+              - {key: db.statement, value: ''}\n+          - operationName: Mysql/JDBI/Statement/executeQuery\n+            operationId: 0\n+            parentSpanId: 4\n+            spanId: 6\n+            spanLayer: Database\n+            startTime: not null\n+            endTime: not null\n+            componentId: 33\n+            componentName: ''\n+            isError: false\n+            spanType: Exit\n+            peer: mysql:3306\n+            peerId: 0\n+            tags:\n+              - {key: db.type, value: sql}\n+              - {key: db.instance, value: ''}\n+              - {key: db.statement, value: select @@session.tx_read_only}\n+          - operationName: Mysql/JDBI/Connection/close\n+            operationId: 0\n+            parentSpanId: 4\n+            spanId: 7\n+            spanLayer: Database\n+            startTime: not null\n+            endTime: not null\n+            componentId: 33\n+            componentName: ''\n+            isError: false\n+            spanType: Exit\n+            peer: mysql:3306\n+            peerId: 0\n+            tags:\n+              - {key: db.type, value: sql}\n+              - {key: db.instance, value: ''}\n+              - {key: db.statement, value: ''}\n+          - operationName: TX/commit\n+            operationId: 0\n+            parentSpanId: 0\n+            spanId: 4\n+            spanLayer: Unknown\n+            startTime: not null\n+            endTime: not null\n+            componentId: 78\n+            componentName: ''\n+            isError: false\n+            spanType: Local\n+            peer: ''\n+            peerId: 0\n+            tags:\n+              - {key: isNewTransaction, value: 'true'}\n+              - {key: hasSavepoint, value: 'false'}\n+              - {key: rollbackOnly, value: 'false'}\n+              - {key: isCompleted, value: 'false'}\n+          - operationName: /case/spring-tx-case\n+            operationId: 0\n+            parentSpanId: -1\n+            spanId: 0\n+            spanLayer: Http\n+            startTime: not null\n+            endTime: not null\n+            componentId: 14\n+            componentName: ''\n+            isError: false\n+            spanType: Entry\n+            peer: ''\n+            peerId: 0\n+            tags:\n+              - {key: url, value: 'http://localhost:8080/spring-tx-scenario/case/spring-tx-case'}\n+              - {key: http.method, value: GET}\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/config/expectedData.yaml",
                "sha": "72cf9955a8e813ad91435f38c3847730a08c35a1",
                "status": "added"
            },
            {
                "additions": 34,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/configuration.yml",
                "changes": 34,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/configuration.yml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/configuration.yml",
                "patch": "@@ -0,0 +1,34 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+type: jvm\n+entryService: http://localhost:8080/spring-tx-scenario/case/spring-tx-case\n+healthCheck: http://localhost:8080/spring-tx-scenario/case/healthCheck\n+startScript: ./bin/startup.sh\n+framework: spring-tx\n+runningMode: with_optional\n+withPlugins: apm-spring-tx-plugin-*.jar\n+environment:\n+  - MYSQL_SERVERS=mysql:3306\n+  - MYSQL_DATABASE=test\n+depends_on:\n+  - mysql\n+dependencies:\n+  mysql:\n+    image: mysql:5.6\n+    hostname: mysql\n+    environment:\n+      - MYSQL_ROOT_PASSWORD=000000\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/configuration.yml",
                "sha": "56a0b875e35298c7b2393e777e683a4970e61039",
                "status": "added"
            },
            {
                "additions": 109,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/pom.xml",
                "changes": 109,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/pom.xml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/pom.xml",
                "patch": "@@ -0,0 +1,109 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+    <modelVersion>4.0.0</modelVersion>\n+\n+    <groupId>org.apache.skywalking</groupId>\n+    <artifactId>spring-tx-scenario</artifactId>\n+    <version>5.0.0</version>\n+\n+    <properties>\n+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n+        <compiler.version>1.8</compiler.version>\n+        <test.framework.version>2.0.0.RELEASE</test.framework.version>\n+        <docker.image.version>${test.framework.version}</docker.image.version>\n+    </properties>\n+\n+    <name>skywalking-spring-tx-scenario</name>\n+\n+    <dependencies>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-web</artifactId>\n+            <version>${test.framework.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.springframework.boot</groupId>\n+            <artifactId>spring-boot-starter-jdbc</artifactId>\n+            <version>${test.framework.version}</version>\n+        </dependency>\n+        <dependency>\n+            <groupId>mysql</groupId>\n+            <artifactId>mysql-connector-java</artifactId>\n+            <version>6.0.6</version>\n+        </dependency>\n+    </dependencies>\n+\n+    <build>\n+        <finalName>spring-tx-scenario</finalName>\n+        <plugins>\n+            <plugin>\n+                <groupId>org.springframework.boot</groupId>\n+                <artifactId>spring-boot-maven-plugin</artifactId>\n+                <executions>\n+                    <execution>\n+                        <goals>\n+                            <goal>repackage</goal>\n+                        </goals>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+            <plugin>\n+                <artifactId>maven-compiler-plugin</artifactId>\n+                <configuration>\n+                    <source>${compiler.version}</source>\n+                    <target>${compiler.version}</target>\n+                    <encoding>${project.build.sourceEncoding}</encoding>\n+                </configuration>\n+            </plugin>\n+            <plugin>\n+                <groupId>org.apache.maven.plugins</groupId>\n+                <artifactId>maven-assembly-plugin</artifactId>\n+                <executions>\n+                    <execution>\n+                        <id>assemble</id>\n+                        <phase>package</phase>\n+                        <goals>\n+                            <goal>single</goal>\n+                        </goals>\n+                        <configuration>\n+                            <descriptors>\n+                                <descriptor>src/main/assembly/assembly.xml</descriptor>\n+                            </descriptors>\n+                            <outputDirectory>./target/</outputDirectory>\n+                        </configuration>\n+                    </execution>\n+                </executions>\n+            </plugin>\n+        </plugins>\n+    </build>\n+\n+    <pluginRepositories>\n+        <pluginRepository>\n+            <id>spring-snapshots</id>\n+            <url>http://repo.spring.io/snapshot</url>\n+        </pluginRepository>\n+        <pluginRepository>\n+            <id>spring-milestones</id>\n+            <url>http://repo.spring.io/milestone</url>\n+        </pluginRepository>\n+    </pluginRepositories>\n+</project>\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/pom.xml",
                "sha": "b622b1a7a2c301e9d09b534f1b467f51eeabaea3",
                "status": "added"
            },
            {
                "additions": 41,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/assembly/assembly.xml",
                "changes": 41,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/assembly/assembly.xml?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/assembly/assembly.xml",
                "patch": "@@ -0,0 +1,41 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+  ~ Licensed to the Apache Software Foundation (ASF) under one or more\n+  ~ contributor license agreements.  See the NOTICE file distributed with\n+  ~ this work for additional information regarding copyright ownership.\n+  ~ The ASF licenses this file to You under the Apache License, Version 2.0\n+  ~ (the \"License\"); you may not use this file except in compliance with\n+  ~ the License.  You may obtain a copy of the License at\n+  ~\n+  ~     http://www.apache.org/licenses/LICENSE-2.0\n+  ~\n+  ~ Unless required by applicable law or agreed to in writing, software\n+  ~ distributed under the License is distributed on an \"AS IS\" BASIS,\n+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+  ~ See the License for the specific language governing permissions and\n+  ~ limitations under the License.\n+  ~\n+  -->\n+<assembly\n+        xmlns=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2\"\n+        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+        xsi:schemaLocation=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd\">\n+    <formats>\n+        <format>zip</format>\n+    </formats>\n+\n+    <fileSets>\n+        <fileSet>\n+            <directory>./bin</directory>\n+            <fileMode>0775</fileMode>\n+        </fileSet>\n+    </fileSets>\n+\n+    <files>\n+        <file>\n+            <source>${project.build.directory}/spring-tx-scenario.jar</source>\n+            <outputDirectory>./libs</outputDirectory>\n+            <fileMode>0775</fileMode>\n+        </file>\n+    </files>\n+</assembly>",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/assembly/assembly.xml",
                "sha": "f3feb135aee7717e0f951a16a775c66b4373020d",
                "status": "added"
            },
            {
                "additions": 35,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/Application.java",
                "changes": 35,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/Application.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/Application.java",
                "patch": "@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction;\n+\n+import org.springframework.boot.SpringApplication;\n+import org.springframework.boot.autoconfigure.SpringBootApplication;\n+import org.springframework.transaction.annotation.EnableTransactionManagement;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@SpringBootApplication\n+@EnableTransactionManagement\n+public class Application {\n+\n+    public static void main(String[] args) {\n+        SpringApplication.run(Application.class, args);\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/Application.java",
                "sha": "406530bcdcb026a49336808c24812eddd13c9961",
                "status": "added"
            },
            {
                "additions": 53,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/JdbcConfig.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/JdbcConfig.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/JdbcConfig.java",
                "patch": "@@ -0,0 +1,53 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.config;\n+\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.jdbc.core.JdbcTemplate;\n+import org.springframework.jdbc.datasource.DriverManagerDataSource;\n+\n+import javax.sql.DataSource;\n+\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@Configuration\n+public class JdbcConfig {\n+\n+    @Value(\"${mysql.servers}\")\n+    private String url;\n+\n+    @Bean(name = \"dataSource\")\n+    public DataSource createDataSource() {\n+        DriverManagerDataSource dataSource = new DriverManagerDataSource();\n+        dataSource.setDriverClassName(\"com.mysql.cj.jdbc.Driver\");\n+        dataSource.setUrl(\"jdbc:mysql://\" + url + \"?useSSL=false\");\n+        dataSource.setUsername(\"root\");\n+        dataSource.setPassword(\"000000\");\n+        return dataSource;\n+    }\n+\n+    @Bean(name = \"jdbcTemplate\")\n+    public JdbcTemplate createJdbcTemplate(DataSource dataSource) {\n+        return new JdbcTemplate(dataSource);\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/JdbcConfig.java",
                "sha": "2f91fc1811dc57653269c15fa719e68c4d0bf9fa",
                "status": "added"
            },
            {
                "additions": 38,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/TransactionConfig.java",
                "changes": 38,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/TransactionConfig.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/TransactionConfig.java",
                "patch": "@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.config;\n+\n+import org.springframework.context.annotation.Bean;\n+import org.springframework.context.annotation.Configuration;\n+import org.springframework.jdbc.datasource.DataSourceTransactionManager;\n+import org.springframework.transaction.PlatformTransactionManager;\n+\n+import javax.sql.DataSource;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@Configuration\n+public class TransactionConfig {\n+\n+    @Bean\n+    public PlatformTransactionManager transactionManager(DataSource dataSource){\n+        return new DataSourceTransactionManager(dataSource);\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/config/TransactionConfig.java",
                "sha": "cbd421fe4e676417940c8c2da23c9e08d4b66556",
                "status": "added"
            },
            {
                "additions": 72,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/controller/CaseController.java",
                "changes": 72,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/controller/CaseController.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/controller/CaseController.java",
                "patch": "@@ -0,0 +1,72 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.controller;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.beans.factory.annotation.Value;\n+import org.springframework.context.annotation.PropertySource;\n+import org.springframework.jdbc.core.JdbcTemplate;\n+import org.springframework.stereotype.Controller;\n+import org.springframework.web.bind.annotation.RequestMapping;\n+import org.springframework.web.bind.annotation.ResponseBody;\n+import test.org.apache.skywalking.apm.testcase.spring.transaction.service.DemoService;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@Controller\n+@RequestMapping(\"/case\")\n+@PropertySource(\"classpath:application.properties\")\n+public class CaseController {\n+\n+    @Value(\"${mysql.servers}\")\n+    private String address;\n+    @Autowired\n+    private JdbcTemplate jdbcTemplate;\n+\n+    @Autowired\n+    private DemoService demoService;\n+\n+\n+    @RequestMapping(\"/spring-tx-case\")\n+    @ResponseBody\n+    public String springTransactionCase() {\n+        demoService.doBiz();\n+        return \"Success\";\n+    }\n+\n+    @RequestMapping(\"/healthCheck\")\n+    @ResponseBody\n+    public String healthCheck() {\n+        try {\n+            jdbcTemplate.execute(\"create database if not exists test default charset = utf8\");\n+            jdbcTemplate.execute(\"\" +\n+                    \"CREATE TABLE IF NOT EXISTS `test`.`table_demo` (\\n\" +\n+                    \"  `id` bigint(20) NOT NULL AUTO_INCREMENT,\\n\" +\n+                    \"  `name` varchar(60),\\n\" +\n+                    \"  PRIMARY KEY (`id`)\\n\" +\n+                    \") ENGINE=InnoDB\");\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            throw e;\n+        }\n+        return \"success\";\n+    }\n+\n+}\n+",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/controller/CaseController.java",
                "sha": "92d652462f03c4a539e6598e7198be1ec2b84a30",
                "status": "added"
            },
            {
                "additions": 28,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/DemoDao.java",
                "changes": 28,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/DemoDao.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/DemoDao.java",
                "patch": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.dao;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+\n+public interface DemoDao {\n+\n+    int insert(String name);\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/DemoDao.java",
                "sha": "7d5459eeac1074e5ac4dcae1d8d4e60d1ad9ceb0",
                "status": "added"
            },
            {
                "additions": 39,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/impl/DemoDaoImpl.java",
                "changes": 39,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/impl/DemoDaoImpl.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/impl/DemoDaoImpl.java",
                "patch": "@@ -0,0 +1,39 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.dao.impl;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.jdbc.core.JdbcTemplate;\n+import org.springframework.stereotype.Repository;\n+import test.org.apache.skywalking.apm.testcase.spring.transaction.dao.DemoDao;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@Repository\n+public class DemoDaoImpl implements DemoDao {\n+\n+    @Autowired\n+    private JdbcTemplate jdbcTemplate;\n+\n+    @Override\n+    public int insert(String name) {\n+        return jdbcTemplate.update(\"insert into `test`.`table_demo`(name) values(?)\", name);\n+    }\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/dao/impl/DemoDaoImpl.java",
                "sha": "806ebc9c5d41296c8c4f69eb6bf7e807a9c21042",
                "status": "added"
            },
            {
                "additions": 28,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/DemoService.java",
                "changes": 28,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/DemoService.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/DemoService.java",
                "patch": "@@ -0,0 +1,28 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.service;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+\n+public interface DemoService {\n+\n+    void doBiz();\n+\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/DemoService.java",
                "sha": "a4ad4eb16eef111e6bb40276f3ff0aea7c1a37f5",
                "status": "added"
            },
            {
                "additions": 41,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/impl/DemoServiceImpl.java",
                "changes": 41,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/impl/DemoServiceImpl.java?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/impl/DemoServiceImpl.java",
                "patch": "@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+package test.org.apache.skywalking.apm.testcase.spring.transaction.service.impl;\n+\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.springframework.stereotype.Service;\n+import org.springframework.transaction.annotation.Transactional;\n+import test.org.apache.skywalking.apm.testcase.spring.transaction.dao.DemoDao;\n+import test.org.apache.skywalking.apm.testcase.spring.transaction.service.DemoService;\n+\n+/**\n+ * @author zhaoyuguang\n+ */\n+@Service\n+public class DemoServiceImpl implements DemoService {\n+\n+    @Autowired\n+    private DemoDao demoDao;\n+\n+    @Override\n+    @Transactional\n+    public void doBiz() {\n+        demoDao.insert(\"1\");\n+        demoDao.insert(\"2\");\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/java/test/org/apache/skywalking/apm/testcase/spring/transaction/service/impl/DemoServiceImpl.java",
                "sha": "19b42868cb56078f1668b46b3ad4e471da920fc0",
                "status": "added"
            },
            {
                "additions": 21,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/resources/application.properties",
                "changes": 21,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/src/main/resources/application.properties?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/src/main/resources/application.properties",
                "patch": "@@ -0,0 +1,21 @@\n+#\n+# Licensed to the Apache Software Foundation (ASF) under one or more\n+# contributor license agreements.  See the NOTICE file distributed with\n+# this work for additional information regarding copyright ownership.\n+# The ASF licenses this file to You under the Apache License, Version 2.0\n+# (the \"License\"); you may not use this file except in compliance with\n+# the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+#\n+#\n+\n+server.port=8080\n+server.contextPath=/spring-tx-scenario\n+server.servlet.contextPath=/spring-tx-scenario\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/src/main/resources/application.properties",
                "sha": "e9aaf725ef9a385c62700498dbc09f8a45276891",
                "status": "added"
            },
            {
                "additions": 26,
                "blob_url": "https://github.com/apache/skywalking/blob/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/support-version.list",
                "changes": 26,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/test/plugin/scenarios/spring-tx-scenario/support-version.list?ref=6ffd92792d176b9af2562dd1d165576d05542c48",
                "deletions": 0,
                "filename": "test/plugin/scenarios/spring-tx-scenario/support-version.list",
                "patch": "@@ -0,0 +1,26 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#     http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing, software\n+# distributed under the License is distributed on an \"AS IS\" BASIS,\n+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# See the License for the specific language governing permissions and\n+# limitations under the License.\n+\n+2.1.9.RELEASE\n+2.1.5.RELEASE\n+2.1.0.RELEASE\n+2.0.9.RELEASE\n+2.0.5.RELEASE\n+2.0.0.RELEASE\n+1.5.22.RELEASE\n+1.5.11.RELEASE\n+1.5.0.RELEASE\n+1.4.7.RELEASE\n\\ No newline at end of file",
                "raw_url": "https://github.com/apache/skywalking/raw/6ffd92792d176b9af2562dd1d165576d05542c48/test/plugin/scenarios/spring-tx-scenario/support-version.list",
                "sha": "4045a35cafebf1829e6fd3f4578d3f1a3c3772f1",
                "status": "added"
            }
        ],
        "message": "Support spring-tx in optional plugin (#3857)\n\n* plugin code\r\n\r\n* NPE FIX",
        "parent": "https://github.com/apache/skywalking/commit/1b433da7e4a53d0b68d62c4af932d59ed49ecb68",
        "patched_files": [
            "AbstractPlatformTransactionManagerInstrumentation.java",
            "Jenkinsfile-Agent-Test-2.java",
            "Config.java",
            "skywalking-plugin.java",
            "TransactionConfig.java",
            "EndTransactionMethodInterceptor.java",
            "assembly.java",
            "pom.java",
            "application.java",
            "DemoDaoImpl.java",
            "Application.java",
            "DemoServiceImpl.java",
            "Constants.java",
            "ComponentsDefine.java",
            "Supported-list.java",
            "JdbcConfig.java",
            "GetTransactionMethodInterceptor.java",
            "configuration.java",
            "README.java",
            "DemoService.java",
            "expectedData.java",
            "DemoDao.java",
            "CaseController.java",
            "component-libraries.java",
            "startup.java",
            "support-version.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "Plugin-test.java"
        ]
    },
    "skywalking_7c2aa4c": {
        "bug_id": "skywalking_7c2aa4c",
        "commit": "https://github.com/apache/skywalking/commit/7c2aa4c43a01964dd4d15a55c281ce720e0e4af0",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/7c2aa4c43a01964dd4d15a55c281ce720e0e4af0/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java?ref=7c2aa4c43a01964dd4d15a55c281ce720e0e4af0",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "patch": "@@ -37,7 +37,7 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         if (ContextManager.isActive()) {\n             AbstractSpan abstractTracingSpan = ContextManager.activeSpan();\n             Map<String, String> eventMap = new HashMap<String, String>();\n-            eventMap.put(\"forward-url\", (String)objInst.getSkyWalkingDynamicField());\n+            eventMap.put(\"forward-url\", objInst.getSkyWalkingDynamicField() == null ? \"\" : String.valueOf(objInst.getSkyWalkingDynamicField()));\n             abstractTracingSpan.log(System.currentTimeMillis(), eventMap);\n             ContextManager.getRuntimeContext().put(Constants.FORWARD_REQUEST_FLAG, true);\n         }",
                "raw_url": "https://github.com/apache/skywalking/raw/7c2aa4c43a01964dd4d15a55c281ce720e0e4af0/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "sha": "68416c7ed6734fe6e043c098f205dadf306571d5",
                "status": "modified"
            }
        ],
        "message": "FIX NPE in tomcat plugin ForwardInterceptor (#1562)",
        "parent": "https://github.com/apache/skywalking/commit/03af5f1806d6a9d7052a8836d07b2135277bc2d5",
        "patched_files": [
            "ForwardInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "ForwardInterceptorTest.java"
        ]
    },
    "skywalking_8716bb0": {
        "bug_id": "skywalking_8716bb0",
        "commit": "https://github.com/apache/skywalking/commit/8716bb0dc56780093ff3832e2d692f4bae8982bb",
        "file": [
            {
                "additions": 12,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/ConnectionServiceMethodInterceptor.java",
                "changes": 19,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/ConnectionServiceMethodInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 7,
                "filename": "apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/ConnectionServiceMethodInterceptor.java",
                "patch": "@@ -45,19 +45,24 @@ public final void beforeMethod(EnhancedInstance objInst, Method method, Object[]\n         Class<?>[] argumentsTypes,\n         MethodInterceptResult result) throws Throwable {\n         ConnectionInfo connectInfo = (ConnectionInfo)objInst.getSkyWalkingDynamicField();\n-        AbstractSpan span = ContextManager.createExitSpan(connectInfo.getDBType() + \"/JDBI/Connection/\" + method.getName(), connectInfo.getDatabasePeer());\n-        Tags.DB_TYPE.set(span, \"sql\");\n-        Tags.DB_INSTANCE.set(span, connectInfo.getDatabaseName());\n-        Tags.DB_STATEMENT.set(span, \"\");\n-        span.setComponent(connectInfo.getComponent());\n-        SpanLayer.asDB(span);\n+        if (connectInfo != null) {\n+            AbstractSpan span = ContextManager.createExitSpan(connectInfo.getDBType() + \"/JDBI/Connection/\" + method.getName(), connectInfo.getDatabasePeer());\n+            Tags.DB_TYPE.set(span, \"sql\");\n+            Tags.DB_INSTANCE.set(span, connectInfo.getDatabaseName());\n+            Tags.DB_STATEMENT.set(span, \"\");\n+            span.setComponent(connectInfo.getComponent());\n+            SpanLayer.asDB(span);\n+        }\n     }\n \n     @Override\n     public final Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments,\n         Class<?>[] argumentsTypes,\n         Object ret) throws Throwable {\n-        ContextManager.stopSpan();\n+        ConnectionInfo connectInfo = (ConnectionInfo)objInst.getSkyWalkingDynamicField();\n+        if (connectInfo != null) {\n+            ContextManager.stopSpan();\n+        }\n         return ret;\n     }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/ConnectionServiceMethodInterceptor.java",
                "sha": "ef6a2ccabb54f3f658d0131da9a746bba45acfad",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/JDBCDriverInterceptor.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/JDBCDriverInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/JDBCDriverInterceptor.java",
                "patch": "@@ -41,7 +41,7 @@\n \n     @Override public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments,\n         Class<?>[] argumentsTypes, Object ret) throws Throwable {\n-        if (ret != null) {\n+        if (ret != null && ret instanceof EnhancedInstance) {\n             ((EnhancedInstance)ret).setSkyWalkingDynamicField(URLParser.parser((String)allArguments[0]));\n         }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/JDBCDriverInterceptor.java",
                "sha": "1ffe7b98ac8b22d7c8084be1718d0c3d97743a22",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/MysqlURLParser.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/MysqlURLParser.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 3,
                "filename": "apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/MysqlURLParser.java",
                "patch": "@@ -84,12 +84,12 @@ public ConnectionInfo parse() {\n             StringBuilder sb = new StringBuilder();\n             for (String host : hostSegment) {\n                 if (host.split(\":\").length == 1) {\n-                    sb.append(host + \":\" + DEFAULT_PORT + \",\");\n+                    sb.append(host).append(\":\").append(DEFAULT_PORT).append(\",\");\n                 } else {\n-                    sb.append(host + \",\");\n+                    sb.append(host).append(\",\");\n                 }\n             }\n-            return new ConnectionInfo(ComponentsDefine.MYSQL_JDBC_DRIVER, DB_TYPE, sb.toString(), fetchDatabaseNameFromURL());\n+            return new ConnectionInfo(ComponentsDefine.MYSQL_JDBC_DRIVER, DB_TYPE, sb.substring(0, sb.length() - 1), fetchDatabaseNameFromURL());\n         } else {\n             String[] hostAndPort = hostSegment[0].split(\":\");\n             if (hostAndPort.length != 1) {",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/MysqlURLParser.java",
                "sha": "57050487e58432b22c5a201863bbdd9026c9dac1",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/test/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/URLParserTest.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/test/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/URLParserTest.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 2,
                "filename": "apm-sniffer/apm-sdk-plugin/jdbc-commons/src/test/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/URLParserTest.java",
                "patch": "@@ -55,15 +55,15 @@ public void testParseMysqlJDBCURLWithMultiHost() {\n         ConnectionInfo connectionInfo = new URLParser().parser(\"jdbc:mysql//primaryhost:3307,secondaryhost1,secondaryhost2/test?profileSQL=true\");\n         assertThat(connectionInfo.getDBType(), is(\"Mysql\"));\n         assertThat(connectionInfo.getDatabaseName(), is(\"test\"));\n-        assertThat(connectionInfo.getDatabasePeer(), is(\"primaryhost:3307,secondaryhost1:3306,secondaryhost2:3306,\"));\n+        assertThat(connectionInfo.getDatabasePeer(), is(\"primaryhost:3307,secondaryhost1:3306,secondaryhost2:3306\"));\n     }\n \n     @Test\n     public void testParseMysqlJDBCURLWithConnectorJs() {\n         ConnectionInfo connectionInfo = new URLParser().parser(\"jdbc:mysql:replication://master,slave1,slave2,slave3/test\");\n         assertThat(connectionInfo.getDBType(), is(\"Mysql\"));\n         assertThat(connectionInfo.getDatabaseName(), is(\"test\"));\n-        assertThat(connectionInfo.getDatabasePeer(), is(\"master:3306,slave1:3306,slave2:3306,slave3:3306,\"));\n+        assertThat(connectionInfo.getDatabasePeer(), is(\"master:3306,slave1:3306,slave2:3306,slave3:3306\"));\n     }\n \n     @Test",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/jdbc-commons/src/test/java/org/apache/skywalking/apm/plugin/jdbc/connectionurl/parser/URLParserTest.java",
                "sha": "3eec7b03154943cc32368733cb9f16550854d4e5",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/ConnectionCreate5xInterceptor.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/ConnectionCreate5xInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/ConnectionCreate5xInterceptor.java",
                "patch": "@@ -22,6 +22,7 @@\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n import org.apache.skywalking.apm.plugin.jdbc.connectionurl.parser.URLParser;\n+import org.apache.skywalking.apm.plugin.jdbc.mysql.ConnectionCache;\n import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n \n import java.lang.reflect.Method;",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/ConnectionCreate5xInterceptor.java",
                "sha": "115ea5d0607f30497716a9521a54b24e4183df5c",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/define/CacheIpsInstrumentation.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/define/CacheIpsInstrumentation.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 2,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/define/CacheIpsInstrumentation.java",
                "patch": "@@ -26,6 +26,7 @@\n \n import static net.bytebuddy.matcher.ElementMatchers.named;\n import static org.apache.skywalking.apm.agent.core.plugin.match.MultiClassNameMatch.byMultiClassMatch;\n+import static org.apache.skywalking.apm.plugin.jdbc.mysql.Constants.DRIVER_CONNECT_INTERCEPTOR;\n \n /**\n  * @author: dingshaocheng\n@@ -35,7 +36,6 @@\n     private static final String ENHANCE_CLASS_NON_REG_REP = \"com.mysql.jdbc.NonRegisteringReplicationDriver\";\n     private static final String ENHANCE_CLASS = \"com.mysql.jdbc.Driver\";\n     private static final String ENHANCE_CLASS_NON_REG = \"com.mysql.jdbc.NonRegisteringDriver\";\n-    private static final String METHOD_INTERCEPTOR_CLASS = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v5.DriverConnectInterceptor\";\n \n \n     @Override\n@@ -54,7 +54,7 @@\n \n                 @Override\n                 public String getMethodsInterceptor() {\n-                    return METHOD_INTERCEPTOR_CLASS;\n+                    return DRIVER_CONNECT_INTERCEPTOR;\n                 }\n \n                 @Override",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/define/CacheIpsInstrumentation.java",
                "sha": "28dfd3974db01de1babce56339a6848dd4b7f420",
                "status": "modified"
            },
            {
                "additions": 24,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateNewInterceptor.java",
                "changes": 46,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateNewInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 22,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateNewInterceptor.java",
                "patch": "@@ -6,49 +6,51 @@\n  * (the \"License\"); you may not use this file except in compliance with\n  * the License.  You may obtain a copy of the License at\n  *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n  *\n  * Unless required by applicable law or agreed to in writing, software\n  * distributed under the License is distributed on an \"AS IS\" BASIS,\n  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n  */\n \n package org.apache.skywalking.apm.plugin.jdbc.mysql.v6;\n \n-import com.mysql.cj.api.jdbc.JdbcConnection;\n-import com.mysql.cj.core.conf.url.ConnectionUrl;\n import com.mysql.cj.core.conf.url.HostInfo;\n-import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-import org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper.JdbcConnectionWrapper;\n+import org.apache.skywalking.apm.plugin.jdbc.connectionurl.parser.URLParser;\n import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n \n-public class CreateJdbcConnectionProxyInstanceInterceptor implements StaticMethodsAroundInterceptor {\n+import java.lang.reflect.Method;\n+\n+/**\n+ * for mysql connector java 6.0.4+\n+ * @author lican\n+ */\n+public class ConnectionCreateNewInterceptor implements StaticMethodsAroundInterceptor {\n+\n+\n     @Override\n-    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        MethodInterceptResult result) {\n+    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, MethodInterceptResult result) {\n+\n     }\n \n     @Override\n-    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Object ret) {\n-        ConnectionUrl connectionUrl = (ConnectionUrl)allArguments[0];\n-\n-        StringBuilder hosts = new StringBuilder();\n-        for (HostInfo info : connectionUrl.getHostsList()) {\n-            hosts.append(info.getHost()).append(\":\").append(info.getPort()).append(\",\");\n+    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Object ret) {\n+        if (ret instanceof EnhancedInstance) {\n+            final HostInfo hostInfo = (HostInfo) allArguments[0];\n+            ConnectionInfo connectionInfo = URLParser.parser(hostInfo.getDatabaseUrl());\n+            ((EnhancedInstance) ret).setSkyWalkingDynamicField(connectionInfo);\n         }\n-        ConnectionInfo connectionInfo = new ConnectionInfo(ComponentsDefine.MYSQL_JDBC_DRIVER, \"Mysql\", hosts.toString(), connectionUrl.getDatabase());\n-        return new JdbcConnectionWrapper((JdbcConnection)ret, connectionInfo);\n+        return ret;\n     }\n \n     @Override\n-    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Throwable t) {\n+    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Throwable t) {\n \n     }\n }",
                "previous_filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateJdbcConnectionProxyInstanceInterceptor.java",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateNewInterceptor.java",
                "sha": "e7a5adf35cadc42a046a2367756ecf0d2a1cd967",
                "status": "renamed"
            },
            {
                "additions": 54,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateOldInterceptor.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateOldInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateOldInterceptor.java",
                "patch": "@@ -0,0 +1,54 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.jdbc.mysql.v6;\n+\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n+import org.apache.skywalking.apm.plugin.jdbc.mysql.ConnectionCache;\n+import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n+\n+import java.lang.reflect.Method;\n+\n+/**\n+ * for mysql connector java 6.0.2,6.0.3\n+ * @author lican\n+ */\n+public class ConnectionCreateOldInterceptor implements StaticMethodsAroundInterceptor {\n+\n+\n+    @Override\n+    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, MethodInterceptResult result) {\n+\n+    }\n+\n+    @Override\n+    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Object ret) {\n+        if (ret instanceof EnhancedInstance) {\n+            ConnectionInfo connectionInfo = ConnectionCache.get(allArguments[1].toString(), allArguments[2].toString());\n+            ((EnhancedInstance) ret).setSkyWalkingDynamicField(connectionInfo);\n+        }\n+        return ret;\n+    }\n+\n+    @Override\n+    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Throwable t) {\n+\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/ConnectionCreateOldInterceptor.java",
                "sha": "65cc785881813a49910722d405f2c1bdcad0e508",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateLoadBalancedConnectionProxyInstanceInterceptor.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateLoadBalancedConnectionProxyInstanceInterceptor.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 53,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateLoadBalancedConnectionProxyInstanceInterceptor.java",
                "patch": "@@ -1,53 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6;\n-\n-import com.mysql.cj.api.jdbc.ha.LoadBalancedConnection;\n-import com.mysql.cj.core.conf.url.ConnectionUrl;\n-import com.mysql.cj.core.conf.url.HostInfo;\n-import java.lang.reflect.Method;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-import org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper.LoadBalancedConnectionWrapper;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class CreateLoadBalancedConnectionProxyInstanceInterceptor implements StaticMethodsAroundInterceptor {\n-    @Override public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        MethodInterceptResult result) {\n-\n-    }\n-\n-    @Override public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Object ret) {\n-        ConnectionUrl connectionUrl = (ConnectionUrl)allArguments[0];\n-\n-        StringBuilder hosts = new StringBuilder();\n-        for (HostInfo info : connectionUrl.getHostsList()) {\n-            hosts.append(info.getHost()).append(\":\").append(info.getPort()).append(\",\");\n-        }\n-        ConnectionInfo connectionInfo = new ConnectionInfo(ComponentsDefine.MYSQL_JDBC_DRIVER, \"Mysql\", hosts.toString(), connectionUrl.getDatabase());\n-        return new LoadBalancedConnectionWrapper((LoadBalancedConnection)ret, connectionInfo);\n-    }\n-\n-    @Override\n-    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Throwable t) {\n-\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateLoadBalancedConnectionProxyInstanceInterceptor.java",
                "sha": "a48146573e124cf74f63a8cde7f839763586c8f1",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateReplicationConnectionProxyInstanceInterceptor.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateReplicationConnectionProxyInstanceInterceptor.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 53,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateReplicationConnectionProxyInstanceInterceptor.java",
                "patch": "@@ -1,53 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6;\n-\n-import com.mysql.cj.api.jdbc.ha.ReplicationConnection;\n-import com.mysql.cj.core.conf.url.ConnectionUrl;\n-import com.mysql.cj.core.conf.url.HostInfo;\n-import java.lang.reflect.Method;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-import org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper.ReplicationConnectionWrapper;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class CreateReplicationConnectionProxyInstanceInterceptor implements StaticMethodsAroundInterceptor {\n-    @Override public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        MethodInterceptResult result) {\n-\n-    }\n-\n-    @Override public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Object ret) {\n-        ConnectionUrl connectionUrl = (ConnectionUrl)allArguments[0];\n-\n-        StringBuilder hosts = new StringBuilder();\n-        for (HostInfo info : connectionUrl.getHostsList()) {\n-            hosts.append(info.getHost()).append(\":\").append(info.getPort()).append(\",\");\n-        }\n-        ConnectionInfo connectionInfo = new ConnectionInfo(ComponentsDefine.MYSQL_JDBC_DRIVER, \"Mysql\", hosts.toString(), connectionUrl.getDatabase());\n-        return new ReplicationConnectionWrapper((ReplicationConnection)ret, connectionInfo);\n-    }\n-\n-    @Override\n-    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n-        Throwable t) {\n-\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/CreateReplicationConnectionProxyInstanceInterceptor.java",
                "sha": "7c0aaa7cbd51590194ce9c9440b87eeb22263fc5",
                "status": "removed"
            },
            {
                "additions": 69,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/CacheIpsInstrumentation.java",
                "changes": 69,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/CacheIpsInstrumentation.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/CacheIpsInstrumentation.java",
                "patch": "@@ -0,0 +1,69 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+import static org.apache.skywalking.apm.agent.core.plugin.match.MultiClassNameMatch.byMultiClassMatch;\n+import static org.apache.skywalking.apm.plugin.jdbc.mysql.Constants.DRIVER_CONNECT_INTERCEPTOR;\n+\n+/**\n+ * @author dingshaocheng lican\n+ */\n+public class CacheIpsInstrumentation extends AbstractMysqlInstrumentation {\n+\n+    private static final String ENHANCE_CLASS_NON_REG = \"com.mysql.cj.jdbc.NonRegisteringDriver\";\n+\n+\n+    @Override\n+    protected ConstructorInterceptPoint[] getConstructorsInterceptPoints() {\n+        return new ConstructorInterceptPoint[0];\n+    }\n+\n+    @Override\n+    protected InstanceMethodsInterceptPoint[] getInstanceMethodsInterceptPoints() {\n+        return new InstanceMethodsInterceptPoint[]{new InstanceMethodsInterceptPoint() {\n+            @Override\n+            public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                return named(\"connect\");\n+            }\n+\n+            @Override\n+            public String getMethodsInterceptor() {\n+                return DRIVER_CONNECT_INTERCEPTOR;\n+            }\n+\n+            @Override\n+            public boolean isOverrideArgs() {\n+                return false;\n+            }\n+        }\n+        };\n+    }\n+\n+    @Override\n+    protected ClassMatch enhanceClass() {\n+        return byMultiClassMatch(ENHANCE_CLASS_NON_REG);\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/CacheIpsInstrumentation.java",
                "sha": "c7b2240d8057f1e9defa410da31f89fe6bc2f316",
                "status": "added"
            },
            {
                "additions": 89,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ConnectionImplCreateInstrumentation.java",
                "changes": 89,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ConnectionImplCreateInstrumentation.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ConnectionImplCreateInstrumentation.java",
                "patch": "@@ -0,0 +1,89 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+\n+package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define;\n+\n+import net.bytebuddy.description.method.MethodDescription;\n+import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.StaticMethodsInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n+\n+import static net.bytebuddy.matcher.ElementMatchers.named;\n+import static net.bytebuddy.matcher.ElementMatchers.takesArguments;\n+import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n+\n+/**\n+ * interceptor the method {@link com.mysql.cj.jdbc.ConnectionImpl#getInstance} for mysql client version 6.x\n+ *\n+ * @author dingshaocheng lican\n+ */\n+public class ConnectionImplCreateInstrumentation extends AbstractMysqlInstrumentation {\n+\n+    private static final String JDBC_ENHANCE_CLASS = \"com.mysql.cj.jdbc.ConnectionImpl\";\n+\n+    private static final String CONNECT_METHOD = \"getInstance\";\n+\n+    private static final String GET_INSTANCE_NEW_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v6.ConnectionCreateNewInterceptor\";\n+\n+    private static final String GET_INSTANCE_OLD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v6.ConnectionCreateOldInterceptor\";\n+\n+\n+    @Override\n+    protected StaticMethodsInterceptPoint[] getStaticMethodsInterceptPoints() {\n+        return new StaticMethodsInterceptPoint[]{\n+            new StaticMethodsInterceptPoint() {\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return named(CONNECT_METHOD).and(takesArguments(1));\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return GET_INSTANCE_NEW_INTERCEPTOR;\n+                }\n+\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+            },\n+            new StaticMethodsInterceptPoint() {\n+                @Override\n+                public ElementMatcher<MethodDescription> getMethodsMatcher() {\n+                    return named(CONNECT_METHOD).and(takesArguments(4));\n+                }\n+\n+                @Override\n+                public String getMethodsInterceptor() {\n+                    return GET_INSTANCE_OLD_INTERCEPTOR;\n+                }\n+\n+                @Override\n+                public boolean isOverrideArgs() {\n+                    return false;\n+                }\n+            }\n+        };\n+    }\n+\n+    @Override\n+    protected ClassMatch enhanceClass() {\n+        return byName(JDBC_ENHANCE_CLASS);\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ConnectionImplCreateInstrumentation.java",
                "sha": "454a31bc71cda1e9d5d29abf1db1080efdd24622",
                "status": "added"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/FailoverConnectionProxyInstrumentation.java",
                "changes": 57,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/FailoverConnectionProxyInstrumentation.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 57,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/FailoverConnectionProxyInstrumentation.java",
                "patch": "@@ -1,57 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define;\n-\n-import net.bytebuddy.description.method.MethodDescription;\n-import net.bytebuddy.matcher.ElementMatcher;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.StaticMethodsInterceptPoint;\n-import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n-\n-import static net.bytebuddy.matcher.ElementMatchers.named;\n-import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n-\n-public class FailoverConnectionProxyInstrumentation extends AbstractMysqlInstrumentation {\n-\n-    public static final String METHOD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v6.CreateJdbcConnectionProxyInstanceInterceptor\";\n-    public static final String INTERCEPT_CLASS = \"com.mysql.cj.jdbc.ha.FailoverConnectionProxy\";\n-\n-    @Override\n-    protected StaticMethodsInterceptPoint[] getStaticMethodsInterceptPoints() {\n-        return new StaticMethodsInterceptPoint[] {\n-            new StaticMethodsInterceptPoint() {\n-                @Override public ElementMatcher<MethodDescription> getMethodsMatcher() {\n-                    return named(\"createProxyInstance\");\n-                }\n-\n-                @Override public String getMethodsInterceptor() {\n-                    return METHOD_INTERCEPTOR;\n-                }\n-\n-                @Override public boolean isOverrideArgs() {\n-                    return false;\n-                }\n-            }\n-        };\n-    }\n-\n-    @Override\n-    protected ClassMatch enhanceClass() {\n-        return byName(INTERCEPT_CLASS);\n-    }\n-\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/FailoverConnectionProxyInstrumentation.java",
                "sha": "c1f9271e06e0c99041177f35fcf4688a6e384352",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/LoadBalancedConnectionProxyInstrumentation.java",
                "changes": 55,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/LoadBalancedConnectionProxyInstrumentation.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 55,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/LoadBalancedConnectionProxyInstrumentation.java",
                "patch": "@@ -1,55 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define;\n-\n-import net.bytebuddy.description.method.MethodDescription;\n-import net.bytebuddy.matcher.ElementMatcher;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.StaticMethodsInterceptPoint;\n-import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n-\n-import static net.bytebuddy.matcher.ElementMatchers.named;\n-import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n-\n-public class LoadBalancedConnectionProxyInstrumentation extends AbstractMysqlInstrumentation {\n-\n-    public static final String METHOD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v6.CreateLoadBalancedConnectionProxyInstanceInterceptor\";\n-    public static final String INTERCEPT_CLASS = \"com.mysql.cj.jdbc.ha.LoadBalancedConnectionProxy\";\n-\n-    @Override protected StaticMethodsInterceptPoint[] getStaticMethodsInterceptPoints() {\n-        return new StaticMethodsInterceptPoint[] {\n-            new StaticMethodsInterceptPoint() {\n-                @Override public ElementMatcher<MethodDescription> getMethodsMatcher() {\n-                    return named(\"createProxyInstance\");\n-                }\n-\n-                @Override public String getMethodsInterceptor() {\n-                    return METHOD_INTERCEPTOR;\n-                }\n-\n-                @Override public boolean isOverrideArgs() {\n-                    return false;\n-                }\n-            }\n-        };\n-    }\n-\n-    @Override protected ClassMatch enhanceClass() {\n-        return byName(INTERCEPT_CLASS);\n-    }\n-\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/LoadBalancedConnectionProxyInstrumentation.java",
                "sha": "842daa45f77cfa47de470c2d38750e4e4401e0e2",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ReplicationConnectionProxyInstrumentation.java",
                "changes": 54,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ReplicationConnectionProxyInstrumentation.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 54,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ReplicationConnectionProxyInstrumentation.java",
                "patch": "@@ -1,54 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define;\n-\n-import net.bytebuddy.description.method.MethodDescription;\n-import net.bytebuddy.matcher.ElementMatcher;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.StaticMethodsInterceptPoint;\n-import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n-\n-import static net.bytebuddy.matcher.ElementMatchers.named;\n-import static org.apache.skywalking.apm.agent.core.plugin.match.NameMatch.byName;\n-\n-public class ReplicationConnectionProxyInstrumentation extends AbstractMysqlInstrumentation {\n-\n-    public static final String METHOD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.v6.CreateReplicationConnectionProxyInstanceInterceptor\";\n-    public static final String INTERCEPT_CLASS = \"com.mysql.cj.jdbc.ha.ReplicationConnectionProxy\";\n-\n-    @Override protected StaticMethodsInterceptPoint[] getStaticMethodsInterceptPoints() {\n-        return new StaticMethodsInterceptPoint[] {\n-            new StaticMethodsInterceptPoint() {\n-                @Override public ElementMatcher<MethodDescription> getMethodsMatcher() {\n-                    return named(\"createProxyInstance\");\n-                }\n-\n-                @Override public String getMethodsInterceptor() {\n-                    return METHOD_INTERCEPTOR;\n-                }\n-\n-                @Override public boolean isOverrideArgs() {\n-                    return false;\n-                }\n-            }\n-        };\n-    }\n-\n-    @Override protected ClassMatch enhanceClass() {\n-        return byName(INTERCEPT_CLASS);\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/define/ReplicationConnectionProxyInstrumentation.java",
                "sha": "3077bd3b2ef3db8e45b902d15b74f5bb8c38c314",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/CallableStatementWrapper.java",
                "changes": 539,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/CallableStatementWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 539,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/CallableStatementWrapper.java",
                "patch": "@@ -1,539 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import java.io.InputStream;\n-import java.io.Reader;\n-import java.math.BigDecimal;\n-import java.net.URL;\n-import java.sql.Array;\n-import java.sql.Blob;\n-import java.sql.CallableStatement;\n-import java.sql.Clob;\n-import java.sql.Date;\n-import java.sql.NClob;\n-import java.sql.Ref;\n-import java.sql.RowId;\n-import java.sql.SQLException;\n-import java.sql.SQLType;\n-import java.sql.SQLXML;\n-import java.sql.Time;\n-import java.sql.Timestamp;\n-import java.util.Calendar;\n-import java.util.Map;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class CallableStatementWrapper extends PreparedStatementWrapper implements CallableStatement {\n-\n-    @Override public void registerOutParameter(int parameterIndex, int sqlType) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType);\n-    }\n-\n-    @Override public void registerOutParameter(int parameterIndex, int sqlType, int scale) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType, scale);\n-    }\n-\n-    @Override public boolean wasNull() throws SQLException {\n-        return call.wasNull();\n-    }\n-\n-    @Override public String getString(int parameterIndex) throws SQLException {\n-        return call.getString(parameterIndex);\n-    }\n-\n-    @Override public boolean getBoolean(int parameterIndex) throws SQLException {\n-        return call.getBoolean(parameterIndex);\n-    }\n-\n-    @Override public byte getByte(int parameterIndex) throws SQLException {\n-        return call.getByte(parameterIndex);\n-    }\n-\n-    @Override public short getShort(int parameterIndex) throws SQLException {\n-        return call.getShort(parameterIndex);\n-    }\n-\n-    @Override public int getInt(int parameterIndex) throws SQLException {\n-        return call.getInt(parameterIndex);\n-    }\n-\n-    @Override public long getLong(int parameterIndex) throws SQLException {\n-        return call.getLong(parameterIndex);\n-    }\n-\n-    @Override public float getFloat(int parameterIndex) throws SQLException {\n-        return call.getFloat(parameterIndex);\n-    }\n-\n-    @Override public double getDouble(int parameterIndex) throws SQLException {\n-        return call.getDouble(parameterIndex);\n-    }\n-\n-    @Override @Deprecated public BigDecimal getBigDecimal(int parameterIndex, int scale) throws SQLException {\n-        return call.getBigDecimal(parameterIndex, scale);\n-    }\n-\n-    @Override public byte[] getBytes(int parameterIndex) throws SQLException {\n-        return call.getBytes(parameterIndex);\n-    }\n-\n-    @Override public Date getDate(int parameterIndex) throws SQLException {\n-        return call.getDate(parameterIndex);\n-    }\n-\n-    @Override public Time getTime(int parameterIndex) throws SQLException {\n-        return call.getTime(parameterIndex);\n-    }\n-\n-    @Override public Timestamp getTimestamp(int parameterIndex) throws SQLException {\n-        return call.getTimestamp(parameterIndex);\n-    }\n-\n-    @Override public Object getObject(int parameterIndex) throws SQLException {\n-        return call.getObject(parameterIndex);\n-    }\n-\n-    @Override public BigDecimal getBigDecimal(int parameterIndex) throws SQLException {\n-        return call.getBigDecimal(parameterIndex);\n-    }\n-\n-    @Override public Object getObject(int parameterIndex, Map<String, Class<?>> map) throws SQLException {\n-        return call.getObject(parameterIndex, map);\n-    }\n-\n-    @Override public Ref getRef(int parameterIndex) throws SQLException {\n-        return call.getRef(parameterIndex);\n-    }\n-\n-    @Override public Blob getBlob(int parameterIndex) throws SQLException {\n-        return call.getBlob(parameterIndex);\n-    }\n-\n-    @Override public Clob getClob(int parameterIndex) throws SQLException {\n-        return call.getClob(parameterIndex);\n-    }\n-\n-    @Override public Array getArray(int parameterIndex) throws SQLException {\n-        return call.getArray(parameterIndex);\n-    }\n-\n-    @Override public Date getDate(int parameterIndex, Calendar cal) throws SQLException {\n-        return call.getDate(parameterIndex, cal);\n-    }\n-\n-    @Override public Time getTime(int parameterIndex, Calendar cal) throws SQLException {\n-        return call.getTime(parameterIndex, cal);\n-    }\n-\n-    @Override public Timestamp getTimestamp(int parameterIndex, Calendar cal) throws SQLException {\n-        return call.getTimestamp(parameterIndex, cal);\n-    }\n-\n-    @Override public void registerOutParameter(int parameterIndex, int sqlType, String typeName) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType, typeName);\n-    }\n-\n-    @Override public void registerOutParameter(String parameterName, int sqlType) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType);\n-    }\n-\n-    @Override public void registerOutParameter(String parameterName, int sqlType, int scale) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType, scale);\n-    }\n-\n-    @Override public void registerOutParameter(String parameterName, int sqlType, String typeName) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType, typeName);\n-    }\n-\n-    @Override public URL getURL(int parameterIndex) throws SQLException {\n-        return call.getURL(parameterIndex);\n-    }\n-\n-    @Override public void setURL(String parameterName, URL val) throws SQLException {\n-        call.setURL(parameterName, val);\n-    }\n-\n-    @Override public void setNull(String parameterName, int sqlType) throws SQLException {\n-        call.setNull(parameterName, sqlType);\n-    }\n-\n-    @Override public void setBoolean(String parameterName, boolean x) throws SQLException {\n-        call.setBoolean(parameterName, x);\n-    }\n-\n-    @Override public void setByte(String parameterName, byte x) throws SQLException {\n-        call.setByte(parameterName, x);\n-    }\n-\n-    @Override public void setShort(String parameterName, short x) throws SQLException {\n-        call.setShort(parameterName, x);\n-    }\n-\n-    @Override public void setInt(String parameterName, int x) throws SQLException {\n-        call.setInt(parameterName, x);\n-    }\n-\n-    @Override public void setLong(String parameterName, long x) throws SQLException {\n-        call.setLong(parameterName, x);\n-    }\n-\n-    @Override public void setFloat(String parameterName, float x) throws SQLException {\n-        call.setFloat(parameterName, x);\n-    }\n-\n-    @Override public void setDouble(String parameterName, double x) throws SQLException {\n-        call.setDouble(parameterName, x);\n-    }\n-\n-    @Override public void setBigDecimal(String parameterName, BigDecimal x) throws SQLException {\n-        call.setBigDecimal(parameterName, x);\n-    }\n-\n-    @Override public void setString(String parameterName, String x) throws SQLException {\n-        call.setString(parameterName, x);\n-    }\n-\n-    @Override public void setBytes(String parameterName, byte[] x) throws SQLException {\n-        call.setBytes(parameterName, x);\n-    }\n-\n-    @Override public void setDate(String parameterName, Date x) throws SQLException {\n-        call.setDate(parameterName, x);\n-    }\n-\n-    @Override public void setTime(String parameterName, Time x) throws SQLException {\n-        call.setTime(parameterName, x);\n-    }\n-\n-    @Override public void setTimestamp(String parameterName, Timestamp x) throws SQLException {\n-        call.setTimestamp(parameterName, x);\n-    }\n-\n-    @Override public void setAsciiStream(String parameterName, InputStream x, int length) throws SQLException {\n-        call.setAsciiStream(parameterName, x, length);\n-    }\n-\n-    @Override public void setBinaryStream(String parameterName, InputStream x, int length) throws SQLException {\n-        call.setBinaryStream(parameterName, x, length);\n-    }\n-\n-    @Override public void setObject(String parameterName, Object x, int targetSqlType, int scale) throws SQLException {\n-        call.setObject(parameterName, x, targetSqlType, scale);\n-    }\n-\n-    @Override public void setObject(String parameterName, Object x, int targetSqlType) throws SQLException {\n-        call.setObject(parameterName, x, targetSqlType);\n-    }\n-\n-    @Override public void setObject(String parameterName, Object x) throws SQLException {\n-        call.setObject(parameterName, x);\n-    }\n-\n-    @Override public void setCharacterStream(String parameterName, Reader reader, int length) throws SQLException {\n-        call.setCharacterStream(parameterName, reader, length);\n-    }\n-\n-    @Override public void setDate(String parameterName, Date x, Calendar cal) throws SQLException {\n-        call.setDate(parameterName, x, cal);\n-    }\n-\n-    @Override public void setTime(String parameterName, Time x, Calendar cal) throws SQLException {\n-        call.setTime(parameterName, x, cal);\n-    }\n-\n-    @Override public void setTimestamp(String parameterName, Timestamp x, Calendar cal) throws SQLException {\n-        call.setTimestamp(parameterName, x, cal);\n-    }\n-\n-    @Override public void setNull(String parameterName, int sqlType, String typeName) throws SQLException {\n-        call.setNull(parameterName, sqlType, typeName);\n-    }\n-\n-    @Override public String getString(String parameterName) throws SQLException {\n-        return call.getString(parameterName);\n-    }\n-\n-    @Override public boolean getBoolean(String parameterName) throws SQLException {\n-        return call.getBoolean(parameterName);\n-    }\n-\n-    @Override public byte getByte(String parameterName) throws SQLException {\n-        return call.getByte(parameterName);\n-    }\n-\n-    @Override public short getShort(String parameterName) throws SQLException {\n-        return call.getShort(parameterName);\n-    }\n-\n-    @Override public int getInt(String parameterName) throws SQLException {\n-        return call.getInt(parameterName);\n-    }\n-\n-    @Override public long getLong(String parameterName) throws SQLException {\n-        return call.getLong(parameterName);\n-    }\n-\n-    @Override public float getFloat(String parameterName) throws SQLException {\n-        return call.getFloat(parameterName);\n-    }\n-\n-    @Override public double getDouble(String parameterName) throws SQLException {\n-        return call.getDouble(parameterName);\n-    }\n-\n-    @Override public byte[] getBytes(String parameterName) throws SQLException {\n-        return call.getBytes(parameterName);\n-    }\n-\n-    @Override public Date getDate(String parameterName) throws SQLException {\n-        return call.getDate(parameterName);\n-    }\n-\n-    @Override public Time getTime(String parameterName) throws SQLException {\n-        return call.getTime(parameterName);\n-    }\n-\n-    @Override public Timestamp getTimestamp(String parameterName) throws SQLException {\n-        return call.getTimestamp(parameterName);\n-    }\n-\n-    @Override public Object getObject(String parameterName) throws SQLException {\n-        return call.getObject(parameterName);\n-    }\n-\n-    @Override public BigDecimal getBigDecimal(String parameterName) throws SQLException {\n-        return call.getBigDecimal(parameterName);\n-    }\n-\n-    @Override public Object getObject(String parameterName, Map<String, Class<?>> map) throws SQLException {\n-        return call.getObject(parameterName, map);\n-    }\n-\n-    @Override public Ref getRef(String parameterName) throws SQLException {\n-        return call.getRef(parameterName);\n-    }\n-\n-    @Override public Blob getBlob(String parameterName) throws SQLException {\n-        return call.getBlob(parameterName);\n-    }\n-\n-    @Override public Clob getClob(String parameterName) throws SQLException {\n-        return call.getClob(parameterName);\n-    }\n-\n-    @Override public Array getArray(String parameterName) throws SQLException {\n-        return call.getArray(parameterName);\n-    }\n-\n-    @Override public Date getDate(String parameterName, Calendar cal) throws SQLException {\n-        return call.getDate(parameterName, cal);\n-    }\n-\n-    @Override public Time getTime(String parameterName, Calendar cal) throws SQLException {\n-        return call.getTime(parameterName, cal);\n-    }\n-\n-    @Override public Timestamp getTimestamp(String parameterName, Calendar cal) throws SQLException {\n-        return call.getTimestamp(parameterName, cal);\n-    }\n-\n-    @Override public URL getURL(String parameterName) throws SQLException {\n-        return call.getURL(parameterName);\n-    }\n-\n-    @Override public RowId getRowId(int parameterIndex) throws SQLException {\n-        return call.getRowId(parameterIndex);\n-    }\n-\n-    @Override public RowId getRowId(String parameterName) throws SQLException {\n-        return call.getRowId(parameterName);\n-    }\n-\n-    @Override public void setRowId(String parameterName, RowId x) throws SQLException {\n-        call.setRowId(parameterName, x);\n-    }\n-\n-    @Override public void setNString(String parameterName, String value) throws SQLException {\n-        call.setNString(parameterName, value);\n-    }\n-\n-    @Override public void setNCharacterStream(String parameterName, Reader value, long length) throws SQLException {\n-        call.setNCharacterStream(parameterName, value, length);\n-    }\n-\n-    @Override public void setNClob(String parameterName, NClob value) throws SQLException {\n-        call.setNClob(parameterName, value);\n-    }\n-\n-    @Override public void setClob(String parameterName, Reader reader, long length) throws SQLException {\n-        call.setClob(parameterName, reader, length);\n-    }\n-\n-    @Override public void setBlob(String parameterName, InputStream inputStream, long length) throws SQLException {\n-        call.setBlob(parameterName, inputStream, length);\n-    }\n-\n-    @Override public void setNClob(String parameterName, Reader reader, long length) throws SQLException {\n-        call.setNClob(parameterName, reader, length);\n-    }\n-\n-    @Override public NClob getNClob(int parameterIndex) throws SQLException {\n-        return call.getNClob(parameterIndex);\n-    }\n-\n-    @Override public NClob getNClob(String parameterName) throws SQLException {\n-        return call.getNClob(parameterName);\n-    }\n-\n-    @Override public void setSQLXML(String parameterName, SQLXML xmlObject) throws SQLException {\n-        call.setSQLXML(parameterName, xmlObject);\n-    }\n-\n-    @Override public SQLXML getSQLXML(int parameterIndex) throws SQLException {\n-        return call.getSQLXML(parameterIndex);\n-    }\n-\n-    @Override public SQLXML getSQLXML(String parameterName) throws SQLException {\n-        return call.getSQLXML(parameterName);\n-    }\n-\n-    @Override public String getNString(int parameterIndex) throws SQLException {\n-        return call.getNString(parameterIndex);\n-    }\n-\n-    @Override public String getNString(String parameterName) throws SQLException {\n-        return call.getNString(parameterName);\n-    }\n-\n-    @Override public Reader getNCharacterStream(int parameterIndex) throws SQLException {\n-        return call.getNCharacterStream(parameterIndex);\n-    }\n-\n-    @Override public Reader getNCharacterStream(String parameterName) throws SQLException {\n-        return call.getNCharacterStream(parameterName);\n-    }\n-\n-    @Override public Reader getCharacterStream(int parameterIndex) throws SQLException {\n-        return call.getCharacterStream(parameterIndex);\n-    }\n-\n-    @Override public Reader getCharacterStream(String parameterName) throws SQLException {\n-        return call.getCharacterStream(parameterName);\n-    }\n-\n-    @Override public void setBlob(String parameterName, Blob x) throws SQLException {\n-        call.setBlob(parameterName, x);\n-    }\n-\n-    @Override public void setClob(String parameterName, Clob x) throws SQLException {\n-        call.setClob(parameterName, x);\n-    }\n-\n-    @Override public void setAsciiStream(String parameterName, InputStream x, long length) throws SQLException {\n-        call.setAsciiStream(parameterName, x, length);\n-    }\n-\n-    @Override public void setBinaryStream(String parameterName, InputStream x, long length) throws SQLException {\n-        call.setBinaryStream(parameterName, x, length);\n-    }\n-\n-    @Override public void setCharacterStream(String parameterName, Reader reader, long length) throws SQLException {\n-        call.setCharacterStream(parameterName, reader, length);\n-    }\n-\n-    @Override public void setAsciiStream(String parameterName, InputStream x) throws SQLException {\n-        call.setAsciiStream(parameterName, x);\n-    }\n-\n-    @Override public void setBinaryStream(String parameterName, InputStream x) throws SQLException {\n-        call.setBinaryStream(parameterName, x);\n-    }\n-\n-    @Override public void setCharacterStream(String parameterName, Reader reader) throws SQLException {\n-        call.setCharacterStream(parameterName, reader);\n-    }\n-\n-    @Override public void setNCharacterStream(String parameterName, Reader value) throws SQLException {\n-        call.setNCharacterStream(parameterName, value);\n-    }\n-\n-    @Override public void setClob(String parameterName, Reader reader) throws SQLException {\n-        call.setClob(parameterName, reader);\n-    }\n-\n-    @Override public void setBlob(String parameterName, InputStream inputStream) throws SQLException {\n-        call.setBlob(parameterName, inputStream);\n-    }\n-\n-    @Override public void setNClob(String parameterName, Reader reader) throws SQLException {\n-        call.setNClob(parameterName, reader);\n-    }\n-\n-    @Override public <T> T getObject(int parameterIndex, Class<T> type) throws SQLException {\n-        return call.getObject(parameterIndex, type);\n-    }\n-\n-    @Override public <T> T getObject(String parameterName, Class<T> type) throws SQLException {\n-        return call.getObject(parameterName, type);\n-    }\n-\n-    @Override public void setObject(String parameterName, Object x, SQLType targetSqlType,\n-        int scaleOrLength) throws SQLException {\n-        call.setObject(parameterName, x, targetSqlType, scaleOrLength);\n-    }\n-\n-    @Override public void setObject(String parameterName, Object x, SQLType targetSqlType) throws SQLException {\n-        call.setObject(parameterName, x, targetSqlType);\n-    }\n-\n-    @Override public void registerOutParameter(int parameterIndex, SQLType sqlType) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType);\n-    }\n-\n-    @Override public void registerOutParameter(int parameterIndex, SQLType sqlType, int scale) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType, scale);\n-    }\n-\n-    @Override\n-    public void registerOutParameter(int parameterIndex, SQLType sqlType, String typeName) throws SQLException {\n-        call.registerOutParameter(parameterIndex, sqlType, typeName);\n-    }\n-\n-    @Override public void registerOutParameter(String parameterName, SQLType sqlType) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType);\n-    }\n-\n-    @Override public void registerOutParameter(String parameterName, SQLType sqlType, int scale) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType, scale);\n-    }\n-\n-    @Override\n-    public void registerOutParameter(String parameterName, SQLType sqlType, String typeName) throws SQLException {\n-        call.registerOutParameter(parameterName, sqlType, typeName);\n-    }\n-\n-    private final CallableStatement call;\n-    private final String sql;\n-\n-    public CallableStatementWrapper(CallableStatement call, ConnectionInfo connectionInfo, String sql) {\n-        super(call, connectionInfo, sql, \"Callable\");\n-        this.call = call;\n-        this.sql = sql;\n-    }\n-\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/CallableStatementWrapper.java",
                "sha": "78811f7e8efa0c9187b148a3a5ede76f6c33fd02",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/JdbcConnectionWrapper.java",
                "changes": 652,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/JdbcConnectionWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 652,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/JdbcConnectionWrapper.java",
                "patch": "@@ -1,652 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import com.mysql.cj.api.exceptions.ExceptionInterceptor;\n-import com.mysql.cj.api.jdbc.ClientInfoProvider;\n-import com.mysql.cj.api.jdbc.JdbcConnection;\n-import com.mysql.cj.api.jdbc.JdbcPropertySet;\n-import com.mysql.cj.api.jdbc.interceptors.StatementInterceptor;\n-import com.mysql.cj.api.jdbc.result.ResultSetInternalMethods;\n-import com.mysql.cj.api.mysqla.io.PacketPayload;\n-import com.mysql.cj.api.mysqla.result.ColumnDefinition;\n-import com.mysql.cj.core.ServerVersion;\n-import com.mysql.cj.jdbc.ServerPreparedStatement;\n-import com.mysql.cj.jdbc.StatementImpl;\n-import com.mysql.cj.jdbc.result.CachedResultSetMetaData;\n-import com.mysql.cj.mysqla.MysqlaSession;\n-import java.sql.Array;\n-import java.sql.Blob;\n-import java.sql.CallableStatement;\n-import java.sql.Clob;\n-import java.sql.DatabaseMetaData;\n-import java.sql.NClob;\n-import java.sql.PreparedStatement;\n-import java.sql.SQLClientInfoException;\n-import java.sql.SQLException;\n-import java.sql.SQLWarning;\n-import java.sql.SQLXML;\n-import java.sql.Savepoint;\n-import java.sql.Statement;\n-import java.sql.Struct;\n-import java.util.List;\n-import java.util.Map;\n-import java.util.Properties;\n-import java.util.Timer;\n-import java.util.concurrent.Executor;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class JdbcConnectionWrapper implements JdbcConnection, EnhancedInstance {\n-\n-    public JdbcConnectionWrapper(JdbcConnection delegate, ConnectionInfo connectionInfo) {\n-        this.delegate = delegate;\n-        this.connectionInfo = connectionInfo;\n-    }\n-\n-    public JdbcPropertySet getPropertySet() {\n-        return delegate.getPropertySet();\n-    }\n-\n-    public MysqlaSession getSession() {\n-        return delegate.getSession();\n-    }\n-\n-    public void changeUser(String s, String s1) throws SQLException {\n-        delegate.changeUser(s, s1);\n-    }\n-\n-    @Deprecated public void clearHasTriedMaster() {\n-        delegate.clearHasTriedMaster();\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s) throws SQLException {\n-        return delegate.clientPrepareStatement(s);\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s, int i) throws SQLException {\n-        return delegate.clientPrepareStatement(s, i);\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s, int i, int i1) throws SQLException {\n-        return delegate.clientPrepareStatement(s, i, i1);\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s, int[] ints) throws SQLException {\n-        return delegate.clientPrepareStatement(s, ints);\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s, int i, int i1, int i2) throws SQLException {\n-        return delegate.clientPrepareStatement(s, i, i1, i2);\n-    }\n-\n-    public PreparedStatement clientPrepareStatement(String s, String[] strings) throws SQLException {\n-        return delegate.clientPrepareStatement(s, strings);\n-    }\n-\n-    public int getActiveStatementCount() {\n-        return delegate.getActiveStatementCount();\n-    }\n-\n-    public long getIdleFor() {\n-        return delegate.getIdleFor();\n-    }\n-\n-    public String getStatementComment() {\n-        return delegate.getStatementComment();\n-    }\n-\n-    @Deprecated public boolean hasTriedMaster() {\n-        return delegate.hasTriedMaster();\n-    }\n-\n-    public boolean isInGlobalTx() {\n-        return delegate.isInGlobalTx();\n-    }\n-\n-    public void setInGlobalTx(boolean b) {\n-        delegate.setInGlobalTx(b);\n-    }\n-\n-    public boolean isMasterConnection() {\n-        return delegate.isMasterConnection();\n-    }\n-\n-    public boolean isNoBackslashEscapesSet() {\n-        return delegate.isNoBackslashEscapesSet();\n-    }\n-\n-    public boolean isSameResource(JdbcConnection connection) {\n-        return delegate.isSameResource(connection);\n-    }\n-\n-    public boolean lowerCaseTableNames() {\n-        return delegate.lowerCaseTableNames();\n-    }\n-\n-    public void ping() throws SQLException {\n-        delegate.ping();\n-    }\n-\n-    public void resetServerState() throws SQLException {\n-        delegate.resetServerState();\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s) throws SQLException {\n-        return delegate.serverPrepareStatement(s);\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s, int i) throws SQLException {\n-        return delegate.serverPrepareStatement(s, i);\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s, int i, int i1) throws SQLException {\n-        return delegate.serverPrepareStatement(s, i, i1);\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s, int i, int i1, int i2) throws SQLException {\n-        return delegate.serverPrepareStatement(s, i, i1, i2);\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s, int[] ints) throws SQLException {\n-        return delegate.serverPrepareStatement(s, ints);\n-    }\n-\n-    public PreparedStatement serverPrepareStatement(String s, String[] strings) throws SQLException {\n-        return delegate.serverPrepareStatement(s, strings);\n-    }\n-\n-    public void setFailedOver(boolean b) {\n-        delegate.setFailedOver(b);\n-    }\n-\n-    public void setStatementComment(String s) {\n-        delegate.setStatementComment(s);\n-    }\n-\n-    public void shutdownServer() throws SQLException {\n-        delegate.shutdownServer();\n-    }\n-\n-    public void reportQueryTime(long l) {\n-        delegate.reportQueryTime(l);\n-    }\n-\n-    public boolean isAbonormallyLongQuery(long l) {\n-        return delegate.isAbonormallyLongQuery(l);\n-    }\n-\n-    public int getAutoIncrementIncrement() {\n-        return delegate.getAutoIncrementIncrement();\n-    }\n-\n-    public boolean hasSameProperties(JdbcConnection connection) {\n-        return delegate.hasSameProperties(connection);\n-    }\n-\n-    public String getHost() {\n-        return delegate.getHost();\n-    }\n-\n-    public String getHostPortPair() {\n-        return delegate.getHostPortPair();\n-    }\n-\n-    public void setProxy(JdbcConnection connection) {\n-        delegate.setProxy(connection);\n-    }\n-\n-    public boolean isServerLocal() throws SQLException {\n-        return delegate.isServerLocal();\n-    }\n-\n-    public int getSessionMaxRows() {\n-        return delegate.getSessionMaxRows();\n-    }\n-\n-    public void setSessionMaxRows(int i) throws SQLException {\n-        delegate.setSessionMaxRows(i);\n-    }\n-\n-    public void setSchema(String s) throws SQLException {\n-        delegate.setSchema(s);\n-    }\n-\n-    public void abortInternal() throws SQLException {\n-        delegate.abortInternal();\n-    }\n-\n-    public void checkClosed() {\n-        delegate.checkClosed();\n-    }\n-\n-    public boolean isProxySet() {\n-        return delegate.isProxySet();\n-    }\n-\n-    public JdbcConnection duplicate() throws SQLException {\n-        return delegate.duplicate();\n-    }\n-\n-    public ResultSetInternalMethods execSQL(StatementImpl statement,\n-        String s, int i, PacketPayload payload, boolean b, String s1,\n-        ColumnDefinition definition) throws SQLException {\n-        return delegate.execSQL(statement, s, i, payload, b, s1, definition);\n-    }\n-\n-    public ResultSetInternalMethods execSQL(StatementImpl statement,\n-        String s, int i, PacketPayload payload, boolean b, String s1,\n-        ColumnDefinition definition, boolean b1) throws SQLException {\n-        return delegate.execSQL(statement, s, i, payload, b, s1, definition, b1);\n-    }\n-\n-    public StringBuilder generateConnectionCommentBlock(StringBuilder builder) {\n-        return delegate.generateConnectionCommentBlock(builder);\n-    }\n-\n-    public CachedResultSetMetaData getCachedMetaData(String s) {\n-        return delegate.getCachedMetaData(s);\n-    }\n-\n-    public Timer getCancelTimer() {\n-        return delegate.getCancelTimer();\n-    }\n-\n-    public String getCharacterSetMetadata() {\n-        return delegate.getCharacterSetMetadata();\n-    }\n-\n-    public Statement getMetadataSafeStatement() throws SQLException {\n-        return delegate.getMetadataSafeStatement();\n-    }\n-\n-    public boolean getRequiresEscapingEncoder() {\n-        return delegate.getRequiresEscapingEncoder();\n-    }\n-\n-    public ServerVersion getServerVersion() {\n-        return delegate.getServerVersion();\n-    }\n-\n-    public List<StatementInterceptor> getStatementInterceptorsInstances() {\n-        return delegate.getStatementInterceptorsInstances();\n-    }\n-\n-    public void incrementNumberOfPreparedExecutes() {\n-        delegate.incrementNumberOfPreparedExecutes();\n-    }\n-\n-    public void incrementNumberOfPrepares() {\n-        delegate.incrementNumberOfPrepares();\n-    }\n-\n-    public void incrementNumberOfResultSetsCreated() {\n-        delegate.incrementNumberOfResultSetsCreated();\n-    }\n-\n-    public void initializeResultsMetadataFromCache(String s, CachedResultSetMetaData data,\n-        ResultSetInternalMethods methods) throws SQLException {\n-        delegate.initializeResultsMetadataFromCache(s, data, methods);\n-    }\n-\n-    public void initializeSafeStatementInterceptors() throws SQLException {\n-        delegate.initializeSafeStatementInterceptors();\n-    }\n-\n-    public boolean isReadInfoMsgEnabled() {\n-        return delegate.isReadInfoMsgEnabled();\n-    }\n-\n-    public boolean isReadOnly(boolean b) throws SQLException {\n-        return delegate.isReadOnly(b);\n-    }\n-\n-    public void pingInternal(boolean b, int i) throws SQLException {\n-        delegate.pingInternal(b, i);\n-    }\n-\n-    public void realClose(boolean b, boolean b1, boolean b2, Throwable throwable) throws SQLException {\n-        delegate.realClose(b, b1, b2, throwable);\n-    }\n-\n-    public void recachePreparedStatement(ServerPreparedStatement statement) throws SQLException {\n-        delegate.recachePreparedStatement(statement);\n-    }\n-\n-    public void decachePreparedStatement(ServerPreparedStatement statement) throws SQLException {\n-        delegate.decachePreparedStatement(statement);\n-    }\n-\n-    public void registerQueryExecutionTime(long l) {\n-        delegate.registerQueryExecutionTime(l);\n-    }\n-\n-    public void registerStatement(com.mysql.cj.api.jdbc.Statement statement) {\n-        delegate.registerStatement(statement);\n-    }\n-\n-    public void reportNumberOfTablesAccessed(int i) {\n-        delegate.reportNumberOfTablesAccessed(i);\n-    }\n-\n-    public void setReadInfoMsgEnabled(boolean b) {\n-        delegate.setReadInfoMsgEnabled(b);\n-    }\n-\n-    public void setReadOnlyInternal(boolean b) throws SQLException {\n-        delegate.setReadOnlyInternal(b);\n-    }\n-\n-    public boolean storesLowerCaseTableName() {\n-        return delegate.storesLowerCaseTableName();\n-    }\n-\n-    public void throwConnectionClosedException() throws SQLException {\n-        delegate.throwConnectionClosedException();\n-    }\n-\n-    public void transactionBegun() throws SQLException {\n-        delegate.transactionBegun();\n-    }\n-\n-    public void transactionCompleted() throws SQLException {\n-        delegate.transactionCompleted();\n-    }\n-\n-    public void unregisterStatement(com.mysql.cj.api.jdbc.Statement statement) {\n-        delegate.unregisterStatement(statement);\n-    }\n-\n-    public void unSafeStatementInterceptors() throws SQLException {\n-        delegate.unSafeStatementInterceptors();\n-    }\n-\n-    public boolean useAnsiQuotedIdentifiers() {\n-        return delegate.useAnsiQuotedIdentifiers();\n-    }\n-\n-    public JdbcConnection getMultiHostSafeProxy() {\n-        return delegate.getMultiHostSafeProxy();\n-    }\n-\n-    public ClientInfoProvider getClientInfoProviderImpl() throws SQLException {\n-        return delegate.getClientInfoProviderImpl();\n-    }\n-\n-    public Statement createStatement() throws SQLException {\n-        return new StatementWrapper(delegate.createStatement(), connectionInfo);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql), connectionInfo, sql);\n-    }\n-\n-    public CallableStatement prepareCall(String sql) throws SQLException {\n-        return new CallableStatementWrapper(delegate.prepareCall(sql), connectionInfo, sql);\n-    }\n-\n-    public String nativeSQL(String sql) throws SQLException {\n-        return delegate.nativeSQL(sql);\n-    }\n-\n-    public void setAutoCommit(boolean autoCommit) throws SQLException {\n-        delegate.setAutoCommit(autoCommit);\n-    }\n-\n-    public boolean getAutoCommit() throws SQLException {\n-        return delegate.getAutoCommit();\n-    }\n-\n-    public void commit() throws SQLException {\n-        delegate.commit();\n-    }\n-\n-    public void rollback() throws SQLException {\n-        delegate.rollback();\n-    }\n-\n-    public void close() throws SQLException {\n-        delegate.close();\n-    }\n-\n-    public boolean isClosed() throws SQLException {\n-        return delegate.isClosed();\n-    }\n-\n-    public DatabaseMetaData getMetaData() throws SQLException {\n-        return delegate.getMetaData();\n-    }\n-\n-    public void setReadOnly(boolean readOnly) throws SQLException {\n-        delegate.setReadOnly(readOnly);\n-    }\n-\n-    public boolean isReadOnly() throws SQLException {\n-        return delegate.isReadOnly();\n-    }\n-\n-    public void setCatalog(String catalog) throws SQLException {\n-        delegate.setCatalog(catalog);\n-    }\n-\n-    public String getCatalog() throws SQLException {\n-        return delegate.getCatalog();\n-    }\n-\n-    public void setTransactionIsolation(int level) throws SQLException {\n-        delegate.setTransactionIsolation(level);\n-    }\n-\n-    public int getTransactionIsolation() throws SQLException {\n-        return delegate.getTransactionIsolation();\n-    }\n-\n-    public SQLWarning getWarnings() throws SQLException {\n-        return delegate.getWarnings();\n-    }\n-\n-    public void clearWarnings() throws SQLException {\n-        delegate.clearWarnings();\n-    }\n-\n-    public Statement createStatement(int resultSetType, int resultSetConcurrency) throws SQLException {\n-        return new StatementWrapper(delegate.createStatement(resultSetType, resultSetConcurrency), connectionInfo);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql, int resultSetType,\n-        int resultSetConcurrency) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql, resultSetType, resultSetConcurrency), connectionInfo, sql);\n-    }\n-\n-    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency) throws SQLException {\n-        return new CallableStatementWrapper(delegate.prepareCall(sql, resultSetType, resultSetConcurrency), connectionInfo, sql);\n-    }\n-\n-    public Map<String, Class<?>> getTypeMap() throws SQLException {\n-        return delegate.getTypeMap();\n-    }\n-\n-    public void setTypeMap(Map<String, Class<?>> map) throws SQLException {\n-        delegate.setTypeMap(map);\n-    }\n-\n-    public void setHoldability(int holdability) throws SQLException {\n-        delegate.setHoldability(holdability);\n-    }\n-\n-    public int getHoldability() throws SQLException {\n-        return delegate.getHoldability();\n-    }\n-\n-    public Savepoint setSavepoint() throws SQLException {\n-        return delegate.setSavepoint();\n-    }\n-\n-    public Savepoint setSavepoint(String name) throws SQLException {\n-        return delegate.setSavepoint(name);\n-    }\n-\n-    public void rollback(Savepoint savepoint) throws SQLException {\n-        delegate.rollback(savepoint);\n-    }\n-\n-    public void releaseSavepoint(Savepoint savepoint) throws SQLException {\n-        delegate.releaseSavepoint(savepoint);\n-    }\n-\n-    public Statement createStatement(int resultSetType, int resultSetConcurrency,\n-        int resultSetHoldability) throws SQLException {\n-        return new StatementWrapper(delegate.createStatement(resultSetType, resultSetConcurrency, resultSetHoldability), connectionInfo);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency,\n-        int resultSetHoldability) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql, resultSetType, resultSetConcurrency, resultSetHoldability), connectionInfo, sql);\n-    }\n-\n-    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency,\n-        int resultSetHoldability) throws SQLException {\n-        return new CallableStatementWrapper(delegate.prepareCall(sql, resultSetType, resultSetConcurrency, resultSetHoldability), connectionInfo, sql);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql, int autoGeneratedKeys) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql, autoGeneratedKeys), connectionInfo, sql);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql, int[] columnIndexes) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql, columnIndexes), connectionInfo, sql);\n-    }\n-\n-    public PreparedStatement prepareStatement(String sql, String[] columnNames) throws SQLException {\n-        return new PreparedStatementWrapper(delegate.prepareStatement(sql, columnNames), connectionInfo, sql);\n-    }\n-\n-    public Clob createClob() throws SQLException {\n-        return delegate.createClob();\n-    }\n-\n-    public Blob createBlob() throws SQLException {\n-        return delegate.createBlob();\n-    }\n-\n-    public NClob createNClob() throws SQLException {\n-        return delegate.createNClob();\n-    }\n-\n-    public SQLXML createSQLXML() throws SQLException {\n-        return delegate.createSQLXML();\n-    }\n-\n-    public boolean isValid(int timeout) throws SQLException {\n-        return delegate.isValid(timeout);\n-    }\n-\n-    public void setClientInfo(String name, String value) throws SQLClientInfoException {\n-        delegate.setClientInfo(name, value);\n-    }\n-\n-    public void setClientInfo(Properties properties) throws SQLClientInfoException {\n-        delegate.setClientInfo(properties);\n-    }\n-\n-    public String getClientInfo(String name) throws SQLException {\n-        return delegate.getClientInfo(name);\n-    }\n-\n-    public Properties getClientInfo() throws SQLException {\n-        return delegate.getClientInfo();\n-    }\n-\n-    public Array createArrayOf(String typeName, Object[] elements) throws SQLException {\n-        return delegate.createArrayOf(typeName, elements);\n-    }\n-\n-    public Struct createStruct(String typeName, Object[] attributes) throws SQLException {\n-        return delegate.createStruct(typeName, attributes);\n-    }\n-\n-    public String getSchema() throws SQLException {\n-        return delegate.getSchema();\n-    }\n-\n-    public void abort(Executor executor) throws SQLException {\n-        delegate.abort(executor);\n-    }\n-\n-    public void setNetworkTimeout(Executor executor, int milliseconds) throws SQLException {\n-        delegate.setNetworkTimeout(executor, milliseconds);\n-    }\n-\n-    public int getNetworkTimeout() throws SQLException {\n-        return delegate.getNetworkTimeout();\n-    }\n-\n-    public <T> T unwrap(Class<T> iface) throws SQLException {\n-        return delegate.unwrap(iface);\n-    }\n-\n-    public boolean isWrapperFor(Class<?> iface) throws SQLException {\n-        return delegate.isWrapperFor(iface);\n-    }\n-\n-    public void createNewIO(boolean b) {\n-        delegate.createNewIO(b);\n-    }\n-\n-    public long getId() {\n-        return delegate.getId();\n-    }\n-\n-    public Properties getProperties() {\n-        return delegate.getProperties();\n-    }\n-\n-    public String getProcessHost() {\n-        return delegate.getProcessHost();\n-    }\n-\n-    public Object getConnectionMutex() {\n-        return delegate.getConnectionMutex();\n-    }\n-\n-    public String getURL() {\n-        return delegate.getURL();\n-    }\n-\n-    public String getUser() {\n-        return delegate.getUser();\n-    }\n-\n-    public ExceptionInterceptor getExceptionInterceptor() {\n-        return delegate.getExceptionInterceptor();\n-    }\n-\n-    private final JdbcConnection delegate;\n-    private final ConnectionInfo connectionInfo;\n-    private Object dynamicField;\n-\n-    @Override\n-    public Object getSkyWalkingDynamicField() {\n-        return dynamicField;\n-    }\n-\n-    @Override\n-    public void setSkyWalkingDynamicField(Object value) {\n-        this.dynamicField = value;\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/JdbcConnectionWrapper.java",
                "sha": "016d5d395f47b2359435df20d2e9bd7be9937b92",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/LoadBalancedConnectionWrapper.java",
                "changes": 48,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/LoadBalancedConnectionWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 48,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/LoadBalancedConnectionWrapper.java",
                "patch": "@@ -1,48 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import com.mysql.cj.api.jdbc.ha.LoadBalancedConnection;\n-import java.sql.SQLException;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class LoadBalancedConnectionWrapper extends JdbcConnectionWrapper implements LoadBalancedConnection {\n-\n-    @Override\n-    public boolean addHost(String s) throws SQLException {\n-        return delegate.addHost(s);\n-    }\n-\n-    @Override public void removeHost(String s) throws SQLException {\n-        delegate.removeHost(s);\n-    }\n-\n-    @Override public void removeHostWhenNotInUse(String s) throws SQLException {\n-        delegate.removeHostWhenNotInUse(s);\n-    }\n-\n-    @Override public void ping(boolean b) throws SQLException {\n-        delegate.ping(b);\n-    }\n-\n-    private LoadBalancedConnection delegate;\n-\n-    public LoadBalancedConnectionWrapper(LoadBalancedConnection delegate, ConnectionInfo info) {\n-        super(delegate, info);\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/LoadBalancedConnectionWrapper.java",
                "sha": "a3bc07e3deb4f752c1bce9779deed1eb8f457c79",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/PreparedStatementWrapper.java",
                "changes": 303,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/PreparedStatementWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 303,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/PreparedStatementWrapper.java",
                "patch": "@@ -1,303 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import java.io.InputStream;\n-import java.io.Reader;\n-import java.math.BigDecimal;\n-import java.net.URL;\n-import java.sql.Array;\n-import java.sql.Blob;\n-import java.sql.Clob;\n-import java.sql.Date;\n-import java.sql.NClob;\n-import java.sql.ParameterMetaData;\n-import java.sql.PreparedStatement;\n-import java.sql.Ref;\n-import java.sql.ResultSet;\n-import java.sql.ResultSetMetaData;\n-import java.sql.RowId;\n-import java.sql.SQLException;\n-import java.sql.SQLType;\n-import java.sql.SQLXML;\n-import java.sql.Time;\n-import java.sql.Timestamp;\n-import java.util.Calendar;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class PreparedStatementWrapper extends StatementWrapper implements PreparedStatement {\n-\n-    public PreparedStatementWrapper(PreparedStatement statement, ConnectionInfo connectionInfo, String sql,\n-        String statementType) {\n-        super(statement, connectionInfo, statementType);\n-        this.statement = statement;\n-        this.sql = sql;\n-    }\n-\n-    public PreparedStatementWrapper(PreparedStatement statement, ConnectionInfo connectionInfo, String sql) {\n-        this(statement, connectionInfo, sql, \"PreparedStatement\");\n-    }\n-\n-    @Override public ResultSet executeQuery() throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeQuery\", sql, stateType, new TracingUtils.Executable<ResultSet>() {\n-            @Override public ResultSet exe(String sql) throws SQLException {\n-                return statement.executeQuery();\n-            }\n-        });\n-    }\n-\n-    @Override public int executeUpdate() throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeUpdate\", sql, stateType, new TracingUtils.Executable<Integer>() {\n-            @Override public Integer exe(String sql) throws SQLException {\n-                return statement.executeUpdate();\n-            }\n-        });\n-    }\n-\n-    @Override public void setNull(int parameterIndex, int sqlType) throws SQLException {\n-        statement.setNull(parameterIndex, sqlType);\n-    }\n-\n-    @Override public void setBoolean(int parameterIndex, boolean x) throws SQLException {\n-        statement.setBoolean(parameterIndex, x);\n-    }\n-\n-    @Override public void setByte(int parameterIndex, byte x) throws SQLException {\n-        statement.setByte(parameterIndex, x);\n-    }\n-\n-    @Override public void setShort(int parameterIndex, short x) throws SQLException {\n-        statement.setShort(parameterIndex, x);\n-    }\n-\n-    @Override public void setInt(int parameterIndex, int x) throws SQLException {\n-        statement.setInt(parameterIndex, x);\n-    }\n-\n-    @Override public void setLong(int parameterIndex, long x) throws SQLException {\n-        statement.setLong(parameterIndex, x);\n-    }\n-\n-    @Override public void setFloat(int parameterIndex, float x) throws SQLException {\n-        statement.setFloat(parameterIndex, x);\n-    }\n-\n-    @Override public void setDouble(int parameterIndex, double x) throws SQLException {\n-        statement.setDouble(parameterIndex, x);\n-    }\n-\n-    @Override public void setBigDecimal(int parameterIndex, BigDecimal x) throws SQLException {\n-        statement.setBigDecimal(parameterIndex, x);\n-    }\n-\n-    @Override public void setString(int parameterIndex, String x) throws SQLException {\n-        statement.setString(parameterIndex, x);\n-    }\n-\n-    @Override public void setBytes(int parameterIndex, byte[] x) throws SQLException {\n-        statement.setBytes(parameterIndex, x);\n-    }\n-\n-    @Override public void setDate(int parameterIndex, Date x) throws SQLException {\n-        statement.setDate(parameterIndex, x);\n-    }\n-\n-    @Override public void setTime(int parameterIndex, Time x) throws SQLException {\n-        statement.setTime(parameterIndex, x);\n-    }\n-\n-    @Override public void setTimestamp(int parameterIndex, Timestamp x) throws SQLException {\n-        statement.setTimestamp(parameterIndex, x);\n-    }\n-\n-    @Override public void setAsciiStream(int parameterIndex, InputStream x, int length) throws SQLException {\n-        statement.setAsciiStream(parameterIndex, x, length);\n-    }\n-\n-    @Override @Deprecated\n-    public void setUnicodeStream(int parameterIndex, InputStream x, int length) throws SQLException {\n-        statement.setUnicodeStream(parameterIndex, x, length);\n-    }\n-\n-    @Override public void setBinaryStream(int parameterIndex, InputStream x, int length) throws SQLException {\n-        statement.setBinaryStream(parameterIndex, x, length);\n-    }\n-\n-    @Override public void clearParameters() throws SQLException {\n-        statement.clearParameters();\n-    }\n-\n-    @Override public void setObject(int parameterIndex, Object x, int targetSqlType) throws SQLException {\n-        statement.setObject(parameterIndex, x, targetSqlType);\n-    }\n-\n-    @Override public void setObject(int parameterIndex, Object x) throws SQLException {\n-        statement.setObject(parameterIndex, x);\n-    }\n-\n-    @Override public boolean execute() throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"execute\", sql, stateType, new TracingUtils.Executable<Boolean>() {\n-            @Override public Boolean exe(String sql) throws SQLException {\n-                return statement.execute();\n-            }\n-        });\n-    }\n-\n-    @Override public void addBatch() throws SQLException {\n-        statement.addBatch();\n-    }\n-\n-    @Override public void setCharacterStream(int parameterIndex, Reader reader, int length) throws SQLException {\n-        statement.setCharacterStream(parameterIndex, reader, length);\n-    }\n-\n-    @Override public void setRef(int parameterIndex, Ref x) throws SQLException {\n-        statement.setRef(parameterIndex, x);\n-    }\n-\n-    @Override public void setBlob(int parameterIndex, Blob x) throws SQLException {\n-        statement.setBlob(parameterIndex, x);\n-    }\n-\n-    @Override public void setClob(int parameterIndex, Clob x) throws SQLException {\n-        statement.setClob(parameterIndex, x);\n-    }\n-\n-    @Override public void setArray(int parameterIndex, Array x) throws SQLException {\n-        statement.setArray(parameterIndex, x);\n-    }\n-\n-    @Override public ResultSetMetaData getMetaData() throws SQLException {\n-        return statement.getMetaData();\n-    }\n-\n-    @Override public void setDate(int parameterIndex, Date x, Calendar cal) throws SQLException {\n-        statement.setDate(parameterIndex, x, cal);\n-    }\n-\n-    @Override public void setTime(int parameterIndex, Time x, Calendar cal) throws SQLException {\n-        statement.setTime(parameterIndex, x, cal);\n-    }\n-\n-    @Override public void setTimestamp(int parameterIndex, Timestamp x, Calendar cal) throws SQLException {\n-        statement.setTimestamp(parameterIndex, x, cal);\n-    }\n-\n-    @Override public void setNull(int parameterIndex, int sqlType, String typeName) throws SQLException {\n-        statement.setNull(parameterIndex, sqlType, typeName);\n-    }\n-\n-    @Override public void setURL(int parameterIndex, URL x) throws SQLException {\n-        statement.setURL(parameterIndex, x);\n-    }\n-\n-    @Override public ParameterMetaData getParameterMetaData() throws SQLException {\n-        return statement.getParameterMetaData();\n-    }\n-\n-    @Override public void setRowId(int parameterIndex, RowId x) throws SQLException {\n-        statement.setRowId(parameterIndex, x);\n-    }\n-\n-    @Override public void setNString(int parameterIndex, String value) throws SQLException {\n-        statement.setNString(parameterIndex, value);\n-    }\n-\n-    @Override public void setNCharacterStream(int parameterIndex, Reader value, long length) throws SQLException {\n-        statement.setNCharacterStream(parameterIndex, value, length);\n-    }\n-\n-    @Override public void setNClob(int parameterIndex, NClob value) throws SQLException {\n-        statement.setNClob(parameterIndex, value);\n-    }\n-\n-    @Override public void setClob(int parameterIndex, Reader reader, long length) throws SQLException {\n-        statement.setClob(parameterIndex, reader, length);\n-    }\n-\n-    @Override public void setBlob(int parameterIndex, InputStream inputStream, long length) throws SQLException {\n-        statement.setBlob(parameterIndex, inputStream, length);\n-    }\n-\n-    @Override public void setNClob(int parameterIndex, Reader reader, long length) throws SQLException {\n-        statement.setNClob(parameterIndex, reader, length);\n-    }\n-\n-    @Override public void setSQLXML(int parameterIndex, SQLXML xmlObject) throws SQLException {\n-        statement.setSQLXML(parameterIndex, xmlObject);\n-    }\n-\n-    @Override\n-    public void setObject(int parameterIndex, Object x, int targetSqlType, int scaleOrLength) throws SQLException {\n-        statement.setObject(parameterIndex, x, targetSqlType, scaleOrLength);\n-    }\n-\n-    @Override public void setAsciiStream(int parameterIndex, InputStream x, long length) throws SQLException {\n-        statement.setAsciiStream(parameterIndex, x, length);\n-    }\n-\n-    @Override public void setBinaryStream(int parameterIndex, InputStream x, long length) throws SQLException {\n-        statement.setBinaryStream(parameterIndex, x, length);\n-    }\n-\n-    @Override public void setCharacterStream(int parameterIndex, Reader reader, long length) throws SQLException {\n-        statement.setCharacterStream(parameterIndex, reader, length);\n-    }\n-\n-    @Override public void setAsciiStream(int parameterIndex, InputStream x) throws SQLException {\n-        statement.setAsciiStream(parameterIndex, x);\n-    }\n-\n-    @Override public void setBinaryStream(int parameterIndex, InputStream x) throws SQLException {\n-        statement.setBinaryStream(parameterIndex, x);\n-    }\n-\n-    @Override public void setCharacterStream(int parameterIndex, Reader reader) throws SQLException {\n-        statement.setCharacterStream(parameterIndex, reader);\n-    }\n-\n-    @Override public void setNCharacterStream(int parameterIndex, Reader value) throws SQLException {\n-        statement.setNCharacterStream(parameterIndex, value);\n-    }\n-\n-    @Override public void setClob(int parameterIndex, Reader reader) throws SQLException {\n-        statement.setClob(parameterIndex, reader);\n-    }\n-\n-    @Override public void setBlob(int parameterIndex, InputStream inputStream) throws SQLException {\n-        statement.setBlob(parameterIndex, inputStream);\n-    }\n-\n-    @Override public void setNClob(int parameterIndex, Reader reader) throws SQLException {\n-        statement.setNClob(parameterIndex, reader);\n-    }\n-\n-    @Override\n-    public void setObject(int parameterIndex, Object x, SQLType targetSqlType, int scaleOrLength) throws SQLException {\n-        statement.setObject(parameterIndex, x, targetSqlType, scaleOrLength);\n-    }\n-\n-    @Override\n-    public void setObject(int parameterIndex, Object x, SQLType targetSqlType) throws SQLException {\n-        statement.setObject(parameterIndex, x, targetSqlType);\n-    }\n-\n-    private final PreparedStatement statement;\n-    private final String sql;\n-\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/PreparedStatementWrapper.java",
                "sha": "b0cb9f552b48a60acb6fa2ffef0396cbc6af239b",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/ReplicationConnectionWrapper.java",
                "changes": 80,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/ReplicationConnectionWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 80,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/ReplicationConnectionWrapper.java",
                "patch": "@@ -1,80 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import com.mysql.cj.api.jdbc.JdbcConnection;\n-import com.mysql.cj.api.jdbc.ha.ReplicationConnection;\n-import java.sql.SQLException;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class ReplicationConnectionWrapper extends JdbcConnectionWrapper implements ReplicationConnection {\n-\n-    public ReplicationConnectionWrapper(JdbcConnection delegate, ConnectionInfo connectionInfo) {\n-        super(delegate, connectionInfo);\n-    }\n-\n-    @Override public long getConnectionGroupId() {\n-        return replicationConnection.getConnectionGroupId();\n-    }\n-\n-    @Override public JdbcConnection getCurrentConnection() {\n-        return replicationConnection.getCurrentConnection();\n-    }\n-\n-    @Override public JdbcConnection getMasterConnection() {\n-        return replicationConnection.getMasterConnection();\n-    }\n-\n-    @Override public void promoteSlaveToMaster(String s) throws SQLException {\n-        replicationConnection.promoteSlaveToMaster(s);\n-    }\n-\n-    @Override public void removeMasterHost(String s) throws SQLException {\n-        replicationConnection.removeMasterHost(s);\n-    }\n-\n-    @Override public void removeMasterHost(String s, boolean b) throws SQLException {\n-        replicationConnection.removeMasterHost(s, b);\n-    }\n-\n-    @Override public boolean isHostMaster(String s) {\n-        return replicationConnection.isHostMaster(s);\n-    }\n-\n-    @Override public JdbcConnection getSlavesConnection() {\n-        return replicationConnection.getSlavesConnection();\n-    }\n-\n-    @Override public void addSlaveHost(String s) throws SQLException {\n-        replicationConnection.addSlaveHost(s);\n-    }\n-\n-    @Override public void removeSlave(String s) throws SQLException {\n-        replicationConnection.removeSlave(s);\n-    }\n-\n-    @Override public void removeSlave(String s, boolean b) throws SQLException {\n-        replicationConnection.removeSlave(s, b);\n-    }\n-\n-    @Override public boolean isHostSlave(String s) {\n-        return replicationConnection.isHostSlave(s);\n-    }\n-\n-    private ReplicationConnection replicationConnection;\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/ReplicationConnectionWrapper.java",
                "sha": "e1453f37b9809ec8cd432e8dd7c74812b898fc78",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/StatementWrapper.java",
                "changes": 307,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/StatementWrapper.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 307,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/StatementWrapper.java",
                "patch": "@@ -1,307 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import java.sql.Connection;\n-import java.sql.ResultSet;\n-import java.sql.SQLException;\n-import java.sql.SQLWarning;\n-import java.sql.Statement;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class StatementWrapper implements Statement {\n-\n-    @Override\n-    public ResultSet executeQuery(String sql) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeQuery\", sql, stateType, new TracingUtils.Executable<ResultSet>() {\n-            @Override public ResultSet exe(String sql) throws SQLException {\n-                return statement.executeQuery(sql);\n-            }\n-        });\n-    }\n-\n-    @Override public int executeUpdate(String sql) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeUpdate\", sql, stateType, new TracingUtils.Executable<Integer>() {\n-            @Override public Integer exe(String sql) throws SQLException {\n-                return statement.executeUpdate(sql);\n-            }\n-        });\n-    }\n-\n-    @Override public void close() throws SQLException {\n-        statement.close();\n-    }\n-\n-    @Override public int getMaxFieldSize() throws SQLException {\n-        return statement.getMaxFieldSize();\n-    }\n-\n-    @Override public void setMaxFieldSize(int max) throws SQLException {\n-        statement.setMaxFieldSize(max);\n-    }\n-\n-    @Override public int getMaxRows() throws SQLException {\n-        return statement.getMaxRows();\n-    }\n-\n-    @Override public void setMaxRows(int max) throws SQLException {\n-        statement.setMaxRows(max);\n-    }\n-\n-    @Override public void setEscapeProcessing(boolean enable) throws SQLException {\n-        statement.setEscapeProcessing(enable);\n-    }\n-\n-    @Override public int getQueryTimeout() throws SQLException {\n-        return statement.getQueryTimeout();\n-    }\n-\n-    @Override public void setQueryTimeout(int seconds) throws SQLException {\n-        statement.setQueryTimeout(seconds);\n-    }\n-\n-    @Override public void cancel() throws SQLException {\n-        statement.cancel();\n-    }\n-\n-    @Override public SQLWarning getWarnings() throws SQLException {\n-        return statement.getWarnings();\n-    }\n-\n-    @Override public void clearWarnings() throws SQLException {\n-        statement.clearWarnings();\n-    }\n-\n-    @Override public void setCursorName(String name) throws SQLException {\n-        statement.setCursorName(name);\n-    }\n-\n-    @Override public boolean execute(String sql) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"execute\", sql, stateType, new TracingUtils.Executable<Boolean>() {\n-            @Override public Boolean exe(String sql) throws SQLException {\n-                return statement.execute(sql);\n-            }\n-        });\n-    }\n-\n-    @Override public ResultSet getResultSet() throws SQLException {\n-        return statement.getResultSet();\n-    }\n-\n-    @Override public int getUpdateCount() throws SQLException {\n-        return statement.getUpdateCount();\n-    }\n-\n-    @Override public boolean getMoreResults() throws SQLException {\n-        return statement.getMoreResults();\n-    }\n-\n-    @Override public void setFetchDirection(int direction) throws SQLException {\n-        statement.setFetchDirection(direction);\n-    }\n-\n-    @Override public int getFetchDirection() throws SQLException {\n-        return statement.getFetchDirection();\n-    }\n-\n-    @Override public void setFetchSize(int rows) throws SQLException {\n-        statement.setFetchSize(rows);\n-    }\n-\n-    @Override public int getFetchSize() throws SQLException {\n-        return statement.getFetchSize();\n-    }\n-\n-    @Override public int getResultSetConcurrency() throws SQLException {\n-        return statement.getResultSetConcurrency();\n-    }\n-\n-    @Override public int getResultSetType() throws SQLException {\n-        return statement.getResultSetType();\n-    }\n-\n-    @Override public void addBatch(String sql) throws SQLException {\n-        statement.addBatch(sql);\n-    }\n-\n-    @Override public void clearBatch() throws SQLException {\n-        statement.clearBatch();\n-    }\n-\n-    @Override public int[] executeBatch() throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeBatch\", null, stateType, new TracingUtils.Executable<int[]>() {\n-            @Override public int[] exe(String sql) throws SQLException {\n-                return statement.executeBatch();\n-            }\n-        });\n-    }\n-\n-    @Override public Connection getConnection() throws SQLException {\n-        return statement.getConnection();\n-    }\n-\n-    @Override public boolean getMoreResults(int current) throws SQLException {\n-        return statement.getMoreResults(current);\n-    }\n-\n-    @Override public ResultSet getGeneratedKeys() throws SQLException {\n-        return statement.getGeneratedKeys();\n-    }\n-\n-    @Override public int executeUpdate(String sql, final int autoGeneratedKeys) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeUpdate\", sql, stateType, new TracingUtils.Executable<Integer>() {\n-            @Override public Integer exe(String sql) throws SQLException {\n-                return statement.executeUpdate(sql, autoGeneratedKeys);\n-            }\n-        });\n-    }\n-\n-    @Override public int executeUpdate(String sql, final int[] columnIndexes) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeUpdate\", sql, stateType, new TracingUtils.Executable<Integer>() {\n-            @Override public Integer exe(String sql) throws SQLException {\n-                return statement.executeUpdate(sql, columnIndexes);\n-            }\n-        });\n-    }\n-\n-    @Override public int executeUpdate(String sql, final String[] columnNames) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeUpdate\", sql, stateType, new TracingUtils.Executable<Integer>() {\n-            @Override public Integer exe(String sql) throws SQLException {\n-                return statement.executeUpdate(sql, columnNames);\n-            }\n-        });\n-    }\n-\n-    @Override public boolean execute(String sql, final int autoGeneratedKeys) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"execute\", sql, stateType, new TracingUtils.Executable<Boolean>() {\n-            @Override public Boolean exe(String sql) throws SQLException {\n-                return statement.execute(sql, autoGeneratedKeys);\n-            }\n-        });\n-    }\n-\n-    @Override public boolean execute(String sql, final int[] columnIndexes) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"execute\", sql, stateType, new TracingUtils.Executable<Boolean>() {\n-            @Override public Boolean exe(String sql) throws SQLException {\n-                return statement.execute(sql, columnIndexes);\n-            }\n-        });\n-    }\n-\n-    @Override public boolean execute(String sql, final String[] columnNames) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"execute\", sql, stateType, new TracingUtils.Executable<Boolean>() {\n-            @Override public Boolean exe(String sql) throws SQLException {\n-                return statement.execute(sql, columnNames);\n-            }\n-        });\n-    }\n-\n-    @Override public int getResultSetHoldability() throws SQLException {\n-        return statement.getResultSetHoldability();\n-    }\n-\n-    @Override public boolean isClosed() throws SQLException {\n-        return statement.isClosed();\n-    }\n-\n-    @Override public void setPoolable(boolean poolable) throws SQLException {\n-        statement.setPoolable(poolable);\n-    }\n-\n-    @Override public boolean isPoolable() throws SQLException {\n-        return statement.isPoolable();\n-    }\n-\n-    @Override public void closeOnCompletion() throws SQLException {\n-        statement.closeOnCompletion();\n-    }\n-\n-    @Override public boolean isCloseOnCompletion() throws SQLException {\n-        return statement.isCloseOnCompletion();\n-    }\n-\n-    @Override public long getLargeUpdateCount() throws SQLException {\n-        return statement.getLargeUpdateCount();\n-    }\n-\n-    @Override public void setLargeMaxRows(long max) throws SQLException {\n-        statement.setLargeMaxRows(max);\n-    }\n-\n-    @Override public long getLargeMaxRows() throws SQLException {\n-        return statement.getLargeMaxRows();\n-    }\n-\n-    @Override public long[] executeLargeBatch() throws SQLException {\n-        return statement.executeLargeBatch();\n-    }\n-\n-    @Override public long executeLargeUpdate(String sql) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeLargeUpdate\", sql, stateType, new TracingUtils.Executable<Long>() {\n-            @Override public Long exe(String sql) throws SQLException {\n-                return statement.executeLargeUpdate(sql);\n-            }\n-        });\n-    }\n-\n-    @Override public long executeLargeUpdate(String sql, final int autoGeneratedKeys) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeLargeUpdate\", sql, stateType, new TracingUtils.Executable<Long>() {\n-            @Override public Long exe(String sql) throws SQLException {\n-                return statement.executeLargeUpdate(sql, autoGeneratedKeys);\n-            }\n-        });\n-    }\n-\n-    @Override public long executeLargeUpdate(String sql, final int[] columnIndexes) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeLargeUpdate\", sql, stateType, new TracingUtils.Executable<Long>() {\n-            @Override public Long exe(String sql) throws SQLException {\n-                return statement.executeLargeUpdate(sql, columnIndexes);\n-            }\n-        });\n-    }\n-\n-    @Override public long executeLargeUpdate(String sql, final String[] columnNames) throws SQLException {\n-        return TracingUtils.trace(connectionInfo, \"executeLargeUpdate\", sql, stateType, new TracingUtils.Executable<Long>() {\n-            @Override public Long exe(String sql) throws SQLException {\n-                return statement.executeLargeUpdate(sql, columnNames);\n-            }\n-        });\n-    }\n-\n-    private final Statement statement;\n-    protected final ConnectionInfo connectionInfo;\n-    protected final String stateType;\n-\n-    public StatementWrapper(Statement statement, ConnectionInfo connectionInfo, String stateType) {\n-        this.statement = statement;\n-        this.connectionInfo = connectionInfo;\n-        this.stateType = stateType;\n-    }\n-\n-    public StatementWrapper(Statement statement, ConnectionInfo connectionInfo) {\n-        this(statement, connectionInfo, \"Statement\");\n-    }\n-\n-    @Override public <T> T unwrap(Class<T> iface) throws SQLException {\n-        return statement.unwrap(iface);\n-    }\n-\n-    @Override public boolean isWrapperFor(Class<?> iface) throws SQLException {\n-        return statement.isWrapperFor(iface);\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/StatementWrapper.java",
                "sha": "24b46b8e393ba151363ad1ed4aa5fe0b62c0d473",
                "status": "removed"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/TracingUtils.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/TracingUtils.java?ref=f803a2ade32ac27971e306edaaa7df4e4e390dac",
                "deletions": 53,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/TracingUtils.java",
                "patch": "@@ -1,53 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *      http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- *  See the License for the specific language governing permissions and\n- *  limitations under the License.\n- */\n-\n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v6.wrapper;\n-\n-import java.sql.SQLException;\n-import org.apache.skywalking.apm.agent.core.context.ContextManager;\n-import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n-import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n-import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n-import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n-\n-public class TracingUtils {\n-\n-    public static <R> R trace(ConnectionInfo connectInfo, String method, String sql, String statementType,\n-        TracingUtils.Executable<R> exec)\n-        throws SQLException {\n-        try {\n-            AbstractSpan span = ContextManager.createExitSpan(connectInfo.getDBType() + \"/JDBI/\" + statementType + \"/\" + method, connectInfo.getDatabasePeer());\n-            Tags.DB_TYPE.set(span, \"sql\");\n-            Tags.DB_INSTANCE.set(span, connectInfo.getDatabaseName());\n-            Tags.DB_STATEMENT.set(span, sql);\n-            span.setComponent(connectInfo.getComponent());\n-            SpanLayer.asDB(span);\n-            return exec.exe(sql);\n-        } catch (SQLException e) {\n-            AbstractSpan span = ContextManager.activeSpan();\n-            span.errorOccurred();\n-            span.log(e);\n-            throw e;\n-        } finally {\n-            ContextManager.stopSpan();\n-        }\n-    }\n-\n-    public interface Executable<R> {\n-        R exe(String sql) throws SQLException;\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/f803a2ade32ac27971e306edaaa7df4e4e390dac/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v6/wrapper/TracingUtils.java",
                "sha": "2093bb5044500b1d486f4f4522595180b3d9b8b7",
                "status": "removed"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/resources/skywalking-plugin.def",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/resources/skywalking-plugin.def?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 3,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/resources/skywalking-plugin.def",
                "patch": "@@ -19,6 +19,5 @@ mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.ConnectionInstru\n mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.CallableInstrumentation\n mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.PreparedStatementInstrumentation\n mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.StatementInstrumentation\n-mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.FailoverConnectionProxyInstrumentation\n-mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.LoadBalancedConnectionProxyInstrumentation\n-mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.ReplicationConnectionProxyInstrumentation\n+mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.CacheIpsInstrumentation\n+mysql-6.x=org.apache.skywalking.apm.plugin.jdbc.mysql.v6.define.ConnectionImplCreateInstrumentation",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-6.x-plugin/src/main/resources/skywalking-plugin.def",
                "sha": "087d2af2bf81ba30469dd95e0179c9dc805cc3db",
                "status": "modified"
            },
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v8/define/PreparedStatementInstrumentation.java",
                "changes": 4,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v8/define/PreparedStatementInstrumentation.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 2,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v8/define/PreparedStatementInstrumentation.java",
                "patch": "@@ -32,7 +32,7 @@\n public class PreparedStatementInstrumentation extends AbstractMysqlInstrumentation {\n \n     private static final String PREPARED_STATEMENT_CLASS_NAME = \"com.mysql.cj.jdbc.ClientPreparedStatement\";\n-    private static final String PREPARED_STATEMENT_SERVERSIDE_CLASS_NAME = \"com.mysql.cj.jdbc.ServerPreparedStatement\";\n+    private static final String PREPARED_STATEMENT_SERVER_SIDE_CLASS_NAME = \"com.mysql.cj.jdbc.ServerPreparedStatement\";\n \n     private static final String SERVICE_METHOD_INTERCEPTOR =  Constants.PREPARED_STATEMENT_EXECUTE_METHODS_INTERCEPTOR;\n \n@@ -62,6 +62,6 @@\n     }\n \n     @Override protected ClassMatch enhanceClass() {\n-        return byMultiClassMatch(PREPARED_STATEMENT_CLASS_NAME,PREPARED_STATEMENT_SERVERSIDE_CLASS_NAME);\n+        return byMultiClassMatch(PREPARED_STATEMENT_CLASS_NAME, PREPARED_STATEMENT_SERVER_SIDE_CLASS_NAME);\n     }\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v8/define/PreparedStatementInstrumentation.java",
                "sha": "183c45d290e8178d4d1a160121fd8ab19c9b09b6",
                "status": "modified"
            },
            {
                "additions": 3,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/ConnectionCache.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/ConnectionCache.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 3,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/ConnectionCache.java",
                "patch": "@@ -16,7 +16,7 @@\n  *\n  */\n \n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v5;\n+package org.apache.skywalking.apm.plugin.jdbc.mysql;\n \n import org.apache.skywalking.apm.plugin.jdbc.trace.ConnectionInfo;\n import org.apache.skywalking.apm.util.StringUtil;\n@@ -27,9 +27,9 @@\n  * @author: dingshaocheng\n  */\n public class ConnectionCache {\n-    private static ConcurrentHashMap<String, ConnectionInfo> CONNECTIONS_MAP = new ConcurrentHashMap<String, ConnectionInfo>();\n+    private static final ConcurrentHashMap<String, ConnectionInfo> CONNECTIONS_MAP = new ConcurrentHashMap<String, ConnectionInfo>();\n \n-    private static String CONNECTION_SPLIT_STR = \",\";\n+    private static final String CONNECTION_SPLIT_STR = \",\";\n \n     public static ConnectionInfo get(String host, String port) {\n         final String connStr = String.format(\"%s:%s\", host, port);",
                "previous_filename": "apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/ConnectionCache.java",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/ConnectionCache.java",
                "sha": "d24b01cfa23264ca5e75b2c3691f3911ae4150b4",
                "status": "renamed"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/Constants.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/Constants.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/Constants.java",
                "patch": "@@ -28,4 +28,5 @@\n     public static final String PREPARED_STATEMENT_EXECUTE_METHODS_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.PreparedStatementExecuteMethodsInterceptor\";\n     public static final String SET_CATALOG_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.SetCatalogInterceptor\";\n     public static final String STATEMENT_EXECUTE_METHODS_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.StatementExecuteMethodsInterceptor\";\n+    public static final String DRIVER_CONNECT_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.jdbc.mysql.DriverConnectInterceptor\";\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/Constants.java",
                "sha": "a22c79b32e589ab4610d1961b9ab72841ba59666",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/DriverConnectInterceptor.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/DriverConnectInterceptor.java?ref=8716bb0dc56780093ff3832e2d692f4bae8982bb",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/DriverConnectInterceptor.java",
                "patch": "@@ -16,7 +16,7 @@\n  *\n  */\n \n-package org.apache.skywalking.apm.plugin.jdbc.mysql.v5;\n+package org.apache.skywalking.apm.plugin.jdbc.mysql;\n \n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;",
                "previous_filename": "apm-sniffer/apm-sdk-plugin/mysql-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/v5/DriverConnectInterceptor.java",
                "raw_url": "https://github.com/apache/skywalking/raw/8716bb0dc56780093ff3832e2d692f4bae8982bb/apm-sniffer/apm-sdk-plugin/mysql-common/src/main/java/org/apache/skywalking/apm/plugin/jdbc/mysql/DriverConnectInterceptor.java",
                "sha": "b32519f2c91a931395ca2b141d9c24509c0e67bd",
                "status": "renamed"
            }
        ],
        "message": "Fix Mysql 6.x plugin (#2803)\n\n* fix NPE\r\n\r\n* fix 6.x\r\n\r\n* optimize\r\n\r\n* add final\r\n\r\n* fix ci\r\n\r\n* Update apm-sniffer/apm-sdk-plugin/jdbc-commons/src/main/java/org/apache/skywalking/apm/plugin/jdbc/JDBCDriverInterceptor.java\r\n\r\nadd not null\r\n\r\nCo-Authored-By: Xin,Zhang <zhangxin@apache.org>",
        "parent": "https://github.com/apache/skywalking/commit/f803a2ade32ac27971e306edaaa7df4e4e390dac",
        "patched_files": [
            "JDBCDriverInterceptor.java",
            "ConnectionCreateOldInterceptor.java",
            "StatementWrapper.java",
            "CallableStatementWrapper.java",
            "ReplicationConnectionProxyInstrumentation.java",
            "skywalking-plugin.java",
            "PreparedStatementInstrumentation.java",
            "ConnectionCreateNewInterceptor.java",
            "ReplicationConnectionWrapper.java",
            "CreateLoadBalancedConnectionProxyInstanceInterceptor.java",
            "CreateReplicationConnectionProxyInstanceInterceptor.java",
            "LoadBalancedConnectionProxyInstrumentation.java",
            "Constants.java",
            "ConnectionServiceMethodInterceptor.java",
            "ConnectionCreate5xInterceptor.java",
            "MysqlURLParser.java",
            "TracingUtils.java",
            "LoadBalancedConnectionWrapper.java",
            "ConnectionImplCreateInstrumentation.java",
            "DriverConnectInterceptor.java",
            "JdbcConnectionWrapper.java",
            "CacheIpsInstrumentation.java",
            "ConnectionCache.java",
            "URLParser.java",
            "PreparedStatementWrapper.java",
            "FailoverConnectionProxyInstrumentation.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "URLParserTest.java"
        ]
    },
    "skywalking_a5d2610": {
        "bug_id": "skywalking_a5d2610",
        "commit": "https://github.com/apache/skywalking/commit/a5d261039278019b6d288d72a760ba3beda7444a",
        "file": [
            {
                "additions": 14,
                "blob_url": "https://github.com/apache/skywalking/blob/a5d261039278019b6d288d72a760ba3beda7444a/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "changes": 27,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java?ref=a5d261039278019b6d288d72a760ba3beda7444a",
                "deletions": 13,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "patch": "@@ -15,17 +15,15 @@\n  * limitations under the License.\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.patch;\n \n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n-\n import java.lang.reflect.Method;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.List;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.StaticMethodsAroundInterceptor;\n \n /**\n  * {@link AopExpressionMatchInterceptor} check if the method is match the enhanced method\n@@ -42,30 +40,33 @@ public AopExpressionMatchInterceptor() {\n     }\n \n     @Override\n-    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, MethodInterceptResult result) {\n+    public void beforeMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        MethodInterceptResult result) {\n \n     }\n \n     @Override\n-    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Object ret) {\n-        Method targetAopMethod = (Method) allArguments[1];\n-        Class<?> targetAopClass = (Class<?>) allArguments[2];\n-        if (EnhancedInstance.class.isAssignableFrom(targetAopClass) && isEnhancedMethod(targetAopMethod)) {\n+    public Object afterMethod(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        Object ret) {\n+        Method targetAopMethod = (Method)allArguments[1];\n+        Class<?> targetAopClass = (Class<?>)allArguments[2];\n+        if (targetAopClass != null && EnhancedInstance.class.isAssignableFrom(targetAopClass) && isEnhancedMethod(targetAopMethod)) {\n             return false;\n         }\n         return ret;\n     }\n \n     @Override\n-    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes, Throwable t) {\n+    public void handleMethodException(Class clazz, Method method, Object[] allArguments, Class<?>[] parameterTypes,\n+        Throwable t) {\n \n     }\n \n     private boolean isEnhancedMethod(Method targetMethod) {\n         for (Method method : methods) {\n             if (method.getName().equals(targetMethod.getName())\n-                    && method.getReturnType().equals(targetMethod.getReturnType())\n-                    && equalParamTypes(method.getParameterTypes(), targetMethod.getParameterTypes())) {\n+                && method.getReturnType().equals(targetMethod.getReturnType())\n+                && equalParamTypes(method.getParameterTypes(), targetMethod.getParameterTypes())) {\n                 return true;\n             }\n         }",
                "raw_url": "https://github.com/apache/skywalking/raw/a5d261039278019b6d288d72a760ba3beda7444a/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/AopExpressionMatchInterceptor.java",
                "sha": "5c99a886904ef3eae8d455c155c42390186dc71a",
                "status": "modified"
            }
        ],
        "message": "Fix #1488: Fix NPE when the targetAop class is null (#1507)",
        "parent": "https://github.com/apache/skywalking/commit/eed6fa18c88ad14277d17149fea92946e9cb1b40",
        "patched_files": [
            "AopExpressionMatchInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "AopExpressionMatchInterceptorTest.java"
        ]
    },
    "skywalking_a835fe4": {
        "bug_id": "skywalking_a835fe4",
        "commit": "https://github.com/apache/skywalking/commit/a835fe4ec5d41266e90ff6159d48da8d84715773",
        "file": [
            {
                "additions": 24,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/Constants.java",
                "changes": 24,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/Constants.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/Constants.java",
                "patch": "@@ -0,0 +1,24 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.hystrix.v1;\n+\n+public class Constants {\n+\n+    public static final String ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT = \"ISOLATE_STRATEGY\";\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/Constants.java",
                "sha": "97c204c92b87a113a29f5717891483cd7f8de850",
                "status": "added"
            },
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/HystrixCommandRunInterceptor.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/HystrixCommandRunInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/HystrixCommandRunInterceptor.java",
                "patch": "@@ -18,6 +18,7 @@\n \n package org.apache.skywalking.apm.plugin.hystrix.v1;\n \n+import com.netflix.hystrix.HystrixCommand;\n import java.lang.reflect.Method;\n import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.context.ContextSnapshot;\n@@ -27,6 +28,8 @@\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n \n+import static org.apache.skywalking.apm.plugin.hystrix.v1.Constants.ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT;\n+\n public class HystrixCommandRunInterceptor implements InstanceMethodsAroundInterceptor {\n     @Override\n     public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n@@ -41,6 +44,8 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         ContextManager.continued(snapshot);\n         // Because of `fall back` method running in other thread. so we need capture concurrent span for tracing.\n         enhanceRequireObjectCache.setContextSnapshot(ContextManager.capture());\n+\n+        ContextManager.getRuntimeContext().put(ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT, ((HystrixCommand)objInst).getProperties().executionIsolationStrategy().get().name().toUpperCase());\n     }\n \n     @Override",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/hystrix-1.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/hystrix/v1/HystrixCommandRunInterceptor.java",
                "sha": "c6f1bcc97e713fe33cc35cadc61b645436424435",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/HandlerMethodInvokerInterceptor.java",
                "changes": 7,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/HandlerMethodInvokerInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 3,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/HandlerMethodInvokerInterceptor.java",
                "patch": "@@ -16,16 +16,17 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v3;\n \n import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.springframework.web.context.request.NativeWebRequest;\n \n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.RESPONSE_KEY_IN_RUNTIME_CONTEXT;\n+\n /**\n  * {@link HandlerMethodInvokerInterceptor} pass the {@link NativeWebRequest} object into the {@link\n  * org.springframework.stereotype.Controller} object.\n@@ -38,7 +39,7 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         MethodInterceptResult result) throws Throwable {\n         Object handler = allArguments[1];\n         if (handler instanceof EnhancedInstance) {\n-            ((EnhanceRequireObjectCache)((EnhancedInstance)handler).getSkyWalkingDynamicField()).setNativeWebRequest((NativeWebRequest)allArguments[2]);\n+            ContextManager.getRuntimeContext().put(RESPONSE_KEY_IN_RUNTIME_CONTEXT, ((NativeWebRequest)allArguments[2]).getNativeResponse());\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/HandlerMethodInvokerInterceptor.java",
                "sha": "19f2f6e784a79d127a17c5c99d79540c98f6626d",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/AbstractSpring3Instrumentation.java",
                "changes": 1,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/AbstractSpring3Instrumentation.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/AbstractSpring3Instrumentation.java",
                "patch": "@@ -16,7 +16,6 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v3.define;\n \n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.ClassInstanceMethodsEnhancePluginDefine;",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/AbstractSpring3Instrumentation.java",
                "sha": "e534a6e0ef4ee5d2562ad7bc93584949d0212dbc",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/ControllerInstrumentation.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/ControllerInstrumentation.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/ControllerInstrumentation.java",
                "patch": "@@ -21,9 +21,9 @@\n \n import net.bytebuddy.description.method.MethodDescription;\n import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.match.ClassAnnotationMatch;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n \n import static net.bytebuddy.matcher.ElementMatchers.any;",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/ControllerInstrumentation.java",
                "sha": "dd24d03e6a9ac771c58e5364be25434a21a3bf6d",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/InvocableHandlerInstrumentation.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/InvocableHandlerInstrumentation.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 2,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/InvocableHandlerInstrumentation.java",
                "patch": "@@ -16,13 +16,12 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v3.define;\n \n import net.bytebuddy.description.method.MethodDescription;\n import net.bytebuddy.matcher.ElementMatcher;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n \n import static net.bytebuddy.matcher.ElementMatchers.named;",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/define/InvocableHandlerInstrumentation.java",
                "sha": "88f7cc6fad0a26123b97f5984d11c49596f3837e",
                "status": "modified"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/GetBeanInterceptorTest.java",
                "changes": 11,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/GetBeanInterceptorTest.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 10,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/GetBeanInterceptorTest.java",
                "patch": "@@ -16,18 +16,17 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v3;\n \n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n+import org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.GetBeanInterceptor;\n import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.mockito.Matchers;\n import org.mockito.Mock;\n import org.mockito.runners.MockitoJUnitRunner;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.GetBeanInterceptor;\n import org.springframework.web.context.request.NativeWebRequest;\n \n import static org.mockito.Mockito.times;\n@@ -62,12 +61,4 @@ public void testResultIsNotEnhanceInstance() throws Throwable {\n \n         verify(enhanceRet, times(0)).setSkyWalkingDynamicField(Matchers.any());\n     }\n-\n-    @Test\n-    public void testResultIsEnhanceInstance() throws Throwable {\n-        interceptor.afterMethod(enhancedInstance, null, null, null, enhanceRet);\n-\n-        verify(enhanceRet, times(0)).setSkyWalkingDynamicField(Matchers.any());\n-    }\n-\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/GetBeanInterceptorTest.java",
                "sha": "b4ec3f59284ed9822590b8de07d76604add78d6f",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/29f6f6e50ecc01b4f04241742c1961e8527badf2/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/InvokeForRequestInterceptorTest.java",
                "changes": 59,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/InvokeForRequestInterceptorTest.java?ref=29f6f6e50ecc01b4f04241742c1961e8527badf2",
                "deletions": 59,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/InvokeForRequestInterceptorTest.java",
                "patch": "@@ -1,59 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one or more\n- * contributor license agreements.  See the NOTICE file distributed with\n- * this work for additional information regarding copyright ownership.\n- * The ASF licenses this file to You under the Apache License, Version 2.0\n- * (the \"License\"); you may not use this file except in compliance with\n- * the License.  You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- *\n- */\n-\n-\n-package org.apache.skywalking.apm.plugin.spring.mvc.v3;\n-\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.InvokeForRequestInterceptor;\n-import org.junit.Before;\n-import org.junit.Test;\n-import org.junit.runner.RunWith;\n-import org.mockito.Matchers;\n-import org.mockito.Mock;\n-import org.mockito.runners.MockitoJUnitRunner;\n-import org.springframework.web.context.request.NativeWebRequest;\n-\n-import static org.mockito.Mockito.times;\n-import static org.mockito.Mockito.verify;\n-\n-@RunWith(MockitoJUnitRunner.class)\n-public class InvokeForRequestInterceptorTest {\n-    private InvokeForRequestInterceptor interceptor;\n-\n-    @Mock\n-    private EnhancedInstance enhancedInstance;\n-\n-    @Mock\n-    private NativeWebRequest nativeWebRequest;\n-\n-    private Object argument[];\n-\n-    @Before\n-    public void setUp() {\n-        interceptor = new InvokeForRequestInterceptor();\n-        argument = new Object[] {nativeWebRequest};\n-    }\n-\n-    @Test\n-    public void testPassNativeWebRequest() throws Throwable {\n-        interceptor.beforeMethod(enhancedInstance, null, argument, new Class[] {NativeWebRequest.class}, null);\n-\n-        verify(enhancedInstance, times(1)).setSkyWalkingDynamicField(Matchers.any());\n-    }\n-}",
                "raw_url": "https://github.com/apache/skywalking/raw/29f6f6e50ecc01b4f04241742c1961e8527badf2/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-3.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v3/InvokeForRequestInterceptorTest.java",
                "sha": "3760e1dca5a19a21c4fa36f5192a0badd4178179",
                "status": "removed"
            },
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/define/AbstractControllerInstrumentation.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/define/AbstractControllerInstrumentation.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 2,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/define/AbstractControllerInstrumentation.java",
                "patch": "@@ -16,16 +16,15 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v4.define;\n \n import net.bytebuddy.description.method.MethodDescription;\n import net.bytebuddy.matcher.ElementMatcher;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.InstanceMethodsInterceptPoint;\n import org.apache.skywalking.apm.agent.core.plugin.match.ClassAnnotationMatch;\n import org.apache.skywalking.apm.agent.core.plugin.match.ClassMatch;\n import org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.ConstructorInterceptPoint;\n \n import static net.bytebuddy.matcher.ElementMatchers.any;\n import static net.bytebuddy.matcher.ElementMatchers.isAnnotatedWith;",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/define/AbstractControllerInstrumentation.java",
                "sha": "225b657bbf256c55bf7616d9a690e2a408c24c34",
                "status": "modified"
            },
            {
                "additions": 37,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RequestMappingMethodInterceptorTest.java",
                "changes": 67,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RequestMappingMethodInterceptorTest.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 30,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RequestMappingMethodInterceptorTest.java",
                "patch": "@@ -16,48 +16,47 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v4;\n \n import java.lang.reflect.Method;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n+import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n+import org.apache.skywalking.apm.agent.core.context.trace.LogDataEntity;\n import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n+import org.apache.skywalking.apm.agent.core.context.trace.TraceSegmentRef;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.agent.test.helper.SegmentHelper;\n+import org.apache.skywalking.apm.agent.test.helper.SegmentRefHelper;\n import org.apache.skywalking.apm.agent.test.helper.SpanHelper;\n+import org.apache.skywalking.apm.agent.test.tools.AgentServiceRule;\n import org.apache.skywalking.apm.agent.test.tools.SegmentStorage;\n import org.apache.skywalking.apm.agent.test.tools.SegmentStoragePoint;\n import org.apache.skywalking.apm.agent.test.tools.SpanAssert;\n+import org.apache.skywalking.apm.agent.test.tools.TracingSegmentRunner;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n import org.apache.skywalking.apm.plugin.spring.mvc.commons.PathMappingCache;\n+import org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.RequestMappingMethodInterceptor;\n import org.junit.Before;\n import org.junit.Rule;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n import org.mockito.Mock;\n import org.powermock.modules.junit4.PowerMockRunner;\n import org.powermock.modules.junit4.PowerMockRunnerDelegate;\n-import org.apache.skywalking.apm.agent.core.context.trace.AbstractTracingSpan;\n-import org.apache.skywalking.apm.agent.core.context.trace.LogDataEntity;\n-import org.apache.skywalking.apm.agent.core.context.trace.TraceSegment;\n-import org.apache.skywalking.apm.agent.core.context.trace.TraceSegmentRef;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.agent.test.helper.SegmentRefHelper;\n-import org.apache.skywalking.apm.agent.test.tools.AgentServiceRule;\n-import org.apache.skywalking.apm.agent.test.tools.TracingSegmentRunner;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.RequestMappingMethodInterceptor;\n import org.springframework.web.bind.annotation.RequestMapping;\n import org.springframework.web.context.request.NativeWebRequest;\n import org.springframework.web.context.request.RequestContextHolder;\n import org.springframework.web.context.request.ServletRequestAttributes;\n \n+import static org.apache.skywalking.apm.agent.test.tools.SpanAssert.assertComponent;\n import static org.hamcrest.CoreMatchers.is;\n import static org.hamcrest.MatcherAssert.assertThat;\n import static org.mockito.Mockito.when;\n-import static org.apache.skywalking.apm.agent.test.tools.SpanAssert.assertComponent;\n \n @RunWith(PowerMockRunner.class)\n @PowerMockRunnerDelegate(TracingSegmentRunner.class)\n@@ -103,7 +102,6 @@ public void setUp() throws Exception {\n         when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n         when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/testRequestURL\"));\n         when(response.getStatus()).thenReturn(200);\n-        when(nativeWebRequest.getNativeResponse()).thenReturn(response);\n \n         arguments = new Object[] {request, response};\n         argumentType = new Class[] {request.getClass(), response.getClass()};\n@@ -112,31 +110,39 @@ public void setUp() throws Exception {\n \n     @Test\n     public void testWithoutSerializedContextData() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RequestMappingClass1 mappingClass1 = new RequestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"testRequestURL\");\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override\n+            public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RequestMappingClass1 mappingClass1 = new RequestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"testRequestURL\");\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n         List<AbstractTracingSpan> spans = SegmentHelper.getSpans(traceSegment);\n-\n         assertHttpSpan(spans.get(0));\n     }\n \n     @Test\n     public void testWithOccurException() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RequestMappingClass1 mappingClass1 = new RequestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"testRequestURL\");\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.handleMethodException(enhancedInstance, m, arguments, argumentType, new RuntimeException());\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RequestMappingClass1 mappingClass1 = new RequestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"testRequestURL\");\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.handleMethodException(enhancedInstance, m, arguments, argumentType, new RuntimeException());\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -168,8 +174,9 @@ private void assertHttpSpan(AbstractTracingSpan span) {\n \n         @Override\n         public Object getSkyWalkingDynamicField() {\n+\n             value.setPathMappingCache(new PathMappingCache(\"/test\"));\n-            value.setNativeWebRequest(nativeWebRequest);\n+\n             return value;\n         }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RequestMappingMethodInterceptorTest.java",
                "sha": "bedbae744ac7b28bf39041c5c8843421760cb4cc",
                "status": "modified"
            },
            {
                "additions": 103,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RestMappingMethodInterceptorTest.java",
                "changes": 176,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RestMappingMethodInterceptorTest.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 73,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RestMappingMethodInterceptorTest.java",
                "patch": "@@ -16,7 +16,6 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.v4;\n \n import java.lang.reflect.Method;\n@@ -112,16 +111,20 @@ public void setUp() throws Exception {\n \n     @Test\n     public void testGetMapping() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"getRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/getRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"getRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/getRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -132,16 +135,21 @@ public void testGetMapping() throws Throwable {\n \n     @Test\n     public void testPostMapping() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"postRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/postRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"postRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/postRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -152,16 +160,21 @@ public void testPostMapping() throws Throwable {\n \n     @Test\n     public void testPutMapping() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"putRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/putRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"putRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/putRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -172,16 +185,21 @@ public void testPutMapping() throws Throwable {\n \n     @Test\n     public void testDeleteMapping() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"deleteRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/deleteRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"deleteRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/deleteRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -192,16 +210,20 @@ public void testDeleteMapping() throws Throwable {\n \n     @Test\n     public void testPatchMapping() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"patchRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/patchRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"patchRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/patchRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -212,16 +234,21 @@ public void testPatchMapping() throws Throwable {\n \n     @Test\n     public void testDummy() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"dummy\");\n-        when(request.getRequestURI()).thenReturn(\"/test\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"dummy\");\n+                when(request.getRequestURI()).thenReturn(\"/test\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -232,17 +259,21 @@ public void testDummy() throws Throwable {\n \n     @Test\n     public void testWithOccurException() throws Throwable {\n-        controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n-        RestMappingClass1 mappingClass1 = new RestMappingClass1();\n-        Method m = mappingClass1.getClass().getMethod(\"getRequestURL\");\n-        when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n-        when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/getRequestURL\"));\n-        ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n-        RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n-\n-        interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n-        interceptor.handleMethodException(enhancedInstance, m, arguments, argumentType, new RuntimeException());\n-        interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+        SpringTestCaseHelper.createCaseHandler(request, response, new SpringTestCaseHelper.CaseHandler() {\n+            @Override public void handleCase() throws Throwable {\n+                controllerConstructorInterceptor.onConstruct(enhancedInstance, null);\n+                RestMappingClass1 mappingClass1 = new RestMappingClass1();\n+                Method m = mappingClass1.getClass().getMethod(\"getRequestURL\");\n+                when(request.getRequestURI()).thenReturn(\"/test/testRequestURL\");\n+                when(request.getRequestURL()).thenReturn(new StringBuffer(\"http://localhost:8080/test/getRequestURL\"));\n+                ServletRequestAttributes servletRequestAttributes = new ServletRequestAttributes(request, response);\n+                RequestContextHolder.setRequestAttributes(servletRequestAttributes);\n+\n+                interceptor.beforeMethod(enhancedInstance, m, arguments, argumentType, methodInterceptResult);\n+                interceptor.handleMethodException(enhancedInstance, m, arguments, argumentType, new RuntimeException());\n+                interceptor.afterMethod(enhancedInstance, m, arguments, argumentType, null);\n+            }\n+        });\n \n         assertThat(segmentStorage.getTraceSegments().size(), is(1));\n         TraceSegment traceSegment = segmentStorage.getTraceSegments().get(0);\n@@ -275,7 +306,6 @@ private void assertHttpSpan(AbstractTracingSpan span, String suffix) {\n         @Override\n         public Object getSkyWalkingDynamicField() {\n             value.setPathMappingCache(new PathMappingCache(\"/test\"));\n-            value.setNativeWebRequest(nativeWebRequest);\n             return value;\n         }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/RestMappingMethodInterceptorTest.java",
                "sha": "ccff690c5aac442bb254f3af8a7c3ed89ef95df9",
                "status": "modified"
            },
            {
                "additions": 40,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/SpringTestCaseHelper.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/SpringTestCaseHelper.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 0,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/SpringTestCaseHelper.java",
                "patch": "@@ -0,0 +1,40 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ *\n+ */\n+\n+package org.apache.skywalking.apm.plugin.spring.mvc.v4;\n+\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n+import org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants;\n+\n+public final class SpringTestCaseHelper {\n+\n+    public final static void createCaseHandler(HttpServletRequest request, HttpServletResponse response,\n+        CaseHandler a) throws Throwable {\n+        ContextManager.createLocalSpan(\"For-Test\");\n+        ContextManager.getRuntimeContext().put(Constants.REQUEST_KEY_IN_RUNTIME_CONTEXT, request);\n+        ContextManager.getRuntimeContext().put(Constants.RESPONSE_KEY_IN_RUNTIME_CONTEXT, response);\n+        a.handleCase();\n+        ContextManager.stopSpan();\n+    }\n+\n+    public interface CaseHandler {\n+        void handleCase() throws Throwable;\n+    }\n+}",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-4.x-plugin/src/test/java/org/apache/skywalking/apm/plugin/spring/mvc/v4/SpringTestCaseHelper.java",
                "sha": "34b257aebae094eb394ca880debf30c8aad953bd",
                "status": "added"
            },
            {
                "additions": 8,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/Constants.java",
                "changes": 9,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/Constants.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/Constants.java",
                "patch": "@@ -16,7 +16,6 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.commons;\n \n /**\n@@ -32,4 +31,12 @@\n     public static final String REQUEST_MAPPING_METHOD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.RequestMappingMethodInterceptor\";\n \n     public static final String REST_MAPPING_METHOD_INTERCEPTOR = \"org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor.RestMappingMethodInterceptor\";\n+\n+    public static final String HYSTRIX_COMMAND_ANNOTATION = \"com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand\";\n+\n+    public static final String REQUEST_KEY_IN_RUNTIME_CONTEXT = \"SW_REQUEST\";\n+\n+    public static final String RESPONSE_KEY_IN_RUNTIME_CONTEXT = \"SW_RESPONSE\";\n+\n+    public static final String ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT = \"ISOLATE_STRATEGY\";\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/Constants.java",
                "sha": "ca42b3ee89898e948910f13e4ea3a48dd14b767d",
                "status": "modified"
            },
            {
                "additions": 0,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/EnhanceRequireObjectCache.java",
                "changes": 23,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/EnhanceRequireObjectCache.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 23,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/EnhanceRequireObjectCache.java",
                "patch": "@@ -18,28 +18,15 @@\n \n package org.apache.skywalking.apm.plugin.spring.mvc.commons;\n \n-import org.springframework.web.context.request.NativeWebRequest;\n-\n-import javax.servlet.http.HttpServletResponse;\n import java.lang.reflect.Method;\n \n public class EnhanceRequireObjectCache {\n     private PathMappingCache pathMappingCache;\n-    private ThreadLocal<NativeWebRequest> nativeWebRequest = new ThreadLocal<NativeWebRequest>();\n-    private ThreadLocal<HttpServletResponse> httpResponse = new ThreadLocal<HttpServletResponse>();\n \n     public void setPathMappingCache(PathMappingCache pathMappingCache) {\n         this.pathMappingCache = pathMappingCache;\n     }\n \n-    public HttpServletResponse getHttpServletResponse() {\n-        return httpResponse.get() == null ? (HttpServletResponse) nativeWebRequest.get().getNativeResponse() : httpResponse.get();\n-    }\n-\n-    public void setNativeWebRequest(NativeWebRequest nativeWebRequest) {\n-        this.nativeWebRequest.set(nativeWebRequest);\n-    }\n-\n     public String findPathMapping(Method method) {\n         return pathMappingCache.findPathMapping(method);\n     }\n@@ -51,14 +38,4 @@ public void addPathMapping(Method method, String url) {\n     public PathMappingCache getPathMappingCache() {\n         return pathMappingCache;\n     }\n-\n-    public void setHttpResponse(HttpServletResponse httpResponse) {\n-        this.httpResponse.set(httpResponse);\n-    }\n-\n-    public void clearRequestAndResponse() {\n-        setNativeWebRequest(null);\n-        setHttpResponse(null);\n-    }\n-\n }",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/EnhanceRequireObjectCache.java",
                "sha": "8337591fbdaf520f3e8c472b62ede4ca6cee8192",
                "status": "modified"
            },
            {
                "additions": 30,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java",
                "changes": 53,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 23,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java",
                "patch": "@@ -16,9 +16,11 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor;\n \n+import java.lang.reflect.Method;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n import org.apache.skywalking.apm.agent.core.context.ContextManager;\n@@ -30,12 +32,10 @@\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n-import org.springframework.web.context.request.RequestContextHolder;\n-import org.springframework.web.context.request.ServletRequestAttributes;\n \n-import javax.servlet.http.HttpServletRequest;\n-import javax.servlet.http.HttpServletResponse;\n-import java.lang.reflect.Method;\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT;\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.REQUEST_KEY_IN_RUNTIME_CONTEXT;\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.RESPONSE_KEY_IN_RUNTIME_CONTEXT;\n \n /**\n  * the abstract method inteceptor\n@@ -54,38 +54,45 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n             requestURL = pathMappingCache.findPathMapping(method);\n         }\n \n-        HttpServletRequest request = ((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest();\n+        String hystrixIsolateStrategy = (String)ContextManager.getRuntimeContext().get(ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT);\n+        HttpServletRequest request = (HttpServletRequest)ContextManager.getRuntimeContext().get(REQUEST_KEY_IN_RUNTIME_CONTEXT);\n \n-        ContextCarrier contextCarrier = new ContextCarrier();\n-        CarrierItem next = contextCarrier.items();\n-        while (next.hasNext()) {\n-            next = next.next();\n-            next.setHeadValue(request.getHeader(next.getHeadKey()));\n-        }\n+        if (hystrixIsolateStrategy != null) {\n+            ContextManager.createLocalSpan(requestURL);\n+        } else if (request != null) {\n+            ContextCarrier contextCarrier = new ContextCarrier();\n+            CarrierItem next = contextCarrier.items();\n+            while (next.hasNext()) {\n+                next = next.next();\n+                next.setHeadValue(request.getHeader(next.getHeadKey()));\n+            }\n \n-        AbstractSpan span = ContextManager.createEntrySpan(requestURL, contextCarrier);\n-        Tags.URL.set(span, request.getRequestURL().toString());\n-        Tags.HTTP.METHOD.set(span, request.getMethod());\n-        span.setComponent(ComponentsDefine.SPRING_MVC_ANNOTATION);\n-        SpanLayer.asHttp(span);\n+            AbstractSpan span = ContextManager.createEntrySpan(requestURL, contextCarrier);\n+            Tags.URL.set(span, request.getRequestURL().toString());\n+            Tags.HTTP.METHOD.set(span, request.getMethod());\n+            span.setComponent(ComponentsDefine.SPRING_MVC_ANNOTATION);\n+            SpanLayer.asHttp(span);\n+        }\n     }\n \n     @Override\n     public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         Object ret) throws Throwable {\n-        try {\n-            HttpServletResponse response = ((EnhanceRequireObjectCache) objInst.getSkyWalkingDynamicField()).getHttpServletResponse();\n+        String hystrixIsolateStrategy = (String)ContextManager.getRuntimeContext().get(ISOLATE_STRATEGY_KEY_IN_RUNNING_CONTEXT);\n+        HttpServletResponse response = (HttpServletResponse)ContextManager.getRuntimeContext().get(RESPONSE_KEY_IN_RUNTIME_CONTEXT);\n \n+        if (hystrixIsolateStrategy != null) {\n+            ContextManager.stopSpan();\n+        } else if (response != null) {\n             AbstractSpan span = ContextManager.activeSpan();\n             if (response.getStatus() >= 400) {\n                 span.errorOccurred();\n                 Tags.STATUS_CODE.set(span, Integer.toString(response.getStatus()));\n             }\n             ContextManager.stopSpan();\n-            return ret;\n-        } finally {\n-            ((EnhanceRequireObjectCache)objInst.getSkyWalkingDynamicField()).clearRequestAndResponse();\n         }\n+\n+        return ret;\n     }\n \n     @Override",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/AbstractMethodInterceptor.java",
                "sha": "ded96e74579f9cf74edc66e0e111ba02db866bdf",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/GetBeanInterceptor.java",
                "changes": 9,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/GetBeanInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 3,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/GetBeanInterceptor.java",
                "patch": "@@ -16,15 +16,18 @@\n  *\n  */\n \n-\n package org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor;\n \n import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n import org.springframework.web.context.request.NativeWebRequest;\n+import org.springframework.web.context.request.RequestContextHolder;\n+import org.springframework.web.context.request.ServletRequestAttributes;\n+\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.REQUEST_KEY_IN_RUNTIME_CONTEXT;\n \n /**\n  * {@link GetBeanInterceptor} pass the {@link NativeWebRequest} object into the {@link\n@@ -42,7 +45,7 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n     public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         Object ret) throws Throwable {\n         if (ret instanceof EnhancedInstance) {\n-            ((EnhanceRequireObjectCache)((EnhancedInstance)ret).getSkyWalkingDynamicField()).setNativeWebRequest((NativeWebRequest)objInst.getSkyWalkingDynamicField());\n+            ContextManager.getRuntimeContext().put(REQUEST_KEY_IN_RUNTIME_CONTEXT, ((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest());\n         }\n         return ret;\n     }",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/GetBeanInterceptor.java",
                "sha": "613481fcde3c4d835a6e2b133b10ccdd0e289ebd",
                "status": "modified"
            },
            {
                "additions": 4,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeForRequestInterceptor.java",
                "changes": 5,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeForRequestInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeForRequestInterceptor.java",
                "patch": "@@ -19,13 +19,16 @@\n \n package org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor;\n \n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n import org.springframework.web.context.request.NativeWebRequest;\n \n import java.lang.reflect.Method;\n \n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.RESPONSE_KEY_IN_RUNTIME_CONTEXT;\n+\n /**\n  * {@link InvokeForRequestInterceptor} pass the {@link NativeWebRequest} object into the {@link\n  * org.springframework.stereotype.Controller} object.\n@@ -36,7 +39,7 @@\n     @Override\n     public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         MethodInterceptResult result) throws Throwable {\n-        objInst.setSkyWalkingDynamicField(allArguments[0]);\n+        ContextManager.getRuntimeContext().put(RESPONSE_KEY_IN_RUNTIME_CONTEXT, ((NativeWebRequest)allArguments[0]).getNativeResponse());\n     }\n \n     @Override",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeForRequestInterceptor.java",
                "sha": "f1762a93483a5fa32cf5f2c46b6040d960756dd4",
                "status": "modified"
            },
            {
                "additions": 6,
                "blob_url": "https://github.com/apache/skywalking/blob/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeHandlerMethodInterceptor.java",
                "changes": 10,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeHandlerMethodInterceptor.java?ref=a835fe4ec5d41266e90ff6159d48da8d84715773",
                "deletions": 4,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeHandlerMethodInterceptor.java",
                "patch": "@@ -18,20 +18,22 @@\n \n package org.apache.skywalking.apm.plugin.spring.mvc.commons.interceptor;\n \n+import java.lang.reflect.Method;\n+import org.apache.skywalking.apm.agent.core.context.ContextManager;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.plugin.spring.mvc.commons.EnhanceRequireObjectCache;\n \n-import javax.servlet.http.HttpServletResponse;\n-import java.lang.reflect.Method;\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.REQUEST_KEY_IN_RUNTIME_CONTEXT;\n+import static org.apache.skywalking.apm.plugin.spring.mvc.commons.Constants.RESPONSE_KEY_IN_RUNTIME_CONTEXT;\n \n public class InvokeHandlerMethodInterceptor implements InstanceMethodsAroundInterceptor {\n     @Override\n     public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allArguments, Class<?>[] argumentsTypes,\n         MethodInterceptResult result) throws Throwable {\n         if (allArguments[2] instanceof EnhancedInstance) {\n-            ((EnhanceRequireObjectCache)((EnhancedInstance)allArguments[2]).getSkyWalkingDynamicField()).setHttpResponse((HttpServletResponse)allArguments[1]);\n+            ContextManager.getRuntimeContext().put(RESPONSE_KEY_IN_RUNTIME_CONTEXT, allArguments[1]);\n+            ContextManager.getRuntimeContext().put(REQUEST_KEY_IN_RUNTIME_CONTEXT, allArguments[0]);\n         }\n     }\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/a835fe4ec5d41266e90ff6159d48da8d84715773/apm-sniffer/apm-sdk-plugin/spring-plugins/mvc-annotation-commons/src/main/java/org/apache/skywalking/apm/plugin/spring/mvc/commons/interceptor/InvokeHandlerMethodInterceptor.java",
                "sha": "33fbec273f0cfa520b2970c62ed872ceb8579358",
                "status": "modified"
            }
        ],
        "message": "Fix occure the NPE when SpringMVC and hystrix work together (#1256)",
        "parent": "https://github.com/apache/skywalking/commit/29f6f6e50ecc01b4f04241742c1961e8527badf2",
        "patched_files": [
            "InvocableHandlerInstrumentation.java",
            "RequestMappingMethodInterceptor.java",
            "RestMappingMethodInterceptor.java",
            "AbstractMethodInterceptor.java",
            "AbstractControllerInstrumentation.java",
            "HandlerMethodInvokerInterceptor.java",
            "ControllerInstrumentation.java",
            "GetBeanInterceptor.java",
            "SpringTestCaseHelper.java",
            "EnhanceRequireObjectCache.java",
            "InvokeHandlerMethodInterceptor.java",
            "HystrixCommandRunInterceptor.java",
            "Constants.java",
            "AbstractSpring3Instrumentation.java",
            "InvokeForRequestInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "GetBeanInterceptorTest.java",
            "RequestMappingMethodInterceptorTest.java",
            "ControllerInstrumentationTest.java",
            "RestMappingMethodInterceptorTest.java",
            "InvokeForRequestInterceptorTest.java"
        ]
    },
    "skywalking_b8206b8": {
        "bug_id": "skywalking_b8206b8",
        "commit": "https://github.com/apache/skywalking/commit/b8206b8cecd787891f1ace550ecd9550d7bec1bf",
        "file": [
            {
                "additions": 17,
                "blob_url": "https://github.com/apache/skywalking/blob/b8206b8cecd787891f1ace550ecd9550d7bec1bf/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "changes": 40,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java?ref=b8206b8cecd787891f1ace550ecd9550d7bec1bf",
                "deletions": 23,
                "filename": "apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "patch": "@@ -18,23 +18,14 @@\n \n package org.apache.skywalking.apm.plugin.httpClient.v4;\n \n-import org.apache.http.HttpHost;\n-import org.apache.http.HttpRequest;\n-import org.apache.http.HttpResponse;\n-import org.apache.http.StatusLine;\n-import org.apache.skywalking.apm.agent.core.context.CarrierItem;\n-import org.apache.skywalking.apm.agent.core.context.ContextCarrier;\n-import org.apache.skywalking.apm.agent.core.context.ContextManager;\n-import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n-import org.apache.skywalking.apm.agent.core.context.trace.AbstractSpan;\n-import org.apache.skywalking.apm.agent.core.context.trace.SpanLayer;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.EnhancedInstance;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstanceMethodsAroundInterceptor;\n-import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.MethodInterceptResult;\n-import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n-\n import java.lang.reflect.Method;\n import java.net.URL;\n+import org.apache.http.*;\n+import org.apache.skywalking.apm.agent.core.context.*;\n+import org.apache.skywalking.apm.agent.core.context.tag.Tags;\n+import org.apache.skywalking.apm.agent.core.context.trace.*;\n+import org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.*;\n+import org.apache.skywalking.apm.network.trace.component.ComponentsDefine;\n \n public class HttpClientExecuteInterceptor implements InstanceMethodsAroundInterceptor {\n \n@@ -73,16 +64,19 @@\n             return ret;\n         }\n \n-        HttpResponse response = (HttpResponse)ret;\n-        StatusLine responseStatusLine = response.getStatusLine();\n-        if (responseStatusLine != null) {\n-            int statusCode = responseStatusLine.getStatusCode();\n-            AbstractSpan span = ContextManager.activeSpan();\n-            if (statusCode >= 400) {\n-                span.errorOccurred();\n-                Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+        if (ret != null) {\n+            HttpResponse response = (HttpResponse)ret;\n+            StatusLine responseStatusLine = response.getStatusLine();\n+            if (responseStatusLine != null) {\n+                int statusCode = responseStatusLine.getStatusCode();\n+                AbstractSpan span = ContextManager.activeSpan();\n+                if (statusCode >= 400) {\n+                    span.errorOccurred();\n+                    Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+                }\n             }\n         }\n+        \n         ContextManager.stopSpan();\n         return ret;\n     }",
                "raw_url": "https://github.com/apache/skywalking/raw/b8206b8cecd787891f1ace550ecd9550d7bec1bf/apm-sniffer/apm-sdk-plugin/httpClient-4.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/httpClient/v4/HttpClientExecuteInterceptor.java",
                "sha": "5d2cf2908385e48480b964e87fc337008267d810",
                "status": "modified"
            }
        ],
        "message": "[Agent] Apache http client plugin bug (#1448)\n\n* #1447\r\n\r\nFixed the after method interceptor for the apache http client NPE error when the response is null cause by the doExecute method throw a exception.",
        "parent": "https://github.com/apache/skywalking/commit/5299a68e7c7e469b3cfe4d440228d351f12c3860",
        "patched_files": [
            "HttpClientExecuteInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "HttpClientExecuteInterceptorTest.java"
        ]
    },
    "skywalking_d38b208": {
        "bug_id": "skywalking_d38b208",
        "commit": "https://github.com/apache/skywalking/commit/d38b208c9e8dfa6aa872ea51fe0de340d6d493af",
        "file": [
            {
                "additions": 2,
                "blob_url": "https://github.com/apache/skywalking/blob/d38b208c9e8dfa6aa872ea51fe0de340d6d493af/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "changes": 3,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java?ref=d38b208c9e8dfa6aa872ea51fe0de340d6d493af",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "patch": "@@ -44,7 +44,8 @@ public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allA\n         Object ret) throws Throwable {\n         AdvisedSupport advisedSupport = (AdvisedSupport)allArguments[0];\n \n-        if (EnhancedInstance.class.isAssignableFrom(advisedSupport.getTargetClass())) {\n+        Class targetClass = advisedSupport.getTargetClass();\n+        if (targetClass != null && EnhancedInstance.class.isAssignableFrom(targetClass)) {\n             return true;\n         }\n         return ret;",
                "raw_url": "https://github.com/apache/skywalking/raw/d38b208c9e8dfa6aa872ea51fe0de340d6d493af/apm-sniffer/apm-sdk-plugin/spring-plugins/core-patch/src/main/java/org/apache/skywalking/apm/plugin/spring/patch/CreateAopProxyInterceptor.java",
                "sha": "a7300e4190d3a68a7e0dacc729031f171e309752",
                "status": "modified"
            }
        ],
        "message": "Fix #1454: fix NPE issue about spring apo interceptor (#1467)",
        "parent": "https://github.com/apache/skywalking/commit/48348efe74112c7daeb36984b4954de93e6f5e1e",
        "patched_files": [
            "CreateAopProxyInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "CreateAopProxyInterceptorTest.java"
        ]
    },
    "skywalking_d556404": {
        "bug_id": "skywalking_d556404",
        "commit": "https://github.com/apache/skywalking/commit/d55640454ee63b151272f043697f8779bb6cdd50",
        "file": [
            {
                "additions": 7,
                "blob_url": "https://github.com/apache/skywalking/blob/d55640454ee63b151272f043697f8779bb6cdd50/apm-sniffer/apm-sdk-plugin/okhttp-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/okhttp/v3/RealCallInterceptor.java",
                "changes": 13,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/okhttp-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/okhttp/v3/RealCallInterceptor.java?ref=d55640454ee63b151272f043697f8779bb6cdd50",
                "deletions": 6,
                "filename": "apm-sniffer/apm-sdk-plugin/okhttp-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/okhttp/v3/RealCallInterceptor.java",
                "patch": "@@ -100,12 +100,13 @@ public void onConstruct(EnhancedInstance objInst, Object[] allArguments) {\n     public Object afterMethod(EnhancedInstance objInst, Method method, Object[] allArguments,\n         Class<?>[] argumentsTypes, Object ret) throws Throwable {\n         Response response = (Response)ret;\n-        int statusCode = response.code();\n-\n-        AbstractSpan span = ContextManager.activeSpan();\n-        if (statusCode >= 400) {\n-            span.errorOccurred();\n-            Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+        if (response != null) {\n+            int statusCode = response.code();\n+            AbstractSpan span = ContextManager.activeSpan();\n+            if (statusCode >= 400) {\n+                span.errorOccurred();\n+                Tags.STATUS_CODE.set(span, Integer.toString(statusCode));\n+            }\n         }\n \n         ContextManager.stopSpan();",
                "raw_url": "https://github.com/apache/skywalking/raw/d55640454ee63b151272f043697f8779bb6cdd50/apm-sniffer/apm-sdk-plugin/okhttp-3.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/okhttp/v3/RealCallInterceptor.java",
                "sha": "d9a9ae7abf8867788b105bbe7431a40b6e76648b",
                "status": "modified"
            }
        ],
        "message": "fix NPE when has connection exception (#1253)",
        "parent": "https://github.com/apache/skywalking/commit/e249e0607d461b609eb76be48c046d114b34bfd5",
        "patched_files": [
            "RealCallInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "RealCallInterceptorTest.java"
        ]
    },
    "skywalking_dd942d1": {
        "bug_id": "skywalking_dd942d1",
        "commit": "https://github.com/apache/skywalking/commit/dd942d15a30958483ccc939bf66b0121859cc243",
        "file": [
            {
                "additions": 1,
                "blob_url": "https://github.com/apache/skywalking/blob/dd942d15a30958483ccc939bf66b0121859cc243/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "changes": 2,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java?ref=dd942d15a30958483ccc939bf66b0121859cc243",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "patch": "@@ -37,7 +37,7 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         if (ContextManager.isActive()) {\n             AbstractSpan abstractTracingSpan = ContextManager.activeSpan();\n             Map<String, String> eventMap = new HashMap<String, String>();\n-            eventMap.put(\"forward-url\", (String)objInst.getSkyWalkingDynamicField());\n+            eventMap.put(\"forward-url\", objInst.getSkyWalkingDynamicField() == null ? \"\" : String.valueOf(objInst.getSkyWalkingDynamicField()));\n             abstractTracingSpan.log(System.currentTimeMillis(), eventMap);\n             ContextManager.getRuntimeContext().put(Constants.FORWARD_REQUEST_FLAG, true);\n         }",
                "raw_url": "https://github.com/apache/skywalking/raw/dd942d15a30958483ccc939bf66b0121859cc243/apm-sniffer/apm-sdk-plugin/tomcat-7.x-8.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/tomcat78x/ForwardInterceptor.java",
                "sha": "68416c7ed6734fe6e043c098f205dadf306571d5",
                "status": "modified"
            }
        ],
        "message": "FIX NPE in tomcat plugin ForwardInterceptor (#1562)",
        "parent": "https://github.com/apache/skywalking/commit/a29a8d7c09641b7c4e722d03c9816d15d68855c4",
        "patched_files": [
            "ForwardInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "ForwardInterceptorTest.java"
        ]
    },
    "skywalking_ea566b1": {
        "bug_id": "skywalking_ea566b1",
        "commit": "https://github.com/apache/skywalking/commit/ea566b19a501b44c29ca4083c28c560160ad86cf",
        "file": [
            {
                "additions": 5,
                "blob_url": "https://github.com/apache/skywalking/blob/ea566b19a501b44c29ca4083c28c560160ad86cf/apm-sniffer/apm-sdk-plugin/rabbitmq-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/rabbitmq/RabbitMQConsumerInterceptor.java",
                "changes": 6,
                "contents_url": "https://api.github.com/repos/apache/skywalking/contents/apm-sniffer/apm-sdk-plugin/rabbitmq-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/rabbitmq/RabbitMQConsumerInterceptor.java?ref=ea566b19a501b44c29ca4083c28c560160ad86cf",
                "deletions": 1,
                "filename": "apm-sniffer/apm-sdk-plugin/rabbitmq-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/rabbitmq/RabbitMQConsumerInterceptor.java",
                "patch": "@@ -51,7 +51,11 @@ public void beforeMethod(EnhancedInstance objInst, Method method, Object[] allAr\n         CarrierItem next = contextCarrier.items();\n         while (next.hasNext()) {\n             next = next.next();\n-            next.setHeadValue(properties.getHeaders().get(next.getHeadKey()).toString());\n+            if (properties.getHeaders() != null && properties.getHeaders().get(next.getHeadKey()) != null) {\n+                next.setHeadValue(properties.getHeaders().get(next.getHeadKey()).toString());\n+            } else {\n+                next.setHeadValue(\"\");\n+            }\n         }\n         ContextManager.extract(contextCarrier);\n ",
                "raw_url": "https://github.com/apache/skywalking/raw/ea566b19a501b44c29ca4083c28c560160ad86cf/apm-sniffer/apm-sdk-plugin/rabbitmq-5.x-plugin/src/main/java/org/apache/skywalking/apm/plugin/rabbitmq/RabbitMQConsumerInterceptor.java",
                "sha": "91be8bb7f08852b8ee636c739773db0ae01b72a6",
                "status": "modified"
            }
        ],
        "message": "Fix RabbitMq NPE case (#2450)\n\n* Fix npe",
        "parent": "https://github.com/apache/skywalking/commit/128a119077d74ad4481a942e3e3705d6043a429b",
        "patched_files": [
            "RabbitMQConsumerInterceptor.java"
        ],
        "repo": "skywalking",
        "unit_tests": [
            "RabbitMQConsumerInterceptorTest.java"
        ]
    }
}