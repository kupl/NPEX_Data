[
    {
        "commit": "https://github.com/apache/james-jdkim/commit/454c84fa117c433a5dc2c4e02b5136072182a233",
        "file": [
            {
                "patch": "@@ -234,7 +234,7 @@ else if (lastPermFailure != null)\n         // System.out.println(message.getFields(\"DKIM-Signature\"));\n         List fields = messageHeaders.getFields(\"DKIM-Signature\");\n         // if (fields.size() > 1) throw new RuntimeException(\"here we are!\");\n-        if (fields.size() == 0) {\n+        if (fields == null || fields.size() == 0) {\n             throw new PermFailException(\"DKIM-Signature field not found\");\n         }\n ",
                "additions": 1,
                "raw_url": "https://github.com/apache/james-jdkim/raw/454c84fa117c433a5dc2c4e02b5136072182a233/main/src/main/java/org/apache/james/jdkim/DKIMVerifier.java",
                "status": "modified",
                "changes": 2,
                "deletions": 1,
                "sha": "02f2234f15c9b59d379048220eca1bff2a2a2d97",
                "blob_url": "https://github.com/apache/james-jdkim/blob/454c84fa117c433a5dc2c4e02b5136072182a233/main/src/main/java/org/apache/james/jdkim/DKIMVerifier.java",
                "filename": "main/src/main/java/org/apache/james/jdkim/DKIMVerifier.java",
                "contents_url": "https://api.github.com/repos/apache/james-jdkim/contents/main/src/main/java/org/apache/james/jdkim/DKIMVerifier.java?ref=454c84fa117c433a5dc2c4e02b5136072182a233"
            }
        ],
        "bug_id": "james-jdkim_1",
        "parent": "https://github.com/apache/james-jdkim/commit/a1cf3abbc13aed3a55f9198d7845f20c4f889376",
        "message": "Protect method from NPE on missing signature header\n\ngit-svn-id: https://svn.apache.org/repos/asf/james/jdkim/trunk@905012 13f79535-47bb-0310-9956-ffa450edef68",
        "repo": "james-jdkim"
    },
    {
        "commit": "https://github.com/apache/james-jdkim/commit/9730bc0b40e651fecd62a33c73021279bb090ef2",
        "file": [
            {
                "patch": "@@ -129,7 +129,7 @@ public FileBasedTestSuite() throws IOException {\n \t\t\tFile dir = TESTS_FOLDER;\n \t\t\tFile[] files = dir.listFiles();\n \n-\t\t\tfor (int i = 0; i < files.length; i++) {\n+\t\t\tif (files != null) for (int i = 0; i < files.length; i++) {\n \t\t\t\tFile f = files[i];\n \t\t\t\tif (f.getName().toLowerCase().endsWith(\".eml\")) {\n \t\t\t\t\taddTest(new FileBasedTest(f.getName().substring(0,",
                "additions": 1,
                "raw_url": "https://github.com/apache/james-jdkim/raw/9730bc0b40e651fecd62a33c73021279bb090ef2/main/src/test/java/org/apache/james/jdkim/FileBasedTest.java",
                "status": "modified",
                "changes": 2,
                "deletions": 1,
                "sha": "27dcbdc7fe251c5c98f8d4c15c2e5e753bb1dae6",
                "blob_url": "https://github.com/apache/james-jdkim/blob/9730bc0b40e651fecd62a33c73021279bb090ef2/main/src/test/java/org/apache/james/jdkim/FileBasedTest.java",
                "filename": "main/src/test/java/org/apache/james/jdkim/FileBasedTest.java",
                "contents_url": "https://api.github.com/repos/apache/james-jdkim/contents/main/src/test/java/org/apache/james/jdkim/FileBasedTest.java?ref=9730bc0b40e651fecd62a33c73021279bb090ef2"
            }
        ],
        "bug_id": "james-jdkim_2",
        "parent": "https://github.com/apache/james-jdkim/commit/366991050d745a0a629216e4f75faaab5c94ef70",
        "message": "Fix an NPE on missing test resources\n\ngit-svn-id: https://svn.apache.org/repos/asf/james/jdkim/trunk@822428 13f79535-47bb-0310-9956-ffa450edef68",
        "repo": "james-jdkim"
    },
    {
        "commit": "https://github.com/apache/james-jdkim/commit/b9ff2e0b4a757f17b3b2e1b21684e405dce7a476",
        "file": [
            {
                "patch": "@@ -47,6 +47,12 @@ public BodyHasherImpl(SignatureRecord sign) throws PermFailException {\n             throw new PermFailException(\"Unsupported algorythm: \"\n                     + sign.getHashAlgo(), e);\n         }\n+        \n+        try {\n+            sign.validate();\n+        } catch (IllegalStateException e) {\n+            throw new PermFailException(\"Invalid signature template\", e);\n+        }\n \n         int limit = sign.getBodyHashLimit();\n ",
                "additions": 6,
                "raw_url": "https://github.com/apache/james-jdkim/raw/b9ff2e0b4a757f17b3b2e1b21684e405dce7a476/main/src/main/java/org/apache/james/jdkim/impl/BodyHasherImpl.java",
                "status": "modified",
                "changes": 6,
                "deletions": 0,
                "sha": "b44d1457f307ba7de978b9dd6eb5acfdca8e2b52",
                "blob_url": "https://github.com/apache/james-jdkim/blob/b9ff2e0b4a757f17b3b2e1b21684e405dce7a476/main/src/main/java/org/apache/james/jdkim/impl/BodyHasherImpl.java",
                "filename": "main/src/main/java/org/apache/james/jdkim/impl/BodyHasherImpl.java",
                "contents_url": "https://api.github.com/repos/apache/james-jdkim/contents/main/src/main/java/org/apache/james/jdkim/impl/BodyHasherImpl.java?ref=b9ff2e0b4a757f17b3b2e1b21684e405dce7a476"
            }
        ],
        "bug_id": "james-jdkim_3",
        "parent": "https://github.com/apache/james-jdkim/commit/c8e48f443ff94c1bd949fa2c3e9ab4a7e2764ac7",
        "message": "Make sure to validate the signature templates and throw PermFailException if an invalid template is provided (otherwise it was throwing NPE later)\n\ngit-svn-id: https://svn.apache.org/repos/asf/james/jdkim/trunk@928674 13f79535-47bb-0310-9956-ffa450edef68",
        "repo": "james-jdkim"
    }
]