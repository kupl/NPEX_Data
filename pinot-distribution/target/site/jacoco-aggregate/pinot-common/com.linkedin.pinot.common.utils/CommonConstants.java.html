<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>CommonConstants.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">pinot-distribution</a> &gt; <a href="../index.html" class="el_bundle">pinot-common</a> &gt; <a href="index.source.html" class="el_package">com.linkedin.pinot.common.utils</a> &gt; <span class="el_source">CommonConstants.java</span></div><h1>CommonConstants.java</h1><pre class="source lang-java linenums">/**
 * Copyright (C) 2014-2016 LinkedIn Corp. (pinot-core@linkedin.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.linkedin.pinot.common.utils;

import java.io.File;
import org.apache.commons.lang.StringUtils;


<span class="nc" id="L22">public class CommonConstants {</span>

  public static final String PREFIX_OF_SSL_SUBSET = &quot;ssl&quot;;

<span class="nc" id="L26">  public static class Helix {</span>
    public static final String IS_SHUTDOWN_IN_PROGRESS = &quot;shutdownInProgress&quot;;

    public static final String PREFIX_OF_SERVER_INSTANCE = &quot;Server_&quot;;
    public static final String PREFIX_OF_BROKER_INSTANCE = &quot;Broker_&quot;;

    public static final String SERVER_INSTANCE_TYPE = &quot;server&quot;;
    public static final String BROKER_INSTANCE_TYPE = &quot;broker&quot;;

    public static final String BROKER_RESOURCE_INSTANCE = &quot;brokerResource&quot;;

    public static final String UNTAGGED_SERVER_INSTANCE = &quot;server_untagged&quot;;
    public static final String UNTAGGED_BROKER_INSTANCE = &quot;broker_untagged&quot;;

<span class="nc" id="L40">    public static class StateModel {</span>
<span class="nc" id="L41">      public static class SegmentOnlineOfflineStateModel {</span>
        public static final String ONLINE = &quot;ONLINE&quot;;
        public static final String OFFLINE = &quot;OFFLINE&quot;;
        public static final String ERROR = &quot;ERROR&quot;;
        public static final String DROPPED = &quot;DROPPED&quot;;
      }

<span class="nc" id="L48">      public static class RealtimeSegmentOnlineOfflineStateModel {</span>
        public static final String ONLINE = &quot;ONLINE&quot;;
        public static final String OFFLINE = &quot;OFFLINE&quot;;
        public static final String ERROR = &quot;ERROR&quot;;
        public static final String DROPPED = &quot;DROPPED&quot;;
        public static final String CONSUMING = &quot;CONSUMING&quot;;
        public static final String CONVERTING = &quot;CONVERTING&quot;;
      }

<span class="nc" id="L57">      public static class BrokerOnlineOfflineStateModel {</span>
        public static final String ONLINE = &quot;ONLINE&quot;;
        public static final String OFFLINE = &quot;OFFLINE&quot;;
        public static final String DROPPED = &quot;DROPPED&quot;;
        public static final String ERROR = &quot;ERROR&quot;;
      }
    }

<span class="nc" id="L65">    public static class DataSource {</span>
      public static final String SCHEMA = &quot;schema&quot;;
      public static final String KAFKA = &quot;kafka&quot;;
      public static final String STREAM_PREFIX = &quot;stream&quot;;
<span class="nc" id="L69">      public enum SegmentAssignmentStrategyType {</span>
<span class="nc" id="L70">        RandomAssignmentStrategy,</span>
<span class="nc" id="L71">        BalanceNumSegmentAssignmentStrategy,</span>
<span class="nc" id="L72">        BucketizedSegmentAssignmentStrategy,</span>
<span class="nc" id="L73">        ReplicaGroupSegmentAssignmentStrategy</span>
      }

<span class="nc" id="L76">      public enum RoutingTableBuilderName {</span>
<span class="nc" id="L77">        DefaultOffline,</span>
<span class="nc" id="L78">        DefaultRealtime,</span>
<span class="nc" id="L79">        BalancedRandom,</span>
<span class="nc" id="L80">        KafkaLowLevel,</span>
<span class="nc" id="L81">        KafkaHighLevel,</span>
<span class="nc" id="L82">        PartitionAwareOffline,</span>
<span class="nc" id="L83">        PartitionAwareRealtime</span>
      }

<span class="nc" id="L86">      public static class Schema {</span>
        public static final String COLUMN_NAME = &quot;columnName&quot;;
        public static final String DATA_TYPE = &quot;dataType&quot;;
        public static final String DELIMETER = &quot;delimeter&quot;;
        public static final String IS_SINGLE_VALUE = &quot;isSingleValue&quot;;
        public static final String FIELD_TYPE = &quot;fieldType&quot;;
        public static final String TIME_UNIT = &quot;timeUnit&quot;;
      }

<span class="nc" id="L95">      public static class Realtime {</span>
        public static final String STREAM_TYPE = &quot;streamType&quot;;
        // Time threshold that will keep the realtime segment open for before we convert it into an offline segment
        public static final String REALTIME_SEGMENT_FLUSH_TIME = &quot;realtime.segment.flush.threshold.time&quot;;
        // Time threshold that controller will wait for the segment to be built by the server
        public static final String SEGMENT_COMMIT_TIMEOUT_SECONDS = &quot;realtime.segment.commit.timeoutSeconds&quot;;
        /**
         * Row count flush threshold for realtime segments. This behaves in a similar way for HLC and LLC. For HLC,
         * since there is only one consumer per server, this size is used as the size of the consumption buffer and
         * determines after how many rows we flush to disk. For example, if this threshold is set to two million rows,
         * then a high level consumer would have a buffer size of two million.
         *
         * For LLC, this size is divided across all the segments assigned to a given server and is set on a per segment
         * basis. Assuming a low level consumer server is assigned four Kafka partitions to consume from and a flush
         * size of two million, then each consuming segment would have a flush size of five hundred thousand rows, for a
         * total of two million rows in memory.
         *
         * Keep in mind that this NOT a hard threshold, as other tables can also be assigned to this server, and that in
         * certain conditions (eg. if the number of servers, replicas of Kafka partitions changes) where Kafka partition
         * to server assignment changes, it's possible to end up with more (or less) than this number of rows in memory.
         */
        public static final String REALTIME_SEGMENT_FLUSH_SIZE = &quot;realtime.segment.flush.threshold.size&quot;;
        public static final String LLC_PROPERTY_SUFFIX = &quot;.llc&quot;;
        public static final String LLC_REALTIME_SEGMENT_FLUSH_SIZE = REALTIME_SEGMENT_FLUSH_SIZE + LLC_PROPERTY_SUFFIX;
        public static final String LLC_REALTIME_SEGMENT_FLUSH_TIME = REALTIME_SEGMENT_FLUSH_TIME + LLC_PROPERTY_SUFFIX;

<span class="nc" id="L121">        public static enum StreamType {</span>
<span class="nc" id="L122">          kafka</span>
        }

<span class="nc" id="L125">        public static class Kafka {</span>

<span class="fc" id="L127">          public static enum ConsumerType {</span>
<span class="fc" id="L128">            simple,</span>
<span class="fc" id="L129">            highLevel</span>
          }

          public static final String TOPIC_NAME = &quot;kafka.topic.name&quot;;
          public static final String CONSUMER_TYPE = &quot;kafka.consumer.type&quot;;
          public static final String DECODER_CLASS = &quot;kafka.decoder.class.name&quot;;
          public static final String DECODER_PROPS_PREFIX = &quot;kafka.decoder.prop&quot;;
          public static final String KAFKA_CONSUMER_PROPS_PREFIX = &quot;kafka.consumer.prop&quot;;
          public static final String KAFKA_CONNECTION_TIMEOUT_MILLIS = &quot;kafka.connection.timeout.ms&quot;;
          public static final String KAFKA_FETCH_TIMEOUT_MILLIS = &quot;kafka.fetch.timeout.ms&quot;;
          public static final String ZK_BROKER_URL = &quot;kafka.zk.broker.url&quot;;
          public static final String KAFKA_BROKER_LIST = &quot;kafka.broker.list&quot;;
          public static final String CONSUMER_FACTORY = &quot;kafka.consumer.factory.class.name&quot;;

          // Consumer properties
          public static final String AUTO_OFFSET_RESET = &quot;auto.offset.reset&quot;;

          public static String getDecoderPropertyKeyFor(String key) {
<span class="nc" id="L147">            return StringUtils.join(new String[] { DECODER_PROPS_PREFIX, key }, &quot;.&quot;);</span>
          }

          public static String getDecoderPropertyKey(String incoming) {
<span class="fc" id="L151">            return incoming.split(DECODER_PROPS_PREFIX + &quot;.&quot;)[1];</span>
          }

          public static String getConsumerPropertyKey(String incoming) {
<span class="fc" id="L155">            return incoming.split(KAFKA_CONSUMER_PROPS_PREFIX + &quot;.&quot;)[1];</span>
          }

<span class="nc" id="L158">          public static class HighLevelConsumer {</span>
            public static final String ZK_CONNECTION_STRING = &quot;kafka.hlc.zk.connect.string&quot;;
            public static final String GROUP_ID = &quot;kafka.hlc.group.id&quot;;
          }

<span class="nc" id="L163">          public static class ConsumerFactory {</span>
            public static final String SIMPLE_CONSUMER_FACTORY_STRING = &quot;com.linkedin.pinot.core.realtime.impl.kafka.SimpleConsumerFactory&quot;;
          }
        }
      }

    }

<span class="nc" id="L171">    public static class Instance {</span>
      public static final String INSTANCE_NAME = &quot;instance.name&quot;;
      public static final String GROUP_ID_SUFFIX = &quot;kafka.hlc.groupId&quot;;
      public static final String PARTITION_SUFFIX = &quot;kafka.hlc.partition&quot;;
      public static final String INSTANCE_ID_KEY = &quot;instanceId&quot;;
      public static final String DATA_DIR_KEY = &quot;dataDir&quot;;
      public static final String ADMIN_PORT_KEY = &quot;adminPort&quot;;
    }

<span class="pc" id="L180">    public enum TableType {</span>
<span class="fc" id="L181">      OFFLINE,</span>
<span class="fc" id="L182">      REALTIME;</span>

      public ServerType getServerType() {
<span class="fc bfc" id="L185" title="All 2 branches covered.">        if (this == OFFLINE) {</span>
<span class="fc" id="L186">          return ServerType.OFFLINE;</span>
        }
<span class="fc" id="L188">        return ServerType.REALTIME;</span>
      }
    }

    public static final String KEY_OF_SERVER_NETTY_PORT = &quot;pinot.server.netty.port&quot;;
    public static final int DEFAULT_SERVER_NETTY_PORT = 8098;
    public static final String KEY_OF_BROKER_QUERY_PORT = &quot;pinot.broker.client.queryPort&quot;;
    public static final int DEFAULT_BROKER_QUERY_PORT = 8099;
    public static final String KEY_OF_SERVER_NETTY_HOST = &quot;pinot.server.netty.host&quot;;

    public static final String HELIX_MANAGER_FLAPPING_TIME_WINDOW_KEY = &quot;helixmanager.flappingTimeWindow&quot;;
    public static final String HELIX_MANAGER_MAX_DISCONNECT_THRESHOLD_KEY = &quot;helixmanager.maxDisconnectThreshold&quot;;
    public static final String CONFIG_OF_HELIX_FLAPPING_TIMEWINDOW_MS = &quot;pinot.server.flapping.timeWindowMs&quot;;
    public static final String CONFIG_OF_HELIX_MAX_DISCONNECT_THRESHOLD = &quot;pinot.server.flapping.maxDisconnectThreshold&quot;;
    public static final String DEFAULT_HELIX_FLAPPING_TIMEWINDOW_MS = &quot;1&quot;;
    public static final String DEFAULT_HELIX_FLAPPING_MAX_DISCONNECT_THRESHOLD = &quot;100&quot;;
  }

<span class="nc" id="L206">  public static class Broker {</span>
    public static final String CONFIG_OF_BROKER_QUERY_RESPONSE_LIMIT = &quot;pinot.broker.query.response.limit&quot;;
    public static final int DEFAULT_BROKER_QUERY_RESPONSE_LIMIT = Integer.MAX_VALUE;
    public static final String CONFIG_OF_BROKER_TIMEOUT_MS = &quot;pinot.broker.timeoutMs&quot;;
    public static final long DEFAULT_BROKER_TIMEOUT_MS = 10_000L;
    public static final String CONFIG_OF_BROKER_ID = &quot;pinot.broker.id&quot;;
  }

<span class="nc" id="L214">  public static class Server {</span>
    public static final String CONFIG_OF_INSTANCE_ID = &quot;pinot.server.instance.id&quot;;
    public static final String CONFIG_OF_INSTANCE_DATA_DIR = &quot;pinot.server.instance.dataDir&quot;;
    public static final String CONFIG_OF_CONSUMER_DIR = &quot;pinot.server.instance.consumerDir&quot;;
    public static final String CONFIG_OF_INSTANCE_SEGMENT_TAR_DIR = &quot;pinot.server.instance.segmentTarDir&quot;;
    public static final String CONFIG_OF_INSTANCE_READ_MODE = &quot;pinot.server.instance.readMode&quot;;
    public static final String CONFIG_OF_INSTANCE_DATA_MANAGER_CLASS = &quot;pinot.server.instance.data.manager.class&quot;;
    public static final String CONFIG_OF_QUERY_EXECUTOR_PRUNER_CLASS = &quot;pinot.server.query.executor.pruner.class&quot;;
    public static final String CONFIG_OF_QUERY_EXECUTOR_TIMEOUT = &quot;pinot.server.query.executor.timeout&quot;;
    public static final String CONFIG_OF_QUERY_EXECUTOR_CLASS = &quot;pinot.server.query.executor.class&quot;;
    public static final String CONFIG_OF_REQUEST_HANDLER_FACTORY_CLASS = &quot;pinot.server.requestHandlerFactory.class&quot;;
    public static final String CONFIG_OF_NETTY_PORT = &quot;pinot.server.netty.port&quot;;
    public static final String CONFIG_OF_ADMIN_API_PORT = &quot;pinot.server.adminapi.port&quot;;
    public static final String CONFIG_OF_SEGMENT_LOAD_MAX_RETRY_COUNT = &quot;pinot.server.segment.loadMaxRetryCount&quot;;
    public static final String CONFIG_OF_SEGMENT_LOAD_MIN_RETRY_DELAY_MILLIS =
        &quot;pinot.server.segment.minRetryDelayMillis&quot;;
    public static final String CONFIG_OF_SEGMENT_FORMAT_VERSION = &quot;pinot.server.instance.segment.format.version&quot;;
    public static final String CONFIG_OF_ENABLE_DEFAULT_COLUMNS = &quot;pinot.server.instance.enable.default.columns&quot;;
    public static final String CONFIG_OF_ENABLE_SHUTDOWN_DELAY = &quot;pinot.server.instance.enable.shutdown.delay&quot;;
    public static final String CONFIG_OF_ENABLE_SPLIT_COMMIT = &quot;pinot.server.instance.enable.split.commit&quot;;
    public static final String CONFIG_OF_REALTIME_OFFHEAP_ALLOCATION = &quot;pinot.server.instance.realtime.alloc.offheap&quot;;
    public static final String CONFIG_OF_REALTIME_OFFHEAP_DIRECT_ALLOCATION = &quot;pinot.server.instance.realtime.alloc.offheap.direct&quot;;

    public static final int DEFAULT_ADMIN_API_PORT = 8097;
    public static final String DEFAULT_READ_MODE = &quot;heap&quot;;
<span class="nc" id="L239">    public static final String DEFAULT_INSTANCE_BASE_DIR =</span>
        System.getProperty(&quot;java.io.tmpdir&quot;) + File.separator + &quot;PinotServer&quot;;
<span class="nc" id="L241">    public static final String DEFAULT_INSTANCE_DATA_DIR = DEFAULT_INSTANCE_BASE_DIR + File.separator + &quot;index&quot;;</span>
<span class="nc" id="L242">    public static final String DEFAULT_INSTANCE_SEGMENT_TAR_DIR =</span>
        DEFAULT_INSTANCE_BASE_DIR + File.separator + &quot;segmentTar&quot;;
    public static final String DEFAULT_DATA_MANAGER_CLASS =
        &quot;com.linkedin.pinot.server.starter.helix.HelixInstanceDataManager&quot;;
    public static final String DEFAULT_QUERY_EXECUTOR_CLASS =
        &quot;com.linkedin.pinot.core.query.executor.ServerQueryExecutorV1Impl&quot;;
    public static final long DEFAULT_QUERY_EXECUTOR_TIMEOUT_MS = 15_000L;
    public static final String DEFAULT_REQUEST_HANDLER_FACTORY_CLASS =
        &quot;com.linkedin.pinot.server.request.SimpleRequestHandlerFactory&quot;;
    public static final String DEFAULT_SEGMENT_LOAD_MAX_RETRY_COUNT = &quot;5&quot;;
    public static final String DEFAULT_SEGMENT_LOAD_MIN_RETRY_DELAY_MILLIS = &quot;60000&quot;;
    public static final String PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = &quot;pinot.server.segment.fetcher&quot;;
    public static final String PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER = &quot;pinot.server.segment.uploader&quot;;
    public static final String DEFAULT_STAR_TREE_FORMAT_VERSION = &quot;OFF_HEAP&quot;;
    public static final String DEFAULT_COLUMN_MIN_MAX_VALUE_GENERATOR_MODE = &quot;TIME&quot;;
  }

<span class="nc" id="L259">  public static class Controller {</span>
    public static final String PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = &quot;pinot.controller.segment.fetcher&quot;;
    public static final String HOST_HTTP_HEADER = &quot;Pinot-Controller-Host&quot;;
    public static final String VERSION_HTTP_HEADER = &quot;Pinot-Controller-Version&quot;;
  }

<span class="nc" id="L265">  public static class Minion {</span>
    public static final String INSTANCE_PREFIX = &quot;Minion_&quot;;
    public static final String INSTANCE_TYPE = &quot;minion&quot;;
    public static final String UNTAGGED_INSTANCE = &quot;minion_untagged&quot;;
    public static final String METRICS_PREFIX = &quot;pinot.minion.&quot;;

    // Config keys
    public static final String METRICS_REGISTRY_REGISTRATION_LISTENERS_KEY = &quot;metricsRegistryRegistrationListeners&quot;;

    // Default settings
    public static final int DEFAULT_HELIX_PORT = 9514;
<span class="nc" id="L276">    public static final String DEFAULT_INSTANCE_BASE_DIR =</span>
        System.getProperty(&quot;java.io.tmpdir&quot;) + File.separator + &quot;PinotMinion&quot;;
<span class="nc" id="L278">    public static final String DEFAULT_INSTANCE_DATA_DIR = DEFAULT_INSTANCE_BASE_DIR + File.separator + &quot;data&quot;;</span>
    public static final String PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = &quot;segment.fetcher&quot;;
  }

<span class="nc" id="L282">  public static class Metric {</span>
<span class="nc" id="L283">    public static class Server {</span>
      public static final String CURRENT_NUMBER_OF_SEGMENTS = &quot;currentNumberOfSegments&quot;;
      public static final String CURRENT_NUMBER_OF_DOCUMENTS = &quot;currentNumberOfDocuments&quot;;
      public static final String NUMBER_OF_DELETED_SEGMENTS = &quot;numberOfDeletedSegments&quot;;
    }
  }

<span class="nc" id="L290">  public static class Segment {</span>
<span class="nc" id="L291">    public static class Realtime {</span>
<span class="pc" id="L292">      public enum Status {</span>
<span class="fc" id="L293">        IN_PROGRESS,</span>
<span class="fc" id="L294">        DONE</span>
      }
      public static final String STATUS = &quot;segment.realtime.status&quot;;
    }

<span class="nc" id="L299">    public static class Offline {</span>
      public static final String DOWNLOAD_URL = &quot;segment.offline.download.url&quot;;
      public static final String PUSH_TIME = &quot;segment.offline.push.time&quot;;
      public static final String REFRESH_TIME = &quot;segment.offline.refresh.time&quot;;
    }

    public static final String SEGMENT_NAME = &quot;segment.name&quot;;
    public static final String TABLE_NAME = &quot;segment.table.name&quot;;
    public static final String SEGMENT_TYPE = &quot;segment.type&quot;;
    public static final String INDEX_VERSION = &quot;segment.index.version&quot;;
    public static final String START_TIME = &quot;segment.start.time&quot;;
    public static final String END_TIME = &quot;segment.end.time&quot;;
    public static final String TIME_UNIT = &quot;segment.time.unit&quot;;
    public static final String TOTAL_DOCS = &quot;segment.total.docs&quot;;
    public static final String CRC = &quot;segment.crc&quot;;
    public static final String CREATION_TIME = &quot;segment.creation.time&quot;;
    public static final String FLUSH_THRESHOLD_SIZE = &quot;segment.flush.threshold.size&quot;;
    public static final String PARTITION_METADATA = &quot;segment.partition.metadata&quot;;
    /**
     * This field is used for parallel push protection to lock the segment globally.
     * We put the segment upload start timestamp so that if the previous push failed without unlock the segment, the
     * next upload won't be blocked forever.
     */
    public static final String SEGMENT_UPLOAD_START_TIME = &quot;segment.upload.start.time&quot;;

    public static final String CUSTOM_MAP = &quot;custom.map&quot;;

    public static final String SEGMENT_BACKUP_DIR_SUFFIX = &quot;.segment.bak&quot;;
    public static final String SEGMENT_TEMP_DIR_SUFFIX = &quot;.segment.tmp&quot;;

<span class="pc" id="L329">    public enum SegmentType {</span>
<span class="fc" id="L330">      OFFLINE,</span>
<span class="fc" id="L331">      REALTIME</span>
    }
  }

<span class="nc" id="L335">  public static class SegmentFetcher {</span>
<span class="nc" id="L336">    public static class HdfsSegmentFetcher {</span>
      public static final String PRINCIPLE = &quot;hadoop.kerberos.principle&quot;;
      public static final String KEYTAB = &quot;hadoop.kerberos.keytab&quot;;
      public static final String HADOOP_CONF_PATH = &quot;hadoop.conf.path&quot;;
    }

    public static final String RETRY = &quot;retry.count&quot;;
    public static final int RETRY_DEFAULT = 3;
    public static final String RETRY_WAITIME_MS = &quot;retry.wait.ms&quot;;
    public static final int RETRY_WAITIME_MS_DEFAULT = 100;
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>