<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started</title>
<link rel="stylesheet" href="css/blazebit.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="prettify/prettify.min.css">
<script src="prettify/prettify.min.js"></script>
<script src="prettify/lang-ext.js"></script>
<script>document.addEventListener('DOMContentLoaded', prettyPrint)</script>
<link rel="shortcut icon" href="images/favicon.png">
</head>
<body class="book toc2 toc-left">

<div class="brand">
    <a class="vendor" href="https://blazebit.com">
        <strong>Blazebit.com</strong>
    </a>
    <a class="logo" href="https://persistence.blazebit.com">
        <strong>blaze-persistence</strong>
    </a>
</div>
<br/>

<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#getting-started">Getting started</a>
<ul class="sectlevel2">
<li><a href="#getting-started-setup">Setup</a></li>
<li><a href="#anchor-environment">Environments</a></li>
<li><a href="#supported-java-runtimes">Supported Java runtimes</a></li>
<li><a href="#supported-environments-libraries">Supported environments/libraries</a></li>
<li><a href="#first-criteria-query">First criteria query</a></li>
<li><a href="#getting-started-summary">Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="getting-started"><a class="anchor" href="#getting-started"></a>Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a step-by-step introduction about how to get started with the core module of {projectname}.</p>
</div>
<div class="sect2">
<h3 id="getting-started-setup"><a class="anchor" href="#getting-started-setup"></a>Setup</h3>
<div class="paragraph">
<p>Every <a href="https://github.com/Blazebit/blaze-persistence/releases">release</a> comes with a distribution bundle named like <em>blaze-persistence-dist-VERSION</em>.
This distribution contains the <em>required</em> artifacts for the {projectname} core module as well as artifacts for integrations and other modules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>required - The core module artifacts and dependencies</p>
</li>
<li>
<p>entity-view - The entity view module artifacts and dependencies</p>
</li>
<li>
<p>jpa-criteria - The jpa-criteria module artifacts and dependencies</p>
</li>
<li>
<p>integration/hibernate - The integrations for various Hibernate versions</p>
</li>
<li>
<p>integration/datanucleus - The integration for DataNucleus</p>
</li>
<li>
<p>integration/eclipselink - The integration for EclipseLink</p>
</li>
<li>
<p>integration/openjpa - The integration for OpenJPA</p>
</li>
<li>
<p>integration/entity-view - Integrations for the entity view module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <em>required</em> artifacts are always necessary. Every other module builds up on that. Based on the JPA provider that is used, one of the integrations should be used.
Other modules are optional and normally don&#8217;t have dependencies on each other.</p>
</div>
<div class="sect3">
<h4 id="maven-setup"><a class="anchor" href="#maven-setup"></a>Maven setup</h4>
<div class="paragraph">
<p>We recommend you introduce a version property for {projectname} which can be used for all artifacts.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;properties&gt;
    &lt;blaze-persistence.version&gt;{version}&lt;/blaze-persistence.version&gt;
&lt;/properties&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The required dependencies for the core module are</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-core-api&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-core-impl&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the JPA provider that should be used, one of the following integrations is required</p>
</div>
<div class="sect4">
<h5 id="maven-setup-hibernate53"><a class="anchor" href="#maven-setup-hibernate53"></a>Hibernate 5.3</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-hibernate-5.3&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-hibernate52"><a class="anchor" href="#maven-setup-hibernate52"></a>Hibernate 5.2</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-hibernate-5.2&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-hibernate5"><a class="anchor" href="#maven-setup-hibernate5"></a>Hibernate 5+</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-hibernate-5&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-hibernate43"><a class="anchor" href="#maven-setup-hibernate43"></a>Hibernate 4.3</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-hibernate-4.3&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-hibernate42"><a class="anchor" href="#maven-setup-hibernate42"></a>Hibernate 4.2</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-hibernate-4.2&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-datanucleus51"><a class="anchor" href="#maven-setup-datanucleus51"></a>Datanucleus 5.1</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-datanucleus-5.1&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-datanucleus"><a class="anchor" href="#maven-setup-datanucleus"></a>Datanucleus 4 and 5</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-datanucleus&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-eclipselink"><a class="anchor" href="#maven-setup-eclipselink"></a>EclipseLink</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-eclipselink&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="maven-setup-openjpa"><a class="anchor" href="#maven-setup-openjpa"></a>OpenJPA</h5>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;com.blazebit&lt;/groupId&gt;
    &lt;artifactId&gt;blaze-persistence-integration-openjpa&lt;/artifactId&gt;
    &lt;version&gt;${blaze-persistence.version}&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="anchor-environment"><a class="anchor" href="#anchor-environment"></a>Environments</h3>
<div class="paragraph">
<p>{projectname} is usable in Java EE, Spring as well as in Java SE environments.</p>
</div>
<div class="sect3">
<h4 id="environments-java-se"><a class="anchor" href="#environments-java-se"></a>Java SE</h4>
<div class="paragraph">
<p>An instance of <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html"><code>CriteriaBuilderFactory</code></a> can be obtained as follows:</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">CriteriaBuilderConfiguration config = Criteria.getDefault();
// optionally, perform dynamic configuration
CriteriaBuilderFactory cbf = config.createCriteriaBuilderFactory(entityManagerFactory);</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="{core_jdoc}/persistence/Criteria.html#getDefault()"><code>Criteria.getDefault()</code></a> method uses the <code>java.util.ServiceLoader</code> to locate
the first implementation of <a href="{core_jdoc}/persistence/spi/CriteriaBuilderConfigurationProvider.html"><code>CriteriaBuilderConfigurationProvider</code></a> on the classpath
which it uses to obtain an instance of <a href="{core_jdoc}/persistence/spi/CriteriaBuilderConfiguration.html"><code>CriteriaBuilderConfiguration</code></a>.
The <a href="{core_jdoc}/persistence/spi/CriteriaBuilderConfiguration.html"><code>CriteriaBuilderConfiguration</code></a> instance also allows dynamic configuration of the
factory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html"><code>CriteriaBuilderFactory</code></a> should only be built once.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Creating the criteria builder factory eagerly at startup is required so that the integration can work properly.
Initializing it differently might result in data races because at creation time e.g. custom functions are registered.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="environments-java-ee"><a class="anchor" href="#environments-java-ee"></a>Java EE</h4>
<div class="paragraph">
<p>The most convenient way to use {projectname} within a Java EE environment is by using a startup EJB and a CDI producer.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">@Singleton // From javax.ejb
@Startup   // From javax.ejb
public class CriteriaBuilderFactoryProducer {

    // inject your entity manager factory
    @PersistenceUnit
    private EntityManagerFactory entityManagerFactory;

    private CriteriaBuilderFactory criteriaBuilderFactory;

    @PostConstruct
    public void init() {
        CriteriaBuilderConfiguration config = Criteria.getDefault();
        // do some configuration
        this.criteriaBuilderFactory = config.createCriteriaBuilderFactory(entityManagerFactory);
    }

    @Produces
    @ApplicationScoped
    public CriteriaBuilderFactory createCriteriaBuilderFactory() {
        return criteriaBuilderFactory;
    }
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="environments-cdi"><a class="anchor" href="#environments-cdi"></a>CDI</h4>
<div class="paragraph">
<p>If EJBs aren&#8217;t available, the <code>CriteriaBuilderFactory</code> can also be configured in a CDI 1.1 specific way by creating a simple producer method like the following example shows.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">@ApplicationScoped
public class CriteriaBuilderFactoryProducer {

    // inject your entity manager factory
    @PersistenceUnit
    private EntityManagerFactory entityManagerFactory;

    private volatile CriteriaBuilderFactory criteriaBuilderFactory;

    public void init(@Observes @Initialized(ApplicationScoped.class) Object init) {
        CriteriaBuilderConfiguration config = Criteria.getDefault();
        // do some configuration
        this.criteriaBuilderFactory = config.createCriteriaBuilderFactory(entityManagerFactory);
    }

    @Produces
    @ApplicationScoped
    public CriteriaBuilderFactory createCriteriaBuilderFactory() {
        return criteriaBuilderFactory;
    }
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="environments-spring"><a class="anchor" href="#environments-spring"></a>Spring</h4>
<div class="paragraph">
<p>Within a Spring application the <code>CriteriaBuilderFactory</code> can be provided for injection like this.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">@Configuration
public class BlazePersistenceConfiguration {

    @PersistenceUnit
    private EntityManagerFactory entityManagerFactory;

    @Bean
    @Scope(ConfigurableBeanFactory.SCOPE_SINGLETON)
    @Lazy(false)
    public CriteriaBuilderFactory createCriteriaBuilderFactory() {
        CriteriaBuilderConfiguration config = Criteria.getDefault();
        // do some configuration
        return config.createCriteriaBuilderFactory(entityManagerFactory);
    }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="supported-java-runtimes"><a class="anchor" href="#supported-java-runtimes"></a>Supported Java runtimes</h3>
<div class="paragraph">
<p>All projects are built for Java 7 except for the ones where dependencies already use Java 8 like e.g. Hibernate 5.2, Spring Data 2.0 etc.
So you are going to need at least JDK 8 for building the project.</p>
</div>
<div class="paragraph">
<p>We also support building the project with JDK 9 and try to keep up with newer versions.
If you want to run your application on a Java 9 JVM you need to handle the fact that JDK 9+ doesn&#8217;t export some APIs like the JAXB, JAF, javax.annotations and JTA anymore.
In fact, JDK 11 will even remove the modules so the command line flags to add modules to the classpath won&#8217;t work.</p>
</div>
<div class="paragraph">
<p>Since libraries like Hibernate and others require these APIs you need to make them available. The easiest way to get these APIs back on the classpath is to package them along with your application.
This will also work when running on Java 8. We suggest you add the following dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint xml lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
    &lt;version&gt;2.2.11&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;
    &lt;version&gt;2.2.11&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
    &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;
    &lt;version&gt;2.2.11&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
    &lt;artifactId&gt;javax.transaction-api&lt;/artifactId&gt;
    &lt;version&gt;1.2&lt;/version&gt;
    &lt;!-- In a managed environment like Java EE, use 'provided'. Otherwise use 'compile' --&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.activation&lt;/groupId&gt;
    &lt;artifactId&gt;activation&lt;/artifactId&gt;
    &lt;version&gt;1.1.1&lt;/version&gt;
    &lt;!-- In a managed environment like Java EE, use 'provided'. Otherwise use 'compile' --&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;javax.annotation&lt;/groupId&gt;
    &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;
    &lt;version&gt;1.3.2&lt;/version&gt;
    &lt;!-- In a managed environment like Java EE, use 'provided'. Otherwise use 'compile' --&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Automatic module names for modules.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Automatic module name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Impl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.core.impl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Parser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.core.parser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JPA Criteria API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.criteria</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Impl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.criteria.impl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JPA Criteria JPA2 Compatibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.criteria.jpa2compatibility</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="supported-environments-libraries"><a class="anchor" href="#supported-environments-libraries"></a>Supported environments/libraries</h3>
<div class="paragraph">
<p>The bare minimum is JPA 2.0. If you want to use the JPA Criteria API module, you will also have to add the JPA 2 compatibility module.
Generally, we support the usage in Java EE 6+ or Spring 4+ applications.</p>
</div>
<div class="paragraph">
<p>The following table outlines the supported library versions for the integrations.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Automatic module name</th>
<th class="tableblock halign-left valign-top">Minimum version</th>
<th class="tableblock halign-left valign-top">Supported versions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hibernate integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.integration.hibernate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hibernate 4.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.2, 4.3, 5.0, 5.1, 5.2, 5.3 (not all features are available in older versions)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EclipseLink integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.integration.eclipselink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EclipseLink 2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6 (Probably 2.4 and 2.5 work as well, but only tested against 2.6)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataNucleus integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.integration.datanucleus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataNucleus 4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.1, 5.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenJPA integration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.blazebit.persistence.integration.openjpa</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Currently not usable. OpenJPA doesn&#8217;t seem to be actively developed anymore and no users asked for support yet)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="first-criteria-query"><a class="anchor" href="#first-criteria-query"></a>First criteria query</h3>
<div class="paragraph">
<p>This section is supposed to give you a first feeling of how to use the criteria
builder. For more detailed information, please see the subsequent chapters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the following we suppose <code>cbf</code> and <code>em</code> to refer to an instance of <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html"><code>CriteriaBuilderFactory</code></a>
and JPA&#8217;s <code>EntityManager</code>, respectively.
Take a look at the <a href="#anchor-environment">environments</a> chapter for how to obtain a <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html"><code>CriteriaBuilderFactory</code></a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the simplest query possible:</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">CriteriaBuilder&lt;Cat&gt; cb = cbf.create(em, Cat.class);</pre>
</div>
</div>
<div class="paragraph">
<p>This query simply selects all Cat objects and is equivalent to following JPQL query:</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint sqlext lang-sqlext">SELECT c FROM Cat c</pre>
</div>
</div>
<div class="paragraph">
<p>Once the <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html#create(javax.persistence.EntityManager,%20java.lang.Class)"><code>create()</code></a> method is called the expression
returns a <a href="{core_jdoc}/persistence/CriteriaBuilder.html"><code>CriteriaBuilder&lt;T&gt;</code></a> where <code>T</code> is specified via the second parameter of the
<a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html#create(javax.persistence.EntityManager,%20java.lang.Class)"><code>create()</code></a> method and denotes the result type of the query.
The default behavior of <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html#create(javax.persistence.EntityManager,%20java.lang.Class)"><code>create()</code></a> is that the result type
is assumed to be the entity class from which to select. So if we would like to only select the cats' age we would have to write:</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">CriteriaBuilder&lt;Integer&gt; cb = cbf.create(em, Integer.class)
    .from(Cat.class)
    .select("cat.age");</pre>
</div>
</div>
<div class="paragraph">
<p>Here we can see that the criteria builder assigns a default alias (the simple lower-case name of the entity class)
to the entity class from which we select (root entity) if we do not specify one. If we want to save some
writing, both the <a href="{core_jdoc}/persistence/CriteriaBuilderFactory.html#create(javax.persistence.EntityManager,%20java.lang.Class)"><code>create()</code></a> and
the <a href="{core_jdoc}/persistence/FromBuilder.html#from(java.lang.Class,%20java.lang.String)"><code>from()</code></a> method allow the specification of a custom alias for the root entity:</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">CriteriaBuilder&lt;Integer&gt; cb = cbf.create(em, Integer.class)
    .from(Cat.class, "c")
    .select("c.age");</pre>
</div>
</div>
<div class="paragraph">
<p>Next we want to build a more complicated query. Let&#8217;s select all cats with an
age between 5 and 10 years and with at least two kittens. Additionally, we would
like to order the results by name ascending and by id in case of equal names.</p>
</div>
<div class="listingblock">
<div class="content">
    <pre class="prettyprint javaext lang-javaext">CriteriaBuilder&lt;Cat&gt; cb = cbf.create(em, Cat.class, "c")
    .where("c.age").betweenExpression("5").andExpression("10")
    .where("SIZE(c.kittens)").geExpression("2")
    .orderByAsc("c.name")
    .orderByAsc("c.id");</pre>
</div>
</div>
<div class="paragraph">
<p>We have built a couple of queries so far but how can we retrieve the results?
There are two possible ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>List&lt;Cat&gt; cats = cb.getResultList();</code> to retrieve all results</p>
</li>
<li>
<p><code>PagedList&lt;Cat&gt; cats = cb.page(0, 10).getResultList();</code> to retrieve 10 results starting from the first result
(you must specify at least one unique column to determine the order of results)</p>
<div class="paragraph">
<p>The <code>PagedList&lt;Cat&gt;</code> features the <a href="{core_jdoc}/persistence/PagedList.html#getTotalSize()"><code>getTotalSize()</code></a> method which is perfectly suited for displaying the results in a
paginated table. Moreover the <a href="{core_jdoc}/persistence/PagedList.html#getKeysetPage()"><code>getKeysetPage()</code></a> method can be used to switch to keyset pagination for further paging.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="getting-started-summary"><a class="anchor" href="#getting-started-summary"></a>Summary</h3>
<div class="paragraph">
<p>If you want to go into more detail, you are now ready to discover the other chapters of the documentation or
the API yourself.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-08-04 13:32:35 KST
</div>
</div>
</body>
</html>