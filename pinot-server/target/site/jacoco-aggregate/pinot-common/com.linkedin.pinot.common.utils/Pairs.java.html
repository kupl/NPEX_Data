<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Pairs.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">pinot-server</a> &gt; <a href="../index.html" class="el_bundle">pinot-common</a> &gt; <a href="index.source.html" class="el_package">com.linkedin.pinot.common.utils</a> &gt; <span class="el_source">Pairs.java</span></div><h1>Pairs.java</h1><pre class="source lang-java linenums">/**
 * Copyright (C) 2014-2016 LinkedIn Corp. (pinot-core@linkedin.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.linkedin.pinot.common.utils;

import java.util.Comparator;

<span class="nc" id="L20">public class Pairs {</span>

  public static IntPair intPair(int a, int b) {
<span class="fc" id="L23">    return new IntPair(a, b);</span>
  }

  public static Comparator&lt;IntPair&gt; intPairComparator() {
<span class="nc" id="L27">    return new AscendingIntPairComparator();</span>
  }

  public static class IntPair {
    int a;

    int b;

<span class="fc" id="L35">    public IntPair(int a, int b) {</span>
<span class="fc" id="L36">      this.a = a;</span>
<span class="fc" id="L37">      this.b = b;</span>
<span class="fc" id="L38">    }</span>

    public int getLeft() {
<span class="fc" id="L41">      return a;</span>
    }

    public int getRight() {
<span class="fc" id="L45">      return b;</span>
    }

    public void setLeft(int a) {
<span class="fc" id="L49">      this.a = a;</span>
<span class="fc" id="L50">    }</span>

    public void setRight(int b) {
<span class="fc" id="L53">      this.b = b;</span>
<span class="fc" id="L54">    }</span>

    @Override
    public String toString() {
<span class="fc" id="L58">      return &quot;[&quot; + a + &quot;,&quot; + b + &quot;]&quot;;</span>
    }

    @Override
    public int hashCode() {
<span class="nc" id="L63">      return toString().hashCode();</span>
    }

    @Override
    public boolean equals(Object obj) {
<span class="pc bpc" id="L68" title="1 of 2 branches missed.">      if (obj instanceof IntPair) {</span>
<span class="fc" id="L69">        IntPair that = (IntPair) obj;</span>
<span class="pc bpc" id="L70" title="3 of 6 branches missed.">        return obj != null &amp;&amp; a == (that.a) &amp;&amp; b == that.b;</span>
      }
<span class="nc" id="L72">      return false;</span>
    }
  }

<span class="nc" id="L76">  public static class AscendingIntPairComparator implements Comparator&lt;IntPair&gt; {</span>

    @Override
    public int compare(IntPair o1, IntPair o2) {
<span class="nc" id="L80">      return Integer.compare(o1.a, o2.a);</span>
    }
  }

  public static Comparator&lt;Number2ObjectPair&gt; getAscendingnumber2ObjectPairComparator() {
<span class="nc" id="L85">    return new AscendingNumber2ObjectPairComparator();</span>
  }

  public static Comparator&lt;Number2ObjectPair&gt; getDescendingnumber2ObjectPairComparator() {
<span class="nc" id="L89">    return new DescendingNumber2ObjectPairComparator();</span>
  }

  public static class Number2ObjectPair&lt;T&gt; {
    Number a;

    T b;

<span class="nc" id="L97">    public Number2ObjectPair(Number a, T b) {</span>
<span class="nc" id="L98">      this.a = a;</span>
<span class="nc" id="L99">      this.b = b;</span>
<span class="nc" id="L100">    }</span>

    public Number getA() {
<span class="nc" id="L103">      return a;</span>
    }

    public T getB() {
<span class="nc" id="L107">      return b;</span>
    }
  }

<span class="nc" id="L111">  public static class AscendingNumber2ObjectPairComparator</span>
      implements Comparator&lt;Number2ObjectPair&gt; {
    @Override
    public int compare(Number2ObjectPair o1, Number2ObjectPair o2) {
<span class="nc" id="L115">      return new Double(o1.a.doubleValue()).compareTo(new Double(o2.a.doubleValue()));</span>
    }
  }

<span class="nc" id="L119">  public static class DescendingNumber2ObjectPairComparator</span>
      implements Comparator&lt;Number2ObjectPair&gt; {
    @Override
    public int compare(Number2ObjectPair o1, Number2ObjectPair o2) {
<span class="nc" id="L123">      return new Double(o2.a.doubleValue()).compareTo(new Double(o1.a.doubleValue()));</span>
    }
  }

  /**
   * Utility class to store a primitive 'int' and 'double' pair.
   */
  public static class IntDoublePair {
    int _intValue;
    double _doubleValue;

    /**
     * Constructor for the class
     *
     * @param intVal 'int' value
     * @param doubleVal 'double' value
     */
<span class="fc" id="L140">    public IntDoublePair(int intVal, double doubleVal) {</span>
<span class="fc" id="L141">      _intValue = intVal;</span>
<span class="fc" id="L142">      _doubleValue = doubleVal;</span>
<span class="fc" id="L143">    }</span>

    /**
     * Sets the provided value into the 'int' field.
     * @param intVal Value to set
     */
    public void setIntValue(int intVal) {
<span class="fc" id="L150">      _intValue = intVal;</span>
<span class="fc" id="L151">    }</span>

    /**
     * Returns the int value of the pair
     * @return 'int' value
     */
    public int getIntValue() {
<span class="fc" id="L158">      return _intValue;</span>
    }

    /**
     * Sets the provided value into the 'double' field.
     * @param doubleVal Value to set
     */
    public void setDoubleValue(double doubleVal) {
<span class="fc" id="L166">      _doubleValue = doubleVal;</span>
<span class="fc" id="L167">    }</span>

    /**
     * Returns the double value of the pair
     * @return 'double' value
     */
    public double getDoubleValue() {
<span class="fc" id="L174">      return _doubleValue;</span>
    }
  }

  /**
   * Comparator class for comparing {@link IntDoublePair}.
   */
  public static class IntDoubleComparator implements Comparator&lt;IntDoublePair&gt; {
    private final boolean _descending;

<span class="fc" id="L184">    public IntDoubleComparator(boolean descending) {</span>
<span class="fc" id="L185">      _descending = descending;</span>
<span class="fc" id="L186">    }</span>

    @Override
    public int compare(IntDoublePair o1, IntDoublePair o2) {
<span class="fc" id="L190">      double v1 = o1.getDoubleValue();</span>
<span class="fc" id="L191">      double v2 = o2.getDoubleValue();</span>

<span class="fc bfc" id="L193" title="All 2 branches covered.">      if (v1 &lt; v2) {</span>
<span class="fc bfc" id="L194" title="All 2 branches covered.">        return  (_descending) ? 1 : -1;</span>
<span class="pc bpc" id="L195" title="1 of 2 branches missed.">      } else if (v1 &gt; v2) {</span>
<span class="fc bfc" id="L196" title="All 2 branches covered.">        return (_descending) ? -1 : 1;</span>
      } else {
<span class="nc" id="L198">        return 0;</span>
      }
    }
  }

  /**
   * Utility class to store a primitive 'int' and 'Object' pair.
   */
  public static class IntObjectPair&lt;T extends Comparable&gt; {
    int _intValue;
    T _objectValue;

    /**
     * Constructor for the class
     *
     * @param intVal 'int' value
     * @param objectVal 'Object' value
     */
<span class="fc" id="L216">    public IntObjectPair(int intVal, T objectVal) {</span>
<span class="fc" id="L217">      _intValue = intVal;</span>
<span class="fc" id="L218">      _objectValue = objectVal;</span>
<span class="fc" id="L219">    }</span>

    /**
     * Sets the provided value into the 'int' field.
     */
    public void setIntValue(int intValue) {
<span class="fc" id="L225">      _intValue = intValue;</span>
<span class="fc" id="L226">    }</span>

    /**
     * Returns the int value of the pair
     * @return 'int' value
     */
    public int getIntValue() {
<span class="fc" id="L233">      return _intValue;</span>
    }

    /**
     * Sets the specified object value into the 'object' field.
     */
    public void setObjectValue(T objectValue) {
<span class="fc" id="L240">      _objectValue = objectValue;</span>
<span class="fc" id="L241">    }</span>

    /**
     * Returns the object value of the pair
     * @return 'Object' value
     */
    public T getObjectValue() {
<span class="fc" id="L248">      return _objectValue;</span>
    }
  }

  /**
   * Comparator for {@link IntObjectComparator} class
   */
<span class="nc" id="L255">  public static class IntObjectComparator implements Comparator&lt;IntObjectPair&gt; {</span>
    private final boolean _descending;

<span class="fc" id="L258">    public IntObjectComparator(boolean descending) {</span>
<span class="fc" id="L259">      _descending = descending;</span>
<span class="fc" id="L260">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    @Override
    public int compare(IntObjectPair pair1, IntObjectPair pair2) {

<span class="fc" id="L266">      Comparable c1 = (Comparable) pair1.getObjectValue();</span>
<span class="fc" id="L267">      Comparable c2 = (Comparable) pair2.getObjectValue();</span>

<span class="fc" id="L269">      int cmpValue = c1.compareTo(c2);</span>
<span class="fc bfc" id="L270" title="All 2 branches covered.">      if (cmpValue == -1) {</span>
<span class="fc bfc" id="L271" title="All 2 branches covered.">        return (_descending) ? 1 : -1;</span>
<span class="fc bfc" id="L272" title="All 2 branches covered.">      } else if (cmpValue == 1) {</span>
<span class="fc bfc" id="L273" title="All 2 branches covered.">        return (_descending) ? -1 : 1;</span>
      } else {
<span class="fc" id="L275">        return 0;</span>
      }
    }
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>