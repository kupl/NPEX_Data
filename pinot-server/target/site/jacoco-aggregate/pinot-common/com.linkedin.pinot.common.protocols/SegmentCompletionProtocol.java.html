<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>SegmentCompletionProtocol.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">pinot-server</a> &gt; <a href="../index.html" class="el_bundle">pinot-common</a> &gt; <a href="index.source.html" class="el_package">com.linkedin.pinot.common.protocols</a> &gt; <span class="el_source">SegmentCompletionProtocol.java</span></div><h1>SegmentCompletionProtocol.java</h1><pre class="source lang-java linenums">/**
 * Copyright (C) 2014-2016 LinkedIn Corp. (pinot-core@linkedin.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.linkedin.pinot.common.protocols;

import java.util.concurrent.TimeUnit;
import com.alibaba.fastjson.JSONObject;

/*
 * This class encapsulates the segment completion protocol used by the server and the controller for
 * low-level kafka consumer realtime segments. The protocol has two requests: SegmentConsumedRequest
 * and SegmentCommitRequest.It has a response that may contain different status codes depending on the state machine
 * that the controller drives for that segment. All responses have two elements -- status and an offset.
 *
 * The overall idea is that when a server has completed consuming a segment until the &quot;end criteria&quot; that
 * is set (in the table configuration), it sends a SegmentConsumedRequest to the controller (leader).  The
 * controller may respond with a HOLD, asking the server to NOT consume any new kafka messages, but get back
 * to the controller after a while.
 *
 * Meanwhile, the controller co-ordinates the SegmentConsumedRequest messages from replicas and selects a server
 * to commit the segment. The server uses SegmentCommitRequest message, in which it also posts the completed
 * segment to the controller.
 *
 * The controller may respond with a failure for this commit message, but on success, the controller changes the
 * segment state to ONLINE in idealstate, and adds new CONSUMING segments as well.
 *
 * For details see the design document
 * https://github.com/linkedin/pinot/wiki/Low-level-kafka-consumers
 */
<span class="nc" id="L42">public class SegmentCompletionProtocol {</span>

  /**
   * MAX_HOLD_TIME_MS is the maximum time (msecs) for which a server will be in HOLDING state, after which it will
   * send in a SegmentConsumedRequest with its current offset in kafka.
   */
  public static final long MAX_HOLD_TIME_MS = 3000;
  /**
   * MAX_SEGMENT_COMMIT_TIME_MS is the longest time (msecs) a server will take to complete building a segment and committing
   * it  (via a SegmentCommit message) after the server has been notified that it is the committer.
   */
  private static final int DEFAULT_MAX_SEGMENT_COMMIT_TIME_SEC = 120;
<span class="fc" id="L54">  private static long MAX_SEGMENT_COMMIT_TIME_MS = TimeUnit.MILLISECONDS.convert(DEFAULT_MAX_SEGMENT_COMMIT_TIME_SEC, TimeUnit.SECONDS);</span>

<span class="pc" id="L56">  public enum ControllerResponseStatus {</span>
    /** Never sent by the controller, but locally used by server when sending a request fails */
<span class="fc" id="L58">    NOT_SENT,</span>

    /** Server should send back a SegmentCommitRequest after processing this response */
<span class="fc" id="L61">    COMMIT,</span>

    /** Server should send SegmentConsumedRequest after waiting for less than MAX_HOLD_TIME_MS */
<span class="fc" id="L64">    HOLD,</span>

    /** Server should consume kafka events to catch up to the offset contained in this response */
<span class="fc" id="L67">    CATCH_UP,</span>

    /** Server should discard the rows in memory */
<span class="fc" id="L70">    DISCARD,</span>

    /** Server should build a segment out of the rows in memory, and replace in-memory rows with the segment built */
<span class="fc" id="L73">    KEEP,</span>

    /** Server should locate the current controller leader and re-send the message */
<span class="fc" id="L76">    NOT_LEADER,</span>

    /** Commit failed. Server should go back to HOLDING state and re-start with the SegmentConsumed message  */
<span class="fc" id="L79">    FAILED,</span>

    /** Commit succeeded, behave exactly like KEEP */
<span class="fc" id="L82">    COMMIT_SUCCESS,</span>

    /** Never sent by the controller, but locally used by the controller during the segmentCommit() processing */
<span class="fc" id="L85">    COMMIT_CONTINUE,</span>

    /** Sent by controller as an acknowledgement to the SegmentStoppedConsuming message */
<span class="fc" id="L88">    PROCESSED,</span>

    /** Sent by controller as an acknowledgement during split commit for successful segment upload */
<span class="fc" id="L91">    UPLOAD_SUCCESS,</span>
  }

  public static final String STATUS_KEY = &quot;status&quot;;
  public static final String OFFSET_KEY = &quot;offset&quot;;
  public static final String BUILD_TIME_KEY = &quot;buildTimeSec&quot;;  // Sent by controller in COMMIT message
  public static final String COMMIT_TYPE_KEY = &quot;isSplitCommitType&quot;;
  public static final String SEGMENT_LOCATION_KEY = &quot;segmentLocation&quot;;
  public static final String CONTROLLER_VIP_URL_KEY = &quot;controllerVipUrl&quot;;

  public static final String MSG_TYPE_CONSUMED = &quot;segmentConsumed&quot;;
  public static final String MSG_TYPE_COMMIT = &quot;segmentCommit&quot;;
  public static final String MSG_TYPE_COMMIT_START = &quot;segmentCommitStart&quot;;
  public static final String MSG_TYPE_SEGMENT_UPLOAD = &quot;segmentUpload&quot;;
  public static final String MSG_TYPE_COMMIT_END = &quot;segmentCommitEnd&quot;;
  public static final String MSG_TYPE_STOPPED_CONSUMING = &quot;segmentStoppedConsuming&quot;;
  public static final String MSG_TYPE_EXTEND_BUILD_TIME = &quot;extendBuildTime&quot;;

  public static final String PARAM_SEGMENT_LOCATION = &quot;location&quot;;
  public static final String PARAM_SEGMENT_NAME = &quot;name&quot;;
  public static final String PARAM_OFFSET = &quot;offset&quot;;
  public static final String PARAM_INSTANCE_ID = &quot;instance&quot;;
  public static final String PARAM_MEMORY_USED_BYTES = &quot;memoryUsedBytes&quot;;
  public static final String PARAM_REASON = &quot;reason&quot;;
  public static final String PARAM_EXTRA_TIME_SEC = &quot;extraTimeSec&quot;; // Sent by servers to request additional time to build
  public static final String PARAM_ROW_COUNT = &quot;rowCount&quot;; // Sent by servers to indicate the number of rows read so far
  public static final String PARAM_BUILD_TIME_MILLIS = &quot;buildTimeMillis&quot;; // Time taken to build segment
  public static final String PARAM_WAIT_TIME_MILLIS = &quot;waitTimeMillis&quot;;   // Time taken to wait for build to start.

  public static final String REASON_ROW_LIMIT = &quot;rowLimit&quot;;  // Stop reason sent by server as max num rows reached
  public static final String REASON_TIME_LIMIT = &quot;timeLimit&quot;;  // Stop reason sent by server as max time reached

  // Canned responses
<span class="fc" id="L124">  public static final Response RESP_NOT_LEADER = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.NOT_LEADER));
<span class="fc" id="L126">  public static final Response RESP_FAILED = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.FAILED));
<span class="fc" id="L128">  public static final Response RESP_DISCARD = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.DISCARD));
<span class="fc" id="L130">  public static final Response RESP_COMMIT_SUCCESS = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.COMMIT_SUCCESS));
<span class="fc" id="L132">  public static final Response RESP_COMMIT_CONTINUE = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.COMMIT_CONTINUE));
<span class="fc" id="L134">  public static final Response RESP_PROCESSED = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.PROCESSED));
<span class="fc" id="L136">  public static final Response RESP_NOT_SENT = new Response(new Response.Params().withStatus(</span>
      ControllerResponseStatus.NOT_SENT));

  public static long getMaxSegmentCommitTimeMs() {
<span class="nc" id="L140">    return MAX_SEGMENT_COMMIT_TIME_MS;</span>
  }

  public static void setMaxSegmentCommitTimeMs(long commitTimeMs) {
<span class="nc" id="L144">    MAX_SEGMENT_COMMIT_TIME_MS = commitTimeMs;</span>
<span class="nc" id="L145">  }</span>

  public static int getDefaultMaxSegmentCommitTimeSeconds() {
<span class="fc" id="L148">    return DEFAULT_MAX_SEGMENT_COMMIT_TIME_SEC;</span>
  }

  public static abstract class Request {
    final Params _params;
    final String _msgType;

<span class="nc" id="L155">    private Request(Params params, String msgType) {</span>
<span class="nc" id="L156">      _params = params;</span>
<span class="nc" id="L157">      _msgType = msgType;</span>
<span class="nc" id="L158">    }</span>

    public String getUrl(String hostPort, String protocol) {
<span class="nc bnc" id="L161" title="All 12 branches missed.">      return protocol + &quot;://&quot; + hostPort +  &quot;/&quot; + _msgType + &quot;?&quot; +</span>
        PARAM_SEGMENT_NAME + &quot;=&quot; + _params.getSegmentName() + &quot;&amp;&quot; +
        PARAM_OFFSET + &quot;=&quot; + _params.getOffset() + &quot;&amp;&quot; +
        PARAM_INSTANCE_ID + &quot;=&quot; + _params.getInstanceId() +
          (_params.getReason() == null ? &quot;&quot; : (&quot;&amp;&quot; + PARAM_REASON + &quot;=&quot; + _params.getReason())) +
          (_params.getBuildTimeMillis() &lt;= 0 ? &quot;&quot; :(&quot;&amp;&quot; + PARAM_BUILD_TIME_MILLIS + &quot;=&quot; + _params.getBuildTimeMillis())) +
          (_params.getWaitTimeMillis() &lt;= 0 ? &quot;&quot; : (&quot;&amp;&quot; + PARAM_WAIT_TIME_MILLIS + &quot;=&quot; + _params.getWaitTimeMillis())) +
          (_params.getExtraTimeSec() &lt;= 0 ? &quot;&quot; : (&quot;&amp;&quot; + PARAM_EXTRA_TIME_SEC + &quot;=&quot; + _params.getExtraTimeSec())) +
          (_params.getNumRows() &lt;= 0 ? &quot;&quot; : (&quot;&amp;&quot; + PARAM_ROW_COUNT + &quot;=&quot; + _params.getNumRows())) +
          (_params.getSegmentLocation() == null ? &quot;&quot; : (&quot;&amp;&quot; + PARAM_SEGMENT_LOCATION + &quot;=&quot; + _params.getSegmentLocation()));
    }

    public static class Params {
      private long _offset;
      private String _segmentName;
      private String _instanceId;
      private String _reason;
      private int _numRows;
      private long _buildTimeMillis;
      private long _waitTimeMillis;
      private int _extraTimeSec;
      private String _segmentLocation;
      private long _memoryUsedBytes;

<span class="fc" id="L185">      public Params() {</span>
<span class="fc" id="L186">        _offset = -1L;</span>
<span class="fc" id="L187">        _segmentName = &quot;UNKNOWN_SEGMENT&quot;;</span>
<span class="fc" id="L188">        _instanceId = &quot;UNKNOWN_INSTANCE&quot;;</span>
<span class="fc" id="L189">        _numRows = -1;</span>
<span class="fc" id="L190">        _buildTimeMillis = -1;</span>
<span class="fc" id="L191">        _waitTimeMillis = -1;</span>
<span class="fc" id="L192">        _extraTimeSec = -1;</span>
<span class="fc" id="L193">        _segmentLocation = null;</span>
<span class="fc" id="L194">        _memoryUsedBytes = -1;</span>
<span class="fc" id="L195">      }</span>

      public Params withOffset(long offset) {
<span class="fc" id="L198">        _offset = offset;</span>
<span class="fc" id="L199">        return this;</span>
      }

      public Params withSegmentName(String segmentName) {
<span class="fc" id="L203">        _segmentName = segmentName;</span>
<span class="fc" id="L204">        return this;</span>
      }
      public Params withInstanceId(String instanceId) {
<span class="nc" id="L207">        _instanceId = instanceId;</span>
<span class="nc" id="L208">        return this;</span>
      }

      public Params withReason(String reason) {
<span class="nc" id="L212">        _reason = reason;</span>
<span class="nc" id="L213">        return this;</span>
      }

      public Params withNumRows(int numRows) {
<span class="nc" id="L217">        _numRows = numRows;</span>
<span class="nc" id="L218">        return this;</span>
      }

      public Params withBuildTimeMillis(long buildTimeMillis) {
<span class="nc" id="L222">        _buildTimeMillis = buildTimeMillis;</span>
<span class="nc" id="L223">        return this;</span>
      }

      public Params withWaitTimeMillis(long waitTimeMillis) {
<span class="nc" id="L227">        _waitTimeMillis = waitTimeMillis;</span>
<span class="nc" id="L228">        return this;</span>
      }

      public Params withExtraTimeSec(int extraTimeSec) {
<span class="fc" id="L232">        _extraTimeSec = extraTimeSec;</span>
<span class="fc" id="L233">        return this;</span>
      }

      public Params withSegmentLocation(String segmentLocation) {
<span class="nc" id="L237">        _segmentLocation = segmentLocation;</span>
<span class="nc" id="L238">        return this;</span>
      }

      public Params withMemoryUsedBytes(long memoryUsedBytes) {
<span class="nc" id="L242">        _memoryUsedBytes = memoryUsedBytes;</span>
<span class="nc" id="L243">        return this;</span>
      }

      public String getSegmentName() {
<span class="nc" id="L247">        return _segmentName;</span>
      }

      public long getOffset() {
<span class="nc" id="L251">        return _offset;</span>
      }

      public String getReason() {
<span class="nc" id="L255">        return _reason;</span>
      }

      public String getInstanceId() {
<span class="nc" id="L259">        return _instanceId;</span>
      }

      public int getNumRows() {
<span class="nc" id="L263">        return _numRows;</span>
      }

      public long getBuildTimeMillis() {
<span class="nc" id="L267">        return _buildTimeMillis;</span>
      }

      public long getWaitTimeMillis() {
<span class="nc" id="L271">        return _waitTimeMillis;</span>
      }

      public int getExtraTimeSec() {
<span class="nc" id="L275">        return _extraTimeSec;</span>
      }

      public String getSegmentLocation() {
<span class="nc" id="L279">        return _segmentLocation;</span>
      }

<span class="nc" id="L282">      public long getMemoryUsedBytes() { return _memoryUsedBytes; }</span>

      public String toString() {
<span class="nc" id="L285">        return &quot;Offset: &quot; + _offset</span>
            + &quot;,Segment name: &quot; + _segmentName
            + &quot;,Instance Id: &quot; + _instanceId
            + &quot;,Reason: &quot; + _reason
            + &quot;,NumRows: &quot; + _numRows
            + &quot;,BuildTimeMillis: &quot; + _buildTimeMillis
            + &quot;,WaitTimeMillis: &quot; + _waitTimeMillis
            + &quot;,ExtraTimeSec: &quot; + _extraTimeSec
            + &quot;,SegmentLocation: &quot; + _segmentLocation
            + &quot;,Memory Used Bytes: &quot; + _memoryUsedBytes;
      }
    }
  }

  public static class ExtendBuildTimeRequest extends Request {
    public ExtendBuildTimeRequest(Params params) {
<span class="nc" id="L301">      super(params, MSG_TYPE_EXTEND_BUILD_TIME);</span>
<span class="nc" id="L302">    }</span>
  }

  public static class SegmentConsumedRequest extends Request {
    public SegmentConsumedRequest(Params params) {
<span class="nc" id="L307">      super(params, MSG_TYPE_CONSUMED);</span>
<span class="nc" id="L308">    }</span>
  }

  public static class SegmentCommitRequest extends Request {
    public SegmentCommitRequest(Params params) {
<span class="nc" id="L313">      super(params, MSG_TYPE_COMMIT);</span>
<span class="nc" id="L314">    }</span>
  }

  public static class SegmentCommitStartRequest extends Request {
    public SegmentCommitStartRequest(Params params) {
<span class="nc" id="L319">      super(params, MSG_TYPE_COMMIT_START);</span>
<span class="nc" id="L320">    }</span>
  }

  public static class SegmentCommitUploadRequest extends Request {
    public SegmentCommitUploadRequest(Params params) {
<span class="nc" id="L325">      super(params, MSG_TYPE_SEGMENT_UPLOAD);</span>
<span class="nc" id="L326">    }</span>
  }

  public static class SegmentCommitEndRequest extends Request {
    public SegmentCommitEndRequest(Params params) {
<span class="nc" id="L331">      super(params, MSG_TYPE_COMMIT_END);</span>
<span class="nc" id="L332">    }</span>
  }

  public static class SegmentStoppedConsuming extends Request {
    public SegmentStoppedConsuming(Params params) {
<span class="nc" id="L337">      super(params, MSG_TYPE_STOPPED_CONSUMING);</span>
<span class="nc" id="L338">    }</span>
  }

<span class="nc" id="L341">  public static class Response {</span>
    final ControllerResponseStatus _status;
    final long _offset;
    final long _buildTimeSeconds;
    final boolean _isSplitCommit;
    final String _segmentLocation;
    final String _controllerVipUrl;

<span class="nc" id="L349">    public Response(String jsonRespStr) {</span>
<span class="nc" id="L350">      JSONObject jsonObject = JSONObject.parseObject(jsonRespStr);</span>
<span class="nc" id="L351">      long offset = -1;</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">      if (jsonObject.containsKey(OFFSET_KEY)) {</span>
<span class="nc" id="L353">        offset = jsonObject.getLong(OFFSET_KEY);</span>
      }
<span class="nc" id="L355">      _offset = offset;</span>

<span class="nc" id="L357">      String statusStr = jsonObject.getString(STATUS_KEY);</span>
      ControllerResponseStatus status;
      try {
<span class="nc" id="L360">        status = ControllerResponseStatus.valueOf(statusStr);</span>
<span class="nc" id="L361">      } catch (Exception e) {</span>
<span class="nc" id="L362">        status = ControllerResponseStatus.FAILED;</span>
<span class="nc" id="L363">      }</span>
<span class="nc" id="L364">      _status = status;</span>

<span class="nc" id="L366">      Long buildTimeObj = jsonObject.getLong(BUILD_TIME_KEY);</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">      if (buildTimeObj == null) {</span>
<span class="nc" id="L368">        _buildTimeSeconds = -1;</span>
      } else {
<span class="nc" id="L370">        _buildTimeSeconds = buildTimeObj;</span>
      }

<span class="nc" id="L373">      boolean isSplitCommit = false;</span>
<span class="nc bnc" id="L374" title="All 4 branches missed.">      if (jsonObject.containsKey(COMMIT_TYPE_KEY) &amp;&amp; jsonObject.getBoolean(COMMIT_TYPE_KEY)) {</span>
<span class="nc" id="L375">        isSplitCommit = true;</span>
      }
<span class="nc" id="L377">      _isSplitCommit = isSplitCommit;</span>

<span class="nc" id="L379">      String segmentLocation = null;</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">      if (jsonObject.containsKey(SEGMENT_LOCATION_KEY)) {</span>
<span class="nc" id="L381">        segmentLocation = jsonObject.getString(SEGMENT_LOCATION_KEY);</span>
      }
<span class="nc" id="L383">      _segmentLocation = segmentLocation;</span>

<span class="nc" id="L385">      String controllerVipUrl= null;</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">      if (jsonObject.containsKey(CONTROLLER_VIP_URL_KEY)) {</span>
<span class="nc" id="L387">        controllerVipUrl = jsonObject.getString(CONTROLLER_VIP_URL_KEY);</span>
      }
<span class="nc" id="L389">      _controllerVipUrl = controllerVipUrl;</span>
<span class="nc" id="L390">    }</span>

<span class="fc" id="L392">    public Response(Params params) {</span>
<span class="fc" id="L393">      _status = params.getStatus();</span>
<span class="fc" id="L394">      _offset = params.getOffset();</span>
<span class="fc" id="L395">      _buildTimeSeconds = params.getBuildTimeSeconds();</span>
<span class="fc" id="L396">      _isSplitCommit = params.getIsSplitCommit();</span>
<span class="fc" id="L397">      _segmentLocation = params.getSegmentLocation();</span>
<span class="fc" id="L398">      _controllerVipUrl = params.getControllerVipUrl();</span>
<span class="fc" id="L399">    }</span>

    public ControllerResponseStatus getStatus() {
<span class="fc" id="L402">      return _status;</span>
    }

    public long getOffset() {
<span class="fc" id="L406">      return _offset;</span>
    }

    public long getBuildTimeSeconds() {
<span class="fc" id="L410">      return _buildTimeSeconds;</span>
    }

    public boolean getIsSplitCommit() {
<span class="nc" id="L414">      return _isSplitCommit;</span>
    }

    public String getControllerVipUrl() {
<span class="nc" id="L418">      return _controllerVipUrl;</span>
    }

    public String getSegmentLocation() {
<span class="nc" id="L422">      return _segmentLocation;</span>
    }

    public String toJsonString() {
<span class="nc" id="L426">      StringBuilder builder = new StringBuilder();</span>
<span class="nc bnc" id="L427" title="All 4 branches missed.">      builder.append(&quot;{\&quot;&quot; + STATUS_KEY + &quot;\&quot;:&quot; + &quot;\&quot;&quot; + _status.name() + &quot;\&quot;,&quot; + &quot;\&quot;&quot;</span>
          + OFFSET_KEY + &quot;\&quot;:&quot; + _offset + &quot;,\&quot;&quot;
          + COMMIT_TYPE_KEY + &quot;\&quot;:&quot; + _isSplitCommit
          + (_segmentLocation != null ? &quot;,\&quot;&quot; + SEGMENT_LOCATION_KEY + &quot;\&quot;:\&quot;&quot; + _segmentLocation + &quot;\&quot;&quot; : &quot;&quot;)
          + (_controllerVipUrl != null ? &quot;,&quot; + &quot;\&quot;&quot; + CONTROLLER_VIP_URL_KEY + &quot;\&quot;:\&quot;&quot; + _controllerVipUrl + &quot;\&quot;&quot; : &quot;&quot;));
<span class="nc" id="L432">      builder.append(&quot;}&quot;);</span>
<span class="nc" id="L433">      return builder.toString();</span>
    }

    public static class Params {
      private ControllerResponseStatus _status;
      private long _offset;
      private long _buildTimeSec;
      private boolean _isSplitCommit;
      private String _segmentLocation;
      private String _controllerVipUrl;

<span class="fc" id="L444">      public Params() {</span>
<span class="fc" id="L445">        _offset = -1L;</span>
<span class="fc" id="L446">        _status = ControllerResponseStatus.FAILED;</span>
<span class="fc" id="L447">        _buildTimeSec = -1;</span>
<span class="fc" id="L448">        _isSplitCommit = false;</span>
<span class="fc" id="L449">        _segmentLocation = null;</span>
<span class="fc" id="L450">        _controllerVipUrl = null;</span>
<span class="fc" id="L451">      }</span>

      public Params withOffset(long offset) {
<span class="fc" id="L454">        _offset = offset;</span>
<span class="fc" id="L455">        return this;</span>
      }

      public Params withStatus(ControllerResponseStatus status) {
<span class="fc" id="L459">        _status = status;</span>
<span class="fc" id="L460">        return this;</span>
      }

      public Params withBuildTimeSeconds(long buildTimeSeconds) {
<span class="nc" id="L464">        _buildTimeSec = buildTimeSeconds;</span>
<span class="nc" id="L465">        return this;</span>
      }

      public Params withSplitCommit(boolean isSplitCommit) {
<span class="nc" id="L469">        _isSplitCommit = isSplitCommit;</span>
<span class="nc" id="L470">        return this;</span>
      }

      public Params withControllerVipUrl(String controllerVipUrl) {
<span class="nc" id="L474">        _controllerVipUrl = controllerVipUrl;</span>
<span class="nc" id="L475">        return this;</span>
      }

      public Params withSegmentLocation(String segmentLocation) {
<span class="nc" id="L479">        _segmentLocation = segmentLocation;</span>
<span class="nc" id="L480">        return this;</span>
      }

      public ControllerResponseStatus getStatus() {
<span class="fc" id="L484">        return _status;</span>
      }
      public long getOffset() {
<span class="fc" id="L487">        return _offset;</span>
      }
      public long getBuildTimeSeconds() {
<span class="fc" id="L490">        return _buildTimeSec;</span>
      }
      public boolean getIsSplitCommit() {
<span class="fc" id="L493">        return _isSplitCommit;</span>
      }
      public String getSegmentLocation() {
<span class="fc" id="L496">        return _segmentLocation;</span>
      }
      public String getControllerVipUrl() {
<span class="fc" id="L499">        return _controllerVipUrl;</span>
      }
    }
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>