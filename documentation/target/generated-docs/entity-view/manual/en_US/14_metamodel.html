<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metamodel</title>
<link rel="stylesheet" href="css/blazebit.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="prettify/prettify.min.css">
<script src="prettify/prettify.min.js"></script>
<script src="prettify/lang-ext.js"></script>
<script>document.addEventListener('DOMContentLoaded', prettyPrint)</script>
<link rel="shortcut icon" href="images/favicon.png">
</head>
<body class="book toc2 toc-left">

<div class="brand">
    <a class="vendor" href="https://blazebit.com">
        <strong>Blazebit.com</strong>
    </a>
    <a class="logo" href="https://persistence.blazebit.com">
        <strong>blaze-persistence</strong>
    </a>
</div>
<br/>

<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#metamodel">Metamodel</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="metamodel"><a class="anchor" href="#metamodel"></a>Metamodel</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The metamodel for entity views is very similar to the JPA metamodel and the entry point is <a href="{entity_view_jdoc}/persistence/view/metamodel/ViewMetamodel.html"><code>ViewMetamodel</code></a>
which can be acquired through <a href="{entity_view_jdoc}/persistence/view/EntityViewManager.html#getMetamodel()"><code>EntityViewManager.getMetamodel()</code></a></p>
</div>
<div class="paragraph">
<p>It allows access to views(<code>ViewType</code>) and flat views(<code>FlatViewType</code>) which both are subtypes of managed views(<code>ManagedViewType</code>).
The only difference between the two is that a flat view has no id mapping, so it&#8217;s identity is composed of all attributes
which results in some limitations as described in the <a href="#flat-view-mappings">flat view mapping</a> section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Failed to generate image: can't modify frozen #&lt;Class:#&lt;Asciidoctor::Diagram::PlantUmlBlockProcessor:0xf6c495c&gt;&gt;
interface ManagedViewType {
    +getJavaType()
    +getEntityClass()
    +getAttributes()
    +getAttribute(String name)
    +getDefaultBatchSize()
    +getConstructors()
    +getConstructor(Class&lt;?&gt;... paramTypes)
    +getConstructorNames()
    +getConstructor(String name)
}
interface ViewType {
    +getName()
    +getIdAttribute()
    +isUpdatable()
    +isPartiallyUpdatable()
    +getViewFilter(String name)
    +getViewFilters()
}
interface FlatViewType {
}
interface MappingConstructor {
    +getName()
    +getDeclaringType()
    +getJavaConstructor()
    +getParameterAttributes()
    +getParameterAttribute(int index)
}
interface FilterMapping {
    +getName()
    +isViewFilter()
    +getFilterClass()
}
interface ViewFilterMapping {
    +getDeclaringType()
}
ManagedViewType &lt;|-- ViewType
ManagedViewType &lt;|-- FlatViewType
FilterMapping &lt;|-- ViewFilterMapping

hide fields
hide FlatViewType members</pre>
</div>
</div>
<div class="paragraph">
<p>A view can have multiple named constructors that have parameter attributes. Additionally, a view can also have multiple named view filters.
Every managed view has attributes which are structured based on the arity(singular or plural), the mapping type(parameter or method) and correlation type(normal, subquery or correlated).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Failed to generate image: can't modify frozen #&lt;Class:#&lt;Asciidoctor::Diagram::PlantUmlBlockProcessor:0xf6c495c&gt;&gt;
interface Attribute {
    +getDeclaringType()
    +getJavaType()
    +isSubquery()
    +isCollection()
    +isSubview()
    +isCorrelated()
    +getFetchStrategy()
    +getBatchSize()
}

interface SingularAttribute {
    +isQueryParameter()
    +isId()
}

interface PluralAttribute {
    +getCollectionType()
    +getElementType()
    +isIndexed()
    +isOrdered()
    +isSorted()
    +getComparator()
    +getComparatorClass()
}

interface MethodAttribute {
    +getName()
    +isUpdatable()
    +getJavaMethod()
    +getFilter(String filterName)
    +getFilters()
}
interface ParameterAttribute {
    +getIndex()
    +getDeclaringConstructor()
}

interface MappingAttribute {
    +getMapping()
}
interface CorrelatedAttribute {
    +getCorrelationProvider()
    +getCorrelationBasis()
    +getCorrelationResult()
}
interface SubqueryAttribute {
    +getSubqueryProvider()
    +getSubqueryExpression()
    +getSubqueryAlias()
}

enum CollectionType {
    COLLECTION
    LIST
    MAP
    SET
}

interface CollectionAttribute
interface SetAttribute
interface ListAttribute
interface MapAttribute {
    +getKeyType()
    +isKeySubview()
}

interface FilterMapping {
    +getName()
    +isViewFilter()
    +getFilterClass()
}
interface AttributeFilterMapping {
    +getDeclaringAttribute()
}


Attribute &lt;|-- SingularAttribute
Attribute &lt;|-- PluralAttribute

Attribute &lt;|-- MethodAttribute
Attribute &lt;|-- ParameterAttribute

Attribute &lt;|-- MappingAttribute
Attribute &lt;|-- CorrelatedAttribute
SingularAttribute &lt;|-- SubqueryAttribute

PluralAttribute &lt;|-- ListAttribute
PluralAttribute &lt;|-- MapAttribute
PluralAttribute &lt;|-- CollectionAttribute
PluralAttribute &lt;|-- SetAttribute

FilterMapping &lt;|-- AttributeFilterMapping

hide fields
hide CollectionAttribute members
hide SetAttribute members
hide ListAttribute members
show CollectionType fields
hide CollectionType methods</pre>
</div>
</div>
<div class="paragraph">
<p>An attribute is always either an instance of <code>ParameterAttribute</code> or <code>MethodAttribute</code> depending on whether it is defined on a constructor as parameter or as getter method.
A parameter attribute is defined by it&#8217;s index and it&#8217;s declaring <code>MappingConstructor</code>.
Method attributes have a name, may have multiple named attribute filters and might possibly be updatable.</p>
</div>
<div class="paragraph">
<p>A singular attribute is always an instance of <code>SingularAttribute</code> and is given if <code>isCollection()</code> returns <code>false</code>.
If it is a subquery i.e. <code>isSubquery()</code> returns <code>true</code>, it is also an instance of <code>SubqueryAttribute</code>.
If it is correlated i.e. <code>isCorrelated()</code> returns <code>true</code>, it is also an instance of <code>CorrelatedAttribute</code>.
If it is neither a subquery nor correlated, it is going to be an instance of <code>MappingAttribute</code>.</p>
</div>
<div class="paragraph">
<p>A plural attribute is always an instance of <code>PluralAttribute</code> and is given if <code>isCollection()</code> return <code>true</code>.
Since plural attributes can&#8217;t be defined via a subquery mapping, it is never an instance of <code>SubqueryAttribute</code>.
If it is correlated i.e. <code>isCorrelated()</code> returns <code>true</code>, it is also an instance of <code>CorrelatedAttribute</code>, otherwise it is going to be an instance of <code>MappingAttribute</code>.
Depending on the collection type returned by <code>getCollectionType</code> a plural attribute is also an instance of</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CollectionAttribute</code> if <code>CollectionType.COLLECTION</code></p>
</li>
<li>
<p><code>ListAttribute</code> if <code>CollectionType.LIST</code></p>
</li>
<li>
<p><code>SetAttribute</code> if <code>CollectionType.SET</code></p>
</li>
<li>
<p><code>MapAttribute</code> if <code>CollectionType.MAP</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-08-05 16:46:14 KST
</div>
</div>
</body>
</html>